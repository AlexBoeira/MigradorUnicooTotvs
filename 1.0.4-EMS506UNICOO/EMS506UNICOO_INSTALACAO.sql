------------------------------------------------
-- Export file for user EMS506UNICOO          --
-- Created by Totvs01 on 13/05/2019, 11:25:52 --
------------------------------------------------

set define off
spool PCK_EMS506UNICOO.log

prompt
prompt Creating table BKP_TI_TIPO_MOVIMENTO_TIT_ACR
prompt ============================================
prompt
create table EMS506UNICOO.BKP_TI_TIPO_MOVIMENTO_TIT_ACR
(
  nrsequencial              NUMBER(4) not null,
  cdempresa                 VARCHAR2(5) not null,
  cdmovimento               VARCHAR2(4) not null,
  cdmodulo                  VARCHAR2(4) not null,
  nomovimento               VARCHAR2(40),
  cod_grp_clien             VARCHAR2(4) not null,
  cod_estab                 VARCHAR2(3),
  cod_tip_fluxo_financ      VARCHAR2(12),
  cod_cta_ctbl              VARCHAR2(20),
  cod_ccusto                VARCHAR2(11),
  cod_espec_docto           VARCHAR2(3),
  cod_cart_bcia             VARCHAR2(3),
  cod_empresa               VARCHAR2(3),
  cod_portador              VARCHAR2(6),
  cod_tip_fluxo_financ_ems2 VARCHAR2(12)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CAD_GER_ENCON
prompt ============================
prompt
create table EMS506UNICOO.CAD_GER_ENCON
(
  cd_usuario_criacao    VARCHAR2(12),
  cod_cart_bcia_acr     VARCHAR2(6),
  cod_cart_bcia_apb     VARCHAR2(6),
  cod_ccusto_bai_acr    VARCHAR2(11),
  cod_ccusto_bai_apb    VARCHAR2(11),
  cod_ccusto_impl_acr   VARCHAR2(11),
  cod_ccusto_impl_apb   VARCHAR2(11),
  u##cod_cenar_ctbl     VARCHAR2(30),
  cod_cenar_ctbl        VARCHAR2(30),
  cod_cta_ctbl_bai_acr  VARCHAR2(20),
  cod_cta_ctbl_bai_apb  VARCHAR2(20),
  cod_cta_ctbl_impl_acr VARCHAR2(20),
  cod_cta_ctbl_impl_apb VARCHAR2(20),
  u##cod_empresa        VARCHAR2(6),
  cod_empresa           VARCHAR2(6),
  cod_espec_acr         VARCHAR2(6),
  cod_espec_apb         VARCHAR2(6),
  u##cod_estab          VARCHAR2(6),
  cod_estab             VARCHAR2(6),
  cod_forma_pagto_acr   VARCHAR2(6),
  cod_forma_pagto_apb   VARCHAR2(6),
  u##cod_plano_ccusto   VARCHAR2(30),
  cod_plano_ccusto      VARCHAR2(30),
  u##cod_plano_cta_ctbl VARCHAR2(30),
  cod_plano_cta_ctbl    VARCHAR2(30),
  cod_portador_acr      VARCHAR2(6),
  cod_portador_apb      VARCHAR2(6),
  cod_ser_acr           VARCHAR2(6),
  cod_ser_apb           VARCHAR2(6),
  cod_tip_fluxo_acr     VARCHAR2(12),
  cod_tip_fluxo_apb     VARCHAR2(12),
  u##cod_unid_negoc     VARCHAR2(6),
  cod_unid_negoc        VARCHAR2(6),
  dt_criacao            DATE,
  nr_seq_lote_cod_ref   NUMBER,
  progress_recid        NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create unique index EMS506UNICOO.CAD_GER_##GERALENCON on EMS506UNICOO.CAD_GER_ENCON (U##COD_EMPRESA, U##COD_ESTAB, U##COD_CENAR_CTBL, U##COD_UNID_NEGOC, U##COD_PLANO_CCUSTO, U##COD_PLANO_CTA_CTBL)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create unique index EMS506UNICOO.CAD_GER_##REC on EMS506UNICOO.CAD_GER_ENCON (PROGRESS_RECID)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CAM_COMPENSACAO
prompt ==============================
prompt
create table EMS506UNICOO.CAM_COMPENSACAO
(
  cdnfornecedorprincipal NUMBER not null,
  cod_usuario_criacao    VARCHAR2(12),
  des_camara             VARCHAR2(20),
  dt_criacao             DATE,
  cdn_camara             NUMBER not null,
  progress_recid         NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create unique index EMS506UNICOO.CAM_COMP##CAMPRIN on EMS506UNICOO.CAM_COMPENSACAO (CDNFORNECEDORPRINCIPAL, CDN_CAMARA)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create unique index EMS506UNICOO.CAM_COMP##REC on EMS506UNICOO.CAM_COMPENSACAO (PROGRESS_RECID)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CAM_COMPENSACAO_FORNEC
prompt =====================================
prompt
create table EMS506UNICOO.CAM_COMPENSACAO_FORNEC
(
  cdn_camara          NUMBER not null,
  cdn_fornecedor      NUMBER not null,
  cod_usuario_criacao VARCHAR2(12),
  dt_criacao          DATE,
  progress_recid      NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create unique index EMS506UNICOO.CAM_COM1##CAMFORNEC on EMS506UNICOO.CAM_COMPENSACAO_FORNEC (CDN_CAMARA, CDN_FORNECEDOR)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create unique index EMS506UNICOO.CAM_COM1##REC on EMS506UNICOO.CAM_COMPENSACAO_FORNEC (PROGRESS_RECID)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CLIEN_FIN_EMS_BKP_2701
prompt =====================================
prompt
create table EMS506UNICOO.CLIEN_FIN_EMS_BKP_2701
(
  u##cod_empresa          VARCHAR2(12) not null,
  cod_empresa             VARCHAR2(12) not null,
  cdn_cliente             NUMBER not null,
  cdn_repres              NUMBER,
  cod_tip_clien           VARCHAR2(16) not null,
  cod_portad_prefer       VARCHAR2(12),
  u##cod_portador         VARCHAR2(12),
  cod_portador            VARCHAR2(12),
  cod_banco               VARCHAR2(16),
  cod_agenc_bcia          VARCHAR2(20),
  cod_cta_corren_bco      VARCHAR2(40),
  cod_digito_cta_corren   VARCHAR2(12),
  u##cod_classif_msg_cobr VARCHAR2(16),
  cod_classif_msg_cobr    VARCHAR2(16),
  cod_instruc_bcia_1_acr  VARCHAR2(12) not null,
  cod_instruc_bcia_2_acr  VARCHAR2(12) not null,
  loghabilitemisboleto    NUMBER not null,
  log_habilit_gera_avdeb  NUMBER not null,
  log_retenc_impto        NUMBER not null,
  log_habilit_db_autom    NUMBER not null,
  num_tit_acr_aber        NUMBER not null,
  indsitclienperdadedut   VARCHAR2(42) not null,
  cod_digito_agenc_bcia   VARCHAR2(12) not null,
  cod_livre_1             VARCHAR2(500),
  log_livre_1             NUMBER,
  num_livre_1             NUMBER,
  val_livre_1             NUMBER,
  dat_livre_1             DATE,
  cod_cart_bcia           VARCHAR2(12) not null,
  cod_cart_bcia_prefer    VARCHAR2(12) not null,
  cod_livre_2             VARCHAR2(500),
  log_livre_2             NUMBER,
  num_livre_2             NUMBER,
  val_livre_2             NUMBER,
  dat_livre_2             DATE,
  des_livre_1             VARCHAR2(2000) not null,
  log_utiliz_verba        NUMBER,
  val_perc_verba          NUMBER,
  val_min_avdeb           NUMBER,
  log_calc_multa          NUMBER not null,
  num_dias_atraso_avdeb   NUMBER not null,
  cod_tip_fluxo_financ    VARCHAR2(24) not null,
  log_envio_bco_histor    NUMBER not null,
  cdd_version             NUMBER,
  cdn_id_reserve          NUMBER,
  log_envdo_serasa        NUMBER,
  progress_recid          NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CLIEN_FINANC_EMS_BKP
prompt ===================================
prompt
create table EMS506UNICOO.CLIEN_FINANC_EMS_BKP
(
  u##cod_empresa          VARCHAR2(12) not null,
  cod_empresa             VARCHAR2(12) not null,
  cdn_cliente             NUMBER not null,
  cdn_repres              NUMBER,
  cod_tip_clien           VARCHAR2(16) not null,
  cod_portad_prefer       VARCHAR2(12),
  u##cod_portador         VARCHAR2(12),
  cod_portador            VARCHAR2(12),
  cod_banco               VARCHAR2(16),
  cod_agenc_bcia          VARCHAR2(20),
  cod_cta_corren_bco      VARCHAR2(40),
  cod_digito_cta_corren   VARCHAR2(12),
  u##cod_classif_msg_cobr VARCHAR2(16),
  cod_classif_msg_cobr    VARCHAR2(16),
  cod_instruc_bcia_1_acr  VARCHAR2(12) not null,
  cod_instruc_bcia_2_acr  VARCHAR2(12) not null,
  loghabilitemisboleto    NUMBER not null,
  log_habilit_gera_avdeb  NUMBER not null,
  log_retenc_impto        NUMBER not null,
  log_habilit_db_autom    NUMBER not null,
  num_tit_acr_aber        NUMBER not null,
  indsitclienperdadedut   VARCHAR2(42) not null,
  cod_digito_agenc_bcia   VARCHAR2(12) not null,
  cod_livre_1             VARCHAR2(500),
  log_livre_1             NUMBER,
  num_livre_1             NUMBER,
  val_livre_1             NUMBER,
  dat_livre_1             DATE,
  cod_cart_bcia           VARCHAR2(12) not null,
  cod_cart_bcia_prefer    VARCHAR2(12) not null,
  cod_livre_2             VARCHAR2(500),
  log_livre_2             NUMBER,
  num_livre_2             NUMBER,
  val_livre_2             NUMBER,
  dat_livre_2             DATE,
  des_livre_1             VARCHAR2(2000) not null,
  log_utiliz_verba        NUMBER,
  val_perc_verba          NUMBER,
  val_min_avdeb           NUMBER,
  log_calc_multa          NUMBER not null,
  num_dias_atraso_avdeb   NUMBER not null,
  cod_tip_fluxo_financ    VARCHAR2(24) not null,
  log_envio_bco_histor    NUMBER not null,
  cdd_version             NUMBER,
  cdn_id_reserve          NUMBER,
  log_envdo_serasa        NUMBER,
  progress_recid          NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CLIEN_FINANC_EMS_BKP_2
prompt =====================================
prompt
create table EMS506UNICOO.CLIEN_FINANC_EMS_BKP_2
(
  u##cod_empresa          VARCHAR2(12) not null,
  cod_empresa             VARCHAR2(12) not null,
  cdn_cliente             NUMBER not null,
  cdn_repres              NUMBER,
  cod_tip_clien           VARCHAR2(16) not null,
  cod_portad_prefer       VARCHAR2(12),
  u##cod_portador         VARCHAR2(12),
  cod_portador            VARCHAR2(12),
  cod_banco               VARCHAR2(16),
  cod_agenc_bcia          VARCHAR2(20),
  cod_cta_corren_bco      VARCHAR2(40),
  cod_digito_cta_corren   VARCHAR2(12),
  u##cod_classif_msg_cobr VARCHAR2(16),
  cod_classif_msg_cobr    VARCHAR2(16),
  cod_instruc_bcia_1_acr  VARCHAR2(12) not null,
  cod_instruc_bcia_2_acr  VARCHAR2(12) not null,
  loghabilitemisboleto    NUMBER not null,
  log_habilit_gera_avdeb  NUMBER not null,
  log_retenc_impto        NUMBER not null,
  log_habilit_db_autom    NUMBER not null,
  num_tit_acr_aber        NUMBER not null,
  indsitclienperdadedut   VARCHAR2(42) not null,
  cod_digito_agenc_bcia   VARCHAR2(12) not null,
  cod_livre_1             VARCHAR2(500),
  log_livre_1             NUMBER,
  num_livre_1             NUMBER,
  val_livre_1             NUMBER,
  dat_livre_1             DATE,
  cod_cart_bcia           VARCHAR2(12) not null,
  cod_cart_bcia_prefer    VARCHAR2(12) not null,
  cod_livre_2             VARCHAR2(500),
  log_livre_2             NUMBER,
  num_livre_2             NUMBER,
  val_livre_2             NUMBER,
  dat_livre_2             DATE,
  des_livre_1             VARCHAR2(2000) not null,
  log_utiliz_verba        NUMBER,
  val_perc_verba          NUMBER,
  val_min_avdeb           NUMBER,
  log_calc_multa          NUMBER not null,
  num_dias_atraso_avdeb   NUMBER not null,
  cod_tip_fluxo_financ    VARCHAR2(24) not null,
  log_envio_bco_histor    NUMBER not null,
  cdd_version             NUMBER,
  cdn_id_reserve          NUMBER,
  log_envdo_serasa        NUMBER,
  progress_recid          NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CLIEN_FINANC_EMS_BKP_3
prompt =====================================
prompt
create table EMS506UNICOO.CLIEN_FINANC_EMS_BKP_3
(
  u##cod_empresa          VARCHAR2(12) not null,
  cod_empresa             VARCHAR2(12) not null,
  cdn_cliente             NUMBER not null,
  cdn_repres              NUMBER,
  cod_tip_clien           VARCHAR2(16) not null,
  cod_portad_prefer       VARCHAR2(12),
  u##cod_portador         VARCHAR2(12),
  cod_portador            VARCHAR2(12),
  cod_banco               VARCHAR2(16),
  cod_agenc_bcia          VARCHAR2(20),
  cod_cta_corren_bco      VARCHAR2(40),
  cod_digito_cta_corren   VARCHAR2(12),
  u##cod_classif_msg_cobr VARCHAR2(16),
  cod_classif_msg_cobr    VARCHAR2(16),
  cod_instruc_bcia_1_acr  VARCHAR2(12) not null,
  cod_instruc_bcia_2_acr  VARCHAR2(12) not null,
  loghabilitemisboleto    NUMBER not null,
  log_habilit_gera_avdeb  NUMBER not null,
  log_retenc_impto        NUMBER not null,
  log_habilit_db_autom    NUMBER not null,
  num_tit_acr_aber        NUMBER not null,
  indsitclienperdadedut   VARCHAR2(42) not null,
  cod_digito_agenc_bcia   VARCHAR2(12) not null,
  cod_livre_1             VARCHAR2(500),
  log_livre_1             NUMBER,
  num_livre_1             NUMBER,
  val_livre_1             NUMBER,
  dat_livre_1             DATE,
  cod_cart_bcia           VARCHAR2(12) not null,
  cod_cart_bcia_prefer    VARCHAR2(12) not null,
  cod_livre_2             VARCHAR2(500),
  log_livre_2             NUMBER,
  num_livre_2             NUMBER,
  val_livre_2             NUMBER,
  dat_livre_2             DATE,
  des_livre_1             VARCHAR2(2000) not null,
  log_utiliz_verba        NUMBER,
  val_perc_verba          NUMBER,
  val_min_avdeb           NUMBER,
  log_calc_multa          NUMBER not null,
  num_dias_atraso_avdeb   NUMBER not null,
  cod_tip_fluxo_financ    VARCHAR2(24) not null,
  log_envio_bco_histor    NUMBER not null,
  cdd_version             NUMBER,
  cdn_id_reserve          NUMBER,
  log_envdo_serasa        NUMBER,
  progress_recid          NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CLIENTE_EMS_BKP
prompt ==============================
prompt
create table EMS506UNICOO.CLIENTE_EMS_BKP
(
  u##cod_empresa         VARCHAR2(12) not null,
  cod_empresa            VARCHAR2(12) not null,
  cdn_cliente            NUMBER not null,
  u##nom_pessoa          VARCHAR2(80) not null,
  nom_pessoa             VARCHAR2(80) not null,
  num_pessoa             NUMBER,
  u##nom_abrev           VARCHAR2(30) not null,
  nom_abrev              VARCHAR2(30) not null,
  u##cod_pais            VARCHAR2(12) not null,
  cod_pais               VARCHAR2(12) not null,
  u##cod_id_feder        VARCHAR2(40) not null,
  cod_id_feder           VARCHAR2(40) not null,
  u##cod_grp_clien       VARCHAR2(12),
  cod_grp_clien          VARCHAR2(12),
  u##cod_tip_clien       VARCHAR2(16) not null,
  cod_tip_clien          VARCHAR2(16) not null,
  dat_impl_clien         DATE not null,
  log_ems_20_atlzdo      NUMBER not null,
  cod_livre_1            VARCHAR2(500),
  log_livre_1            NUMBER,
  num_livre_1            NUMBER,
  val_livre_1            NUMBER,
  dat_livre_1            DATE,
  cod_livre_2            VARCHAR2(500),
  dat_livre_2            DATE,
  log_livre_2            NUMBER,
  num_livre_2            NUMBER,
  val_livre_2            NUMBER,
  cdd_version            NUMBER,
  log_replic_emit_hcm    NUMBER,
  log_replic_emit_gps    NUMBER,
  log_replic_emit_crm    NUMBER,
  log_replic_emit_financ NUMBER,
  log_replic_emit_erp    NUMBER,
  progress_recid         NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CLIENTE_EMS_BKP_2
prompt ================================
prompt
create table EMS506UNICOO.CLIENTE_EMS_BKP_2
(
  u##cod_empresa         VARCHAR2(12) not null,
  cod_empresa            VARCHAR2(12) not null,
  cdn_cliente            NUMBER not null,
  u##nom_pessoa          VARCHAR2(80) not null,
  nom_pessoa             VARCHAR2(80) not null,
  num_pessoa             NUMBER,
  u##nom_abrev           VARCHAR2(30) not null,
  nom_abrev              VARCHAR2(30) not null,
  u##cod_pais            VARCHAR2(12) not null,
  cod_pais               VARCHAR2(12) not null,
  u##cod_id_feder        VARCHAR2(40) not null,
  cod_id_feder           VARCHAR2(40) not null,
  u##cod_grp_clien       VARCHAR2(12),
  cod_grp_clien          VARCHAR2(12),
  u##cod_tip_clien       VARCHAR2(16) not null,
  cod_tip_clien          VARCHAR2(16) not null,
  dat_impl_clien         DATE not null,
  log_ems_20_atlzdo      NUMBER not null,
  cod_livre_1            VARCHAR2(500),
  log_livre_1            NUMBER,
  num_livre_1            NUMBER,
  val_livre_1            NUMBER,
  dat_livre_1            DATE,
  cod_livre_2            VARCHAR2(500),
  dat_livre_2            DATE,
  log_livre_2            NUMBER,
  num_livre_2            NUMBER,
  val_livre_2            NUMBER,
  cdd_version            NUMBER,
  log_replic_emit_hcm    NUMBER,
  log_replic_emit_gps    NUMBER,
  log_replic_emit_crm    NUMBER,
  log_replic_emit_financ NUMBER,
  log_replic_emit_erp    NUMBER,
  progress_recid         NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CLIENTE_EMS_BKP_2701
prompt ===================================
prompt
create table EMS506UNICOO.CLIENTE_EMS_BKP_2701
(
  u##cod_empresa         VARCHAR2(12) not null,
  cod_empresa            VARCHAR2(12) not null,
  cdn_cliente            NUMBER not null,
  u##nom_pessoa          VARCHAR2(80) not null,
  nom_pessoa             VARCHAR2(80) not null,
  num_pessoa             NUMBER,
  u##nom_abrev           VARCHAR2(30) not null,
  nom_abrev              VARCHAR2(30) not null,
  u##cod_pais            VARCHAR2(12) not null,
  cod_pais               VARCHAR2(12) not null,
  u##cod_id_feder        VARCHAR2(40) not null,
  cod_id_feder           VARCHAR2(40) not null,
  u##cod_grp_clien       VARCHAR2(12),
  cod_grp_clien          VARCHAR2(12),
  u##cod_tip_clien       VARCHAR2(16) not null,
  cod_tip_clien          VARCHAR2(16) not null,
  dat_impl_clien         DATE not null,
  log_ems_20_atlzdo      NUMBER not null,
  cod_livre_1            VARCHAR2(500),
  log_livre_1            NUMBER,
  num_livre_1            NUMBER,
  val_livre_1            NUMBER,
  dat_livre_1            DATE,
  cod_livre_2            VARCHAR2(500),
  dat_livre_2            DATE,
  log_livre_2            NUMBER,
  num_livre_2            NUMBER,
  val_livre_2            NUMBER,
  cdd_version            NUMBER,
  log_replic_emit_hcm    NUMBER,
  log_replic_emit_gps    NUMBER,
  log_replic_emit_crm    NUMBER,
  log_replic_emit_financ NUMBER,
  log_replic_emit_erp    NUMBER,
  progress_recid         NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CLIENTE_EMS_BKP_3
prompt ================================
prompt
create table EMS506UNICOO.CLIENTE_EMS_BKP_3
(
  u##cod_empresa         VARCHAR2(12) not null,
  cod_empresa            VARCHAR2(12) not null,
  cdn_cliente            NUMBER not null,
  u##nom_pessoa          VARCHAR2(80) not null,
  nom_pessoa             VARCHAR2(80) not null,
  num_pessoa             NUMBER,
  u##nom_abrev           VARCHAR2(30) not null,
  nom_abrev              VARCHAR2(30) not null,
  u##cod_pais            VARCHAR2(12) not null,
  cod_pais               VARCHAR2(12) not null,
  u##cod_id_feder        VARCHAR2(40) not null,
  cod_id_feder           VARCHAR2(40) not null,
  u##cod_grp_clien       VARCHAR2(12),
  cod_grp_clien          VARCHAR2(12),
  u##cod_tip_clien       VARCHAR2(16) not null,
  cod_tip_clien          VARCHAR2(16) not null,
  dat_impl_clien         DATE not null,
  log_ems_20_atlzdo      NUMBER not null,
  cod_livre_1            VARCHAR2(500),
  log_livre_1            NUMBER,
  num_livre_1            NUMBER,
  val_livre_1            NUMBER,
  dat_livre_1            DATE,
  cod_livre_2            VARCHAR2(500),
  dat_livre_2            DATE,
  log_livre_2            NUMBER,
  num_livre_2            NUMBER,
  val_livre_2            NUMBER,
  cdd_version            NUMBER,
  log_replic_emit_hcm    NUMBER,
  log_replic_emit_gps    NUMBER,
  log_replic_emit_crm    NUMBER,
  log_replic_emit_financ NUMBER,
  log_replic_emit_erp    NUMBER,
  progress_recid         NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CONTROLE_RETORNO_TITULO_ACR
prompt ==========================================
prompt
create table EMS506UNICOO.CONTROLE_RETORNO_TITULO_ACR
(
  nrsequencial   NUMBER(8) not null,
  cod_refer      VARCHAR2(10),
  dat_geracao    DATE,
  dat_liquidacao DATE
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.CONTROLE_RETORNO_TITULO_ACR
  add constraint PK_CONTROLE_RETORNO_TITULO primary key (NRSEQUENCIAL)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CST_JOSIAS_BANCO_CLIENTE
prompt =======================================
prompt
create table EMS506UNICOO.CST_JOSIAS_BANCO_CLIENTE
(
  nrseq_controle_integracao NUMBER(9) not null,
  cdidentificador           VARCHAR2(40),
  cod_cliente               NUMBER(9) not null,
  nom_abrev                 VARCHAR2(15),
  cod_id_feder              VARCHAR2(20) not null,
  cod_banco                 VARCHAR2(8) not null,
  txfalha                   VARCHAR2(2000)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CST_JOSIAS_FOR
prompt =============================
prompt
create table EMS506UNICOO.CST_JOSIAS_FOR
(
  cdidentificador VARCHAR2(40)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CST_JOSIAS_FORNEC_ERRO
prompt =====================================
prompt
create table EMS506UNICOO.CST_JOSIAS_FORNEC_ERRO
(
  nrregistro             NUMBER(10) not null,
  nrregistro_pai         NUMBER(10),
  cod_fornecedor         NUMBER(9),
  cdn_fornecedor         NUMBER(10),
  nom_abrev              VARCHAR2(15) not null,
  noabreviado_fornecedor VARCHAR2(15)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CST_POSICAO_COONTABIL_PAGAR
prompt ==========================================
prompt
create table EMS506UNICOO.CST_POSICAO_COONTABIL_PAGAR
(
  nrregistro_titulo     NUMBER(10) not null,
  nrregistro_fornecedor NUMBER(8),
  cdempresa             VARCHAR2(5) not null,
  idcontrato            VARCHAR2(12),
  cdhistorico           NUMBER,
  nrdocumento           VARCHAR2(12),
  cdportador            VARCHAR2(3),
  tpdocumento           VARCHAR2(3),
  cdsituacao            VARCHAR2(1),
  cdoperacao            VARCHAR2(3),
  dtvencimento          DATE,
  dttitulo              DATE,
  cddivisao             NUMBER(6),
  txhistorico           VARCHAR2(255),
  cdfornecedor          VARCHAR2(6) not null,
  cdgrupo_fornecedor    NUMBER(4) not null,
  nogrupo_fornecedor    VARCHAR2(30),
  nopessoa              VARCHAR2(60),
  nrcgc_cpf             VARCHAR2(15),
  tppessoa              VARCHAR2(1),
  noempresa             VARCHAR2(45),
  nodocumento           VARCHAR2(30),
  noportador            VARCHAR2(30),
  vltitulo              NUMBER,
  dtultimo_recebimento  DATE,
  vlpago                NUMBER,
  vldevido              NUMBER,
  vldesconto            NUMBER,
  vlabatimento          NUMBER,
  vlabatimento_2        NUMBER,
  vljuros               NUMBER,
  vlmulta               NUMBER,
  vltaxa_bancaria       NUMBER,
  cdconta_contabil      VARCHAR2(20)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CST_TIT_ACR_GERADO_JOSIAS
prompt ========================================
prompt
create table EMS506UNICOO.CST_TIT_ACR_GERADO_JOSIAS
(
  cod_refer           VARCHAR2(20),
  nrsequencial        NUMBER,
  nrsequencial_origem NUMBER(10),
  tpintegracao        VARCHAR2(2),
  val_titulo          NUMBER,
  sit_ti_controle     VARCHAR2(2),
  sit_ti_tit_apb      VARCHAR2(2),
  vloriginal          NUMBER,
  val_sdo_tit_ap      NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CST_TIT_APB_GERADO_JOSIAS
prompt ========================================
prompt
create table EMS506UNICOO.CST_TIT_APB_GERADO_JOSIAS
(
  cod_refer           VARCHAR2(20),
  nrsequencial        NUMBER,
  nrsequencial_origem NUMBER(10),
  tpintegracao        VARCHAR2(2),
  val_titulo          NUMBER,
  val_imposto         NUMBER,
  sit_ti_controle     VARCHAR2(2),
  sit_ti_tit_apb      VARCHAR2(2),
  vloriginal          NUMBER,
  val_sdo_tit_ap      NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CTA_CORREN_FORNEC_FALHA
prompt ======================================
prompt
create table EMS506UNICOO.CTA_CORREN_FORNEC_FALHA
(
  u##cod_empresa           VARCHAR2(12) not null,
  cod_empresa              VARCHAR2(12) not null,
  cdn_fornecedor           NUMBER not null,
  u##cod_banco             VARCHAR2(16) not null,
  cod_banco                VARCHAR2(16) not null,
  u##cod_agenc_bcia        VARCHAR2(20) not null,
  cod_agenc_bcia           VARCHAR2(20) not null,
  u##cod_digito_agenc_bcia VARCHAR2(12) not null,
  cod_digito_agenc_bcia    VARCHAR2(12) not null,
  u##cod_cta_corren_bco    VARCHAR2(40) not null,
  cod_cta_corren_bco       VARCHAR2(40) not null,
  u##cod_digito_cta_corren VARCHAR2(12) not null,
  cod_digito_cta_corren    VARCHAR2(12) not null,
  des_cta_corren           VARCHAR2(60),
  log_cta_corren_prefer    NUMBER not null,
  cod_livre_1              VARCHAR2(500),
  cod_livre_2              VARCHAR2(500),
  log_livre_1              NUMBER,
  log_livre_2              NUMBER,
  num_livre_1              NUMBER,
  num_livre_2              NUMBER,
  val_livre_1              NUMBER,
  val_livre_2              NUMBER,
  dat_livre_1              DATE,
  dat_livre_2              DATE,
  progress_recid           NUMBER,
  txfalha                  VARCHAR2(200)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CTA_CTBL_2018_02_20
prompt ==================================
prompt
create table EMS506UNICOO.CTA_CTBL_2018_02_20
(
  u##cod_plano_cta_ctbl    VARCHAR2(16) not null,
  cod_plano_cta_ctbl       VARCHAR2(16) not null,
  u##cod_cta_ctbl          VARCHAR2(40) not null,
  cod_cta_ctbl             VARCHAR2(40) not null,
  u##des_tit_ctbl          VARCHAR2(80) not null,
  des_tit_ctbl             VARCHAR2(80) not null,
  u##cod_altern_cta_ctbl   VARCHAR2(24) not null,
  cod_altern_cta_ctbl      VARCHAR2(24) not null,
  codctactblpadrinternac   VARCHAR2(60),
  u##cod_tip_grp_cta_ctbl  VARCHAR2(16) not null,
  cod_tip_grp_cta_ctbl     VARCHAR2(16) not null,
  u##cod_grp_cta_ctbl      VARCHAR2(16) not null,
  cod_grp_cta_ctbl         VARCHAR2(16) not null,
  u##ind_espec_cta_ctbl    VARCHAR2(20) not null,
  ind_espec_cta_ctbl       VARCHAR2(20) not null,
  ind_natur_cta_ctbl       VARCHAR2(16) not null,
  indutilizctblfinalid     VARCHAR2(38) not null,
  u##cod_finalid_econ      VARCHAR2(20),
  cod_finalid_econ         VARCHAR2(20),
  u##cod_unid_medid        VARCHAR2(12),
  cod_unid_medid           VARCHAR2(12),
  ind_tip_taxac_ctbl       VARCHAR2(40) not null,
  u##cod_cenar_ctbl_exclus VARCHAR2(16),
  cod_cenar_ctbl_exclus    VARCHAR2(16),
  logctactblexclusanalit   NUMBER not null,
  logconsidapuracrestdo    NUMBER not null,
  log_consid_balan_pat     NUMBER not null,
  des_anot_tab             VARCHAR2(2000) not null,
  dat_inic_valid           DATE,
  dat_fim_valid            DATE not null,
  cod_livre_1              VARCHAR2(500),
  log_livre_1              NUMBER,
  num_livre_1              NUMBER,
  val_livre_1              NUMBER,
  dat_livre_1              DATE,
  cod_livre_2              VARCHAR2(500),
  dat_livre_2              DATE,
  log_livre_2              NUMBER,
  num_livre_2              NUMBER,
  val_livre_2              NUMBER,
  cdd_version              NUMBER,
  progress_recid           NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CTA_CTBL_INTEGR_2018_02_19
prompt =========================================
prompt
create table EMS506UNICOO.CTA_CTBL_INTEGR_2018_02_19
(
  u##cod_modul_dtsul    VARCHAR2(12) not null,
  cod_modul_dtsul       VARCHAR2(12) not null,
  u##cod_plano_cta_ctbl VARCHAR2(16) not null,
  cod_plano_cta_ctbl    VARCHAR2(16) not null,
  u##cod_cta_ctbl       VARCHAR2(40) not null,
  cod_cta_ctbl          VARCHAR2(40) not null,
  dat_inic_valid        DATE not null,
  dat_fim_valid         DATE not null,
  u##ind_finalid_ctbl   VARCHAR2(60) not null,
  ind_finalid_ctbl      VARCHAR2(60) not null,
  des_anot_tab          VARCHAR2(2000) not null,
  cod_livre_1           VARCHAR2(500),
  log_livre_1           NUMBER,
  num_livre_1           NUMBER,
  val_livre_1           NUMBER,
  dat_livre_1           DATE,
  cod_livre_2           VARCHAR2(500),
  dat_livre_2           DATE,
  log_livre_2           NUMBER,
  num_livre_2           NUMBER,
  val_livre_2           NUMBER,
  cdd_version           NUMBER,
  progress_recid        NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CTA_CTBL_INTEGR_BKP_2018_01_16
prompt =============================================
prompt
create table EMS506UNICOO.CTA_CTBL_INTEGR_BKP_2018_01_16
(
  u##cod_modul_dtsul    VARCHAR2(12) not null,
  cod_modul_dtsul       VARCHAR2(12) not null,
  u##cod_plano_cta_ctbl VARCHAR2(16) not null,
  cod_plano_cta_ctbl    VARCHAR2(16) not null,
  u##cod_cta_ctbl       VARCHAR2(40) not null,
  cod_cta_ctbl          VARCHAR2(40) not null,
  dat_inic_valid        DATE not null,
  dat_fim_valid         DATE not null,
  u##ind_finalid_ctbl   VARCHAR2(60) not null,
  ind_finalid_ctbl      VARCHAR2(60) not null,
  des_anot_tab          VARCHAR2(2000) not null,
  cod_livre_1           VARCHAR2(500),
  log_livre_1           NUMBER,
  num_livre_1           NUMBER,
  val_livre_1           NUMBER,
  dat_livre_1           DATE,
  cod_livre_2           VARCHAR2(500),
  dat_livre_2           DATE,
  log_livre_2           NUMBER,
  num_livre_2           NUMBER,
  val_livre_2           NUMBER,
  cdd_version           NUMBER,
  progress_recid        NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CTA_GRP_CLIEN_BKP_2018_01_16
prompt ===========================================
prompt
create table EMS506UNICOO.CTA_GRP_CLIEN_BKP_2018_01_16
(
  u##cod_empresa         VARCHAR2(12) not null,
  cod_empresa            VARCHAR2(12) not null,
  u##cod_espec_docto     VARCHAR2(12) not null,
  cod_espec_docto        VARCHAR2(12) not null,
  u##cod_grp_clien       VARCHAR2(12) not null,
  cod_grp_clien          VARCHAR2(12) not null,
  u##cod_finalid_econ    VARCHAR2(20) not null,
  cod_finalid_econ       VARCHAR2(20) not null,
  u##ind_tip_espec_docto VARCHAR2(34) not null,
  ind_tip_espec_docto    VARCHAR2(34) not null,
  u##ind_finalid_ctbl    VARCHAR2(60) not null,
  ind_finalid_ctbl       VARCHAR2(60) not null,
  ind_control_ctbl       VARCHAR2(36) not null,
  num_seq_cta_grp_clien  NUMBER not null,
  dat_inic_valid         DATE not null,
  dat_fim_valid          DATE not null,
  u##cod_plano_cta_ctbl  VARCHAR2(16) not null,
  cod_plano_cta_ctbl     VARCHAR2(16) not null,
  u##cod_cta_ctbl        VARCHAR2(40) not null,
  cod_cta_ctbl           VARCHAR2(40) not null,
  cod_cta_ctbl_ativ      VARCHAR2(40) not null,
  cod_cta_ctbl_passiv    VARCHAR2(40) not null,
  cod_livre_1            VARCHAR2(500),
  cod_plano_ccusto       VARCHAR2(16) not null,
  cod_ccusto             VARCHAR2(22) not null,
  cod_livre_2            VARCHAR2(500),
  dat_livre_1            DATE,
  dat_livre_2            DATE,
  log_livre_1            NUMBER,
  log_livre_2            NUMBER,
  num_livre_1            NUMBER,
  num_livre_2            NUMBER,
  val_livre_1            NUMBER,
  val_livre_2            NUMBER,
  cdd_version            NUMBER,
  progress_recid         NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table CTA_GRP_FORNEC_BKP_2018_01_16
prompt ============================================
prompt
create table EMS506UNICOO.CTA_GRP_FORNEC_BKP_2018_01_16
(
  u##cod_empresa         VARCHAR2(12) not null,
  cod_empresa            VARCHAR2(12) not null,
  u##cod_espec_docto     VARCHAR2(12) not null,
  cod_espec_docto        VARCHAR2(12) not null,
  u##ind_tip_espec_docto VARCHAR2(34) not null,
  ind_tip_espec_docto    VARCHAR2(34) not null,
  u##cod_grp_fornec      VARCHAR2(12) not null,
  cod_grp_fornec         VARCHAR2(12) not null,
  u##cod_finalid_econ    VARCHAR2(20) not null,
  cod_finalid_econ       VARCHAR2(20) not null,
  u##ind_finalid_ctbl    VARCHAR2(60) not null,
  ind_finalid_ctbl       VARCHAR2(60) not null,
  num_seq_cta_grp_fornec NUMBER not null,
  u##cod_plano_cta_ctbl  VARCHAR2(16) not null,
  cod_plano_cta_ctbl     VARCHAR2(16) not null,
  u##cod_cta_ctbl        VARCHAR2(40) not null,
  cod_cta_ctbl           VARCHAR2(40) not null,
  dat_inic_valid         DATE not null,
  dat_fim_valid          DATE not null,
  cod_cta_ctbl_ativ      VARCHAR2(40) not null,
  cod_cta_ctbl_passiv    VARCHAR2(40) not null,
  ind_control_ctbl       VARCHAR2(36) not null,
  cod_livre_1            VARCHAR2(500),
  cod_plano_ccusto       VARCHAR2(16) not null,
  cod_ccusto             VARCHAR2(22) not null,
  cod_livre_2            VARCHAR2(500),
  dat_livre_1            DATE,
  dat_livre_2            DATE,
  log_livre_1            NUMBER,
  log_livre_2            NUMBER,
  num_livre_1            NUMBER,
  num_livre_2            NUMBER,
  val_livre_1            NUMBER,
  val_livre_2            NUMBER,
  cdd_version            NUMBER,
  progress_recid         NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table DEPARA_HIST_APB_NAO_MIGRAR
prompt =========================================
prompt
create table EMS506UNICOO.DEPARA_HIST_APB_NAO_MIGRAR
(
  cdhistorico NUMBER(4)
)
tablespace TS_EMS5
  pctfree 10
  initrans 30
  maxtrans 255
  storage
  (
    initial 18M
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table EMS_FALHA_ACR_UNICOO
prompt ===================================
prompt
create table EMS506UNICOO.EMS_FALHA_ACR_UNICOO
(
  num_id_tit_acr NUMBER(12),
  txfalha        VARCHAR2(4000),
  dtfalha        DATE
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table EMS_MOVIMENTO_TITULO_ACR
prompt =======================================
prompt
create table EMS506UNICOO.EMS_MOVIMENTO_TITULO_ACR
(
  dtmovimento_ems       DATE,
  dtmovimento_unicoo    DATE,
  txultima_falha        VARCHAR2(4000),
  num_id_tit_acr        NUMBER not null,
  num_id_movto_tit_acr  NUMBER not null,
  cod_ser_docto         VARCHAR2(6) not null,
  cod_tit_acr           VARCHAR2(10) not null,
  cod_parcela           VARCHAR2(6),
  val_liq_tit_acr       NUMBER(12,2),
  dat_vencto_tit_acr    DATE,
  val_ajust_val_tit_acr NUMBER(12,2),
  val_movto_tit_acr     NUMBER(12,2) not null,
  val_multa_tit_acr     NUMBER(12,2) not null,
  val_juros             NUMBER(12,2) not null,
  val_desconto          NUMBER(12,2) not null,
  val_abat_tit_acr      NUMBER(12,2) not null,
  val_despes_bcia       NUMBER(12,2),
  dat_cr_movto_tit_acr  DATE,
  dat_transacao         DATE not null,
  ind_trans_acr_abrev   VARCHAR2(6),
  cod_tit_acr_bco       VARCHAR2(20),
  cod_refer             VARCHAR2(10),
  cod_estab             VARCHAR2(6),
  cod_espec_docto       VARCHAR2(6),
  nrmovimento           NUMBER(10),
  ind_tip_espec_docto   VARCHAR2(17),
  nrregistro_titulo     NUMBER(8),
  nrdocumento           VARCHAR2(20),
  dat_liquidac_tit_acr  DATE
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_EMS_MOVTO_TIT_ACR_03 on EMS506UNICOO.EMS_MOVIMENTO_TITULO_ACR (COD_ESTAB, COD_ESPEC_DOCTO, COD_SER_DOCTO, COD_TIT_ACR, COD_PARCELA)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_EMS_MOVTO_TIT_ACR_04 on EMS506UNICOO.EMS_MOVIMENTO_TITULO_ACR (NRDOCUMENTO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_EMS_MOVTO_TIT_ACR_05 on EMS506UNICOO.EMS_MOVIMENTO_TITULO_ACR (COD_SER_DOCTO, COD_TIT_ACR)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.EMS_MOVIMENTO_TITULO_ACR
  add constraint PK_EMS_MOVTO_TITULO_ACR primary key (NUM_ID_MOVTO_TIT_ACR)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table EMS_MOVIMENTO_TITULO_ACR_LOG
prompt ===========================================
prompt
create table EMS506UNICOO.EMS_MOVIMENTO_TITULO_ACR_LOG
(
  dtmovimento_ems       DATE,
  dtmovimento_unicoo    DATE,
  txultima_falha        VARCHAR2(4000),
  num_id_tit_acr        NUMBER not null,
  num_id_movto_tit_acr  NUMBER not null,
  cod_ser_docto         VARCHAR2(6) not null,
  cod_tit_acr           VARCHAR2(10) not null,
  cod_parcela           VARCHAR2(6),
  val_liq_tit_acr       NUMBER(12,2),
  dat_vencto_tit_acr    DATE,
  val_ajust_val_tit_acr NUMBER(12,2),
  val_movto_tit_acr     NUMBER(12,2) not null,
  val_multa_tit_acr     NUMBER(12,2) not null,
  val_juros             NUMBER(12,2) not null,
  val_desconto          NUMBER(12,2) not null,
  val_abat_tit_acr      NUMBER(12,2) not null,
  val_despes_bcia       NUMBER(12,2),
  dat_cr_movto_tit_acr  DATE,
  dat_transacao         DATE not null,
  ind_trans_acr_abrev   VARCHAR2(6),
  cod_tit_acr_bco       VARCHAR2(20),
  cod_refer             VARCHAR2(10),
  cod_estab             VARCHAR2(6),
  cod_espec_docto       VARCHAR2(6),
  nrmovimento           NUMBER(10),
  ind_tip_espec_docto   VARCHAR2(17),
  nrregistro_titulo     NUMBER(8),
  nrdocumento           VARCHAR2(12),
  dat_liquidac_tit_acr  DATE
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.EMS_MOVIMENTO_TITULO_ACR_LOG
  add constraint PK_EMS_MOVTO_TITULO_ACR_LOG primary key (NUM_ID_MOVTO_TIT_ACR)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table EMS_TRANSACAO_ACR
prompt ================================
prompt
create table EMS506UNICOO.EMS_TRANSACAO_ACR
(
  cdtransacao VARCHAR2(6) not null,
  notransacao VARCHAR2(29),
  vlsinal     NUMBER(1),
  cdmovimento VARCHAR2(2),
  aodesconto  VARCHAR2(1) default 'N',
  cddesconto  VARCHAR2(2)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.EMS_TRANSACAO_ACR
  add constraint PK_EMS_TRANSACAO_ACR primary key (CDTRANSACAO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table ENCONTAS
prompt =======================
prompt
create table EMS506UNICOO.ENCONTAS
(
  cdn_camara            NUMBER,
  cdn_encontas          NUMBER not null,
  u##cod_estab          VARCHAR2(6) not null,
  cod_estab             VARCHAR2(6) not null,
  cod_fornecedor        NUMBER not null,
  cod_refer_acr         VARCHAR2(10),
  cod_refer_apb         VARCHAR2(10),
  cod_tit_encontas      VARCHAR2(10),
  codusuarioconfirmacao VARCHAR2(12),
  cod_usuario_criacao   VARCHAR2(12),
  des_encontas          VARCHAR2(30),
  dt_alteracao          DATE,
  dt_cancelamento       DATE,
  dt_confirmacao        DATE,
  dt_criacao_encontas   DATE,
  dt_vencimento         DATE,
  in_status_encontas    VARCHAR2(10),
  lg_modulo_encontro    NUMBER,
  num_id_encontas       NUMBER,
  vl_encontas           NUMBER,
  vl_saldo              NUMBER,
  progress_recid        NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create unique index EMS506UNICOO.ENCONTAS##ENCONTA on EMS506UNICOO.ENCONTAS (CDN_ENCONTAS, U##COD_ESTAB, COD_FORNECEDOR)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create unique index EMS506UNICOO.ENCONTAS##REC on EMS506UNICOO.ENCONTAS (PROGRESS_RECID)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table END_MIGRA
prompt ========================
prompt
create table EMS506UNICOO.END_MIGRA
(
  logra_unicoo VARCHAR2(40),
  compl_unicoo VARCHAR2(15),
  logra_totvs  VARCHAR2(40),
  compl_totvs  VARCHAR2(10),
  linha        NUMBER,
  nr_unicoo    VARCHAR2(6),
  nrregistro   NUMBER(10)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table ENDERECO_UNICOO
prompt ==============================
prompt
create table EMS506UNICOO.ENDERECO_UNICOO
(
  nrregistro            NUMBER(8) not null,
  tpendereco            VARCHAR2(4) not null,
  nologradouro          VARCHAR2(40),
  nrimovel              NUMBER(5),
  txcomplemento         VARCHAR2(15),
  nobairro              VARCHAR2(25),
  cdcidade              VARCHAR2(4),
  cdestado              VARCHAR2(2),
  nrcep                 VARCHAR2(8),
  nrtelefone            VARCHAR2(24),
  nrfax                 VARCHAR2(24),
  nocontato             VARCHAR2(30),
  nocargocontato        VARCHAR2(20),
  cdemail               VARCHAR2(40),
  txobservacoes         VARCHAR2(255),
  aocorrespondencia     VARCHAR2(1),
  nooperador            VARCHAR2(20),
  nrcelular             VARCHAR2(24),
  aosituacao            VARCHAR2(1),
  nrddd                 VARCHAR2(4),
  txreferencia_endereco VARCHAR2(60),
  aoreside_exterior     VARCHAR2(1),
  tplogradouro_ptu      VARCHAR2(2),
  cdemail_adicional     VARCHAR2(255)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.ENDERECO_UNICOO.txreferencia_endereco
  is 'Esse campo será um auxiliar do complemento do endereço.';
comment on column EMS506UNICOO.ENDERECO_UNICOO.aoreside_exterior
  is 'Informa se o usuario reside ou nco no exterior. Valores possmveis ''N'' - Nco reside; ''S'' - Reside.';
comment on column EMS506UNICOO.ENDERECO_UNICOO.tplogradouro_ptu
  is 'Tipo de Logradouro do PTU (Valores possíveis: tabela de código ''TIPO_LOGRADOURO_PTU'')';
comment on column EMS506UNICOO.ENDERECO_UNICOO.cdemail_adicional
  is 'Opção para um e-mail adicional';
alter table EMS506UNICOO.ENDERECO_UNICOO
  add constraint PK_ENDERECO primary key (NRREGISTRO, TPENDERECO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table ES_PARAM_RECIBO
prompt ==============================
prompt
create table EMS506UNICOO.ES_PARAM_RECIBO
(
  des_dir_rec_acr VARCHAR2(60),
  des_dir_rec_apb VARCHAR2(60),
  des_dir_darf    VARCHAR2(60),
  num_seq         NUMBER,
  num_seq_ap      NUMBER,
  num_seq_cr      NUMBER,
  num_seq_darf    NUMBER,
  livre_1         VARCHAR2(200),
  livre_2         VARCHAR2(200),
  progress_recid  NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create unique index EMS506UNICOO.ES_PARAM_RECIBO on EMS506UNICOO.ES_PARAM_RECIBO (PROGRESS_RECID)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create unique index EMS506UNICOO.ES_PARAM_RECIBO##ID on EMS506UNICOO.ES_PARAM_RECIBO (NUM_SEQ)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.ES_PARAM_RECIBO##SEQ_AP on EMS506UNICOO.ES_PARAM_RECIBO (NUM_SEQ_AP, PROGRESS_RECID)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.ES_PARAM_RECIBO##SEQ_CR on EMS506UNICOO.ES_PARAM_RECIBO (NUM_SEQ_CR, PROGRESS_RECID)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.ES_PARAM_RECIBO##SEQ_DARF on EMS506UNICOO.ES_PARAM_RECIBO (NUM_SEQ_DARF, PROGRESS_RECID)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table FORNEC_FINAC_EMS_BKP_2701
prompt ========================================
prompt
create table EMS506UNICOO.FORNEC_FINAC_EMS_BKP_2701
(
  u##cod_empresa         VARCHAR2(12) not null,
  cod_empresa            VARCHAR2(12) not null,
  cdn_fornecedor         NUMBER not null,
  u##cod_portador        VARCHAR2(12) not null,
  cod_portador           VARCHAR2(12) not null,
  cod_banco              VARCHAR2(16) not null,
  cod_agenc_bcia         VARCHAR2(20) not null,
  cod_digito_agenc_bcia  VARCHAR2(12) not null,
  cod_cta_corren_bco     VARCHAR2(40) not null,
  cod_digito_cta_corren  VARCHAR2(12) not null,
  u##cod_forma_pagto     VARCHAR2(12),
  cod_forma_pagto        VARCHAR2(12),
  u##cod_tip_fornec      VARCHAR2(16) not null,
  cod_tip_fornec         VARCHAR2(16) not null,
  cod_tip_fluxo_financ   VARCHAR2(24) not null,
  ind_tratam_vencto_sab  VARCHAR2(16) not null,
  ind_tratam_vencto_dom  VARCHAR2(16) not null,
  ind_tratam_vencto_fer  VARCHAR2(16) not null,
  indpagtojurosfornecap  VARCHAR2(16) not null,
  ind_tip_fornecto       VARCHAR2(16) not null,
  ind_armaz_val_pagto    VARCHAR2(24) not null,
  log_fornec_serv_export NUMBER not null,
  log_pagto_bloqdo       NUMBER not null,
  log_retenc_impto       NUMBER not null,
  dat_ult_impl_tit_ap    DATE,
  dat_ult_pagto          DATE,
  dat_impl_maior_tit_ap  DATE,
  num_antecip_aber       NUMBER,
  num_tit_ap_aber        NUMBER,
  val_tit_ap_maior_val   NUMBER,
  valtitapmaiorvalaber   NUMBER,
  val_sdo_antecip_aber   NUMBER,
  val_sdo_tit_ap_aber    NUMBER not null,
  cod_livre_1            VARCHAR2(500),
  log_livre_1            NUMBER,
  num_livre_1            NUMBER,
  val_livre_1            NUMBER,
  dat_livre_1            DATE,
  val_ult_impl_tit_ap    NUMBER not null,
  num_rendto_tribut      NUMBER not null,
  logvenctodianaoutil    NUMBER not null,
  val_percent_bonif      NUMBER not null,
  log_indic_rendto       NUMBER not null,
  num_dias_compcao       NUMBER not null,
  log_envio_bco_histor   NUMBER not null,
  log_retenc_impto_pagto NUMBER not null,
  cod_livre_2            VARCHAR2(500),
  dat_livre_2            DATE,
  log_livre_2            NUMBER,
  num_livre_2            NUMBER,
  val_livre_2            NUMBER,
  cdd_version            NUMBER,
  log_assoc_desport      NUMBER,
  log_cooperat           NUMBER,
  progress_recid         NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table FORNEC_FINANC_EMS_BKP
prompt ====================================
prompt
create table EMS506UNICOO.FORNEC_FINANC_EMS_BKP
(
  u##cod_empresa         VARCHAR2(12) not null,
  cod_empresa            VARCHAR2(12) not null,
  cdn_fornecedor         NUMBER not null,
  u##cod_portador        VARCHAR2(12) not null,
  cod_portador           VARCHAR2(12) not null,
  cod_banco              VARCHAR2(16) not null,
  cod_agenc_bcia         VARCHAR2(20) not null,
  cod_digito_agenc_bcia  VARCHAR2(12) not null,
  cod_cta_corren_bco     VARCHAR2(40) not null,
  cod_digito_cta_corren  VARCHAR2(12) not null,
  u##cod_forma_pagto     VARCHAR2(12),
  cod_forma_pagto        VARCHAR2(12),
  u##cod_tip_fornec      VARCHAR2(16) not null,
  cod_tip_fornec         VARCHAR2(16) not null,
  cod_tip_fluxo_financ   VARCHAR2(24) not null,
  ind_tratam_vencto_sab  VARCHAR2(16) not null,
  ind_tratam_vencto_dom  VARCHAR2(16) not null,
  ind_tratam_vencto_fer  VARCHAR2(16) not null,
  indpagtojurosfornecap  VARCHAR2(16) not null,
  ind_tip_fornecto       VARCHAR2(16) not null,
  ind_armaz_val_pagto    VARCHAR2(24) not null,
  log_fornec_serv_export NUMBER not null,
  log_pagto_bloqdo       NUMBER not null,
  log_retenc_impto       NUMBER not null,
  dat_ult_impl_tit_ap    DATE,
  dat_ult_pagto          DATE,
  dat_impl_maior_tit_ap  DATE,
  num_antecip_aber       NUMBER,
  num_tit_ap_aber        NUMBER,
  val_tit_ap_maior_val   NUMBER,
  valtitapmaiorvalaber   NUMBER,
  val_sdo_antecip_aber   NUMBER,
  val_sdo_tit_ap_aber    NUMBER not null,
  cod_livre_1            VARCHAR2(500),
  log_livre_1            NUMBER,
  num_livre_1            NUMBER,
  val_livre_1            NUMBER,
  dat_livre_1            DATE,
  val_ult_impl_tit_ap    NUMBER not null,
  num_rendto_tribut      NUMBER not null,
  logvenctodianaoutil    NUMBER not null,
  val_percent_bonif      NUMBER not null,
  log_indic_rendto       NUMBER not null,
  num_dias_compcao       NUMBER not null,
  log_envio_bco_histor   NUMBER not null,
  log_retenc_impto_pagto NUMBER not null,
  cod_livre_2            VARCHAR2(500),
  dat_livre_2            DATE,
  log_livre_2            NUMBER,
  num_livre_2            NUMBER,
  val_livre_2            NUMBER,
  cdd_version            NUMBER,
  log_assoc_desport      NUMBER,
  log_cooperat           NUMBER,
  progress_recid         NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table FORNEC_FINANC_EMS_BKP_2
prompt ======================================
prompt
create table EMS506UNICOO.FORNEC_FINANC_EMS_BKP_2
(
  u##cod_empresa         VARCHAR2(12) not null,
  cod_empresa            VARCHAR2(12) not null,
  cdn_fornecedor         NUMBER not null,
  u##cod_portador        VARCHAR2(12) not null,
  cod_portador           VARCHAR2(12) not null,
  cod_banco              VARCHAR2(16) not null,
  cod_agenc_bcia         VARCHAR2(20) not null,
  cod_digito_agenc_bcia  VARCHAR2(12) not null,
  cod_cta_corren_bco     VARCHAR2(40) not null,
  cod_digito_cta_corren  VARCHAR2(12) not null,
  u##cod_forma_pagto     VARCHAR2(12),
  cod_forma_pagto        VARCHAR2(12),
  u##cod_tip_fornec      VARCHAR2(16) not null,
  cod_tip_fornec         VARCHAR2(16) not null,
  cod_tip_fluxo_financ   VARCHAR2(24) not null,
  ind_tratam_vencto_sab  VARCHAR2(16) not null,
  ind_tratam_vencto_dom  VARCHAR2(16) not null,
  ind_tratam_vencto_fer  VARCHAR2(16) not null,
  indpagtojurosfornecap  VARCHAR2(16) not null,
  ind_tip_fornecto       VARCHAR2(16) not null,
  ind_armaz_val_pagto    VARCHAR2(24) not null,
  log_fornec_serv_export NUMBER not null,
  log_pagto_bloqdo       NUMBER not null,
  log_retenc_impto       NUMBER not null,
  dat_ult_impl_tit_ap    DATE,
  dat_ult_pagto          DATE,
  dat_impl_maior_tit_ap  DATE,
  num_antecip_aber       NUMBER,
  num_tit_ap_aber        NUMBER,
  val_tit_ap_maior_val   NUMBER,
  valtitapmaiorvalaber   NUMBER,
  val_sdo_antecip_aber   NUMBER,
  val_sdo_tit_ap_aber    NUMBER not null,
  cod_livre_1            VARCHAR2(500),
  log_livre_1            NUMBER,
  num_livre_1            NUMBER,
  val_livre_1            NUMBER,
  dat_livre_1            DATE,
  val_ult_impl_tit_ap    NUMBER not null,
  num_rendto_tribut      NUMBER not null,
  logvenctodianaoutil    NUMBER not null,
  val_percent_bonif      NUMBER not null,
  log_indic_rendto       NUMBER not null,
  num_dias_compcao       NUMBER not null,
  log_envio_bco_histor   NUMBER not null,
  log_retenc_impto_pagto NUMBER not null,
  cod_livre_2            VARCHAR2(500),
  dat_livre_2            DATE,
  log_livre_2            NUMBER,
  num_livre_2            NUMBER,
  val_livre_2            NUMBER,
  cdd_version            NUMBER,
  log_assoc_desport      NUMBER,
  log_cooperat           NUMBER,
  progress_recid         NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table FORNECEDOR_EMS_BKP
prompt =================================
prompt
create table EMS506UNICOO.FORNECEDOR_EMS_BKP
(
  u##cod_empresa         VARCHAR2(12) not null,
  cod_empresa            VARCHAR2(12) not null,
  cdn_fornecedor         NUMBER not null,
  u##nom_pessoa          VARCHAR2(80) not null,
  nom_pessoa             VARCHAR2(80) not null,
  num_pessoa             NUMBER,
  u##nom_abrev           VARCHAR2(30) not null,
  nom_abrev              VARCHAR2(30) not null,
  u##cod_pais            VARCHAR2(12) not null,
  cod_pais               VARCHAR2(12) not null,
  u##cod_id_feder        VARCHAR2(40) not null,
  cod_id_feder           VARCHAR2(40) not null,
  u##cod_grp_fornec      VARCHAR2(12) not null,
  cod_grp_fornec         VARCHAR2(12) not null,
  u##cod_tip_fornec      VARCHAR2(16) not null,
  cod_tip_fornec         VARCHAR2(16) not null,
  dat_impl_fornec        DATE not null,
  log_ems_20_atlzdo      NUMBER not null,
  cod_livre_1            VARCHAR2(500),
  log_livre_1            NUMBER,
  num_livre_1            NUMBER,
  val_livre_1            NUMBER,
  dat_livre_1            DATE,
  log_cr_pis             NUMBER not null,
  log_control_inss       NUMBER not null,
  log_cr_cofins          NUMBER not null,
  cdn_classif_fornec     NUMBER,
  log_retenc_impto_pagto NUMBER not null,
  cod_livre_2            VARCHAR2(500),
  dat_livre_2            DATE,
  log_livre_2            NUMBER,
  num_livre_2            NUMBER,
  val_livre_2            NUMBER,
  cdd_version            NUMBER,
  log_replic_emit_hcm    NUMBER,
  log_replic_emit_gps    NUMBER,
  log_replic_emit_crm    NUMBER,
  log_replic_emit_financ NUMBER,
  log_replic_emit_erp    NUMBER,
  progress_recid         NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table FORNECEDOR_EMS_BKP_2
prompt ===================================
prompt
create table EMS506UNICOO.FORNECEDOR_EMS_BKP_2
(
  u##cod_empresa         VARCHAR2(12) not null,
  cod_empresa            VARCHAR2(12) not null,
  cdn_fornecedor         NUMBER not null,
  u##nom_pessoa          VARCHAR2(80) not null,
  nom_pessoa             VARCHAR2(80) not null,
  num_pessoa             NUMBER,
  u##nom_abrev           VARCHAR2(30) not null,
  nom_abrev              VARCHAR2(30) not null,
  u##cod_pais            VARCHAR2(12) not null,
  cod_pais               VARCHAR2(12) not null,
  u##cod_id_feder        VARCHAR2(40) not null,
  cod_id_feder           VARCHAR2(40) not null,
  u##cod_grp_fornec      VARCHAR2(12) not null,
  cod_grp_fornec         VARCHAR2(12) not null,
  u##cod_tip_fornec      VARCHAR2(16) not null,
  cod_tip_fornec         VARCHAR2(16) not null,
  dat_impl_fornec        DATE not null,
  log_ems_20_atlzdo      NUMBER not null,
  cod_livre_1            VARCHAR2(500),
  log_livre_1            NUMBER,
  num_livre_1            NUMBER,
  val_livre_1            NUMBER,
  dat_livre_1            DATE,
  log_cr_pis             NUMBER not null,
  log_control_inss       NUMBER not null,
  log_cr_cofins          NUMBER not null,
  cdn_classif_fornec     NUMBER,
  log_retenc_impto_pagto NUMBER not null,
  cod_livre_2            VARCHAR2(500),
  dat_livre_2            DATE,
  log_livre_2            NUMBER,
  num_livre_2            NUMBER,
  val_livre_2            NUMBER,
  cdd_version            NUMBER,
  log_replic_emit_hcm    NUMBER,
  log_replic_emit_gps    NUMBER,
  log_replic_emit_crm    NUMBER,
  log_replic_emit_financ NUMBER,
  log_replic_emit_erp    NUMBER,
  progress_recid         NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table FORNECEDOR_EMS_BKP_2701
prompt ======================================
prompt
create table EMS506UNICOO.FORNECEDOR_EMS_BKP_2701
(
  u##cod_empresa         VARCHAR2(12) not null,
  cod_empresa            VARCHAR2(12) not null,
  cdn_fornecedor         NUMBER not null,
  u##nom_pessoa          VARCHAR2(80) not null,
  nom_pessoa             VARCHAR2(80) not null,
  num_pessoa             NUMBER,
  u##nom_abrev           VARCHAR2(30) not null,
  nom_abrev              VARCHAR2(30) not null,
  u##cod_pais            VARCHAR2(12) not null,
  cod_pais               VARCHAR2(12) not null,
  u##cod_id_feder        VARCHAR2(40) not null,
  cod_id_feder           VARCHAR2(40) not null,
  u##cod_grp_fornec      VARCHAR2(12) not null,
  cod_grp_fornec         VARCHAR2(12) not null,
  u##cod_tip_fornec      VARCHAR2(16) not null,
  cod_tip_fornec         VARCHAR2(16) not null,
  dat_impl_fornec        DATE not null,
  log_ems_20_atlzdo      NUMBER not null,
  cod_livre_1            VARCHAR2(500),
  log_livre_1            NUMBER,
  num_livre_1            NUMBER,
  val_livre_1            NUMBER,
  dat_livre_1            DATE,
  log_cr_pis             NUMBER not null,
  log_control_inss       NUMBER not null,
  log_cr_cofins          NUMBER not null,
  cdn_classif_fornec     NUMBER,
  log_retenc_impto_pagto NUMBER not null,
  cod_livre_2            VARCHAR2(500),
  dat_livre_2            DATE,
  log_livre_2            NUMBER,
  num_livre_2            NUMBER,
  val_livre_2            NUMBER,
  cdd_version            NUMBER,
  log_replic_emit_hcm    NUMBER,
  log_replic_emit_gps    NUMBER,
  log_replic_emit_crm    NUMBER,
  log_replic_emit_financ NUMBER,
  log_replic_emit_erp    NUMBER,
  progress_recid         NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table IMPTO_VINCUL_FORNEC_BKP
prompt ======================================
prompt
create table EMS506UNICOO.IMPTO_VINCUL_FORNEC_BKP
(
  u##cod_empresa       VARCHAR2(12) not null,
  cod_empresa          VARCHAR2(12) not null,
  cdn_fornecedor       NUMBER not null,
  u##cod_pais          VARCHAR2(12) not null,
  cod_pais             VARCHAR2(12) not null,
  u##cod_unid_federac  VARCHAR2(12) not null,
  cod_unid_federac     VARCHAR2(12) not null,
  u##cod_imposto       VARCHAR2(12) not null,
  cod_imposto          VARCHAR2(12) not null,
  u##cod_classif_impto VARCHAR2(12) not null,
  cod_classif_impto    VARCHAR2(12) not null,
  log_impto_opcnal     NUMBER not null,
  cod_livre_1          VARCHAR2(500),
  log_livre_1          NUMBER,
  num_livre_1          NUMBER,
  val_livre_1          NUMBER,
  dat_livre_1          DATE,
  numreduzrendtotribut NUMBER not null,
  cod_livre_2          VARCHAR2(500),
  dat_livre_2          DATE,
  log_livre_2          NUMBER,
  num_livre_2          NUMBER,
  val_livre_2          NUMBER,
  cdd_version          NUMBER,
  progress_recid       NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table JOSIAS_IMPOSTO
prompt =============================
prompt
create table EMS506UNICOO.JOSIAS_IMPOSTO
(
  u##cod_empresa       VARCHAR2(4000),
  cod_empresa          VARCHAR2(4000),
  cdn_fornecedor       NUMBER(10),
  u##cod_pais          VARCHAR2(4000),
  cod_pais             VARCHAR2(4000),
  u##cod_unid_federac  VARCHAR2(3),
  cod_unid_federac     VARCHAR2(3),
  u##cod_imposto       VARCHAR2(4000),
  cod_imposto          VARCHAR2(4000),
  u##cod_classif_impto VARCHAR2(4000),
  cod_classif_impto    VARCHAR2(4000),
  log_impto_opcnal     NUMBER,
  cod_livre_1          CHAR(1),
  log_livre_1          NUMBER,
  num_livre_1          NUMBER,
  val_livre_1          NUMBER,
  dat_livre_1          DATE,
  numreduzrendtotribut NUMBER,
  cod_livre_2          CHAR(1),
  dat_livre_2          CHAR(1),
  log_livre_2          NUMBER,
  num_livre_2          NUMBER,
  val_livre_2          NUMBER,
  cdd_version          NUMBER,
  progress_recid       NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table LG$_CLIENTE
prompt ==========================
prompt
create table EMS506UNICOO.LG$_CLIENTE
(
  dtatualizacao$$   DATE not null,
  nrsequencia$$     NUMBER not null,
  tpoperacao$$      VARCHAR2(1) not null,
  nousuario$$       VARCHAR2(30) not null,
  nousuario_rede$$  VARCHAR2(30),
  nomaquina$$       VARCHAR2(64),
  noprograma$$      VARCHAR2(48),
  u##cod_empresa    VARCHAR2(6),
  cod_empresa       VARCHAR2(6),
  cdn_cliente       NUMBER,
  u##nom_pessoa     VARCHAR2(40),
  nom_pessoa        VARCHAR2(40),
  num_pessoa        NUMBER,
  u##nom_abrev      VARCHAR2(15),
  nom_abrev         VARCHAR2(15),
  u##cod_pais       VARCHAR2(6),
  cod_pais          VARCHAR2(6),
  u##cod_id_feder   VARCHAR2(20),
  cod_id_feder      VARCHAR2(20),
  u##cod_grp_clien  VARCHAR2(6),
  cod_grp_clien     VARCHAR2(6),
  u##cod_tip_clien  VARCHAR2(8),
  cod_tip_clien     VARCHAR2(8),
  dat_impl_clien    DATE,
  log_ems_20_atlzdo NUMBER,
  cod_livre_1       VARCHAR2(100),
  log_livre_1       NUMBER,
  num_livre_1       NUMBER,
  val_livre_1       NUMBER,
  dat_livre_1       DATE,
  cod_livre_2       VARCHAR2(100),
  dat_livre_2       DATE,
  log_livre_2       NUMBER,
  num_livre_2       NUMBER,
  val_livre_2       NUMBER,
  progress_recid    NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.LG$_CLIENTE
  add constraint PK_LG$_CLIENTE primary key (NRSEQUENCIA$$, TPOPERACAO$$)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table LG$_FORNECEDOR
prompt =============================
prompt
create table EMS506UNICOO.LG$_FORNECEDOR
(
  dtatualizacao$$        DATE not null,
  nrsequencia$$          NUMBER not null,
  tpoperacao$$           VARCHAR2(1) not null,
  nousuario$$            VARCHAR2(30) not null,
  nousuario_rede$$       VARCHAR2(30),
  nomaquina$$            VARCHAR2(64),
  noprograma$$           VARCHAR2(48),
  u##cod_empresa         VARCHAR2(6),
  cod_empresa            VARCHAR2(6),
  cdn_fornecedor         NUMBER,
  u##nom_pessoa          VARCHAR2(40),
  nom_pessoa             VARCHAR2(40),
  num_pessoa             NUMBER,
  u##nom_abrev           VARCHAR2(15),
  nom_abrev              VARCHAR2(15),
  u##cod_pais            VARCHAR2(6),
  cod_pais               VARCHAR2(6),
  u##cod_id_feder        VARCHAR2(20),
  cod_id_feder           VARCHAR2(20),
  u##cod_grp_fornec      VARCHAR2(6),
  cod_grp_fornec         VARCHAR2(6),
  u##cod_tip_fornec      VARCHAR2(8),
  cod_tip_fornec         VARCHAR2(8),
  dat_impl_fornec        DATE,
  log_ems_20_atlzdo      NUMBER,
  cod_livre_1            VARCHAR2(100),
  log_livre_1            NUMBER,
  num_livre_1            NUMBER,
  val_livre_1            NUMBER,
  dat_livre_1            DATE,
  log_cr_pis             NUMBER,
  log_control_inss       NUMBER,
  log_cr_cofins          NUMBER,
  cdn_classif_fornec     NUMBER,
  log_retenc_impto_pagto NUMBER,
  cod_livre_2            VARCHAR2(100),
  dat_livre_2            DATE,
  log_livre_2            NUMBER,
  num_livre_2            NUMBER,
  val_livre_2            NUMBER,
  progress_recid         NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.LG$_FORNECEDOR
  add constraint PK_LG$_FORNECEDOR primary key (NRSEQUENCIA$$, TPOPERACAO$$)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table LG$_MOVTO_CTA_CORREN
prompt ===================================
prompt
create table EMS506UNICOO.LG$_MOVTO_CTA_CORREN
(
  dtatualizacao$$         DATE not null,
  nrsequencia$$           NUMBER not null,
  tpoperacao$$            VARCHAR2(1) not null,
  nousuario$$             VARCHAR2(30) not null,
  nousuario_rede$$        VARCHAR2(30),
  nomaquina$$             VARCHAR2(64),
  noprograma$$            VARCHAR2(48),
  u##cod_cta_corren       VARCHAR2(20),
  cod_cta_corren          VARCHAR2(20),
  dat_movto_cta_corren    DATE,
  numseqmovtoctacorren    NUMBER,
  cod_cenar_ctbl          VARCHAR2(16),
  cod_indic_econ          VARCHAR2(16),
  u##cod_tip_trans_cx     VARCHAR2(16),
  cod_tip_trans_cx        VARCHAR2(16),
  cod_histor_padr         VARCHAR2(16),
  u##coddoctomovtoctabco  VARCHAR2(40),
  coddoctomovtoctabco     VARCHAR2(40),
  cod_usuar_ult_atualiz   VARCHAR2(24),
  codusuaremisavisolancto VARCHAR2(16),
  cod_modul_dtsul         VARCHAR2(12),
  dat_transacao           DATE,
  dat_emis_aviso_lancto   DATE,
  dat_ult_atualiz         DATE,
  deshistormovtoctacorren VARCHAR2(2000),
  deshistormovtoconcil    VARCHAR2(2000),
  indfluxomovtoctacorren  VARCHAR2(12),
  u##indtipmovtoctacorren VARCHAR2(12),
  indtipmovtoctacorren    VARCHAR2(12),
  indorigimptomovtofinanc VARCHAR2(12),
  indsitconcilmovtocta    VARCHAR2(12),
  indligacconcilctacorren VARCHAR2(12),
  indemisdoctotransfbcia  VARCHAR2(34),
  val_movto_cta_corren    NUMBER,
  valimptomovtoctacorren  NUMBER,
  valpendconcilctacorren  NUMBER,
  logmovtoctacorrenautom  NUMBER,
  log_concil_cta_corren   NUMBER,
  logctbzmovtoctacorren   NUMBER,
  numidmovtoctatransf     NUMBER,
  numidmovtoctacorren     NUMBER,
  num_id_movto_cta_impto  NUMBER,
  numidmovtoorigmutuo     NUMBER,
  num_id_cheq             NUMBER,
  numidmovtoctaestorn     NUMBER,
  numcalcencargoctacorren NUMBER,
  numavisolanctoctacorren NUMBER,
  hra_emis_aviso_lancto   VARCHAR2(16),
  hra_ult_atualiz         VARCHAR2(16),
  cod_livre_1             VARCHAR2(500),
  numidmovtodespesbcia    NUMBER,
  dat_prev_orig           DATE,
  cod_estab_bord          VARCHAR2(12),
  log_sdo_bco_histor      NUMBER,
  cod_usuar_gerac_ctbz    VARCHAR2(24),
  dat_gerac_ctbz          DATE,
  hra_gerac_ctbz          VARCHAR2(16),
  cod_livre_2             VARCHAR2(500),
  dat_livre_1             DATE,
  dat_livre_2             DATE,
  log_livre_1             NUMBER,
  log_livre_2             NUMBER,
  num_livre_1             NUMBER,
  num_livre_2             NUMBER,
  val_livre_1             NUMBER,
  val_livre_2             NUMBER,
  progress_recid          NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.LG$_MOVTO_CTA_CORREN
  add constraint PK_LG$_MOVTO_CTA_CORREN primary key (NRSEQUENCIA$$, TPOPERACAO$$)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table LG$_PESSOA_FISIC
prompt ===============================
prompt
create table EMS506UNICOO.LG$_PESSOA_FISIC
(
  dtatualizacao$$            DATE not null,
  nrsequencia$$              NUMBER not null,
  tpoperacao$$               VARCHAR2(1) not null,
  nousuario$$                VARCHAR2(30) not null,
  nousuario_rede$$           VARCHAR2(30),
  nomaquina$$                VARCHAR2(64),
  noprograma$$               VARCHAR2(48),
  num_pessoa_fisic           NUMBER,
  u##nom_pessoa              VARCHAR2(40),
  nom_pessoa                 VARCHAR2(40),
  u##cod_id_feder            VARCHAR2(20),
  cod_id_feder               VARCHAR2(20),
  u##cod_id_estad_fisic      VARCHAR2(20),
  cod_id_estad_fisic         VARCHAR2(20),
  codorgaoemisidestad        VARCHAR2(10),
  u##codunidfederacemisestad VARCHAR2(6),
  codunidfederacemisestad    VARCHAR2(6),
  nom_endereco               VARCHAR2(40),
  nom_ender_compl            VARCHAR2(10),
  nom_bairro                 VARCHAR2(20),
  nom_cidade                 VARCHAR2(32),
  nom_condado                VARCHAR2(32),
  u##cod_pais                VARCHAR2(6),
  cod_pais                   VARCHAR2(6),
  u##cod_unid_federac        VARCHAR2(6),
  cod_unid_federac           VARCHAR2(6),
  cod_cep                    VARCHAR2(20),
  cod_cx_post                VARCHAR2(20),
  cod_telefone               VARCHAR2(20),
  cod_ramal                  VARCHAR2(7),
  cod_fax                    VARCHAR2(20),
  cod_ramal_fax              VARCHAR2(7),
  cod_telex                  VARCHAR2(7),
  cod_modem                  VARCHAR2(20),
  cod_ramal_modem            VARCHAR2(7),
  cod_e_mail                 VARCHAR2(40),
  dat_nasc_pessoa_fisic      DATE,
  cod_pais_nasc              VARCHAR2(6),
  cod_unid_federac_nasc      VARCHAR2(6),
  des_anot_tab               VARCHAR2(2000),
  cod_usuar_ult_atualiz      VARCHAR2(12),
  dat_ult_atualiz            DATE,
  hra_ult_atualiz            VARCHAR2(8),
  u##nom_mae_pessoa          VARCHAR2(40),
  nom_mae_pessoa             VARCHAR2(40),
  cod_imagem                 VARCHAR2(30),
  log_ems_20_atlzdo          NUMBER,
  cod_livre_1                VARCHAR2(100),
  log_livre_1                NUMBER,
  num_livre_1                NUMBER,
  val_livre_1                NUMBER,
  dat_livre_1                DATE,
  ind_tip_pessoa_fisic       VARCHAR2(15),
  nomnacionpessoafisic       VARCHAR2(40),
  nomprofispessoafisic       VARCHAR2(40),
  indestadocivilpessoa       VARCHAR2(10),
  nom_home_page              VARCHAR2(40),
  nom_ender_text             VARCHAR2(2000),
  log_envio_bco_histor       NUMBER,
  cod_livre_2                VARCHAR2(100),
  dat_livre_2                DATE,
  log_livre_2                NUMBER,
  num_livre_2                NUMBER,
  val_livre_2                NUMBER,
  progress_recid             NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.LG$_PESSOA_FISIC
  add constraint PK_LG$_PESSOA_FISIC primary key (NRSEQUENCIA$$, TPOPERACAO$$)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table LG$_PESSOA_JURID
prompt ===============================
prompt
create table EMS506UNICOO.LG$_PESSOA_JURID
(
  dtatualizacao$$           DATE not null,
  nrsequencia$$             NUMBER not null,
  tpoperacao$$              VARCHAR2(1) not null,
  nousuario$$               VARCHAR2(30) not null,
  nousuario_rede$$          VARCHAR2(30),
  nomaquina$$               VARCHAR2(64),
  noprograma$$              VARCHAR2(48),
  num_pessoa_jurid          NUMBER,
  u##nom_pessoa             VARCHAR2(40),
  nom_pessoa                VARCHAR2(40),
  u##cod_id_feder           VARCHAR2(20),
  cod_id_feder              VARCHAR2(20),
  cod_id_estad_jurid        VARCHAR2(20),
  cod_id_munic_jurid        VARCHAR2(20),
  u##cod_id_previd_social   VARCHAR2(20),
  cod_id_previd_social      VARCHAR2(20),
  log_fins_lucrat           NUMBER,
  numpessoajuridmatriz      NUMBER,
  nom_endereco              VARCHAR2(40),
  nom_ender_compl           VARCHAR2(10),
  nom_bairro                VARCHAR2(20),
  nom_cidade                VARCHAR2(32),
  nom_condado               VARCHAR2(32),
  u##cod_pais               VARCHAR2(6),
  cod_pais                  VARCHAR2(6),
  u##cod_unid_federac       VARCHAR2(6),
  cod_unid_federac          VARCHAR2(6),
  cod_cep                   VARCHAR2(20),
  cod_cx_post               VARCHAR2(20),
  cod_telefone              VARCHAR2(20),
  cod_fax                   VARCHAR2(20),
  cod_ramal_fax             VARCHAR2(7),
  cod_telex                 VARCHAR2(7),
  cod_modem                 VARCHAR2(20),
  cod_ramal_modem           VARCHAR2(7),
  cod_e_mail                VARCHAR2(40),
  cod_e_mail_cobr           VARCHAR2(40),
  num_pessoa_jurid_cobr     NUMBER,
  nom_ender_cobr            VARCHAR2(40),
  nom_ender_compl_cobr      VARCHAR2(10),
  nom_bairro_cobr           VARCHAR2(20),
  nom_cidad_cobr            VARCHAR2(32),
  nom_condad_cobr           VARCHAR2(32),
  u##cod_unid_federac_cobr  VARCHAR2(6),
  cod_unid_federac_cobr     VARCHAR2(6),
  u##cod_pais_cobr          VARCHAR2(6),
  cod_pais_cobr             VARCHAR2(6),
  cod_cep_cobr              VARCHAR2(20),
  cod_cx_post_cobr          VARCHAR2(20),
  num_pessoa_jurid_pagto    NUMBER,
  nom_ender_pagto           VARCHAR2(40),
  nom_ender_compl_pagto     VARCHAR2(10),
  nom_bairro_pagto          VARCHAR2(20),
  nom_cidad_pagto           VARCHAR2(32),
  nom_condad_pagto          VARCHAR2(32),
  u##cod_pais_pagto         VARCHAR2(6),
  cod_pais_pagto            VARCHAR2(6),
  u##cod_unid_federac_pagto VARCHAR2(6),
  cod_unid_federac_pagto    VARCHAR2(6),
  cod_cep_pagto             VARCHAR2(20),
  cod_cx_post_pagto         VARCHAR2(20),
  des_anot_tab              VARCHAR2(2000),
  ind_tip_pessoa_jurid      VARCHAR2(8),
  indtipcapitpessoajurid    VARCHAR2(13),
  cod_usuar_ult_atualiz     VARCHAR2(12),
  dat_ult_atualiz           DATE,
  hra_ult_atualiz           VARCHAR2(8),
  cod_imagem                VARCHAR2(30),
  log_ems_20_atlzdo         NUMBER,
  cod_livre_1               VARCHAR2(100),
  log_livre_1               NUMBER,
  num_livre_1               NUMBER,
  val_livre_1               NUMBER,
  dat_livre_1               DATE,
  nom_home_page             VARCHAR2(40),
  nom_ender_text            VARCHAR2(2000),
  nom_ender_cobr_text       VARCHAR2(2000),
  nom_ender_pagto_text      VARCHAR2(2000),
  log_envio_bco_histor      NUMBER,
  cod_livre_2               VARCHAR2(100),
  dat_livre_2               DATE,
  log_livre_2               NUMBER,
  num_livre_2               NUMBER,
  val_livre_2               NUMBER,
  progress_recid            NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.LG$_PESSOA_JURID
  add constraint PK_LG$_PESSOA_JURID primary key (NRSEQUENCIA$$, TPOPERACAO$$)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table LG$_TI_CONTROLE_INTEGRACAO
prompt =========================================
prompt
create table EMS506UNICOO.LG$_TI_CONTROLE_INTEGRACAO
(
  dtatualizacao$$               DATE not null,
  nrsequencia$$                 NUMBER not null,
  tpoperacao$$                  VARCHAR2(1) not null,
  nousuario$$                   VARCHAR2(30) not null,
  nousuario_rede$$              VARCHAR2(30),
  nomaquina$$                   VARCHAR2(64),
  noprograma$$                  VARCHAR2(48),
  nrsequencial                  NUMBER(10),
  tpintegracao                  VARCHAR2(2),
  dtgeracao                     DATE,
  nrsequencial_origem           NUMBER(10),
  dtprocessamento               DATE,
  dtintegracao                  DATE,
  cdacao                        VARCHAR2(1),
  cdidentificador               VARCHAR2(40),
  txobservacao                  VARCHAR2(500),
  cdsituacao                    VARCHAR2(2),
  nrseq_controle_integracao_org NUMBER(10),
  cdempresa                     VARCHAR2(5),
  cdmodulo                      VARCHAR2(4),
  cdmovimento                   VARCHAR2(4),
  nrsessao                      NUMBER(10),
  cddivisao                     VARCHAR2(4),
  cdcentro_custo                VARCHAR2(4)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.LG$_TI_CONTROLE_INTEGRACAO
  add constraint PK_LG$_TI_CONTROLE_INTEGRACAO primary key (NRSEQUENCIA$$, TPOPERACAO$$)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table LOG_RECEBIMENTO_RECIBO
prompt =====================================
prompt
create table EMS506UNICOO.LOG_RECEBIMENTO_RECIBO
(
  ds_usuario_rede VARCHAR2(100),
  ds_computador   VARCHAR2(100),
  ds_programa     VARCHAR2(100),
  dt_geracao      DATE,
  cod_refer       VARCHAR2(10),
  ao_impresso     VARCHAR2(1) default 'N',
  cod_estab_refer VARCHAR2(6),
  cod_cliente     NUMBER,
  ao_ativo        VARCHAR2(1) default 'S',
  progress_recid  NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.LOG_RECEBIMENTO_RECIBO.ds_usuario_rede
  is 'NOME DO USUARIO LOGADO NA REDE';
comment on column EMS506UNICOO.LOG_RECEBIMENTO_RECIBO.ds_computador
  is 'DESCRICAO DO COMPUTADOR QUE ORIGINOU O RECIBO';
comment on column EMS506UNICOO.LOG_RECEBIMENTO_RECIBO.ds_programa
  is 'PROGRAMA QUE ORIGINOU O RECIBO';
comment on column EMS506UNICOO.LOG_RECEBIMENTO_RECIBO.dt_geracao
  is 'DATA DA GERACAO DO MOVIMENTO';
comment on column EMS506UNICOO.LOG_RECEBIMENTO_RECIBO.cod_refer
  is 'CODIGO MOVIMENTO LOTE_LIQUID_ACR';
comment on column EMS506UNICOO.LOG_RECEBIMENTO_RECIBO.ao_impresso
  is 'INDICA SE O RECIBO FOI IMPRESSO';
comment on column EMS506UNICOO.LOG_RECEBIMENTO_RECIBO.cod_estab_refer
  is 'CHAVE RELACIONAMENTO COM LOTE_LIQUID_ACR';
comment on column EMS506UNICOO.LOG_RECEBIMENTO_RECIBO.cod_cliente
  is 'CODIGO DO CLIENTE';
comment on column EMS506UNICOO.LOG_RECEBIMENTO_RECIBO.ao_ativo
  is 'INDICADOR SE A LIQUIDACAO ESTA ATIVA OU FOI ESTORNADA';
comment on column EMS506UNICOO.LOG_RECEBIMENTO_RECIBO.progress_recid
  is 'PROGRESS_RECID DA TABELA EMS506PORO9P10104MFIN.MOVTO_TIT_ACR';
create index EMS506UNICOO.PK_LOG_RECEBIMENTO_RECIBO on EMS506UNICOO.LOG_RECEBIMENTO_RECIBO (COD_ESTAB_REFER, COD_CLIENTE, COD_REFER)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table MENSAGEM_MONITOR_EVENTOS
prompt =======================================
prompt
create table EMS506UNICOO.MENSAGEM_MONITOR_EVENTOS
(
  dt_criacao      DATE,
  ds_rotina       VARCHAR2(60),
  dt_enviar       VARCHAR2(60),
  ds_remetente    VARCHAR2(60),
  ds_destinatario VARCHAR2(60),
  ds_assunto      VARCHAR2(60),
  ds_mensagem     VARCHAR2(60)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table MOVIMENTO_RETORNO_TITULO_ACR
prompt ===========================================
prompt
create table EMS506UNICOO.MOVIMENTO_RETORNO_TITULO_ACR
(
  nrsequencial           NUMBER(8) not null,
  nrseq_controle         NUMBER(8),
  cod_refer              VARCHAR2(10),
  nom_cliente            VARCHAR2(40),
  cod_portad             VARCHAR2(6),
  cod_cart_bcia          VARCHAR2(6),
  cod_espec_docto        VARCHAR2(6),
  cod_titulo_acr         VARCHAR2(10),
  cod_parcela            VARCHAR2(6),
  dat_emissao            DATE,
  dat_vencimento         DATE,
  dat_baixa              DATE,
  dat_credito            DATE,
  dat_recebimento        DATE,
  val_saldo              NUMBER(12,2),
  val_pago               NUMBER(12,2),
  val_abatimento         NUMBER(12,2),
  val_desconto           NUMBER(12,2),
  val_juros              NUMBER(12,2),
  cod_tit_acr_bco        VARCHAR2(20),
  des_mensagem           VARCHAR2(500),
  log_falha              VARCHAR2(1),
  val_desconto_calculado NUMBER(12,2),
  cod_empresa            VARCHAR2(6),
  cod_estab              VARCHAR2(6),
  cdn_cliente            NUMBER,
  cod_indic_econ         VARCHAR2(8),
  cod_ser_docto          VARCHAR2(6),
  num_id_tit_acr         NUMBER(8),
  tip_cobranca           VARCHAR2(3),
  cod_operacao           VARCHAR2(3),
  cod_convenio           VARCHAR2(15)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_MOVIMENTO_TITULO_ACR_01 on EMS506UNICOO.MOVIMENTO_RETORNO_TITULO_ACR (NRSEQ_CONTROLE, NUM_ID_TIT_ACR)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.MOVIMENTO_RETORNO_TITULO_ACR
  add constraint PK_MOVTO_RETORNO_TITULO_ACR primary key (NRSEQUENCIAL)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table PESSOA_BKP_HML
prompt =============================
prompt
create table EMS506UNICOO.PESSOA_BKP_HML
(
  nrregistro             NUMBER(8) not null,
  nopessoa               VARCHAR2(60),
  cdsitpessoa            VARCHAR2(4),
  tppessoa               VARCHAR2(1),
  nrcgc_cpf              VARCHAR2(15),
  nrinscest_rg           VARCHAR2(15),
  cdramoativ             VARCHAR2(5),
  dtnascimento           DATE,
  cdsexo                 VARCHAR2(1),
  cdestadocivil          VARCHAR2(1),
  nomae                  VARCHAR2(70),
  nrreg_nascto           VARCHAR2(6),
  nocartorio_reg         VARCHAR2(30),
  txobservacoes          VARCHAR2(400),
  nooperador             VARCHAR2(20),
  nonaturalidade         VARCHAR2(20),
  cdnacionalidade        VARCHAR2(4),
  noorgao_emissor_rg     VARCHAR2(6),
  nrpis                  VARCHAR2(11),
  cdgrau_de_instrucao    VARCHAR2(4),
  cdreligiao             VARCHAR2(4),
  nopai                  VARCHAR2(70),
  noesposo               VARCHAR2(40),
  cdetnia                VARCHAR2(4),
  nrinscmun              VARCHAR2(15),
  nrcei                  VARCHAR2(15),
  nrcartao_convenio      VARCHAR2(15),
  noabreviado            VARCHAR2(25),
  cdpais_emissor_id      NUMBER(3),
  nrcns                  NUMBER(15),
  dtexpedicao_rg         DATE,
  cdestado_emissor_rg    VARCHAR2(2),
  nrdeclaracao_nasc_vivo VARCHAR2(15),
  cdcidade_naturalidade  VARCHAR2(4)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table PROG_DTSUL_BKP
prompt =============================
prompt
create table EMS506UNICOO.PROG_DTSUL_BKP
(
  cod_prog_dtsul          VARCHAR2(200) not null,
  des_prog_dtsul          VARCHAR2(80) not null,
  cod_proced              VARCHAR2(64) not null,
  nom_prog_dtsul_menu     VARCHAR2(80) not null,
  nom_prog_ext            VARCHAR2(508) not null,
  log_reg_padr            NUMBER not null,
  log_visualiz_menu       NUMBER not null,
  log_gera_log_exec       NUMBER not null,
  num_topico              NUMBER,
  nom_prog_upc            VARCHAR2(100),
  idi_template            NUMBER,
  nom_prog_appc           VARCHAR2(100),
  log_exec_prog_rpc       NUMBER,
  nom_prog_dpc            VARCHAR2(100),
  cod_livre_1             VARCHAR2(200),
  cod_livre_2             VARCHAR2(200),
  val_livre_1             NUMBER(19,4),
  val_livre_2             NUMBER(19,4),
  num_livre_1             NUMBER,
  num_livre_2             NUMBER,
  log_livre_1             NUMBER,
  log_livre_2             NUMBER,
  dat_livre_1             DATE,
  dat_livre_2             DATE,
  des_checksum            VARCHAR2(40),
  log_exec_prog_rpc_usuar NUMBER not null,
  log_prog_liberd_clien   NUMBER,
  log_web_enable          NUMBER,
  log_outro_produt_dtsul  NUMBER,
  log_prepdo_rpc          NUMBER,
  idi_interfac            NUMBER,
  idi_dtsul               NUMBER not null,
  idi_categ_prog_dtsul    NUMBER,
  idi_dtsul_ui_resource   NUMBER,
  idi_dtsul_modul_dtsul   NUMBER not null,
  nom_prog_menu_verbal    VARCHAR2(508),
  nom_tag_prog_menu       VARCHAR2(508),
  dat_ult_aces            DATE,
  num_tot_aces            NUMBER,
  dat_cadast_prog_dtsul   DATE,
  log_tip_exec            NUMBER,
  log_atualiz_query       NUMBER,
  idi_tip_prog_dtsul      NUMBER not null,
  log_login_interm_autom  NUMBER not null,
  progress_recid          NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TEMP_ACERT_TIPO
prompt ==============================
prompt
create table EMS506UNICOO.TEMP_ACERT_TIPO
(
  cdmovimento          NUMBER,
  cod_tip_fluxo_financ VARCHAR2(999)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TEMP_ANALIS_CLIENTE
prompt ==================================
prompt
create table EMS506UNICOO.TEMP_ANALIS_CLIENTE
(
  nrseq_controle_integracao NUMBER(9) not null,
  nrseq_favorecido          NUMBER(8),
  cdsituacao                VARCHAR2(2) not null,
  cod_acao                  VARCHAR2(1) not null,
  cod_agenc_bcia            VARCHAR2(10) not null,
  cod_banco                 VARCHAR2(8) not null,
  cod_cart_bcia_prefer      VARCHAR2(3) not null,
  cod_cep                   VARCHAR2(20) not null,
  cod_cep_cobr              VARCHAR2(20) not null,
  cod_cliente               NUMBER(9) not null,
  cod_cta_corren_bco        VARCHAR2(20) not null,
  cod_cx_post               VARCHAR2(20) not null,
  cod_cx_post_cobr          VARCHAR2(20) not null,
  cod_digito_agenc_bcia     VARCHAR2(2) not null,
  cod_digito_cta_corren     VARCHAR2(2) not null,
  cod_e_mail                VARCHAR2(40) not null,
  cod_empresa               VARCHAR2(3) not null,
  cod_fax                   VARCHAR2(20) not null,
  cod_grp_clien             VARCHAR2(4) not null,
  cod_id_estad_fisic        VARCHAR2(20) not null,
  cod_id_feder              VARCHAR2(20) not null,
  cod_id_feder_emis_estad   VARCHAR2(3) not null,
  cod_id_feder_estad_jurid  VARCHAR2(20) not null,
  cod_id_feder_jurid        VARCHAR2(20) not null,
  cod_id_feder_matriz       VARCHAR2(20) not null,
  cod_id_feder_nasc         VARCHAR2(3) not null,
  cod_id_munic_jurid        VARCHAR2(20),
  cod_id_previd_social      VARCHAR2(20) not null,
  cod_org_emis_id_estad     VARCHAR2(10) not null,
  cod_pais_nasc             VARCHAR2(3) not null,
  cod_portad_prefer         VARCHAR2(5) not null,
  cod_ramal_fax             VARCHAR2(20) not null,
  cod_telefone_1            VARCHAR2(20) not null,
  cod_telefone_2            VARCHAR2(20) not null,
  cod_telefone_3            VARCHAR2(20) not null,
  cod_tip_clien             VARCHAR2(8) not null,
  cod_tip_fluxo_financ      VARCHAR2(12) not null,
  cod_unid_feder            VARCHAR2(3) not null,
  cod_unid_feder_cobr       VARCHAR2(3) not null,
  dat_envio                 DATE,
  dat_impl_clien            DATE not null,
  dat_nascimento            DATE,
  dat_processamento         DATE not null,
  dest_anot_tabela          VARCHAR2(2000) not null,
  ind_estado_civil          VARCHAR2(10) not null,
  ind_ocorrencia            NUMBER(1) not null,
  ind_tipo_pessoa           VARCHAR2(8) not null,
  log_calc_multa            VARCHAR2(1) not null,
  log_fins_lucrat           VARCHAR2(1) not null,
  nom_abrev                 VARCHAR2(15),
  nom_bairro                VARCHAR2(20) not null,
  nom_bairro_cobr           VARCHAR2(20) not null,
  nom_cidade                VARCHAR2(32) not null,
  nom_cidade_cobr           VARCHAR2(32) not null,
  nom_cliente               VARCHAR2(40) not null,
  nom_ender_compl           VARCHAR2(10) not null,
  nom_ender_compl_cobr      VARCHAR2(10) not null,
  nom_endereco              VARCHAR2(40) not null,
  nom_endereco_cobr         VARCHAR2(40) not null,
  nom_home_page             VARCHAR2(40) not null,
  nom_mae                   VARCHAR2(40) not null,
  nom_nacionalidade         VARCHAR2(40) not null,
  nom_profissao             VARCHAR2(40) not null,
  num_dias_atraso_avdeb     NUMBER(3) not null,
  nrpessoa                  NUMBER(10)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TEMP_ANALIS_FORNECEDOR
prompt =====================================
prompt
create table EMS506UNICOO.TEMP_ANALIS_FORNECEDOR
(
  nrseq_controle_integracao NUMBER(9) not null,
  nrseq_favorecido          NUMBER(8),
  cdsituacao                VARCHAR2(2),
  cod_acao                  VARCHAR2(1),
  cod_agenc_bcia            VARCHAR2(10),
  cod_banco                 VARCHAR2(8) not null,
  cod_cep                   VARCHAR2(20) not null,
  cod_cep_pagto             VARCHAR2(20) not null,
  cod_cta_corren_bco        VARCHAR2(20) not null,
  cod_cx_post               VARCHAR2(20) not null,
  cod_cx_post_pagto         VARCHAR2(20) not null,
  cod_digito_agenc_bcia     VARCHAR2(2) not null,
  cod_digito_cta_corren     VARCHAR2(2) not null,
  cod_e_mail                VARCHAR2(40) not null,
  cod_empresa               VARCHAR2(3) not null,
  cod_fax                   VARCHAR2(20) not null,
  cod_forma_pagto           VARCHAR2(6) not null,
  cod_fornecedor            NUMBER(9),
  cod_grp_fornecedor        VARCHAR2(4) not null,
  cod_id_estad_fisic        VARCHAR2(20) not null,
  cod_id_feder              VARCHAR2(20) not null,
  cod_id_feder_estad_jurid  VARCHAR2(20) not null,
  cod_id_feder_jurid        VARCHAR2(20) not null,
  cod_id_feder_matriz       VARCHAR2(20) not null,
  cod_id_feder_nasc         VARCHAR2(3) not null,
  cod_id_munic_jurid        VARCHAR2(20) not null,
  cod_id_previd_social      VARCHAR2(20) not null,
  cod_org_emis_id_estad     VARCHAR2(10) not null,
  cod_pais_nasc             VARCHAR2(3) not null,
  cod_portad_prefer         VARCHAR2(5) not null,
  cod_ramal_fax             VARCHAR2(20) not null,
  cod_telefone_1            VARCHAR2(20) not null,
  cod_telefone_2            VARCHAR2(20) not null,
  cod_telefone_3            VARCHAR2(20) not null,
  cod_tip_fluxo_financ      VARCHAR2(12) not null,
  cod_tip_fornecedor        VARCHAR2(8) not null,
  cod_unid_feder            VARCHAR2(3) not null,
  cod_unid_feder_emis_estad VARCHAR2(3) not null,
  cod_unid_feder_pagto      VARCHAR2(3) not null,
  dat_envio                 DATE,
  dat_impl_fornecedor       DATE,
  dat_nascimento            DATE,
  dat_processamento         DATE,
  dest_anot_tabela          VARCHAR2(2000),
  ind_estado_civil          VARCHAR2(10) not null,
  ind_ocorrencia            NUMBER(1) not null,
  ind_tipo_pessoa           VARCHAR2(1) not null,
  log_fins_lucrat           VARCHAR2(1) not null,
  nom_abrev                 VARCHAR2(15) not null,
  nom_bairro                VARCHAR2(20) not null,
  nom_bairro_pagto          VARCHAR2(20),
  nom_cidade                VARCHAR2(32) not null,
  nom_cidade_pagto          VARCHAR2(32),
  nom_ender_compl           VARCHAR2(10),
  nom_ender_compl_pagto     VARCHAR2(10),
  nom_endereco              VARCHAR2(40) not null,
  nom_endereco_pagto        VARCHAR2(40),
  nom_fornecedor            VARCHAR2(40) not null,
  nom_home_page             VARCHAR2(40),
  nom_mae                   VARCHAR2(40),
  nom_nacionalidade         VARCHAR2(40),
  nom_profissao             VARCHAR2(40),
  nrpessoa                  NUMBER(10)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TEMP_ANALISE_TITULOS
prompt ===================================
prompt
create table EMS506UNICOO.TEMP_ANALISE_TITULOS
(
  ptpintegracao                  CHAR(2),
  pcdacao                        CHAR(1),
  pcdidentificador               VARCHAR2(12),
  pnrsequencial_origem           NUMBER(10),
  pcdmodulo                      CHAR(1),
  cdempresa                      VARCHAR2(5),
  pnrseq_controle_integracao_org CHAR(1),
  vltitulo                       NUMBER(12,2),
  saldo                          NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TEMP_CEP_ERRADO
prompt ==============================
prompt
create table EMS506UNICOO.TEMP_CEP_ERRADO
(
  nrseq_controle_integracao NUMBER(9) not null,
  nrsequencial_origem       NUMBER(10),
  cdidentificador           VARCHAR2(40)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TEMP_EMS_MOV_TITULO_ACR
prompt ======================================
prompt
create table EMS506UNICOO.TEMP_EMS_MOV_TITULO_ACR
(
  cod_empresa              VARCHAR2(12) not null,
  u##cod_estab             VARCHAR2(12) not null,
  cod_estab                VARCHAR2(12) not null,
  u##cod_refer             VARCHAR2(20) not null,
  cod_refer                VARCHAR2(20) not null,
  u##cod_espec_docto       VARCHAR2(12) not null,
  cod_espec_docto          VARCHAR2(12) not null,
  u##cod_estab_tit_acr_pai VARCHAR2(12),
  cod_estab_tit_acr_pai    VARCHAR2(12),
  cod_portador             VARCHAR2(12) not null,
  cod_cart_bcia            VARCHAR2(12) not null,
  u##codmotivmovtotitacr   VARCHAR2(16),
  codmotivmovtotitacr      VARCHAR2(16),
  cod_finalid_econ_motiv   VARCHAR2(20),
  cod_usuario              VARCHAR2(24) not null,
  cod_usuar_gerac_ctbz     VARCHAR2(24),
  cod_autoriz_bco          VARCHAR2(16),
  codinstrucbcia1movto     VARCHAR2(12),
  codinstrucbcia2movto     VARCHAR2(12),
  cod_estab_enctro_cta     VARCHAR2(12),
  dat_transacao            DATE not null,
  dat_cr_movto_tit_acr     DATE,
  dat_vencto_tit_acr       DATE,
  dat_vencto_ant_tit_acr   DATE,
  datapuracvariacvalant    DATE,
  dat_gerac_ctbz           DATE,
  dat_gerac_movto          DATE not null,
  dat_liquidac_tit_acr     DATE,
  dat_fluxo_cx_movto       DATE not null,
  val_movto_tit_acr        NUMBER not null,
  val_movto_fluxo_cx_bco   NUMBER not null,
  val_desconto             NUMBER not null,
  val_abat_tit_acr         NUMBER not null,
  val_juros                NUMBER not null,
  val_multa_tit_acr        NUMBER not null,
  val_despes_bcia          NUMBER,
  val_cm_tit_acr           NUMBER not null,
  valimptooperacfinanc     NUMBER not null,
  val_motiv_movto_acr      NUMBER,
  val_despes_financ        NUMBER not null,
  num_id_movto_tit_acr     NUMBER not null,
  numidmovtotitacrpai      NUMBER,
  numidmovtoctacorren      NUMBER not null,
  num_id_tit_acr           NUMBER not null,
  num_id_movto_bxa         NUMBER,
  num_fatur_acr            NUMBER,
  num_renegoc_cobr_acr     NUMBER not null,
  num_id_enctro_cta        NUMBER,
  log_ctbz_aprop_ctbl      NUMBER not null,
  log_aprop_ctbl_ctbzda    NUMBER not null,
  log_movto_estordo        NUMBER not null,
  log_ndebito_gerad        NUMBER not null,
  log_antecip_gerad        NUMBER not null,
  logliquidaccontraantecip NUMBER not null,
  logmovtocomisestordo     NUMBER not null,
  log_movto_envdo_bco      NUMBER not null,
  cdn_cliente              NUMBER not null,
  cdn_clien_fatur          NUMBER,
  ind_trans_acr            VARCHAR2(58) not null,
  ind_motiv_acerto_val     VARCHAR2(24),
  u##ind_trans_acr_abrev   VARCHAR2(12),
  ind_trans_acr_abrev      VARCHAR2(12),
  u##hra_gerac_movto       VARCHAR2(16) not null,
  hra_gerac_movto          VARCHAR2(16) not null,
  hra_gerac_ctbz           VARCHAR2(16),
  cod_livre_1              VARCHAR2(500),
  log_integr_cfl_atlzdo    NUMBER not null,
  val_sdo_tit_acr          NUMBER not null,
  val_multa_tit_acr_calc   NUMBER not null,
  val_juros_calc           NUMBER not null,
  log_recuper_perda        NUMBER,
  ind_orig_alter_portad    VARCHAR2(30),
  cod_contrat_cambio       VARCHAR2(30),
  datcontratcambioexport   DATE,
  num_contrat_id_cambio    NUMBER,
  codestabcontratcambio    VARCHAR2(12),
  codrefercontratcambio    VARCHAR2(20),
  datrefercontratcambio    DATE,
  cod_estab_reembol        VARCHAR2(12),
  cod_estab_proces_bxa     VARCHAR2(12),
  datvinculcontratcambio   DATE,
  log_retenc_impto_liq     NUMBER not null,
  val_retenc_pis           NUMBER not null,
  val_retenc_cofins        NUMBER not null,
  val_retenc_csll          NUMBER not null,
  cod_livre_2              VARCHAR2(500),
  dat_livre_1              DATE,
  dat_livre_2              DATE,
  log_livre_1              NUMBER,
  log_livre_2              NUMBER,
  num_livre_1              NUMBER,
  num_livre_2              NUMBER,
  val_livre_1              NUMBER,
  val_livre_2              NUMBER,
  val_iva_retid            NUMBER not null,
  log_import_tit_sdo       NUMBER,
  progress_recid           NUMBER,
  cod_ser_docto            VARCHAR2(12) not null,
  cod_tit_acr              VARCHAR2(20) not null,
  cod_parcela              VARCHAR2(12) not null,
  val_liq_tit_acr          NUMBER not null,
  val_ajust_val_tit_acr    NUMBER not null,
  ind_tip_espec_docto      VARCHAR2(34) not null,
  vrdoc                    VARCHAR2(40),
  cod_tit_acr_bco          VARCHAR2(40)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TEMP_ERROS_INTGR
prompt ===============================
prompt
create table EMS506UNICOO.TEMP_ERROS_INTGR
(
  cdn_fornecedor NUMBER not null,
  cdn_cliente    NUMBER not null,
  u##nom_pessoa  VARCHAR2(80) not null,
  nom_pessoa     VARCHAR2(80) not null,
  cod_id_feder   VARCHAR2(40) not null
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TEMP_IT_PESSOA
prompt =============================
prompt
create table EMS506UNICOO.TEMP_IT_PESSOA
(
  nrregistro             NUMBER(10) not null,
  noabreviado_cliente    VARCHAR2(15),
  noabreviado_fornecedor VARCHAR2(15),
  cdn_fornecedor         NUMBER(10),
  cdn_cliente            NUMBER(10),
  nrregistro_pai         NUMBER(10),
  txregra_agrupamento    VARCHAR2(20),
  nopessoa               VARCHAR2(60),
  dtnascimento           DATE,
  nrcgc_cpf              VARCHAR2(15),
  dtgeracao              DATE,
  dtultima_atualizacao   DATE
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TEMP_NOMEABREV
prompt =============================
prompt
create table EMS506UNICOO.TEMP_NOMEABREV
(
  nrregistro   NUMBER,
  nopessoa     VARCHAR2(999),
  nomae        VARCHAR2(999),
  dtnascimento DATE,
  tppessoa     CHAR(1),
  noabrev_ems  VARCHAR2(12),
  nrcgc_cpg    NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IX_TEMP_1 on EMS506UNICOO.TEMP_NOMEABREV (NOPESSOA, NOMAE, DTNASCIMENTO, NRCGC_CPG)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  )
  reverse;
create index EMS506UNICOO.IX_TEMP_2 on EMS506UNICOO.TEMP_NOMEABREV (NOABREV_EMS)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  )
  reverse;

prompt
prompt Creating table TEMP_TIPO_MOV_APB
prompt ================================
prompt
create table EMS506UNICOO.TEMP_TIPO_MOV_APB
(
  nrsequencial         NUMBER(4) not null,
  cdempresa            VARCHAR2(5) not null,
  cdmovimento          VARCHAR2(4) not null,
  cdmodulo             VARCHAR2(4) not null,
  nomovimento          VARCHAR2(40),
  cddivisao            VARCHAR2(4),
  cod_estab            VARCHAR2(3),
  cod_tip_fluxo_financ VARCHAR2(12),
  cod_cta_ctbl         VARCHAR2(20),
  cod_ccusto           VARCHAR2(11),
  cod_espec_docto      VARCHAR2(3),
  cod_cart_bcia        VARCHAR2(3),
  cod_empresa          VARCHAR2(3),
  cod_portador         VARCHAR2(5),
  cod_ser_docto        VARCHAR2(2),
  cod_forma_pagto      VARCHAR2(4),
  cod_grp_fornecedor   VARCHAR2(4) not null,
  cdcentro_custo       VARCHAR2(4)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TEMP_TIT_FECHADO
prompt ===============================
prompt
create table EMS506UNICOO.TEMP_TIT_FECHADO
(
  registro    VARCHAR2(4000),
  nrsequencia NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TEMP_TITULOS_APB_NAO_MIGRAR
prompt ==========================================
prompt
create table EMS506UNICOO.TEMP_TITULOS_APB_NAO_MIGRAR
(
  cdfornecedor              VARCHAR2(6),
  nrregistro_titulo         NUMBER(10) not null,
  cdempresa                 VARCHAR2(5),
  nrregistro_fornecedor     NUMBER(8),
  cdsituacao                VARCHAR2(1),
  idcontrato                VARCHAR2(12),
  cdhistorico               NUMBER(4),
  nrdocumento               VARCHAR2(12),
  tpdocumento               VARCHAR2(3),
  cdportador                VARCHAR2(3),
  cdoperacao                VARCHAR2(3),
  nrnossonumero             VARCHAR2(20),
  nrvendedor                VARCHAR2(3),
  dttitulo                  DATE,
  dtvencimento              DATE,
  dtexclusao                DATE,
  dtreferencia              DATE,
  vltitulo                  NUMBER(12,2),
  vlabatimento              NUMBER(12,2),
  vlabatimento_2            NUMBER(12,2),
  dtultimo_recebimento      DATE,
  vlpago                    NUMBER(12,2),
  vlmulta                   NUMBER(12,2),
  vljuros                   NUMBER(12,2),
  vldesconto                NUMBER(12,2),
  dtenvio_banco             DATE,
  dtconfirma_banco          DATE,
  txreferencia_banco        VARCHAR2(100),
  txhistorico               VARCHAR2(255),
  dtprotesto                DATE,
  nocartorio_protesto       VARCHAR2(50),
  txobservacoes             VARCHAR2(255),
  cdcentro_custo            NUMBER(6),
  nrregistro_tit_agrup      NUMBER(10),
  nrregistro_tit_desm       NUMBER(10),
  nrbanco                   NUMBER(4),
  nragencia                 VARCHAR2(8),
  nrconta_bancaria          VARCHAR2(12),
  dtcontabilizado           DATE,
  aoliberado                VARCHAR2(1),
  cdfuncionario             VARCHAR2(12),
  dtliberacao               DATE,
  aoenvia                   VARCHAR2(3),
  nrsequencianotafiscalent  NUMBER default 0,
  nrnota_fiscal_dev         VARCHAR2(12),
  vltitulo_vendor           NUMBER(14,2),
  nrregistro_despesa        NUMBER(12),
  nrmotivo_exclusao         NUMBER(4),
  dtdigitacao               DATE,
  nrregistro_agrup          NUMBER(10),
  dtultimo_retorno          DATE,
  nrultimo_retorno          NUMBER,
  cdcomando_envio           VARCHAR2(2),
  cdcomando_retorno         VARCHAR2(3),
  cdcomando_atual           VARCHAR2(2),
  cdbarra                   VARCHAR2(44),
  linha_digitavel_cb        VARCHAR2(47),
  vltaxa_bancaria           NUMBER(12,2),
  cdtaxa                    VARCHAR2(6),
  nrultimo_envio            NUMBER,
  nrdocumento_banco         VARCHAR2(30),
  vlir_fonte                NUMBER(12,2),
  cdorigem                  VARCHAR2(2),
  nrorigem                  NUMBER(10),
  dtencerramento            DATE,
  cddivisao                 NUMBER(6),
  vlbruto                   NUMBER(12,2),
  dtemissao_nf              DATE,
  dtreferencia_baixa        DATE,
  cdmovimento_inclusao      NUMBER(2),
  tpimpostos_desmembramento VARCHAR2(1),
  tpimpostos_agrupamento    VARCHAR2(1),
  cdcentro_responsabilidade NUMBER(6),
  nrdoc_intercambio         VARCHAR2(20)
)
tablespace TS_EMS5
  pctfree 10
  initrans 30
  maxtrans 255
  storage
  (
    initial 18M
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TEMP_TITULOS_APB_NAO_MIGRAR
  add constraint PK_TITULO_A_PAGAR primary key (NRREGISTRO_TITULO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 2M
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_ABERTO_CONTABIL_EMS
prompt =====================================
prompt
create table EMS506UNICOO.TI_ABERTO_CONTABIL_EMS
(
  nrregistro_titulo      NUMBER(12),
  cod_estab              VARCHAR2(6),
  cod_espec_docto        VARCHAR2(6),
  cod_ser_docto          VARCHAR2(6),
  cod_tit_acr            VARCHAR2(10),
  cod_parcela            VARCHAR2(6),
  cod_unid_negocio       CHAR(3),
  cdn_cliente            NUMBER,
  nom_abrev              VARCHAR2(40),
  nom_cliente            VARCHAR2(60),
  cod_grp_cliente        VARCHAR2(3),
  cod_cliente_matriz     NUMBER,
  cod_portador           VARCHAR2(6),
  cod_cart_bcia          VARCHAR2(6),
  cod_representante      NUMBER,
  dat_emis_docto         DATE,
  dat_vencto_tit_acr     DATE,
  dat_liquidac_tit_acr   DATE,
  cod_refer              VARCHAR2(10),
  cod_tit_acr_bco        VARCHAR2(20),
  cod_moeda              VARCHAR2(20),
  val_origin_tit_acr     NUMBER,
  val_sdo_tit_acr        NUMBER,
  val_saldo_apresentacao NUMBER,
  num_dias               NUMBER,
  num_pedido             NUMBER,
  cod_condicao_pagto     VARCHAR2(20)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_ABERTO_CONTABIL_UNICOO
prompt ========================================
prompt
create table EMS506UNICOO.TI_ABERTO_CONTABIL_UNICOO
(
  nrregistro_titulo NUMBER(10),
  cdcliente         VARCHAR2(10),
  cliente           CHAR(50),
  nrdocumento       VARCHAR2(12),
  tpdocumento       VARCHAR2(3),
  dttitulo          DATE,
  dtvencimento      DATE,
  dtexclusao        DATE,
  vltitulo          NUMBER(12,2),
  vldesconto        NUMBER(12,2),
  vlglosaap         NUMBER(12,2),
  vlglosa           NUMBER(12,2),
  vljuros           NUMBER(12,2),
  vlmulta           NUMBER(12,2),
  vlrecebido        NUMBER(12,2),
  vlareceber        NUMBER(12,2),
  cod_ser_docto     VARCHAR2(10),
  cod_tit_acr       VARCHAR2(12)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_BANCO
prompt =======================
prompt
create table EMS506UNICOO.TI_BANCO
(
  nrsequencial     NUMBER,
  nobanco          VARCHAR2(30),
  cod_banco_totvs  VARCHAR2(10),
  cod_banco_unicoo VARCHAR2(10),
  cod_portador_apb VARCHAR2(10),
  cod_portador_acr VARCHAR2(10),
  tam_nossonumero  NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_BANCO
  add constraint UK_TI_BANCO_01 unique (COD_BANCO_TOTVS, COD_BANCO_UNICOO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_BX_78_NPROC
prompt =============================
prompt
create table EMS506UNICOO.TI_BX_78_NPROC
(
  cdidentificador VARCHAR2(40)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_BX_PERDA
prompt ==========================
prompt
create table EMS506UNICOO.TI_BX_PERDA
(
  nrdocumento       VARCHAR2(12),
  nrregistro_titulo NUMBER(10) not null,
  dtmovimento       DATE,
  vlrecebido        NUMBER(12,2),
  cod_ser           VARCHAR2(2),
  cod_tit           VARCHAR2(10),
  status            VARCHAR2(2),
  cod_espe          VARCHAR2(5)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IX_TX_BX_BAIXA_PERDA on EMS506UNICOO.TI_BX_PERDA (NRDOCUMENTO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_CENTRO_CUSTO_CTBL
prompt ===================================
prompt
create table EMS506UNICOO.TI_CENTRO_CUSTO_CTBL
(
  cod_cta_ctbl     VARCHAR2(20) not null,
  cod_ccusto       VARCHAR2(11),
  cod_estab        VARCHAR2(6) not null,
  cod_plano_ccusto VARCHAR2(8),
  cdhistorico      NUMBER(4) default '0' not null
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_CENTRO_CUSTO_CTBL.cod_cta_ctbl
  is 'Conta contabil no EMS';
comment on column EMS506UNICOO.TI_CENTRO_CUSTO_CTBL.cod_ccusto
  is 'Centro de Custo no EMS';
comment on column EMS506UNICOO.TI_CENTRO_CUSTO_CTBL.cod_estab
  is 'Codigo do Estabelecimento no EMS';
comment on column EMS506UNICOO.TI_CENTRO_CUSTO_CTBL.cod_plano_ccusto
  is 'Plano de Centro de Custo no EMS';
alter table EMS506UNICOO.TI_CENTRO_CUSTO_CTBL
  add constraint PK_TI_CENTRO_CUSTO_CTBL primary key (COD_ESTAB, COD_CTA_CTBL, CDHISTORICO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_CENTRO_CUSTO_CTBL_DEPARA
prompt ==========================================
prompt
create table EMS506UNICOO.TI_CENTRO_CUSTO_CTBL_DEPARA
(
  cdconta         NUMBER,
  cd_ccusto_totvs NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_CLIENTE
prompt =========================
prompt
create table EMS506UNICOO.TI_CLIENTE
(
  nrseq_controle_integracao NUMBER(9) not null,
  nrseq_favorecido          NUMBER(8),
  cdsituacao                VARCHAR2(2) not null,
  cod_acao                  VARCHAR2(1) not null,
  cod_agenc_bcia            VARCHAR2(10) not null,
  cod_banco                 VARCHAR2(8) not null,
  cod_cart_bcia_prefer      VARCHAR2(3) not null,
  cod_cep                   VARCHAR2(20) not null,
  cod_cep_cobr              VARCHAR2(20) not null,
  cod_cliente               NUMBER(9) default 0 not null,
  cod_cta_corren_bco        VARCHAR2(20) not null,
  cod_cx_post               VARCHAR2(20) not null,
  cod_cx_post_cobr          VARCHAR2(20) not null,
  cod_digito_agenc_bcia     VARCHAR2(2) not null,
  cod_digito_cta_corren     VARCHAR2(2) not null,
  cod_e_mail                VARCHAR2(40) not null,
  cod_empresa               VARCHAR2(3) not null,
  cod_fax                   VARCHAR2(20) not null,
  cod_grp_clien             VARCHAR2(4) not null,
  cod_id_estad_fisic        VARCHAR2(20) not null,
  cod_id_feder              VARCHAR2(20) not null,
  cod_id_feder_emis_estad   VARCHAR2(3) not null,
  cod_id_feder_estad_jurid  VARCHAR2(20) not null,
  cod_id_feder_jurid        VARCHAR2(20) not null,
  cod_id_feder_matriz       VARCHAR2(20) not null,
  cod_id_feder_nasc         VARCHAR2(3) not null,
  cod_id_munic_jurid        VARCHAR2(20),
  cod_id_previd_social      VARCHAR2(20) not null,
  cod_org_emis_id_estad     VARCHAR2(10) not null,
  cod_pais_nasc             VARCHAR2(3) not null,
  cod_portad_prefer         VARCHAR2(5) not null,
  cod_ramal_fax             VARCHAR2(20) not null,
  cod_telefone_1            VARCHAR2(20) not null,
  cod_telefone_2            VARCHAR2(20) not null,
  cod_telefone_3            VARCHAR2(20) not null,
  cod_tip_clien             VARCHAR2(8) not null,
  cod_tip_fluxo_financ      VARCHAR2(12) not null,
  cod_unid_feder            VARCHAR2(3) not null,
  cod_unid_feder_cobr       VARCHAR2(3) not null,
  dat_envio                 DATE,
  dat_impl_clien            DATE not null,
  dat_nascimento            DATE,
  dat_processamento         DATE not null,
  dest_anot_tabela          VARCHAR2(2000) not null,
  ind_estado_civil          VARCHAR2(10) not null,
  ind_ocorrencia            NUMBER(1) not null,
  ind_tipo_pessoa           VARCHAR2(8) not null,
  log_calc_multa            VARCHAR2(1) not null,
  log_fins_lucrat           VARCHAR2(1) not null,
  nom_abrev                 VARCHAR2(15),
  nom_bairro                VARCHAR2(20) not null,
  nom_bairro_cobr           VARCHAR2(20) not null,
  nom_cidade                VARCHAR2(32) not null,
  nom_cidade_cobr           VARCHAR2(32) not null,
  nom_cliente               VARCHAR2(80) not null,
  nom_ender_compl           VARCHAR2(10) not null,
  nom_ender_compl_cobr      VARCHAR2(10) not null,
  nom_endereco              VARCHAR2(40) not null,
  nom_endereco_cobr         VARCHAR2(40) not null,
  nom_home_page             VARCHAR2(40) not null,
  nom_mae                   VARCHAR2(40) not null,
  nom_nacionalidade         VARCHAR2(40) not null,
  nom_profissao             VARCHAR2(40) not null,
  num_dias_atraso_avdeb     NUMBER(3) not null,
  nrpessoa                  NUMBER(10)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_COD_CLIENTE on EMS506UNICOO.TI_CLIENTE (COD_CLIENTE)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_CLIENTE_CDSITUACAO on EMS506UNICOO.TI_CLIENTE (CDSITUACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_CLIENTE
  add constraint PK_TI_CLIENTE primary key (NRSEQ_CONTROLE_INTEGRACAO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_CONTABILIZACAO
prompt ================================
prompt
create table EMS506UNICOO.TI_CONTABILIZACAO
(
  nrseq_controle_integracao NUMBER(10) not null,
  cdsituacao                VARCHAR2(2),
  cod_plano_cta_ctbl        VARCHAR2(8),
  cod_plano_ccusto          VARCHAR2(8),
  cod_cta_ctbl              VARCHAR2(20),
  ind_natur_lancto_ctbl     VARCHAR2(2) not null,
  cod_histor_padr           VARCHAR2(8),
  des_histor_lancto_ctbl    VARCHAR2(2000),
  dat_lancto                DATE,
  val_lancto_ctbl           NUMBER(12,2),
  cod_ccusto                VARCHAR2(11),
  cod_proj_financ           VARCHAR2(20),
  ind_ocorrencia            VARCHAR2(1),
  dat_processamento         DATE,
  dat_geracao               DATE,
  cod_estab                 VARCHAR2(6),
  des_docto                 VARCHAR2(20),
  nrperiodo                 NUMBER(6),
  des_lote_ctbl             VARCHAR2(40),
  cod_empresa               VARCHAR2(3),
  cod_unid_negoc            VARCHAR2(3),
  nrlancamento              NUMBER(6) not null,
  nrseq_lancto              NUMBER(6) not null
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_CONTABILIZACAO
  add constraint UK_TI_CONTABILIZACAO_LANCTO primary key (NRSEQ_CONTROLE_INTEGRACAO, NRLANCAMENTO, NRSEQ_LANCTO, IND_NATUR_LANCTO_CTBL)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_CONTROLE_INTEGRACAO
prompt =====================================
prompt
create table EMS506UNICOO.TI_CONTROLE_INTEGRACAO
(
  nrsequencial                  NUMBER(10) not null,
  tpintegracao                  VARCHAR2(2),
  dtgeracao                     DATE,
  nrsequencial_origem           NUMBER(10),
  dtprocessamento               DATE,
  dtintegracao                  DATE,
  cdacao                        VARCHAR2(1),
  cdidentificador               VARCHAR2(40),
  txobservacao                  VARCHAR2(500),
  cdsituacao                    VARCHAR2(2),
  nrseq_controle_integracao_org NUMBER(10),
  cdempresa                     VARCHAR2(5),
  cdmodulo                      VARCHAR2(4),
  cdmovimento                   VARCHAR2(4),
  nrsessao                      NUMBER(10),
  cddivisao                     VARCHAR2(4),
  cdcentro_custo                VARCHAR2(4),
  tpdocumento                   VARCHAR2(5)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_CONTROLE_INTEGRACAO.cdacao
  is 'A-INCLUSAO, I-INCLUSAO, R-Reprocesso';
comment on column EMS506UNICOO.TI_CONTROLE_INTEGRACAO.cdsituacao
  is 'OK - Processado com sucesso, GE - Gerado, ER -Processo com erro; RE - Reprocessar; CA - CANCELADO';
create index EMS506UNICOO.IDX_INT_TCI_DTGERA_1 on EMS506UNICOO.TI_CONTROLE_INTEGRACAO (TRUNC(DTGERACAO), CDSITUACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_CONTROLE_INTEGRACAO_01 on EMS506UNICOO.TI_CONTROLE_INTEGRACAO (NRSEQUENCIAL, CDSITUACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_CONTROLE_INTEGRACAO_02 on EMS506UNICOO.TI_CONTROLE_INTEGRACAO (NRSEQUENCIAL_ORIGEM, TPINTEGRACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_CONTROLE_INTEGRACAO_03 on EMS506UNICOO.TI_CONTROLE_INTEGRACAO (NRSESSAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_CONTROLE_INTEGRACAO_04 on EMS506UNICOO.TI_CONTROLE_INTEGRACAO (TPINTEGRACAO, NRSEQUENCIAL_ORIGEM, CDIDENTIFICADOR)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_CONTROLE_INTEGRACAO_06 on EMS506UNICOO.TI_CONTROLE_INTEGRACAO (CDIDENTIFICADOR)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_CONTROLE_INTEGRACAO_07 on EMS506UNICOO.TI_CONTROLE_INTEGRACAO (NRSESSAO, TPINTEGRACAO, CDSITUACAO, NRSEQUENCIAL)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  )
  reverse;
create index EMS506UNICOO.IDX_TI_CONTROLE_INTEGRACAO_08 on EMS506UNICOO.TI_CONTROLE_INTEGRACAO (TPINTEGRACAO, CDSITUACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IX_TI_CONTROLE_INTEGRACAO_05 on EMS506UNICOO.TI_CONTROLE_INTEGRACAO (CDSITUACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_CONTROLE_INTEGRACAO
  add constraint PK_TI_CONTROLE_INTEGRACAO primary key (NRSEQUENCIAL);

prompt
prompt Creating table TI_CONTROLE_INTEGRACAO_BKP
prompt =========================================
prompt
create table EMS506UNICOO.TI_CONTROLE_INTEGRACAO_BKP
(
  nrsequencial                  NUMBER(10) not null,
  tpintegracao                  VARCHAR2(2),
  dtgeracao                     DATE,
  nrsequencial_origem           NUMBER(10),
  dtprocessamento               DATE,
  dtintegracao                  DATE,
  cdacao                        VARCHAR2(1),
  cdidentificador               VARCHAR2(40),
  txobservacao                  VARCHAR2(500),
  cdsituacao                    VARCHAR2(2),
  nrseq_controle_integracao_org NUMBER(10),
  cdempresa                     VARCHAR2(5),
  cdmodulo                      VARCHAR2(4),
  cdmovimento                   VARCHAR2(4),
  nrsessao                      NUMBER(10),
  cddivisao                     VARCHAR2(4),
  cdcentro_custo                VARCHAR2(4),
  tpdocumento                   VARCHAR2(5)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_CX_BX_ACR
prompt ===========================
prompt
create table EMS506UNICOO.TI_CX_BX_ACR
(
  nrseq_controle_integracao NUMBER(10) not null,
  cdsituacao                VARCHAR2(2) not null,
  cod_cart_bcia             VARCHAR2(3) not null,
  cod_cliente               NUMBER(9),
  cod_empresa               VARCHAR2(3) not null,
  cod_espec_docto           VARCHAR2(3) not null,
  cod_estab                 VARCHAR2(3) not null,
  cod_parcela               VARCHAR2(6) not null,
  cod_portador              VARCHAR2(5) not null,
  cod_ser_docto             VARCHAR2(3) not null,
  cod_tit_acr_bco           VARCHAR2(20) not null,
  cod_titulo_acr            VARCHAR2(10) not null,
  dat_baixa                 DATE,
  dat_envio                 DATE,
  dat_processamento         DATE not null,
  des_text_histor           VARCHAR2(200) not null,
  val_desconto              NUMBER(9,2) not null,
  val_abatimento            NUMBER(9,2) not null,
  val_ir                    NUMBER(9,2) not null,
  val_juros                 NUMBER(9,2),
  val_multa                 NUMBER(9,2),
  val_liq_titulo            NUMBER(9,2) not null,
  val_titulo                NUMBER(9,2) not null,
  nrpessoa                  NUMBER(10) not null,
  nrregistro_titulo         NUMBER(10),
  nrmovimento_baixa         NUMBER(12),
  nrdocumento               VARCHAR2(12) not null,
  nrnossonumero             VARCHAR2(20) not null,
  txhistorico               VARCHAR2(1000),
  nrbanco                   VARCHAR2(4) not null,
  nragencia                 VARCHAR2(8) not null,
  nrconta_corrente          VARCHAR2(12) not null
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_CX_BX_ACR on EMS506UNICOO.TI_CX_BX_ACR (COD_ESPEC_DOCTO, COD_TITULO_ACR, COD_ESTAB, COD_SER_DOCTO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_CX_BX_ACR_01 on EMS506UNICOO.TI_CX_BX_ACR (CDSITUACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_CX_BX_ACR_02 on EMS506UNICOO.TI_CX_BX_ACR (NRMOVIMENTO_BAIXA)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_CX_BX_ACR
  add constraint PK_TI_CX_BX_ACR primary key (NRSEQ_CONTROLE_INTEGRACAO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_CX_BX_APB
prompt ===========================
prompt
create table EMS506UNICOO.TI_CX_BX_APB
(
  nrseq_controle_integracao NUMBER(10) not null,
  cdsituacao                VARCHAR2(2) not null,
  cod_cart_bcia             VARCHAR2(3) not null,
  cod_cliente               NUMBER(9),
  cod_empresa               VARCHAR2(3) not null,
  cod_espec_docto           VARCHAR2(3) not null,
  cod_estab                 VARCHAR2(3) not null,
  cod_parcela               VARCHAR2(6) not null,
  cod_portador              VARCHAR2(5) not null,
  cod_ser_docto             VARCHAR2(3) not null,
  cod_tit_apb_bco           VARCHAR2(20) not null,
  cod_titulo_apb            VARCHAR2(10) not null,
  dat_baixa                 DATE,
  dat_envio                 DATE,
  dat_processamento         DATE not null,
  des_text_histor           VARCHAR2(200) not null,
  val_desconto              NUMBER(9,2) not null,
  val_abatimento            NUMBER(9,2) not null,
  val_ir                    NUMBER(9,2) not null,
  val_juros                 NUMBER(9,2),
  val_multa                 NUMBER(9,2),
  val_liq_titulo            NUMBER(9,2) not null,
  val_titulo                NUMBER(9,2) not null,
  nrpessoa                  NUMBER(10) not null,
  nrregistro_titulo         NUMBER(10),
  nrmovimento_baixa         NUMBER(12),
  nrdocumento               VARCHAR2(12) not null,
  nrnossonumero             VARCHAR2(20) not null,
  txhistorico               VARCHAR2(1000),
  nrbanco                   VARCHAR2(4) not null,
  nragencia                 VARCHAR2(8) not null,
  nrconta_corrente          VARCHAR2(12) not null
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_DEMONSTRATIVO_FATURAMENTO
prompt ===========================================
prompt
create table EMS506UNICOO.TI_DEMONSTRATIVO_FATURAMENTO
(
  num_id_tit_acr        NUMBER not null,
  num_id_movto_tit_acr  NUMBER not null,
  cod_ser_docto         VARCHAR2(6) not null,
  cod_tit_acr           VARCHAR2(10) not null,
  cod_parcela           VARCHAR2(6) not null,
  val_movto_tit_acr     NUMBER not null,
  dat_vencto_tit_acr    DATE,
  val_ajust_val_tit_acr NUMBER not null,
  val_multa_tit_acr     NUMBER not null,
  val_juros             NUMBER not null,
  val_desconto          NUMBER not null,
  val_abat_tit_acr      NUMBER not null,
  val_despes_bcia       NUMBER,
  dat_cr_movto_tit_acr  DATE,
  dat_transacao         DATE not null,
  ind_trans_acr_abrev   VARCHAR2(6),
  cod_tit_acr_bco       VARCHAR2(20),
  cod_refer             VARCHAR2(10) not null,
  cod_estab             VARCHAR2(6) not null,
  cod_espec_docto       VARCHAR2(6) not null,
  ind_tip_espec_docto   VARCHAR2(17) not null,
  cdn_cliente           NUMBER not null,
  log_ctbz_aprop_ctbl   NUMBER not null,
  log_tit_acr_estordo   NUMBER not null,
  dat_emis_docto        DATE not null
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_DEPARA_CONTA_DEPOSITO
prompt =======================================
prompt
create table EMS506UNICOO.TI_DEPARA_CONTA_DEPOSITO
(
  cod_estoque_mv         NUMBER,
  cod_ctacontabil_unicoo VARCHAR2(20),
  cod_historico_unicoo   VARCHAR2(30)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_DEPARA_CONTABIL
prompt =================================
prompt
create table EMS506UNICOO.TI_DEPARA_CONTABIL
(
  cod_especie        NUMBER(2),
  cod_classe         NUMBER(2),
  cod_subclasse      NUMBER(2),
  cod_cta_contabil   VARCHAR2(60),
  vlr_limite_inicial NUMBER(10,2),
  vlr_limite_final   NUMBER(10,2)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_DEPARA_TIPO_MOVIMENTO
prompt =======================================
prompt
create table EMS506UNICOO.TI_DEPARA_TIPO_MOVIMENTO
(
  cdempresa            VARCHAR2(5),
  cdmodulo             VARCHAR2(2),
  cdmovimento          NUMBER,
  cod_grp_clien        VARCHAR2(3),
  cod_estab            NUMBER,
  cod_tip_fluxo_financ NUMBER,
  cod_cta_ctbl         NUMBER,
  cod_especie          VARCHAR2(3)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_EMPRESA
prompt =========================
prompt
create table EMS506UNICOO.TI_EMPRESA
(
  cdempresa   VARCHAR2(5) not null,
  noempresa   VARCHAR2(40),
  cod_empresa VARCHAR2(5),
  cod_estab   VARCHAR2(3)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_EMPRESA.cdempresa
  is 'Código da empresa no UNICOO';
comment on column EMS506UNICOO.TI_EMPRESA.noempresa
  is 'Nome da Empresa no UNICOO';
comment on column EMS506UNICOO.TI_EMPRESA.cod_empresa
  is 'Codigo da empresa no EMS';
comment on column EMS506UNICOO.TI_EMPRESA.cod_estab
  is 'Codigo do Estabelecimento no TOTVS11';
alter table EMS506UNICOO.TI_EMPRESA
  add constraint PK_EMPRESA primary key (CDEMPRESA)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_ESPECIE_PRODUTO
prompt =================================
prompt
create table EMS506UNICOO.TI_ESPECIE_PRODUTO
(
  cd_especie      NUMBER(2),
  cd_classe       NUMBER(2),
  cd_sub_classe   NUMBER(4),
  cod_espc_bem    VARCHAR2(12),
  cod_empresa_ems VARCHAR2(2)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create unique index EMS506UNICOO.IX_TI_ESPECIE_PRODUTO on EMS506UNICOO.TI_ESPECIE_PRODUTO (CD_ESPECIE, CD_CLASSE, CD_SUB_CLASSE, COD_EMPRESA_EMS)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_ESTABELECIMENTO
prompt =================================
prompt
create table EMS506UNICOO.TI_ESTABELECIMENTO
(
  cddivisao VARCHAR2(4) not null,
  nodivisao VARCHAR2(40),
  cod_estab VARCHAR2(4),
  nom_estab VARCHAR2(40)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_ESTABELECIMENTO.cddivisao
  is '???';
comment on column EMS506UNICOO.TI_ESTABELECIMENTO.nodivisao
  is '??????';
comment on column EMS506UNICOO.TI_ESTABELECIMENTO.cod_estab
  is 'Cod Estabelecimento no EMS';
comment on column EMS506UNICOO.TI_ESTABELECIMENTO.nom_estab
  is 'Descricao do Estabelecimento no EMS';
alter table EMS506UNICOO.TI_ESTABELECIMENTO
  add constraint PK_ESTABELECIMENTO primary key (CDDIVISAO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_EXCLUIR_EMS
prompt =============================
prompt
create table EMS506UNICOO.TI_EXCLUIR_EMS
(
  cdn_fornecedor      NUMBER,
  cdn_estabelecimento NUMBER,
  cdn_especie         VARCHAR2(3),
  cdn_serie           VARCHAR2(3),
  cod_tit_acr         VARCHAR2(99),
  cod_parcela         VARCHAR2(99),
  dat_emissao         DATE,
  val_titulo          NUMBER(10,2),
  val_saldo           NUMBER(10,2),
  cod_refer           VARCHAR2(10),
  nrregistro_titulo   NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_FALHA_DE_PROCESSO
prompt ===================================
prompt
create table EMS506UNICOO.TI_FALHA_DE_PROCESSO
(
  nrsequencial              NUMBER,
  nrseq_controle_integracao NUMBER,
  cdintegracao              VARCHAR2(30),
  txfalha                   VARCHAR2(2000),
  dtfalha                   DATE,
  txajuda                   VARCHAR2(2000),
  nrmensagem                NUMBER(12)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_FALHA_DE_PROCESSO.nrsequencial
  is 'SQ_TI_FALHA_DE_PROCESSO';
comment on column EMS506UNICOO.TI_FALHA_DE_PROCESSO.nrseq_controle_integracao
  is 'Sequencia da ti_controle_integracao';
comment on column EMS506UNICOO.TI_FALHA_DE_PROCESSO.cdintegracao
  is 'tabela que originou a falha';
comment on column EMS506UNICOO.TI_FALHA_DE_PROCESSO.txfalha
  is 'descricao da falha';
comment on column EMS506UNICOO.TI_FALHA_DE_PROCESSO.dtfalha
  is 'data da geracao da falha';
comment on column EMS506UNICOO.TI_FALHA_DE_PROCESSO.txajuda
  is 'descricao da falha';
comment on column EMS506UNICOO.TI_FALHA_DE_PROCESSO.nrmensagem
  is 'numero da mensagem de erro do EMS';
create index EMS506UNICOO.IDX_TI_FALHA_DE_PROCESSO_01 on EMS506UNICOO.TI_FALHA_DE_PROCESSO (NRSEQ_CONTROLE_INTEGRACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_FALHA_DE_PROCESSO_JOS
prompt =======================================
prompt
create table EMS506UNICOO.TI_FALHA_DE_PROCESSO_JOS
(
  nrsequencial              NUMBER,
  nrseq_controle_integracao NUMBER,
  cdintegracao              VARCHAR2(30),
  txfalha                   VARCHAR2(2000),
  dtfalha                   DATE,
  txajuda                   VARCHAR2(2000),
  nrmensagem                NUMBER(12)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_FAVORECIDO_MOVIMENTO
prompt ======================================
prompt
create table EMS506UNICOO.TI_FAVORECIDO_MOVIMENTO
(
  nrsequencial                   NUMBER(8),
  nrseq_favorecido               NUMBER(8),
  nrseq_controle_integracao      NUMBER(8),
  cdorigem                       VARCHAR2(10),
  cdidentificador                VARCHAR2(10),
  txregra_regra_agrup_favorecido VARCHAR2(100),
  dtnascimento                   DATE,
  nrcgc_cpf                      VARCHAR2(15),
  nopessoa                       VARCHAR2(60),
  dtmovimento                    DATE,
  dtprocessamento                DATE,
  cdacao                         VARCHAR2(1),
  nrregistro                     NUMBER(9) not null,
  tppessoa                       VARCHAR2(1) not null
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_FORNECEDOR
prompt ============================
prompt
create table EMS506UNICOO.TI_FORNECEDOR
(
  nrseq_controle_integracao NUMBER(9) not null,
  nrseq_favorecido          NUMBER(8),
  cdsituacao                VARCHAR2(2),
  cod_acao                  VARCHAR2(1),
  cod_agenc_bcia            VARCHAR2(10),
  cod_banco                 VARCHAR2(8) not null,
  cod_cep                   VARCHAR2(20) not null,
  cod_cep_pagto             VARCHAR2(20) not null,
  cod_cta_corren_bco        VARCHAR2(20) not null,
  cod_cx_post               VARCHAR2(20) not null,
  cod_cx_post_pagto         VARCHAR2(20) not null,
  cod_digito_agenc_bcia     VARCHAR2(2) not null,
  cod_digito_cta_corren     VARCHAR2(2) not null,
  cod_e_mail                VARCHAR2(40) not null,
  cod_empresa               VARCHAR2(3) not null,
  cod_fax                   VARCHAR2(20) not null,
  cod_forma_pagto           VARCHAR2(6) not null,
  cod_fornecedor            NUMBER(9),
  cod_grp_fornecedor        VARCHAR2(4) not null,
  cod_id_estad_fisic        VARCHAR2(20) not null,
  cod_id_feder              VARCHAR2(20) not null,
  cod_id_feder_estad_jurid  VARCHAR2(20) not null,
  cod_id_feder_jurid        VARCHAR2(20) not null,
  cod_id_feder_matriz       VARCHAR2(20) not null,
  cod_id_feder_nasc         VARCHAR2(3) not null,
  cod_id_munic_jurid        VARCHAR2(20) not null,
  cod_id_previd_social      VARCHAR2(20) not null,
  cod_org_emis_id_estad     VARCHAR2(10) not null,
  cod_pais_nasc             VARCHAR2(3) not null,
  cod_portad_prefer         VARCHAR2(5) not null,
  cod_ramal_fax             VARCHAR2(20) not null,
  cod_telefone_1            VARCHAR2(20) not null,
  cod_telefone_2            VARCHAR2(20) not null,
  cod_telefone_3            VARCHAR2(20) not null,
  cod_tip_fluxo_financ      VARCHAR2(12) not null,
  cod_tip_fornecedor        VARCHAR2(8) not null,
  cod_unid_feder            VARCHAR2(3) not null,
  cod_unid_feder_emis_estad VARCHAR2(3) not null,
  cod_unid_feder_pagto      VARCHAR2(3) not null,
  dat_envio                 DATE,
  dat_impl_fornecedor       DATE,
  dat_nascimento            DATE,
  dat_processamento         DATE,
  dest_anot_tabela          VARCHAR2(2000),
  ind_estado_civil          VARCHAR2(10) not null,
  ind_ocorrencia            NUMBER(1) not null,
  ind_tipo_pessoa           VARCHAR2(1) not null,
  log_fins_lucrat           VARCHAR2(1) not null,
  nom_abrev                 VARCHAR2(15) not null,
  nom_bairro                VARCHAR2(20) not null,
  nom_bairro_pagto          VARCHAR2(20),
  nom_cidade                VARCHAR2(32) not null,
  nom_cidade_pagto          VARCHAR2(32),
  nom_ender_compl           VARCHAR2(10),
  nom_ender_compl_pagto     VARCHAR2(10),
  nom_endereco              VARCHAR2(40) not null,
  nom_endereco_pagto        VARCHAR2(40),
  nom_fornecedor            VARCHAR2(80) not null,
  nom_home_page             VARCHAR2(40),
  nom_mae                   VARCHAR2(40),
  nom_nacionalidade         VARCHAR2(40),
  nom_profissao             VARCHAR2(40),
  nrpessoa                  NUMBER(10)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_FORNECEDOR_CDSITUACAO on EMS506UNICOO.TI_FORNECEDOR (CDSITUACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_FORNECEDOR
  add constraint PK_TI_FORNECEDOR primary key (NRSEQ_CONTROLE_INTEGRACAO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_GRUPO_DE_CLIENTE
prompt ==================================
prompt
create table EMS506UNICOO.TI_GRUPO_DE_CLIENTE
(
  cdgrupo_cliente        NUMBER(4) not null,
  nogrupo_cliente        VARCHAR2(30),
  cdgrupo_cliente_ems_pj VARCHAR2(4),
  cdgrupo_cliente_ems_pf VARCHAR2(4)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_GRUPO_DE_CLIENTE.cdgrupo_cliente
  is 'Codigo do grupo de cliente no unicoo';
comment on column EMS506UNICOO.TI_GRUPO_DE_CLIENTE.nogrupo_cliente
  is 'Descricao do grupo de cliente no unicoo';
comment on column EMS506UNICOO.TI_GRUPO_DE_CLIENTE.cdgrupo_cliente_ems_pj
  is 'Cod no EMS para PJ';
comment on column EMS506UNICOO.TI_GRUPO_DE_CLIENTE.cdgrupo_cliente_ems_pf
  is 'Cod no EMS para PF';
alter table EMS506UNICOO.TI_GRUPO_DE_CLIENTE
  add constraint PK_TI_GRUPO_DE_CLIENTE primary key (CDGRUPO_CLIENTE)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_GRUPO_DE_FORNECEDOR
prompt =====================================
prompt
create table EMS506UNICOO.TI_GRUPO_DE_FORNECEDOR
(
  cdgrupo_fornecedor  NUMBER(4) not null,
  nogrupo_fornecedor  VARCHAR2(30),
  cod_grp_fornecedor  VARCHAR2(4),
  cd_historico_padrao VARCHAR2(10)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_GRUPO_DE_FORNECEDOR.cdgrupo_fornecedor
  is 'Cod grupo fornecedor';
comment on column EMS506UNICOO.TI_GRUPO_DE_FORNECEDOR.nogrupo_fornecedor
  is 'Descricao do grupo de fornecedor';
comment on column EMS506UNICOO.TI_GRUPO_DE_FORNECEDOR.cod_grp_fornecedor
  is 'Codigo grupo fornecedor no EMS';
alter table EMS506UNICOO.TI_GRUPO_DE_FORNECEDOR
  add constraint PK_GRUPO_FORNECEDOR_EMS primary key (CDGRUPO_FORNECEDOR)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_HASH
prompt ======================
prompt
create table EMS506UNICOO.TI_HASH
(
  nrsequencial        NUMBER(10) not null,
  tpintegracao        VARCHAR2(2),
  dtgeracao           DATE,
  nrsequencial_origem NUMBER(10),
  cdidentificador     VARCHAR2(40),
  txhash              VARCHAR2(100)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_HASH.nrsequencial
  is 'TI_HASH_SEQ';
comment on column EMS506UNICOO.TI_HASH.tpintegracao
  is 'FN, CL, TP, TR';
comment on column EMS506UNICOO.TI_HASH.dtgeracao
  is 'SYSDATE';
comment on column EMS506UNICOO.TI_HASH.nrsequencial_origem
  is 'FN: NRREGISTRO_FORNECEDOR; CL: NRREGISTRO_CLIENTE; TP, TR: NRREGISTRO_TITULO';
comment on column EMS506UNICOO.TI_HASH.cdidentificador
  is 'FN: CDFORNECEDOR; CL: CDCLIENTE; TP, TR: NRDOCUMENTO';
create index EMS506UNICOO.IDX_TI_HASH_02 on EMS506UNICOO.TI_HASH (NRSEQUENCIAL_ORIGEM, TPINTEGRACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_HASH_03 on EMS506UNICOO.TI_HASH (TPINTEGRACAO, NRSEQUENCIAL_ORIGEM, CDIDENTIFICADOR)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_HASH_04 on EMS506UNICOO.TI_HASH (CDIDENTIFICADOR)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create unique index EMS506UNICOO.IDX_TI_HASH_PK on EMS506UNICOO.TI_HASH (NRSEQUENCIAL)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_INCLUIR_EMS_APB
prompt =================================
prompt
create table EMS506UNICOO.TI_INCLUIR_EMS_APB
(
  cdempresa         VARCHAR2(5),
  nrdocumento       VARCHAR2(99),
  tpdocumento       VARCHAR2(3),
  cdsituacao        CHAR(1),
  dttiulo           DATE,
  vltitulo          NUMBER(10,2),
  nrregistro_titulo NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_ITEM_LANCAMENTO_CTBL
prompt ======================================
prompt
create table EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL
(
  nrseq_controle_integracao NUMBER(10) not null,
  cdsituacao                VARCHAR2(2),
  cod_cta_ctbl              VARCHAR2(20),
  ind_natur_lancto_ctbl     VARCHAR2(2) not null,
  cod_histor_padr           VARCHAR2(8),
  des_histor_lancto_ctbl    VARCHAR2(2000),
  dat_lancto                DATE,
  val_lancto_ctbl           NUMBER(12,2),
  cod_ccusto                VARCHAR2(11),
  cod_proj_financ           VARCHAR2(20),
  ind_ocorrencia            VARCHAR2(1),
  dat_processamento         DATE,
  dat_geracao               DATE,
  cod_estab                 VARCHAR2(6),
  des_docto                 VARCHAR2(20),
  nrperiodo                 NUMBER(6),
  cod_empresa               VARCHAR2(3),
  cod_unid_negoc            VARCHAR2(3),
  nrlancamento              NUMBER(6) not null,
  nrseq_lancto              NUMBER(6) not null,
  num_item_lancto_ctbl      NUMBER(10),
  cdhistorico               NUMBER(4)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_INT_TI_ILC_1 on EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL (NRSEQ_CONTROLE_INTEGRACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_LANCAMENTO_CTBL
prompt =================================
prompt
create table EMS506UNICOO.TI_LANCAMENTO_CTBL
(
  nrseq_controle_integracao NUMBER(10) not null,
  cdsituacao                VARCHAR2(2),
  cod_cta_ctbl              VARCHAR2(20),
  ind_natur_lancto_ctbl     VARCHAR2(2) not null,
  cod_histor_padr           VARCHAR2(8),
  des_histor_lancto_ctbl    VARCHAR2(2000),
  dat_lancto                DATE,
  val_lancto_ctbl           NUMBER(12,2),
  cod_ccusto                VARCHAR2(11),
  cod_proj_financ           VARCHAR2(20),
  ind_ocorrencia            VARCHAR2(1),
  dat_processamento         DATE,
  dat_geracao               DATE,
  cod_estab                 VARCHAR2(6),
  des_docto                 VARCHAR2(20),
  nrperiodo                 NUMBER(6),
  cod_empresa               VARCHAR2(3),
  cod_unid_negoc            VARCHAR2(3),
  nrlancamento              NUMBER(6) not null,
  nrseq_lancto              NUMBER(6) not null,
  num_item_lancto_ctbl      NUMBER(10)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_LANCAMENTO_CTBL
  add constraint UK_TI_LANCAMENTO_CTBL primary key (NRSEQ_CONTROLE_INTEGRACAO, NRLANCAMENTO, NRSEQ_LANCTO, IND_NATUR_LANCTO_CTBL)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_LOTE_CTBL
prompt ===========================
prompt
create table EMS506UNICOO.TI_LOTE_CTBL
(
  nrseq_controle_integracao NUMBER(10) not null,
  cdsituacao                VARCHAR2(2),
  nrperiodo                 NUMBER(6),
  cod_plano_cta_ctbl        VARCHAR2(8),
  cod_plano_ccusto          VARCHAR2(8),
  dat_lote_ctbl             DATE,
  dat_processamento         DATE,
  dat_geracao               DATE,
  des_lote_ctbl             VARCHAR2(40),
  aolote_integracao         VARCHAR2(1)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_LOTE_CTBL
  add constraint PK_TI_LOTE_CTBL primary key (NRSEQ_CONTROLE_INTEGRACAO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_LOTE_CTBL_MATRIZ_TRADUCAO
prompt ===========================================
prompt
create table EMS506UNICOO.TI_LOTE_CTBL_MATRIZ_TRADUCAO
(
  cod_cta_ctbl             VARCHAR2(20) not null,
  cod_ccusto               VARCHAR2(11) not null,
  cod_estab                VARCHAR2(6) not null,
  cod_plano_ccusto         VARCHAR2(8) not null,
  des_histor_lancto_ctbl   VARCHAR2(100) not null,
  destino_cod_ccusto       VARCHAR2(11),
  destino_cod_estab        VARCHAR2(6),
  destino_cod_plano_ccusto VARCHAR2(8),
  cdhistorico              NUMBER(4)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_LOTE_CTBL_MATRIZ_TRADUCAO
  add constraint PK_TI_LOTE_CTBL_MATRIZ_TRAD primary key (COD_CTA_CTBL, COD_CCUSTO, COD_ESTAB, COD_PLANO_CCUSTO, DES_HISTOR_LANCTO_CTBL)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_MATRIZ_PAGAR
prompt ==============================
prompt
create table EMS506UNICOO.TI_MATRIZ_PAGAR
(
  nrregistro_titulo    NUMBER(10) not null,
  nrregistro           NUMBER(8) not null,
  cdempresa            VARCHAR2(5) not null,
  nrdocumento          VARCHAR2(12),
  cdportador           VARCHAR2(3),
  tpdocumento          VARCHAR2(3),
  cdsituacao           VARCHAR2(1),
  descsituacao         VARCHAR2(21),
  dtvencimento         DATE,
  dttitulo             DATE,
  cdfornecedor         VARCHAR2(6) not null,
  cdgrupo_fornecedor   NUMBER(4) not null,
  nogrupo_fornecedor   VARCHAR2(30),
  nrcgc_cpf            VARCHAR2(15),
  vltitulo             NUMBER,
  dtultimo_recebimento DATE,
  vlpago               NUMBER,
  vldevido             NUMBER,
  vldesconto           NUMBER,
  vlabatimento         NUMBER,
  vlabatimento_2       NUMBER,
  vljuros              NUMBER,
  vlmulta              NUMBER,
  vltaxa_bancaria      NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IX_TI_MATRIZ_NRREGISTRO on EMS506UNICOO.TI_MATRIZ_PAGAR (NRREGISTRO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_MATRIZ_PAGAR
  add constraint IX_TI_MATRIZ_PAGAR primary key (NRREGISTRO_TITULO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_MATRIZ_PAGAR_2018_02_20
prompt =========================================
prompt
create table EMS506UNICOO.TI_MATRIZ_PAGAR_2018_02_20
(
  nrregistro_titulo    NUMBER(10) not null,
  nrregistro           NUMBER(8) not null,
  cdempresa            VARCHAR2(5) not null,
  nrdocumento          VARCHAR2(12),
  cdportador           VARCHAR2(3),
  tpdocumento          VARCHAR2(3),
  cdsituacao           VARCHAR2(1),
  descsituacao         VARCHAR2(21),
  dtvencimento         DATE,
  dttitulo             DATE,
  cdfornecedor         VARCHAR2(6) not null,
  cdgrupo_fornecedor   NUMBER(4) not null,
  nogrupo_fornecedor   VARCHAR2(30),
  nrcgc_cpf            VARCHAR2(15),
  vltitulo             NUMBER,
  dtultimo_recebimento DATE,
  vlpago               NUMBER,
  vldevido             NUMBER,
  vldesconto           NUMBER,
  vlabatimento         NUMBER,
  vlabatimento_2       NUMBER,
  vljuros              NUMBER,
  vlmulta              NUMBER,
  vltaxa_bancaria      NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_MATRIZ_RECEBER
prompt ================================
prompt
create table EMS506UNICOO.TI_MATRIZ_RECEBER
(
  cdcliente            VARCHAR2(10),
  nrregistro_titulo    NUMBER(10) not null,
  nrregistro           NUMBER(8) not null,
  nrdocumento          VARCHAR2(12),
  cdsituacao           VARCHAR2(1),
  descsituacao         VARCHAR2(21),
  dttitulo             DATE,
  dtvencimento         DATE,
  vlfaturado           NUMBER,
  vltitulo             NUMBER,
  dtultimo_recebimento DATE,
  vlmulta              NUMBER,
  vljuros              NUMBER,
  vlabatimento         NUMBER,
  vlabatimento_2       NUMBER,
  vlrecebido           NUMBER,
  vldesconto           NUMBER,
  vlaberto             NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_MATRIZ_RECEBER_2018_02_20
prompt ===========================================
prompt
create table EMS506UNICOO.TI_MATRIZ_RECEBER_2018_02_20
(
  cdcliente            VARCHAR2(10),
  nrregistro_titulo    NUMBER(10) not null,
  nrregistro           NUMBER(8) not null,
  nrdocumento          VARCHAR2(12),
  cdsituacao           VARCHAR2(1),
  descsituacao         VARCHAR2(21),
  dttitulo             DATE,
  dtvencimento         DATE,
  vlfaturado           NUMBER,
  vltitulo             NUMBER,
  dtultimo_recebimento DATE,
  vlmulta              NUMBER,
  vljuros              NUMBER,
  vlabatimento         NUMBER,
  vlabatimento_2       NUMBER,
  vlrecebido           NUMBER,
  vldesconto           NUMBER,
  vlaberto             NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_MATRIZ_RECEBER_2018_02_28
prompt ===========================================
prompt
create table EMS506UNICOO.TI_MATRIZ_RECEBER_2018_02_28
(
  cdcliente            VARCHAR2(10),
  nrregistro_titulo    NUMBER(10) not null,
  nrregistro           NUMBER(8) not null,
  nrdocumento          VARCHAR2(12),
  cdsituacao           VARCHAR2(1),
  descsituacao         VARCHAR2(21),
  dttitulo             DATE,
  dtvencimento         DATE,
  vlfaturado           NUMBER,
  vltitulo             NUMBER,
  dtultimo_recebimento DATE,
  vlmulta              NUMBER,
  vljuros              NUMBER,
  vlabatimento         NUMBER,
  vlabatimento_2       NUMBER,
  vlrecebido           NUMBER,
  vldesconto           NUMBER,
  vlaberto             NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_MENSAGEM_PROCESSO
prompt ===================================
prompt
create table EMS506UNICOO.TI_MENSAGEM_PROCESSO
(
  nrmensagem   NUMBER(5) not null,
  cdintegracao VARCHAR2(30) not null,
  txfalha      VARCHAR2(100),
  cdacao       VARCHAR2(2)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_MENSAGEM_PROCESSO.nrmensagem
  is 'Nr mensagem da falha do EMS';
comment on column EMS506UNICOO.TI_MENSAGEM_PROCESSO.cdintegracao
  is 'Tabela de Origem do Erro';
comment on column EMS506UNICOO.TI_MENSAGEM_PROCESSO.txfalha
  is 'Descricao da FAlha';
comment on column EMS506UNICOO.TI_MENSAGEM_PROCESSO.cdacao
  is 'CA - Cancela, AT- Atualiza, RE - Reprocessa';
alter table EMS506UNICOO.TI_MENSAGEM_PROCESSO
  add constraint PK_TI_MENSAGEM_PROCESSO primary key (NRMENSAGEM, CDINTEGRACAO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_MOVIMENTO_CTA_CORRENTE
prompt ========================================
prompt
create table EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE
(
  nrseq_controle_integracao  NUMBER(9),
  cdsituacao                 VARCHAR2(2),
  cod_cta_corren             VARCHAR2(10),
  dat_movto_cta_corren       DATE,
  ind_tip_movto_cta_corren   VARCHAR2(2),
  cod_tip_trans_cx           VARCHAR2(8),
  ind_fluxo_movto_cta_corren VARCHAR2(3),
  cod_cenar_ctbl             VARCHAR2(8),
  cod_histor_padr            VARCHAR2(8),
  val_movto_cta_corren       NUMBER(9,2),
  cod_docto_movto_cta_bco    VARCHAR2(25),
  cod_modul_dtsul            VARCHAR2(3),
  ind_erro_valid             VARCHAR2(8),
  des_histor_padr            VARCHAR2(2000),
  num_id_movto_cta_corren    INTEGER,
  dat_envio                  DATE,
  dat_processamento          DATE,
  cod_plano_ccusto           VARCHAR2(8),
  cod_ccusto                 VARCHAR2(11)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.cod_cta_corren
  is 'CODIGO DA CONTA CORRENTE';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.dat_movto_cta_corren
  is 'DATA MOVIMENTO';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.ind_tip_movto_cta_corren
  is 'INDICADOR DO TIPO DE MOVIMENTO (RE - REALIZADO | NR NAO REALIZADO)';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.cod_tip_trans_cx
  is 'CODIGO DO TIPO DE TRANSACAO DE CAIXA';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.ind_fluxo_movto_cta_corren
  is 'INDICADOR DO FLUXO DO MOVIMENTO (ENT - ENTRADA | SAI - SAIDA)';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.cod_cenar_ctbl
  is 'CODIGO DO CENARIO CONTABIL';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.cod_histor_padr
  is 'CODIGO DO HISTORICO PADRAO';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.val_movto_cta_corren
  is 'VALOR DO MOVIMENTO';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.cod_docto_movto_cta_bco
  is 'DOCUMENTO DO BANCO QUE POSSA SER UTILIZADO COMO REFERENCIA PARA O MOVIMENTO A SER CRIADO';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.cod_modul_dtsul
  is 'CODIGO DO MODULO. NORMALMENTE UTILIZADO COMO "CMG" PARA MOVIMENTO DO CAIXA E BANCOS';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.ind_erro_valid
  is 'INICIALMENTE ESTE ATRIBUTO DEVERA RECEBER O VALOR "NAO". APOS EXECUCAO DA API, CASO OCORRA ALGUM ERRO DE IMPORTACAO, ESTE TERA O VALOR "SIM"';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.des_histor_padr
  is 'DESCRICAO DO HISTORICO';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.num_id_movto_cta_corren
  is 'NO RETORNO DA API ESTE ATRIBUTO CONTERA O NUMERO DO MOVIMENTO DE CONTA CORRENTE QUE FOI CRIADO. SE ESTE NUMERO FOR IGUAL A "0" E PORQUE OCORREU ALGUM ERRO DURANTE O PROCESSO DE IMPOERTACAO E O MOVIMENTO NAO FOI IMPORTADO';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.dat_envio
  is 'DATA DE ENVIO DO REGISTRO';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.dat_processamento
  is 'DATA DE PROCESSAMENTO';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.cod_plano_ccusto
  is 'CODIGO DO PLANO DE CENTRO DE CUSTO DO EMS5';
comment on column EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE.cod_ccusto
  is 'CODIGO DO CENTRO DE CUSTO DO EMS5';

prompt
prompt Creating table TI_MOVTO_TIT_AP
prompt ==============================
prompt
create table EMS506UNICOO.TI_MOVTO_TIT_AP
(
  dtmovimento_ems     DATE,
  dtmovimento_unicoo  DATE,
  txultima_falha      VARCHAR2(4000),
  num_id_tit_ap       NUMBER,
  num_id_movto_tit_ap NUMBER not null,
  cod_ser_docto       VARCHAR2(6),
  cod_tit_ap          VARCHAR2(10),
  cod_parcela         VARCHAR2(6),
  val_liq_tit_ap      NUMBER(12,2),
  dat_vencto_tit_ap   DATE,
  val_movto_tit_ap    NUMBER(12,2),
  val_multa_tit_ap    NUMBER(12,2),
  val_juros           NUMBER(12,2),
  val_desconto        NUMBER(12,2),
  val_abat_tit_ap     NUMBER(12,2),
  val_despes_bcia     NUMBER(12,2),
  dat_cr_movto_tit_ap DATE,
  dat_transacao       DATE,
  ind_trans_ap_abrev  VARCHAR2(6),
  cod_tit_acr_bco     VARCHAR2(20),
  cod_refer           VARCHAR2(10),
  cod_estab           VARCHAR2(6),
  cod_espec_docto     VARCHAR2(6),
  ind_tip_espec_docto VARCHAR2(17),
  nrregistro_titulo   NUMBER(8),
  nrdocumento         VARCHAR2(12)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_EMS_MOVTO_TIT_AP_02 on EMS506UNICOO.TI_MOVTO_TIT_AP (NRREGISTRO_TITULO, NRDOCUMENTO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_EMS_MOVTO_TIT_AP_04 on EMS506UNICOO.TI_MOVTO_TIT_AP (NRDOCUMENTO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_MOVTO_TIT_AP on EMS506UNICOO.TI_MOVTO_TIT_AP (NUM_ID_TIT_AP, NRREGISTRO_TITULO, IND_TRANS_AP_ABREV)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_MOVTO_TIT_AP_03 on EMS506UNICOO.TI_MOVTO_TIT_AP (COD_ESTAB, COD_ESPEC_DOCTO, COD_SER_DOCTO, COD_TIT_AP, COD_PARCELA)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_MOVTO_TIT_AP
  add constraint PK_EMS_MOVTO_TITULO_AP primary key (NUM_ID_MOVTO_TIT_AP)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_OUTROS_PROCESSOS
prompt ==================================
prompt
create table EMS506UNICOO.TI_OUTROS_PROCESSOS
(
  cdprocesso VARCHAR2(40) not null,
  txcaption  VARCHAR2(20) not null,
  txprocesso VARCHAR2(4000)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_OUTROS_PROCESSOS
  add constraint PK_TI_OUTROS_PROCESSOS primary key (CDPROCESSO, TXCAPTION)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_PARAMETRO_INTEGRAC_BKP_2018
prompt =============================================
prompt
create table EMS506UNICOO.TI_PARAMETRO_INTEGRAC_BKP_2018
(
  cdparametro   VARCHAR2(40) not null,
  noparametro   VARCHAR2(200) not null,
  vlparametro   VARCHAR2(100) not null,
  aoparametro   VARCHAR2(1),
  txobservacoes VARCHAR2(2500)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_PARAMETRO_INTEGRACAO
prompt ======================================
prompt
create table EMS506UNICOO.TI_PARAMETRO_INTEGRACAO
(
  cdparametro   VARCHAR2(40) not null,
  noparametro   VARCHAR2(200) not null,
  vlparametro   VARCHAR2(100) not null,
  aoparametro   VARCHAR2(1),
  txobservacoes VARCHAR2(2500)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_PARAMETRO_INTEGRACAO.cdparametro
  is 'Codigo do parametro';
comment on column EMS506UNICOO.TI_PARAMETRO_INTEGRACAO.noparametro
  is 'Descricao do parametro';
comment on column EMS506UNICOO.TI_PARAMETRO_INTEGRACAO.vlparametro
  is 'Valor do parametro';
comment on column EMS506UNICOO.TI_PARAMETRO_INTEGRACAO.aoparametro
  is 'sem uso';
comment on column EMS506UNICOO.TI_PARAMETRO_INTEGRACAO.txobservacoes
  is 'observacoes';
alter table EMS506UNICOO.TI_PARAMETRO_INTEGRACAO
  add constraint PK_PARAMETRO_INTEGRACAO_EMS primary key (CDPARAMETRO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_PESSOA
prompt ========================
prompt
create table EMS506UNICOO.TI_PESSOA
(
  nrregistro             NUMBER(10) not null,
  noabreviado_cliente    VARCHAR2(15),
  noabreviado_fornecedor VARCHAR2(15),
  cdn_fornecedor         NUMBER(10),
  cdn_cliente            NUMBER(10),
  nrregistro_pai         NUMBER(10),
  txregra_agrupamento    VARCHAR2(20),
  nopessoa               VARCHAR2(60),
  dtnascimento           DATE,
  nrcgc_cpf              VARCHAR2(15),
  dtgeracao              DATE,
  dtultima_atualizacao   DATE
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_PESSOA.nrregistro
  is 'Registro da pessoa no sistema de origem';
comment on column EMS506UNICOO.TI_PESSOA.noabreviado_cliente
  is 'Nome abreviado do cliente';
comment on column EMS506UNICOO.TI_PESSOA.noabreviado_fornecedor
  is 'Nome abreviado do Fornecedor';
comment on column EMS506UNICOO.TI_PESSOA.cdn_fornecedor
  is 'Codigo do Fornecedor no EMS';
comment on column EMS506UNICOO.TI_PESSOA.cdn_cliente
  is 'Codigo do Cliente no EMS';
comment on column EMS506UNICOO.TI_PESSOA.nrregistro_pai
  is '????';
comment on column EMS506UNICOO.TI_PESSOA.txregra_agrupamento
  is '????';
comment on column EMS506UNICOO.TI_PESSOA.nopessoa
  is 'Nome da pessoa';
comment on column EMS506UNICOO.TI_PESSOA.dtnascimento
  is 'Data de nascimento';
comment on column EMS506UNICOO.TI_PESSOA.nrcgc_cpf
  is 'CPF ( pessoa fisica ) ou CNPJ ( pessoa juridica )';
comment on column EMS506UNICOO.TI_PESSOA.dtgeracao
  is 'data que foi gerado o registro';
comment on column EMS506UNICOO.TI_PESSOA.dtultima_atualizacao
  is 'data da ultima atualizacao';
create index EMS506UNICOO.IDX_TI_PESSOA_01 on EMS506UNICOO.TI_PESSOA (NOABREVIADO_CLIENTE)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_PESSOA
  add constraint PK_TI_PESSOA primary key (NRREGISTRO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_PESSOA
  add constraint UK_TI_PESSOA_CLIENTE unique (NOABREVIADO_CLIENTE, NRREGISTRO_PAI)
  disable;
alter table EMS506UNICOO.TI_PESSOA
  add constraint UK_TI_PESSOA_FORNECEDOR unique (NOABREVIADO_FORNECEDOR, NRREGISTRO_PAI)
  disable;

prompt
prompt Creating table TI_PESSOA_BKP_20181005
prompt =====================================
prompt
create table EMS506UNICOO.TI_PESSOA_BKP_20181005
(
  nrregistro             NUMBER(10) not null,
  noabreviado_cliente    VARCHAR2(15),
  noabreviado_fornecedor VARCHAR2(15),
  cdn_fornecedor         NUMBER(10),
  cdn_cliente            NUMBER(10),
  nrregistro_pai         NUMBER(10),
  txregra_agrupamento    VARCHAR2(20),
  nopessoa               VARCHAR2(60),
  dtnascimento           DATE,
  nrcgc_cpf              VARCHAR2(15),
  dtgeracao              DATE,
  dtultima_atualizacao   DATE
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_REGISTRO_PAI
prompt ==============================
prompt
create table EMS506UNICOO.TI_REGISTRO_PAI
(
  nrregistro_filho NUMBER,
  nrregistro_pai   NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TAXA_A_PAGAR
prompt ==============================
prompt
create table EMS506UNICOO.TI_TAXA_A_PAGAR
(
  cod_taxa             VARCHAR2(6),
  nom_taxa             VARCHAR2(40),
  ind_clas_impto       VARCHAR2(14),
  cod_unid_federac     VARCHAR2(3),
  cod_imposto          VARCHAR2(5),
  cod_classif_impto    VARCHAR2(5),
  cod_cta_ctbl         VARCHAR2(20),
  cod_plano_ctb_cbtl   VARCHAR2(8),
  cod_tip_fluxo_financ VARCHAR2(12),
  cod_taxa_agrupamento VARCHAR2(4),
  cod_espec_docto      VARCHAR2(3),
  cdn_fornecedor       VARCHAR2(10),
  aointegraimposto     VARCHAR2(2) default 'S'
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_TAXA_A_PAGAR.cod_taxa
  is 'Codigo do imposto';
comment on column EMS506UNICOO.TI_TAXA_A_PAGAR.nom_taxa
  is 'Descric?o do imposto';
comment on column EMS506UNICOO.TI_TAXA_A_PAGAR.ind_clas_impto
  is '???';
comment on column EMS506UNICOO.TI_TAXA_A_PAGAR.cod_unid_federac
  is 'Unid Federacao quando o imposto e estadual';
comment on column EMS506UNICOO.TI_TAXA_A_PAGAR.cod_imposto
  is 'Codigo do imposto';
comment on column EMS506UNICOO.TI_TAXA_A_PAGAR.cod_classif_impto
  is 'Codigo do imposto';
comment on column EMS506UNICOO.TI_TAXA_A_PAGAR.cod_cta_ctbl
  is 'Conta Contabil no EMS';
comment on column EMS506UNICOO.TI_TAXA_A_PAGAR.cod_plano_ctb_cbtl
  is '????';
comment on column EMS506UNICOO.TI_TAXA_A_PAGAR.cod_tip_fluxo_financ
  is 'Codigo do Fluxo no EMS';
comment on column EMS506UNICOO.TI_TAXA_A_PAGAR.cod_taxa_agrupamento
  is 'Quando este imposto  agrega a outro, informar aki o imposto';
comment on column EMS506UNICOO.TI_TAXA_A_PAGAR.cod_espec_docto
  is 'Especie de documento no EMS';
comment on column EMS506UNICOO.TI_TAXA_A_PAGAR.cdn_fornecedor
  is 'Codigo do fornecedor no EMS';
comment on column EMS506UNICOO.TI_TAXA_A_PAGAR.aointegraimposto
  is 'Devera integra o imposto ? Aqui define se o imposto sera integrado com o EMS ou não.';
create index EMS506UNICOO.PK_TAXA_A_PAGAR_EMS on EMS506UNICOO.TI_TAXA_A_PAGAR (COD_TAXA)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TAXA_A_RECEBER
prompt ================================
prompt
create table EMS506UNICOO.TI_TAXA_A_RECEBER
(
  cod_taxa_unicoo       VARCHAR2(6),
  nom_taxa              VARCHAR2(40),
  ind_clas_impto_unicoo VARCHAR2(14),
  cod_imposto_t11       VARCHAR2(5),
  cod_classif_impto_t11 VARCHAR2(5)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_TAXA_A_RECEBER.cod_taxa_unicoo
  is 'Codigo do imposto';
comment on column EMS506UNICOO.TI_TAXA_A_RECEBER.nom_taxa
  is 'Descric?o do imposto';
comment on column EMS506UNICOO.TI_TAXA_A_RECEBER.ind_clas_impto_unicoo
  is '???';
comment on column EMS506UNICOO.TI_TAXA_A_RECEBER.cod_imposto_t11
  is 'Codigo do imposto';
comment on column EMS506UNICOO.TI_TAXA_A_RECEBER.cod_classif_impto_t11
  is 'Codigo do imposto';
create index EMS506UNICOO.PK_TAXA_A_RECEBER_EMS on EMS506UNICOO.TI_TAXA_A_RECEBER (COD_TAXA_UNICOO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIPO_DE_ENDERECO
prompt ==================================
prompt
create table EMS506UNICOO.TI_TIPO_DE_ENDERECO
(
  tpendereco    VARCHAR2(4) not null,
  notipendereco VARCHAR2(20),
  nrprioridade  NUMBER(2)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_TIPO_DE_ENDERECO.tpendereco
  is 'Tipo de endereco';
comment on column EMS506UNICOO.TI_TIPO_DE_ENDERECO.notipendereco
  is 'descricao do tipo de endereco';
comment on column EMS506UNICOO.TI_TIPO_DE_ENDERECO.nrprioridade
  is '??????????';
alter table EMS506UNICOO.TI_TIPO_DE_ENDERECO
  add constraint PK_TI_TIPO_DE_ENDERECO primary key (TPENDERECO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIPO_DE_FORNECEDOR
prompt ====================================
prompt
create table EMS506UNICOO.TI_TIPO_DE_FORNECEDOR
(
  tpfornecedor         VARCHAR2(1) not null,
  cdgrupo_fornecedor   VARCHAR2(2),
  notipo_fornecedor    VARCHAR2(20),
  cod_estab            VARCHAR2(3),
  cod_tip_fluxo_financ VARCHAR2(12),
  cod_cta_ctbl         VARCHAR2(20),
  cod_ccusto           VARCHAR2(11),
  cod_espec_docto      VARCHAR2(3),
  cod_cart_bcia        VARCHAR2(3),
  cod_empresa          VARCHAR2(3),
  cod_portador         VARCHAR2(5),
  cod_ser_docto        VARCHAR2(2),
  cod_forma_pagto      VARCHAR2(4),
  cod_grp_fornecedor   VARCHAR2(4),
  cod_tip_fornecedor   VARCHAR2(3) not null
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_TIPO_DE_FORNECEDOR
  add constraint PK_TI_TIPO_DE_FORNECEDOR primary key (COD_TIP_FORNECEDOR)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_TIPO_DE_FORNECEDOR
  add constraint UK_TI_TIPO_DE_FORNECEDOR unique (TPFORNECEDOR, CDGRUPO_FORNECEDOR)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIPO_MOV_TIT_ACR_2018_04_18
prompt =============================================
prompt
create table EMS506UNICOO.TI_TIPO_MOV_TIT_ACR_2018_04_18
(
  nrsequencial              NUMBER(4) not null,
  cdempresa                 VARCHAR2(5) not null,
  cdmovimento               VARCHAR2(4) not null,
  cdmodulo                  VARCHAR2(4) not null,
  nomovimento               VARCHAR2(40),
  cod_grp_clien             VARCHAR2(4) not null,
  cod_estab                 VARCHAR2(3),
  cod_tip_fluxo_financ      VARCHAR2(12),
  cod_cta_ctbl              VARCHAR2(20),
  cod_ccusto                VARCHAR2(11),
  cod_espec_docto           VARCHAR2(3),
  cod_cart_bcia             VARCHAR2(3),
  cod_empresa               VARCHAR2(3),
  cod_portador              VARCHAR2(6),
  cod_tip_fluxo_financ_ems2 VARCHAR2(12)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIPO_MOV_TIT_APB_2018_04_18
prompt =============================================
prompt
create table EMS506UNICOO.TI_TIPO_MOV_TIT_APB_2018_04_18
(
  nrsequencial         NUMBER(4) not null,
  cdempresa            VARCHAR2(5) not null,
  cdmovimento          VARCHAR2(4) not null,
  cdmodulo             VARCHAR2(4) not null,
  nomovimento          VARCHAR2(40),
  cod_estab            VARCHAR2(3),
  cod_tip_fluxo_financ VARCHAR2(12),
  cod_cta_ctbl         VARCHAR2(20),
  cod_ccusto           VARCHAR2(11),
  cod_espec_docto      VARCHAR2(3),
  cod_cart_bcia        VARCHAR2(3),
  cod_empresa          VARCHAR2(3),
  cod_portador         VARCHAR2(5),
  cod_ser_docto        VARCHAR2(2),
  cod_forma_pagto      VARCHAR2(4),
  cod_grp_fornecedor   VARCHAR2(4) not null,
  cddivisao            VARCHAR2(4),
  cdcentro_custo       VARCHAR2(4)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIPO_MOVIMENTO_CMG
prompt ====================================
prompt
create table EMS506UNICOO.TI_TIPO_MOVIMENTO_CMG
(
  nrsequencial     NUMBER(4) not null,
  cdempresa        VARCHAR2(5) not null,
  cdmodulo         VARCHAR2(4) not null,
  cdhistorico      VARCHAR2(4) not null,
  nohistorico      VARCHAR2(60),
  cod_unid_negoc   VARCHAR2(3),
  cod_tip_trans_cx VARCHAR2(8),
  cod_cenar_ctbl   VARCHAR2(8),
  cod_histor_padr  VARCHAR2(8),
  des_histor_padr  VARCHAR2(40),
  caixa            VARCHAR2(11) not null
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIPO_MOVIMENTO_CMG_CAIXA
prompt ==========================================
prompt
create table EMS506UNICOO.TI_TIPO_MOVIMENTO_CMG_CAIXA
(
  nrconta_corrente VARCHAR2(12) not null,
  cod_cta_corren   VARCHAR2(10),
  cod_estab        VARCHAR2(3),
  cod_portador     VARCHAR2(5),
  aointegramovto   VARCHAR2(1) default 'N'
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIPO_MOVIMENTO_TIT_ACR
prompt ========================================
prompt
create table EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR
(
  nrsequencial              NUMBER(4) not null,
  cdempresa                 VARCHAR2(5) not null,
  cdmovimento               VARCHAR2(4) not null,
  cdmodulo                  VARCHAR2(4) not null,
  nomovimento               VARCHAR2(40),
  cod_grp_clien             VARCHAR2(4) not null,
  cod_estab                 VARCHAR2(3),
  cod_tip_fluxo_financ      VARCHAR2(12),
  cod_cta_ctbl              VARCHAR2(20),
  cod_ccusto                VARCHAR2(11),
  cod_espec_docto           VARCHAR2(3),
  cod_cart_bcia             VARCHAR2(3),
  cod_empresa               VARCHAR2(3),
  cod_portador              VARCHAR2(6),
  cod_tip_fluxo_financ_ems2 VARCHAR2(12)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR.nrsequencial
  is 'SQ_TI_TIPO_MOVIMENTO_TIT_APB';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR.cdempresa
  is 'Codigo da empresa no sistema de origem';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR.cdmovimento
  is 'Codigo da movimentac?o na origem. No unicoo, para faturamento preencher com codigo do faturamento, e Receber preencher com historico';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR.cdmodulo
  is 'Identificacao do modulo da origem';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR.nomovimento
  is 'Descric?o do movimento';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR.cod_grp_clien
  is 'Codigo do grupo de cliente do sistema origem. * para todos';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR.cod_estab
  is 'Codigo do estabelecimento que sera integrado o titulo';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR.cod_tip_fluxo_financ
  is 'Fluxo financeiro do EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR.cod_cta_ctbl
  is 'Conta Contabil do EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR.cod_ccusto
  is 'Centro de Custo do EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR.cod_espec_docto
  is 'Codigo da Especie do EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR.cod_cart_bcia
  is '?????????????';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR.cod_empresa
  is 'Codigo da empresa no EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR.cod_portador
  is 'Codigo do portador no EMS';
alter table EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR
  add constraint PK_TI_TIPO_MOVIMENTO_TIT_ACR primary key (CDMOVIMENTO, CDMODULO, COD_GRP_CLIEN, CDEMPRESA)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_ACR
  add constraint UK_TI_TIPO_MOVIMENTO_TIT_ACR unique (NRSEQUENCIAL)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIPO_MOVIMENTO_TIT_APB
prompt ========================================
prompt
create table EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB
(
  nrsequencial         NUMBER(4) not null,
  cdempresa            VARCHAR2(5) not null,
  cdmovimento          VARCHAR2(4) not null,
  cdmodulo             VARCHAR2(4) not null,
  nomovimento          VARCHAR2(40),
  cod_estab            VARCHAR2(3),
  cod_tip_fluxo_financ VARCHAR2(12),
  cod_cta_ctbl         VARCHAR2(20),
  cod_ccusto           VARCHAR2(11),
  cod_espec_docto      VARCHAR2(3),
  cod_cart_bcia        VARCHAR2(3),
  cod_empresa          VARCHAR2(3),
  cod_portador         VARCHAR2(5),
  cod_ser_docto        VARCHAR2(2),
  cod_forma_pagto      VARCHAR2(4),
  cod_grp_fornecedor   VARCHAR2(4) not null,
  cddivisao            VARCHAR2(4),
  cdcentro_custo       VARCHAR2(4)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.nrsequencial
  is 'SQ_TI_TIPO_MOVIMENTO_TIT_APB';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cdempresa
  is 'Codigo da empresa na origem';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cdmovimento
  is 'Codigo do Movimento Origem. Prestador: Tipo Prestador, Cts Pagar: Codigo do historico';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cdmodulo
  is 'Identificador do Modulo de origem';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.nomovimento
  is 'Descricao da origem do movimento';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cod_estab
  is 'Codigo do estabelecimento do EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cod_tip_fluxo_financ
  is 'Codigo do fluxo financeiro do EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cod_cta_ctbl
  is 'Codigo da Conta Contabil do EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cod_ccusto
  is 'Codigo do Centro de Custo do EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cod_espec_docto
  is 'Codigo da Especie do documento do EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cod_cart_bcia
  is 'Codigo da Carteira Bancaria do EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cod_empresa
  is 'Codigo da Empresa no EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cod_portador
  is 'Codigo do Portador no EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cod_ser_docto
  is 'Codigo da Serie do documento no EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cod_forma_pagto
  is 'Codigo da forma de pagamento no EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cod_grp_fornecedor
  is 'Codigo do grupo de fornecedor no EMS';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cddivisao
  is '????';
comment on column EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB.cdcentro_custo
  is '????';
alter table EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB
  add constraint PK_TIPO_MOVIMENTO_TIT_APB primary key (NRSEQUENCIAL, CDEMPRESA, CDMOVIMENTO, CDMODULO, COD_GRP_FORNECEDOR)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB
  add constraint UK_TIPO_MOVIMENTO_TIT_APB unique (NRSEQUENCIAL)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_TIPO_MOVIMENTO_TIT_APB
  add constraint UK_TIPO_MOVIMENTO_TIT_APB_2 unique (CDEMPRESA, CDMOVIMENTO, CDMODULO, COD_ESTAB)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIPO_MOVTO_TIT_ACR_FECHADO
prompt ============================================
prompt
create table EMS506UNICOO.TI_TIPO_MOVTO_TIT_ACR_FECHADO
(
  cdtransacao   VARCHAR2(10),
  notransacao   VARCHAR2(999),
  cod_transacao NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index UNICOOGPS.IX_CDTRANS on EMS506UNICOO.TI_TIPO_MOVTO_TIT_ACR_FECHADO (CDTRANSACAO)
  tablespace TS_GP
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIPO_PROCESSO_INTEGRACAO
prompt ==========================================
prompt
create table EMS506UNICOO.TI_TIPO_PROCESSO_INTEGRACAO
(
  cdprocesso VARCHAR2(25),
  aochecado  CHAR(1),
  cdordem    NUMBER(2),
  cdvalor    VARCHAR2(30) not null
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_TIPO_PROCESSO_INTEGRACAO
  add constraint PK_TI_TIPO_PROCESSO_INTEGRACAO primary key (CDVALOR)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIPO_PROCESSO_TABELA
prompt ======================================
prompt
create table EMS506UNICOO.TI_TIPO_PROCESSO_TABELA
(
  cdprocesso VARCHAR2(2) not null,
  cdtabela   VARCHAR2(30) not null,
  cdordem    NUMBER(2)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_TIPO_PROCESSO_TABELA
  add constraint PK_TI_TIPO_PROCESSO_TABELA primary key (CDPROCESSO, CDTABELA)
  using index 
  tablespace USERS
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIT_ACR
prompt =========================
prompt
create table EMS506UNICOO.TI_TIT_ACR
(
  nrseq_controle_integracao NUMBER(10) not null,
  cdsituacao                VARCHAR2(4) not null,
  cod_cart_bcia             VARCHAR2(3),
  cod_ccusto                VARCHAR2(11),
  cod_cliente               NUMBER(9),
  cod_cta_ctbl              VARCHAR2(20),
  cod_empresa               VARCHAR2(3),
  cod_espec_docto           VARCHAR2(3),
  cod_estab                 VARCHAR2(3),
  cod_id_feder              VARCHAR2(20),
  cod_id_feder_jurid        VARCHAR2(20),
  cod_pais                  VARCHAR2(3),
  cod_parcela               VARCHAR2(6),
  cod_portador              VARCHAR2(5),
  cod_ser_docto             VARCHAR2(3),
  cod_tip_fluxo_financ      VARCHAR2(12),
  cod_tit_acr_bco           VARCHAR2(20),
  cod_titulo_acr            VARCHAR2(10),
  dat_desconto              DATE,
  dat_emissao               DATE,
  dat_envio                 DATE,
  dat_previsao_liquidac     DATE,
  dat_processamento         DATE,
  dat_vencto                DATE,
  des_text_histor           VARCHAR2(200),
  ind_ocorrencia            NUMBER(1),
  ind_tip_espec_docto       VARCHAR2(3),
  ind_tipo_pessoa           VARCHAR2(1),
  val_desconto              NUMBER(9,2),
  val_ir                    NUMBER(9,2),
  val_liq_titulo            NUMBER(9,2),
  val_titulo                NUMBER(9,2),
  nrpessoa                  NUMBER(10),
  cod_plano_cta_ctbl        VARCHAR2(8),
  cod_plano_ccusto          VARCHAR2(8),
  val_perc_juros_dia_atraso NUMBER(8,4),
  val_perc_multa_atraso     NUMBER(8,4)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_TIT_ACR_01 on EMS506UNICOO.TI_TIT_ACR (CDSITUACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_TIT_ACR_TIT on EMS506UNICOO.TI_TIT_ACR (COD_ESPEC_DOCTO, COD_TITULO_ACR, COD_ESTAB, COD_SER_DOCTO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_TIT_ACR
  add constraint PK_TI_TIT_ACR primary key (NRSEQ_CONTROLE_INTEGRACAO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIT_ACR_COMPARATIVO
prompt =====================================
prompt
create table EMS506UNICOO.TI_TIT_ACR_COMPARATIVO
(
  cod_refer           VARCHAR2(20),
  nrsequencial        NUMBER,
  nrsequencial_origem NUMBER(10),
  tpintegracao        VARCHAR2(2),
  val_titulo          NUMBER,
  sit_ti_controle     VARCHAR2(2),
  sit_ti_tit_apb      VARCHAR2(2),
  vloriginal          NUMBER,
  val_sdo_tit_ap      NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIT_ACR_CONCILIACAO
prompt =====================================
prompt
create table EMS506UNICOO.TI_TIT_ACR_CONCILIACAO
(
  cdtipo_falha         VARCHAR2(30),
  dtgeracao            DATE,
  nrdocumento          VARCHAR2(12),
  nrregistro_cliente   NUMBER(8),
  dttitulo             DATE,
  dtultimo_recebimento DATE,
  nrregistro_titulo    NUMBER(8) not null,
  vltitulo             NUMBER(12,2),
  vlrecebido           NUMBER(12,2),
  cod_estab            VARCHAR2(3),
  cod_espec_docto      VARCHAR2(3),
  cod_ser_docto        VARCHAR2(3),
  cod_titulo_acr       VARCHAR2(10),
  cod_parcela          VARCHAR2(6),
  dat_liquidac_tit_acr DATE,
  num_id_tit_acr       NUMBER,
  cdn_cliente          NUMBER,
  val_sdo_tit_acr      NUMBER,
  val_origin_tit_acr   NUMBER,
  cod_tit_acr_bco      VARCHAR2(20),
  cdhistorico          VARCHAR2(4),
  cdcliente            VARCHAR2(10),
  dtcancelamento       DATE
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_TIT_ACR_CONCILIACAO on EMS506UNICOO.TI_TIT_ACR_CONCILIACAO (CDTIPO_FALHA)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIT_ACR_CTBL
prompt ==============================
prompt
create table EMS506UNICOO.TI_TIT_ACR_CTBL
(
  nrseq_controle_integracao NUMBER(8) not null,
  cdsituacao                VARCHAR2(2),
  val_aprop_ctbl            NUMBER(10,2),
  cod_estab                 VARCHAR2(3),
  cod_cta_ctbl              VARCHAR2(20),
  cod_unid_federac          VARCHAR2(3),
  cod_tip_fluxo_financ      VARCHAR2(12),
  ds_status                 VARCHAR2(10),
  cod_ccusto                VARCHAR2(11),
  dat_processamento         DATE
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_TIT_ACR_CTBL_01 on EMS506UNICOO.TI_TIT_ACR_CTBL (CDSITUACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_TIT_ACR_CTBL
  add constraint PK_TI_TIT_ACR_CTBL primary key (NRSEQ_CONTROLE_INTEGRACAO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIT_ACR_ESTORNO
prompt =================================
prompt
create table EMS506UNICOO.TI_TIT_ACR_ESTORNO
(
  nrseq_controle_integracao NUMBER(9) not null,
  cdsituacao                VARCHAR2(2) not null,
  nrdocumento               VARCHAR2(12) not null,
  cod_estab                 VARCHAR2(6) not null,
  cod_espec_docto           VARCHAR2(6) not null,
  cod_ser_docto             VARCHAR2(6) not null,
  cod_tit_acr               VARCHAR2(10) not null,
  cod_parcela               VARCHAR2(2) not null,
  cod_tit_acr_bco           VARCHAR2(20),
  cod_refer                 VARCHAR2(10) not null,
  num_id_movto_tit_acr      NUMBER not null,
  num_id_tit_acr            NUMBER not null,
  cod_portador              VARCHAR2(6) not null,
  dat_transacao             DATE not null,
  dat_envio                 DATE,
  cdn_cliente               NUMBER(9),
  dat_processamento         DATE,
  ind_niv_operac_acr        VARCHAR2(12),
  ind_tip_operac_acr        VARCHAR2(15)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_TIT_ACR_ESTORNO
  add constraint PK_TI_TIT_ACR_ESTORNO primary key (NRSEQ_CONTROLE_INTEGRACAO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIT_ACR_IMPOSTO
prompt =================================
prompt
create table EMS506UNICOO.TI_TIT_ACR_IMPOSTO
(
  nrseq_controle_integracao NUMBER(9) not null,
  cdsituacao                VARCHAR2(2),
  cod_parcela               VARCHAR2(2),
  ind_clas_impto            VARCHAR2(14),
  cod_titulo_acr            VARCHAR2(10),
  cod_unid_federac          VARCHAR2(3),
  cod_classif_impto         VARCHAR2(5),
  val_aliq_impto            NUMBER(5,2),
  val_rendto_tribut         NUMBER(10,2),
  cod_ser_docto             VARCHAR2(3),
  cod_imposto               VARCHAR2(5) not null,
  ind_ocorrencia            NUMBER(1),
  cod_estab                 VARCHAR2(3),
  cod_espec_docto           VARCHAR2(3),
  dat_processamento         DATE,
  val_imposto               NUMBER(10,2)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_TIT_ACR_IMPOSTO on EMS506UNICOO.TI_TIT_ACR_IMPOSTO (CDSITUACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_TIT_ACR_IMPOSTO
  add constraint PK_TI_TIT_ACR_IMPOSTO_1 primary key (NRSEQ_CONTROLE_INTEGRACAO, COD_IMPOSTO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIT_APB
prompt =========================
prompt
create table EMS506UNICOO.TI_TIT_APB
(
  nrseq_controle_integracao NUMBER(10) not null,
  nrpessoa                  NUMBER(10) not null,
  cdsituacao                VARCHAR2(2),
  cod_titulo_ap             VARCHAR2(10),
  val_per_desc              NUMBER(2,4),
  cod_cart_bcia             VARCHAR2(3),
  dat_processamento         DATE,
  cod_tip_fluxo_financ      VARCHAR2(12),
  cdn_fornecedor            NUMBER(12,2),
  qtd_parcela               NUMBER(3),
  ind_tipo_pessoa           VARCHAR2(1),
  cod_ser_docto             VARCHAR2(3),
  cod_parcela               VARCHAR2(2),
  val_desconto              NUMBER(9,2),
  des_text_histor           VARCHAR2(2000),
  cod_ccusto                VARCHAR2(11),
  cod_id_feder_jurid        VARCHAR2(20),
  cod_espec_docto           VARCHAR2(3),
  dat_emissao               DATE,
  dat_vencto                DATE,
  dat_previsao_pagto        DATE,
  dat_desconto              DATE,
  val_titulo                NUMBER(9,2),
  num_dias_atraso           NUMBER(2),
  val_juros                 NUMBER(9,2),
  val_perc_juros_dia_atraso NUMBER(9,6),
  val_perc_multa_atraso     NUMBER(2,2),
  cod_portador              VARCHAR2(5),
  cod_forma_pagto           VARCHAR2(3),
  cod_empresa               VARCHAR2(3),
  cod_estab                 VARCHAR2(3),
  cod_id_feder              VARCHAR2(20),
  ind_ocorrencia            NUMBER(1),
  nrregistro_titulo         NUMBER(12),
  dat_envio                 DATE,
  cod_plano_cta_ctbl        VARCHAR2(8) not null,
  cod_plano_ccusto          VARCHAR2(8) not null
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_TIT_APB_SITUACAO on EMS506UNICOO.TI_TIT_APB (CDSITUACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_TIT_APB
  add constraint PK_TI_TIT_APB primary key (NRSEQ_CONTROLE_INTEGRACAO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIT_APB_COMPARATIVO
prompt =====================================
prompt
create table EMS506UNICOO.TI_TIT_APB_COMPARATIVO
(
  cod_refer           VARCHAR2(20),
  nrsequencial        NUMBER,
  nrsequencial_origem NUMBER(10),
  tpintegracao        VARCHAR2(2),
  val_titulo          NUMBER,
  val_imposto         NUMBER,
  sit_ti_controle     VARCHAR2(2),
  sit_ti_tit_apb      VARCHAR2(2),
  vloriginal          NUMBER,
  val_sdo_tit_ap      NUMBER
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIT_APB_CTBL
prompt ==============================
prompt
create table EMS506UNICOO.TI_TIT_APB_CTBL
(
  nrseq_controle_integracao NUMBER(8) not null,
  cod_cta_ctbl              VARCHAR2(20),
  dat_processamento         DATE,
  cod_estab                 VARCHAR2(3),
  cod_tip_fluxo_financ      VARCHAR2(12) not null,
  cod_unid_federac          VARCHAR2(3),
  val_aprop_ctbl            NUMBER(10,2),
  cod_ccusto                VARCHAR2(11) not null,
  cdsituacao                VARCHAR2(2)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_TIT_APB_CTBL
  add constraint PK_TI_TIT_APB_CTBL_JPA primary key (NRSEQ_CONTROLE_INTEGRACAO, COD_CCUSTO, COD_TIP_FLUXO_FINANC)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TI_TIT_APB_IMPOSTO
prompt =================================
prompt
create table EMS506UNICOO.TI_TIT_APB_IMPOSTO
(
  nrseq_controle_integracao NUMBER(8) not null,
  cdsituacao                VARCHAR2(2),
  cod_ser_docto             VARCHAR2(3),
  ind_clas_impto            VARCHAR2(14),
  val_impto_ja_recolhid     NUMBER(10,2),
  val_outras_deduc_impto    NUMBER(12,2),
  cod_titulo_ap             VARCHAR2(10),
  val_rendto_tribut         NUMBER(10,2),
  val_aliq_impto            NUMBER(2,2),
  val_deduc_faixa_imto      NUMBER(10,2),
  cod_estab                 VARCHAR2(3),
  cod_espec_docto           VARCHAR2(3),
  cod_parcela               VARCHAR2(2),
  cod_unid_federac          VARCHAR2(3),
  cod_imposto               VARCHAR2(5) not null,
  cod_classif_impto         VARCHAR2(5),
  val_deduc_inss            NUMBER(10,2),
  val_deduc_depend          NUMBER(10,2),
  val_deduc_pensao          NUMBER(10,2),
  val_deduc_outras_deduc    NUMBER(10,2),
  val_base_liq_impto        NUMBER(10,2),
  val_imposto               NUMBER(10,2),
  dat_vencto                DATE,
  des_text_histor           VARCHAR2(200),
  dat_processamento         DATE,
  val_deduc_faixa_impto     NUMBER(12,2),
  cod_cta_ctbl              VARCHAR2(20),
  cod_plano_ctb_cbtl        VARCHAR2(8),
  ind_ocorrencia            NUMBER(1),
  cod_tip_fluxo_financ      VARCHAR2(12)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
create index EMS506UNICOO.IDX_TI_TIT_APB_IMPOSTO_01 on EMS506UNICOO.TI_TIT_APB_IMPOSTO (CDSITUACAO)
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );
alter table EMS506UNICOO.TI_TIT_APB_IMPOSTO
  add constraint PK_TI_TIT_APB_IMPOSTO primary key (NRSEQ_CONTROLE_INTEGRACAO, COD_IMPOSTO)
  using index 
  tablespace TS_EMS5
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TIT_BX_PB_UNICOO
prompt ===============================
prompt
create table EMS506UNICOO.TIT_BX_PB_UNICOO
(
  nrregistro_titulo NUMBER,
  dtitulo           DATE
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TIT_CONTABIL_PAGAR
prompt =================================
prompt
create table EMS506UNICOO.TIT_CONTABIL_PAGAR
(
  nrregistro_fornecedor NUMBER(8),
  cdempresa             VARCHAR2(5),
  idcontrato            VARCHAR2(12),
  cdhistorico           NUMBER,
  nrdocumento           VARCHAR2(12),
  cdportador            VARCHAR2(3),
  tpdocumento           VARCHAR2(3),
  cdsituacao            VARCHAR2(1),
  cdoperacao            VARCHAR2(3),
  dtvencimento          DATE,
  dttitulo              DATE,
  cddivisao             NUMBER(6),
  txhistorico           VARCHAR2(255),
  cdfornecedor          VARCHAR2(6),
  cdgrupo_fornecedor    NUMBER(4),
  nogrupo_fornecedor    VARCHAR2(30),
  nopessoa              VARCHAR2(60),
  nrcgc_cpf             VARCHAR2(15),
  tppessoa              VARCHAR2(1),
  noempresa             VARCHAR2(45),
  nodocumento           VARCHAR2(30),
  noportador            VARCHAR2(30),
  vltitulo              NUMBER,
  dtultimo_recebimento  DATE,
  vlpago                NUMBER,
  vldevido              NUMBER,
  vldesconto            NUMBER,
  vlabatimento          NUMBER,
  vlabatimento_2        NUMBER,
  vljuros               NUMBER,
  vlmulta               NUMBER,
  vltaxa_bancaria       NUMBER,
  cdconta_contabil      VARCHAR2(20),
  nrregistro_titulo     NUMBER(10) not null,
  cod_tit_t11           VARCHAR2(10),
  cod_par_t11           VARCHAR2(2)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TIT_CONTABIL_RECEBER
prompt ===================================
prompt
create table EMS506UNICOO.TIT_CONTABIL_RECEBER
(
  cdempresa            VARCHAR2(5),
  nrregistro_titulo    NUMBER(10) not null,
  cdcliente            VARCHAR2(10),
  nrdocumento          VARCHAR2(12),
  tpdocumento          VARCHAR2(3),
  cdportador           VARCHAR2(3),
  dttitulo             DATE,
  dtvencimento         DATE,
  nopessoa             VARCHAR2(60),
  nocidade             VARCHAR2(30),
  nrtelefone           VARCHAR2(24),
  nrfax                VARCHAR2(24),
  cdhistorico          NUMBER(4) not null,
  nohistorico          VARCHAR2(45),
  cdconta_contabil     VARCHAR2(20),
  vlfaturado           NUMBER,
  vltitulo             NUMBER,
  dtultimo_recebimento DATE,
  vlmulta              NUMBER,
  vljuros              NUMBER,
  vlabatimento         NUMBER,
  vlabatimento_2       NUMBER,
  vlrecebido           NUMBER,
  vldesconto           NUMBER,
  vlaberto             NUMBER,
  cdorigem             VARCHAR2(2)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TITULO_ABERTOS_CR
prompt ================================
prompt
create table EMS506UNICOO.TITULO_ABERTOS_CR
(
  cdempresa                    VARCHAR2(5),
  nrregistro_cliente           NUMBER(8),
  nrcontrato                   VARCHAR2(8),
  nrregistro_titulo            NUMBER(10) not null,
  cdsituacao                   VARCHAR2(1),
  nrdocumento                  VARCHAR2(12),
  tpdocumento                  VARCHAR2(3),
  cdportador                   VARCHAR2(3),
  cdoperacao                   VARCHAR2(3),
  nrnossonumero                VARCHAR2(20),
  nrvendedor                   VARCHAR2(3),
  dttitulo                     DATE,
  dtvencimento                 DATE not null,
  dtexclusao                   DATE,
  dtreferencia                 DATE,
  vltitulo                     NUMBER(12,2),
  vlabatimento                 NUMBER(12,2),
  vlabatimento_2               NUMBER(12,2),
  dtultimo_recebimento         DATE,
  vlrecebido                   NUMBER(12,2),
  vlmulta                      NUMBER(12,2),
  vljuros                      NUMBER(12,2),
  vldesconto                   NUMBER(12,2),
  dtenvio_banco                DATE,
  dtconfirma_banco             DATE,
  txreferencia_banco           VARCHAR2(100),
  txhistorico                  VARCHAR2(100),
  dtprotesto                   DATE,
  nocartorio_protesto          VARCHAR2(50),
  txobservacoes                VARCHAR2(400),
  cdcentro_custo               NUMBER(6),
  nrregistro_tit_agrup         NUMBER(10),
  nrregistro_tit_desm          NUMBER(10),
  cdhistorico                  NUMBER(4) not null,
  vlfaturado                   NUMBER(12,2),
  vlir_fonte                   NUMBER(12,2),
  vl_ir_fonte_fat              NUMBER(12,2),
  dtintegracao                 DATE,
  nrparcela                    NUMBER(5),
  cdfuncionario                VARCHAR2(20),
  cdvendedor                   VARCHAR2(4),
  tptitulo                     VARCHAR2(1),
  nrultimoenvio                NUMBER,
  dtultimoenvio                DATE,
  cdultimoenvio                VARCHAR2(2),
  nrultimoretorno              NUMBER,
  dtultimoretorno              DATE,
  cdultimoretorno              VARCHAR2(2),
  cdcomando_envio              VARCHAR2(2),
  cdcomando_retorno            VARCHAR2(3),
  cdmovimento_envio            VARCHAR2(2),
  cdmovimento_retorno          VARCHAR2(2),
  cdcliente                    VARCHAR2(10),
  cdcomando_atual              VARCHAR2(2),
  vltaxa_bancaria              NUMBER(12,2),
  dtultimo_envio               DATE,
  dtultimo_retorno             DATE,
  nrultimo_envio               NUMBER,
  nrultimo_retorno             NUMBER,
  pejuros                      NUMBER(7,4),
  pemulta                      NUMBER(12,2),
  nrbanco                      NUMBER(4),
  nragencia                    VARCHAR2(8),
  nrsequencianotafiscalven     NUMBER,
  tptaxaformamulta             VARCHAR2(3),
  tptaxaformajuros             VARCHAR2(3),
  vltaxamulta                  NUMBER(14,6),
  vltaxajuros                  NUMBER(14,6),
  nrtaxadiacarencia            NUMBER(3),
  aodescontoantecipado         VARCHAR2(1),
  nrdiadescontoantecipado      NUMBER(3),
  pedescontoantecipado         NUMBER(9,6),
  petaxabancaria               NUMBER(9,6),
  nrdiaprotesto                NUMBER(3),
  nrdiasprotesto               NUMBER(3),
  nrdiasdescontoantecipado     NUMBER(3),
  vldescontoantecipado         NUMBER(12,2),
  nrrepresentante              NUMBER,
  nrnota_fiscal_devolucao      VARCHAR2(25),
  cdportadoragencia            VARCHAR2(8),
  cdportadorcontacorrente      VARCHAR2(12),
  nrcontacorrente              VARCHAR2(12),
  nrdiacarencia                NUMBER(3),
  vllucro_vendor               NUMBER(12,2),
  vldespesa_cartorio           NUMBER(12,2),
  aoemite_cobranca             VARCHAR2(1),
  nrconta_corrente             VARCHAR2(12),
  nrmotivo_exclusao            NUMBER(4),
  nrperiodo_compet             NUMBER(6),
  vlrecebido_servico_oferecido NUMBER(9,2),
  rregistro_cliente            NUMBER(6),
  vldespesa_cartoria           NUMBER(12,2),
  vldiferenca_recebimento      NUMBER(9,2),
  vldiferenca_juros            NUMBER(9,2),
  aotrata_taxa                 VARCHAR2(1),
  nrinstrucao                  NUMBER(2),
  nrcomposicao_credito_ir      NUMBER(10),
  dtencerramento               DATE not null,
  cdorigem                     VARCHAR2(2),
  vlabatimento_imposto         NUMBER(12,2),
  nrlote_faturamento           NUMBER(10),
  cdidentificador_deposito     VARCHAR2(30),
  cdcomando_debaut             VARCHAR2(2),
  cdcarteira_cobranca          NUMBER(5),
  nrperiodocobertura           NUMBER(8),
  vlantecipadoperiodocobertura NUMBER(12,2),
  nrperiodorateio1             NUMBER(8),
  vlantecipadoperiodorateio1   NUMBER(12,2),
  nrperiodorateio2             NUMBER(8),
  vlantecipadoperiodorateio2   NUMBER(12,2),
  vlutilizadoperiodocobertura  NUMBER(12,2),
  vlutilizadoperiodorateio1    NUMBER(12,2),
  vlutilizadoperiodorateio2    NUMBER(12,2),
  dtvencimento_original        DATE
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TITULOS_BAIXADOS
prompt ===============================
prompt
create table EMS506UNICOO.TITULOS_BAIXADOS
(
  nrdocumento       VARCHAR2(12),
  vltitulo          NUMBER(12,2),
  saldo_unicoo      NUMBER,
  saldo_totvs11     NUMBER not null,
  num_id_tit_acr    NUMBER not null,
  nrregistro_titulo NUMBER(10) not null,
  cdsituacao        VARCHAR2(1)
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating table TMP_FORNEC_MIGRAR_MATRIZ_APB
prompt ===========================================
prompt
create table EMS506UNICOO.TMP_FORNEC_MIGRAR_MATRIZ_APB
(
  cdfornecedor VARCHAR2(6) not null
)
tablespace TS_EMS5
  pctfree 10
  initrans 1
  maxtrans 255
  storage
  (
    initial 64K
    next 1M
    minextents 1
    maxextents unlimited
  );

prompt
prompt Creating sequence CAD_GER_ENCON_SEQ
prompt ===================================
prompt
create sequence EMS506UNICOO.CAD_GER_ENCON_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence CAM_COMPENSACAO_FORNEC_SEQ
prompt ============================================
prompt
create sequence EMS506UNICOO.CAM_COMPENSACAO_FORNEC_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence CAM_COMPENSACAO_SEQ
prompt =====================================
prompt
create sequence EMS506UNICOO.CAM_COMPENSACAO_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence CTA_CORREN_FORNEC_FALHA_SEQ
prompt =============================================
prompt
create sequence EMS506UNICOO.CTA_CORREN_FORNEC_FALHA_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence ENCONTAS_SEQ
prompt ==============================
prompt
create sequence EMS506UNICOO.ENCONTAS_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence END_MIGRA_SEQ
prompt ===============================
prompt
create sequence EMS506UNICOO.END_MIGRA_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence ES_PARAM_RECIBO_SEQ
prompt =====================================
prompt
create sequence EMS506UNICOO.ES_PARAM_RECIBO_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence INF$_SEQ_ERRO_CONVERTE_V1_V4
prompt ==============================================
prompt
create sequence EMS506UNICOO.INF$_SEQ_ERRO_CONVERTE_V1_V4
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence LG$_SEQ_CONTROLE
prompt ==================================
prompt
create sequence EMS506UNICOO.LG$_SEQ_CONTROLE
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence S_GRE_ERRO_SQL
prompt ================================
prompt
create sequence EMS506UNICOO.S_GRE_ERRO_SQL
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence SEQ_REGISTRO_SISTEMA
prompt ======================================
prompt
create sequence EMS506UNICOO.SEQ_REGISTRO_SISTEMA
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence SEQ_TITULO_FECHADO
prompt ====================================
prompt
create sequence EMS506UNICOO.SEQ_TITULO_FECHADO
minvalue 1
maxvalue 999999999999999999999999999
start with 13617581
increment by 1
cache 20;

prompt
prompt Creating sequence SQ_CONTROLE_RETORNO_TITULO_ACR
prompt ================================================
prompt
create sequence EMS506UNICOO.SQ_CONTROLE_RETORNO_TITULO_ACR
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence SQ_MOVTO_RETORNO_TITULO_ACR
prompt =============================================
prompt
create sequence EMS506UNICOO.SQ_MOVTO_RETORNO_TITULO_ACR
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence SQ_TEMP
prompt =========================
prompt
create sequence EMS506UNICOO.SQ_TEMP
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence SQ_TI_CLIENTE_FORNECEDOR
prompt ==========================================
prompt
create sequence EMS506UNICOO.SQ_TI_CLIENTE_FORNECEDOR
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence SQ_TI_CLIENTE_FORNECEDOR_MOVTO
prompt ================================================
prompt
create sequence EMS506UNICOO.SQ_TI_CLIENTE_FORNECEDOR_MOVTO
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence SQ_TI_CONTROLE_INTEGRACAO
prompt ===========================================
prompt
create sequence EMS506UNICOO.SQ_TI_CONTROLE_INTEGRACAO
minvalue 1
maxvalue 9999999999999999999999999999
start with 22495908
increment by 1
cache 20;

prompt
prompt Creating sequence SQ_TI_CPF_CNPJ_DUPLICADO
prompt ==========================================
prompt
create sequence EMS506UNICOO.SQ_TI_CPF_CNPJ_DUPLICADO
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence SQ_TI_FALHA_DE_PROCESSO
prompt =========================================
prompt
create sequence EMS506UNICOO.SQ_TI_FALHA_DE_PROCESSO
minvalue 1
maxvalue 9999999999999999999999999999
start with 12734717
increment by 1
cache 20;

prompt
prompt Creating sequence SQ_TI_FAVORECIDO
prompt ==================================
prompt
create sequence EMS506UNICOO.SQ_TI_FAVORECIDO
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence SQ_TI_FAVORECIDO_FINANCEIRO
prompt =============================================
prompt
create sequence EMS506UNICOO.SQ_TI_FAVORECIDO_FINANCEIRO
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence SQ_TI_FAVORECIDO_MOVIMENTO
prompt ============================================
prompt
create sequence EMS506UNICOO.SQ_TI_FAVORECIDO_MOVIMENTO
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence SQ_TI_SESSAO
prompt ==============================
prompt
create sequence EMS506UNICOO.SQ_TI_SESSAO
minvalue 1
maxvalue 9999999999999999999999999999
start with 122309
increment by 1
cache 20;

prompt
prompt Creating sequence SQ_TI_TIPO_MOVIMENTO_TIT_APB
prompt ==============================================
prompt
create sequence EMS506UNICOO.SQ_TI_TIPO_MOVIMENTO_TIT_APB
minvalue 1
maxvalue 9999999999999999999999999999
start with 6388
increment by 1
cache 20;

prompt
prompt Creating sequence TEMP_ANALISE_TITULOS_SEQ
prompt ==========================================
prompt
create sequence EMS506UNICOO.TEMP_ANALISE_TITULOS_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TEMP_CEP_ERRADO_SEQ
prompt =====================================
prompt
create sequence EMS506UNICOO.TEMP_CEP_ERRADO_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TEMP_NOMEABREV_SEQ
prompt ====================================
prompt
create sequence EMS506UNICOO.TEMP_NOMEABREV_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TEMP_TIT_FECHADO_SEQ
prompt ======================================
prompt
create sequence EMS506UNICOO.TEMP_TIT_FECHADO_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_ABERTO_CONTABIL_EMS_SEQ
prompt ============================================
prompt
create sequence EMS506UNICOO.TI_ABERTO_CONTABIL_EMS_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_ABERTO_CONTABIL_UNICOO_SEQ
prompt ===============================================
prompt
create sequence EMS506UNICOO.TI_ABERTO_CONTABIL_UNICOO_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_BX_PERDA_SEQ
prompt =================================
prompt
create sequence EMS506UNICOO.TI_BX_PERDA_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_CLIENTE_SEQ
prompt ================================
prompt
create sequence EMS506UNICOO.TI_CLIENTE_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_CONTABILIZACAO_SEQ
prompt =======================================
prompt
create sequence EMS506UNICOO.TI_CONTABILIZACAO_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_CONTROLE_INTEGRACAO_SEQ
prompt ============================================
prompt
create sequence EMS506UNICOO.TI_CONTROLE_INTEGRACAO_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_CX_BX_ACR_SEQ
prompt ==================================
prompt
create sequence EMS506UNICOO.TI_CX_BX_ACR_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_CX_BX_APB_SEQ
prompt ==================================
prompt
create sequence EMS506UNICOO.TI_CX_BX_APB_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_FALHA_DE_PROCESSO_JOS_SEQ
prompt ==============================================
prompt
create sequence EMS506UNICOO.TI_FALHA_DE_PROCESSO_JOS_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_FALHA_DE_PROCESSO_SEQ
prompt ==========================================
prompt
create sequence EMS506UNICOO.TI_FALHA_DE_PROCESSO_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_FORNECEDOR_SEQ
prompt ===================================
prompt
create sequence EMS506UNICOO.TI_FORNECEDOR_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_HASH_SEQ
prompt =============================
prompt
create sequence EMS506UNICOO.TI_HASH_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1252481
increment by 1
cache 20;

prompt
prompt Creating sequence TI_MATRIZ_PAGAR_SEQ
prompt =====================================
prompt
create sequence EMS506UNICOO.TI_MATRIZ_PAGAR_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_MATRIZ_RECEBER_SEQ
prompt =======================================
prompt
create sequence EMS506UNICOO.TI_MATRIZ_RECEBER_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_MOVTO_TIT_AP_SEQ
prompt =====================================
prompt
create sequence EMS506UNICOO.TI_MOVTO_TIT_AP_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_PESSOA_SEQ
prompt ===============================
prompt
create sequence EMS506UNICOO.TI_PESSOA_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_TIT_ACR_COMPARATIVO_SEQ
prompt ============================================
prompt
create sequence EMS506UNICOO.TI_TIT_ACR_COMPARATIVO_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_TIT_ACR_CONCILIACAO_SEQ
prompt ============================================
prompt
create sequence EMS506UNICOO.TI_TIT_ACR_CONCILIACAO_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_TIT_ACR_CTBL_SEQ
prompt =====================================
prompt
create sequence EMS506UNICOO.TI_TIT_ACR_CTBL_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_TIT_ACR_ESTORNO_SEQ
prompt ========================================
prompt
create sequence EMS506UNICOO.TI_TIT_ACR_ESTORNO_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_TIT_ACR_IMPOSTO_SEQ
prompt ========================================
prompt
create sequence EMS506UNICOO.TI_TIT_ACR_IMPOSTO_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_TIT_ACR_SEQ
prompt ================================
prompt
create sequence EMS506UNICOO.TI_TIT_ACR_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_TIT_APB_COMPARATIVO_SEQ
prompt ============================================
prompt
create sequence EMS506UNICOO.TI_TIT_APB_COMPARATIVO_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_TIT_APB_CTBL_SEQ
prompt =====================================
prompt
create sequence EMS506UNICOO.TI_TIT_APB_CTBL_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_TIT_APB_IMPOSTO_SEQ
prompt ========================================
prompt
create sequence EMS506UNICOO.TI_TIT_APB_IMPOSTO_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TI_TIT_APB_SEQ
prompt ================================
prompt
create sequence EMS506UNICOO.TI_TIT_APB_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating sequence TIT_CONTABIL_RECEBER_SEQ
prompt ==========================================
prompt
create sequence EMS506UNICOO.TIT_CONTABIL_RECEBER_SEQ
minvalue 1
maxvalue 9999999999999999999999999999
start with 1
increment by 1
cache 20;

prompt
prompt Creating synonym ABAT_ANTECIP_ACR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.ABAT_ANTECIP_ACR
  for EMS5.ABAT_ANTECIP_ACR;

prompt
prompt Creating synonym ABAT_ANTECIP_VOUCH
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ABAT_ANTECIP_VOUCH
  for EMS5.ABAT_ANTECIP_VOUCH;

prompt
prompt Creating synonym ABAT_PREV_ACR
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.ABAT_PREV_ACR
  for EMS5.ABAT_PREV_ACR;

prompt
prompt Creating synonym ABAT_PREV_PROVIS_AP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ABAT_PREV_PROVIS_AP
  for EMS5.ABAT_PREV_PROVIS_AP;

prompt
prompt Creating synonym ABRANGENCIA
prompt ============================
prompt
create or replace synonym EMS506UNICOO.ABRANGENCIA
  for PRODUCAO.ABRANGENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ABRANGENCIA_PTU
prompt ================================
prompt
create or replace synonym EMS506UNICOO.ABRANGENCIA_PTU
  for PRODUCAO.ABRANGENCIA_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ACAOCAP
prompt ========================
prompt
create or replace synonym EMS506UNICOO.ACAOCAP
  for EMS5.ACAOCAP;

prompt
prompt Creating synonym ACERTO_CTA_EEC
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.ACERTO_CTA_EEC
  for EMS5.ACERTO_CTA_EEC;

prompt
prompt Creating synonym ACION_CONTRAT
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.ACION_CONTRAT
  for EMS5.ACION_CONTRAT;

prompt
prompt Creating synonym ACIONISTA
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.ACIONISTA
  for EMS5.ACIONISTA;

prompt
prompt Creating synonym ACOMODACAO_PRESTADOR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ACOMODACAO_PRESTADOR
  for PRODUCAO.ACOMODACAO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ACOMPTO_SIT_PROCES_EDI
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ACOMPTO_SIT_PROCES_EDI
  for EMS5.ACOMPTO_SIT_PROCES_EDI;

prompt
prompt Creating synonym ACUM_IMPTO_ACR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.ACUM_IMPTO_ACR
  for EMS5.ACUM_IMPTO_ACR;

prompt
prompt Creating synonym ACUM_IMPTO_PAGTO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.ACUM_IMPTO_PAGTO
  for EMS5.ACUM_IMPTO_PAGTO;

prompt
prompt Creating synonym ACUM_PAGTO_PESSOA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ACUM_PAGTO_PESSOA
  for EMS5.ACUM_PAGTO_PESSOA;

prompt
prompt Creating synonym ACUM_PAGTO_USUAR_CX
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ACUM_PAGTO_USUAR_CX
  for EMS5.ACUM_PAGTO_USUAR_CX;

prompt
prompt Creating synonym ACUM_TRANS_1099
prompt ================================
prompt
create or replace synonym EMS506UNICOO.ACUM_TRANS_1099
  for EMS5.ACUM_TRANS_1099;

prompt
prompt Creating synonym ACUMUL_CTBL
prompt ============================
prompt
create or replace synonym EMS506UNICOO.ACUMUL_CTBL
  for EMS5.ACUMUL_CTBL;

prompt
prompt Creating synonym ACUMUL_DEMONST_CTBL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ACUMUL_DEMONST_CTBL
  for EMS5.ACUMUL_DEMONST_CTBL;

prompt
prompt Creating synonym ACUMULO_BASE_TAXA_TITULO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.ACUMULO_BASE_TAXA_TITULO
  for PRODUCAO.ACUMULO_BASE_TAXA_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ACUMULO_BASE_TITULO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ACUMULO_BASE_TITULO
  for PRODUCAO.ACUMULO_BASE_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ADDPERIODO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.ADDPERIODO
  for PRODUCAO.ADDPERIODO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ADIANT_PRESTAC_CTA_EEC
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ADIANT_PRESTAC_CTA_EEC
  for EMS5.ADIANT_PRESTAC_CTA_EEC;

prompt
prompt Creating synonym ADITIVO_CONTRATUAL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ADITIVO_CONTRATUAL
  for PRODUCAO.ADITIVO_CONTRATUAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ADMDRA_CARTAO_CR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.ADMDRA_CARTAO_CR
  for EMS5.ADMDRA_CARTAO_CR;

prompt
prompt Creating synonym ADVERTENCIAS_FCONT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ADVERTENCIAS_FCONT
  for PRODUCAO.ADVERTENCIAS_FCONT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AFASTAMENTO_PRESTADOR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.AFASTAMENTO_PRESTADOR
  for PRODUCAO.AFASTAMENTO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGENC_BCIA
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.AGENC_BCIA
  for EMS5.AGENC_BCIA;

prompt
prompt Creating synonym AGENCIA
prompt ========================
prompt
create or replace synonym EMS506UNICOO.AGENCIA
  for PRODUCAO.AGENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGENDA_AUSEN_EEC
prompt =================================
prompt
create or replace synonym EMS506UNICOO.AGENDA_AUSEN_EEC
  for EMS5.AGENDA_AUSEN_EEC;

prompt
prompt Creating synonym AGENDA_COMERCIAL
prompt =================================
prompt
create or replace synonym EMS506UNICOO.AGENDA_COMERCIAL
  for PRODUCAO.AGENDA_COMERCIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGENDA_COMERCIAL_EXTERNA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.AGENDA_COMERCIAL_EXTERNA
  for PRODUCAO.AGENDA_COMERCIAL_EXTERNA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGENDA_INADIMP
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.AGENDA_INADIMP
  for EMS5.AGENDA_INADIMP;

prompt
prompt Creating synonym AGENDA_PERICIA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.AGENDA_PERICIA
  for PRODUCAO.AGENDA_PERICIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGENDA_PERICIA_HORA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.AGENDA_PERICIA_HORA
  for PRODUCAO.AGENDA_PERICIA_HORA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGENDAMENTO_PERICIA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.AGENDAMENTO_PERICIA
  for PRODUCAO.AGENDAMENTO_PERICIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGRAVO_DO_USUARIO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.AGRAVO_DO_USUARIO
  for PRODUCAO.AGRAVO_DO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGRUPA_RENATA
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.AGRUPA_RENATA
  for PRODUCAO.AGRUPA_RENATA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGRUPAMENTO_10002
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.AGRUPAMENTO_10002
  for PRODUCAO.AGRUPAMENTO_10002@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGRUPAMENTO_BACKUP
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.AGRUPAMENTO_BACKUP
  for PRODUCAO.AGRUPAMENTO_BACKUP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGRUPAMENTO_HISTORICO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.AGRUPAMENTO_HISTORICO
  for PRODUCAO.AGRUPAMENTO_HISTORICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGRUPAMENTO_HISTORICO_DETALHE
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.AGRUPAMENTO_HISTORICO_DETALHE
  for PRODUCAO.AGRUPAMENTO_HISTORICO_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGRUPAMENTO_HISTORICO_TAXAS
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.AGRUPAMENTO_HISTORICO_TAXAS
  for PRODUCAO.AGRUPAMENTO_HISTORICO_TAXAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGRUPAMENTO_SERVICO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.AGRUPAMENTO_SERVICO
  for PRODUCAO.AGRUPAMENTO_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGRUPAMENTO_SERVICO_DETALHE
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.AGRUPAMENTO_SERVICO_DETALHE
  for PRODUCAO.AGRUPAMENTO_SERVICO_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AGRUPAMENTO_TAXA_TITULO_PAGAR
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.AGRUPAMENTO_TAXA_TITULO_PAGAR
  for PRODUCAO.AGRUPAMENTO_TAXA_TITULO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AJUSTE_UV_PRESTADOR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.AJUSTE_UV_PRESTADOR
  for PRODUCAO.AJUSTE_UV_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ALOC_BEM
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ALOC_BEM
  for EMS5.ALOC_BEM;

prompt
prompt Creating synonym ANALIS_PERIOD_CTBL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ANALIS_PERIOD_CTBL
  for EMS5.ANALIS_PERIOD_CTBL;

prompt
prompt Creating synonym ANEXO_MSG_EDI
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.ANEXO_MSG_EDI
  for EMS5.ANEXO_MSG_EDI;

prompt
prompt Creating synonym ANGEL_SERVICO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.ANGEL_SERVICO
  for PRODUCAO.ANGEL_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ANTECIP_PEF_PEND
prompt =================================
prompt
create or replace synonym EMS506UNICOO.ANTECIP_PEF_PEND
  for EMS5.ANTECIP_PEF_PEND;

prompt
prompt Creating synonym ANTECIPPLANILHAVENDOR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.ANTECIPPLANILHAVENDOR
  for EMS5.ANTECIPPLANILHAVENDOR;

prompt
prompt Creating synonym APOL_SEGURO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.APOL_SEGURO
  for EMS5.APOL_SEGURO;

prompt
prompt Creating synonym APOL_SEGURO_BEM_PAT
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.APOL_SEGURO_BEM_PAT
  for EMS5.APOL_SEGURO_BEM_PAT;

prompt
prompt Creating synonym APROP_APOL_SEGURO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.APROP_APOL_SEGURO
  for EMS5.APROP_APOL_SEGURO;

prompt
prompt Creating synonym APROP_CONTRAT_LEAS
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.APROP_CONTRAT_LEAS
  for EMS5.APROP_CONTRAT_LEAS;

prompt
prompt Creating synonym APROP_CTBL_ACR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.APROP_CTBL_ACR
  for EMS5.APROP_CTBL_ACR;

prompt
prompt Creating synonym APROP_CTBL_ACR_AVP
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.APROP_CTBL_ACR_AVP
  for EMS5.APROP_CTBL_ACR_AVP;

prompt
prompt Creating synonym APROP_CTBL_AP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.APROP_CTBL_AP
  for EMS5.APROP_CTBL_AP;

prompt
prompt Creating synonym APROP_CTBL_AP_AVP
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.APROP_CTBL_AP_AVP
  for EMS5.APROP_CTBL_AP_AVP;

prompt
prompt Creating synonym APROP_CTBL_APL
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.APROP_CTBL_APL
  for EMS5.APROP_CTBL_APL;

prompt
prompt Creating synonym APROP_CTBL_CMG
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.APROP_CTBL_CMG
  for EMS5.APROP_CTBL_CMG;

prompt
prompt Creating synonym APROP_CTBL_CTA_PAT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.APROP_CTBL_CTA_PAT
  for EMS5.APROP_CTBL_CTA_PAT;

prompt
prompt Creating synonym APROP_CTBL_MUTUO_AP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.APROP_CTBL_MUTUO_AP
  for EMS5.APROP_CTBL_MUTUO_AP;

prompt
prompt Creating synonym APROP_CTBL_PAT
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.APROP_CTBL_PAT
  for EMS5.APROP_CTBL_PAT;

prompt
prompt Creating synonym APROP_CTBL_PEND_ACR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.APROP_CTBL_PEND_ACR
  for EMS5.APROP_CTBL_PEND_ACR;

prompt
prompt Creating synonym APROP_CTBL_PEND_AP
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.APROP_CTBL_PEND_AP
  for EMS5.APROP_CTBL_PEND_AP;

prompt
prompt Creating synonym APROP_CTBL_SHC
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.APROP_CTBL_SHC
  for EMS5.APROP_CTBL_SHC;

prompt
prompt Creating synonym APROP_DESPES_RECTA_ACR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.APROP_DESPES_RECTA_ACR
  for EMS5.APROP_DESPES_RECTA_ACR;

prompt
prompt Creating synonym APROP_LANCTO_CTBL
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.APROP_LANCTO_CTBL
  for EMS5.APROP_LANCTO_CTBL;

prompt
prompt Creating synonym APROP_LIQUIDAC_ANTECIP
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.APROP_LIQUIDAC_ANTECIP
  for EMS5.APROP_LIQUIDAC_ANTECIP;

prompt
prompt Creating synonym APROP_PARC_PIS_COFINS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.APROP_PARC_PIS_COFINS
  for EMS5.APROP_PARC_PIS_COFINS;

prompt
prompt Creating synonym APROP_RELACTO_PEND_ACR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.APROP_RELACTO_PEND_ACR
  for EMS5.APROP_RELACTO_PEND_ACR;

prompt
prompt Creating synonym APROP_RELACTO_PEND_AP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.APROP_RELACTO_PEND_AP
  for EMS5.APROP_RELACTO_PEND_AP;

prompt
prompt Creating synonym APROPCTBLDATINCONSIST
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.APROPCTBLDATINCONSIST
  for EMS5.APROPCTBLDATINCONSIST;

prompt
prompt Creating synonym APROPCTBLPLANILHAVDR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.APROPCTBLPLANILHAVDR
  for EMS5.APROPCTBLPLANILHAVDR;

prompt
prompt Creating synonym APROPDESPESRECTAPEND
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.APROPDESPESRECTAPEND
  for EMS5.APROPDESPESRECTAPEND;

prompt
prompt Creating synonym APROPRELACTOPENDACR2
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.APROPRELACTOPENDACR2
  for EMS5.APROPRELACTOPENDACR2;

prompt
prompt Creating synonym APRVDOR_SUBSTTO_EEC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.APRVDOR_SUBSTTO_EEC
  for EMS5.APRVDOR_SUBSTTO_EEC;

prompt
prompt Creating synonym APUR_CRED_PER_ANT
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.APUR_CRED_PER_ANT
  for PRODUCAO.APUR_CRED_PER_ANT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym APURACAO_CUSTO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.APURACAO_CUSTO
  for PRODUCAO.APURACAO_CUSTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym APURACAO_CUSTO_BENEFICIARIO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.APURACAO_CUSTO_BENEFICIARIO
  for PRODUCAO.APURACAO_CUSTO_BENEFICIARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym APURACAO_CUSTO_DETALHE
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.APURACAO_CUSTO_DETALHE
  for PRODUCAO.APURACAO_CUSTO_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym APURACAO_CUSTO_FATURAMENTO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.APURACAO_CUSTO_FATURAMENTO
  for PRODUCAO.APURACAO_CUSTO_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym APURACAO_CUSTO_GRUPO_CONTRATO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.APURACAO_CUSTO_GRUPO_CONTRATO
  for PRODUCAO.APURACAO_CUSTO_GRUPO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym APURACAO_CUSTO_OCORR_PREST
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.APURACAO_CUSTO_OCORR_PREST
  for PRODUCAO.APURACAO_CUSTO_OCORR_PREST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym APURACAO_CUSTO_PAGTO_PREST
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.APURACAO_CUSTO_PAGTO_PREST
  for PRODUCAO.APURACAO_CUSTO_PAGTO_PREST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym APURACAO_CUSTO_TEMP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.APURACAO_CUSTO_TEMP
  for PRODUCAO.APURACAO_CUSTO_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym APURACAO_CUSTO_TEMP_DET_CUSTO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.APURACAO_CUSTO_TEMP_DET_CUSTO
  for PRODUCAO.APURACAO_CUSTO_TEMP_DET_CUSTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym APURACAO_CUSTO_TEMP_MOV_PREST
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.APURACAO_CUSTO_TEMP_MOV_PREST
  for PRODUCAO.APURACAO_CUSTO_TEMP_MOV_PREST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym APURACAO_CUSTO_TEMP_UTIL_USU
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.APURACAO_CUSTO_TEMP_UTIL_USU
  for PRODUCAO.APURACAO_CUSTO_TEMP_UTIL_USU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym APURACAO_DMED
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.APURACAO_DMED
  for PRODUCAO.APURACAO_DMED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym APURACAO_ICMS
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.APURACAO_ICMS
  for PRODUCAO.APURACAO_ICMS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AREA_ACAO_TAB_REFER
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.AREA_ACAO_TAB_REFER
  for PRODUCAO.AREA_ACAO_TAB_REFER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AREA_ATUACAO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.AREA_ATUACAO
  for PRODUCAO.AREA_ATUACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AREA_DE_ACAO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.AREA_DE_ACAO
  for PRODUCAO.AREA_DE_ACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AREA_DE_NEGOCIO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.AREA_DE_NEGOCIO
  for PRODUCAO.AREA_DE_NEGOCIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AREA_RISCO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.AREA_RISCO
  for EMS5.AREA_RISCO;

prompt
prompt Creating synonym ARQ_TIT_EM_BCO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.ARQ_TIT_EM_BCO
  for EMS5.ARQ_TIT_EM_BCO;

prompt
prompt Creating synonym ARQUIVO_CONCILIACAO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ARQUIVO_CONCILIACAO
  for PRODUCAO.ARQUIVO_CONCILIACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ARQUIVO_PTU_ENVIADO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ARQUIVO_PTU_ENVIADO
  for PRODUCAO.ARQUIVO_PTU_ENVIADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ARRENDADOR
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.ARRENDADOR
  for EMS5.ARRENDADOR;

prompt
prompt Creating synonym ARRENDATARIO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ARRENDATARIO
  for EMS5.ARRENDATARIO;

prompt
prompt Creating synonym ATENDIMENTO_USUARIO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ATENDIMENTO_USUARIO
  for PRODUCAO.ATENDIMENTO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ATIVID_PESSOA_FISIC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ATIVID_PESSOA_FISIC
  for EMS5.ATIVID_PESSOA_FISIC;

prompt
prompt Creating synonym ATIVID_PESSOA_JURID
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ATIVID_PESSOA_JURID
  for EMS5.ATIVID_PESSOA_JURID;

prompt
prompt Creating synonym ATOADM_ACION
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ATOADM_ACION
  for EMS5.ATOADM_ACION;

prompt
prompt Creating synonym ATOADM_CLAS_ACAOCAP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ATOADM_CLAS_ACAOCAP
  for EMS5.ATOADM_CLAS_ACAOCAP;

prompt
prompt Creating synonym ATOADM_SHC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.ATOADM_SHC
  for EMS5.ATOADM_SHC;

prompt
prompt Creating synonym ATUACAO_ESPECIALIDADE
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.ATUACAO_ESPECIALIDADE
  for PRODUCAO.ATUACAO_ESPECIALIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ATUACAO_ESPECIALISTA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ATUACAO_ESPECIALISTA
  for PRODUCAO.ATUACAO_ESPECIALISTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ATUALIZACAO_CADASTRAL_USUARIO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.ATUALIZACAO_CADASTRAL_USUARIO
  for PRODUCAO.ATUALIZACAO_CADASTRAL_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUTORIZ_SOLICIT_VIAGEM
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.AUTORIZ_SOLICIT_VIAGEM
  for EMS5.AUTORIZ_SOLICIT_VIAGEM;

prompt
prompt Creating synonym AUTORIZA_CONTA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.AUTORIZA_CONTA
  for PRODUCAO.AUTORIZA_CONTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUTORIZA_FUNCIONARIO_PRESTADOR
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.AUTORIZA_FUNCIONARIO_PRESTADOR
  for PRODUCAO.AUTORIZA_FUNCIONARIO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUTORIZACAO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.AUTORIZACAO
  for PRODUCAO.AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUTORIZACAO_ANT2009
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.AUTORIZACAO_ANT2009
  for PRODUCAO.AUTORIZACAO_ANT2009@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUTORIZACAO_DEBITO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.AUTORIZACAO_DEBITO
  for PRODUCAO.AUTORIZACAO_DEBITO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUTORIZACAO_DEBITO_HEADER
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.AUTORIZACAO_DEBITO_HEADER
  for PRODUCAO.AUTORIZACAO_DEBITO_HEADER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUTORIZACAO_SERIE_FISCAL
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.AUTORIZACAO_SERIE_FISCAL
  for PRODUCAO.AUTORIZACAO_SERIE_FISCAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUTORIZADOR_MENU
prompt =================================
prompt
create or replace synonym EMS506UNICOO.AUTORIZADOR_MENU
  for PRODUCAO.AUTORIZADOR_MENU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUX_INT
prompt ========================
prompt
create or replace synonym EMS506UNICOO.AUX_INT
  for PRODUCAO.AUX_INT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUX_PER_CC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.AUX_PER_CC
  for PRODUCAO.AUX_PER_CC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUX_RADAR_2011_IT02_2011_IT02
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.AUX_RADAR_2011_IT02_2011_IT02
  for PRODUCAO.AUX_RADAR_2011_IT02_2011_IT02@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUX_RADAR_TISS
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.AUX_RADAR_TISS
  for PRODUCAO.AUX_RADAR_TISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUX_RADAR_TISS_SINTETICO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.AUX_RADAR_TISS_SINTETICO
  for PRODUCAO.AUX_RADAR_TISS_SINTETICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUX_REFER
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.AUX_REFER
  for PRODUCAO.AUX_REFER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUX_SERV
prompt =========================
prompt
create or replace synonym EMS506UNICOO.AUX_SERV
  for PRODUCAO.AUX_SERV@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUX_SERV2
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.AUX_SERV2
  for PRODUCAO.AUX_SERV2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUX_SERVICO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.AUX_SERVICO
  for PRODUCAO.AUX_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUX_SIP
prompt ========================
prompt
create or replace synonym EMS506UNICOO.AUX_SIP
  for PRODUCAO.AUX_SIP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUX_TUSS
prompt =========================
prompt
create or replace synonym EMS506UNICOO.AUX_TUSS
  for PRODUCAO.AUX_TUSS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym AUXILIAR_DE_FECHAMENTO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.AUXILIAR_DE_FECHAMENTO
  for PRODUCAO.AUXILIAR_DE_FECHAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BACK_DOENCA_CONTROLADA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.BACK_DOENCA_CONTROLADA
  for PRODUCAO.BACK_DOENCA_CONTROLADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BACK_NRNOSSONUMERO_DUPLICADO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.BACK_NRNOSSONUMERO_DUPLICADO
  for PRODUCAO.BACK_NRNOSSONUMERO_DUPLICADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BACK_OCORRENCIA_031207
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.BACK_OCORRENCIA_031207
  for PRODUCAO.BACK_OCORRENCIA_031207@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BACK_ROL_PROCEDIMENTO_ANS
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.BACK_ROL_PROCEDIMENTO_ANS
  for PRODUCAO.BACK_ROL_PROCEDIMENTO_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BACK_SERV_ESP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.BACK_SERV_ESP
  for PRODUCAO.BACK_SERV_ESP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BACK_SERV_ESP_REQUISIT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.BACK_SERV_ESP_REQUISIT
  for PRODUCAO.BACK_SERV_ESP_REQUISIT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BACK_SERVICO_DOENCA_CONTROLADA
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.BACK_SERVICO_DOENCA_CONTROLADA
  for PRODUCAO.BACK_SERVICO_DOENCA_CONTROLADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BACKUP_MAT_PLANO_TAB_VENDAS
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.BACKUP_MAT_PLANO_TAB_VENDAS
  for PRODUCAO.BACKUP_MAT_PLANO_TAB_VENDAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BANCO
prompt ======================
prompt
create or replace synonym EMS506UNICOO.BANCO
  for EMS5.BANCO;

prompt
prompt Creating synonym BASE_DE_INCIDENCIA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.BASE_DE_INCIDENCIA
  for PRODUCAO.BASE_DE_INCIDENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BCO_HISTOR_PERIOD
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.BCO_HISTOR_PERIOD
  for EMS5.BCO_HISTOR_PERIOD;

prompt
prompt Creating synonym BCO_TIP_CHEQ
prompt =============================
prompt
create or replace synonym EMS506UNICOO.BCO_TIP_CHEQ
  for EMS5.BCO_TIP_CHEQ;

prompt
prompt Creating synonym BEM_PAT
prompt ========================
prompt
create or replace synonym EMS506UNICOO.BEM_PAT
  for EMS5.BEM_PAT;

prompt
prompt Creating synonym BEM_PAT_EXT
prompt ============================
prompt
create or replace synonym EMS506UNICOO.BEM_PAT_EXT
  for EMS5.BEM_PAT_EXT;

prompt
prompt Creating synonym BEM_PAT_GARTIA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.BEM_PAT_GARTIA
  for EMS5.BEM_PAT_GARTIA;

prompt
prompt Creating synonym BEMPATITEMDOCTOENTR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.BEMPATITEMDOCTOENTR
  for EMS5.BEMPATITEMDOCTOENTR;

prompt
prompt Creating synonym BENEFICIARIO_ITEM_DESPESA
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.BENEFICIARIO_ITEM_DESPESA
  for PRODUCAO.BENEFICIARIO_ITEM_DESPESA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BENEFICIARIO_PERIODO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.BENEFICIARIO_PERIODO
  for PRODUCAO.BENEFICIARIO_PERIODO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BK1710_ESP_REQ
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.BK1710_ESP_REQ
  for PRODUCAO.BK1710_ESP_REQ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BK1710_ESPECIAL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.BK1710_ESPECIAL
  for PRODUCAO.BK1710_ESPECIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BLOQ_ACAOCAP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.BLOQ_ACAOCAP
  for EMS5.BLOQ_ACAOCAP;

prompt
prompt Creating synonym BLOQUEIO_AUTORIZACAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.BLOQUEIO_AUTORIZACAO
  for PRODUCAO.BLOQUEIO_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BLOQUEIO_CLIENTE
prompt =================================
prompt
create or replace synonym EMS506UNICOO.BLOQUEIO_CLIENTE
  for PRODUCAO.BLOQUEIO_CLIENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym BOLET_PROTEC_CARTAO_CR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.BOLET_PROTEC_CARTAO_CR
  for EMS5.BOLET_PROTEC_CARTAO_CR;

prompt
prompt Creating synonym BORD_ACR
prompt =========================
prompt
create or replace synonym EMS506UNICOO.BORD_ACR
  for EMS5.BORD_ACR;

prompt
prompt Creating synonym BORD_AP
prompt ========================
prompt
create or replace synonym EMS506UNICOO.BORD_AP
  for EMS5.BORD_AP;

prompt
prompt Creating synonym C023_0591
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.C023_0591
  for PRODUCAO.C023_0591@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_AUTOGERADOS_PJ
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.C023_AUTOGERADOS_PJ
  for PRODUCAO.C023_AUTOGERADOS_PJ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_AUX_RAMO_ATIVIDADE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.C023_AUX_RAMO_ATIVIDADE
  for PRODUCAO.C023_AUX_RAMO_ATIVIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_AUX_SERVICO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.C023_AUX_SERVICO
  for PRODUCAO.C023_AUX_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_BACK_SERVICO_201207
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.C023_BACK_SERVICO_201207
  for PRODUCAO.C023_BACK_SERVICO_201207@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_BENF_AVENTUAL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.C023_BENF_AVENTUAL
  for PRODUCAO.C023_BENF_AVENTUAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_BK_SERVICO_ENVIO_ANS
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.C023_BK_SERVICO_ENVIO_ANS
  for PRODUCAO.C023_BK_SERVICO_ENVIO_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_BK_TUSS_16
prompt ================================
prompt
create or replace synonym EMS506UNICOO.C023_BK_TUSS_16
  for PRODUCAO.C023_BK_TUSS_16@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_CONSULTAS_2011
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.C023_CONSULTAS_2011
  for PRODUCAO.C023_CONSULTAS_2011@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_COPIA_CONTA_CONTABIL
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.C023_COPIA_CONTA_CONTABIL
  for PRODUCAO.C023_COPIA_CONTA_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_COPIA_OCORRENCIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.C023_COPIA_OCORRENCIA
  for PRODUCAO.C023_COPIA_OCORRENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_DADOS_PEONA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.C023_DADOS_PEONA
  for PRODUCAO.C023_DADOS_PEONA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_DESPESAS_ANS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.C023_DESPESAS_ANS
  for PRODUCAO.C023_DESPESAS_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_ERRO_SANTANDER
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.C023_ERRO_SANTANDER
  for PRODUCAO.C023_ERRO_SANTANDER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_EVENTO_PAGAMENTO_CALCULO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.C023_EVENTO_PAGAMENTO_CALCULO
  for PRODUCAO.C023_EVENTO_PAGAMENTO_CALCULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_EXECUTOU_TRIGGER
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.C023_EXECUTOU_TRIGGER
  for PRODUCAO.C023_EXECUTOU_TRIGGER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_FN_CARENCIA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.C023_FN_CARENCIA
  for PRODUCAO.C023_FN_CARENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_FN_DIA_DA_SEMANA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.C023_FN_DIA_DA_SEMANA
  for PRODUCAO.C023_FN_DIA_DA_SEMANA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_FN_OBTEM_CUSTO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.C023_FN_OBTEM_CUSTO
  for PRODUCAO.C023_FN_OBTEM_CUSTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_FN_OBTEM_RECEITA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.C023_FN_OBTEM_RECEITA
  for PRODUCAO.C023_FN_OBTEM_RECEITA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_FN_OBTEM_RECEITA_FM
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.C023_FN_OBTEM_RECEITA_FM
  for PRODUCAO.C023_FN_OBTEM_RECEITA_FM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_FN_PROXIMO_REAJUSTE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.C023_FN_PROXIMO_REAJUSTE
  for PRODUCAO.C023_FN_PROXIMO_REAJUSTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_FN_QUITACAO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.C023_FN_QUITACAO
  for PRODUCAO.C023_FN_QUITACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_FUN_FXETARIA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.C023_FUN_FXETARIA
  for PRODUCAO.C023_FUN_FXETARIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_FUN_TX_FXETARIA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.C023_FUN_TX_FXETARIA
  for PRODUCAO.C023_FUN_TX_FXETARIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_FXETARIA_UNIBANCO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.C023_FXETARIA_UNIBANCO
  for PRODUCAO.C023_FXETARIA_UNIBANCO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_HORARIO_PRESTADOR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.C023_HORARIO_PRESTADOR
  for PRODUCAO.C023_HORARIO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_LOG_BOLETO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.C023_LOG_BOLETO
  for PRODUCAO.C023_LOG_BOLETO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_MVW_HB_CLIENTES
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.C023_MVW_HB_CLIENTES
  for PRODUCAO.C023_MVW_HB_CLIENTES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_OBTEM_HORA_FIM
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.C023_OBTEM_HORA_FIM
  for PRODUCAO.C023_OBTEM_HORA_FIM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_OBTEM_HORA_INICIO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.C023_OBTEM_HORA_INICIO
  for PRODUCAO.C023_OBTEM_HORA_INICIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_OBTEM_HORA_INTER_FIM
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.C023_OBTEM_HORA_INTER_FIM
  for PRODUCAO.C023_OBTEM_HORA_INTER_FIM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_OBTEM_HORA_INTER_INICIO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.C023_OBTEM_HORA_INTER_INICIO
  for PRODUCAO.C023_OBTEM_HORA_INTER_INICIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_OBTEM_QTD_SERVICO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.C023_OBTEM_QTD_SERVICO
  for PRODUCAO.C023_OBTEM_QTD_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_OMEGA
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.C023_OMEGA
  for PRODUCAO.C023_OMEGA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_PARJ_COMPLETO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.C023_PARJ_COMPLETO
  for PRODUCAO.C023_PARJ_COMPLETO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_PENOA_TEMP
prompt ================================
prompt
create or replace synonym EMS506UNICOO.C023_PENOA_TEMP
  for PRODUCAO.C023_PENOA_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_PESSOA_ANTES_CNS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.C023_PESSOA_ANTES_CNS
  for PRODUCAO.C023_PESSOA_ANTES_CNS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_PESSOA_CPF
prompt ================================
prompt
create or replace synonym EMS506UNICOO.C023_PESSOA_CPF
  for PRODUCAO.C023_PESSOA_CPF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_POS_APPI
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.C023_POS_APPI
  for PRODUCAO.C023_POS_APPI@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_QTD_CONSULTAS_PERMITIDAS
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.C023_QTD_CONSULTAS_PERMITIDAS
  for PRODUCAO.C023_QTD_CONSULTAS_PERMITIDAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_RADAR_TISS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.C023_RADAR_TISS
  for PRODUCAO.C023_RADAR_TISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_RAZAO_14414
prompt =================================
prompt
create or replace synonym EMS506UNICOO.C023_RAZAO_14414
  for PRODUCAO.C023_RAZAO_14414@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_RAZAO_14415
prompt =================================
prompt
create or replace synonym EMS506UNICOO.C023_RAZAO_14415
  for PRODUCAO.C023_RAZAO_14415@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_RAZAO_14416
prompt =================================
prompt
create or replace synonym EMS506UNICOO.C023_RAZAO_14416
  for PRODUCAO.C023_RAZAO_14416@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_RAZAO_14417
prompt =================================
prompt
create or replace synonym EMS506UNICOO.C023_RAZAO_14417
  for PRODUCAO.C023_RAZAO_14417@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_RAZAO_14419
prompt =================================
prompt
create or replace synonym EMS506UNICOO.C023_RAZAO_14419
  for PRODUCAO.C023_RAZAO_14419@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_RAZAO_14420
prompt =================================
prompt
create or replace synonym EMS506UNICOO.C023_RAZAO_14420
  for PRODUCAO.C023_RAZAO_14420@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_RAZAO_14422
prompt =================================
prompt
create or replace synonym EMS506UNICOO.C023_RAZAO_14422
  for PRODUCAO.C023_RAZAO_14422@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_RAZAO_14423
prompt =================================
prompt
create or replace synonym EMS506UNICOO.C023_RAZAO_14423
  for PRODUCAO.C023_RAZAO_14423@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_REAJUSTE_BACK
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.C023_REAJUSTE_BACK
  for PRODUCAO.C023_REAJUSTE_BACK@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_RECEITAS_ANS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.C023_RECEITAS_ANS
  for PRODUCAO.C023_RECEITAS_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_RELATORIO_DR_GILMAR
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.C023_RELATORIO_DR_GILMAR
  for PRODUCAO.C023_RELATORIO_DR_GILMAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_RENTABILIDADE_PLAMEC
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.C023_RENTABILIDADE_PLAMEC
  for PRODUCAO.C023_RENTABILIDADE_PLAMEC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_SIB
prompt =========================
prompt
create or replace synonym EMS506UNICOO.C023_SIB
  for PRODUCAO.C023_SIB@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_SOCIO_PRESTADOR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.C023_SOCIO_PRESTADOR
  for PRODUCAO.C023_SOCIO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_TEMP_COOPERADOS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.C023_TEMP_COOPERADOS
  for PRODUCAO.C023_TEMP_COOPERADOS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_TEMP_INSTRUMENTADORES
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.C023_TEMP_INSTRUMENTADORES
  for PRODUCAO.C023_TEMP_INSTRUMENTADORES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_TEMP_NAO_COOPERADOS
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.C023_TEMP_NAO_COOPERADOS
  for PRODUCAO.C023_TEMP_NAO_COOPERADOS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_TEMP_REAJUSTE_2011
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.C023_TEMP_REAJUSTE_2011
  for PRODUCAO.C023_TEMP_REAJUSTE_2011@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_TEMP_REAJUSTE_2012
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.C023_TEMP_REAJUSTE_2012
  for PRODUCAO.C023_TEMP_REAJUSTE_2012@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_TEMP_REAJUSTE_2013
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.C023_TEMP_REAJUSTE_2013
  for PRODUCAO.C023_TEMP_REAJUSTE_2013@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_TEMP_REAJUSTE_MAIO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.C023_TEMP_REAJUSTE_MAIO
  for PRODUCAO.C023_TEMP_REAJUSTE_MAIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_TEMP_SERVICOS
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.C023_TEMP_SERVICOS
  for PRODUCAO.C023_TEMP_SERVICOS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_TEMP_SERVICOS_1
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.C023_TEMP_SERVICOS_1
  for PRODUCAO.C023_TEMP_SERVICOS_1@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_TESTE_NFS
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.C023_TESTE_NFS
  for PRODUCAO.C023_TESTE_NFS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_TESTE_PLANO_DE_CONTAS
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.C023_TESTE_PLANO_DE_CONTAS
  for PRODUCAO.C023_TESTE_PLANO_DE_CONTAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_TIPO_PLANO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.C023_TIPO_PLANO
  for PRODUCAO.C023_TIPO_PLANO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_TITULOS_1401
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.C023_TITULOS_1401
  for PRODUCAO.C023_TITULOS_1401@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_ULT_FAT
prompt =============================
prompt
create or replace synonym EMS506UNICOO.C023_ULT_FAT
  for PRODUCAO.C023_ULT_FAT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_USU_FATURA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.C023_USU_FATURA
  for PRODUCAO.C023_USU_FATURA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_VALIDA_CPF_CNPJ
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.C023_VALIDA_CPF_CNPJ
  for PRODUCAO.C023_VALIDA_CPF_CNPJ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_VIEW_ETQ_MENS
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.C023_VIEW_ETQ_MENS
  for PRODUCAO.C023_VIEW_ETQ_MENS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023_VW_HB_PRODUCAO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.C023_VW_HB_PRODUCAO
  for PRODUCAO.C023_VW_HB_PRODUCAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023AUX_SERVICO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.C023AUX_SERVICO
  for PRODUCAO.C023AUX_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym C023DIFERENCA_SERVICO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.C023DIFERENCA_SERVICO
  for PRODUCAO.C023DIFERENCA_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CADASTRO_DE_CARTA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CADASTRO_DE_CARTA
  for PRODUCAO.CADASTRO_DE_CARTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CADASTRO_GERAL_UNIMEDS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.CADASTRO_GERAL_UNIMEDS
  for PRODUCAO.CADASTRO_GERAL_UNIMEDS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CADASTRO_IMPRESSORA_FISCAL
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.CADASTRO_IMPRESSORA_FISCAL
  for PRODUCAO.CADASTRO_IMPRESSORA_FISCAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CADASTRO_REDUCAOZ
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CADASTRO_REDUCAOZ
  for PRODUCAO.CADASTRO_REDUCAOZ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CAIXA_FATOR_MODERADOR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CAIXA_FATOR_MODERADOR
  for PRODUCAO.CAIXA_FATOR_MODERADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CAIXA_UNICO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.CAIXA_UNICO
  for PRODUCAO.CAIXA_UNICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CAIXA_UNICO_REGRA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CAIXA_UNICO_REGRA
  for PRODUCAO.CAIXA_UNICO_REGRA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CAIXA_UNICO_REGRA_ITEM
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.CAIXA_UNICO_REGRA_ITEM
  for PRODUCAO.CAIXA_UNICO_REGRA_ITEM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CALC_PARC_PIS_COFINS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CALC_PARC_PIS_COFINS
  for EMS5.CALC_PARC_PIS_COFINS;

prompt
prompt Creating synonym CALCENCARGOCTACORREN
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CALCENCARGOCTACORREN
  for EMS5.CALCENCARGOCTACORREN;

prompt
prompt Creating synonym CALCULO_ISS_CONTROLE
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CALCULO_ISS_CONTROLE
  for PRODUCAO.CALCULO_ISS_CONTROLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CALCULO_ISS_DETALHE
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.CALCULO_ISS_DETALHE
  for PRODUCAO.CALCULO_ISS_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CALCULO_ISS_RESUMO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CALCULO_ISS_RESUMO
  for PRODUCAO.CALCULO_ISS_RESUMO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CALEND_COMIS
prompt =============================
prompt
create or replace synonym EMS506UNICOO.CALEND_COMIS
  for EMS5.CALEND_COMIS;

prompt
prompt Creating synonym CALEND_GLOB
prompt ============================
prompt
create or replace synonym EMS506UNICOO.CALEND_GLOB
  for EMS5.CALEND_GLOB;

prompt
prompt Creating synonym CAMARA_COMPENSACAO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CAMARA_COMPENSACAO
  for PRODUCAO.CAMARA_COMPENSACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CAMPO_DO_PROCESSO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CAMPO_DO_PROCESSO
  for PRODUCAO.CAMPO_DO_PROCESSO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CAMPO_LAYOUT_AVISO_DB
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CAMPO_LAYOUT_AVISO_DB
  for EMS5.CAMPO_LAYOUT_AVISO_DB;

prompt
prompt Creating synonym CAMPO_LAYOUT_FISC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CAMPO_LAYOUT_FISC
  for EMS5.CAMPO_LAYOUT_FISC;

prompt
prompt Creating synonym CANCELAMENTO_INADIMPL_DETALHE
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.CANCELAMENTO_INADIMPL_DETALHE
  for PRODUCAO.CANCELAMENTO_INADIMPL_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CANCELAMENTO_INADIMPL_TITULO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.CANCELAMENTO_INADIMPL_TITULO
  for PRODUCAO.CANCELAMENTO_INADIMPL_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CAPAC_PRODUC
prompt =============================
prompt
create or replace synonym EMS506UNICOO.CAPAC_PRODUC
  for EMS5.CAPAC_PRODUC;

prompt
prompt Creating synonym CARACT_BEM_PAT
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.CARACT_BEM_PAT
  for EMS5.CARACT_BEM_PAT;

prompt
prompt Creating synonym CARACT_ESPEC_PAT
prompt =================================
prompt
create or replace synonym EMS506UNICOO.CARACT_ESPEC_PAT
  for EMS5.CARACT_ESPEC_PAT;

prompt
prompt Creating synonym CARACT_PAT
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.CARACT_PAT
  for EMS5.CARACT_PAT;

prompt
prompt Creating synonym CARENCIAS_EMISS_CART
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CARENCIAS_EMISS_CART
  for PRODUCAO.CARENCIAS_EMISS_CART@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CARGA_CELULAR
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.CARGA_CELULAR
  for PRODUCAO.CARGA_CELULAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CARGA_CLAUDIO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.CARGA_CLAUDIO
  for PRODUCAO.CARGA_CLAUDIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CARGO_EEC
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.CARGO_EEC
  for EMS5.CARGO_EEC;

prompt
prompt Creating synonym CARGO_NIV_CARGO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.CARGO_NIV_CARGO
  for EMS5.CARGO_NIV_CARGO;

prompt
prompt Creating synonym CART_BCIA
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.CART_BCIA
  for EMS5.CART_BCIA;

prompt
prompt Creating synonym CART_BCIA_CTA_CTBL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CART_BCIA_CTA_CTBL
  for EMS5.CART_BCIA_CTA_CTBL;

prompt
prompt Creating synonym CART_BCIA_IMPTO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.CART_BCIA_IMPTO
  for EMS5.CART_BCIA_IMPTO;

prompt
prompt Creating synonym CARTA_ANUENCIA_INADIMP
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.CARTA_ANUENCIA_INADIMP
  for EMS5.CARTA_ANUENCIA_INADIMP;

prompt
prompt Creating synonym CARTA_DE_CORRECAO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CARTA_DE_CORRECAO
  for PRODUCAO.CARTA_DE_CORRECAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CARTAO_CR
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.CARTAO_CR
  for EMS5.CARTAO_CR;

prompt
prompt Creating synonym CARTEIRA_COBRANCA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CARTEIRA_COBRANCA
  for PRODUCAO.CARTEIRA_COBRANCA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CARTEIRA_COBRANCA_CLIENTE_BCO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.CARTEIRA_COBRANCA_CLIENTE_BCO
  for PRODUCAO.CARTEIRA_COBRANCA_CLIENTE_BCO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CARTEIRA_COBRANCA_CONTRATO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.CARTEIRA_COBRANCA_CONTRATO
  for PRODUCAO.CARTEIRA_COBRANCA_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CATEG_HOTEL
prompt ============================
prompt
create or replace synonym EMS506UNICOO.CATEG_HOTEL
  for EMS5.CATEG_HOTEL;

prompt
prompt Creating synonym CATEGORIA
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.CATEGORIA
  for PRODUCAO.CATEGORIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CATEGORIA_CLIENTE
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CATEGORIA_CLIENTE
  for PRODUCAO.CATEGORIA_CLIENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CATEGORIA_DE_SERVICO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CATEGORIA_DE_SERVICO
  for PRODUCAO.CATEGORIA_DE_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CATEGORIA_DE_SERVICO_CONTR_PES
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.CATEGORIA_DE_SERVICO_CONTR_PES
  for PRODUCAO.CATEGORIA_DE_SERVICO_CONTR_PES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CATEGORIA_DE_SERVICO_PTU
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.CATEGORIA_DE_SERVICO_PTU
  for PRODUCAO.CATEGORIA_DE_SERVICO_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CATEGORIA_DE_USUARIO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CATEGORIA_DE_USUARIO
  for PRODUCAO.CATEGORIA_DE_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CATEGORIA_FATURAMENTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CATEGORIA_FATURAMENTO
  for PRODUCAO.CATEGORIA_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CATEGORIA_PARJ
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.CATEGORIA_PARJ
  for PRODUCAO.CATEGORIA_PARJ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CATEGORIA_PRODUTO_CARENCIA
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.CATEGORIA_PRODUTO_CARENCIA
  for PRODUCAO.CATEGORIA_PRODUTO_CARENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CATEGORIA_PRODUTO_COBERTURA
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.CATEGORIA_PRODUTO_COBERTURA
  for PRODUCAO.CATEGORIA_PRODUTO_COBERTURA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CATEGORIA_PROPOSTA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CATEGORIA_PROPOSTA
  for PRODUCAO.CATEGORIA_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CBHPM_HM
prompt =========================
prompt
create or replace synonym EMS506UNICOO.CBHPM_HM
  for PRODUCAO.CBHPM_HM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CBO
prompt ====================
prompt
create or replace synonym EMS506UNICOO.CBO
  for PRODUCAO.CBO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CBO123
prompt =======================
prompt
create or replace synonym EMS506UNICOO.CBO123
  for PRODUCAO.CBO123@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CCUSTO
prompt =======================
prompt
create or replace synonym EMS506UNICOO.CCUSTO
  for EMS5.CCUSTO;

prompt
prompt Creating synonym CCUSTO_SOLICIT_VIAGEM
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CCUSTO_SOLICIT_VIAGEM
  for EMS5.CCUSTO_SOLICIT_VIAGEM;

prompt
prompt Creating synonym CCUSTO_UNID_NEGOC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CCUSTO_UNID_NEGOC
  for EMS5.CCUSTO_UNID_NEGOC;

prompt
prompt Creating synonym CEDENTE_COBRANCA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.CEDENTE_COBRANCA
  for PRODUCAO.CEDENTE_COBRANCA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CENAR_CTBL
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.CENAR_CTBL
  for EMS5.CENAR_CTBL;

prompt
prompt Creating synonym CENAR_ORCTARIO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.CENAR_ORCTARIO
  for EMS5.CENAR_ORCTARIO;

prompt
prompt Creating synonym CENAR_ORCTARIO_BGC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CENAR_ORCTARIO_BGC
  for EMS5.CENAR_ORCTARIO_BGC;

prompt
prompt Creating synonym CENTRO_CUSTO_SPED
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CENTRO_CUSTO_SPED
  for PRODUCAO.CENTRO_CUSTO_SPED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CEP_AGENC_BCIA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.CEP_AGENC_BCIA
  for EMS5.CEP_AGENC_BCIA;

prompt
prompt Creating synonym CEP_ENDERECO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.CEP_ENDERECO
  for PRODUCAO.CEP_ENDERECO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CHAVE_REGRA_CONCIL_CTA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.CHAVE_REGRA_CONCIL_CTA
  for EMS5.CHAVE_REGRA_CONCIL_CTA;

prompt
prompt Creating synonym CHAVES
prompt =======================
prompt
create or replace synonym EMS506UNICOO.CHAVES
  for PRODUCAO.CHAVES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CHEQ_ACR
prompt =========================
prompt
create or replace synonym EMS506UNICOO.CHEQ_ACR
  for EMS5.CHEQ_ACR;

prompt
prompt Creating synonym CHEQ_AP
prompt ========================
prompt
create or replace synonym EMS506UNICOO.CHEQ_AP
  for EMS5.CHEQ_AP;

prompt
prompt Creating synonym CHEQUE
prompt =======================
prompt
create or replace synonym EMS506UNICOO.CHEQUE
  for EMS5.CHEQUE;

prompt
prompt Creating synonym CHEQUE_ENVIA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.CHEQUE_ENVIA
  for PRODUCAO.CHEQUE_ENVIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CID_10
prompt =======================
prompt
create or replace synonym EMS506UNICOO.CID_10
  for PRODUCAO.CID_10@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CID_DOENCA_CONTROLADA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CID_DOENCA_CONTROLADA
  for PRODUCAO.CID_DOENCA_CONTROLADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CIDADE
prompt =======================
prompt
create or replace synonym EMS506UNICOO.CIDADE
  for EMS5.CIDADE;

prompt
prompt Creating synonym CIDADE_CEP
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.CIDADE_CEP
  for PRODUCAO.CIDADE_CEP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CIDADE_TIPO_VENDA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CIDADE_TIPO_VENDA
  for PRODUCAO.CIDADE_TIPO_VENDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLAS_ACAOCAP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.CLAS_ACAOCAP
  for EMS5.CLAS_ACAOCAP;

prompt
prompt Creating synonym CLAS_CONTAT
prompt ============================
prompt
create or replace synonym EMS506UNICOO.CLAS_CONTAT
  for EMS5.CLAS_CONTAT;

prompt
prompt Creating synonym CLAS_DIA_CALEND
prompt ================================
prompt
create or replace synonym EMS506UNICOO.CLAS_DIA_CALEND
  for EMS5.CLAS_DIA_CALEND;

prompt
prompt Creating synonym CLAS_RISCO_CLIEN
prompt =================================
prompt
create or replace synonym EMS506UNICOO.CLAS_RISCO_CLIEN
  for EMS5.CLAS_RISCO_CLIEN;

prompt
prompt Creating synonym CLASS_TRIBUTARIA_CLASS_FISCAL
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.CLASS_TRIBUTARIA_CLASS_FISCAL
  for PRODUCAO.CLASS_TRIBUTARIA_CLASS_FISCAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLASSE_DE_SERVICO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CLASSE_DE_SERVICO
  for PRODUCAO.CLASSE_DE_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLASSE_INSS
prompt ============================
prompt
create or replace synonym EMS506UNICOO.CLASSE_INSS
  for PRODUCAO.CLASSE_INSS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLASSE_PRESTADOR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.CLASSE_PRESTADOR
  for PRODUCAO.CLASSE_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLASSIF_IMPTO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.CLASSIF_IMPTO
  for EMS5.CLASSIF_IMPTO;

prompt
prompt Creating synonym CLASSIF_MSG_COBR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.CLASSIF_MSG_COBR
  for EMS5.CLASSIF_MSG_COBR;

prompt
prompt Creating synonym CLASSIFICACAO_ABC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CLASSIFICACAO_ABC
  for PRODUCAO.CLASSIFICACAO_ABC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLASSIFICACAO_FISCAL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CLASSIFICACAO_FISCAL
  for PRODUCAO.CLASSIFICACAO_FISCAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLASSIFICACAO_FISCAL_NAT_REC
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.CLASSIFICACAO_FISCAL_NAT_REC
  for PRODUCAO.CLASSIFICACAO_FISCAL_NAT_REC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLASSIFICACAO_GERENC_SERVICO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.CLASSIFICACAO_GERENC_SERVICO
  for PRODUCAO.CLASSIFICACAO_GERENC_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLASSIFICACAO_PRE_AUTORIZACAO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.CLASSIFICACAO_PRE_AUTORIZACAO
  for PRODUCAO.CLASSIFICACAO_PRE_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLASSIFICACAO_SALARIO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CLASSIFICACAO_SALARIO
  for PRODUCAO.CLASSIFICACAO_SALARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLASSIFICACAO_SERVICOS_ISS
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.CLASSIFICACAO_SERVICOS_ISS
  for PRODUCAO.CLASSIFICACAO_SERVICOS_ISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLASSIFICACAO_TIPO_EVENTO_ISS
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.CLASSIFICACAO_TIPO_EVENTO_ISS
  for PRODUCAO.CLASSIFICACAO_TIPO_EVENTO_ISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLASSIFICACAO_TRIBUTARIA_IVAST
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.CLASSIFICACAO_TRIBUTARIA_IVAST
  for PRODUCAO.CLASSIFICACAO_TRIBUTARIA_IVAST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLASSIFICACAO_VENDEDOR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.CLASSIFICACAO_VENDEDOR
  for PRODUCAO.CLASSIFICACAO_VENDEDOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLIEN_ANALIS_CR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.CLIEN_ANALIS_CR
  for EMS5.CLIEN_ANALIS_CR;

prompt
prompt Creating synonym CLIEN_COBR_ATIV
prompt ================================
prompt
create or replace synonym EMS506UNICOO.CLIEN_COBR_ATIV
  for EMS5.CLIEN_COBR_ATIV;

prompt
prompt Creating synonym CLIEN_FINANC
prompt =============================
prompt
create or replace synonym EMS506UNICOO.CLIEN_FINANC
  for EMS5.CLIEN_FINANC;

prompt
prompt Creating synonym CLIEN_INADIMP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.CLIEN_INADIMP
  for EMS5.CLIEN_INADIMP;

prompt
prompt Creating synonym CLIEN_PORTAD
prompt =============================
prompt
create or replace synonym EMS506UNICOO.CLIEN_PORTAD
  for EMS5.CLIEN_PORTAD;

prompt
prompt Creating synonym CLIEN_TERC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.CLIEN_TERC
  for EMS5.CLIEN_TERC;

prompt
prompt Creating synonym CLIEN_VIDEO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.CLIEN_VIDEO
  for EMS5.CLIEN_VIDEO;

prompt
prompt Creating synonym CLIENTE
prompt ========================
prompt
create or replace synonym EMS506UNICOO.CLIENTE
  for EMS5.CLIENTE;

prompt
prompt Creating synonym CLIENTE_CARTA_EMITIDA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CLIENTE_CARTA_EMITIDA
  for PRODUCAO.CLIENTE_CARTA_EMITIDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLIENTE_GRUPO_ECONOMICO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.CLIENTE_GRUPO_ECONOMICO
  for PRODUCAO.CLIENTE_GRUPO_ECONOMICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CLIENTE_TEMP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.CLIENTE_TEMP
  for PRODUCAO.CLIENTE_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym COBERT_APOL
prompt ============================
prompt
create or replace synonym EMS506UNICOO.COBERT_APOL
  for EMS5.COBERT_APOL;

prompt
prompt Creating synonym COBERT_SINIST
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.COBERT_SINIST
  for EMS5.COBERT_SINIST;

prompt
prompt Creating synonym COBR_ATIV_PED_VDA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.COBR_ATIV_PED_VDA
  for EMS5.COBR_ATIV_PED_VDA;

prompt
prompt Creating synonym COBR_ESPECIAL_ACR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.COBR_ESPECIAL_ACR
  for EMS5.COBR_ESPECIAL_ACR;

prompt
prompt Creating synonym CODIGO_DE_FATURAMENTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CODIGO_DE_FATURAMENTO
  for PRODUCAO.CODIGO_DE_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CODIGO_FISCAL
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.CODIGO_FISCAL
  for PRODUCAO.CODIGO_FISCAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CODIGO_MOVIMENTO_CAIXA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.CODIGO_MOVIMENTO_CAIXA
  for PRODUCAO.CODIGO_MOVIMENTO_CAIXA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym COEF_CM_PAT
prompt ============================
prompt
create or replace synonym EMS506UNICOO.COEF_CM_PAT
  for EMS5.COEF_CM_PAT;

prompt
prompt Creating synonym COL_BALANCT
prompt ============================
prompt
create or replace synonym EMS506UNICOO.COL_BALANCT
  for EMS5.COL_BALANCT;

prompt
prompt Creating synonym COL_DEMONST_CTBL
prompt =================================
prompt
create or replace synonym EMS506UNICOO.COL_DEMONST_CTBL
  for EMS5.COL_DEMONST_CTBL;

prompt
prompt Creating synonym COL_FLUXO_CX
prompt =============================
prompt
create or replace synonym EMS506UNICOO.COL_FLUXO_CX
  for EMS5.COL_FLUXO_CX;

prompt
prompt Creating synonym COL_LAYOUT_FISC
prompt ================================
prompt
create or replace synonym EMS506UNICOO.COL_LAYOUT_FISC
  for EMS5.COL_LAYOUT_FISC;

prompt
prompt Creating synonym COLPREFERDEMONSTCTBL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.COLPREFERDEMONSTCTBL
  for EMS5.COLPREFERDEMONSTCTBL;

prompt
prompt Creating synonym COMENT_USUAR_HOTEL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.COMENT_USUAR_HOTEL
  for EMS5.COMENT_USUAR_HOTEL;

prompt
prompt Creating synonym COMISSAO_VENDA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.COMISSAO_VENDA
  for PRODUCAO.COMISSAO_VENDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym COMISSAO_VENDA_ITEM
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.COMISSAO_VENDA_ITEM
  for PRODUCAO.COMISSAO_VENDA_ITEM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym COMISSAO_VENDA_NOTA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.COMISSAO_VENDA_NOTA
  for PRODUCAO.COMISSAO_VENDA_NOTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym COMPETENCIA_DIRF
prompt =================================
prompt
create or replace synonym EMS506UNICOO.COMPETENCIA_DIRF
  for PRODUCAO.COMPETENCIA_DIRF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym COMPETENCIA_INTERCAMBIO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.COMPETENCIA_INTERCAMBIO
  for PRODUCAO.COMPETENCIA_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym COMPL_CARGO_EEC
prompt ================================
prompt
create or replace synonym EMS506UNICOO.COMPL_CARGO_EEC
  for EMS5.COMPL_CARGO_EEC;

prompt
prompt Creating synonym COMPL_COND_COBR_ACR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.COMPL_COND_COBR_ACR
  for EMS5.COMPL_COND_COBR_ACR;

prompt
prompt Creating synonym COMPL_HISTOR_PADR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.COMPL_HISTOR_PADR
  for EMS5.COMPL_HISTOR_PADR;

prompt
prompt Creating synonym COMPL_HOTEL_EEC
prompt ================================
prompt
create or replace synonym EMS506UNICOO.COMPL_HOTEL_EEC
  for EMS5.COMPL_HOTEL_EEC;

prompt
prompt Creating synonym COMPL_IMPTO_RETID_AP
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.COMPL_IMPTO_RETID_AP
  for EMS5.COMPL_IMPTO_RETID_AP;

prompt
prompt Creating synonym COMPL_MOVTO_PAGTO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.COMPL_MOVTO_PAGTO
  for EMS5.COMPL_MOVTO_PAGTO;

prompt
prompt Creating synonym COMPL_MOVTO_TIT_ACR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.COMPL_MOVTO_TIT_ACR
  for EMS5.COMPL_MOVTO_TIT_ACR;

prompt
prompt Creating synonym COMPL_PADR
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.COMPL_PADR
  for EMS5.COMPL_PADR;

prompt
prompt Creating synonym COMPL_PAGTO_CARTCRED
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.COMPL_PAGTO_CARTCRED
  for EMS5.COMPL_PAGTO_CARTCRED;

prompt
prompt Creating synonym COMPLRETENCIMPTOPAGTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.COMPLRETENCIMPTOPAGTO
  for EMS5.COMPLRETENCIMPTOPAGTO;

prompt
prompt Creating synonym COMPON_DOCUMEN
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.COMPON_DOCUMEN
  for EMS5.COMPON_DOCUMEN;

prompt
prompt Creating synonym COMPON_DOCUMEN_IDIOM
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.COMPON_DOCUMEN_IDIOM
  for EMS5.COMPON_DOCUMEN_IDIOM;

prompt
prompt Creating synonym COMPON_FORMUL_EDI
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.COMPON_FORMUL_EDI
  for EMS5.COMPON_FORMUL_EDI;

prompt
prompt Creating synonym COMPOS_CTA_CTBL_EXT
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.COMPOS_CTA_CTBL_EXT
  for EMS5.COMPOS_CTA_CTBL_EXT;

prompt
prompt Creating synonym COMPOS_CTA_PAT_USUAR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.COMPOS_CTA_PAT_USUAR
  for EMS5.COMPOS_CTA_PAT_USUAR;

prompt
prompt Creating synonym COMPOS_DEMONST_CTBL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.COMPOS_DEMONST_CTBL
  for EMS5.COMPOS_DEMONST_CTBL;

prompt
prompt Creating synonym COMPOS_FINALID
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.COMPOS_FINALID
  for EMS5.COMPOS_FINALID;

prompt
prompt Creating synonym COMPOS_FINALID_CMCMM
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.COMPOS_FINALID_CMCMM
  for EMS5.COMPOS_FINALID_CMCMM;

prompt
prompt Creating synonym COMPOS_GRP_CALC
prompt ================================
prompt
create or replace synonym EMS506UNICOO.COMPOS_GRP_CALC
  for EMS5.COMPOS_GRP_CALC;

prompt
prompt Creating synonym COMPOS_PADR_FLUXO_CX
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.COMPOS_PADR_FLUXO_CX
  for EMS5.COMPOS_PADR_FLUXO_CX;

prompt
prompt Creating synonym COMPOS_PRODUT_FINANC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.COMPOS_PRODUT_FINANC
  for EMS5.COMPOS_PRODUT_FINANC;

prompt
prompt Creating synonym COMPOS_TIP_FLUXO_TOT
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.COMPOS_TIP_FLUXO_TOT
  for EMS5.COMPOS_TIP_FLUXO_TOT;

prompt
prompt Creating synonym COMPOS_UNID_CONTROL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.COMPOS_UNID_CONTROL
  for EMS5.COMPOS_UNID_CONTROL;

prompt
prompt Creating synonym COMPOSICAO_TITULO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.COMPOSICAO_TITULO
  for PRODUCAO.COMPOSICAO_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONCES_TELEF
prompt =============================
prompt
create or replace synonym EMS506UNICOO.CONCES_TELEF
  for EMS5.CONCES_TELEF;

prompt
prompt Creating synonym CONCIL_CTA_CORREN
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CONCIL_CTA_CORREN
  for EMS5.CONCIL_CTA_CORREN;

prompt
prompt Creating synonym CONCOR_FINALID_ECON
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.CONCOR_FINALID_ECON
  for EMS5.CONCOR_FINALID_ECON;

prompt
prompt Creating synonym CONCORRENTE
prompt ============================
prompt
create or replace synonym EMS506UNICOO.CONCORRENTE
  for EMS5.CONCORRENTE;

prompt
prompt Creating synonym COND_COBR_ACR
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.COND_COBR_ACR
  for EMS5.COND_COBR_ACR;

prompt
prompt Creating synonym COND_PAGTO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.COND_PAGTO
  for EMS5.COND_PAGTO;

prompt
prompt Creating synonym CONDICAO_DE_CADASTRO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CONDICAO_DE_CADASTRO
  for PRODUCAO.CONDICAO_DE_CADASTRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONDICAO_PAGAMENTO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CONDICAO_PAGAMENTO
  for PRODUCAO.CONDICAO_PAGAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONF_INSS_PRESTADOR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.CONF_INSS_PRESTADOR
  for PRODUCAO.CONF_INSS_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONF_LEIAUTE_TAF
prompt =================================
prompt
create or replace synonym EMS506UNICOO.CONF_LEIAUTE_TAF
  for PRODUCAO.CONF_LEIAUTE_TAF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONFEREN_SERV
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.CONFEREN_SERV
  for EMS5.CONFEREN_SERV;

prompt
prompt Creating synonym CONFERENCIA_FATURA_PRE
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.CONFERENCIA_FATURA_PRE
  for PRODUCAO.CONFERENCIA_FATURA_PRE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONFIG_IMP_ROL_A950
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.CONFIG_IMP_ROL_A950
  for PRODUCAO.CONFIG_IMP_ROL_A950@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONFIG_RECOLHIMENTO_GFIP
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.CONFIG_RECOLHIMENTO_GFIP
  for PRODUCAO.CONFIG_RECOLHIMENTO_GFIP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONFIGURACAO_CHEQUE
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.CONFIGURACAO_CHEQUE
  for PRODUCAO.CONFIGURACAO_CHEQUE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONFIGURACAO_IVAST_UF
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONFIGURACAO_IVAST_UF
  for PRODUCAO.CONFIGURACAO_IVAST_UF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONJTO_PREFER_DEMONST
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONJTO_PREFER_DEMONST
  for EMS5.CONJTO_PREFER_DEMONST;

prompt
prompt Creating synonym CONSELHO_PROFISSIONAL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONSELHO_PROFISSIONAL
  for PRODUCAO.CONSELHO_PROFISSIONAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONSISTENCIA_RETORNO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CONSISTENCIA_RETORNO
  for PRODUCAO.CONSISTENCIA_RETORNO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONSOLIDACAO_EMPRESA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CONSOLIDACAO_EMPRESA
  for PRODUCAO.CONSOLIDACAO_EMPRESA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONSULTA_POR_ESPECIALIDADE
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.CONSULTA_POR_ESPECIALIDADE
  for PRODUCAO.CONSULTA_POR_ESPECIALIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTA_CONTABIL
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.CONTA_CONTABIL
  for PRODUCAO.CONTA_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTA_CORRENTE
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.CONTA_CORRENTE
  for PRODUCAO.CONTA_CORRENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTABIL_CAIXA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.CONTABIL_CAIXA
  for PRODUCAO.CONTABIL_CAIXA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTABILISTA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.CONTABILISTA
  for PRODUCAO.CONTABILISTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTABILISTA_SPED
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CONTABILISTA_SPED
  for PRODUCAO.CONTABILISTA_SPED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTAGEM_BENEF_TEMP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.CONTAGEM_BENEF_TEMP
  for PRODUCAO.CONTAGEM_BENEF_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTAT_CLAS
prompt ============================
prompt
create or replace synonym EMS506UNICOO.CONTAT_CLAS
  for EMS5.CONTAT_CLAS;

prompt
prompt Creating synonym CONTATO
prompt ========================
prompt
create or replace synonym EMS506UNICOO.CONTATO
  for EMS5.CONTATO;

prompt
prompt Creating synonym CONTDO_REG_IMPORT_EDI
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONTDO_REG_IMPORT_EDI
  for EMS5.CONTDO_REG_IMPORT_EDI;

prompt
prompt Creating synonym CONTESTACAO_INTERCAMBIO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.CONTESTACAO_INTERCAMBIO
  for PRODUCAO.CONTESTACAO_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTESTACAO_MOVIMENTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONTESTACAO_MOVIMENTO
  for PRODUCAO.CONTESTACAO_MOVIMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTESTACAO_MOVIMENTO_DETALHE
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.CONTESTACAO_MOVIMENTO_DETALHE
  for PRODUCAO.CONTESTACAO_MOVIMENTO_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTR_PES_JUROS_MULTA_VIGENCIA
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.CONTR_PES_JUROS_MULTA_VIGENCIA
  for PRODUCAO.CONTR_PES_JUROS_MULTA_VIGENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRAT_CARTCRED
prompt =================================
prompt
create or replace synonym EMS506UNICOO.CONTRAT_CARTCRED
  for EMS5.CONTRAT_CARTCRED;

prompt
prompt Creating synonym CONTRAT_LEAS
prompt =============================
prompt
create or replace synonym EMS506UNICOO.CONTRAT_LEAS
  for EMS5.CONTRAT_LEAS;

prompt
prompt Creating synonym CONTRAT_VENDOR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.CONTRAT_VENDOR
  for EMS5.CONTRAT_VENDOR;

prompt
prompt Creating synonym CONTRATO_COPARTICIPACAO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_COPARTICIPACAO
  for PRODUCAO.CONTRATO_COPARTICIPACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_CORRETOR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_CORRETOR
  for PRODUCAO.CONTRATO_CORRETOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_DA_PESSOA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_DA_PESSOA
  for PRODUCAO.CONTRATO_DA_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_DA_PESSOA_COPIA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_DA_PESSOA_COPIA
  for PRODUCAO.CONTRATO_DA_PESSOA_COPIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_DEPENDENCIA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_DEPENDENCIA
  for PRODUCAO.CONTRATO_DEPENDENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_EMISS_CART
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_EMISS_CART
  for PRODUCAO.CONTRATO_EMISS_CART@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_EMISS_CART_REL
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_EMISS_CART_REL
  for PRODUCAO.CONTRATO_EMISS_CART_REL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_NAO_FATURADO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_NAO_FATURADO
  for PRODUCAO.CONTRATO_NAO_FATURADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_PADRAO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_PADRAO
  for PRODUCAO.CONTRATO_PADRAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_PADRAO_CLASSIFICACAO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_PADRAO_CLASSIFICACAO
  for PRODUCAO.CONTRATO_PADRAO_CLASSIFICACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_PADRAO_NOSSO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_PADRAO_NOSSO
  for PRODUCAO.CONTRATO_PADRAO_NOSSO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_PESSOA_JUROS_MULTA
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_PESSOA_JUROS_MULTA
  for PRODUCAO.CONTRATO_PESSOA_JUROS_MULTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_PESSOA_TAB_REFER
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_PESSOA_TAB_REFER
  for PRODUCAO.CONTRATO_PESSOA_TAB_REFER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_PESSOA_TIPCARTEIRA
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_PESSOA_TIPCARTEIRA
  for PRODUCAO.CONTRATO_PESSOA_TIPCARTEIRA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_PLANO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_PLANO
  for PRODUCAO.CONTRATO_PLANO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_SEM_GFIP
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_SEM_GFIP
  for PRODUCAO.CONTRATO_SEM_GFIP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_SINISTR_PERIODO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_SINISTR_PERIODO
  for PRODUCAO.CONTRATO_SINISTR_PERIODO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_TIPCARTEIRA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_TIPCARTEIRA
  for PRODUCAO.CONTRATO_TIPCARTEIRA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRATO_TIPO_AUTORIZ
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONTRATO_TIPO_AUTORIZ
  for PRODUCAO.CONTRATO_TIPO_AUTORIZ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRIB_SOCIAL_PIS_COFINS
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.CONTRIB_SOCIAL_PIS_COFINS
  for PRODUCAO.CONTRIB_SOCIAL_PIS_COFINS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRIB_SOCIAL_PIS_COFINS_DET
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.CONTRIB_SOCIAL_PIS_COFINS_DET
  for PRODUCAO.CONTRIB_SOCIAL_PIS_COFINS_DET@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTRIBUINTE_SUBSTITUTO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.CONTRIBUINTE_SUBSTITUTO
  for PRODUCAO.CONTRIBUINTE_SUBSTITUTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROL_ID_ESOC
prompt ================================
prompt
create or replace synonym EMS506UNICOO.CONTROL_ID_ESOC
  for EMS5.CONTROL_ID_ESOC;

prompt
prompt Creating synonym CONTROL_IMPRSOR_SLIP
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CONTROL_IMPRSOR_SLIP
  for EMS5.CONTROL_IMPRSOR_SLIP;

prompt
prompt Creating synonym CONTROL_PROCES_EDI
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CONTROL_PROCES_EDI
  for EMS5.CONTROL_PROCES_EDI;

prompt
prompt Creating synonym CONTROL_TAR_EXECDO_SHC
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.CONTROL_TAR_EXECDO_SHC
  for EMS5.CONTROL_TAR_EXECDO_SHC;

prompt
prompt Creating synonym CONTROLDEMONSTCTBLACR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONTROLDEMONSTCTBLACR
  for EMS5.CONTROLDEMONSTCTBLACR;

prompt
prompt Creating synonym CONTROLDEMONSTCTBLAPB
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONTROLDEMONSTCTBLAPB
  for EMS5.CONTROLDEMONSTCTBLAPB;

prompt
prompt Creating synonym CONTROLE_AJUSTE_UV
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_AJUSTE_UV
  for PRODUCAO.CONTROLE_AJUSTE_UV@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_APURACAO_SPED
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_APURACAO_SPED
  for PRODUCAO.CONTROLE_APURACAO_SPED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_CALCULO_PRE
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_CALCULO_PRE
  for PRODUCAO.CONTROLE_CALCULO_PRE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_CALCULO_TPS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_CALCULO_TPS
  for PRODUCAO.CONTROLE_CALCULO_TPS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_CANCELAMENTO_INADIMPL
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_CANCELAMENTO_INADIMPL
  for PRODUCAO.CONTROLE_CANCELAMENTO_INADIMPL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_CRED_FISC_PIS_COFINS
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_CRED_FISC_PIS_COFINS
  for PRODUCAO.CONTROLE_CRED_FISC_PIS_COFINS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_DE_PERIODO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_DE_PERIODO
  for PRODUCAO.CONTROLE_DE_PERIODO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_DILUICAO_PRECO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_DILUICAO_PRECO
  for PRODUCAO.CONTROLE_DILUICAO_PRECO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_DIRF
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_DIRF
  for PRODUCAO.CONTROLE_DIRF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_EMISS_CART
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_EMISS_CART
  for PRODUCAO.CONTROLE_EMISS_CART@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_EMISS_CHEQUE_CONSULTA
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_EMISS_CHEQUE_CONSULTA
  for PRODUCAO.CONTROLE_EMISS_CHEQUE_CONSULTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_EMISSAO_PRE_AUTORIZ
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_EMISSAO_PRE_AUTORIZ
  for PRODUCAO.CONTROLE_EMISSAO_PRE_AUTORIZ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_ENVIO_TITULO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_ENVIO_TITULO
  for PRODUCAO.CONTROLE_ENVIO_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_ENVIO_TITULO_PAGAR
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_ENVIO_TITULO_PAGAR
  for PRODUCAO.CONTROLE_ENVIO_TITULO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_GERACAO_A550
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_GERACAO_A550
  for PRODUCAO.CONTROLE_GERACAO_A550@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_GERACAO_A700
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_GERACAO_A700
  for PRODUCAO.CONTROLE_GERACAO_A700@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_GERACAO_A800
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_GERACAO_A800
  for PRODUCAO.CONTROLE_GERACAO_A800@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_GERACAO_GFIP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_GERACAO_GFIP
  for PRODUCAO.CONTROLE_GERACAO_GFIP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_GUIA_PRESTADOR
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_GUIA_PRESTADOR
  for PRODUCAO.CONTROLE_GUIA_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_INTEGRACAO_GUIAS
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_INTEGRACAO_GUIAS
  for PRODUCAO.CONTROLE_INTEGRACAO_GUIAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_INTERCAMBIO_ONLINE
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_INTERCAMBIO_ONLINE
  for PRODUCAO.CONTROLE_INTERCAMBIO_ONLINE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_PARCELAMENTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_PARCELAMENTO
  for PRODUCAO.CONTROLE_PARCELAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_PEONA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_PEONA
  for PRODUCAO.CONTROLE_PEONA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_PROCESSO_ANALISE
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_PROCESSO_ANALISE
  for PRODUCAO.CONTROLE_PROCESSO_ANALISE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_PROCESSO_PAGAMENTO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_PROCESSO_PAGAMENTO
  for PRODUCAO.CONTROLE_PROCESSO_PAGAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_RETORNO_TITULO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_RETORNO_TITULO
  for PRODUCAO.CONTROLE_RETORNO_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_RETORNO_TITULO_PAGAR
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_RETORNO_TITULO_PAGAR
  for PRODUCAO.CONTROLE_RETORNO_TITULO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_UPLOAD
prompt ================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_UPLOAD
  for PRODUCAO.CONTROLE_UPLOAD@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_VALIDA_PRODUCAO_PAGTO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_VALIDA_PRODUCAO_PAGTO
  for PRODUCAO.CONTROLE_VALIDA_PRODUCAO_PAGTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONTROLE_VL_RETIDO_FONTE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.CONTROLE_VL_RETIDO_FONTE
  for PRODUCAO.CONTROLE_VL_RETIDO_FONTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONV_CONTRATO_DA_PESSOA
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.CONV_CONTRATO_DA_PESSOA
  for PRODUCAO.CONV_CONTRATO_DA_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONV_DOENCA_USUARIO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.CONV_DOENCA_USUARIO
  for PRODUCAO.CONV_DOENCA_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONV_ENDERECO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.CONV_ENDERECO
  for PRODUCAO.CONV_ENDERECO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONV_FAMILIA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.CONV_FAMILIA
  for PRODUCAO.CONV_FAMILIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONV_PESSOA
prompt ============================
prompt
create or replace synonym EMS506UNICOO.CONV_PESSOA
  for PRODUCAO.CONV_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONV_PRECO_CONTRATO_PESSOA
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.CONV_PRECO_CONTRATO_PESSOA
  for PRODUCAO.CONV_PRECO_CONTRATO_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONV_REPASSE_DO_USUARIO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.CONV_REPASSE_DO_USUARIO
  for PRODUCAO.CONV_REPASSE_DO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONV_USUARIO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.CONV_USUARIO
  for PRODUCAO.CONV_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONVEN_CART_BCIA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.CONVEN_CART_BCIA
  for EMS5.CONVEN_CART_BCIA;

prompt
prompt Creating synonym CONVEN_VENDOR
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.CONVEN_VENDOR
  for EMS5.CONVEN_VENDOR;

prompt
prompt Creating synonym CONVENIO_CONTRATO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CONVENIO_CONTRATO
  for PRODUCAO.CONVENIO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONVENIO_FECHAMENTO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.CONVENIO_FECHAMENTO
  for PRODUCAO.CONVENIO_FECHAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONVER_UNID_MEDID
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CONVER_UNID_MEDID
  for EMS5.CONVER_UNID_MEDID;

prompt
prompt Creating synonym CONVERSAO_CLIENTE
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CONVERSAO_CLIENTE
  for PRODUCAO.CONVERSAO_CLIENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CONVERSAO_CONTRATO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CONVERSAO_CONTRATO
  for PRODUCAO.CONVERSAO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym COPIA_CONTRATO_COPARTICIPACAO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.COPIA_CONTRATO_COPARTICIPACAO
  for PRODUCAO.COPIA_CONTRATO_COPARTICIPACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym COPIA_IN35
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.COPIA_IN35
  for PRODUCAO.COPIA_IN35@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym COPIA_SIB_201105
prompt =================================
prompt
create or replace synonym EMS506UNICOO.COPIA_SIB_201105
  for PRODUCAO.COPIA_SIB_201105@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym COPIA_SIB_201106
prompt =================================
prompt
create or replace synonym EMS506UNICOO.COPIA_SIB_201106
  for PRODUCAO.COPIA_SIB_201106@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CORREIO_EDI
prompt ============================
prompt
create or replace synonym EMS506UNICOO.CORREIO_EDI
  for EMS5.CORREIO_EDI;

prompt
prompt Creating synonym CORRETOR
prompt =========================
prompt
create or replace synonym EMS506UNICOO.CORRETOR
  for EMS5.CORRETOR;

prompt
prompt Creating synonym COTAC_OPERAC_FINANC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.COTAC_OPERAC_FINANC
  for EMS5.COTAC_OPERAC_FINANC;

prompt
prompt Creating synonym COTAC_PARID
prompt ============================
prompt
create or replace synonym EMS506UNICOO.COTAC_PARID
  for EMS5.COTAC_PARID;

prompt
prompt Creating synonym CRIPT
prompt ======================
prompt
create or replace synonym EMS506UNICOO.CRIPT
  for PRODUCAO.CRIPT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITER_CALC_EMPRES_PAT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.CRITER_CALC_EMPRES_PAT
  for EMS5.CRITER_CALC_EMPRES_PAT;

prompt
prompt Creating synonym CRITERDISTRIBCTACTBL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CRITERDISTRIBCTACTBL
  for EMS5.CRITERDISTRIBCTACTBL;

prompt
prompt Creating synonym CRITERIO
prompt =========================
prompt
create or replace synonym EMS506UNICOO.CRITERIO
  for PRODUCAO.CRITERIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_CLASSIFICACAO_ISS
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_CLASSIFICACAO_ISS
  for PRODUCAO.CRITERIO_CLASSIFICACAO_ISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_COBR_EMISSAO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_COBR_EMISSAO
  for PRODUCAO.CRITERIO_COBR_EMISSAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_CONTR_PES
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_CONTR_PES
  for PRODUCAO.CRITERIO_CONTR_PES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_DE_FATURAMENTO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_DE_FATURAMENTO
  for PRODUCAO.CRITERIO_DE_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_DE_FATURAMENTO_ITEMS
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_DE_FATURAMENTO_ITEMS
  for PRODUCAO.CRITERIO_DE_FATURAMENTO_ITEMS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_DE_HORAEXTRA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_DE_HORAEXTRA
  for PRODUCAO.CRITERIO_DE_HORAEXTRA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_DE_HORAEXTRA_ITEMS
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_DE_HORAEXTRA_ITEMS
  for PRODUCAO.CRITERIO_DE_HORAEXTRA_ITEMS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_DE_RATEIO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_DE_RATEIO
  for PRODUCAO.CRITERIO_DE_RATEIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_EVENTO_PRODMED
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_EVENTO_PRODMED
  for PRODUCAO.CRITERIO_EVENTO_PRODMED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_FATOR_MODERADOR
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_FATOR_MODERADOR
  for PRODUCAO.CRITERIO_FATOR_MODERADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_FATURAMENT0
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_FATURAMENT0
  for PRODUCAO.CRITERIO_FATURAMENT0@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_PAGAMENTO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_PAGAMENTO
  for PRODUCAO.CRITERIO_PAGAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_PAGAMENTO_2
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_PAGAMENTO_2
  for PRODUCAO.CRITERIO_PAGAMENTO_2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_PAGAMENTO_ITEM_2
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_PAGAMENTO_ITEM_2
  for PRODUCAO.CRITERIO_PAGAMENTO_ITEM_2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_PROC_MULT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_PROC_MULT
  for PRODUCAO.CRITERIO_PROC_MULT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_PROC_MULT_ITEM
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_PROC_MULT_ITEM
  for PRODUCAO.CRITERIO_PROC_MULT_ITEM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_REPASSE
prompt =================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_REPASSE
  for PRODUCAO.CRITERIO_REPASSE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_REPASSE_AREA_ACAO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_REPASSE_AREA_ACAO
  for PRODUCAO.CRITERIO_REPASSE_AREA_ACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIO_REPASSE_CONTRATO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.CRITERIO_REPASSE_CONTRATO
  for PRODUCAO.CRITERIO_REPASSE_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIOS_DO_USUARIO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CRITERIOS_DO_USUARIO
  for PRODUCAO.CRITERIOS_DO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIOS_DO_USUARIO_HIST_MOV
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.CRITERIOS_DO_USUARIO_HIST_MOV
  for PRODUCAO.CRITERIOS_DO_USUARIO_HIST_MOV@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIOS_DO_USUARIO_HISTORICO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.CRITERIOS_DO_USUARIO_HISTORICO
  for PRODUCAO.CRITERIOS_DO_USUARIO_HISTORICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITERIOS_REGERADOS
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.CRITERIOS_REGERADOS
  for PRODUCAO.CRITERIOS_REGERADOS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CRITIC_SDO_CTA_CTBL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.CRITIC_SDO_CTA_CTBL
  for EMS5.CRITIC_SDO_CTA_CTBL;

prompt
prompt Creating synonym CRONOG_CALC_PAT
prompt ================================
prompt
create or replace synonym EMS506UNICOO.CRONOG_CALC_PAT
  for EMS5.CRONOG_CALC_PAT;

prompt
prompt Creating synonym CST_011_F_DEPARA_PRESTADOR
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.CST_011_F_DEPARA_PRESTADOR
  for PRODUCAO.CST_011_F_DEPARA_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CST_IMPRIME_BOLETO_OMEGA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.CST_IMPRIME_BOLETO_OMEGA
  for PRODUCAO.CST_IMPRIME_BOLETO_OMEGA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CST_IR
prompt =======================
prompt
create or replace synonym EMS506UNICOO.CST_IR
  for PRODUCAO.CST_IR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CST_MODULO11
prompt =============================
prompt
create or replace synonym EMS506UNICOO.CST_MODULO11
  for PRODUCAO.CST_MODULO11@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CST_POSICAO_CONTABIL_APB
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.CST_POSICAO_CONTABIL_APB
  for PRODUCAO.CST_POSICAO_CONTABIL_APB@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CST_PRINT
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.CST_PRINT
  for PRODUCAO.CST_PRINT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CST_RIO_PRINT
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.CST_RIO_PRINT
  for PRODUCAO.CST_RIO_PRINT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CTA_CORREN
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.CTA_CORREN
  for EMS5.CTA_CORREN;

prompt
prompt Creating synonym CTA_CORREN_CTA_CTBL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.CTA_CORREN_CTA_CTBL
  for EMS5.CTA_CORREN_CTA_CTBL;

prompt
prompt Creating synonym CTA_CORREN_FORNEC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CTA_CORREN_FORNEC
  for EMS5.CTA_CORREN_FORNEC;

prompt
prompt Creating synonym CTA_CORREN_ONERA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.CTA_CORREN_ONERA
  for EMS5.CTA_CORREN_ONERA;

prompt
prompt Creating synonym CTA_CTBL
prompt =========================
prompt
create or replace synonym EMS506UNICOO.CTA_CTBL
  for EMS5.CTA_CTBL;

prompt
prompt Creating synonym CTA_CTBL_CMCMM
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.CTA_CTBL_CMCMM
  for EMS5.CTA_CTBL_CMCMM;

prompt
prompt Creating synonym CTA_CTBL_INTEGR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.CTA_CTBL_INTEGR
  for EMS5.CTA_CTBL_INTEGR;

prompt
prompt Creating synonym CTA_CTBL_INTRACOMPANY
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.CTA_CTBL_INTRACOMPANY
  for EMS5.CTA_CTBL_INTRACOMPANY;

prompt
prompt Creating synonym CTA_CTBL_TIP_ABAT
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CTA_CTBL_TIP_ABAT
  for EMS5.CTA_CTBL_TIP_ABAT;

prompt
prompt Creating synonym CTA_CTBL_TIP_FLUXO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.CTA_CTBL_TIP_FLUXO
  for EMS5.CTA_CTBL_TIP_FLUXO;

prompt
prompt Creating synonym CTA_GRP_CLIEN
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.CTA_GRP_CLIEN
  for EMS5.CTA_GRP_CLIEN;

prompt
prompt Creating synonym CTA_GRP_FORNEC
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.CTA_GRP_FORNEC
  for EMS5.CTA_GRP_FORNEC;

prompt
prompt Creating synonym CTA_GRP_REPRES
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.CTA_GRP_REPRES
  for EMS5.CTA_GRP_REPRES;

prompt
prompt Creating synonym CTA_PAT
prompt ========================
prompt
create or replace synonym EMS506UNICOO.CTA_PAT
  for EMS5.CTA_PAT;

prompt
prompt Creating synonym CTA_PRODUT_FINANC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CTA_PRODUT_FINANC
  for EMS5.CTA_PRODUT_FINANC;

prompt
prompt Creating synonym CTA_REPRES
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.CTA_REPRES
  for EMS5.CTA_REPRES;

prompt
prompt Creating synonym CTA_RESTRIC_ESTAB
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CTA_RESTRIC_ESTAB
  for EMS5.CTA_RESTRIC_ESTAB;

prompt
prompt Creating synonym CTA_RESTRIC_UNID_NEGOC
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.CTA_RESTRIC_UNID_NEGOC
  for EMS5.CTA_RESTRIC_UNID_NEGOC;

prompt
prompt Creating synonym CTACORRENCOMPOSMUTUO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CTACORRENCOMPOSMUTUO
  for EMS5.CTACORRENCOMPOSMUTUO;

prompt
prompt Creating synonym CTAGRPCLIENPERDDEDUT
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.CTAGRPCLIENPERDDEDUT
  for EMS5.CTAGRPCLIENPERDDEDUT;

prompt
prompt Creating synonym CURVA_ABC_ACR
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.CURVA_ABC_ACR
  for EMS5.CURVA_ABC_ACR;

prompt
prompt Creating synonym CUST_DEVOL_CHEQ
prompt ================================
prompt
create or replace synonym EMS506UNICOO.CUST_DEVOL_CHEQ
  for EMS5.CUST_DEVOL_CHEQ;

prompt
prompt Creating synonym CUSTO_INTERCAMBIO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.CUSTO_INTERCAMBIO
  for PRODUCAO.CUSTO_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CUSTO_PERIODO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.CUSTO_PERIODO
  for PRODUCAO.CUSTO_PERIODO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CUSTO_PRODUTO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.CUSTO_PRODUTO
  for PRODUCAO.CUSTO_PRODUTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym CX_FINANC
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.CX_FINANC
  for EMS5.CX_FINANC;

prompt
prompt Creating synonym DARF_AP
prompt ========================
prompt
create or replace synonym EMS506UNICOO.DARF_AP
  for EMS5.DARF_AP;

prompt
prompt Creating synonym DECIDE_PESSOA_PAGA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.DECIDE_PESSOA_PAGA
  for PRODUCAO.DECIDE_PESSOA_PAGA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DECLARACAO_NASCIMENTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.DECLARACAO_NASCIMENTO
  for PRODUCAO.DECLARACAO_NASCIMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DECLARACAO_OBITO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.DECLARACAO_OBITO
  for PRODUCAO.DECLARACAO_OBITO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DEDUCAO_PRESTADOR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.DEDUCAO_PRESTADOR
  for PRODUCAO.DEDUCAO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DEL_LOTE_CONTABIL
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.DEL_LOTE_CONTABIL
  for PRODUCAO.DEL_LOTE_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DEL_LOTE_PAGAR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.DEL_LOTE_PAGAR
  for PRODUCAO.DEL_LOTE_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DEMONST_CONCOR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.DEMONST_CONCOR
  for EMS5.DEMONST_CONCOR;

prompt
prompt Creating synonym DEMONST_CRED_DESCONT_CONTRIB
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.DEMONST_CRED_DESCONT_CONTRIB
  for PRODUCAO.DEMONST_CRED_DESCONT_CONTRIB@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DEMONST_CTBL
prompt =============================
prompt
create or replace synonym EMS506UNICOO.DEMONST_CTBL
  for EMS5.DEMONST_CTBL;

prompt
prompt Creating synonym DEMONST_CTBL_ACR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.DEMONST_CTBL_ACR
  for EMS5.DEMONST_CTBL_ACR;

prompt
prompt Creating synonym DEMONST_CTBL_APB
prompt =================================
prompt
create or replace synonym EMS506UNICOO.DEMONST_CTBL_APB
  for EMS5.DEMONST_CTBL_APB;

prompt
prompt Creating synonym DEMONST_CTBL_PUBLIC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.DEMONST_CTBL_PUBLIC
  for EMS5.DEMONST_CTBL_PUBLIC;

prompt
prompt Creating synonym DEMONSTRATIVO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.DEMONSTRATIVO
  for PRODUCAO.DEMONSTRATIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DEMONSTRATIVO_DE_RESULTADO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.DEMONSTRATIVO_DE_RESULTADO
  for PRODUCAO.DEMONSTRATIVO_DE_RESULTADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DEPARA_PLANO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.DEPARA_PLANO
  for PRODUCAO.DEPARA_PLANO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DEPOSITO_IDENTIFICADO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.DEPOSITO_IDENTIFICADO
  for PRODUCAO.DEPOSITO_IDENTIFICADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DESCONTO_ABRANGENCIA_TPS
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.DESCONTO_ABRANGENCIA_TPS
  for PRODUCAO.DESCONTO_ABRANGENCIA_TPS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DESCONTO_COBERTURA_TPS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.DESCONTO_COBERTURA_TPS
  for PRODUCAO.DESCONTO_COBERTURA_TPS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DESCONTO_CONTR_PADRAO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.DESCONTO_CONTR_PADRAO
  for PRODUCAO.DESCONTO_CONTR_PADRAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DESCONTO_USUARIO_PROPOSTA
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.DESCONTO_USUARIO_PROPOSTA
  for PRODUCAO.DESCONTO_USUARIO_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DESCRICAO_RATEIO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.DESCRICAO_RATEIO
  for PRODUCAO.DESCRICAO_RATEIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DESPES_OPERAC_FINANC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.DESPES_OPERAC_FINANC
  for EMS5.DESPES_OPERAC_FINANC;

prompt
prompt Creating synonym DESPES_PROCES_EEC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.DESPES_PROCES_EEC
  for EMS5.DESPES_PROCES_EEC;

prompt
prompt Creating synonym DESPESA_A_PAGAR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.DESPESA_A_PAGAR
  for PRODUCAO.DESPESA_A_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DESTINAC_COBR
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.DESTINAC_COBR
  for EMS5.DESTINAC_COBR;

prompt
prompt Creating synonym DESTINATARIO_GUIA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.DESTINATARIO_GUIA
  for PRODUCAO.DESTINATARIO_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DET_DESPES_PROCES_EEC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.DET_DESPES_PROCES_EEC
  for EMS5.DET_DESPES_PROCES_EEC;

prompt
prompt Creating synonym DET_LANCTO_FP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.DET_LANCTO_FP
  for EMS5.DET_LANCTO_FP;

prompt
prompt Creating synonym DET_LOTE_MOV_HISTORICO_PAGAR
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.DET_LOTE_MOV_HISTORICO_PAGAR
  for PRODUCAO.DET_LOTE_MOV_HISTORICO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DET_LOTE_MOV_HISTORICO_RECEBER
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.DET_LOTE_MOV_HISTORICO_RECEBER
  for PRODUCAO.DET_LOTE_MOV_HISTORICO_RECEBER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_CADASTRO_REDUCAOZ
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_CADASTRO_REDUCAOZ
  for PRODUCAO.DETALHE_CADASTRO_REDUCAOZ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_CALCULO_TPS
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_CALCULO_TPS
  for PRODUCAO.DETALHE_CALCULO_TPS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_CARTA_DE_CORRECAO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_CARTA_DE_CORRECAO
  for PRODUCAO.DETALHE_CARTA_DE_CORRECAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_COMISSAO_VENDA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_COMISSAO_VENDA
  for PRODUCAO.DETALHE_COMISSAO_VENDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_COMISSAO_VENDA_ITEM
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_COMISSAO_VENDA_ITEM
  for PRODUCAO.DETALHE_COMISSAO_VENDA_ITEM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_CRED_EXTE_VINC
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_CRED_EXTE_VINC
  for PRODUCAO.DETALHE_CRED_EXTE_VINC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_CUSTO_INTERCAMBIO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_CUSTO_INTERCAMBIO
  for PRODUCAO.DETALHE_CUSTO_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_DILUICAO_PRECO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_DILUICAO_PRECO
  for PRODUCAO.DETALHE_DILUICAO_PRECO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_DIRF
prompt =============================
prompt
create or replace synonym EMS506UNICOO.DETALHE_DIRF
  for PRODUCAO.DETALHE_DIRF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_DOENCA_USU_PROPOSTA
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_DOENCA_USU_PROPOSTA
  for PRODUCAO.DETALHE_DOENCA_USU_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_ESQUEMA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_ESQUEMA
  for PRODUCAO.DETALHE_ESQUEMA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_FAIXA_ETARIA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_FAIXA_ETARIA
  for PRODUCAO.DETALHE_FAIXA_ETARIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_FATURAMENTO_CUSTO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_FATURAMENTO_CUSTO
  for PRODUCAO.DETALHE_FATURAMENTO_CUSTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_FATURAMENTO_CUSTO_BKP
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_FATURAMENTO_CUSTO_BKP
  for PRODUCAO.DETALHE_FATURAMENTO_CUSTO_BKP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_FATURAMENTO_CUSTO_CANC
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_FATURAMENTO_CUSTO_CANC
  for PRODUCAO.DETALHE_FATURAMENTO_CUSTO_CANC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_FATURAMENTO_PREMIO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_FATURAMENTO_PREMIO
  for PRODUCAO.DETALHE_FATURAMENTO_PREMIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_FLUXO_DE_CAIXA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_FLUXO_DE_CAIXA
  for PRODUCAO.DETALHE_FLUXO_DE_CAIXA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_HISTORICO_CONTR_PESSOA
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_HISTORICO_CONTR_PESSOA
  for PRODUCAO.DETALHE_HISTORICO_CONTR_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_MODELO_CHEQUE
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_MODELO_CHEQUE
  for PRODUCAO.DETALHE_MODELO_CHEQUE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_MOVIMENTO_AVULSO_LIVRO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_MOVIMENTO_AVULSO_LIVRO
  for PRODUCAO.DETALHE_MOVIMENTO_AVULSO_LIVRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_PAGAMENTO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_PAGAMENTO
  for PRODUCAO.DETALHE_PAGAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_PAGAMENTO_CAIXA_UNICO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_PAGAMENTO_CAIXA_UNICO
  for PRODUCAO.DETALHE_PAGAMENTO_CAIXA_UNICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_PEONA
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.DETALHE_PEONA
  for PRODUCAO.DETALHE_PEONA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DETALHE_VALIDA_PRODUCAO_PAGTO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.DETALHE_VALIDA_PRODUCAO_PAGTO
  for PRODUCAO.DETALHE_VALIDA_PRODUCAO_PAGTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DIA_CALEND_GLOB
prompt ================================
prompt
create or replace synonym EMS506UNICOO.DIA_CALEND_GLOB
  for EMS5.DIA_CALEND_GLOB;

prompt
prompt Creating synonym DIAS_REFERENCIA_PRODUCAO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.DIAS_REFERENCIA_PRODUCAO
  for PRODUCAO.DIAS_REFERENCIA_PRODUCAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DIGITAL_USUARIO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.DIGITAL_USUARIO
  for PRODUCAO.DIGITAL_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DIOPS_PLANO_DE_CONTAS_PADRAO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.DIOPS_PLANO_DE_CONTAS_PADRAO
  for PRODUCAO.DIOPS_PLANO_DE_CONTAS_PADRAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DIOPS_PLANODECONTASPADRAO_BCK
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.DIOPS_PLANODECONTASPADRAO_BCK
  for PRODUCAO.DIOPS_PLANODECONTASPADRAO_BCK@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DIRF
prompt =====================
prompt
create or replace synonym EMS506UNICOO.DIRF
  for PRODUCAO.DIRF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DIRF_APB
prompt =========================
prompt
create or replace synonym EMS506UNICOO.DIRF_APB
  for EMS5.DIRF_APB;

prompt
prompt Creating synonym DIRF_CONFIGURACAO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.DIRF_CONFIGURACAO
  for PRODUCAO.DIRF_CONFIGURACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DIRF_DEDUCAO_TITULO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.DIRF_DEDUCAO_TITULO
  for PRODUCAO.DIRF_DEDUCAO_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DIRF_TAXA_TITULO_A_PAGAR
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.DIRF_TAXA_TITULO_A_PAGAR
  for PRODUCAO.DIRF_TAXA_TITULO_A_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DIRF_TITULO_A_PAGAR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.DIRF_TITULO_A_PAGAR
  for PRODUCAO.DIRF_TITULO_A_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DISPENSA_SPED_PIS_COFINS
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.DISPENSA_SPED_PIS_COFINS
  for PRODUCAO.DISPENSA_SPED_PIS_COFINS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DISPONIBILIDADE_RECURSO_AG_CM
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.DISPONIBILIDADE_RECURSO_AG_CM
  for PRODUCAO.DISPONIBILIDADE_RECURSO_AG_CM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DISTRIB_CTA_CLASSIF
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.DISTRIB_CTA_CLASSIF
  for EMS5.DISTRIB_CTA_CLASSIF;

prompt
prompt Creating synonym DISTRIBUICAO_TITULO_PAGAR
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.DISTRIBUICAO_TITULO_PAGAR
  for PRODUCAO.DISTRIBUICAO_TITULO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DOCTO_ENTR
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.DOCTO_ENTR
  for EMS5.DOCTO_ENTR;

prompt
prompt Creating synonym DOCTO_ESTOQ_ESOC
prompt =================================
prompt
create or replace synonym EMS506UNICOO.DOCTO_ESTOQ_ESOC
  for EMS5.DOCTO_ESTOQ_ESOC;

prompt
prompt Creating synonym DOCTO_RECIBO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.DOCTO_RECIBO
  for EMS5.DOCTO_RECIBO;

prompt
prompt Creating synonym DOCUMEN_OPERAC_FINANC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.DOCUMEN_OPERAC_FINANC
  for EMS5.DOCUMEN_OPERAC_FINANC;

prompt
prompt Creating synonym DOCUMENTO_DE_COBRANCA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.DOCUMENTO_DE_COBRANCA
  for PRODUCAO.DOCUMENTO_DE_COBRANCA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DOCUMENTO_PAGTO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.DOCUMENTO_PAGTO
  for PRODUCAO.DOCUMENTO_PAGTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DOENCA_CONTROLADA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.DOENCA_CONTROLADA
  for PRODUCAO.DOENCA_CONTROLADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DOENCA_CONTROLADA_PRECO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.DOENCA_CONTROLADA_PRECO
  for PRODUCAO.DOENCA_CONTROLADA_PRECO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DOENCA_PRE_EXISTENTE
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.DOENCA_PRE_EXISTENTE
  for PRODUCAO.DOENCA_PRE_EXISTENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DOENCA_TRATAMENTO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.DOENCA_TRATAMENTO
  for PRODUCAO.DOENCA_TRATAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DOENCA_USU_PROPOSTA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.DOENCA_USU_PROPOSTA
  for PRODUCAO.DOENCA_USU_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DOENCA_USUARIO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.DOENCA_USUARIO
  for PRODUCAO.DOENCA_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DOMIN_CARACT
prompt =============================
prompt
create or replace synonym EMS506UNICOO.DOMIN_CARACT
  for EMS5.DOMIN_CARACT;

prompt
prompt Creating synonym DUAL_INF1
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.DUAL_INF1
  for PRODUCAO.DUAL_INF1@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym DUPL_VENDOR
prompt ============================
prompt
create or replace synonym EMS506UNICOO.DUPL_VENDOR
  for EMS5.DUPL_VENDOR;

prompt
prompt Creating synonym DUPLICATA_FATURAMENTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.DUPLICATA_FATURAMENTO
  for PRODUCAO.DUPLICATA_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_0000
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_0000
  for PRODUCAO.ECD_0000@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_0000_BKP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ECD_0000_BKP
  for PRODUCAO.ECD_0000_BKP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_0001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_0001
  for PRODUCAO.ECD_0001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_0007
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_0007
  for PRODUCAO.ECD_0007@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_0020
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_0020
  for PRODUCAO.ECD_0020@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_0020_BKP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ECD_0020_BKP
  for PRODUCAO.ECD_0020_BKP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_0150
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_0150
  for PRODUCAO.ECD_0150@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_0150_BKP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ECD_0150_BKP
  for PRODUCAO.ECD_0150_BKP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_0180
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_0180
  for PRODUCAO.ECD_0180@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_0990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_0990
  for PRODUCAO.ECD_0990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_9001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_9001
  for PRODUCAO.ECD_9001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_9900
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_9900
  for PRODUCAO.ECD_9900@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_9990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_9990
  for PRODUCAO.ECD_9990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_9999
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_9999
  for PRODUCAO.ECD_9999@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_AUDITOR
prompt ============================
prompt
create or replace synonym EMS506UNICOO.ECD_AUDITOR
  for PRODUCAO.ECD_AUDITOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_CONFIGURACAO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.ECD_CONFIGURACAO
  for PRODUCAO.ECD_CONFIGURACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_CONFIGURACAO_FCONT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ECD_CONFIGURACAO_FCONT
  for PRODUCAO.ECD_CONFIGURACAO_FCONT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_GERACAO_SPED_CONTABIL
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.ECD_GERACAO_SPED_CONTABIL
  for PRODUCAO.ECD_GERACAO_SPED_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I001
  for PRODUCAO.ECD_I001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I010
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I010
  for PRODUCAO.ECD_I010@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I012
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I012
  for PRODUCAO.ECD_I012@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I015
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I015
  for PRODUCAO.ECD_I015@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I020
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I020
  for PRODUCAO.ECD_I020@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I030
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I030
  for PRODUCAO.ECD_I030@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I050
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I050
  for PRODUCAO.ECD_I050@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I051
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I051
  for PRODUCAO.ECD_I051@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I052
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I052
  for PRODUCAO.ECD_I052@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I053
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I053
  for PRODUCAO.ECD_I053@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I075
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I075
  for PRODUCAO.ECD_I075@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I100
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I100
  for PRODUCAO.ECD_I100@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I150
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I150
  for PRODUCAO.ECD_I150@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I155
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I155
  for PRODUCAO.ECD_I155@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I156
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I156
  for PRODUCAO.ECD_I156@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I200
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I200
  for PRODUCAO.ECD_I200@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I250
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I250
  for PRODUCAO.ECD_I250@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I256
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I256
  for PRODUCAO.ECD_I256@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I300
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I300
  for PRODUCAO.ECD_I300@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I310
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I310
  for PRODUCAO.ECD_I310@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I350
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I350
  for PRODUCAO.ECD_I350@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I355
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I355
  for PRODUCAO.ECD_I355@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I356
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I356
  for PRODUCAO.ECD_I356@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I500
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I500
  for PRODUCAO.ECD_I500@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I510
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I510
  for PRODUCAO.ECD_I510@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I550
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I550
  for PRODUCAO.ECD_I550@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I555
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I555
  for PRODUCAO.ECD_I555@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_I990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_I990
  for PRODUCAO.ECD_I990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_J001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_J001
  for PRODUCAO.ECD_J001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_J005
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_J005
  for PRODUCAO.ECD_J005@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_J100
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_J100
  for PRODUCAO.ECD_J100@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_J150
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_J150
  for PRODUCAO.ECD_J150@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_J210
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_J210
  for PRODUCAO.ECD_J210@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_J800
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_J800
  for PRODUCAO.ECD_J800@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_J900
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_J900
  for PRODUCAO.ECD_J900@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_J930
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_J930
  for PRODUCAO.ECD_J930@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_J930_BKP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ECD_J930_BKP
  for PRODUCAO.ECD_J930_BKP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_J935
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_J935
  for PRODUCAO.ECD_J935@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_J990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ECD_J990
  for PRODUCAO.ECD_J990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_LANCAMENTO_CONTABIL
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.ECD_LANCAMENTO_CONTABIL
  for PRODUCAO.ECD_LANCAMENTO_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_LIVRO_AUXILIAR
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ECD_LIVRO_AUXILIAR
  for PRODUCAO.ECD_LIVRO_AUXILIAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_PARTIDAS_LANCTO_CONTABIL
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.ECD_PARTIDAS_LANCTO_CONTABIL
  for PRODUCAO.ECD_PARTIDAS_LANCTO_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_SIGNATARIO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.ECD_SIGNATARIO
  for PRODUCAO.ECD_SIGNATARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECD_VALOR_DEMONSTRATIVOS
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.ECD_VALOR_DEMONSTRATIVOS
  for PRODUCAO.ECD_VALOR_DEMONSTRATIVOS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ECF_PARAMETROS_EMPRESA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ECF_PARAMETROS_EMPRESA
  for PRODUCAO.ECF_PARAMETROS_EMPRESA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EDIFACT_COMPON
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.EDIFACT_COMPON
  for EMS5.EDIFACT_COMPON;

prompt
prompt Creating synonym EDIFACT_ELEMENT
prompt ================================
prompt
create or replace synonym EMS506UNICOO.EDIFACT_ELEMENT
  for EMS5.EDIFACT_ELEMENT;

prompt
prompt Creating synonym EDIFACT_ESTRUT_COMPON
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.EDIFACT_ESTRUT_COMPON
  for EMS5.EDIFACT_ESTRUT_COMPON;

prompt
prompt Creating synonym EDIFACT_ESTRUT_MSG
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.EDIFACT_ESTRUT_MSG
  for EMS5.EDIFACT_ESTRUT_MSG;

prompt
prompt Creating synonym EDIFACT_ESTRUT_SEGMENT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.EDIFACT_ESTRUT_SEGMENT
  for EMS5.EDIFACT_ESTRUT_SEGMENT;

prompt
prompt Creating synonym EDIFACT_MSG_PADR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.EDIFACT_MSG_PADR
  for EMS5.EDIFACT_MSG_PADR;

prompt
prompt Creating synonym EDIFACT_SEGMENT
prompt ================================
prompt
create or replace synonym EMS506UNICOO.EDIFACT_SEGMENT
  for EMS5.EDIFACT_SEGMENT;

prompt
prompt Creating synonym EDIFACT_VERS_DIC
prompt =================================
prompt
create or replace synonym EMS506UNICOO.EDIFACT_VERS_DIC
  for EMS5.EDIFACT_VERS_DIC;

prompt
prompt Creating synonym EDIFACTQUALIFICELEMENT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.EDIFACTQUALIFICELEMENT
  for EMS5.EDIFACTQUALIFICELEMENT;

prompt
prompt Creating synonym EFD_0000
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0000
  for PRODUCAO.EFD_0000@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0001
  for PRODUCAO.EFD_0001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0005
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0005
  for PRODUCAO.EFD_0005@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0015
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0015
  for PRODUCAO.EFD_0015@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0100
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0100
  for PRODUCAO.EFD_0100@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0110
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0110
  for PRODUCAO.EFD_0110@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0111
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0111
  for PRODUCAO.EFD_0111@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0120
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0120
  for PRODUCAO.EFD_0120@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0140
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0140
  for PRODUCAO.EFD_0140@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0150
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0150
  for PRODUCAO.EFD_0150@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0190
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0190
  for PRODUCAO.EFD_0190@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0200
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0200
  for PRODUCAO.EFD_0200@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0220
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0220
  for PRODUCAO.EFD_0220@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0400
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0400
  for PRODUCAO.EFD_0400@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0450
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0450
  for PRODUCAO.EFD_0450@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0460
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0460
  for PRODUCAO.EFD_0460@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0500
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0500
  for PRODUCAO.EFD_0500@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0600
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0600
  for PRODUCAO.EFD_0600@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_0990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_0990
  for PRODUCAO.EFD_0990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1001
  for PRODUCAO.EFD_1001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1010
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1010
  for PRODUCAO.EFD_1010@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1100
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1100
  for PRODUCAO.EFD_1100@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1101
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1101
  for PRODUCAO.EFD_1101@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1102
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1102
  for PRODUCAO.EFD_1102@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1200
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1200
  for PRODUCAO.EFD_1200@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1210
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1210
  for PRODUCAO.EFD_1210@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1220
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1220
  for PRODUCAO.EFD_1220@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1300
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1300
  for PRODUCAO.EFD_1300@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1500
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1500
  for PRODUCAO.EFD_1500@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1501
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1501
  for PRODUCAO.EFD_1501@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1502
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1502
  for PRODUCAO.EFD_1502@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1600
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1600
  for PRODUCAO.EFD_1600@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1610
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1610
  for PRODUCAO.EFD_1610@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1620
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1620
  for PRODUCAO.EFD_1620@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1700
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1700
  for PRODUCAO.EFD_1700@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1710
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1710
  for PRODUCAO.EFD_1710@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_1990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_1990
  for PRODUCAO.EFD_1990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_9001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_9001
  for PRODUCAO.EFD_9001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_9900
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_9900
  for PRODUCAO.EFD_9900@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_9990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_9990
  for PRODUCAO.EFD_9990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_A001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_A001
  for PRODUCAO.EFD_A001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_A010
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_A010
  for PRODUCAO.EFD_A010@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_A100
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_A100
  for PRODUCAO.EFD_A100@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_A170
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_A170
  for PRODUCAO.EFD_A170@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_A990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_A990
  for PRODUCAO.EFD_A990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C001
  for PRODUCAO.EFD_C001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C010
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C010
  for PRODUCAO.EFD_C010@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C100
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C100
  for PRODUCAO.EFD_C100@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C110
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C110
  for PRODUCAO.EFD_C110@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C111
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C111
  for PRODUCAO.EFD_C111@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C112
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C112
  for PRODUCAO.EFD_C112@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C113
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C113
  for PRODUCAO.EFD_C113@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C114
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C114
  for PRODUCAO.EFD_C114@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C140
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C140
  for PRODUCAO.EFD_C140@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C141
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C141
  for PRODUCAO.EFD_C141@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C160
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C160
  for PRODUCAO.EFD_C160@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C170
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C170
  for PRODUCAO.EFD_C170@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C173
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C173
  for PRODUCAO.EFD_C173@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C180
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C180
  for PRODUCAO.EFD_C180@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C181
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C181
  for PRODUCAO.EFD_C181@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C185
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C185
  for PRODUCAO.EFD_C185@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C188
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C188
  for PRODUCAO.EFD_C188@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C190
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C190
  for PRODUCAO.EFD_C190@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C191
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C191
  for PRODUCAO.EFD_C191@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C195
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C195
  for PRODUCAO.EFD_C195@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C197
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C197
  for PRODUCAO.EFD_C197@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C198
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C198
  for PRODUCAO.EFD_C198@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C199
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C199
  for PRODUCAO.EFD_C199@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C300
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C300
  for PRODUCAO.EFD_C300@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C320
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C320
  for PRODUCAO.EFD_C320@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C321
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C321
  for PRODUCAO.EFD_C321@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C380
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C380
  for PRODUCAO.EFD_C380@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C381
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C381
  for PRODUCAO.EFD_C381@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C385
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C385
  for PRODUCAO.EFD_C385@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C395
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C395
  for PRODUCAO.EFD_C395@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C396
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C396
  for PRODUCAO.EFD_C396@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C400
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C400
  for PRODUCAO.EFD_C400@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C405
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C405
  for PRODUCAO.EFD_C405@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C410
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C410
  for PRODUCAO.EFD_C410@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C420
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C420
  for PRODUCAO.EFD_C420@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C425
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C425
  for PRODUCAO.EFD_C425@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C460
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C460
  for PRODUCAO.EFD_C460@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C470
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C470
  for PRODUCAO.EFD_C470@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C481
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C481
  for PRODUCAO.EFD_C481@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C485
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C485
  for PRODUCAO.EFD_C485@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C489
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C489
  for PRODUCAO.EFD_C489@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C490
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C490
  for PRODUCAO.EFD_C490@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C491
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C491
  for PRODUCAO.EFD_C491@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C495
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C495
  for PRODUCAO.EFD_C495@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C499
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C499
  for PRODUCAO.EFD_C499@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C500
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C500
  for PRODUCAO.EFD_C500@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C501
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C501
  for PRODUCAO.EFD_C501@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C505
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C505
  for PRODUCAO.EFD_C505@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C509
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C509
  for PRODUCAO.EFD_C509@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C590
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C590
  for PRODUCAO.EFD_C590@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C600
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C600
  for PRODUCAO.EFD_C600@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C601
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C601
  for PRODUCAO.EFD_C601@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C605
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C605
  for PRODUCAO.EFD_C605@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C609
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C609
  for PRODUCAO.EFD_C609@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_C990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_C990
  for PRODUCAO.EFD_C990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_CODIFICACAO_RDE_BLOCO_I
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.EFD_CODIFICACAO_RDE_BLOCO_I
  for PRODUCAO.EFD_CODIFICACAO_RDE_BLOCO_I@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_D001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_D001
  for PRODUCAO.EFD_D001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_D010
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_D010
  for PRODUCAO.EFD_D010@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_D100
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_D100
  for PRODUCAO.EFD_D100@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_D101
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_D101
  for PRODUCAO.EFD_D101@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_D105
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_D105
  for PRODUCAO.EFD_D105@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_D111
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_D111
  for PRODUCAO.EFD_D111@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_D160
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_D160
  for PRODUCAO.EFD_D160@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_D190
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_D190
  for PRODUCAO.EFD_D190@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_D500
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_D500
  for PRODUCAO.EFD_D500@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_D590
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_D590
  for PRODUCAO.EFD_D590@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_D609
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_D609
  for PRODUCAO.EFD_D609@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_D990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_D990
  for PRODUCAO.EFD_D990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E001
  for PRODUCAO.EFD_E001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E100
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E100
  for PRODUCAO.EFD_E100@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E110
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E110
  for PRODUCAO.EFD_E110@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E111
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E111
  for PRODUCAO.EFD_E111@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E112
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E112
  for PRODUCAO.EFD_E112@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E113
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E113
  for PRODUCAO.EFD_E113@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E115
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E115
  for PRODUCAO.EFD_E115@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E116
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E116
  for PRODUCAO.EFD_E116@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E200
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E200
  for PRODUCAO.EFD_E200@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E210
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E210
  for PRODUCAO.EFD_E210@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E220
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E220
  for PRODUCAO.EFD_E220@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E230
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E230
  for PRODUCAO.EFD_E230@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E240
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E240
  for PRODUCAO.EFD_E240@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E250
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E250
  for PRODUCAO.EFD_E250@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_E990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_E990
  for PRODUCAO.EFD_E990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F001
  for PRODUCAO.EFD_F001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F010
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F010
  for PRODUCAO.EFD_F010@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F100
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F100
  for PRODUCAO.EFD_F100@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F111
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F111
  for PRODUCAO.EFD_F111@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F120
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F120
  for PRODUCAO.EFD_F120@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F129
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F129
  for PRODUCAO.EFD_F129@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F130
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F130
  for PRODUCAO.EFD_F130@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F139
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F139
  for PRODUCAO.EFD_F139@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F150
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F150
  for PRODUCAO.EFD_F150@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F200
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F200
  for PRODUCAO.EFD_F200@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F205
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F205
  for PRODUCAO.EFD_F205@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F210
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F210
  for PRODUCAO.EFD_F210@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F211
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F211
  for PRODUCAO.EFD_F211@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F600
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F600
  for PRODUCAO.EFD_F600@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F700
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F700
  for PRODUCAO.EFD_F700@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F800
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F800
  for PRODUCAO.EFD_F800@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_F990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_F990
  for PRODUCAO.EFD_F990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_G001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_G001
  for PRODUCAO.EFD_G001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_G990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_G990
  for PRODUCAO.EFD_G990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_GERACAO_SPED_FISCAL
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.EFD_GERACAO_SPED_FISCAL
  for PRODUCAO.EFD_GERACAO_SPED_FISCAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_H001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_H001
  for PRODUCAO.EFD_H001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_H005
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_H005
  for PRODUCAO.EFD_H005@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_H010
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_H010
  for PRODUCAO.EFD_H010@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_H990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_H990
  for PRODUCAO.EFD_H990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_I001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_I001
  for PRODUCAO.EFD_I001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_I010
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_I010
  for PRODUCAO.EFD_I010@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_I100
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_I100
  for PRODUCAO.EFD_I100@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_I200
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_I200
  for PRODUCAO.EFD_I200@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_I299
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_I299
  for PRODUCAO.EFD_I299@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_I300
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_I300
  for PRODUCAO.EFD_I300@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_I399
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_I399
  for PRODUCAO.EFD_I399@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_I990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_I990
  for PRODUCAO.EFD_I990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M001
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M001
  for PRODUCAO.EFD_M001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M100
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M100
  for PRODUCAO.EFD_M100@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M100_TEMP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.EFD_M100_TEMP
  for PRODUCAO.EFD_M100_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M105
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M105
  for PRODUCAO.EFD_M105@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M105_TEMP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.EFD_M105_TEMP
  for PRODUCAO.EFD_M105_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M110
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M110
  for PRODUCAO.EFD_M110@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M110_TEMP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.EFD_M110_TEMP
  for PRODUCAO.EFD_M110_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M200
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M200
  for PRODUCAO.EFD_M200@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M210
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M210
  for PRODUCAO.EFD_M210@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M211
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M211
  for PRODUCAO.EFD_M211@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M220
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M220
  for PRODUCAO.EFD_M220@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M230
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M230
  for PRODUCAO.EFD_M230@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M300
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M300
  for PRODUCAO.EFD_M300@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M350
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M350
  for PRODUCAO.EFD_M350@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M400
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M400
  for PRODUCAO.EFD_M400@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M410
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M410
  for PRODUCAO.EFD_M410@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M500
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M500
  for PRODUCAO.EFD_M500@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M500_TEMP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.EFD_M500_TEMP
  for PRODUCAO.EFD_M500_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M505
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M505
  for PRODUCAO.EFD_M505@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M505_TEMP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.EFD_M505_TEMP
  for PRODUCAO.EFD_M505_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M510
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M510
  for PRODUCAO.EFD_M510@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M510_TEMP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.EFD_M510_TEMP
  for PRODUCAO.EFD_M510_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M600
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M600
  for PRODUCAO.EFD_M600@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M610
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M610
  for PRODUCAO.EFD_M610@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M611
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M611
  for PRODUCAO.EFD_M611@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M620
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M620
  for PRODUCAO.EFD_M620@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M630
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M630
  for PRODUCAO.EFD_M630@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M700
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M700
  for PRODUCAO.EFD_M700@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M800
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M800
  for PRODUCAO.EFD_M800@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M810
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M810
  for PRODUCAO.EFD_M810@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EFD_M990
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EFD_M990
  for PRODUCAO.EFD_M990@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ELEMENT_EDI
prompt ============================
prompt
create or replace synonym EMS506UNICOO.ELEMENT_EDI
  for EMS5.ELEMENT_EDI;

prompt
prompt Creating synonym EMBALAGEM_MATERIAL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.EMBALAGEM_MATERIAL
  for PRODUCAO.EMBALAGEM_MATERIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EMISS_CHEQUE_CONSULTA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.EMISS_CHEQUE_CONSULTA
  for PRODUCAO.EMISS_CHEQUE_CONSULTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EMISSAO_GUIA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.EMISSAO_GUIA
  for PRODUCAO.EMISSAO_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EMISSAO_GUIA_ANT2009
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.EMISSAO_GUIA_ANT2009
  for PRODUCAO.EMISSAO_GUIA_ANT2009@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EMISSAO_GUIA_CARTAO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.EMISSAO_GUIA_CARTAO
  for PRODUCAO.EMISSAO_GUIA_CARTAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EMISSAO_SERVICO_GUIA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.EMISSAO_SERVICO_GUIA
  for PRODUCAO.EMISSAO_SERVICO_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EMISSAO_SERVICO_GUIA_ANT2009
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.EMISSAO_SERVICO_GUIA_ANT2009
  for PRODUCAO.EMISSAO_SERVICO_GUIA_ANT2009@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EMISSOR_SOLICIT_VIAGEM
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.EMISSOR_SOLICIT_VIAGEM
  for EMS5.EMISSOR_SOLICIT_VIAGEM;

prompt
prompt Creating synonym EMPRES_CLAS_ACAOCAP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.EMPRES_CLAS_ACAOCAP
  for EMS5.EMPRES_CLAS_ACAOCAP;

prompt
prompt Creating synonym EMPRES_PARCEI_SPC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.EMPRES_PARCEI_SPC
  for EMS5.EMPRES_PARCEI_SPC;

prompt
prompt Creating synonym EMPRESA
prompt ========================
prompt
create or replace synonym EMS506UNICOO.EMPRESA
  for EMS5.EMPRESA;

prompt
prompt Creating synonym EMPRESA_LIVRO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.EMPRESA_LIVRO
  for PRODUCAO.EMPRESA_LIVRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EMPRESA_VINCULO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.EMPRESA_VINCULO
  for PRODUCAO.EMPRESA_VINCULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EMPRESAS_UNIMED_FEDERACAO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.EMPRESAS_UNIMED_FEDERACAO
  for PRODUCAO.EMPRESAS_UNIMED_FEDERACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EMPRESPARCEITIPMOVTO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.EMPRESPARCEITIPMOVTO
  for EMS5.EMPRESPARCEITIPMOVTO;

prompt
prompt Creating synonym ENCERRAMENTO_GERENCIAL_TEMP
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.ENCERRAMENTO_GERENCIAL_TEMP
  for PRODUCAO.ENCERRAMENTO_GERENCIAL_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ENCONTRO_CONTAS_HEADER
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ENCONTRO_CONTAS_HEADER
  for PRODUCAO.ENCONTRO_CONTAS_HEADER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ENCONTRO_DE_CONTAS
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ENCONTRO_DE_CONTAS
  for PRODUCAO.ENCONTRO_DE_CONTAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ENCTRO_CTA
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.ENCTRO_CTA
  for EMS5.ENCTRO_CTA;

prompt
prompt Creating synonym ENDER_ENTREG
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ENDER_ENTREG
  for EMS5.ENDER_ENTREG;

prompt
prompt Creating synonym ENDERECO
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ENDERECO
  for PRODUCAO.ENDERECO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ENDERECO_ACREDITACAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ENDERECO_ACREDITACAO
  for PRODUCAO.ENDERECO_ACREDITACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ENDERECO_ESPECIALISTA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.ENDERECO_ESPECIALISTA
  for PRODUCAO.ENDERECO_ESPECIALISTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ENDERECO_PROPOSTA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ENDERECO_PROPOSTA
  for PRODUCAO.ENDERECO_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ENDERECO_UNIMED
prompt ================================
prompt
create or replace synonym EMS506UNICOO.ENDERECO_UNIMED
  for PRODUCAO.ENDERECO_UNIMED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ENTRADAS_PREVISTAS
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ENTRADAS_PREVISTAS
  for PRODUCAO.ENTRADAS_PREVISTAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ENVIO_TITULO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ENVIO_TITULO
  for PRODUCAO.ENVIO_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ENVIO_TITULO_PAGAR
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ENVIO_TITULO_PAGAR
  for PRODUCAO.ENVIO_TITULO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_CLI_COLLECT_BY_EVENTID
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.EPC_CLI_COLLECT_BY_EVENTID
  for PRODUCAO.EPC_CLI_COLLECT_BY_EVENTID@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_CLI_COLLECT_BY_USERID
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.EPC_CLI_COLLECT_BY_USERID
  for PRODUCAO.EPC_CLI_COLLECT_BY_USERID@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_CLI_COLLECTION
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.EPC_CLI_COLLECTION
  for PRODUCAO.EPC_CLI_COLLECTION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_CLI_ENVIRONMENT
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.EPC_CLI_ENVIRONMENT
  for PRODUCAO.EPC_CLI_ENVIRONMENT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_CLI_ENVIRONMENT_VERSION
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.EPC_CLI_ENVIRONMENT_VERSION
  for PRODUCAO.EPC_CLI_ENVIRONMENT_VERSION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_CLI_FDF_FILE
prompt =================================
prompt
create or replace synonym EMS506UNICOO.EPC_CLI_FDF_FILE
  for PRODUCAO.EPC_CLI_FDF_FILE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_CLI_FORMAT
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.EPC_CLI_FORMAT
  for PRODUCAO.EPC_CLI_FORMAT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_CLI_JOB
prompt ============================
prompt
create or replace synonym EMS506UNICOO.EPC_CLI_JOB
  for PRODUCAO.EPC_CLI_JOB@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_CLI_NODE
prompt =============================
prompt
create or replace synonym EMS506UNICOO.EPC_CLI_NODE
  for PRODUCAO.EPC_CLI_NODE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_CLI_PROGRESS
prompt =================================
prompt
create or replace synonym EMS506UNICOO.EPC_CLI_PROGRESS
  for PRODUCAO.EPC_CLI_PROGRESS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_CLI_REP_USERS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.EPC_CLI_REP_USERS
  for PRODUCAO.EPC_CLI_REP_USERS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_CLI_SERVICE
prompt ================================
prompt
create or replace synonym EMS506UNICOO.EPC_CLI_SERVICE
  for PRODUCAO.EPC_CLI_SERVICE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_CLI_USAGE
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.EPC_CLI_USAGE
  for PRODUCAO.EPC_CLI_USAGE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_CLI_VERSION
prompt ================================
prompt
create or replace synonym EMS506UNICOO.EPC_CLI_VERSION
  for PRODUCAO.EPC_CLI_VERSION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_MULTI_VIEW_MAP
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.EPC_MULTI_VIEW_MAP
  for PRODUCAO.EPC_MULTI_VIEW_MAP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_MULTI_VIEWS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.EPC_MULTI_VIEWS
  for PRODUCAO.EPC_MULTI_VIEWS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_MVIEW_CATEGORY_MAP
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.EPC_MVIEW_CATEGORY_MAP
  for PRODUCAO.EPC_MVIEW_CATEGORY_MAP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_PRIMARY_ITEMS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.EPC_PRIMARY_ITEMS
  for PRODUCAO.EPC_PRIMARY_ITEMS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_TDV_VERSION
prompt ================================
prompt
create or replace synonym EMS506UNICOO.EPC_TDV_VERSION
  for PRODUCAO.EPC_TDV_VERSION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_VIEW
prompt =========================
prompt
create or replace synonym EMS506UNICOO.EPC_VIEW
  for PRODUCAO.EPC_VIEW@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_VIEW_CATEGORY
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.EPC_VIEW_CATEGORY
  for PRODUCAO.EPC_VIEW_CATEGORY@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_VIEW_ITEMS
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.EPC_VIEW_ITEMS
  for PRODUCAO.EPC_VIEW_ITEMS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EPC_VIEW_PREFERENCES
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.EPC_VIEW_PREFERENCES
  for PRODUCAO.EPC_VIEW_PREFERENCES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EQUALIZ_OPERAC_FINANC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.EQUALIZ_OPERAC_FINANC
  for EMS5.EQUALIZ_OPERAC_FINANC;

prompt
prompt Creating synonym ERRO
prompt =====================
prompt
create or replace synonym EMS506UNICOO.ERRO
  for PRODUCAO.ERRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ERRO_CRITERIOS
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.ERRO_CRITERIOS
  for PRODUCAO.ERRO_CRITERIOS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESCALA_RECPERICIA_DET
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.ESCALA_RECPERICIA_DET
  for PRODUCAO.ESCALA_RECPERICIA_DET@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESCALA_RECURSO_AG_COMERCIAL
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.ESCALA_RECURSO_AG_COMERCIAL
  for PRODUCAO.ESCALA_RECURSO_AG_COMERCIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESCALA_RECURSO_PERICIA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ESCALA_RECURSO_PERICIA
  for PRODUCAO.ESCALA_RECURSO_PERICIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESPEC_ADMDRA_CARTAO_CR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ESPEC_ADMDRA_CARTAO_CR
  for EMS5.ESPEC_ADMDRA_CARTAO_CR;

prompt
prompt Creating synonym ESPEC_BCO
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.ESPEC_BCO
  for EMS5.ESPEC_BCO;

prompt
prompt Creating synonym ESPEC_BEM
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.ESPEC_BEM
  for EMS5.ESPEC_BEM;

prompt
prompt Creating synonym ESPEC_CONCES_TELEF
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ESPEC_CONCES_TELEF
  for EMS5.ESPEC_CONCES_TELEF;

prompt
prompt Creating synonym ESPEC_DOCTO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.ESPEC_DOCTO
  for EMS5.ESPEC_DOCTO;

prompt
prompt Creating synonym ESPEC_DOCTO_FINANC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ESPEC_DOCTO_FINANC
  for EMS5.ESPEC_DOCTO_FINANC;

prompt
prompt Creating synonym ESPEC_DOCTO_FINANC_ACR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ESPEC_DOCTO_FINANC_ACR
  for EMS5.ESPEC_DOCTO_FINANC_ACR;

prompt
prompt Creating synonym ESPEC_MANUAL
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ESPEC_MANUAL
  for EMS5.ESPEC_MANUAL;

prompt
prompt Creating synonym ESPEC_MANUAL_ESTIL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ESPEC_MANUAL_ESTIL
  for EMS5.ESPEC_MANUAL_ESTIL;

prompt
prompt Creating synonym ESPEC_MANUAL_IDIOM
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ESPEC_MANUAL_IDIOM
  for EMS5.ESPEC_MANUAL_IDIOM;

prompt
prompt Creating synonym ESPEC_VDR_DB
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ESPEC_VDR_DB
  for EMS5.ESPEC_VDR_DB;

prompt
prompt Creating synonym ESPECIALIDADE
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.ESPECIALIDADE
  for PRODUCAO.ESPECIALIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESPECIALIDADE_CONTR_PES
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.ESPECIALIDADE_CONTR_PES
  for PRODUCAO.ESPECIALIDADE_CONTR_PES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESPECIALIDADE_DOENCA_TRATAMENT
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.ESPECIALIDADE_DOENCA_TRATAMENT
  for PRODUCAO.ESPECIALIDADE_DOENCA_TRATAMENT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESPECIALIDADE_GRUPO_TRATAMENTO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.ESPECIALIDADE_GRUPO_TRATAMENTO
  for PRODUCAO.ESPECIALIDADE_GRUPO_TRATAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESPECIALIDADE_PTU
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ESPECIALIDADE_PTU
  for PRODUCAO.ESPECIALIDADE_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESPECIALISTA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ESPECIALISTA
  for PRODUCAO.ESPECIALISTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESPECIF_TEC
prompt ============================
prompt
create or replace synonym EMS506UNICOO.ESPECIF_TEC
  for EMS5.ESPECIF_TEC;

prompt
prompt Creating synonym ESPECREGRAPERDADEDUT
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ESPECREGRAPERDADEDUT
  for EMS5.ESPECREGRAPERDADEDUT;

prompt
prompt Creating synonym ESQUEMA
prompt ========================
prompt
create or replace synonym EMS506UNICOO.ESQUEMA
  for PRODUCAO.ESQUEMA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESQUEMA_CONTABIL_CAIXA_BANCOS
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.ESQUEMA_CONTABIL_CAIXA_BANCOS
  for PRODUCAO.ESQUEMA_CONTABIL_CAIXA_BANCOS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESQUEMA_CONTABIL_FATURAMENTO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.ESQUEMA_CONTABIL_FATURAMENTO
  for PRODUCAO.ESQUEMA_CONTABIL_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESQUEMA_CONTABIL_INTERCAMBIO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.ESQUEMA_CONTABIL_INTERCAMBIO
  for PRODUCAO.ESQUEMA_CONTABIL_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESQUEMA_CONTABIL_ITENS_PROD
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.ESQUEMA_CONTABIL_ITENS_PROD
  for PRODUCAO.ESQUEMA_CONTABIL_ITENS_PROD@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESQUEMA_CONTABIL_PAGAR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ESQUEMA_CONTABIL_PAGAR
  for PRODUCAO.ESQUEMA_CONTABIL_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESQUEMA_CONTABIL_PAGPREST
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.ESQUEMA_CONTABIL_PAGPREST
  for PRODUCAO.ESQUEMA_CONTABIL_PAGPREST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESQUEMA_CONTABIL_PROD_MEDICA
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.ESQUEMA_CONTABIL_PROD_MEDICA
  for PRODUCAO.ESQUEMA_CONTABIL_PROD_MEDICA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESQUEMA_CONTABIL_RECEBER
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.ESQUEMA_CONTABIL_RECEBER
  for PRODUCAO.ESQUEMA_CONTABIL_RECEBER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESQUEMA_LANCAMENTO_SPED
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.ESQUEMA_LANCAMENTO_SPED
  for PRODUCAO.ESQUEMA_LANCAMENTO_SPED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESQUEMA_PAGAMENTO_PAGAR
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.ESQUEMA_PAGAMENTO_PAGAR
  for PRODUCAO.ESQUEMA_PAGAMENTO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESQUEMA_PAGAR
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.ESQUEMA_PAGAR
  for PRODUCAO.ESQUEMA_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESQUEMA_PAGPREST
prompt =================================
prompt
create or replace synonym EMS506UNICOO.ESQUEMA_PAGPREST
  for PRODUCAO.ESQUEMA_PAGPREST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESQUEMA_RECEBER
prompt ================================
prompt
create or replace synonym EMS506UNICOO.ESQUEMA_RECEBER
  for PRODUCAO.ESQUEMA_RECEBER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESTAB_PROCES_ESOC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ESTAB_PROCES_ESOC
  for EMS5.ESTAB_PROCES_ESOC;

prompt
prompt Creating synonym ESTAB_UNID_NEGOC
prompt =================================
prompt
create or replace synonym EMS506UNICOO.ESTAB_UNID_NEGOC
  for EMS5.ESTAB_UNID_NEGOC;

prompt
prompt Creating synonym ESTABELECIMENTO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.ESTABELECIMENTO
  for EMS5.ESTABELECIMENTO;

prompt
prompt Creating synonym ESTADO
prompt =======================
prompt
create or replace synonym EMS506UNICOO.ESTADO
  for PRODUCAO.ESTADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESTADO_CIVIL
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ESTADO_CIVIL
  for PRODUCAO.ESTADO_CIVIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESTADO_CIVIL_FEDERACAO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ESTADO_CIVIL_FEDERACAO
  for PRODUCAO.ESTADO_CIVIL_FEDERACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ESTADO_FISIC
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ESTADO_FISIC
  for EMS5.ESTADO_FISIC;

prompt
prompt Creating synonym ESTATIS_CLIEN
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.ESTATIS_CLIEN
  for EMS5.ESTATIS_CLIEN;

prompt
prompt Creating synonym ESTIL_COMPON_DOCUMEN
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ESTIL_COMPON_DOCUMEN
  for EMS5.ESTIL_COMPON_DOCUMEN;

prompt
prompt Creating synonym ESTIL_IDIOM
prompt ============================
prompt
create or replace synonym EMS506UNICOO.ESTIL_IDIOM
  for EMS5.ESTIL_IDIOM;

prompt
prompt Creating synonym ESTILO
prompt =======================
prompt
create or replace synonym EMS506UNICOO.ESTILO
  for EMS5.ESTILO;

prompt
prompt Creating synonym ESTORN_COBR_ESPECIAL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ESTORN_COBR_ESPECIAL
  for EMS5.ESTORN_COBR_ESPECIAL;

prompt
prompt Creating synonym ESTRUT_CCUSTO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_CCUSTO
  for EMS5.ESTRUT_CCUSTO;

prompt
prompt Creating synonym ESTRUT_CLIEN
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_CLIEN
  for EMS5.ESTRUT_CLIEN;

prompt
prompt Creating synonym ESTRUT_CTA_CTBL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_CTA_CTBL
  for EMS5.ESTRUT_CTA_CTBL;

prompt
prompt Creating synonym ESTRUT_CTBL_MOVTO_SINT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_CTBL_MOVTO_SINT
  for EMS5.ESTRUT_CTBL_MOVTO_SINT;

prompt
prompt Creating synonym ESTRUT_DEMONST_CTBL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_DEMONST_CTBL
  for EMS5.ESTRUT_DEMONST_CTBL;

prompt
prompt Creating synonym ESTRUT_FORNEC
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_FORNEC
  for EMS5.ESTRUT_FORNEC;

prompt
prompt Creating synonym ESTRUT_HIER_PAT
prompt ================================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_HIER_PAT
  for EMS5.ESTRUT_HIER_PAT;

prompt
prompt Creating synonym ESTRUT_PROJ_FINANC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_PROJ_FINANC
  for EMS5.ESTRUT_PROJ_FINANC;

prompt
prompt Creating synonym ESTRUT_REPRES
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_REPRES
  for EMS5.ESTRUT_REPRES;

prompt
prompt Creating synonym ESTRUT_UNID_APROV
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_UNID_APROV
  for EMS5.ESTRUT_UNID_APROV;

prompt
prompt Creating synonym ESTRUT_UNID_CONTROL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_UNID_CONTROL
  for EMS5.ESTRUT_UNID_CONTROL;

prompt
prompt Creating synonym ESTRUT_UNID_NEGOC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_UNID_NEGOC
  for EMS5.ESTRUT_UNID_NEGOC;

prompt
prompt Creating synonym ESTRUT_UNID_ORCTARIA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_UNID_ORCTARIA
  for EMS5.ESTRUT_UNID_ORCTARIA;

prompt
prompt Creating synonym ESTRUT_UNID_ORGAN
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_UNID_ORGAN
  for EMS5.ESTRUT_UNID_ORGAN;

prompt
prompt Creating synonym ESTRUT_VISUALIZ_CTBL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ESTRUT_VISUALIZ_CTBL
  for EMS5.ESTRUT_VISUALIZ_CTBL;

prompt
prompt Creating synonym ESTRUTCTBLMOVTOANALIT
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.ESTRUTCTBLMOVTOANALIT
  for EMS5.ESTRUTCTBLMOVTOANALIT;

prompt
prompt Creating synonym ESTRUTTIPFLUXOFINANC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ESTRUTTIPFLUXOFINANC
  for EMS5.ESTRUTTIPFLUXOFINANC;

prompt
prompt Creating synonym ETAP_PROCES_EDI
prompt ================================
prompt
create or replace synonym EMS506UNICOO.ETAP_PROCES_EDI
  for EMS5.ETAP_PROCES_EDI;

prompt
prompt Creating synonym ETIQUETA_ESCOLHA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.ETIQUETA_ESCOLHA
  for PRODUCAO.ETIQUETA_ESCOLHA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EVENT_MODUL_DTSUL
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.EVENT_MODUL_DTSUL
  for EMS5.EVENT_MODUL_DTSUL;

prompt
prompt Creating synonym EVENTO_CUSTO_ADMINISTRATIVO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.EVENTO_CUSTO_ADMINISTRATIVO
  for PRODUCAO.EVENTO_CUSTO_ADMINISTRATIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EVENTO_DA_BASE
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.EVENTO_DA_BASE
  for PRODUCAO.EVENTO_DA_BASE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EVENTO_DE_FATURAMENTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.EVENTO_DE_FATURAMENTO
  for PRODUCAO.EVENTO_DE_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EVENTO_GUIA
prompt ============================
prompt
create or replace synonym EMS506UNICOO.EVENTO_GUIA
  for PRODUCAO.EVENTO_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EVENTO_PRESTADOR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.EVENTO_PRESTADOR
  for PRODUCAO.EVENTO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EVENTO_PRESTADOR_27_04
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.EVENTO_PRESTADOR_27_04
  for PRODUCAO.EVENTO_PRESTADOR_27_04@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EVENTO_USUARIO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.EVENTO_USUARIO
  for PRODUCAO.EVENTO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EVENTO_VALOR_ACESSORIOS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.EVENTO_VALOR_ACESSORIOS
  for PRODUCAO.EVENTO_VALOR_ACESSORIOS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EVENTO_VALOR_PROPOSTA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.EVENTO_VALOR_PROPOSTA
  for PRODUCAO.EVENTO_VALOR_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EXAME_POR_TIPO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.EXAME_POR_TIPO
  for PRODUCAO.EXAME_POR_TIPO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EXC_CALC_VAR_CCUSTO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.EXC_CALC_VAR_CCUSTO
  for EMS5.EXC_CALC_VAR_CCUSTO;

prompt
prompt Creating synonym EXC_CALC_VAR_CTA_CTBL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.EXC_CALC_VAR_CTA_CTBL
  for EMS5.EXC_CALC_VAR_CTA_CTBL;

prompt
prompt Creating synonym EXC_JUSTIF_GRP_CCUSTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.EXC_JUSTIF_GRP_CCUSTO
  for EMS5.EXC_JUSTIF_GRP_CCUSTO;

prompt
prompt Creating synonym EXECUCAO_SERVICO_GUIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.EXECUCAO_SERVICO_GUIA
  for PRODUCAO.EXECUCAO_SERVICO_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EXERC_CTBL
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.EXERC_CTBL
  for EMS5.EXERC_CTBL;

prompt
prompt Creating synonym EXP_GUIA_CONTROLE
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.EXP_GUIA_CONTROLE
  for PRODUCAO.EXP_GUIA_CONTROLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EXP_GUIA_LOTE
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.EXP_GUIA_LOTE
  for PRODUCAO.EXP_GUIA_LOTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EXP_GUIA_SERVICO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.EXP_GUIA_SERVICO
  for PRODUCAO.EXP_GUIA_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EXPURGOS_PARCIAIS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.EXPURGOS_PARCIAIS
  for PRODUCAO.EXPURGOS_PARCIAIS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym EXT_PROCES_PAGTO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.EXT_PROCES_PAGTO
  for EMS5.EXT_PROCES_PAGTO;

prompt
prompt Creating synonym EXT_RELACTO_CTBL
prompt =================================
prompt
create or replace synonym EMS506UNICOO.EXT_RELACTO_CTBL
  for EMS5.EXT_RELACTO_CTBL;

prompt
prompt Creating synonym EXTNAM_APROP_CTBL_ACR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_APROP_CTBL_ACR
  for EMS5.EXTNAM_APROP_CTBL_ACR;

prompt
prompt Creating synonym EXTNAM_APROP_CTBL_AP
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_APROP_CTBL_AP
  for EMS5.EXTNAM_APROP_CTBL_AP;

prompt
prompt Creating synonym EXTNAM_CONTAT
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_CONTAT
  for EMS5.EXTNAM_CONTAT;

prompt
prompt Creating synonym EXTNAM_EMPRES
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_EMPRES
  for EMS5.EXTNAM_EMPRES;

prompt
prompt Creating synonym EXTNAM_FORNEC_FINANC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_FORNEC_FINANC
  for EMS5.EXTNAM_FORNEC_FINANC;

prompt
prompt Creating synonym EXTNAM_IMPTO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_IMPTO
  for EMS5.EXTNAM_IMPTO;

prompt
prompt Creating synonym EXTNAM_IMPTO_IVA_ACR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_IMPTO_IVA_ACR
  for EMS5.EXTNAM_IMPTO_IVA_ACR;

prompt
prompt Creating synonym EXTNAM_IMPTO_IVA_AP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_IMPTO_IVA_AP
  for EMS5.EXTNAM_IMPTO_IVA_AP;

prompt
prompt Creating synonym EXTNAM_IMPTO_PEND_ACR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_IMPTO_PEND_ACR
  for EMS5.EXTNAM_IMPTO_PEND_ACR;

prompt
prompt Creating synonym EXTNAM_IMPTO_PEND_AP
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_IMPTO_PEND_AP
  for EMS5.EXTNAM_IMPTO_PEND_AP;

prompt
prompt Creating synonym EXTNAM_ITEM_BORD_AP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_ITEM_BORD_AP
  for EMS5.EXTNAM_ITEM_BORD_AP;

prompt
prompt Creating synonym EXTNAM_ITEM_IMPL_ACR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_ITEM_IMPL_ACR
  for EMS5.EXTNAM_ITEM_IMPL_ACR;

prompt
prompt Creating synonym EXTNAM_ITEM_LOTE_PAGTO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_ITEM_LOTE_PAGTO
  for EMS5.EXTNAM_ITEM_LOTE_PAGTO;

prompt
prompt Creating synonym EXTNAM_MOVTO_TIT_AP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_MOVTO_TIT_AP
  for EMS5.EXTNAM_MOVTO_TIT_AP;

prompt
prompt Creating synonym EXTNAM_PESSOA_FISIC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_PESSOA_FISIC
  for EMS5.EXTNAM_PESSOA_FISIC;

prompt
prompt Creating synonym EXTNAM_PESSOA_JURID
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_PESSOA_JURID
  for EMS5.EXTNAM_PESSOA_JURID;

prompt
prompt Creating synonym EXTNAM_TIT_AP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.EXTNAM_TIT_AP
  for EMS5.EXTNAM_TIT_AP;

prompt
prompt Creating synonym EXTNAMANTECIPPEFPEND
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.EXTNAMANTECIPPEFPEND
  for EMS5.EXTNAMANTECIPPEFPEND;

prompt
prompt Creating synonym EXTNAMITEMLOTEIMPLAP
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.EXTNAMITEMLOTEIMPLAP
  for EMS5.EXTNAMITEMLOTEIMPLAP;

prompt
prompt Creating synonym EXTRAT_CTA_CORREN
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.EXTRAT_CTA_CORREN
  for EMS5.EXTRAT_CTA_CORREN;

prompt
prompt Creating synonym F_A500_ACERTA_QTDE_SERVICO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.F_A500_ACERTA_QTDE_SERVICO
  for PRODUCAO.F_A500_ACERTA_QTDE_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_A500_TXSENHA_EXTERNA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_A500_TXSENHA_EXTERNA
  for PRODUCAO.F_A500_TXSENHA_EXTERNA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_ABREVIA_NOME
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.F_ABREVIA_NOME
  for PRODUCAO.F_ABREVIA_NOME@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_ACHA_DISTRIBUICAO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_ACHA_DISTRIBUICAO
  for PRODUCAO.F_ACHA_DISTRIBUICAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_AJUSTA_DATA
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.F_AJUSTA_DATA
  for PRODUCAO.F_AJUSTA_DATA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_APOSENTADO_DEMITIDO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.F_APOSENTADO_DEMITIDO
  for PRODUCAO.F_APOSENTADO_DEMITIDO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_AT
prompt =====================
prompt
create or replace synonym EMS506UNICOO.F_AT
  for PRODUCAO.F_AT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_AUT_FUNCIONARIO_PRESTADOR
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.F_AUT_FUNCIONARIO_PRESTADOR
  for PRODUCAO.F_AUT_FUNCIONARIO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_AUTORIZA_CONTA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.F_AUTORIZA_CONTA
  for PRODUCAO.F_AUTORIZA_CONTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_BUSCA_CO_PARTICIPACAO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_BUSCA_CO_PARTICIPACAO
  for PRODUCAO.F_BUSCA_CO_PARTICIPACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_BUSCA_GUIA_PRINCIPAL
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_BUSCA_GUIA_PRINCIPAL
  for PRODUCAO.F_BUSCA_GUIA_PRINCIPAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_BUSCA_SERVICO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_BUSCA_SERVICO
  for PRODUCAO.F_BUSCA_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_BUSCA_TAXA_ADMIN
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.F_BUSCA_TAXA_ADMIN
  for PRODUCAO.F_BUSCA_TAXA_ADMIN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CALC_COPARTIC_BALCAO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_CALC_COPARTIC_BALCAO
  for PRODUCAO.F_CALC_COPARTIC_BALCAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CALC_COPARTIC_BALCAO_CUSTOM
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.F_CALC_COPARTIC_BALCAO_CUSTOM
  for PRODUCAO.F_CALC_COPARTIC_BALCAO_CUSTOM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CALC_QT_CPT
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.F_CALC_QT_CPT
  for PRODUCAO.F_CALC_QT_CPT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CALC_SALDO_SERV_PERICIA
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.F_CALC_SALDO_SERV_PERICIA
  for PRODUCAO.F_CALC_SALDO_SERV_PERICIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CALC_VLSERVICO_COPARTIC
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.F_CALC_VLSERVICO_COPARTIC
  for PRODUCAO.F_CALC_VLSERVICO_COPARTIC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CALCULA_RENTABILIDADE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_CALCULA_RENTABILIDADE
  for PRODUCAO.F_CALCULA_RENTABILIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CALCULA_VALOR_AUTORIZ
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_CALCULA_VALOR_AUTORIZ
  for PRODUCAO.F_CALCULA_VALOR_AUTORIZ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CALCULA_VALOR_RECEBER
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_CALCULA_VALOR_RECEBER
  for PRODUCAO.F_CALCULA_VALOR_RECEBER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CANCELA_AUTORIZACAO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.F_CANCELA_AUTORIZACAO
  for PRODUCAO.F_CANCELA_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CANCELA_GUIA_SEM_SERVICO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.F_CANCELA_GUIA_SEM_SERVICO
  for PRODUCAO.F_CANCELA_GUIA_SEM_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CANCELA_REQUISICAO_REPETIDA
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.F_CANCELA_REQUISICAO_REPETIDA
  for PRODUCAO.F_CANCELA_REQUISICAO_REPETIDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CANCELA_SERVICO_AUTORIZACAO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.F_CANCELA_SERVICO_AUTORIZACAO
  for PRODUCAO.F_CANCELA_SERVICO_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CARENCIAS_ATUAIS
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.F_CARENCIAS_ATUAIS
  for PRODUCAO.F_CARENCIAS_ATUAIS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CARENCIAS_USUARIO_INTERC
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.F_CARENCIAS_USUARIO_INTERC
  for PRODUCAO.F_CARENCIAS_USUARIO_INTERC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CATEG_SERV_FAT_CUSTO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_CATEG_SERV_FAT_CUSTO
  for PRODUCAO.F_CATEG_SERV_FAT_CUSTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CDCATEGORIA_GFIP
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.F_CDCATEGORIA_GFIP
  for PRODUCAO.F_CDCATEGORIA_GFIP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CDIND_RECOLHIMENTO_GFIP
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.F_CDIND_RECOLHIMENTO_GFIP
  for PRODUCAO.F_CDIND_RECOLHIMENTO_GFIP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CDMODALIDADE_GFIP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_CDMODALIDADE_GFIP
  for PRODUCAO.F_CDMODALIDADE_GFIP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CDRECOLHIMENTO_GFIP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.F_CDRECOLHIMENTO_GFIP
  for PRODUCAO.F_CDRECOLHIMENTO_GFIP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CENTRALIZAR_TEXTO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_CENTRALIZAR_TEXTO
  for PRODUCAO.F_CENTRALIZAR_TEXTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_COB_PAC
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.F_COB_PAC
  for PRODUCAO.F_COB_PAC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_COBRANCA_EFETUADA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_COBRANCA_EFETUADA
  for PRODUCAO.F_COBRANCA_EFETUADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CODIGO_USUARIO_SIB
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.F_CODIGO_USUARIO_SIB
  for PRODUCAO.F_CODIGO_USUARIO_SIB@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_COMP_DATA
prompt ============================
prompt
create or replace synonym EMS506UNICOO.F_COMP_DATA
  for PRODUCAO.F_COMP_DATA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CONFIGURA_MASCARA_FATURA
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.F_CONFIGURA_MASCARA_FATURA
  for PRODUCAO.F_CONFIGURA_MASCARA_FATURA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CONSISTE_QTDE_SERV_PRE_AUT
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.F_CONSISTE_QTDE_SERV_PRE_AUT
  for PRODUCAO.F_CONSISTE_QTDE_SERV_PRE_AUT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CONSISTE_QTDE_SERV_REQ
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.F_CONSISTE_QTDE_SERV_REQ
  for PRODUCAO.F_CONSISTE_QTDE_SERV_REQ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CONTA_USUARIOS_IDADE
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_CONTA_USUARIOS_IDADE
  for PRODUCAO.F_CONTA_USUARIOS_IDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CONVERSAO_VALOR_EXP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.F_CONVERSAO_VALOR_EXP
  for PRODUCAO.F_CONVERSAO_VALOR_EXP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CRITERIOS_RESTRICAO_GUIAS
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.F_CRITERIOS_RESTRICAO_GUIAS
  for PRODUCAO.F_CRITERIOS_RESTRICAO_GUIAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_AOAJIUS
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.F_CST_AOAJIUS
  for PRODUCAO.F_CST_AOAJIUS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_BUSCA_CARENCIA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.F_CST_BUSCA_CARENCIA
  for PRODUCAO.F_CST_BUSCA_CARENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_BUSCA_EVENTO_IR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.F_CST_BUSCA_EVENTO_IR
  for PRODUCAO.F_CST_BUSCA_EVENTO_IR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_BUSCA_FATURA_INTERNA
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.F_CST_BUSCA_FATURA_INTERNA
  for PRODUCAO.F_CST_BUSCA_FATURA_INTERNA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_CALC_BASE_INSS_PRESTADOR
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.F_CST_CALC_BASE_INSS_PRESTADOR
  for PRODUCAO.F_CST_CALC_BASE_INSS_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_COTA_PRESTADOR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.F_CST_COTA_PRESTADOR
  for PRODUCAO.F_CST_COTA_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_DESCONTOS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_CST_DESCONTOS
  for PRODUCAO.F_CST_DESCONTOS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_DET_FAT_CO_REF_FAT
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.F_CST_DET_FAT_CO_REF_FAT
  for PRODUCAO.F_CST_DET_FAT_CO_REF_FAT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_DIAS_ISENCAO_CONTRATO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.F_CST_DIAS_ISENCAO_CONTRATO
  for PRODUCAO.F_CST_DIAS_ISENCAO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_EVENTO_CIDADE
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_CST_EVENTO_CIDADE
  for PRODUCAO.F_CST_EVENTO_CIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_EXCLUI_GUIA_PRINC
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_CST_EXCLUI_GUIA_PRINC
  for PRODUCAO.F_CST_EXCLUI_GUIA_PRINC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_IDADE_USUARIO_BCK_TOTVS
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.F_CST_IDADE_USUARIO_BCK_TOTVS
  for PRODUCAO.F_CST_IDADE_USUARIO_BCK_TOTVS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_LIBERA_MASSA_CONF_REPROC
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.F_CST_LIBERA_MASSA_CONF_REPROC
  for PRODUCAO.F_CST_LIBERA_MASSA_CONF_REPROC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_LIMITE_CARENCIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.F_CST_LIMITE_CARENCIA
  for PRODUCAO.F_CST_LIMITE_CARENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_MSG_BOL_BENEF
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_CST_MSG_BOL_BENEF
  for PRODUCAO.F_CST_MSG_BOL_BENEF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_MSG_REAJUSTE_ITAU
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_CST_MSG_REAJUSTE_ITAU
  for PRODUCAO.F_CST_MSG_REAJUSTE_ITAU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_PROC_USUARIO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.F_CST_PROC_USUARIO
  for PRODUCAO.F_CST_PROC_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_REEMBOLSO_PRESTADOR
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.F_CST_REEMBOLSO_PRESTADOR
  for PRODUCAO.F_CST_REEMBOLSO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_RETORNA_CATEGSUS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_CST_RETORNA_CATEGSUS
  for PRODUCAO.F_CST_RETORNA_CATEGSUS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_RETORNA_CODSUSEP
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_CST_RETORNA_CODSUSEP
  for PRODUCAO.F_CST_RETORNA_CODSUSEP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_RETORNA_CONT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.F_CST_RETORNA_CONT
  for PRODUCAO.F_CST_RETORNA_CONT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_RETORNA_EMPRESA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.F_CST_RETORNA_EMPRESA
  for PRODUCAO.F_CST_RETORNA_EMPRESA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_RETORNA_MENS_ITAU
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_CST_RETORNA_MENS_ITAU
  for PRODUCAO.F_CST_RETORNA_MENS_ITAU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_RETORNA_PESQ
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.F_CST_RETORNA_PESQ
  for PRODUCAO.F_CST_RETORNA_PESQ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_RETORNA_SEQ_CONTROLE
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.F_CST_RETORNA_SEQ_CONTROLE
  for PRODUCAO.F_CST_RETORNA_SEQ_CONTROLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_SERIE_NF
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.F_CST_SERIE_NF
  for PRODUCAO.F_CST_SERIE_NF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_SERVICO_PREST_EXCLUIDO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.F_CST_SERVICO_PREST_EXCLUIDO
  for PRODUCAO.F_CST_SERVICO_PREST_EXCLUIDO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_UNIMED_REPASSADO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_CST_UNIMED_REPASSADO
  for PRODUCAO.F_CST_UNIMED_REPASSADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_VERIF_GRUPO_PRESTADORES
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.F_CST_VERIF_GRUPO_PRESTADORES
  for PRODUCAO.F_CST_VERIF_GRUPO_PRESTADORES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_VERIFICA_CLASSE_SERV
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.F_CST_VERIFICA_CLASSE_SERV
  for PRODUCAO.F_CST_VERIFICA_CLASSE_SERV@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CST_VERIFICA_REDE_ATEND
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.F_CST_VERIFICA_REDE_ATEND
  for PRODUCAO.F_CST_VERIFICA_REDE_ATEND@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CUSTOM_IDADE_USUARIO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_CUSTOM_IDADE_USUARIO
  for PRODUCAO.F_CUSTOM_IDADE_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_CUSTOM_TPCONSULTA_PTU
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_CUSTOM_TPCONSULTA_PTU
  for PRODUCAO.F_CUSTOM_TPCONSULTA_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_DATA_EXTENSO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.F_DATA_EXTENSO
  for PRODUCAO.F_DATA_EXTENSO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_DATAFINAL_FUNCIONARIO_LOCAL
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.F_DATAFINAL_FUNCIONARIO_LOCAL
  for PRODUCAO.F_DATAFINAL_FUNCIONARIO_LOCAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_DATAFINAL_LIMITE_TECNICO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.F_DATAFINAL_LIMITE_TECNICO
  for PRODUCAO.F_DATAFINAL_LIMITE_TECNICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_DATAFINAL_PRESTADOR_COTA
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.F_DATAFINAL_PRESTADOR_COTA
  for PRODUCAO.F_DATAFINAL_PRESTADOR_COTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_DATAFINAL_TAB_IR_REF
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_DATAFINAL_TAB_IR_REF
  for PRODUCAO.F_DATAFINAL_TAB_IR_REF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_DESCRICAO_PLANO_USUARIO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.F_DESCRICAO_PLANO_USUARIO
  for PRODUCAO.F_DESCRICAO_PLANO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_DIA_UTIL
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.F_DIA_UTIL
  for PRODUCAO.F_DIA_UTIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_DIA_UTIL_ANTERIOR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_DIA_UTIL_ANTERIOR
  for PRODUCAO.F_DIA_UTIL_ANTERIOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_DTCREDITO_DEP
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_DTCREDITO_DEP
  for PRODUCAO.F_DTCREDITO_DEP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_EMPRESA_FATURA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.F_EMPRESA_FATURA
  for PRODUCAO.F_EMPRESA_FATURA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_ENDERECO_CORRESP
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.F_ENDERECO_CORRESP
  for PRODUCAO.F_ENDERECO_CORRESP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_EXECUTANTE
prompt =============================
prompt
create or replace synonym EMS506UNICOO.F_EXECUTANTE
  for PRODUCAO.F_EXECUTANTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_EXIGE_PRE_AUTORIZACAO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_EXIGE_PRE_AUTORIZACAO
  for PRODUCAO.F_EXIGE_PRE_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_FATURA_PRE_AUTORIZACAO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.F_FATURA_PRE_AUTORIZACAO
  for PRODUCAO.F_FATURA_PRE_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_FECHAMENTO_PERIODO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.F_FECHAMENTO_PERIODO
  for PRODUCAO.F_FECHAMENTO_PERIODO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_FEDERACAO_DTPAGPREST
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_FEDERACAO_DTPAGPREST
  for PRODUCAO.F_FEDERACAO_DTPAGPREST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_FLAG_PAC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.F_FLAG_PAC
  for PRODUCAO.F_FLAG_PAC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_FUNCIONARIO_GRUPO_PREST
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.F_FUNCIONARIO_GRUPO_PREST
  for PRODUCAO.F_FUNCIONARIO_GRUPO_PREST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_FUNCIONARIO_PRESTADOR
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_FUNCIONARIO_PRESTADOR
  for PRODUCAO.F_FUNCIONARIO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_GERA_NRNN_TST
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_GERA_NRNN_TST
  for PRODUCAO.F_GERA_NRNN_TST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_GERA_NRNOSSONUMERO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.F_GERA_NRNOSSONUMERO
  for PRODUCAO.F_GERA_NRNOSSONUMERO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_GERA_PRE_AUT
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.F_GERA_PRE_AUT
  for PRODUCAO.F_GERA_PRE_AUT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_GRAVA_OCORRENCIA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.F_GRAVA_OCORRENCIA
  for PRODUCAO.F_GRAVA_OCORRENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_INFORME_IR
prompt =============================
prompt
create or replace synonym EMS506UNICOO.F_INFORME_IR
  for PRODUCAO.F_INFORME_IR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_INFORME_IR_TOT
prompt =================================
prompt
create or replace synonym EMS506UNICOO.F_INFORME_IR_TOT
  for PRODUCAO.F_INFORME_IR_TOT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_INFORME_TOT_MEU
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.F_INFORME_TOT_MEU
  for PRODUCAO.F_INFORME_TOT_MEU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_INTERCAMBIO_REPASSE
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.F_INTERCAMBIO_REPASSE
  for PRODUCAO.F_INTERCAMBIO_REPASSE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_LIMITE_IDADE_USUARIO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_LIMITE_IDADE_USUARIO
  for PRODUCAO.F_LIMITE_IDADE_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_LIMITE_SERVICO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.F_LIMITE_SERVICO
  for PRODUCAO.F_LIMITE_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_LIMITE_SERVICO_FAMILIA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.F_LIMITE_SERVICO_FAMILIA
  for PRODUCAO.F_LIMITE_SERVICO_FAMILIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_LOTACAO_USUARIO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.F_LOTACAO_USUARIO
  for PRODUCAO.F_LOTACAO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_MASCARA
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.F_MASCARA
  for PRODUCAO.F_MASCARA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_MASCARA_CONTA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_MASCARA_CONTA
  for PRODUCAO.F_MASCARA_CONTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_MASCARA_CONTA_2
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.F_MASCARA_CONTA_2
  for PRODUCAO.F_MASCARA_CONTA_2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_MASCARA_TEXTO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_MASCARA_TEXTO
  for PRODUCAO.F_MASCARA_TEXTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_MENSAGEM_CARTAO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.F_MENSAGEM_CARTAO
  for PRODUCAO.F_MENSAGEM_CARTAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_MENSAGEM_CONSULTA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_MENSAGEM_CONSULTA
  for PRODUCAO.F_MENSAGEM_CONSULTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_MONTA_DATA_FECHAMENTO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_MONTA_DATA_FECHAMENTO
  for PRODUCAO.F_MONTA_DATA_FECHAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_NRNOSSONUMERO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_NRNOSSONUMERO
  for PRODUCAO.F_NRNOSSONUMERO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_NRREGISTRO_EXECUT
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_NRREGISTRO_EXECUT
  for PRODUCAO.F_NRREGISTRO_EXECUT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_OCORRENCIA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.F_OCORRENCIA
  for PRODUCAO.F_OCORRENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_OCORRENCIA_RETORNO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.F_OCORRENCIA_RETORNO
  for PRODUCAO.F_OCORRENCIA_RETORNO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_ORDENA_AGRUP_FAT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.F_ORDENA_AGRUP_FAT
  for PRODUCAO.F_ORDENA_AGRUP_FAT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_ORDENA_AGRUP_PAGTO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.F_ORDENA_AGRUP_PAGTO
  for PRODUCAO.F_ORDENA_AGRUP_PAGTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_ORIGEM_CHAMADA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.F_ORIGEM_CHAMADA
  for PRODUCAO.F_ORIGEM_CHAMADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PACOTE_PTU
prompt =============================
prompt
create or replace synonym EMS506UNICOO.F_PACOTE_PTU
  for PRODUCAO.F_PACOTE_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PAGAMENTO_EFETUADO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.F_PAGAMENTO_EFETUADO
  for PRODUCAO.F_PAGAMENTO_EFETUADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PARAMETRO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.F_PARAMETRO
  for PRODUCAO.F_PARAMETRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PARAMETRO_SPED
prompt =================================
prompt
create or replace synonym EMS506UNICOO.F_PARAMETRO_SPED
  for PRODUCAO.F_PARAMETRO_SPED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PARAMETROEMPRESA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.F_PARAMETROEMPRESA
  for PRODUCAO.F_PARAMETROEMPRESA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PODE_LIBERAR_OCORRENCIA
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.F_PODE_LIBERAR_OCORRENCIA
  for PRODUCAO.F_PODE_LIBERAR_OCORRENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PRAZO_RETORNO_INTERCAMBIO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.F_PRAZO_RETORNO_INTERCAMBIO
  for PRODUCAO.F_PRAZO_RETORNO_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PRESTADOR_PTU
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_PRESTADOR_PTU
  for PRODUCAO.F_PRESTADOR_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PRIMEIRA_PARCELA_PAGA
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_PRIMEIRA_PARCELA_PAGA
  for PRODUCAO.F_PRIMEIRA_PARCELA_PAGA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PROC_AUT_INTERCAMBIO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_PROC_AUT_INTERCAMBIO
  for PRODUCAO.F_PROC_AUT_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PROCURA_MENSALIDADE_USUARIO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.F_PROCURA_MENSALIDADE_USUARIO
  for PRODUCAO.F_PROCURA_MENSALIDADE_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PROCURA_PERICIA_USU_SERV
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.F_PROCURA_PERICIA_USU_SERV
  for PRODUCAO.F_PROCURA_PERICIA_USU_SERV@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PROCURA_PRE_AUT_USU_SERV
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.F_PROCURA_PRE_AUT_USU_SERV
  for PRODUCAO.F_PROCURA_PRE_AUT_USU_SERV@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PROCURA_REGRA_DESCONTO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.F_PROCURA_REGRA_DESCONTO
  for PRODUCAO.F_PROCURA_REGRA_DESCONTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PROCURA_REQ_USU_SERV
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_PROCURA_REQ_USU_SERV
  for PRODUCAO.F_PROCURA_REQ_USU_SERV@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PROCURA_VALOR_TAXA_PG
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_PROCURA_VALOR_TAXA_PG
  for PRODUCAO.F_PROCURA_VALOR_TAXA_PG@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_PROCURA_VALOR_TAXA_RC
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_PROCURA_VALOR_TAXA_RC
  for PRODUCAO.F_PROCURA_VALOR_TAXA_RC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_QTDIAS_CARENCIA_PRODUTO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.F_QTDIAS_CARENCIA_PRODUTO
  for PRODUCAO.F_QTDIAS_CARENCIA_PRODUTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_RECEITA_COMERCIALIZADA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.F_RECEITA_COMERCIALIZADA
  for PRODUCAO.F_RECEITA_COMERCIALIZADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_RETIRA_CARACTER
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.F_RETIRA_CARACTER
  for PRODUCAO.F_RETIRA_CARACTER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_RETORNA_REF_TISS
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.F_RETORNA_REF_TISS
  for PRODUCAO.F_RETORNA_REF_TISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SALDO_TITULO_PAGAR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.F_SALDO_TITULO_PAGAR
  for PRODUCAO.F_SALDO_TITULO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SALDO_TITULO_PAGAR_AUT
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.F_SALDO_TITULO_PAGAR_AUT
  for PRODUCAO.F_SALDO_TITULO_PAGAR_AUT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SALDO_TITULO_PAGAR_ENVIO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.F_SALDO_TITULO_PAGAR_ENVIO
  for PRODUCAO.F_SALDO_TITULO_PAGAR_ENVIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SALDO_TITULO_RECEBER
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_SALDO_TITULO_RECEBER
  for PRODUCAO.F_SALDO_TITULO_RECEBER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SALDO_TITULO_RECEBER_SE
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.F_SALDO_TITULO_RECEBER_SE
  for PRODUCAO.F_SALDO_TITULO_RECEBER_SE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SENHAEXTERNA_SERVICO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_SENHAEXTERNA_SERVICO
  for PRODUCAO.F_SENHAEXTERNA_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SEPARA_SQL
prompt =============================
prompt
create or replace synonym EMS506UNICOO.F_SEPARA_SQL
  for PRODUCAO.F_SEPARA_SQL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SEPARA_SQL_TST
prompt =================================
prompt
create or replace synonym EMS506UNICOO.F_SEPARA_SQL_TST
  for PRODUCAO.F_SEPARA_SQL_TST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SERVICO_AGRUP_CRITERIO_FAT
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.F_SERVICO_AGRUP_CRITERIO_FAT
  for PRODUCAO.F_SERVICO_AGRUP_CRITERIO_FAT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SERVICO_AGRUP_CRITERIO_PAGTO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.F_SERVICO_AGRUP_CRITERIO_PAGTO
  for PRODUCAO.F_SERVICO_AGRUP_CRITERIO_PAGTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SERVICO_AREA_A700
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_SERVICO_AREA_A700
  for PRODUCAO.F_SERVICO_AREA_A700@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SERVICO_AREA_ACAO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_SERVICO_AREA_ACAO
  for PRODUCAO.F_SERVICO_AREA_ACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SERVICO_COMPLEMENTAR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_SERVICO_COMPLEMENTAR
  for PRODUCAO.F_SERVICO_COMPLEMENTAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SERVICO_CONSULTA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.F_SERVICO_CONSULTA
  for PRODUCAO.F_SERVICO_CONSULTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SERVICO_CORRESPONDENTE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.F_SERVICO_CORRESPONDENTE
  for PRODUCAO.F_SERVICO_CORRESPONDENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SERVICO_PERMITIDO_POS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_SERVICO_PERMITIDO_POS
  for PRODUCAO.F_SERVICO_PERMITIDO_POS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SINCO_REC_CONTA_ANALITICA
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.F_SINCO_REC_CONTA_ANALITICA
  for PRODUCAO.F_SINCO_REC_CONTA_ANALITICA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SINONIMO_SERVICO_AUTORIZACAO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.F_SINONIMO_SERVICO_AUTORIZACAO
  for PRODUCAO.F_SINONIMO_SERVICO_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SITUACAO_AUTORIZACAO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_SITUACAO_AUTORIZACAO
  for PRODUCAO.F_SITUACAO_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SITUACAO_AUTORIZACAO_ANT2009
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.F_SITUACAO_AUTORIZACAO_ANT2009
  for PRODUCAO.F_SITUACAO_AUTORIZACAO_ANT2009@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SUBSTITUI_SERVICO_AUTORIZ
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.F_SUBSTITUI_SERVICO_AUTORIZ
  for PRODUCAO.F_SUBSTITUI_SERVICO_AUTORIZ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_SUBSTR2
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.F_SUBSTR2
  for PRODUCAO.F_SUBSTR2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_TESTE
prompt ========================
prompt
create or replace synonym EMS506UNICOO.F_TESTE
  for PRODUCAO.F_TESTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_TIPO_REPASSE
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.F_TIPO_REPASSE
  for PRODUCAO.F_TIPO_REPASSE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_TOTAL_REGISTROS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.F_TOTAL_REGISTROS
  for PRODUCAO.F_TOTAL_REGISTROS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_TOTAL_UNICRED
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_TOTAL_UNICRED
  for PRODUCAO.F_TOTAL_UNICRED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_TPCONSULTA_PTU
prompt =================================
prompt
create or replace synonym EMS506UNICOO.F_TPCONSULTA_PTU
  for PRODUCAO.F_TPCONSULTA_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_TPNOTA_PTU
prompt =============================
prompt
create or replace synonym EMS506UNICOO.F_TPNOTA_PTU
  for PRODUCAO.F_TPNOTA_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_TPOBSTETRICIA_PTU
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_TPOBSTETRICIA_PTU
  for PRODUCAO.F_TPOBSTETRICIA_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_ULTIMO_DIA_MES
prompt =================================
prompt
create or replace synonym EMS506UNICOO.F_ULTIMO_DIA_MES
  for PRODUCAO.F_ULTIMO_DIA_MES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_US_REPASSADO_FATURAMENTO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.F_US_REPASSADO_FATURAMENTO
  for PRODUCAO.F_US_REPASSADO_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_USUARIO_BAIXADO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.F_USUARIO_BAIXADO
  for PRODUCAO.F_USUARIO_BAIXADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_USUARIO_REPASSADO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_USUARIO_REPASSADO
  for PRODUCAO.F_USUARIO_REPASSADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_ACOMODACAO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_ACOMODACAO
  for PRODUCAO.F_VALIDA_ACOMODACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_ACOMODACAO_GUIA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_ACOMODACAO_GUIA
  for PRODUCAO.F_VALIDA_ACOMODACAO_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_ATUALIZACAO_CADASTRAL
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_ATUALIZACAO_CADASTRAL
  for PRODUCAO.F_VALIDA_ATUALIZACAO_CADASTRAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_AUTORIZACAO_INTERC
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_AUTORIZACAO_INTERC
  for PRODUCAO.F_VALIDA_AUTORIZACAO_INTERC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_CARENCIA_SERV_CUSTOM
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_CARENCIA_SERV_CUSTOM
  for PRODUCAO.F_VALIDA_CARENCIA_SERV_CUSTOM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_CARENCIA_SERVICO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_CARENCIA_SERVICO
  for PRODUCAO.F_VALIDA_CARENCIA_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_CENTRO_CUSTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_CENTRO_CUSTO
  for PRODUCAO.F_VALIDA_CENTRO_CUSTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_EXECUCAO_SERVICO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_EXECUCAO_SERVICO
  for PRODUCAO.F_VALIDA_EXECUCAO_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_FINGER
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_FINGER
  for PRODUCAO.F_VALIDA_FINGER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_LIBERACAO_CARENCIA
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_LIBERACAO_CARENCIA
  for PRODUCAO.F_VALIDA_LIBERACAO_CARENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_PRAZO_RETORNO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_PRAZO_RETORNO
  for PRODUCAO.F_VALIDA_PRAZO_RETORNO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_REDE_ATENDIMENTO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_REDE_ATENDIMENTO
  for PRODUCAO.F_VALIDA_REDE_ATENDIMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_SERV_AUTORIZ_FUTURA
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_SERV_AUTORIZ_FUTURA
  for PRODUCAO.F_VALIDA_SERV_AUTORIZ_FUTURA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_SERV_USUARIO_INTERC
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_SERV_USUARIO_INTERC
  for PRODUCAO.F_VALIDA_SERV_USUARIO_INTERC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_SERVICO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_SERVICO
  for PRODUCAO.F_VALIDA_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_SERVICO_COPIA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_SERVICO_COPIA
  for PRODUCAO.F_VALIDA_SERVICO_COPIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_SERVICO_CUSTOM
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_SERVICO_CUSTOM
  for PRODUCAO.F_VALIDA_SERVICO_CUSTOM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_SERVICO_CUSTOM_BKP
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_SERVICO_CUSTOM_BKP
  for PRODUCAO.F_VALIDA_SERVICO_CUSTOM_BKP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_SERVICO_OLD
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_SERVICO_OLD
  for PRODUCAO.F_VALIDA_SERVICO_OLD@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_USUARIO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_USUARIO
  for PRODUCAO.F_VALIDA_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_USUARIO_ATEND_LIBER
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_USUARIO_ATEND_LIBER
  for PRODUCAO.F_VALIDA_USUARIO_ATEND_LIBER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDA_USUARIO_CUSTOM
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDA_USUARIO_CUSTOM
  for PRODUCAO.F_VALIDA_USUARIO_CUSTOM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDACAO_PRAZO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDACAO_PRAZO
  for PRODUCAO.F_VALIDACAO_PRAZO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDACAO_PRAZO_INTERCAMBIO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDACAO_PRAZO_INTERCAMBIO
  for PRODUCAO.F_VALIDACAO_PRAZO_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDACAO_USUARIO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDACAO_USUARIO
  for PRODUCAO.F_VALIDACAO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDADOR_CEI
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDADOR_CEI
  for PRODUCAO.F_VALIDADOR_CEI@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDADOR_CNPJ
prompt =================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDADOR_CNPJ
  for PRODUCAO.F_VALIDADOR_CNPJ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDADOR_CPF
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDADOR_CPF
  for PRODUCAO.F_VALIDADOR_CPF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALIDADOR_PIS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_VALIDADOR_PIS
  for PRODUCAO.F_VALIDADOR_PIS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VALOR_EXTENSO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_VALOR_EXTENSO
  for PRODUCAO.F_VALOR_EXTENSO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VERIFICA_EXCECAO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.F_VERIFICA_EXCECAO
  for PRODUCAO.F_VERIFICA_EXCECAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VERIFICA_GUIAS_AUTORIZACAO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.F_VERIFICA_GUIAS_AUTORIZACAO
  for PRODUCAO.F_VERIFICA_GUIAS_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VERIFICA_MES
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.F_VERIFICA_MES
  for PRODUCAO.F_VERIFICA_MES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VERIFICAR_CPF
prompt ================================
prompt
create or replace synonym EMS506UNICOO.F_VERIFICAR_CPF
  for PRODUCAO.F_VERIFICAR_CPF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VIDAS_COMERCIALIZADAS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.F_VIDAS_COMERCIALIZADAS
  for PRODUCAO.F_VIDAS_COMERCIALIZADAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym F_VINI_ACHA_CODUSU
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.F_VINI_ACHA_CODUSU
  for PRODUCAO.F_VINI_ACHA_CODUSU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FAIXA_DE_IDADE
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.FAIXA_DE_IDADE
  for PRODUCAO.FAIXA_DE_IDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FAIXA_ETARIA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.FAIXA_ETARIA
  for PRODUCAO.FAIXA_ETARIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FAIXA_ETARIA_PROPOSTA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.FAIXA_ETARIA_PROPOSTA
  for PRODUCAO.FAIXA_ETARIA_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FALHA_DE_PROCESSO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.FALHA_DE_PROCESSO
  for PRODUCAO.FALHA_DE_PROCESSO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FALHA_NA_ANALISE
prompt =================================
prompt
create or replace synonym EMS506UNICOO.FALHA_NA_ANALISE
  for PRODUCAO.FALHA_NA_ANALISE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FALHAS_IMPORTACAO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.FALHAS_IMPORTACAO
  for PRODUCAO.FALHAS_IMPORTACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FALHAS_NFSE
prompt ============================
prompt
create or replace synonym EMS506UNICOO.FALHAS_NFSE
  for PRODUCAO.FALHAS_NFSE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FALHAS_TISS_ANS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.FALHAS_TISS_ANS
  for PRODUCAO.FALHAS_TISS_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FALTA_REMT
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.FALTA_REMT
  for PRODUCAO.FALTA_REMT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FAMILIA
prompt ========================
prompt
create or replace synonym EMS506UNICOO.FAMILIA
  for PRODUCAO.FAMILIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FATOR_MODERADOR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.FATOR_MODERADOR
  for PRODUCAO.FATOR_MODERADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FATOR_MODERADOR_PADRAO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.FATOR_MODERADOR_PADRAO
  for PRODUCAO.FATOR_MODERADOR_PADRAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FATUR_ACR
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.FATUR_ACR
  for EMS5.FATUR_ACR;

prompt
prompt Creating synonym FATUR_AP
prompt =========================
prompt
create or replace synonym EMS506UNICOO.FATUR_AP
  for EMS5.FATUR_AP;

prompt
prompt Creating synonym FATURA_DE_INTERCAMBIO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.FATURA_DE_INTERCAMBIO
  for PRODUCAO.FATURA_DE_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FATURA_INTERCAMBIO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.FATURA_INTERCAMBIO
  for PRODUCAO.FATURA_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FATURA_PP_ESCOLHA_FAMILIA
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.FATURA_PP_ESCOLHA_FAMILIA
  for PRODUCAO.FATURA_PP_ESCOLHA_FAMILIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FATURAMENTO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.FATURAMENTO
  for PRODUCAO.FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FATURAMENTO_ESCOLHA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.FATURAMENTO_ESCOLHA
  for PRODUCAO.FATURAMENTO_ESCOLHA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FATURAMENTO_GFIP
prompt =================================
prompt
create or replace synonym EMS506UNICOO.FATURAMENTO_GFIP
  for PRODUCAO.FATURAMENTO_GFIP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FATURAMENTO_NUMERACAO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.FATURAMENTO_NUMERACAO
  for PRODUCAO.FATURAMENTO_NUMERACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FATURAMENTO_PROPOSTA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.FATURAMENTO_PROPOSTA
  for PRODUCAO.FATURAMENTO_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FC_A500_GRAU_PARTICIP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.FC_A500_GRAU_PARTICIP
  for PRODUCAO.FC_A500_GRAU_PARTICIP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FC_A700_GRAU_PARTICIP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.FC_A700_GRAU_PARTICIP
  for PRODUCAO.FC_A700_GRAU_PARTICIP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FC_CUSTOM_ABC_A500
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.FC_CUSTOM_ABC_A500
  for PRODUCAO.FC_CUSTOM_ABC_A500@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FC_DATE
prompt ========================
prompt
create or replace synonym EMS506UNICOO.FC_DATE
  for PRODUCAO.FC_DATE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FC_FATOR_MODERADOR
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.FC_FATOR_MODERADOR
  for PRODUCAO.FC_FATOR_MODERADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FC_FATURA
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.FC_FATURA
  for PRODUCAO.FC_FATURA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FC_HISTORICO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.FC_HISTORICO
  for PRODUCAO.FC_HISTORICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FC_MOVIMENTACAO_USUARIO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.FC_MOVIMENTACAO_USUARIO
  for PRODUCAO.FC_MOVIMENTACAO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FC_TIPO_ATO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.FC_TIPO_ATO
  for PRODUCAO.FC_TIPO_ATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FC_VALIDA_PARAMETRO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.FC_VALIDA_PARAMETRO
  for PRODUCAO.FC_VALIDA_PARAMETRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FCACHA_INFORMACAO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.FCACHA_INFORMACAO
  for PRODUCAO.FCACHA_INFORMACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FDRJ_TESTA_DATA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.FDRJ_TESTA_DATA
  for PRODUCAO.FDRJ_TESTA_DATA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FECHAMENTO_INTEGRACAO_CONTABIL
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.FECHAMENTO_INTEGRACAO_CONTABIL
  for PRODUCAO.FECHAMENTO_INTEGRACAO_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FER_NAC
prompt ========================
prompt
create or replace synonym EMS506UNICOO.FER_NAC
  for EMS5.FER_NAC;

prompt
prompt Creating synonym FERIADO
prompt ========================
prompt
create or replace synonym EMS506UNICOO.FERIADO
  for PRODUCAO.FERIADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FIADOR
prompt =======================
prompt
create or replace synonym EMS506UNICOO.FIADOR
  for EMS5.FIADOR;

prompt
prompt Creating synonym FIADOR_BCO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.FIADOR_BCO
  for EMS5.FIADOR_BCO;

prompt
prompt Creating synonym FIADOR_CLIEN_INADIMP
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.FIADOR_CLIEN_INADIMP
  for EMS5.FIADOR_CLIEN_INADIMP;

prompt
prompt Creating synonym FIADOR_OPERAC_FINANC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.FIADOR_OPERAC_FINANC
  for EMS5.FIADOR_OPERAC_FINANC;

prompt
prompt Creating synonym FIADOR_RENEGOC
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.FIADOR_RENEGOC
  for EMS5.FIADOR_RENEGOC;

prompt
prompt Creating synonym FIADOR_RENEGOC_INADIMP
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.FIADOR_RENEGOC_INADIMP
  for EMS5.FIADOR_RENEGOC_INADIMP;

prompt
prompt Creating synonym FILTRO_PARAM_GERAL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.FILTRO_PARAM_GERAL
  for EMS5.FILTRO_PARAM_GERAL;

prompt
prompt Creating synonym FINALID_ECON
prompt =============================
prompt
create or replace synonym EMS506UNICOO.FINALID_ECON
  for EMS5.FINALID_ECON;

prompt
prompt Creating synonym FINALID_ECON_BCO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.FINALID_ECON_BCO
  for EMS5.FINALID_ECON_BCO;

prompt
prompt Creating synonym FINALID_PAT
prompt ============================
prompt
create or replace synonym EMS506UNICOO.FINALID_PAT
  for EMS5.FINALID_PAT;

prompt
prompt Creating synonym FINALID_UNID_ORGAN
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.FINALID_UNID_ORGAN
  for EMS5.FINALID_UNID_ORGAN;

prompt
prompt Creating synonym FINALID_UTILIZ_CENAR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.FINALID_UTILIZ_CENAR
  for EMS5.FINALID_UTILIZ_CENAR;

prompt
prompt Creating synonym FINALIDECONTIPPROCES
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.FINALIDECONTIPPROCES
  for EMS5.FINALIDECONTIPPROCES;

prompt
prompt Creating synonym FIXAC_DPR
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.FIXAC_DPR
  for EMS5.FIXAC_DPR;

prompt
prompt Creating synonym FLUXO_CX
prompt =========================
prompt
create or replace synonym EMS506UNICOO.FLUXO_CX
  for EMS5.FLUXO_CX;

prompt
prompt Creating synonym FLUXO_DE_CAIXA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.FLUXO_DE_CAIXA
  for PRODUCAO.FLUXO_DE_CAIXA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_ABREVIA
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.FN_ABREVIA
  for PRODUCAO.FN_ABREVIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_ABREVIA_ENDERECO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.FN_ABREVIA_ENDERECO
  for PRODUCAO.FN_ABREVIA_ENDERECO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_ACHANOMECLIENTE
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.FN_ACHANOMECLIENTE
  for PRODUCAO.FN_ACHANOMECLIENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_AJUSTA_CODIGO_DE_BARRAS
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.FN_AJUSTA_CODIGO_DE_BARRAS
  for PRODUCAO.FN_AJUSTA_CODIGO_DE_BARRAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_ATUALIZA_DET_CUSTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.FN_ATUALIZA_DET_CUSTO
  for PRODUCAO.FN_ATUALIZA_DET_CUSTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_ATUALIZA_DET_CUSTO_AP
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.FN_ATUALIZA_DET_CUSTO_AP
  for PRODUCAO.FN_ATUALIZA_DET_CUSTO_AP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_BUSCA_DESC_PLANO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.FN_BUSCA_DESC_PLANO
  for PRODUCAO.FN_BUSCA_DESC_PLANO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_BUSCA_TELEFONE
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.FN_BUSCA_TELEFONE
  for PRODUCAO.FN_BUSCA_TELEFONE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_BUSCA_TELEFONE_PRESTADOR
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.FN_BUSCA_TELEFONE_PRESTADOR
  for PRODUCAO.FN_BUSCA_TELEFONE_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CALC_PERC_PAGO_TITULO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.FN_CALC_PERC_PAGO_TITULO
  for PRODUCAO.FN_CALC_PERC_PAGO_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CALC_PERC_RECEBIDO_TITULO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.FN_CALC_PERC_RECEBIDO_TITULO
  for PRODUCAO.FN_CALC_PERC_RECEBIDO_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CALC_VALOR_DISTRIB
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.FN_CALC_VALOR_DISTRIB
  for PRODUCAO.FN_CALC_VALOR_DISTRIB@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CALC_VLPAGOTITULOPAGAR
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.FN_CALC_VLPAGOTITULOPAGAR
  for PRODUCAO.FN_CALC_VLPAGOTITULOPAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CALC_VLRECEBIDOTITULOREC
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.FN_CALC_VLRECEBIDOTITULOREC
  for PRODUCAO.FN_CALC_VLRECEBIDOTITULOREC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CALCULAVALORPAGOTITULO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.FN_CALCULAVALORPAGOTITULO
  for PRODUCAO.FN_CALCULAVALORPAGOTITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CEP_ABC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.FN_CEP_ABC
  for PRODUCAO.FN_CEP_ABC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CHECA_ENVIO_TITULO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.FN_CHECA_ENVIO_TITULO
  for PRODUCAO.FN_CHECA_ENVIO_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CHECA_ENVIO_TITULO_PAGAR
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.FN_CHECA_ENVIO_TITULO_PAGAR
  for PRODUCAO.FN_CHECA_ENVIO_TITULO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CID_OBITO_PTU
prompt =================================
prompt
create or replace synonym EMS506UNICOO.FN_CID_OBITO_PTU
  for PRODUCAO.FN_CID_OBITO_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CLASSE_SERVICO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.FN_CLASSE_SERVICO
  for PRODUCAO.FN_CLASSE_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_COMPOR_CODIGO_BARRA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.FN_COMPOR_CODIGO_BARRA
  for PRODUCAO.FN_COMPOR_CODIGO_BARRA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_COMPOR_LINHA_DIGITAVEL
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.FN_COMPOR_LINHA_DIGITAVEL
  for PRODUCAO.FN_COMPOR_LINHA_DIGITAVEL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CONTRIBUICAO_SOCIAL
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.FN_CONTRIBUICAO_SOCIAL
  for PRODUCAO.FN_CONTRIBUICAO_SOCIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CRITERIOTAXABANCARIA
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.FN_CRITERIOTAXABANCARIA
  for PRODUCAO.FN_CRITERIOTAXABANCARIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CST_ICMS_MATERIAL_NFE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.FN_CST_ICMS_MATERIAL_NFE
  for PRODUCAO.FN_CST_ICMS_MATERIAL_NFE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CST_VALIDA_ISENCAO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.FN_CST_VALIDA_ISENCAO
  for PRODUCAO.FN_CST_VALIDA_ISENCAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_CST_VALIDA_PAGT_PREST
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.FN_CST_VALIDA_PAGT_PREST
  for PRODUCAO.FN_CST_VALIDA_PAGT_PREST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_DATA_TAXA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.FN_DATA_TAXA
  for PRODUCAO.FN_DATA_TAXA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_DECLARACAO_NASCIMENTO_PTU
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.FN_DECLARACAO_NASCIMENTO_PTU
  for PRODUCAO.FN_DECLARACAO_NASCIMENTO_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_DECLARACAO_OBITO_PTU
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.FN_DECLARACAO_OBITO_PTU
  for PRODUCAO.FN_DECLARACAO_OBITO_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_DEPENDENTES
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.FN_DEPENDENTES
  for PRODUCAO.FN_DEPENDENTES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_DETALHEFATURAMENTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.FN_DETALHEFATURAMENTO
  for PRODUCAO.FN_DETALHEFATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_DISCR_SERVICOS_NFSE
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.FN_DISCR_SERVICOS_NFSE
  for PRODUCAO.FN_DISCR_SERVICOS_NFSE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_FATURA_EVENTO_CONTRIBUICAO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.FN_FATURA_EVENTO_CONTRIBUICAO
  for PRODUCAO.FN_FATURA_EVENTO_CONTRIBUICAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_FORMATATELEFONE
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.FN_FORMATATELEFONE
  for PRODUCAO.FN_FORMATATELEFONE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_INSTRUCOES_BOLETO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.FN_INSTRUCOES_BOLETO
  for PRODUCAO.FN_INSTRUCOES_BOLETO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_ITAUNOSSONUMERO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.FN_ITAUNOSSONUMERO
  for PRODUCAO.FN_ITAUNOSSONUMERO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_MONTA_OBS_INFORME_DIRF
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.FN_MONTA_OBS_INFORME_DIRF
  for PRODUCAO.FN_MONTA_OBS_INFORME_DIRF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_NOME_EMPRESA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.FN_NOME_EMPRESA
  for PRODUCAO.FN_NOME_EMPRESA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_PART_SERV
prompt =============================
prompt
create or replace synonym EMS506UNICOO.FN_PART_SERV
  for PRODUCAO.FN_PART_SERV@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_PODE_FECHAR_LOTE
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.FN_PODE_FECHAR_LOTE
  for PRODUCAO.FN_PODE_FECHAR_LOTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_RECUPERA_COD_CRED
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.FN_RECUPERA_COD_CRED
  for PRODUCAO.FN_RECUPERA_COD_CRED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_RETORNA_CODIGO_TISS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.FN_RETORNA_CODIGO_TISS
  for PRODUCAO.FN_RETORNA_CODIGO_TISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_RETORNA_NUMERO_DE_USUARIO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.FN_RETORNA_NUMERO_DE_USUARIO
  for PRODUCAO.FN_RETORNA_NUMERO_DE_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_RETORNA_SERVICO_REFERENCIA
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.FN_RETORNA_SERVICO_REFERENCIA
  for PRODUCAO.FN_RETORNA_SERVICO_REFERENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_RETORNA_VALOR_ABERTO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.FN_RETORNA_VALOR_ABERTO
  for PRODUCAO.FN_RETORNA_VALOR_ABERTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_RETORNA_VERSAO_PTU
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.FN_RETORNA_VERSAO_PTU
  for PRODUCAO.FN_RETORNA_VERSAO_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_RETORNAOPERACAO_PIS_COFINS
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.FN_RETORNAOPERACAO_PIS_COFINS
  for PRODUCAO.FN_RETORNAOPERACAO_PIS_COFINS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_SALDO_ADIANTAMENTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.FN_SALDO_ADIANTAMENTO
  for PRODUCAO.FN_SALDO_ADIANTAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_SALDO_ADIANTAMENTO_REC
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.FN_SALDO_ADIANTAMENTO_REC
  for PRODUCAO.FN_SALDO_ADIANTAMENTO_REC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_SALDO_TITULO_PAG_DATA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.FN_SALDO_TITULO_PAG_DATA
  for PRODUCAO.FN_SALDO_TITULO_PAG_DATA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_SALDO_TITULO_REC_DATA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.FN_SALDO_TITULO_REC_DATA
  for PRODUCAO.FN_SALDO_TITULO_REC_DATA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_SENHA_OPERADORA_CUSTOM
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.FN_SENHA_OPERADORA_CUSTOM
  for PRODUCAO.FN_SENHA_OPERADORA_CUSTOM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_SERIE_WEBSERVICE_CUSTOM
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.FN_SERIE_WEBSERVICE_CUSTOM
  for PRODUCAO.FN_SERIE_WEBSERVICE_CUSTOM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_SITUACAO_TITULO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.FN_SITUACAO_TITULO
  for PRODUCAO.FN_SITUACAO_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_SITUACAO_TITULO_PAGAR
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.FN_SITUACAO_TITULO_PAGAR
  for PRODUCAO.FN_SITUACAO_TITULO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_SITUACAO_TITULO_RECEBER
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.FN_SITUACAO_TITULO_RECEBER
  for PRODUCAO.FN_SITUACAO_TITULO_RECEBER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_TEMDISTRIBUICAO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.FN_TEMDISTRIBUICAO
  for PRODUCAO.FN_TEMDISTRIBUICAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_TIRARMASCARA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.FN_TIRARMASCARA
  for PRODUCAO.FN_TIRARMASCARA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_USU_PERTENCE_GRUPO_CONTRATO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.FN_USU_PERTENCE_GRUPO_CONTRATO
  for PRODUCAO.FN_USU_PERTENCE_GRUPO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_VALIDA_BANCO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.FN_VALIDA_BANCO
  for PRODUCAO.FN_VALIDA_BANCO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_VALIDA_CRITERIO_REPASSE
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.FN_VALIDA_CRITERIO_REPASSE
  for PRODUCAO.FN_VALIDA_CRITERIO_REPASSE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_VALOR_DEVOLVIDO_ADT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.FN_VALOR_DEVOLVIDO_ADT
  for PRODUCAO.FN_VALOR_DEVOLVIDO_ADT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_VALOR_DEVOLVIDO_ADT_REC
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.FN_VALOR_DEVOLVIDO_ADT_REC
  for PRODUCAO.FN_VALOR_DEVOLVIDO_ADT_REC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_VALOR_SEQUENCIA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.FN_VALOR_SEQUENCIA
  for PRODUCAO.FN_VALOR_SEQUENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_VALOR_UTILIZADO_ADT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.FN_VALOR_UTILIZADO_ADT
  for PRODUCAO.FN_VALOR_UTILIZADO_ADT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_VALOR_UTILIZADO_ADT_REC
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.FN_VALOR_UTILIZADO_ADT_REC
  for PRODUCAO.FN_VALOR_UTILIZADO_ADT_REC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_VENCIMENTOS_POSTERIORES
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.FN_VENCIMENTOS_POSTERIORES
  for PRODUCAO.FN_VENCIMENTOS_POSTERIORES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_VERIFICA_ANO_BISSEXTO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.FN_VERIFICA_ANO_BISSEXTO
  for PRODUCAO.FN_VERIFICA_ANO_BISSEXTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_VERIFICA_CID_PREEXISTENTE
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.FN_VERIFICA_CID_PREEXISTENTE
  for PRODUCAO.FN_VERIFICA_CID_PREEXISTENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_VERIFICA_PERIODO_CONTABIL
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.FN_VERIFICA_PERIODO_CONTABIL
  for PRODUCAO.FN_VERIFICA_PERIODO_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_VERIFICA_SCHEMA_TISS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.FN_VERIFICA_SCHEMA_TISS
  for PRODUCAO.FN_VERIFICA_SCHEMA_TISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FN_VERIFICACHAVENFE
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.FN_VERIFICACHAVENFE
  for PRODUCAO.FN_VERIFICACHAVENFE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FORMA_AUTORIZACAO_CONTR_PES
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.FORMA_AUTORIZACAO_CONTR_PES
  for PRODUCAO.FORMA_AUTORIZACAO_CONTR_PES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FORMA_DE_AUTORIZACAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.FORMA_DE_AUTORIZACAO
  for PRODUCAO.FORMA_DE_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FORMA_PAGAMENTO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.FORMA_PAGAMENTO
  for PRODUCAO.FORMA_PAGAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FORMA_PAGTO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.FORMA_PAGTO
  for EMS5.FORMA_PAGTO;

prompt
prompt Creating synonym FORMA_PAGTO_BCO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.FORMA_PAGTO_BCO
  for EMS5.FORMA_PAGTO_BCO;

prompt
prompt Creating synonym FORMAT_DAT_ELEMENT_EDI
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.FORMAT_DAT_ELEMENT_EDI
  for EMS5.FORMAT_DAT_ELEMENT_EDI;

prompt
prompt Creating synonym FORMAT_DAT_GERAL_EDI
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.FORMAT_DAT_GERAL_EDI
  for EMS5.FORMAT_DAT_GERAL_EDI;

prompt
prompt Creating synonym FORMAT_DEC_ELEMENT_EDI
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.FORMAT_DEC_ELEMENT_EDI
  for EMS5.FORMAT_DEC_ELEMENT_EDI;

prompt
prompt Creating synonym FORMAT_DEC_GERAL_EDI
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.FORMAT_DEC_GERAL_EDI
  for EMS5.FORMAT_DEC_GERAL_EDI;

prompt
prompt Creating synonym FORMAT_INT_ELEMENT_EDI
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.FORMAT_INT_ELEMENT_EDI
  for EMS5.FORMAT_INT_ELEMENT_EDI;

prompt
prompt Creating synonym FORMAT_INT_GERAL_EDI
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.FORMAT_INT_GERAL_EDI
  for EMS5.FORMAT_INT_GERAL_EDI;

prompt
prompt Creating synonym FORMAT_STRING
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.FORMAT_STRING
  for PRODUCAO.FORMAT_STRING@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FORMATFLOAT
prompt ============================
prompt
create or replace synonym EMS506UNICOO.FORMATFLOAT
  for PRODUCAO.FORMATFLOAT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FORMUL_EDI
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.FORMUL_EDI
  for EMS5.FORMUL_EDI;

prompt
prompt Creating synonym FORMULARIO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.FORMULARIO
  for PRODUCAO.FORMULARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FORNEC_FINANC
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.FORNEC_FINANC
  for EMS5.FORNEC_FINANC;

prompt
prompt Creating synonym FORNECEDOR
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.FORNECEDOR
  for EMS5.FORNECEDOR;

prompt
prompt Creating synonym FORNECEDOR_AGENCIA_BANCARIA
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.FORNECEDOR_AGENCIA_BANCARIA
  for PRODUCAO.FORNECEDOR_AGENCIA_BANCARIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FORNECEDOR_CAMARA_COMPENSACAO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.FORNECEDOR_CAMARA_COMPENSACAO
  for PRODUCAO.FORNECEDOR_CAMARA_COMPENSACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FORNECEDOR_DEDUCOES
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.FORNECEDOR_DEDUCOES
  for PRODUCAO.FORNECEDOR_DEDUCOES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FORNECEDOR_GRUPO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.FORNECEDOR_GRUPO
  for PRODUCAO.FORNECEDOR_GRUPO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FORNECEDOR_TAXA_PAGAR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.FORNECEDOR_TAXA_PAGAR
  for PRODUCAO.FORNECEDOR_TAXA_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FORNECEDOR_TOTVS11
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.FORNECEDOR_TOTVS11
  for PRODUCAO.FORNECEDOR_TOTVS11@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FU_ACENTO
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.FU_ACENTO
  for PRODUCAO.FU_ACENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FUNC_EEC_GRP_VIAGEM
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.FUNC_EEC_GRP_VIAGEM
  for EMS5.FUNC_EEC_GRP_VIAGEM;

prompt
prompt Creating synonym FUNC_EMIT_PROCES_EEC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.FUNC_EMIT_PROCES_EEC
  for EMS5.FUNC_EMIT_PROCES_EEC;

prompt
prompt Creating synonym FUNC_FINANC
prompt ============================
prompt
create or replace synonym EMS506UNICOO.FUNC_FINANC
  for EMS5.FUNC_FINANC;

prompt
prompt Creating synonym FUNC_UNID_APROVAC_EEC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.FUNC_UNID_APROVAC_EEC
  for EMS5.FUNC_UNID_APROVAC_EEC;

prompt
prompt Creating synonym FUNCAO_DO_SISTEMA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.FUNCAO_DO_SISTEMA
  for PRODUCAO.FUNCAO_DO_SISTEMA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FUNCAO_NEGOC
prompt =============================
prompt
create or replace synonym EMS506UNICOO.FUNCAO_NEGOC
  for EMS5.FUNCAO_NEGOC;

prompt
prompt Creating synonym FUNCFINANCAPRVDOREEC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.FUNCFINANCAPRVDOREEC
  for EMS5.FUNCFINANCAPRVDOREEC;

prompt
prompt Creating synonym FUNCIONARIO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.FUNCIONARIO
  for PRODUCAO.FUNCIONARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FUNCIONARIO_LOCAL
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.FUNCIONARIO_LOCAL
  for PRODUCAO.FUNCIONARIO_LOCAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FUNDAMENTACAO_CODIGO_AJUSTE
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.FUNDAMENTACAO_CODIGO_AJUSTE
  for PRODUCAO.FUNDAMENTACAO_CODIGO_AJUSTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym FUNDAMENTACAO_OUTROS_ICMS
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.FUNDAMENTACAO_OUTROS_ICMS
  for PRODUCAO.FUNDAMENTACAO_OUTROS_ICMS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym G_AUTHORS
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.G_AUTHORS
  for PRODUCAO.G_AUTHORS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym G_BOOK_AUTHORS
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.G_BOOK_AUTHORS
  for PRODUCAO.G_BOOK_AUTHORS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym G_BOOKS
prompt ========================
prompt
create or replace synonym EMS506UNICOO.G_BOOKS
  for PRODUCAO.G_BOOKS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym G_CART
prompt =======================
prompt
create or replace synonym EMS506UNICOO.G_CART
  for PRODUCAO.G_CART@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym G_CUSTOMERS
prompt ============================
prompt
create or replace synonym EMS506UNICOO.G_CUSTOMERS
  for PRODUCAO.G_CUSTOMERS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym G_LINE_ITEMS
prompt =============================
prompt
create or replace synonym EMS506UNICOO.G_LINE_ITEMS
  for PRODUCAO.G_LINE_ITEMS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym G_ORDERS
prompt =========================
prompt
create or replace synonym EMS506UNICOO.G_ORDERS
  for PRODUCAO.G_ORDERS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GARTIA_CONTRAT_FINANC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.GARTIA_CONTRAT_FINANC
  for EMS5.GARTIA_CONTRAT_FINANC;

prompt
prompt Creating synonym GARTIA_OPERAC_FINANC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.GARTIA_OPERAC_FINANC
  for EMS5.GARTIA_OPERAC_FINANC;

prompt
prompt Creating synonym GERAC_ANTECIP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.GERAC_ANTECIP
  for EMS5.GERAC_ANTECIP;

prompt
prompt Creating synonym GERACAO_A1200
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.GERACAO_A1200
  for PRODUCAO.GERACAO_A1200@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GERACAO_A1200_PACOTE_TABELA
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.GERACAO_A1200_PACOTE_TABELA
  for PRODUCAO.GERACAO_A1200_PACOTE_TABELA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GERACAO_A1200_SERVICO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.GERACAO_A1200_SERVICO
  for PRODUCAO.GERACAO_A1200_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GERACAO_CARTA_CONFIG
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.GERACAO_CARTA_CONFIG
  for PRODUCAO.GERACAO_CARTA_CONFIG@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GERACAO_CARTA_CONFIG_CAMPO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.GERACAO_CARTA_CONFIG_CAMPO
  for PRODUCAO.GERACAO_CARTA_CONFIG_CAMPO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GERACAO_CARTA_CONFIG_ITEM
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.GERACAO_CARTA_CONFIG_ITEM
  for PRODUCAO.GERACAO_CARTA_CONFIG_ITEM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GERACAO_LANCAMENTO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.GERACAO_LANCAMENTO
  for PRODUCAO.GERACAO_LANCAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GERACAO_LANCAMENTO_ITEM
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.GERACAO_LANCAMENTO_ITEM
  for PRODUCAO.GERACAO_LANCAMENTO_ITEM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRAU_DE_PARTICIPACAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.GRAU_DE_PARTICIPACAO
  for PRODUCAO.GRAU_DE_PARTICIPACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRAU_PARTICIPACAO_INTERCAMBIO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.GRAU_PARTICIPACAO_INTERCAMBIO
  for PRODUCAO.GRAU_PARTICIPACAO_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRP_CALC
prompt =========================
prompt
create or replace synonym EMS506UNICOO.GRP_CALC
  for EMS5.GRP_CALC;

prompt
prompt Creating synonym GRP_CCUSTO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.GRP_CCUSTO
  for EMS5.GRP_CCUSTO;

prompt
prompt Creating synonym GRP_CLIEN
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.GRP_CLIEN
  for EMS5.GRP_CLIEN;

prompt
prompt Creating synonym GRP_CTA_CTBL
prompt =============================
prompt
create or replace synonym EMS506UNICOO.GRP_CTA_CTBL
  for EMS5.GRP_CTA_CTBL;

prompt
prompt Creating synonym GRP_CTA_PAT
prompt ============================
prompt
create or replace synonym EMS506UNICOO.GRP_CTA_PAT
  for EMS5.GRP_CTA_PAT;

prompt
prompt Creating synonym GRP_CTA_PAT_USUAR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.GRP_CTA_PAT_USUAR
  for EMS5.GRP_CTA_PAT_USUAR;

prompt
prompt Creating synonym GRP_EXC_CTA_CTBL
prompt =================================
prompt
create or replace synonym EMS506UNICOO.GRP_EXC_CTA_CTBL
  for EMS5.GRP_EXC_CTA_CTBL;

prompt
prompt Creating synonym GRP_FORNEC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.GRP_FORNEC
  for EMS5.GRP_FORNEC;

prompt
prompt Creating synonym GRP_REPRES
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.GRP_REPRES
  for EMS5.GRP_REPRES;

prompt
prompt Creating synonym GRP_SEGUR_DET_ORCTO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.GRP_SEGUR_DET_ORCTO
  for EMS5.GRP_SEGUR_DET_ORCTO;

prompt
prompt Creating synonym GRP_USUAR_REGRA_CX
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.GRP_USUAR_REGRA_CX
  for EMS5.GRP_USUAR_REGRA_CX;

prompt
prompt Creating synonym GRP_VIAGEM_EEC
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.GRP_VIAGEM_EEC
  for EMS5.GRP_VIAGEM_EEC;

prompt
prompt Creating synonym GRUPO_CONTRATO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.GRUPO_CONTRATO
  for PRODUCAO.GRUPO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_CONTRATO_DETALHE
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.GRUPO_CONTRATO_DETALHE
  for PRODUCAO.GRUPO_CONTRATO_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_DE_CLIENTE
prompt =================================
prompt
create or replace synonym EMS506UNICOO.GRUPO_DE_CLIENTE
  for PRODUCAO.GRUPO_DE_CLIENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_DE_FORNECEDOR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.GRUPO_DE_FORNECEDOR
  for PRODUCAO.GRUPO_DE_FORNECEDOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_DO_HISTORICO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.GRUPO_DO_HISTORICO
  for PRODUCAO.GRUPO_DO_HISTORICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_ECONOMICO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.GRUPO_ECONOMICO
  for PRODUCAO.GRUPO_ECONOMICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_FATURAMENTO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.GRUPO_FATURAMENTO
  for PRODUCAO.GRUPO_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_FUNCIONARIO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.GRUPO_FUNCIONARIO
  for PRODUCAO.GRUPO_FUNCIONARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_MATERIAL
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.GRUPO_MATERIAL
  for PRODUCAO.GRUPO_MATERIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_PLANO_SAUDE
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.GRUPO_PLANO_SAUDE
  for PRODUCAO.GRUPO_PLANO_SAUDE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_POS
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.GRUPO_POS
  for PRODUCAO.GRUPO_POS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_POS_CONTRATO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.GRUPO_POS_CONTRATO
  for PRODUCAO.GRUPO_POS_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_PRESTADOR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.GRUPO_PRESTADOR
  for PRODUCAO.GRUPO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_SERV_ESPECIALISTA
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.GRUPO_SERV_ESPECIALISTA
  for PRODUCAO.GRUPO_SERV_ESPECIALISTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_SERVICO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.GRUPO_SERVICO
  for PRODUCAO.GRUPO_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GRUPO_TRATAMENTO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.GRUPO_TRATAMENTO
  for PRODUCAO.GRUPO_TRATAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GUIA_DE_SERVICO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.GUIA_DE_SERVICO
  for PRODUCAO.GUIA_DE_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GUIA_DE_SERVICO_ANALISE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.GUIA_DE_SERVICO_ANALISE
  for PRODUCAO.GUIA_DE_SERVICO_ANALISE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GUIA_INTERCAMBIO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.GUIA_INTERCAMBIO
  for PRODUCAO.GUIA_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym GUIA_INTERNACAO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.GUIA_INTERNACAO
  for PRODUCAO.GUIA_INTERNACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HB20
prompt =====================
prompt
create or replace synonym EMS506UNICOO.HB20
  for PRODUCAO.HB20@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HBVALIDACAOINTEGRACAO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HBVALIDACAOINTEGRACAO
  for PRODUCAO.HBVALIDACAOINTEGRACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HBVALIDACAOINTEGRACAOPRODUCAO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.HBVALIDACAOINTEGRACAOPRODUCAO
  for PRODUCAO.HBVALIDACAOINTEGRACAOPRODUCAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HIER_BEM_PAT
prompt =============================
prompt
create or replace synonym EMS506UNICOO.HIER_BEM_PAT
  for EMS5.HIER_BEM_PAT;

prompt
prompt Creating synonym HIER_PAT
prompt =========================
prompt
create or replace synonym EMS506UNICOO.HIER_PAT
  for EMS5.HIER_PAT;

prompt
prompt Creating synonym HIS_BEM_PAT
prompt ============================
prompt
create or replace synonym EMS506UNICOO.HIS_BEM_PAT
  for EMS5.HIS_BEM_PAT;

prompt
prompt Creating synonym HIS_BORD_ACR
prompt =============================
prompt
create or replace synonym EMS506UNICOO.HIS_BORD_ACR
  for EMS5.HIS_BORD_ACR;

prompt
prompt Creating synonym HIS_BORD_AP
prompt ============================
prompt
create or replace synonym EMS506UNICOO.HIS_BORD_AP
  for EMS5.HIS_BORD_AP;

prompt
prompt Creating synonym HIS_CHEQ
prompt =========================
prompt
create or replace synonym EMS506UNICOO.HIS_CHEQ
  for EMS5.HIS_CHEQ;

prompt
prompt Creating synonym HIS_CHEQ_ACR
prompt =============================
prompt
create or replace synonym EMS506UNICOO.HIS_CHEQ_ACR
  for EMS5.HIS_CHEQ_ACR;

prompt
prompt Creating synonym HIS_CONCIL_CTA_CORREN
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HIS_CONCIL_CTA_CORREN
  for EMS5.HIS_CONCIL_CTA_CORREN;

prompt
prompt Creating synonym HIS_DOCTO_ENTR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.HIS_DOCTO_ENTR
  for EMS5.HIS_DOCTO_ENTR;

prompt
prompt Creating synonym HIS_ENCTRO_CTA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.HIS_ENCTRO_CTA
  for EMS5.HIS_ENCTRO_CTA;

prompt
prompt Creating synonym HIS_EXTRAT_CTA_CORREN
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HIS_EXTRAT_CTA_CORREN
  for EMS5.HIS_EXTRAT_CTA_CORREN;

prompt
prompt Creating synonym HIS_FATUR_ACR
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.HIS_FATUR_ACR
  for EMS5.HIS_FATUR_ACR;

prompt
prompt Creating synonym HIS_FATUR_AP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.HIS_FATUR_AP
  for EMS5.HIS_FATUR_AP;

prompt
prompt Creating synonym HIS_FLUXO_CX
prompt =============================
prompt
create or replace synonym EMS506UNICOO.HIS_FLUXO_CX
  for EMS5.HIS_FLUXO_CX;

prompt
prompt Creating synonym HIS_LOTE_CTBL
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.HIS_LOTE_CTBL
  for EMS5.HIS_LOTE_CTBL;

prompt
prompt Creating synonym HIS_MAPA_MOVTO_BEM_PAT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.HIS_MAPA_MOVTO_BEM_PAT
  for EMS5.HIS_MAPA_MOVTO_BEM_PAT;

prompt
prompt Creating synonym HIS_MOVTO_CTA_CORREN
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.HIS_MOVTO_CTA_CORREN
  for EMS5.HIS_MOVTO_CTA_CORREN;

prompt
prompt Creating synonym HIS_NOTA_DEVOL_TIT_ACR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.HIS_NOTA_DEVOL_TIT_ACR
  for EMS5.HIS_NOTA_DEVOL_TIT_ACR;

prompt
prompt Creating synonym HIS_NOTA_DEVOL_TIT_AP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HIS_NOTA_DEVOL_TIT_AP
  for EMS5.HIS_NOTA_DEVOL_TIT_AP;

prompt
prompt Creating synonym HIS_OPERAC_FINANC_ACR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HIS_OPERAC_FINANC_ACR
  for EMS5.HIS_OPERAC_FINANC_ACR;

prompt
prompt Creating synonym HIS_ORCTO_CTBL
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.HIS_ORCTO_CTBL
  for EMS5.HIS_ORCTO_CTBL;

prompt
prompt Creating synonym HIS_RENEGOC_ACR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.HIS_RENEGOC_ACR
  for EMS5.HIS_RENEGOC_ACR;

prompt
prompt Creating synonym HIS_TIT_ACR_COBR_ESP
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.HIS_TIT_ACR_COBR_ESP
  for EMS5.HIS_TIT_ACR_COBR_ESP;

prompt
prompt Creating synonym HIS_TIT_ACR_HISTOR
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.HIS_TIT_ACR_HISTOR
  for EMS5.HIS_TIT_ACR_HISTOR;

prompt
prompt Creating synonym HISMOVTOTITACRHISTOR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.HISMOVTOTITACRHISTOR
  for EMS5.HISMOVTOTITACRHISTOR;

prompt
prompt Creating synonym HISMOVTOTITAPHISTOR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.HISMOVTOTITAPHISTOR
  for EMS5.HISMOVTOTITAPHISTOR;

prompt
prompt Creating synonym HIST_DEMONSTRATIVO_ANALISE
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.HIST_DEMONSTRATIVO_ANALISE
  for PRODUCAO.HIST_DEMONSTRATIVO_ANALISE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HIST_PRECO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.HIST_PRECO
  for PRODUCAO.HIST_PRECO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTITAPTRANSFHISTOR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.HISTITAPTRANSFHISTOR
  for EMS5.HISTITAPTRANSFHISTOR;

prompt
prompt Creating synonym HISTOR_ACUM_FORNEC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_ACUM_FORNEC
  for EMS5.HISTOR_ACUM_FORNEC;

prompt
prompt Creating synonym HISTOR_ACUM_REPRES
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_ACUM_REPRES
  for EMS5.HISTOR_ACUM_REPRES;

prompt
prompt Creating synonym HISTOR_BCO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.HISTOR_BCO
  for EMS5.HISTOR_BCO;

prompt
prompt Creating synonym HISTOR_CAD_FINANC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_CAD_FINANC
  for EMS5.HISTOR_CAD_FINANC;

prompt
prompt Creating synonym HISTOR_CHEQ
prompt ============================
prompt
create or replace synonym EMS506UNICOO.HISTOR_CHEQ
  for EMS5.HISTOR_CHEQ;

prompt
prompt Creating synonym HISTOR_CLIEN
prompt =============================
prompt
create or replace synonym EMS506UNICOO.HISTOR_CLIEN
  for EMS5.HISTOR_CLIEN;

prompt
prompt Creating synonym HISTOR_COBR_ESCRIT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_COBR_ESCRIT
  for EMS5.HISTOR_COBR_ESCRIT;

prompt
prompt Creating synonym HISTOR_CTA_CTBL_INTEGR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_CTA_CTBL_INTEGR
  for EMS5.HISTOR_CTA_CTBL_INTEGR;

prompt
prompt Creating synonym HISTOR_DESPES_RECTA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_DESPES_RECTA
  for EMS5.HISTOR_DESPES_RECTA;

prompt
prompt Creating synonym HISTOR_EXEC_ESPECIAL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_EXEC_ESPECIAL
  for EMS5.HISTOR_EXEC_ESPECIAL;

prompt
prompt Creating synonym HISTOR_FINALID_ECON
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_FINALID_ECON
  for EMS5.HISTOR_FINALID_ECON;

prompt
prompt Creating synonym HISTOR_FORNEC
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.HISTOR_FORNEC
  for EMS5.HISTOR_FORNEC;

prompt
prompt Creating synonym HISTOR_GENER
prompt =============================
prompt
create or replace synonym EMS506UNICOO.HISTOR_GENER
  for EMS5.HISTOR_GENER;

prompt
prompt Creating synonym HISTOR_IMPTO_EMPRES
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_IMPTO_EMPRES
  for EMS5.HISTOR_IMPTO_EMPRES;

prompt
prompt Creating synonym HISTOR_LOCALIZ_LANCTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_LOCALIZ_LANCTO
  for EMS5.HISTOR_LOCALIZ_LANCTO;

prompt
prompt Creating synonym HISTOR_LOTE_CTBL_PLANT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_LOTE_CTBL_PLANT
  for EMS5.HISTOR_LOTE_CTBL_PLANT;

prompt
prompt Creating synonym HISTOR_MATRIZ_TRAD
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_MATRIZ_TRAD
  for EMS5.HISTOR_MATRIZ_TRAD;

prompt
prompt Creating synonym HISTOR_MOVTO_TIT_ACR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_MOVTO_TIT_ACR
  for EMS5.HISTOR_MOVTO_TIT_ACR;

prompt
prompt Creating synonym HISTOR_OPERAC_FINANC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_OPERAC_FINANC
  for EMS5.HISTOR_OPERAC_FINANC;

prompt
prompt Creating synonym HISTOR_ORCTO_CTBL_BGC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_ORCTO_CTBL_BGC
  for EMS5.HISTOR_ORCTO_CTBL_BGC;

prompt
prompt Creating synonym HISTOR_PADR
prompt ============================
prompt
create or replace synonym EMS506UNICOO.HISTOR_PADR
  for EMS5.HISTOR_PADR;

prompt
prompt Creating synonym HISTOR_PARAM_CTBZ
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_PARAM_CTBZ
  for EMS5.HISTOR_PARAM_CTBZ;

prompt
prompt Creating synonym HISTOR_PARAM_INTER_DIV
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_PARAM_INTER_DIV
  for EMS5.HISTOR_PARAM_INTER_DIV;

prompt
prompt Creating synonym HISTOR_PERIOD_CLIEN
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_PERIOD_CLIEN
  for EMS5.HISTOR_PERIOD_CLIEN;

prompt
prompt Creating synonym HISTOR_PERIOD_FORNEC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_PERIOD_FORNEC
  for EMS5.HISTOR_PERIOD_FORNEC;

prompt
prompt Creating synonym HISTOR_PESSOA_FISIC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_PESSOA_FISIC
  for EMS5.HISTOR_PESSOA_FISIC;

prompt
prompt Creating synonym HISTOR_PESSOA_JURID
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_PESSOA_JURID
  for EMS5.HISTOR_PESSOA_JURID;

prompt
prompt Creating synonym HISTOR_RANKING_BCIO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_RANKING_BCIO
  for EMS5.HISTOR_RANKING_BCIO;

prompt
prompt Creating synonym HISTOR_SIT_PERIOD_CTBL
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_SIT_PERIOD_CTBL
  for EMS5.HISTOR_SIT_PERIOD_CTBL;

prompt
prompt Creating synonym HISTOR_TIT_MOVTO_AP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_TIT_MOVTO_AP
  for EMS5.HISTOR_TIT_MOVTO_AP;

prompt
prompt Creating synonym HISTOR_TOPIC_COMPON
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.HISTOR_TOPIC_COMPON
  for EMS5.HISTOR_TOPIC_COMPON;

prompt
prompt Creating synonym HISTORACUMIMPTOPAGTO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.HISTORACUMIMPTOPAGTO
  for EMS5.HISTORACUMIMPTOPAGTO;

prompt
prompt Creating synonym HISTOREQUALIZFLUXOTER
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HISTOREQUALIZFLUXOTER
  for EMS5.HISTOREQUALIZFLUXOTER;

prompt
prompt Creating synonym HISTORI__TITULO_PAGAR_TOTVS11
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.HISTORI__TITULO_PAGAR_TOTVS11
  for PRODUCAO.HISTORI__TITULO_PAGAR_TOTVS11@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.HISTORICO
  for PRODUCAO.HISTORICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_AGENDA_COMERCIAL
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_AGENDA_COMERCIAL
  for PRODUCAO.HISTORICO_AGENDA_COMERCIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_AUTORIZACAO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_AUTORIZACAO
  for PRODUCAO.HISTORICO_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_BLOQUEIO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_BLOQUEIO
  for PRODUCAO.HISTORICO_BLOQUEIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_BLOQUEIO_CONTRATO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_BLOQUEIO_CONTRATO
  for PRODUCAO.HISTORICO_BLOQUEIO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_COMPL_USUARIO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_COMPL_USUARIO
  for PRODUCAO.HISTORICO_COMPL_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_CONTR_PESSOA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_CONTR_PESSOA
  for PRODUCAO.HISTORICO_CONTR_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_CONTRATO_PESSOA
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_CONTRATO_PESSOA
  for PRODUCAO.HISTORICO_CONTRATO_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_DA_PERICIA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_DA_PERICIA
  for PRODUCAO.HISTORICO_DA_PERICIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_DEBITO_AUTOMATICO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_DEBITO_AUTOMATICO
  for PRODUCAO.HISTORICO_DEBITO_AUTOMATICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_DEMONSTRATIVO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_DEMONSTRATIVO
  for PRODUCAO.HISTORICO_DEMONSTRATIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_DMED
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_DMED
  for PRODUCAO.HISTORICO_DMED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_DO_CHEQUE
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_DO_CHEQUE
  for PRODUCAO.HISTORICO_DO_CHEQUE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_DO_TITULO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_DO_TITULO
  for PRODUCAO.HISTORICO_DO_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_DO_TITULO_PAGAR
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_DO_TITULO_PAGAR
  for PRODUCAO.HISTORICO_DO_TITULO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_DO_TITULO_TEMP
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_DO_TITULO_TEMP
  for PRODUCAO.HISTORICO_DO_TITULO_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_FORN_TAXA_PAGAR
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_FORN_TAXA_PAGAR
  for PRODUCAO.HISTORICO_FORN_TAXA_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_FORNECEDOR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_FORNECEDOR
  for PRODUCAO.HISTORICO_FORNECEDOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_GUIA_DE_SERVICO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_GUIA_DE_SERVICO
  for PRODUCAO.HISTORICO_GUIA_DE_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_LISTAGEM_MENSAL
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_LISTAGEM_MENSAL
  for PRODUCAO.HISTORICO_LISTAGEM_MENSAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_PADRAO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_PADRAO
  for PRODUCAO.HISTORICO_PADRAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_PRESTADOR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_PRESTADOR
  for PRODUCAO.HISTORICO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_SERVICO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_SERVICO
  for PRODUCAO.HISTORICO_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_SERVICO_DA_GUIA
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_SERVICO_DA_GUIA
  for PRODUCAO.HISTORICO_SERVICO_DA_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_SERVICO_INTERCAMBIO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_SERVICO_INTERCAMBIO
  for PRODUCAO.HISTORICO_SERVICO_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORICO_USUARIO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.HISTORICO_USUARIO
  for PRODUCAO.HISTORICO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HISTORITEMDISTRIBGERC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HISTORITEMDISTRIBGERC
  for EMS5.HISTORITEMDISTRIBGERC;

prompt
prompt Creating synonym HISTORMAPADISTRIBGERC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HISTORMAPADISTRIBGERC
  for EMS5.HISTORMAPADISTRIBGERC;

prompt
prompt Creating synonym HISTORORIGMOVTOEMPENH
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HISTORORIGMOVTOEMPENH
  for EMS5.HISTORORIGMOVTOEMPENH;

prompt
prompt Creating synonym HISTORPARAMINTEGREMS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.HISTORPARAMINTEGREMS
  for EMS5.HISTORPARAMINTEGREMS;

prompt
prompt Creating synonym HISTORPERCPARTICACION
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HISTORPERCPARTICACION
  for EMS5.HISTORPERCPARTICACION;

prompt
prompt Creating synonym HISTORSDOCTACTBLMOD
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.HISTORSDOCTACTBLMOD
  for EMS5.HISTORSDOCTACTBLMOD;

prompt
prompt Creating synonym HISTORSITMOVIMENDTSUL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HISTORSITMOVIMENDTSUL
  for EMS5.HISTORSITMOVIMENDTSUL;

prompt
prompt Creating synonym HISTORTITCOBRESPECIAL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HISTORTITCOBRESPECIAL
  for EMS5.HISTORTITCOBRESPECIAL;

prompt
prompt Creating synonym HORA_TRABALHADA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.HORA_TRABALHADA
  for PRODUCAO.HORA_TRABALHADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HORAR_PASSAG
prompt =============================
prompt
create or replace synonym EMS506UNICOO.HORAR_PASSAG
  for EMS5.HORAR_PASSAG;

prompt
prompt Creating synonym HORARIO
prompt ========================
prompt
create or replace synonym EMS506UNICOO.HORARIO
  for PRODUCAO.HORARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HORARIO_DIGITACAO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.HORARIO_DIGITACAO
  for PRODUCAO.HORARIO_DIGITACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HOSPED_EEC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.HOSPED_EEC
  for EMS5.HOSPED_EEC;

prompt
prompt Creating synonym HOSPITAL_SERVICO_GUIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.HOSPITAL_SERVICO_GUIA
  for PRODUCAO.HOSPITAL_SERVICO_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym HOTEL_EEC
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.HOTEL_EEC
  for EMS5.HOTEL_EEC;

prompt
prompt Creating synonym ID_GEN
prompt =======================
prompt
create or replace synonym EMS506UNICOO.ID_GEN
  for PRODUCAO.ID_GEN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IDADE
prompt ======================
prompt
create or replace synonym EMS506UNICOO.IDADE
  for PRODUCAO.IDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IDENT_BEM_PAT
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.IDENT_BEM_PAT
  for EMS5.IDENT_BEM_PAT;

prompt
prompt Creating synonym IDENT_CR_RET_FONTE
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.IDENT_CR_RET_FONTE
  for EMS5.IDENT_CR_RET_FONTE;

prompt
prompt Creating synonym IDENTIF_FLAT_FILE_EDI
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.IDENTIF_FLAT_FILE_EDI
  for EMS5.IDENTIF_FLAT_FILE_EDI;

prompt
prompt Creating synonym IDENTIF_FLAT_FILE_REG
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.IDENTIF_FLAT_FILE_REG
  for EMS5.IDENTIF_FLAT_FILE_REG;

prompt
prompt Creating synonym IDIOM_BASIC
prompt ============================
prompt
create or replace synonym EMS506UNICOO.IDIOM_BASIC
  for EMS5.IDIOM_BASIC;

prompt
prompt Creating synonym IDIOM_CONTAT
prompt =============================
prompt
create or replace synonym EMS506UNICOO.IDIOM_CONTAT
  for EMS5.IDIOM_CONTAT;

prompt
prompt Creating synonym IDIOM_PAIS
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.IDIOM_PAIS
  for EMS5.IDIOM_PAIS;

prompt
prompt Creating synonym IDIOM_PESSOA_FISIC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.IDIOM_PESSOA_FISIC
  for EMS5.IDIOM_PESSOA_FISIC;

prompt
prompt Creating synonym IMP_ANEXO_AUTORIZACAO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.IMP_ANEXO_AUTORIZACAO
  for PRODUCAO.IMP_ANEXO_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_ANEXO_CONTROLE
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.IMP_ANEXO_CONTROLE
  for PRODUCAO.IMP_ANEXO_CONTROLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_CIDADE_CEP
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.IMP_CIDADE_CEP
  for PRODUCAO.IMP_CIDADE_CEP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_DE_PARA_CIDADE
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.IMP_DE_PARA_CIDADE
  for PRODUCAO.IMP_DE_PARA_CIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_DEPARA_CIDADE_FORNECEDOR
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.IMP_DEPARA_CIDADE_FORNECEDOR
  for PRODUCAO.IMP_DEPARA_CIDADE_FORNECEDOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_FATURA_GERAL
prompt =================================
prompt
create or replace synonym EMS506UNICOO.IMP_FATURA_GERAL
  for PRODUCAO.IMP_FATURA_GERAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_FATURA_PRE
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.IMP_FATURA_PRE
  for PRODUCAO.IMP_FATURA_PRE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_FATURA_PRE_BOL_INS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.IMP_FATURA_PRE_BOL_INS
  for PRODUCAO.IMP_FATURA_PRE_BOL_INS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_FATURA_PRE_BOL_OBS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.IMP_FATURA_PRE_BOL_OBS
  for PRODUCAO.IMP_FATURA_PRE_BOL_OBS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_FATURA_PRE_BOLETO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.IMP_FATURA_PRE_BOLETO
  for PRODUCAO.IMP_FATURA_PRE_BOLETO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_FATURA_PRE_CED_SAC
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.IMP_FATURA_PRE_CED_SAC
  for PRODUCAO.IMP_FATURA_PRE_CED_SAC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_FATURA_PRE_CORPO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.IMP_FATURA_PRE_CORPO
  for PRODUCAO.IMP_FATURA_PRE_CORPO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_FATURA_PRE_USUARIO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.IMP_FATURA_PRE_USUARIO
  for PRODUCAO.IMP_FATURA_PRE_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_FORNECEDOR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.IMP_FORNECEDOR
  for PRODUCAO.IMP_FORNECEDOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_GUIA_CONTA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.IMP_GUIA_CONTA
  for PRODUCAO.IMP_GUIA_CONTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_GUIA_CONTROLE
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.IMP_GUIA_CONTROLE
  for PRODUCAO.IMP_GUIA_CONTROLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_GUIA_DECLARACAO_NASCIMENTO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.IMP_GUIA_DECLARACAO_NASCIMENTO
  for PRODUCAO.IMP_GUIA_DECLARACAO_NASCIMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_GUIA_FALHAS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.IMP_GUIA_FALHAS
  for PRODUCAO.IMP_GUIA_FALHAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_GUIA_LOTE
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.IMP_GUIA_LOTE
  for PRODUCAO.IMP_GUIA_LOTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_GUIA_SERIES_IMPORTACAO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.IMP_GUIA_SERIES_IMPORTACAO
  for PRODUCAO.IMP_GUIA_SERIES_IMPORTACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_GUIA_SERVICO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.IMP_GUIA_SERVICO
  for PRODUCAO.IMP_GUIA_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_IN35
prompt =========================
prompt
create or replace synonym EMS506UNICOO.IMP_IN35
  for PRODUCAO.IMP_IN35@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_A1100_CONTROLE
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_A1100_CONTROLE
  for PRODUCAO.IMP_INTERC_A1100_CONTROLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_A1100_FALHA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_A1100_FALHA
  for PRODUCAO.IMP_INTERC_A1100_FALHA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_A1100_ITENS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_A1100_ITENS
  for PRODUCAO.IMP_INTERC_A1100_ITENS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_A1100_PEDIDO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_A1100_PEDIDO
  for PRODUCAO.IMP_INTERC_A1100_PEDIDO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_A1200
prompt =================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_A1200
  for PRODUCAO.IMP_INTERC_A1200@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_CONTROLE
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_CONTROLE
  for PRODUCAO.IMP_INTERC_CONTROLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_CONTROLE_PRE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_CONTROLE_PRE
  for PRODUCAO.IMP_INTERC_CONTROLE_PRE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_FALHAS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_FALHAS
  for PRODUCAO.IMP_INTERC_FALHAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_FATURA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_FATURA
  for PRODUCAO.IMP_INTERC_FATURA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_GUIA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_GUIA
  for PRODUCAO.IMP_INTERC_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_MOTIVO_QUEST
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_MOTIVO_QUEST
  for PRODUCAO.IMP_INTERC_MOTIVO_QUEST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_PACOTE_OBS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_PACOTE_OBS
  for PRODUCAO.IMP_INTERC_PACOTE_OBS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_PACOTE_TABELA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_PACOTE_TABELA
  for PRODUCAO.IMP_INTERC_PACOTE_TABELA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_QUEST_DETALHE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_QUEST_DETALHE
  for PRODUCAO.IMP_INTERC_QUEST_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_QUESTIONAMENTO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_QUESTIONAMENTO
  for PRODUCAO.IMP_INTERC_QUESTIONAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_R999
prompt ================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_R999
  for PRODUCAO.IMP_INTERC_R999@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_SERVICO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_SERVICO
  for PRODUCAO.IMP_INTERC_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_INTERC_SERVICO_PAC_TAB
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.IMP_INTERC_SERVICO_PAC_TAB
  for PRODUCAO.IMP_INTERC_SERVICO_PAC_TAB@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_RECURSO_GLOSA_CONTROLE
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.IMP_RECURSO_GLOSA_CONTROLE
  for PRODUCAO.IMP_RECURSO_GLOSA_CONTROLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_RECURSO_GLOSA_FALHAS
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.IMP_RECURSO_GLOSA_FALHAS
  for PRODUCAO.IMP_RECURSO_GLOSA_FALHAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_RECURSO_GLOSA_GUIA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.IMP_RECURSO_GLOSA_GUIA
  for PRODUCAO.IMP_RECURSO_GLOSA_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_RECURSO_GLOSA_JUST
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.IMP_RECURSO_GLOSA_JUST
  for PRODUCAO.IMP_RECURSO_GLOSA_JUST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_RECURSO_GLOSA_LOG
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.IMP_RECURSO_GLOSA_LOG
  for PRODUCAO.IMP_RECURSO_GLOSA_LOG@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_RECURSO_GLOSA_LOTE
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.IMP_RECURSO_GLOSA_LOTE
  for PRODUCAO.IMP_RECURSO_GLOSA_LOTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_RECURSO_GLOSA_SERVICO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.IMP_RECURSO_GLOSA_SERVICO
  for PRODUCAO.IMP_RECURSO_GLOSA_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_RECURSO_GLOSA_STATUS
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.IMP_RECURSO_GLOSA_STATUS
  for PRODUCAO.IMP_RECURSO_GLOSA_STATUS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_REGISTRO_TEXTO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.IMP_REGISTRO_TEXTO
  for PRODUCAO.IMP_REGISTRO_TEXTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_USU_CARENCIA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.IMP_USU_CARENCIA
  for PRODUCAO.IMP_USU_CARENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_USU_CONTROLE
prompt =================================
prompt
create or replace synonym EMS506UNICOO.IMP_USU_CONTROLE
  for PRODUCAO.IMP_USU_CONTROLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_USU_EMPRESA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.IMP_USU_EMPRESA
  for PRODUCAO.IMP_USU_EMPRESA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_USU_FALHAS
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.IMP_USU_FALHAS
  for PRODUCAO.IMP_USU_FALHAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_USU_MAPEIA_CONTRATO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.IMP_USU_MAPEIA_CONTRATO
  for PRODUCAO.IMP_USU_MAPEIA_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_USU_PLANO_EMPRESA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.IMP_USU_PLANO_EMPRESA
  for PRODUCAO.IMP_USU_PLANO_EMPRESA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_USU_PREEXISTENCIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.IMP_USU_PREEXISTENCIA
  for PRODUCAO.IMP_USU_PREEXISTENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_USU_USUARIO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.IMP_USU_USUARIO
  for PRODUCAO.IMP_USU_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMP_UTCIDADE
prompt =============================
prompt
create or replace synonym EMS506UNICOO.IMP_UTCIDADE
  for PRODUCAO.IMP_UTCIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym IMPOSTO
prompt ========================
prompt
create or replace synonym EMS506UNICOO.IMPOSTO
  for EMS5.IMPOSTO;

prompt
prompt Creating synonym IMPRSOR_SLIP_COD_BCIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.IMPRSOR_SLIP_COD_BCIA
  for EMS5.IMPRSOR_SLIP_COD_BCIA;

prompt
prompt Creating synonym IMPTO_IMPL_PEND_ACR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.IMPTO_IMPL_PEND_ACR
  for EMS5.IMPTO_IMPL_PEND_ACR;

prompt
prompt Creating synonym IMPTO_IMPL_PEND_AP
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.IMPTO_IMPL_PEND_AP
  for EMS5.IMPTO_IMPL_PEND_AP;

prompt
prompt Creating synonym IMPTO_LIQUIDAC_TIT_ACR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.IMPTO_LIQUIDAC_TIT_ACR
  for EMS5.IMPTO_LIQUIDAC_TIT_ACR;

prompt
prompt Creating synonym IMPTO_PAGTO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.IMPTO_PAGTO
  for EMS5.IMPTO_PAGTO;

prompt
prompt Creating synonym IMPTO_PRODUT_FINANC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.IMPTO_PRODUT_FINANC
  for EMS5.IMPTO_PRODUT_FINANC;

prompt
prompt Creating synonym IMPTO_TIP_TRANS_CX
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.IMPTO_TIP_TRANS_CX
  for EMS5.IMPTO_TIP_TRANS_CX;

prompt
prompt Creating synonym IMPTO_VAL_AGREG_ACR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.IMPTO_VAL_AGREG_ACR
  for EMS5.IMPTO_VAL_AGREG_ACR;

prompt
prompt Creating synonym IMPTO_VINCUL_CLIEN
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.IMPTO_VINCUL_CLIEN
  for EMS5.IMPTO_VINCUL_CLIEN;

prompt
prompt Creating synonym IMPTO_VINCUL_EMPRES
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.IMPTO_VINCUL_EMPRES
  for EMS5.IMPTO_VINCUL_EMPRES;

prompt
prompt Creating synonym IMPTO_VINCUL_ESTAB
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.IMPTO_VINCUL_ESTAB
  for EMS5.IMPTO_VINCUL_ESTAB;

prompt
prompt Creating synonym IMPTO_VINCUL_FORNEC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.IMPTO_VINCUL_FORNEC
  for EMS5.IMPTO_VINCUL_FORNEC;

prompt
prompt Creating synonym IMPTO_VINCUL_TIT_ACR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.IMPTO_VINCUL_TIT_ACR
  for EMS5.IMPTO_VINCUL_TIT_ACR;

prompt
prompt Creating synonym IMPTOPENDOPERACFINANC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.IMPTOPENDOPERACFINANC
  for EMS5.IMPTOPENDOPERACFINANC;

prompt
prompt Creating synonym IMPTOVALAGREGMOVTOAP
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.IMPTOVALAGREGMOVTOAP
  for EMS5.IMPTOVALAGREGMOVTOAP;

prompt
prompt Creating synonym INCENT_FISC
prompt ============================
prompt
create or replace synonym EMS506UNICOO.INCENT_FISC
  for EMS5.INCENT_FISC;

prompt
prompt Creating synonym INCIDENCIA_INSS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.INCIDENCIA_INSS
  for PRODUCAO.INCIDENCIA_INSS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INCIDENCIA_IR
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.INCIDENCIA_IR
  for PRODUCAO.INCIDENCIA_IR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INCIDENCIA_ISS
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.INCIDENCIA_ISS
  for PRODUCAO.INCIDENCIA_ISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INCORP_BEM_PAT
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.INCORP_BEM_PAT
  for EMS5.INCORP_BEM_PAT;

prompt
prompt Creating synonym INCREM_DPR_CCUSTO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.INCREM_DPR_CCUSTO
  for EMS5.INCREM_DPR_CCUSTO;

prompt
prompt Creating synonym INDENIZ_INDEXAD
prompt ================================
prompt
create or replace synonym EMS506UNICOO.INDENIZ_INDEXAD
  for EMS5.INDENIZ_INDEXAD;

prompt
prompt Creating synonym INDENIZ_REPRES
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.INDENIZ_REPRES
  for EMS5.INDENIZ_REPRES;

prompt
prompt Creating synonym INDEXADOR_FINANCEIRO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.INDEXADOR_FINANCEIRO
  for PRODUCAO.INDEXADOR_FINANCEIRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INDIC_APL
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.INDIC_APL
  for EMS5.INDIC_APL;

prompt
prompt Creating synonym INDIC_ECON
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.INDIC_ECON
  for EMS5.INDIC_ECON;

prompt
prompt Creating synonym INDICE_FINACEIRO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.INDICE_FINACEIRO
  for PRODUCAO.INDICE_FINACEIRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INDICE_FINACEIRO_VALOR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.INDICE_FINACEIRO_VALOR
  for PRODUCAO.INDICE_FINACEIRO_VALOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INDICE_FINANCEIRO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.INDICE_FINANCEIRO
  for PRODUCAO.INDICE_FINANCEIRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INDICE_FINANCEIRO_VALOR
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.INDICE_FINANCEIRO_VALOR
  for PRODUCAO.INDICE_FINANCEIRO_VALOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INDICECONOPERACFINANC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.INDICECONOPERACFINANC
  for EMS5.INDICECONOPERACFINANC;

prompt
prompt Creating synonym INF$SQL_AUX
prompt ============================
prompt
create or replace synonym EMS506UNICOO.INF$SQL_AUX
  for PRODUCAO.INF$SQL_AUX@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INF_DETALHE_PEONA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.INF_DETALHE_PEONA
  for PRODUCAO.INF_DETALHE_PEONA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INFORMACAO_DO_LAYOUT
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.INFORMACAO_DO_LAYOUT
  for PRODUCAO.INFORMACAO_DO_LAYOUT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INSS
prompt =====================
prompt
create or replace synonym EMS506UNICOO.INSS
  for PRODUCAO.INSS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INSTRUC_BCIA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.INSTRUC_BCIA
  for EMS5.INSTRUC_BCIA;

prompt
prompt Creating synonym INSTRUC_BCIA_BCO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.INSTRUC_BCIA_BCO
  for EMS5.INSTRUC_BCIA_BCO;

prompt
prompt Creating synonym INSTRUCAO_BANCARIA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.INSTRUCAO_BANCARIA
  for PRODUCAO.INSTRUCAO_BANCARIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INT_SDO_CONSOLID_PARAM
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.INT_SDO_CONSOLID_PARAM
  for EMS5.INT_SDO_CONSOLID_PARAM;

prompt
prompt Creating synonym INTEGR_SDO_CONSOLID_HIS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.INTEGR_SDO_CONSOLID_HIS
  for EMS5.INTEGR_SDO_CONSOLID_HIS;

prompt
prompt Creating synonym INTEGR_SDO_CONSOLID_MSG
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.INTEGR_SDO_CONSOLID_MSG
  for EMS5.INTEGR_SDO_CONSOLID_MSG;

prompt
prompt Creating synonym INTEGRA_CONTABIL_FATURAMENTO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.INTEGRA_CONTABIL_FATURAMENTO
  for PRODUCAO.INTEGRA_CONTABIL_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INTEGRACAO_CONTABIL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.INTEGRACAO_CONTABIL
  for PRODUCAO.INTEGRACAO_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INTEGRACAO_CONTABIL_AUX
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.INTEGRACAO_CONTABIL_AUX
  for PRODUCAO.INTEGRACAO_CONTABIL_AUX@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INTEGRAPLMODULFUNCAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.INTEGRAPLMODULFUNCAO
  for EMS5.INTEGRAPLMODULFUNCAO;

prompt
prompt Creating synonym INTEGRAPLPARAMFUNCAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.INTEGRAPLPARAMFUNCAO
  for EMS5.INTEGRAPLPARAMFUNCAO;

prompt
prompt Creating synonym INTEGRCFLMODULFUNCAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.INTEGRCFLMODULFUNCAO
  for EMS5.INTEGRCFLMODULFUNCAO;

prompt
prompt Creating synonym INTEGRCFLPARAMFUNCAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.INTEGRCFLPARAMFUNCAO
  for EMS5.INTEGRCFLPARAMFUNCAO;

prompt
prompt Creating synonym INTEGREECMODULFUNCAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.INTEGREECMODULFUNCAO
  for EMS5.INTEGREECMODULFUNCAO;

prompt
prompt Creating synonym INTEGREECPARAMFUNCAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.INTEGREECPARAMFUNCAO
  for EMS5.INTEGREECPARAMFUNCAO;

prompt
prompt Creating synonym INTERNACAO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.INTERNACAO
  for PRODUCAO.INTERNACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym INTERNACOES_DOS_USUARIOS
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.INTERNACOES_DOS_USUARIOS
  for PRODUCAO.INTERNACOES_DOS_USUARIOS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ITEM_AGENDA_INADIMP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ITEM_AGENDA_INADIMP
  for EMS5.ITEM_AGENDA_INADIMP;

prompt
prompt Creating synonym ITEM_BORD_ACR
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.ITEM_BORD_ACR
  for EMS5.ITEM_BORD_ACR;

prompt
prompt Creating synonym ITEM_BORD_AP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ITEM_BORD_AP
  for EMS5.ITEM_BORD_AP;

prompt
prompt Creating synonym ITEM_BORD_AP_AGRUP
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ITEM_BORD_AP_AGRUP
  for EMS5.ITEM_BORD_AP_AGRUP;

prompt
prompt Creating synonym ITEM_CHEQ_AP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ITEM_CHEQ_AP
  for EMS5.ITEM_CHEQ_AP;

prompt
prompt Creating synonym ITEM_CONFEREN_SERV
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ITEM_CONFEREN_SERV
  for EMS5.ITEM_CONFEREN_SERV;

prompt
prompt Creating synonym ITEM_CURVA_ABC_ACR
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ITEM_CURVA_ABC_ACR
  for EMS5.ITEM_CURVA_ABC_ACR;

prompt
prompt Creating synonym ITEM_DEMONST_CONCOR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ITEM_DEMONST_CONCOR
  for EMS5.ITEM_DEMONST_CONCOR;

prompt
prompt Creating synonym ITEM_DEMONST_CTBL
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ITEM_DEMONST_CTBL
  for EMS5.ITEM_DEMONST_CTBL;

prompt
prompt Creating synonym ITEM_DESTINAC_COBR
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.ITEM_DESTINAC_COBR
  for EMS5.ITEM_DESTINAC_COBR;

prompt
prompt Creating synonym ITEM_DISTRIB_CCUSTO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ITEM_DISTRIB_CCUSTO
  for EMS5.ITEM_DISTRIB_CCUSTO;

prompt
prompt Creating synonym ITEM_DISTRIB_GERC_CTBL
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ITEM_DISTRIB_GERC_CTBL
  for EMS5.ITEM_DISTRIB_GERC_CTBL;

prompt
prompt Creating synonym ITEM_DOCTO_ENTR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.ITEM_DOCTO_ENTR
  for EMS5.ITEM_DOCTO_ENTR;

prompt
prompt Creating synonym ITEM_DOCTO_ESTOQ_ESOC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.ITEM_DOCTO_ESTOQ_ESOC
  for EMS5.ITEM_DOCTO_ESTOQ_ESOC;

prompt
prompt Creating synonym ITEM_GRP_EXC_CTA_CTBL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.ITEM_GRP_EXC_CTA_CTBL
  for EMS5.ITEM_GRP_EXC_CTA_CTBL;

prompt
prompt Creating synonym ITEM_INTEGR_CTBL_EXT
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ITEM_INTEGR_CTBL_EXT
  for EMS5.ITEM_INTEGR_CTBL_EXT;

prompt
prompt Creating synonym ITEM_LANCTO_CTBL
prompt =================================
prompt
create or replace synonym EMS506UNICOO.ITEM_LANCTO_CTBL
  for EMS5.ITEM_LANCTO_CTBL;

prompt
prompt Creating synonym ITEM_LANCTO_CTBL_PADR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.ITEM_LANCTO_CTBL_PADR
  for EMS5.ITEM_LANCTO_CTBL_PADR;

prompt
prompt Creating synonym ITEM_LIQUIDAC_VENDOR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ITEM_LIQUIDAC_VENDOR
  for EMS5.ITEM_LIQUIDAC_VENDOR;

prompt
prompt Creating synonym ITEM_LISTA_CCUSTO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ITEM_LISTA_CCUSTO
  for EMS5.ITEM_LISTA_CCUSTO;

prompt
prompt Creating synonym ITEM_LOTE_IMPL_AP
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ITEM_LOTE_IMPL_AP
  for EMS5.ITEM_LOTE_IMPL_AP;

prompt
prompt Creating synonym ITEM_LOTE_IMPL_TIT_ACR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ITEM_LOTE_IMPL_TIT_ACR
  for EMS5.ITEM_LOTE_IMPL_TIT_ACR;

prompt
prompt Creating synonym ITEM_LOTE_LIQUIDAC_ACR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ITEM_LOTE_LIQUIDAC_ACR
  for EMS5.ITEM_LOTE_LIQUIDAC_ACR;

prompt
prompt Creating synonym ITEM_LOTE_PAGTO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.ITEM_LOTE_PAGTO
  for EMS5.ITEM_LOTE_PAGTO;

prompt
prompt Creating synonym ITEM_MATERIAL
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.ITEM_MATERIAL
  for PRODUCAO.ITEM_MATERIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ITEM_MOVTO_ORCTO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.ITEM_MOVTO_ORCTO
  for EMS5.ITEM_MOVTO_ORCTO;

prompt
prompt Creating synonym ITEM_ORCTO_CTBL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.ITEM_ORCTO_CTBL
  for EMS5.ITEM_ORCTO_CTBL;

prompt
prompt Creating synonym ITEM_ORCTO_FLUXO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.ITEM_ORCTO_FLUXO
  for EMS5.ITEM_ORCTO_FLUXO;

prompt
prompt Creating synonym ITEM_OUTROS_LANCAMENTOS_ICMS
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.ITEM_OUTROS_LANCAMENTOS_ICMS
  for PRODUCAO.ITEM_OUTROS_LANCAMENTOS_ICMS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ITEM_PCTE
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.ITEM_PCTE
  for EMS5.ITEM_PCTE;

prompt
prompt Creating synonym ITEM_PLANILHA_ORCTARIA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ITEM_PLANILHA_ORCTARIA
  for EMS5.ITEM_PLANILHA_ORCTARIA;

prompt
prompt Creating synonym ITEM_RAT_CTBL
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.ITEM_RAT_CTBL
  for EMS5.ITEM_RAT_CTBL;

prompt
prompt Creating synonym ITEM_RENEGOC_ACR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.ITEM_RENEGOC_ACR
  for EMS5.ITEM_RENEGOC_ACR;

prompt
prompt Creating synonym ITEM_RENEGOC_INADIMP
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ITEM_RENEGOC_INADIMP
  for EMS5.ITEM_RENEGOC_INADIMP;

prompt
prompt Creating synonym ITEM_RENEGOC_TERC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ITEM_RENEGOC_TERC
  for EMS5.ITEM_RENEGOC_TERC;

prompt
prompt Creating synonym ITEM_RESERVA_SOLICIT
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ITEM_RESERVA_SOLICIT
  for EMS5.ITEM_RESERVA_SOLICIT;

prompt
prompt Creating synonym ITEM_TAB_PRGSSIV_IMPTO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ITEM_TAB_PRGSSIV_IMPTO
  for EMS5.ITEM_TAB_PRGSSIV_IMPTO;

prompt
prompt Creating synonym ITEM_TAXA_A_PAGAR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ITEM_TAXA_A_PAGAR
  for PRODUCAO.ITEM_TAXA_A_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ITEMCOTACOPERACFINANC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.ITEMCOTACOPERACFINANC
  for EMS5.ITEMCOTACOPERACFINANC;

prompt
prompt Creating synonym ITEMCRITICSDOCTACTBL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ITEMCRITICSDOCTACTBL
  for EMS5.ITEMCRITICSDOCTACTBL;

prompt
prompt Creating synonym ITEMGRPSEGURDETORCTO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ITEMGRPSEGURDETORCTO
  for EMS5.ITEMGRPSEGURDETORCTO;

prompt
prompt Creating synonym ITEMHISTORRANKINGBCIO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.ITEMHISTORRANKINGBCIO
  for EMS5.ITEMHISTORRANKINGBCIO;

prompt
prompt Creating synonym ITEMMAPAMOVTOBEMPAT
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ITEMMAPAMOVTOBEMPAT
  for EMS5.ITEMMAPAMOVTOBEMPAT;

prompt
prompt Creating synonym ITEMMAPAMOVTOPATORIG
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ITEMMAPAMOVTOPATORIG
  for EMS5.ITEMMAPAMOVTOPATORIG;

prompt
prompt Creating synonym ITEMMOVTODESTINACCOBR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.ITEMMOVTODESTINACCOBR
  for EMS5.ITEMMOVTODESTINACCOBR;

prompt
prompt Creating synonym ITEMREGRARANKINGBCIO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ITEMREGRARANKINGBCIO
  for EMS5.ITEMREGRARANKINGBCIO;

prompt
prompt Creating synonym ITEMSIMULOPERACFINANC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.ITEMSIMULOPERACFINANC
  for EMS5.ITEMSIMULOPERACFINANC;

prompt
prompt Creating synonym JOSIAS_FORNECEDOR_ERRO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.JOSIAS_FORNECEDOR_ERRO
  for PRODUCAO.JOSIAS_FORNECEDOR_ERRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym JURISD_ISENCAO_CLIEN
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.JURISD_ISENCAO_CLIEN
  for EMS5.JURISD_ISENCAO_CLIEN;

prompt
prompt Creating synonym JURISD_SALES_TAX
prompt =================================
prompt
create or replace synonym EMS506UNICOO.JURISD_SALES_TAX
  for EMS5.JURISD_SALES_TAX;

prompt
prompt Creating synonym JURISDSALESTAXEMPRES
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.JURISDSALESTAXEMPRES
  for EMS5.JURISDSALESTAXEMPRES;

prompt
prompt Creating synonym JUSTIF_ORCTO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.JUSTIF_ORCTO
  for EMS5.JUSTIF_ORCTO;

prompt
prompt Creating synonym LANCAMENTO_CONCILIACAO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LANCAMENTO_CONCILIACAO
  for PRODUCAO.LANCAMENTO_CONCILIACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LANCAMENTO_CONTABIL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.LANCAMENTO_CONTABIL
  for PRODUCAO.LANCAMENTO_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LANCAMENTO_CONTABIL_AUX
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.LANCAMENTO_CONTABIL_AUX
  for PRODUCAO.LANCAMENTO_CONTABIL_AUX@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LANCAMENTO_CREDITO_PISCOFINS
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.LANCAMENTO_CREDITO_PISCOFINS
  for PRODUCAO.LANCAMENTO_CREDITO_PISCOFINS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LANCAMENTOS_PIS_COFINS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LANCAMENTOS_PIS_COFINS
  for PRODUCAO.LANCAMENTOS_PIS_COFINS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LANCTO_ATOADM_SHC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LANCTO_ATOADM_SHC
  for EMS5.LANCTO_ATOADM_SHC;

prompt
prompt Creating synonym LANCTO_CONTABIL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.LANCTO_CONTABIL
  for PRODUCAO.LANCTO_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LANCTO_CTBL
prompt ============================
prompt
create or replace synonym EMS506UNICOO.LANCTO_CTBL
  for EMS5.LANCTO_CTBL;

prompt
prompt Creating synonym LANCTO_CTBL_PADR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.LANCTO_CTBL_PADR
  for EMS5.LANCTO_CTBL_PADR;

prompt
prompt Creating synonym LANCTO_PADR_EMPRES_SHC
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LANCTO_PADR_EMPRES_SHC
  for EMS5.LANCTO_PADR_EMPRES_SHC;

prompt
prompt Creating synonym LANCTO_SPED_OPERADORAS_PLANO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.LANCTO_SPED_OPERADORAS_PLANO
  for PRODUCAO.LANCTO_SPED_OPERADORAS_PLANO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LASTRO_PRODUT_FINANC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.LASTRO_PRODUT_FINANC
  for EMS5.LASTRO_PRODUT_FINANC;

prompt
prompt Creating synonym LAYOUT
prompt =======================
prompt
create or replace synonym EMS506UNICOO.LAYOUT
  for EMS5.LAYOUT;

prompt
prompt Creating synonym LAYOUT_ADMDRA_CARTAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_ADMDRA_CARTAO
  for EMS5.LAYOUT_ADMDRA_CARTAO;

prompt
prompt Creating synonym LAYOUT_AVISO_DB
prompt ================================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_AVISO_DB
  for EMS5.LAYOUT_AVISO_DB;

prompt
prompt Creating synonym LAYOUT_BOLETO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_BOLETO
  for EMS5.LAYOUT_BOLETO;

prompt
prompt Creating synonym LAYOUT_CCUSTO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_CCUSTO
  for EMS5.LAYOUT_CCUSTO;

prompt
prompt Creating synonym LAYOUT_CHEQ
prompt ============================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_CHEQ
  for EMS5.LAYOUT_CHEQ;

prompt
prompt Creating synonym LAYOUT_COL_FLUXO_CX
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_COL_FLUXO_CX
  for EMS5.LAYOUT_COL_FLUXO_CX;

prompt
prompt Creating synonym LAYOUT_CONCES_TELEF
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_CONCES_TELEF
  for EMS5.LAYOUT_CONCES_TELEF;

prompt
prompt Creating synonym LAYOUT_CTA_CTBL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_CTA_CTBL
  for EMS5.LAYOUT_CTA_CTBL;

prompt
prompt Creating synonym LAYOUT_DE_ARQUIVO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_DE_ARQUIVO
  for PRODUCAO.LAYOUT_DE_ARQUIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LAYOUT_DUPL
prompt ============================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_DUPL
  for EMS5.LAYOUT_DUPL;

prompt
prompt Creating synonym LAYOUT_EXTRAT
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_EXTRAT
  for EMS5.LAYOUT_EXTRAT;

prompt
prompt Creating synonym LAYOUT_FISC
prompt ============================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_FISC
  for EMS5.LAYOUT_FISC;

prompt
prompt Creating synonym LAYOUT_INTEGR_CTBL_EXT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_INTEGR_CTBL_EXT
  for EMS5.LAYOUT_INTEGR_CTBL_EXT;

prompt
prompt Creating synonym LAYOUT_INVENT
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_INVENT
  for EMS5.LAYOUT_INVENT;

prompt
prompt Creating synonym LAYOUT_MAPA_DISTRIB
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_MAPA_DISTRIB
  for EMS5.LAYOUT_MAPA_DISTRIB;

prompt
prompt Creating synonym LAYOUT_MOVTO_FLUXO_CX
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_MOVTO_FLUXO_CX
  for EMS5.LAYOUT_MOVTO_FLUXO_CX;

prompt
prompt Creating synonym LAYOUT_ORCTO_CTBL
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_ORCTO_CTBL
  for EMS5.LAYOUT_ORCTO_CTBL;

prompt
prompt Creating synonym LAYOUT_PLANILHA_VENDOR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LAYOUT_PLANILHA_VENDOR
  for EMS5.LAYOUT_PLANILHA_VENDOR;

prompt
prompt Creating synonym LAYOUTMOVTOCTACORREN
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.LAYOUTMOVTOCTACORREN
  for EMS5.LAYOUTMOVTOCTACORREN;

prompt
prompt Creating synonym LAYOUTPLANILHAORCTARIA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LAYOUTPLANILHAORCTARIA
  for EMS5.LAYOUTPLANILHAORCTARIA;

prompt
prompt Creating synonym LCST_CARGA_JULIANA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.LCST_CARGA_JULIANA
  for PRODUCAO.LCST_CARGA_JULIANA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LCST_CARGA_JULIANA_ROL_HM
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.LCST_CARGA_JULIANA_ROL_HM
  for PRODUCAO.LCST_CARGA_JULIANA_ROL_HM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LCST_PS7065DJ
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.LCST_PS7065DJ
  for PRODUCAO.LCST_PS7065DJ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LCST_ROL
prompt =========================
prompt
create or replace synonym EMS506UNICOO.LCST_ROL
  for PRODUCAO.LCST_ROL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LCST_SIB_CAD_ERRO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LCST_SIB_CAD_ERRO
  for PRODUCAO.LCST_SIB_CAD_ERRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LEFT
prompt =====================
prompt
create or replace synonym EMS506UNICOO.LEFT
  for PRODUCAO.LEFT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_AGRUP_SERVICO_DETALHE
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.LG$_AGRUP_SERVICO_DETALHE
  for PRODUCAO.LG$_AGRUP_SERVICO_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_AREA_DE_ACAO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.LG$_AREA_DE_ACAO
  for PRODUCAO.LG$_AREA_DE_ACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CONTRATO_DA_PESSOA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LG$_CONTRATO_DA_PESSOA
  for PRODUCAO.LG$_CONTRATO_DA_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CONTRATO_PADRAO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.LG$_CONTRATO_PADRAO
  for PRODUCAO.LG$_CONTRATO_PADRAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CONTROLE_GRP
prompt =================================
prompt
create or replace synonym EMS506UNICOO.LG$_CONTROLE_GRP
  for PRODUCAO.LG$_CONTROLE_GRP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CONTROLE_TAB
prompt =================================
prompt
create or replace synonym EMS506UNICOO.LG$_CONTROLE_TAB
  for PRODUCAO.LG$_CONTROLE_TAB@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CRIT_DE_FATURAMENTO_ITEMS
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.LG$_CRIT_DE_FATURAMENTO_ITEMS
  for PRODUCAO.LG$_CRIT_DE_FATURAMENTO_ITEMS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CRIT_DE_HORAEXTRA_ITEMS
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.LG$_CRIT_DE_HORAEXTRA_ITEMS
  for PRODUCAO.LG$_CRIT_DE_HORAEXTRA_ITEMS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CRIT_EVENT_PRODMED
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LG$_CRIT_EVENT_PRODMED
  for PRODUCAO.LG$_CRIT_EVENT_PRODMED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CRITERIO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.LG$_CRITERIO
  for PRODUCAO.LG$_CRITERIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CRITERIO_DE_FATURAMENTO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.LG$_CRITERIO_DE_FATURAMENTO
  for PRODUCAO.LG$_CRITERIO_DE_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CRITERIO_DE_HORAEXTRA
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.LG$_CRITERIO_DE_HORAEXTRA
  for PRODUCAO.LG$_CRITERIO_DE_HORAEXTRA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CRITERIO_EVENTO_PRODMED
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.LG$_CRITERIO_EVENTO_PRODMED
  for PRODUCAO.LG$_CRITERIO_EVENTO_PRODMED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CRITERIO_FATOR_MODERADOR
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.LG$_CRITERIO_FATOR_MODERADOR
  for PRODUCAO.LG$_CRITERIO_FATOR_MODERADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CRITERIO_FATURAMENTO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.LG$_CRITERIO_FATURAMENTO
  for PRODUCAO.LG$_CRITERIO_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CRITERIO_PAGAMENTO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LG$_CRITERIO_PAGAMENTO
  for PRODUCAO.LG$_CRITERIO_PAGAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CRITERIO_PAGAMENTO_2
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.LG$_CRITERIO_PAGAMENTO_2
  for PRODUCAO.LG$_CRITERIO_PAGAMENTO_2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CRITERIO_PAGAMENTO_ITEM_2
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.LG$_CRITERIO_PAGAMENTO_ITEM_2
  for PRODUCAO.LG$_CRITERIO_PAGAMENTO_ITEM_2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_CRITEVENTPROD
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LG$_CRITEVENTPROD
  for PRODUCAO.LG$_CRITEVENTPROD@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_DETALHE_PAGAMENTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.LG$_DETALHE_PAGAMENTO
  for PRODUCAO.LG$_DETALHE_PAGAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_ESQUEMA_PAGAMENTO_PAGAR
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.LG$_ESQUEMA_PAGAMENTO_PAGAR
  for PRODUCAO.LG$_ESQUEMA_PAGAMENTO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_EVENTO_DE_FATURAMENTO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.LG$_EVENTO_DE_FATURAMENTO
  for PRODUCAO.LG$_EVENTO_DE_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_EVENTO_PRESTADOR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.LG$_EVENTO_PRESTADOR
  for PRODUCAO.LG$_EVENTO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_FATURA_INTERCAMBIO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LG$_FATURA_INTERCAMBIO
  for PRODUCAO.LG$_FATURA_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_FATURA_INTERCAMBIO_2
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.LG$_FATURA_INTERCAMBIO_2
  for PRODUCAO.LG$_FATURA_INTERCAMBIO_2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_FECH_INTE_CONT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.LG$_FECH_INTE_CONT
  for PRODUCAO.LG$_FECH_INTE_CONT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_FORNECEDOR_TAXA_PAGAR
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.LG$_FORNECEDOR_TAXA_PAGAR
  for PRODUCAO.LG$_FORNECEDOR_TAXA_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_FUNCIONARIO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.LG$_FUNCIONARIO
  for PRODUCAO.LG$_FUNCIONARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_GUIA_DE_SERVICO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.LG$_GUIA_DE_SERVICO
  for PRODUCAO.LG$_GUIA_DE_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_HIST_BL_CONTR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LG$_HIST_BL_CONTR
  for PRODUCAO.LG$_HIST_BL_CONTR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_HIST_BLOQ_CONTRATO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LG$_HIST_BLOQ_CONTRATO
  for PRODUCAO.LG$_HIST_BLOQ_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_HIST_BQ_CONT
prompt =================================
prompt
create or replace synonym EMS506UNICOO.LG$_HIST_BQ_CONT
  for PRODUCAO.LG$_HIST_BQ_CONT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_HISTORICO_BLOQ_CONTRATO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.LG$_HISTORICO_BLOQ_CONTRATO
  for PRODUCAO.LG$_HISTORICO_BLOQ_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_HISTORICO_FORN_TAXA_PAGAR
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.LG$_HISTORICO_FORN_TAXA_PAGAR
  for PRODUCAO.LG$_HISTORICO_FORN_TAXA_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_HISTORICO_PRESTADOR
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.LG$_HISTORICO_PRESTADOR
  for PRODUCAO.LG$_HISTORICO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_INCIDENCIA_INSS
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.LG$_INCIDENCIA_INSS
  for PRODUCAO.LG$_INCIDENCIA_INSS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_INCIDENCIA_IR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LG$_INCIDENCIA_IR
  for PRODUCAO.LG$_INCIDENCIA_IR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_INCIDENCIA_ISS
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.LG$_INCIDENCIA_ISS
  for PRODUCAO.LG$_INCIDENCIA_ISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_LIMITE_FATOR_MODERADOR
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.LG$_LIMITE_FATOR_MODERADOR
  for PRODUCAO.LG$_LIMITE_FATOR_MODERADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_LOTE_GUIA
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.LG$_LOTE_GUIA
  for PRODUCAO.LG$_LOTE_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_MOVIMENTO_CAIXA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.LG$_MOVIMENTO_CAIXA
  for PRODUCAO.LG$_MOVIMENTO_CAIXA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_OCORRENCIA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.LG$_OCORRENCIA
  for PRODUCAO.LG$_OCORRENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_OCORRENCIA2
prompt ================================
prompt
create or replace synonym EMS506UNICOO.LG$_OCORRENCIA2
  for PRODUCAO.LG$_OCORRENCIA2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_PARAMETRO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.LG$_PARAMETRO
  for PRODUCAO.LG$_PARAMETRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_PERIODO_COMPETENCIA
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.LG$_PERIODO_COMPETENCIA
  for PRODUCAO.LG$_PERIODO_COMPETENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_PESSOA
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.LG$_PESSOA
  for PRODUCAO.LG$_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_POS
prompt ========================
prompt
create or replace synonym EMS506UNICOO.LG$_POS
  for PRODUCAO.LG$_POS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_POS_PRESTADOR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LG$_POS_PRESTADOR
  for PRODUCAO.LG$_POS_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_PRESTADOR
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.LG$_PRESTADOR
  for PRODUCAO.LG$_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_PRESTADOR_EVENTUAL
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LG$_PRESTADOR_EVENTUAL
  for PRODUCAO.LG$_PRESTADOR_EVENTUAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_PRESTADOR_FINAL_03_04_2013
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.LG$_PRESTADOR_FINAL_03_04_2013
  for PRODUCAO.LG$_PRESTADOR_FINAL_03_04_2013@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_REFERENCIA_PERIODO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LG$_REFERENCIA_PERIODO
  for PRODUCAO.LG$_REFERENCIA_PERIODO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_SERV_TAB_REFER
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.LG$_SERV_TAB_REFER
  for PRODUCAO.LG$_SERV_TAB_REFER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_SERVICO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.LG$_SERVICO
  for PRODUCAO.LG$_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_SERVICO_DA_CATEGORIA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.LG$_SERVICO_DA_CATEGORIA
  for PRODUCAO.LG$_SERVICO_DA_CATEGORIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_SERVICO_DA_GUIA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.LG$_SERVICO_DA_GUIA
  for PRODUCAO.LG$_SERVICO_DA_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_SERVICO_ESPECIALIDADE
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.LG$_SERVICO_ESPECIALIDADE
  for PRODUCAO.LG$_SERVICO_ESPECIALIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_SERVICO_ESPECIALISTA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.LG$_SERVICO_ESPECIALISTA
  for PRODUCAO.LG$_SERVICO_ESPECIALISTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_SERVICO_FATOR_MODERADOR
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.LG$_SERVICO_FATOR_MODERADOR
  for PRODUCAO.LG$_SERVICO_FATOR_MODERADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_SERVICO_TAB_REFER
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.LG$_SERVICO_TAB_REFER
  for PRODUCAO.LG$_SERVICO_TAB_REFER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_TABELA_REFERENCIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.LG$_TABELA_REFERENCIA
  for PRODUCAO.LG$_TABELA_REFERENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_TIPO_DE_EVENTO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.LG$_TIPO_DE_EVENTO
  for PRODUCAO.LG$_TIPO_DE_EVENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_TIPO_DE_FATURAMENTO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.LG$_TIPO_DE_FATURAMENTO
  for PRODUCAO.LG$_TIPO_DE_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_TIPO_EVENTO_FATURAMENTO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.LG$_TIPO_EVENTO_FATURAMENTO
  for PRODUCAO.LG$_TIPO_EVENTO_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_TITULO_A_PAGAR
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.LG$_TITULO_A_PAGAR
  for PRODUCAO.LG$_TITULO_A_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_TITULO_A_RECEBER
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.LG$_TITULO_A_RECEBER
  for PRODUCAO.LG$_TITULO_A_RECEBER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_USUARIO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.LG$_USUARIO
  for PRODUCAO.LG$_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LG$_V_PER_DO_GRUPO_CONFIG
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.LG$_V_PER_DO_GRUPO_CONFIG
  for PRODUCAO.LG$_V_PER_DO_GRUPO_CONFIG@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIBERACAO_ATENDIMENTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.LIBERACAO_ATENDIMENTO
  for PRODUCAO.LIBERACAO_ATENDIMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIBERACAO_AUTORIZ_TRAT_ESPEC
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.LIBERACAO_AUTORIZ_TRAT_ESPEC
  for PRODUCAO.LIBERACAO_AUTORIZ_TRAT_ESPEC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LICENC_USO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.LICENC_USO
  for EMS5.LICENC_USO;

prompt
prompt Creating synonym LICENSE_SERVER
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.LICENSE_SERVER
  for PRODUCAO.LICENSE_SERVER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIM_JUSTIF
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.LIM_JUSTIF
  for EMS5.LIM_JUSTIF;

prompt
prompt Creating synonym LIMITE_ADITIVO_CONTRATUAL
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.LIMITE_ADITIVO_CONTRATUAL
  for PRODUCAO.LIMITE_ADITIVO_CONTRATUAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIMITE_CARENCIA_PROPOSTA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.LIMITE_CARENCIA_PROPOSTA
  for PRODUCAO.LIMITE_CARENCIA_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIMITE_CONTRATO_TIPO_AUTORIZ
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.LIMITE_CONTRATO_TIPO_AUTORIZ
  for PRODUCAO.LIMITE_CONTRATO_TIPO_AUTORIZ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIMITE_CRITERIO_ADITIVO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.LIMITE_CRITERIO_ADITIVO
  for PRODUCAO.LIMITE_CRITERIO_ADITIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIMITE_DE_IDADE
prompt ================================
prompt
create or replace synonym EMS506UNICOO.LIMITE_DE_IDADE
  for PRODUCAO.LIMITE_DE_IDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIMITE_DE_IDADE_CONTR_PES
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.LIMITE_DE_IDADE_CONTR_PES
  for PRODUCAO.LIMITE_DE_IDADE_CONTR_PES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIMITE_DE_SERVICO_IDADE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.LIMITE_DE_SERVICO_IDADE
  for PRODUCAO.LIMITE_DE_SERVICO_IDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIMITE_DO_CRITERIO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.LIMITE_DO_CRITERIO
  for PRODUCAO.LIMITE_DO_CRITERIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIMITE_DO_CRITERIO_CONTR_PES
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.LIMITE_DO_CRITERIO_CONTR_PES
  for PRODUCAO.LIMITE_DO_CRITERIO_CONTR_PES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIMITE_DO_SERVICO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LIMITE_DO_SERVICO
  for PRODUCAO.LIMITE_DO_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIMITE_DO_SERVICO_CONTR_PES
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.LIMITE_DO_SERVICO_CONTR_PES
  for PRODUCAO.LIMITE_DO_SERVICO_CONTR_PES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIMITE_FATOR_MODERADOR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LIMITE_FATOR_MODERADOR
  for PRODUCAO.LIMITE_FATOR_MODERADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIMITE_TECNICO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.LIMITE_TECNICO
  for PRODUCAO.LIMITE_TECNICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIN_EXTRAT_CTA_CORREN
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.LIN_EXTRAT_CTA_CORREN
  for EMS5.LIN_EXTRAT_CTA_CORREN;

prompt
prompt Creating synonym LIN_LAYOUT_BOLETO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LIN_LAYOUT_BOLETO
  for EMS5.LIN_LAYOUT_BOLETO;

prompt
prompt Creating synonym LIN_LAYOUT_CCUSTO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LIN_LAYOUT_CCUSTO
  for EMS5.LIN_LAYOUT_CCUSTO;

prompt
prompt Creating synonym LIN_LAYOUT_CHEQ
prompt ================================
prompt
create or replace synonym EMS506UNICOO.LIN_LAYOUT_CHEQ
  for EMS5.LIN_LAYOUT_CHEQ;

prompt
prompt Creating synonym LIN_LAYOUT_CTA_CTBL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.LIN_LAYOUT_CTA_CTBL
  for EMS5.LIN_LAYOUT_CTA_CTBL;

prompt
prompt Creating synonym LIN_LAYOUT_DUPL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.LIN_LAYOUT_DUPL
  for EMS5.LIN_LAYOUT_DUPL;

prompt
prompt Creating synonym LIN_LAYOUT_INVENT
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LIN_LAYOUT_INVENT
  for EMS5.LIN_LAYOUT_INVENT;

prompt
prompt Creating synonym LIN_LAYOUT_MOVTO_CTA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.LIN_LAYOUT_MOVTO_CTA
  for EMS5.LIN_LAYOUT_MOVTO_CTA;

prompt
prompt Creating synonym LIN_LAYOUT_MOVTO_FLUXO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LIN_LAYOUT_MOVTO_FLUXO
  for EMS5.LIN_LAYOUT_MOVTO_FLUXO;

prompt
prompt Creating synonym LIN_LAYOUT_ORCTO_CTBL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.LIN_LAYOUT_ORCTO_CTBL
  for EMS5.LIN_LAYOUT_ORCTO_CTBL;

prompt
prompt Creating synonym LINHA_TABELA_TEXTO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.LINHA_TABELA_TEXTO
  for PRODUCAO.LINHA_TABELA_TEXTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LINLAYOUTADMDRACARTAO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.LINLAYOUTADMDRACARTAO
  for EMS5.LINLAYOUTADMDRACARTAO;

prompt
prompt Creating synonym LINLAYOUTCONCESTELEF
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.LINLAYOUTCONCESTELEF
  for EMS5.LINLAYOUTCONCESTELEF;

prompt
prompt Creating synonym LINLAYOUTMAPADISTRIB
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.LINLAYOUTMAPADISTRIB
  for EMS5.LINLAYOUTMAPADISTRIB;

prompt
prompt Creating synonym LISTA_ACES_DEMONST
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.LISTA_ACES_DEMONST
  for EMS5.LISTA_ACES_DEMONST;

prompt
prompt Creating synonym LISTA_INVENT_BEM_PAT
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.LISTA_INVENT_BEM_PAT
  for EMS5.LISTA_INVENT_BEM_PAT;

prompt
prompt Creating synonym LISTA_TRAB_INVENT
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LISTA_TRAB_INVENT
  for EMS5.LISTA_TRAB_INVENT;

prompt
prompt Creating synonym LIVRO_CONTROLE_CREDITO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.LIVRO_CONTROLE_CREDITO
  for PRODUCAO.LIVRO_CONTROLE_CREDITO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIVRO_FISC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.LIVRO_FISC
  for EMS5.LIVRO_FISC;

prompt
prompt Creating synonym LIVRO_FISCAL_GUIA_RECOLHIMENTO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.LIVRO_FISCAL_GUIA_RECOLHIMENTO
  for PRODUCAO.LIVRO_FISCAL_GUIA_RECOLHIMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIVRO_NOTA_FISCAL
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LIVRO_NOTA_FISCAL
  for PRODUCAO.LIVRO_NOTA_FISCAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIVRO_UTILIZACAO_CREDITO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.LIVRO_UTILIZACAO_CREDITO
  for PRODUCAO.LIVRO_UTILIZACAO_CREDITO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LIVROFISCMOVTOTITACR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.LIVROFISCMOVTOTITACR
  for EMS5.LIVROFISCMOVTOTITACR;

prompt
prompt Creating synonym LOCAL_CONEXAO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.LOCAL_CONEXAO
  for PRODUCAO.LOCAL_CONEXAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOCAL_EMISSAO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.LOCAL_EMISSAO
  for PRODUCAO.LOCAL_EMISSAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOCALEMBARQVIAGEMEEC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.LOCALEMBARQVIAGEMEEC
  for EMS5.LOCALEMBARQVIAGEMEEC;

prompt
prompt Creating synonym LOCALID_CONCES
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.LOCALID_CONCES
  for EMS5.LOCALID_CONCES;

prompt
prompt Creating synonym LOCALID_TELEBRAS
prompt =================================
prompt
create or replace synonym EMS506UNICOO.LOCALID_TELEBRAS
  for EMS5.LOCALID_TELEBRAS;

prompt
prompt Creating synonym LOCALIZ_ARQ_EDI
prompt ================================
prompt
create or replace synonym EMS506UNICOO.LOCALIZ_ARQ_EDI
  for EMS5.LOCALIZ_ARQ_EDI;

prompt
prompt Creating synonym LOCALIZ_LANCTO_CTBL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.LOCALIZ_LANCTO_CTBL
  for EMS5.LOCALIZ_LANCTO_CTBL;

prompt
prompt Creating synonym LOCALIZACAO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.LOCALIZACAO
  for EMS5.LOCALIZACAO;

prompt
prompt Creating synonym LOG_BCO_HISTOR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.LOG_BCO_HISTOR
  for EMS5.LOG_BCO_HISTOR;

prompt
prompt Creating synonym LOG_BCO_HISTOR_MOVTO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.LOG_BCO_HISTOR_MOVTO
  for EMS5.LOG_BCO_HISTOR_MOVTO;

prompt
prompt Creating synonym LOG_MOV_USUARIO_PRODUTO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.LOG_MOV_USUARIO_PRODUTO
  for PRODUCAO.LOG_MOV_USUARIO_PRODUTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOG_MSG_ENVDA_EDI
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LOG_MSG_ENVDA_EDI
  for EMS5.LOG_MSG_ENVDA_EDI;

prompt
prompt Creating synonym LOTACAO
prompt ========================
prompt
create or replace synonym EMS506UNICOO.LOTACAO
  for PRODUCAO.LOTACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOTACAO_HISTORICO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LOTACAO_HISTORICO
  for PRODUCAO.LOTACAO_HISTORICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOTE_CARTA_EMITIDA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.LOTE_CARTA_EMITIDA
  for PRODUCAO.LOTE_CARTA_EMITIDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOTE_CONTABIL
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.LOTE_CONTABIL
  for PRODUCAO.LOTE_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOTE_CTBL
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.LOTE_CTBL
  for EMS5.LOTE_CTBL;

prompt
prompt Creating synonym LOTE_CTBL_PLANT
prompt ================================
prompt
create or replace synonym EMS506UNICOO.LOTE_CTBL_PLANT
  for EMS5.LOTE_CTBL_PLANT;

prompt
prompt Creating synonym LOTE_DE_INTEGRACAO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.LOTE_DE_INTEGRACAO
  for PRODUCAO.LOTE_DE_INTEGRACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOTE_DE_INTEGRACAO_2
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.LOTE_DE_INTEGRACAO_2
  for PRODUCAO.LOTE_DE_INTEGRACAO_2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOTE_FATURAMENTO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.LOTE_FATURAMENTO
  for PRODUCAO.LOTE_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOTE_FATURAMENTO_CONTROLE
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.LOTE_FATURAMENTO_CONTROLE
  for PRODUCAO.LOTE_FATURAMENTO_CONTROLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOTE_FATURAMENTO_DETALHE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.LOTE_FATURAMENTO_DETALHE
  for PRODUCAO.LOTE_FATURAMENTO_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOTE_GUIA
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.LOTE_GUIA
  for PRODUCAO.LOTE_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOTE_IMPL_TIT_ACR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LOTE_IMPL_TIT_ACR
  for EMS5.LOTE_IMPL_TIT_ACR;

prompt
prompt Creating synonym LOTE_IMPL_TIT_AP
prompt =================================
prompt
create or replace synonym EMS506UNICOO.LOTE_IMPL_TIT_AP
  for EMS5.LOTE_IMPL_TIT_AP;

prompt
prompt Creating synonym LOTE_IMPOSTO_GERADO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.LOTE_IMPOSTO_GERADO
  for PRODUCAO.LOTE_IMPOSTO_GERADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOTE_LIQUIDAC_ACR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.LOTE_LIQUIDAC_ACR
  for EMS5.LOTE_LIQUIDAC_ACR;

prompt
prompt Creating synonym LOTE_LIQUIDAC_VENDOR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.LOTE_LIQUIDAC_VENDOR
  for EMS5.LOTE_LIQUIDAC_VENDOR;

prompt
prompt Creating synonym LOTE_MATERIAL_REC_CONTROLADO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.LOTE_MATERIAL_REC_CONTROLADO
  for PRODUCAO.LOTE_MATERIAL_REC_CONTROLADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOTE_MOV_HISTORICO_PAGAR
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.LOTE_MOV_HISTORICO_PAGAR
  for PRODUCAO.LOTE_MOV_HISTORICO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOTE_MOV_HISTORICO_RECEBER
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.LOTE_MOV_HISTORICO_RECEBER
  for PRODUCAO.LOTE_MOV_HISTORICO_RECEBER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym LOTE_ORCTO_CTBL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.LOTE_ORCTO_CTBL
  for EMS5.LOTE_ORCTO_CTBL;

prompt
prompt Creating synonym LOTE_PAGTO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.LOTE_PAGTO
  for EMS5.LOTE_PAGTO;

prompt
prompt Creating synonym MANUAL_DOCUMEN
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.MANUAL_DOCUMEN
  for EMS5.MANUAL_DOCUMEN;

prompt
prompt Creating synonym MANUAL_DOCUMEN_IDIOM
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.MANUAL_DOCUMEN_IDIOM
  for EMS5.MANUAL_DOCUMEN_IDIOM;

prompt
prompt Creating synonym MANUAL_TOPIC_ESTIL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.MANUAL_TOPIC_ESTIL
  for EMS5.MANUAL_TOPIC_ESTIL;

prompt
prompt Creating synonym MANUALTOPICESTILIDIOM
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MANUALTOPICESTILIDIOM
  for EMS5.MANUALTOPICESTILIDIOM;

prompt
prompt Creating synonym MAPA_DISTRIB_CCUSTO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MAPA_DISTRIB_CCUSTO
  for EMS5.MAPA_DISTRIB_CCUSTO;

prompt
prompt Creating synonym MAPA_DISTRIB_GERC_CTBL
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MAPA_DISTRIB_GERC_CTBL
  for EMS5.MAPA_DISTRIB_GERC_CTBL;

prompt
prompt Creating synonym MAPA_EDI
prompt =========================
prompt
create or replace synonym EMS506UNICOO.MAPA_EDI
  for EMS5.MAPA_EDI;

prompt
prompt Creating synonym MAPA_MOVTO_BEM_PAT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.MAPA_MOVTO_BEM_PAT
  for EMS5.MAPA_MOVTO_BEM_PAT;

prompt
prompt Creating synonym MAPA_RESUMO_ECF
prompt ================================
prompt
create or replace synonym EMS506UNICOO.MAPA_RESUMO_ECF
  for PRODUCAO.MAPA_RESUMO_ECF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MAPA_SEGMENT_EDI
prompt =================================
prompt
create or replace synonym EMS506UNICOO.MAPA_SEGMENT_EDI
  for EMS5.MAPA_SEGMENT_EDI;

prompt
prompt Creating synonym MAPA_SEGMENT_EQUIV_EDI
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MAPA_SEGMENT_EQUIV_EDI
  for EMS5.MAPA_SEGMENT_EQUIV_EDI;

prompt
prompt Creating synonym MAPA_TIP_REG_EXTRAT
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MAPA_TIP_REG_EXTRAT
  for EMS5.MAPA_TIP_REG_EXTRAT;

prompt
prompt Creating synonym MAPA_TIP_REG_LAYOUT
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MAPA_TIP_REG_LAYOUT
  for EMS5.MAPA_TIP_REG_LAYOUT;

prompt
prompt Creating synonym MAPASEGMENTELEMENTEDI
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MAPASEGMENTELEMENTEDI
  for EMS5.MAPASEGMENTELEMENTEDI;

prompt
prompt Creating synonym MARCA
prompt ======================
prompt
create or replace synonym EMS506UNICOO.MARCA
  for EMS5.MARCA;

prompt
prompt Creating synonym MAT_MED_SERVICO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.MAT_MED_SERVICO
  for PRODUCAO.MAT_MED_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATERIAL
prompt =========================
prompt
create or replace synonym EMS506UNICOO.MATERIAL
  for PRODUCAO.MATERIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATERIAL_1
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.MATERIAL_1
  for PRODUCAO.MATERIAL_1@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATERIAL_2
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.MATERIAL_2
  for PRODUCAO.MATERIAL_2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATERIAL_3
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.MATERIAL_3
  for PRODUCAO.MATERIAL_3@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATERIAL_CODIGO_BARRAS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MATERIAL_CODIGO_BARRAS
  for PRODUCAO.MATERIAL_CODIGO_BARRAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATERIAL_EMPRESA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.MATERIAL_EMPRESA
  for PRODUCAO.MATERIAL_EMPRESA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATERIAL_EVENTUAL
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.MATERIAL_EVENTUAL
  for PRODUCAO.MATERIAL_EVENTUAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATERIAL_EVENTUAL_EMPRESA
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.MATERIAL_EVENTUAL_EMPRESA
  for PRODUCAO.MATERIAL_EVENTUAL_EMPRESA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATERIAL_EVENTUAL_PIS_COFINS
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.MATERIAL_EVENTUAL_PIS_COFINS
  for PRODUCAO.MATERIAL_EVENTUAL_PIS_COFINS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATERIAL_NOTA_FISCAL_ENTRADA
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.MATERIAL_NOTA_FISCAL_ENTRADA
  for PRODUCAO.MATERIAL_NOTA_FISCAL_ENTRADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATERIAL_NOTA_FISCAL_VENDAS
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.MATERIAL_NOTA_FISCAL_VENDAS
  for PRODUCAO.MATERIAL_NOTA_FISCAL_VENDAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATERIAL_PEDIDO_VENDAS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MATERIAL_PEDIDO_VENDAS
  for PRODUCAO.MATERIAL_PEDIDO_VENDAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATERIAL_PIS_COFINS
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MATERIAL_PIS_COFINS
  for PRODUCAO.MATERIAL_PIS_COFINS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATERIAL_PLANO_TABELA_VENDAS
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.MATERIAL_PLANO_TABELA_VENDAS
  for PRODUCAO.MATERIAL_PLANO_TABELA_VENDAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_ABCFARMA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.MATMED_ABCFARMA
  for PRODUCAO.MATMED_ABCFARMA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_BRASINDICE
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.MATMED_BRASINDICE
  for PRODUCAO.MATMED_BRASINDICE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_INTERCAMBIO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.MATMED_INTERCAMBIO
  for PRODUCAO.MATMED_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_INTERCAMBIO2
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MATMED_INTERCAMBIO2
  for PRODUCAO.MATMED_INTERCAMBIO2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_INTERCAMBIO_BCK
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MATMED_INTERCAMBIO_BCK
  for PRODUCAO.MATMED_INTERCAMBIO_BCK@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_MAPEAMENTO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.MATMED_MAPEAMENTO
  for PRODUCAO.MATMED_MAPEAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_MEDICAMENTO_TISS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.MATMED_MEDICAMENTO_TISS
  for PRODUCAO.MATMED_MEDICAMENTO_TISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_MEDICAMENTO_TISS_COPIA
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.MATMED_MEDICAMENTO_TISS_COPIA
  for PRODUCAO.MATMED_MEDICAMENTO_TISS_COPIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_OPME_TISS
prompt =================================
prompt
create or replace synonym EMS506UNICOO.MATMED_OPME_TISS
  for PRODUCAO.MATMED_OPME_TISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_OPME_TISS_COPIA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MATMED_OPME_TISS_COPIA
  for PRODUCAO.MATMED_OPME_TISS_COPIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_SERVICO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.MATMED_SERVICO
  for PRODUCAO.MATMED_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_SERVICO_BCK
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.MATMED_SERVICO_BCK
  for PRODUCAO.MATMED_SERVICO_BCK@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_SERVICO_ESTOQUE
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MATMED_SERVICO_ESTOQUE
  for PRODUCAO.MATMED_SERVICO_ESTOQUE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_SIMPRO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.MATMED_SIMPRO
  for PRODUCAO.MATMED_SIMPRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_UNIDADE_CONVERSAO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.MATMED_UNIDADE_CONVERSAO
  for PRODUCAO.MATMED_UNIDADE_CONVERSAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATMED_UNIDADE_MEDIDA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MATMED_UNIDADE_MEDIDA
  for PRODUCAO.MATMED_UNIDADE_MEDIDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MATRIZ_TRAD_CCUSTO_EXT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MATRIZ_TRAD_CCUSTO_EXT
  for EMS5.MATRIZ_TRAD_CCUSTO_EXT;

prompt
prompt Creating synonym MATRIZ_TRAD_CTA_CORREN
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MATRIZ_TRAD_CTA_CORREN
  for EMS5.MATRIZ_TRAD_CTA_CORREN;

prompt
prompt Creating synonym MATRIZ_TRAD_FLUXO_EXT
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MATRIZ_TRAD_FLUXO_EXT
  for EMS5.MATRIZ_TRAD_FLUXO_EXT;

prompt
prompt Creating synonym MATRIZ_TRAD_ORG_EXT
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MATRIZ_TRAD_ORG_EXT
  for EMS5.MATRIZ_TRAD_ORG_EXT;

prompt
prompt Creating synonym MATRIZ_TRAD_PAIS_EXT
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.MATRIZ_TRAD_PAIS_EXT
  for EMS5.MATRIZ_TRAD_PAIS_EXT;

prompt
prompt Creating synonym MATRIZ_TRAD_PORTAD_EXT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MATRIZ_TRAD_PORTAD_EXT
  for EMS5.MATRIZ_TRAD_PORTAD_EXT;

prompt
prompt Creating synonym MATRIZTRADCTACTBLEXT
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.MATRIZTRADCTACTBLEXT
  for EMS5.MATRIZTRADCTACTBLEXT;

prompt
prompt Creating synonym MATRIZTRADCTAPATEXT
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MATRIZTRADCTAPATEXT
  for EMS5.MATRIZTRADCTAPATEXT;

prompt
prompt Creating synonym MATRIZTRADFINALIDEXT
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.MATRIZTRADFINALIDEXT
  for EMS5.MATRIZTRADFINALIDEXT;

prompt
prompt Creating synonym MEDICAMENTOS_3
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.MEDICAMENTOS_3
  for PRODUCAO.MEDICAMENTOS_3@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MEDIDITEMREGRARANKING
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MEDIDITEMREGRARANKING
  for EMS5.MEDIDITEMREGRARANKING;

prompt
prompt Creating synonym MEIO_SOLICITACAO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.MEIO_SOLICITACAO
  for PRODUCAO.MEIO_SOLICITACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MENSAGEM_CONTRATO_PADRAO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.MENSAGEM_CONTRATO_PADRAO
  for PRODUCAO.MENSAGEM_CONTRATO_PADRAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MENSAGEM_CONTRATO_PESSOA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.MENSAGEM_CONTRATO_PESSOA
  for PRODUCAO.MENSAGEM_CONTRATO_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MENSAGEM_DE_RELATORIO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MENSAGEM_DE_RELATORIO
  for PRODUCAO.MENSAGEM_DE_RELATORIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MENSAGEM_DE_RELATORIO_DETALHE
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.MENSAGEM_DE_RELATORIO_DETALHE
  for PRODUCAO.MENSAGEM_DE_RELATORIO_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MENSAGEM_FAMILIA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.MENSAGEM_FAMILIA
  for PRODUCAO.MENSAGEM_FAMILIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MENSAGEM_GUIA_CONTRATO_PADRAO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.MENSAGEM_GUIA_CONTRATO_PADRAO
  for PRODUCAO.MENSAGEM_GUIA_CONTRATO_PADRAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MENSAGEM_INTEGRACAO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MENSAGEM_INTEGRACAO
  for PRODUCAO.MENSAGEM_INTEGRACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MENSAGEM_RODAPE_FATURA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MENSAGEM_RODAPE_FATURA
  for PRODUCAO.MENSAGEM_RODAPE_FATURA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MENSAGEM_TELE
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.MENSAGEM_TELE
  for PRODUCAO.MENSAGEM_TELE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MENSAGEM_USUARIO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.MENSAGEM_USUARIO
  for PRODUCAO.MENSAGEM_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MENSAGEM_USUARIO_PRODMED
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.MENSAGEM_USUARIO_PRODMED
  for PRODUCAO.MENSAGEM_USUARIO_PRODMED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MENSAGENS_POS
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.MENSAGENS_POS
  for PRODUCAO.MENSAGENS_POS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MENU_INFORMENGE
prompt ================================
prompt
create or replace synonym EMS506UNICOO.MENU_INFORMENGE
  for PRODUCAO.MENU_INFORMENGE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MERENDA1
prompt =========================
prompt
create or replace synonym EMS506UNICOO.MERENDA1
  for PRODUCAO.MERENDA1@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MES_EXTENSO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.MES_EXTENSO
  for PRODUCAO.MES_EXTENSO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym METOD_CALC_DPR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.METOD_CALC_DPR
  for EMS5.METOD_CALC_DPR;

prompt
prompt Creating synonym METOD_CALC_VENDOR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.METOD_CALC_VENDOR
  for EMS5.METOD_CALC_VENDOR;

prompt
prompt Creating synonym MEU_PRECO
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.MEU_PRECO
  for PRODUCAO.MEU_PRECO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOD_11
prompt =======================
prompt
create or replace synonym EMS506UNICOO.MOD_11
  for PRODUCAO.MOD_11@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOD_PENDENTE
prompt =============================
prompt
create or replace synonym EMS506UNICOO.MOD_PENDENTE
  for PRODUCAO.MOD_PENDENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODELO
prompt =======================
prompt
create or replace synonym EMS506UNICOO.MODELO
  for EMS5.MODELO;

prompt
prompt Creating synonym MODELO_CARTEIRA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.MODELO_CARTEIRA
  for PRODUCAO.MODELO_CARTEIRA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODELO_CHEQUE
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.MODELO_CHEQUE
  for PRODUCAO.MODELO_CHEQUE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODELO_EMAIL_NOTIFIC_PAGTO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.MODELO_EMAIL_NOTIFIC_PAGTO
  for PRODUCAO.MODELO_EMAIL_NOTIFIC_PAGTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODELO_FOLHA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.MODELO_FOLHA
  for PRODUCAO.MODELO_FOLHA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODELO_FOLHA_TIPO_PRESTADOR
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.MODELO_FOLHA_TIPO_PRESTADOR
  for PRODUCAO.MODELO_FOLHA_TIPO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODELO_FPG_COLUNA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.MODELO_FPG_COLUNA
  for PRODUCAO.MODELO_FPG_COLUNA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODELO_FPG_COLUNA_EVENTO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.MODELO_FPG_COLUNA_EVENTO
  for PRODUCAO.MODELO_FPG_COLUNA_EVENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODELO_IMPRESSAO_CHEQUE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.MODELO_IMPRESSAO_CHEQUE
  for PRODUCAO.MODELO_IMPRESSAO_CHEQUE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODUL_GRP_USUAR_EDI
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MODUL_GRP_USUAR_EDI
  for EMS5.MODUL_GRP_USUAR_EDI;

prompt
prompt Creating synonym MODUL_USUAR_MESTRE_EDI
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MODUL_USUAR_MESTRE_EDI
  for EMS5.MODUL_USUAR_MESTRE_EDI;

prompt
prompt Creating synonym MODULO10
prompt =========================
prompt
create or replace synonym EMS506UNICOO.MODULO10
  for PRODUCAO.MODULO10@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODULO11
prompt =========================
prompt
create or replace synonym EMS506UNICOO.MODULO11
  for PRODUCAO.MODULO11@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODULO11_237_BRADESCO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MODULO11_237_BRADESCO
  for PRODUCAO.MODULO11_237_BRADESCO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODULO11_399_HSBC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.MODULO11_399_HSBC
  for PRODUCAO.MODULO11_399_HSBC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODULO11_422_SAFRA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.MODULO11_422_SAFRA
  for PRODUCAO.MODULO11_422_SAFRA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODULO11_BB
prompt ============================
prompt
create or replace synonym EMS506UNICOO.MODULO11_BB
  for PRODUCAO.MODULO11_BB@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODULO11_BIC
prompt =============================
prompt
create or replace synonym EMS506UNICOO.MODULO11_BIC
  for PRODUCAO.MODULO11_BIC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODULO11_CEF
prompt =============================
prompt
create or replace synonym EMS506UNICOO.MODULO11_CEF
  for PRODUCAO.MODULO11_CEF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MODULO11_OPC
prompt =============================
prompt
create or replace synonym EMS506UNICOO.MODULO11_OPC
  for PRODUCAO.MODULO11_OPC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOTIV_ALTER_VERBA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.MOTIV_ALTER_VERBA
  for EMS5.MOTIV_ALTER_VERBA;

prompt
prompt Creating synonym MOTIV_CANCEL_CARTCRED
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MOTIV_CANCEL_CARTCRED
  for EMS5.MOTIV_CANCEL_CARTCRED;

prompt
prompt Creating synonym MOTIV_DESMOB
prompt =============================
prompt
create or replace synonym EMS506UNICOO.MOTIV_DESMOB
  for EMS5.MOTIV_DESMOB;

prompt
prompt Creating synonym MOTIV_DEVOL_CHEQ
prompt =================================
prompt
create or replace synonym EMS506UNICOO.MOTIV_DEVOL_CHEQ
  for EMS5.MOTIV_DEVOL_CHEQ;

prompt
prompt Creating synonym MOTIV_MOVTO_COMIS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.MOTIV_MOVTO_COMIS
  for EMS5.MOTIV_MOVTO_COMIS;

prompt
prompt Creating synonym MOTIV_MOVTO_INADIMP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MOTIV_MOVTO_INADIMP
  for EMS5.MOTIV_MOVTO_INADIMP;

prompt
prompt Creating synonym MOTIV_MOVTO_TIT_ACR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MOTIV_MOVTO_TIT_ACR
  for EMS5.MOTIV_MOVTO_TIT_ACR;

prompt
prompt Creating synonym MOTIV_REJ_BCO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.MOTIV_REJ_BCO
  for EMS5.MOTIV_REJ_BCO;

prompt
prompt Creating synonym MOTIV_REJ_CONCES_TELEF
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MOTIV_REJ_CONCES_TELEF
  for EMS5.MOTIV_REJ_CONCES_TELEF;

prompt
prompt Creating synonym MOTIV_REJ_ESPEC_DOCTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MOTIV_REJ_ESPEC_DOCTO
  for EMS5.MOTIV_REJ_ESPEC_DOCTO;

prompt
prompt Creating synonym MOTIV_SIT_ACAOCAP
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.MOTIV_SIT_ACAOCAP
  for EMS5.MOTIV_SIT_ACAOCAP;

prompt
prompt Creating synonym MOTIVO_AUTORIZACAO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.MOTIVO_AUTORIZACAO
  for PRODUCAO.MOTIVO_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOTIVO_CANCELA_TITULO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MOTIVO_CANCELA_TITULO
  for PRODUCAO.MOTIVO_CANCELA_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOTIVO_CANCELAMENTO_AG_CM
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.MOTIVO_CANCELAMENTO_AG_CM
  for PRODUCAO.MOTIVO_CANCELAMENTO_AG_CM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOTIVO_DE_CANCELAMENTO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MOTIVO_DE_CANCELAMENTO
  for PRODUCAO.MOTIVO_DE_CANCELAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOTIVO_GLOSA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.MOTIVO_GLOSA
  for PRODUCAO.MOTIVO_GLOSA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOTIVO_LIBERACAO_ATENDIMENTO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.MOTIVO_LIBERACAO_ATENDIMENTO
  for PRODUCAO.MOTIVO_LIBERACAO_ATENDIMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOTIVO_QUESTIONAMENTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MOTIVO_QUESTIONAMENTO
  for PRODUCAO.MOTIVO_QUESTIONAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOTIVO_SAIDA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.MOTIVO_SAIDA
  for PRODUCAO.MOTIVO_SAIDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOTIVREJADMDRACARTAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.MOTIVREJADMDRACARTAO
  for EMS5.MOTIVREJADMDRACARTAO;

prompt
prompt Creating synonym MOTIVREJCOBRESPECIAL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.MOTIVREJCOBRESPECIAL
  for EMS5.MOTIVREJCOBRESPECIAL;

prompt
prompt Creating synonym MOV_AFASTAMENTO_PRESTADOR
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.MOV_AFASTAMENTO_PRESTADOR
  for PRODUCAO.MOV_AFASTAMENTO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOV_CONTRATO_DA_PESSOA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MOV_CONTRATO_DA_PESSOA
  for PRODUCAO.MOV_CONTRATO_DA_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOV_ENDERECO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.MOV_ENDERECO
  for PRODUCAO.MOV_ENDERECO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOV_ESPECIALISTA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.MOV_ESPECIALISTA
  for PRODUCAO.MOV_ESPECIALISTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOV_PESSOA
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.MOV_PESSOA
  for PRODUCAO.MOV_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOV_PREST_10
prompt =============================
prompt
create or replace synonym EMS506UNICOO.MOV_PREST_10
  for PRODUCAO.MOV_PREST_10@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOV_PRESTADOR
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.MOV_PRESTADOR
  for PRODUCAO.MOV_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOV_SERV_OPC_CONTRATO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MOV_SERV_OPC_CONTRATO
  for PRODUCAO.MOV_SERV_OPC_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOV_SERV_OPC_FAMILIA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.MOV_SERV_OPC_FAMILIA
  for PRODUCAO.MOV_SERV_OPC_FAMILIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOV_SERVICO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.MOV_SERVICO
  for PRODUCAO.MOV_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOV_SERVICO_TAB_REFER
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MOV_SERVICO_TAB_REFER
  for PRODUCAO.MOV_SERVICO_TAB_REFER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOV_USUARIO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.MOV_USUARIO
  for PRODUCAO.MOV_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOVIMENTO_AVULSO_LIVRO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MOVIMENTO_AVULSO_LIVRO
  for PRODUCAO.MOVIMENTO_AVULSO_LIVRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOVIMENTO_CAIXA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.MOVIMENTO_CAIXA
  for PRODUCAO.MOVIMENTO_CAIXA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOVIMENTO_CAIXA_DOCTO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MOVIMENTO_CAIXA_DOCTO
  for PRODUCAO.MOVIMENTO_CAIXA_DOCTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOVIMENTO_CONCILIACAO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MOVIMENTO_CONCILIACAO
  for PRODUCAO.MOVIMENTO_CONCILIACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOVIMENTO_PREST_DET_CXU
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.MOVIMENTO_PREST_DET_CXU
  for PRODUCAO.MOVIMENTO_PREST_DET_CXU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MOVTO_ACAOCAP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.MOVTO_ACAOCAP
  for EMS5.MOVTO_ACAOCAP;

prompt
prompt Creating synonym MOVTO_BEM_PAT
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.MOVTO_BEM_PAT
  for EMS5.MOVTO_BEM_PAT;

prompt
prompt Creating synonym MOVTO_BEM_VIAGEM_EEC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_BEM_VIAGEM_EEC
  for EMS5.MOVTO_BEM_VIAGEM_EEC;

prompt
prompt Creating synonym MOVTO_BLOQ_ACAOCAP
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_BLOQ_ACAOCAP
  for EMS5.MOVTO_BLOQ_ACAOCAP;

prompt
prompt Creating synonym MOVTO_CENAR_BEM_PAT
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_CENAR_BEM_PAT
  for EMS5.MOVTO_CENAR_BEM_PAT;

prompt
prompt Creating synonym MOVTO_COBR_TIT_ACR
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_COBR_TIT_ACR
  for EMS5.MOVTO_COBR_TIT_ACR;

prompt
prompt Creating synonym MOVTO_COBR_TIT_INADIMP
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_COBR_TIT_INADIMP
  for EMS5.MOVTO_COBR_TIT_INADIMP;

prompt
prompt Creating synonym MOVTO_COMIS_REPRES
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_COMIS_REPRES
  for EMS5.MOVTO_COMIS_REPRES;

prompt
prompt Creating synonym MOVTO_CTA_CORREN
prompt =================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_CTA_CORREN
  for EMS5.MOVTO_CTA_CORREN;

prompt
prompt Creating synonym MOVTO_CTA_CORREN_SINT
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_CTA_CORREN_SINT
  for EMS5.MOVTO_CTA_CORREN_SINT;

prompt
prompt Creating synonym MOVTO_CX_FINANC
prompt ================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_CX_FINANC
  for EMS5.MOVTO_CX_FINANC;

prompt
prompt Creating synonym MOVTO_DESTINAC_COBR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_DESTINAC_COBR
  for EMS5.MOVTO_DESTINAC_COBR;

prompt
prompt Creating synonym MOVTO_DEVOL_CHEQ_ACR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_DEVOL_CHEQ_ACR
  for EMS5.MOVTO_DEVOL_CHEQ_ACR;

prompt
prompt Creating synonym MOVTO_DIVNDO_ACION
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_DIVNDO_ACION
  for EMS5.MOVTO_DIVNDO_ACION;

prompt
prompt Creating synonym MOVTO_FISC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.MOVTO_FISC
  for EMS5.MOVTO_FISC;

prompt
prompt Creating synonym MOVTO_FLUXO_CX
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.MOVTO_FLUXO_CX
  for EMS5.MOVTO_FLUXO_CX;

prompt
prompt Creating synonym MOVTO_IMPTO_TIT_ACR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_IMPTO_TIT_ACR
  for EMS5.MOVTO_IMPTO_TIT_ACR;

prompt
prompt Creating synonym MOVTO_ITEM_DESTINAC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_ITEM_DESTINAC
  for EMS5.MOVTO_ITEM_DESTINAC;

prompt
prompt Creating synonym MOVTO_MSG_USUAR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_MSG_USUAR
  for EMS5.MOVTO_MSG_USUAR;

prompt
prompt Creating synonym MOVTO_OCOR_BCIA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_OCOR_BCIA
  for EMS5.MOVTO_OCOR_BCIA;

prompt
prompt Creating synonym MOVTO_OPERAC_FINANC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_OPERAC_FINANC
  for EMS5.MOVTO_OPERAC_FINANC;

prompt
prompt Creating synonym MOVTO_ORCTO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.MOVTO_ORCTO
  for EMS5.MOVTO_ORCTO;

prompt
prompt Creating synonym MOVTO_RESIDUO_ACAOCAP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_RESIDUO_ACAOCAP
  for EMS5.MOVTO_RESIDUO_ACAOCAP;

prompt
prompt Creating synonym MOVTO_SPC
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.MOVTO_SPC
  for EMS5.MOVTO_SPC;

prompt
prompt Creating synonym MOVTO_SPOOL_ACR_VENDOR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_SPOOL_ACR_VENDOR
  for EMS5.MOVTO_SPOOL_ACR_VENDOR;

prompt
prompt Creating synonym MOVTO_TIT_ACR
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.MOVTO_TIT_ACR
  for EMS5.MOVTO_TIT_ACR;

prompt
prompt Creating synonym MOVTO_TIT_ACR_AVP
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_TIT_ACR_AVP
  for EMS5.MOVTO_TIT_ACR_AVP;

prompt
prompt Creating synonym MOVTO_TIT_ACR_FECHADO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_TIT_ACR_FECHADO
  for EMS5.MOVTO_TIT_ACR_FECHADO;

prompt
prompt Creating synonym MOVTO_TIT_ACR_VENDOR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_TIT_ACR_VENDOR
  for EMS5.MOVTO_TIT_ACR_VENDOR;

prompt
prompt Creating synonym MOVTO_TIT_AP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.MOVTO_TIT_AP
  for EMS5.MOVTO_TIT_AP;

prompt
prompt Creating synonym MOVTO_TIT_AP_AVP
prompt =================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_TIT_AP_AVP
  for EMS5.MOVTO_TIT_AP_AVP;

prompt
prompt Creating synonym MOVTO_TIT_AP_BCIO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_TIT_AP_BCIO
  for EMS5.MOVTO_TIT_AP_BCIO;

prompt
prompt Creating synonym MOVTO_TIT_AP_FECHADO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_TIT_AP_FECHADO
  for EMS5.MOVTO_TIT_AP_FECHADO;

prompt
prompt Creating synonym MOVTO_TIT_ENVIO_SERASA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_TIT_ENVIO_SERASA
  for EMS5.MOVTO_TIT_ENVIO_SERASA;

prompt
prompt Creating synonym MOVTO_USUAR_CHEQ_TERC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_USUAR_CHEQ_TERC
  for EMS5.MOVTO_USUAR_CHEQ_TERC;

prompt
prompt Creating synonym MOVTO_USUAR_FINANC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.MOVTO_USUAR_FINANC
  for EMS5.MOVTO_USUAR_FINANC;

prompt
prompt Creating synonym MOVTOCOBRESPECIALACR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.MOVTOCOBRESPECIALACR
  for EMS5.MOVTOCOBRESPECIALACR;

prompt
prompt Creating synonym MOVTOCONCILCTACORREN
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.MOVTOCONCILCTACORREN
  for EMS5.MOVTOCONCILCTACORREN;

prompt
prompt Creating synonym MOVTOFLUXOUNIDCONTROL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MOVTOFLUXOUNIDCONTROL
  for EMS5.MOVTOFLUXOUNIDCONTROL;

prompt
prompt Creating synonym MOVTOMAPAMOVTOBEMPAT
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.MOVTOMAPAMOVTOBEMPAT
  for EMS5.MOVTOMAPAMOVTOBEMPAT;

prompt
prompt Creating synonym MOVTOPREVOPERACFINANC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.MOVTOPREVOPERACFINANC
  for EMS5.MOVTOPREVOPERACFINANC;

prompt
prompt Creating synonym MSG_AUTORIZADOR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.MSG_AUTORIZADOR
  for PRODUCAO.MSG_AUTORIZADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MSG_ENVDA_EDI
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.MSG_ENVDA_EDI
  for EMS5.MSG_ENVDA_EDI;

prompt
prompt Creating synonym MSG_FINANC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.MSG_FINANC
  for EMS5.MSG_FINANC;

prompt
prompt Creating synonym MSG_RECBDA_EDI
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.MSG_RECBDA_EDI
  for EMS5.MSG_RECBDA_EDI;

prompt
prompt Creating synonym MSG_REMESSA
prompt ============================
prompt
create or replace synonym EMS506UNICOO.MSG_REMESSA
  for PRODUCAO.MSG_REMESSA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym MSG_USUAR
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.MSG_USUAR
  for EMS5.MSG_USUAR;

prompt
prompt Creating synonym NARRAT_DEMONST_CTBL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.NARRAT_DEMONST_CTBL
  for EMS5.NARRAT_DEMONST_CTBL;

prompt
prompt Creating synonym NATUREZA_JURIDICA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.NATUREZA_JURIDICA
  for PRODUCAO.NATUREZA_JURIDICA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym NATUREZA_OPERACAO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.NATUREZA_OPERACAO
  for PRODUCAO.NATUREZA_OPERACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym NATUREZA_OPERACAO_NFSE
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.NATUREZA_OPERACAO_NFSE
  for PRODUCAO.NATUREZA_OPERACAO_NFSE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym NIV_CARGO_EEC
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.NIV_CARGO_EEC
  for EMS5.NIV_CARGO_EEC;

prompt
prompt Creating synonym NIV_USUAR
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.NIV_USUAR
  for EMS5.NIV_USUAR;

prompt
prompt Creating synonym NIVEL_DE_ALCADA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.NIVEL_DE_ALCADA
  for PRODUCAO.NIVEL_DE_ALCADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym NIVEL_DE_APROVACAO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.NIVEL_DE_APROVACAO
  for PRODUCAO.NIVEL_DE_APROVACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym NIVEL_DO_USUARIO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.NIVEL_DO_USUARIO
  for PRODUCAO.NIVEL_DO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym NIVHIERFUNCNALFINANC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.NIVHIERFUNCNALFINANC
  for EMS5.NIVHIERFUNCNALFINANC;

prompt
prompt Creating synonym NOME_CRITERIO_DE_RATEIO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.NOME_CRITERIO_DE_RATEIO
  for PRODUCAO.NOME_CRITERIO_DE_RATEIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym NOTA_DEVOL_TIT_ACR
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.NOTA_DEVOL_TIT_ACR
  for EMS5.NOTA_DEVOL_TIT_ACR;

prompt
prompt Creating synonym NOTA_DEVOL_TIT_AP
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.NOTA_DEVOL_TIT_AP
  for EMS5.NOTA_DEVOL_TIT_AP;

prompt
prompt Creating synonym NOTA_FISCAL_ENTRADA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.NOTA_FISCAL_ENTRADA
  for PRODUCAO.NOTA_FISCAL_ENTRADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym NOTA_FISCAL_ENTRADA_COMPL
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.NOTA_FISCAL_ENTRADA_COMPL
  for PRODUCAO.NOTA_FISCAL_ENTRADA_COMPL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym NOTA_FISCAL_VENDAS
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.NOTA_FISCAL_VENDAS
  for PRODUCAO.NOTA_FISCAL_VENDAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym NOTA_PEND_CARTCRED
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.NOTA_PEND_CARTCRED
  for EMS5.NOTA_PEND_CARTCRED;

prompt
prompt Creating synonym OCOR_BCIA_BCO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.OCOR_BCIA_BCO
  for EMS5.OCOR_BCIA_BCO;

prompt
prompt Creating synonym OCOR_ITEM_BORD_AP
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.OCOR_ITEM_BORD_AP
  for EMS5.OCOR_ITEM_BORD_AP;

prompt
prompt Creating synonym OCOR_PROCES_EDI
prompt ================================
prompt
create or replace synonym EMS506UNICOO.OCOR_PROCES_EDI
  for EMS5.OCOR_PROCES_EDI;

prompt
prompt Creating synonym OCORRENCIA
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.OCORRENCIA
  for PRODUCAO.OCORRENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OCORRENCIA_AUTORIZACAO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.OCORRENCIA_AUTORIZACAO
  for PRODUCAO.OCORRENCIA_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OCORRENCIA_BLOQUEIO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.OCORRENCIA_BLOQUEIO
  for PRODUCAO.OCORRENCIA_BLOQUEIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OCORRENCIA_DA_GUIA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.OCORRENCIA_DA_GUIA
  for PRODUCAO.OCORRENCIA_DA_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OCORRENCIA_DO_SERVICO_DA_GUIA
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.OCORRENCIA_DO_SERVICO_DA_GUIA
  for PRODUCAO.OCORRENCIA_DO_SERVICO_DA_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OCORRENCIA_SERVICO_EVENTO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.OCORRENCIA_SERVICO_EVENTO
  for PRODUCAO.OCORRENCIA_SERVICO_EVENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OCORRENCIA_SERVICO_INTERCAMBIO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.OCORRENCIA_SERVICO_INTERCAMBIO
  for PRODUCAO.OCORRENCIA_SERVICO_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OCORRENCIA_TITULO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.OCORRENCIA_TITULO
  for PRODUCAO.OCORRENCIA_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OCORRENCIA_TITULO_PAGAR
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.OCORRENCIA_TITULO_PAGAR
  for PRODUCAO.OCORRENCIA_TITULO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OPERAC_FINANC
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.OPERAC_FINANC
  for EMS5.OPERAC_FINANC;

prompt
prompt Creating synonym OPERAC_FINANC_ACR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.OPERAC_FINANC_ACR
  for EMS5.OPERAC_FINANC_ACR;

prompt
prompt Creating synonym OPERACAO_DE_COBRANCA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.OPERACAO_DE_COBRANCA
  for PRODUCAO.OPERACAO_DE_COBRANCA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OPERADOR_FILA_TELE
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.OPERADOR_FILA_TELE
  for PRODUCAO.OPERADOR_FILA_TELE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OPERADOR_TELE
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.OPERADOR_TELE
  for PRODUCAO.OPERADOR_TELE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OPME
prompt =====================
prompt
create or replace synonym EMS506UNICOO.OPME
  for PRODUCAO.OPME@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OPME1
prompt ======================
prompt
create or replace synonym EMS506UNICOO.OPME1
  for PRODUCAO.OPME1@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OPME2
prompt ======================
prompt
create or replace synonym EMS506UNICOO.OPME2
  for PRODUCAO.OPME2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ORCTO_CTBL
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.ORCTO_CTBL
  for EMS5.ORCTO_CTBL;

prompt
prompt Creating synonym ORCTO_CTBL_BGC
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.ORCTO_CTBL_BGC
  for EMS5.ORCTO_CTBL_BGC;

prompt
prompt Creating synonym ORD_BUSCA_ORCTO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.ORD_BUSCA_ORCTO
  for EMS5.ORD_BUSCA_ORCTO;

prompt
prompt Creating synonym ORD_COMPRA_TIT_AP
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ORD_COMPRA_TIT_AP
  for EMS5.ORD_COMPRA_TIT_AP;

prompt
prompt Creating synonym ORD_COMPRA_TIT_AP_PEND
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ORD_COMPRA_TIT_AP_PEND
  for EMS5.ORD_COMPRA_TIT_AP_PEND;

prompt
prompt Creating synonym ORGAO_EMIS_CART_IDENTIDADE
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.ORGAO_EMIS_CART_IDENTIDADE
  for PRODUCAO.ORGAO_EMIS_CART_IDENTIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ORGAO_PUBLIC
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ORGAO_PUBLIC
  for EMS5.ORGAO_PUBLIC;

prompt
prompt Creating synonym ORIG_ACAOCAP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.ORIG_ACAOCAP
  for EMS5.ORIG_ACAOCAP;

prompt
prompt Creating synonym ORIG_MOVTO_CMG_EMS_2
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ORIG_MOVTO_CMG_EMS_2
  for EMS5.ORIG_MOVTO_CMG_EMS_2;

prompt
prompt Creating synonym ORIG_MOVTO_EMPENH
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ORIG_MOVTO_EMPENH
  for EMS5.ORIG_MOVTO_EMPENH;

prompt
prompt Creating synonym ORIG_MOVTO_FLUXO_CX
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ORIG_MOVTO_FLUXO_CX
  for EMS5.ORIG_MOVTO_FLUXO_CX;

prompt
prompt Creating synonym ORIG_SALES_TAX_TIT_AP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.ORIG_SALES_TAX_TIT_AP
  for EMS5.ORIG_SALES_TAX_TIT_AP;

prompt
prompt Creating synonym ORIGSALESTAXITEMAPB
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ORIGSALESTAXITEMAPB
  for EMS5.ORIGSALESTAXITEMAPB;

prompt
prompt Creating synonym OUTRA_FONTE_INSS
prompt =================================
prompt
create or replace synonym EMS506UNICOO.OUTRA_FONTE_INSS
  for PRODUCAO.OUTRA_FONTE_INSS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OUTRO_RECOLHIMENTO_INSS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.OUTRO_RECOLHIMENTO_INSS
  for PRODUCAO.OUTRO_RECOLHIMENTO_INSS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym OUTROS_LANCAMENTOS_ICMS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.OUTROS_LANCAMENTOS_ICMS
  for PRODUCAO.OUTROS_LANCAMENTOS_ICMS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PADR_COL_BALANCT
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PADR_COL_BALANCT
  for EMS5.PADR_COL_BALANCT;

prompt
prompt Creating synonym PADR_COL_DEMONST_CTBL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PADR_COL_DEMONST_CTBL
  for EMS5.PADR_COL_DEMONST_CTBL;

prompt
prompt Creating synonym PADR_FLUXO_CX
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.PADR_FLUXO_CX
  for EMS5.PADR_FLUXO_CX;

prompt
prompt Creating synonym PAG_LIVRO_FISC
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PAG_LIVRO_FISC
  for EMS5.PAG_LIVRO_FISC;

prompt
prompt Creating synonym PAGAMENTO_COMISSAO_VENDA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.PAGAMENTO_COMISSAO_VENDA
  for PRODUCAO.PAGAMENTO_COMISSAO_VENDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGAMENTO_CONTROLE
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PAGAMENTO_CONTROLE
  for PRODUCAO.PAGAMENTO_CONTROLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGAMENTO_CONTROLE_PREST
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.PAGAMENTO_CONTROLE_PREST
  for PRODUCAO.PAGAMENTO_CONTROLE_PREST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGAMENTO_GFIP
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PAGAMENTO_GFIP
  for PRODUCAO.PAGAMENTO_GFIP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGAMENTO_NOTA_FISCAL_ENTRADA
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.PAGAMENTO_NOTA_FISCAL_ENTRADA
  for PRODUCAO.PAGAMENTO_NOTA_FISCAL_ENTRADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGAMENTO_SIMULA_TABELA
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.PAGAMENTO_SIMULA_TABELA
  for PRODUCAO.PAGAMENTO_SIMULA_TABELA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGAMENTO_SIMULA_TABELA_DET
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.PAGAMENTO_SIMULA_TABELA_DET
  for PRODUCAO.PAGAMENTO_SIMULA_TABELA_DET@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGAMENTO_SIMULA_TABELA_RESUMO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.PAGAMENTO_SIMULA_TABELA_RESUMO
  for PRODUCAO.PAGAMENTO_SIMULA_TABELA_RESUMO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGAMENTO_SIMULACAO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PAGAMENTO_SIMULACAO
  for PRODUCAO.PAGAMENTO_SIMULACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGAMENTO_SIMULACAO_DETALHE
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.PAGAMENTO_SIMULACAO_DETALHE
  for PRODUCAO.PAGAMENTO_SIMULACAO_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGAR_MODULO_10
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PAGAR_MODULO_10
  for PRODUCAO.PAGAR_MODULO_10@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGAR_MODULO_11
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PAGAR_MODULO_11
  for PRODUCAO.PAGAR_MODULO_11@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGRES
prompt =======================
prompt
create or replace synonym EMS506UNICOO.PAGRES
  for PRODUCAO.PAGRES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGTO02
prompt ========================
prompt
create or replace synonym EMS506UNICOO.PAGTO02
  for PRODUCAO.PAGTO02@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGTO04
prompt ========================
prompt
create or replace synonym EMS506UNICOO.PAGTO04
  for PRODUCAO.PAGTO04@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PAGTO_PADR
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.PAGTO_PADR
  for EMS5.PAGTO_PADR;

prompt
prompt Creating synonym PAGTO_PEND
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.PAGTO_PEND
  for EMS5.PAGTO_PEND;

prompt
prompt Creating synonym PAGTO_PROVIS_REPET
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PAGTO_PROVIS_REPET
  for EMS5.PAGTO_PROVIS_REPET;

prompt
prompt Creating synonym PAIS
prompt =====================
prompt
create or replace synonym EMS506UNICOO.PAIS
  for EMS5.PAIS;

prompt
prompt Creating synonym PAIS_EMISSOR_CART_IDENTIDADE
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.PAIS_EMISSOR_CART_IDENTIDADE
  for PRODUCAO.PAIS_EMISSOR_CART_IDENTIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PALAVRA_CHAVE
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.PALAVRA_CHAVE
  for EMS5.PALAVRA_CHAVE;

prompt
prompt Creating synonym PALAVRA_CHAVE_IDIOM
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PALAVRA_CHAVE_IDIOM
  for EMS5.PALAVRA_CHAVE_IDIOM;

prompt
prompt Creating synonym PALAVRA_CHAVE_TOPIC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PALAVRA_CHAVE_TOPIC
  for EMS5.PALAVRA_CHAVE_TOPIC;

prompt
prompt Creating synonym PARAM_APB_APF
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.PARAM_APB_APF
  for EMS5.PARAM_APB_APF;

prompt
prompt Creating synonym PARAM_CALC_BEM_PAT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PARAM_CALC_BEM_PAT
  for EMS5.PARAM_CALC_BEM_PAT;

prompt
prompt Creating synonym PARAM_CALC_CTA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PARAM_CALC_CTA
  for EMS5.PARAM_CALC_CTA;

prompt
prompt Creating synonym PARAM_CALC_INCORP_PAT
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PARAM_CALC_INCORP_PAT
  for EMS5.PARAM_CALC_INCORP_PAT;

prompt
prompt Creating synonym PARAM_CALC_RISCO_COBR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PARAM_CALC_RISCO_COBR
  for EMS5.PARAM_CALC_RISCO_COBR;

prompt
prompt Creating synonym PARAM_CENAR_CTBL_APL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PARAM_CENAR_CTBL_APL
  for EMS5.PARAM_CENAR_CTBL_APL;

prompt
prompt Creating synonym PARAM_COBR_ATIV
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_COBR_ATIV
  for EMS5.PARAM_COBR_ATIV;

prompt
prompt Creating synonym PARAM_CONEX_BCO_HISTOR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.PARAM_CONEX_BCO_HISTOR
  for EMS5.PARAM_CONEX_BCO_HISTOR;

prompt
prompt Creating synonym PARAM_CONTROL_CX
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PARAM_CONTROL_CX
  for EMS5.PARAM_CONTROL_CX;

prompt
prompt Creating synonym PARAM_CONTROL_TERC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PARAM_CONTROL_TERC
  for EMS5.PARAM_CONTROL_TERC;

prompt
prompt Creating synonym PARAM_CTA_CTBL_ACR
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PARAM_CTA_CTBL_ACR
  for EMS5.PARAM_CTA_CTBL_ACR;

prompt
prompt Creating synonym PARAM_CTBZ
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.PARAM_CTBZ
  for EMS5.PARAM_CTBZ;

prompt
prompt Creating synonym PARAM_CTBZ_AVP
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PARAM_CTBZ_AVP
  for EMS5.PARAM_CTBZ_AVP;

prompt
prompt Creating synonym PARAM_CTBZ_COMIS
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PARAM_CTBZ_COMIS
  for EMS5.PARAM_CTBZ_COMIS;

prompt
prompt Creating synonym PARAM_CTBZ_CTA_PAT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PARAM_CTBZ_CTA_PAT
  for EMS5.PARAM_CTBZ_CTA_PAT;

prompt
prompt Creating synonym PARAM_DARF_AP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.PARAM_DARF_AP
  for EMS5.PARAM_DARF_AP;

prompt
prompt Creating synonym PARAM_DEMONST_PUBLIC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PARAM_DEMONST_PUBLIC
  for EMS5.PARAM_DEMONST_PUBLIC;

prompt
prompt Creating synonym PARAM_EMIS_MSG_COBR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PARAM_EMIS_MSG_COBR
  for EMS5.PARAM_EMIS_MSG_COBR;

prompt
prompt Creating synonym PARAM_EMPRES_ACR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PARAM_EMPRES_ACR
  for EMS5.PARAM_EMPRES_ACR;

prompt
prompt Creating synonym PARAM_EMPRES_APB
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PARAM_EMPRES_APB
  for EMS5.PARAM_EMPRES_APB;

prompt
prompt Creating synonym PARAM_EMPRES_EEC
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PARAM_EMPRES_EEC
  for EMS5.PARAM_EMPRES_EEC;

prompt
prompt Creating synonym PARAM_EMPRES_PAT
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PARAM_EMPRES_PAT
  for EMS5.PARAM_EMPRES_PAT;

prompt
prompt Creating synonym PARAM_EMPRES_SHC
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PARAM_EMPRES_SHC
  for EMS5.PARAM_EMPRES_SHC;

prompt
prompt Creating synonym PARAM_EMVIA_FTP
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_EMVIA_FTP
  for EMS5.PARAM_EMVIA_FTP;

prompt
prompt Creating synonym PARAM_ESTAB_ACR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_ESTAB_ACR
  for EMS5.PARAM_ESTAB_ACR;

prompt
prompt Creating synonym PARAM_ESTAB_APB
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_ESTAB_APB
  for EMS5.PARAM_ESTAB_APB;

prompt
prompt Creating synonym PARAM_ESTAB_CART_BCIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PARAM_ESTAB_CART_BCIA
  for EMS5.PARAM_ESTAB_CART_BCIA;

prompt
prompt Creating synonym PARAM_ESTAB_CMG
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_ESTAB_CMG
  for EMS5.PARAM_ESTAB_CMG;

prompt
prompt Creating synonym PARAM_ESTAB_COMIS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.PARAM_ESTAB_COMIS
  for EMS5.PARAM_ESTAB_COMIS;

prompt
prompt Creating synonym PARAM_ESTAB_INADIMP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PARAM_ESTAB_INADIMP
  for EMS5.PARAM_ESTAB_INADIMP;

prompt
prompt Creating synonym PARAM_ESTAB_VENDOR
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PARAM_ESTAB_VENDOR
  for EMS5.PARAM_ESTAB_VENDOR;

prompt
prompt Creating synonym PARAM_GERAL_ACR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_GERAL_ACR
  for EMS5.PARAM_GERAL_ACR;

prompt
prompt Creating synonym PARAM_GERAL_APB
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_GERAL_APB
  for EMS5.PARAM_GERAL_APB;

prompt
prompt Creating synonym PARAM_GERAL_APL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_GERAL_APL
  for EMS5.PARAM_GERAL_APL;

prompt
prompt Creating synonym PARAM_GERAL_BGC
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_GERAL_BGC
  for EMS5.PARAM_GERAL_BGC;

prompt
prompt Creating synonym PARAM_GERAL_BGC_MODUL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PARAM_GERAL_BGC_MODUL
  for EMS5.PARAM_GERAL_BGC_MODUL;

prompt
prompt Creating synonym PARAM_GERAL_CFL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_GERAL_CFL
  for EMS5.PARAM_GERAL_CFL;

prompt
prompt Creating synonym PARAM_GERAL_CMG
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_GERAL_CMG
  for EMS5.PARAM_GERAL_CMG;

prompt
prompt Creating synonym PARAM_GERAL_EEC
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_GERAL_EEC
  for EMS5.PARAM_GERAL_EEC;

prompt
prompt Creating synonym PARAM_GERAL_EMS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_GERAL_EMS
  for EMS5.PARAM_GERAL_EMS;

prompt
prompt Creating synonym PARAM_GERAL_GLD
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_GERAL_GLD
  for EMS5.PARAM_GERAL_GLD;

prompt
prompt Creating synonym PARAM_GERAL_PAT
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_GERAL_PAT
  for EMS5.PARAM_GERAL_PAT;

prompt
prompt Creating synonym PARAM_GERAL_SCO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_GERAL_SCO
  for EMS5.PARAM_GERAL_SCO;

prompt
prompt Creating synonym PARAM_INTEGR_CFL
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PARAM_INTEGR_CFL
  for EMS5.PARAM_INTEGR_CFL;

prompt
prompt Creating synonym PARAM_INTEGR_EMS
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PARAM_INTEGR_EMS
  for EMS5.PARAM_INTEGR_EMS;

prompt
prompt Creating synonym PARAM_INTER_DIV
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARAM_INTER_DIV
  for EMS5.PARAM_INTER_DIV;

prompt
prompt Creating synonym PARAM_MSG_COBR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PARAM_MSG_COBR
  for EMS5.PARAM_MSG_COBR;

prompt
prompt Creating synonym PARAM_ORCTO_FLUXO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.PARAM_ORCTO_FLUXO
  for EMS5.PARAM_ORCTO_FLUXO;

prompt
prompt Creating synonym PARAM_TEF
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.PARAM_TEF
  for EMS5.PARAM_TEF;

prompt
prompt Creating synonym PARAM_UTILIZ_PRODUT
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PARAM_UTILIZ_PRODUT
  for EMS5.PARAM_UTILIZ_PRODUT;

prompt
prompt Creating synonym PARAMBLOQEXECORCTARIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PARAMBLOQEXECORCTARIA
  for EMS5.PARAMBLOQEXECORCTARIA;

prompt
prompt Creating synonym PARAMEMPRESAPROVACVAL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PARAMEMPRESAPROVACVAL
  for EMS5.PARAMEMPRESAPROVACVAL;

prompt
prompt Creating synonym PARAMESTABAPROVACVAL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PARAMESTABAPROVACVAL
  for EMS5.PARAMESTABAPROVACVAL;

prompt
prompt Creating synonym PARAMETRO
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.PARAMETRO
  for PRODUCAO.PARAMETRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PARAMETRO_SPED
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PARAMETRO_SPED
  for PRODUCAO.PARAMETRO_SPED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PARAMEXTRATCRIAAUTOM
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PARAMEXTRATCRIAAUTOM
  for EMS5.PARAMEXTRATCRIAAUTOM;

prompt
prompt Creating synonym PARAMREGRAPERDADEDUT
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PARAMREGRAPERDADEDUT
  for EMS5.PARAMREGRAPERDADEDUT;

prompt
prompt Creating synonym PARC_COND_PAGTO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARC_COND_PAGTO
  for EMS5.PARC_COND_PAGTO;

prompt
prompt Creating synonym PARC_OPERAC_FINANC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PARC_OPERAC_FINANC
  for EMS5.PARC_OPERAC_FINANC;

prompt
prompt Creating synonym PARC_PROCESS_NEGOC_CX
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PARC_PROCESS_NEGOC_CX
  for EMS5.PARC_PROCESS_NEGOC_CX;

prompt
prompt Creating synonym PARC_TAB_FINANC
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARC_TAB_FINANC
  for EMS5.PARC_TAB_FINANC;

prompt
prompt Creating synonym PARC_VENDOR
prompt ============================
prompt
create or replace synonym EMS506UNICOO.PARC_VENDOR
  for EMS5.PARC_VENDOR;

prompt
prompt Creating synonym PARCEI_EDI
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.PARCEI_EDI
  for EMS5.PARCEI_EDI;

prompt
prompt Creating synonym PARCEI_MAPA_EDI
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PARCEI_MAPA_EDI
  for EMS5.PARCEI_MAPA_EDI;

prompt
prompt Creating synonym PARCEI_PRVDOR_EDI
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.PARCEI_PRVDOR_EDI
  for EMS5.PARCEI_PRVDOR_EDI;

prompt
prompt Creating synonym PARCEI_SPC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.PARCEI_SPC
  for EMS5.PARCEI_SPC;

prompt
prompt Creating synonym PARCEI_SPC_TIP_MOVTO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PARCEI_SPC_TIP_MOVTO
  for EMS5.PARCEI_SPC_TIP_MOVTO;

prompt
prompt Creating synonym PARCEI_TRANS_EDI
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PARCEI_TRANS_EDI
  for EMS5.PARCEI_TRANS_EDI;

prompt
prompt Creating synonym PARCELA_PAGAMENTO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.PARCELA_PAGAMENTO
  for PRODUCAO.PARCELA_PAGAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PARID_INDIC_ECON
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PARID_INDIC_ECON
  for EMS5.PARID_INDIC_ECON;

prompt
prompt Creating synonym PASSAG_EEC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.PASSAG_EEC
  for EMS5.PASSAG_EEC;

prompt
prompt Creating synonym PASSAG_SOLICIT_VIAGEM
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PASSAG_SOLICIT_VIAGEM
  for EMS5.PASSAG_SOLICIT_VIAGEM;

prompt
prompt Creating synonym PCTE_CTA_CTBL
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.PCTE_CTA_CTBL
  for EMS5.PCTE_CTA_CTBL;

prompt
prompt Creating synonym PED_VDA_TIT_ACR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PED_VDA_TIT_ACR
  for EMS5.PED_VDA_TIT_ACR;

prompt
prompt Creating synonym PED_VDA_TIT_ACR_PEND
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PED_VDA_TIT_ACR_PEND
  for EMS5.PED_VDA_TIT_ACR_PEND;

prompt
prompt Creating synonym PERC_PARTICIP_ACION
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PERC_PARTICIP_ACION
  for EMS5.PERC_PARTICIP_ACION;

prompt
prompt Creating synonym PERCENTUAL_VENDAS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.PERCENTUAL_VENDAS
  for PRODUCAO.PERCENTUAL_VENDAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PERF_COBR_ATIV
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PERF_COBR_ATIV
  for EMS5.PERF_COBR_ATIV;

prompt
prompt Creating synonym PERF_COBR_ATIV_BASE
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PERF_COBR_ATIV_BASE
  for EMS5.PERF_COBR_ATIV_BASE;

prompt
prompt Creating synonym PERF_USUAR_COBR_ATIV
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PERF_USUAR_COBR_ATIV
  for EMS5.PERF_USUAR_COBR_ATIV;

prompt
prompt Creating synonym PERF_USUAR_INADIMP
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PERF_USUAR_INADIMP
  for EMS5.PERF_USUAR_INADIMP;

prompt
prompt Creating synonym PERICIA
prompt ========================
prompt
create or replace synonym EMS506UNICOO.PERICIA
  for PRODUCAO.PERICIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PERIOD_CTBL
prompt ============================
prompt
create or replace synonym EMS506UNICOO.PERIOD_CTBL
  for EMS5.PERIOD_CTBL;

prompt
prompt Creating synonym PERIODO_COMP_LIVRO_FISCAL
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.PERIODO_COMP_LIVRO_FISCAL
  for PRODUCAO.PERIODO_COMP_LIVRO_FISCAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PERIODO_COMPETENCIA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PERIODO_COMPETENCIA
  for PRODUCAO.PERIODO_COMPETENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PERIODO_COTA_PRESTADOR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.PERIODO_COTA_PRESTADOR
  for PRODUCAO.PERIODO_COTA_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PERIODO_REFERENCIA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PERIODO_REFERENCIA
  for PRODUCAO.PERIODO_REFERENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PERM_USUAR_CX
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.PERM_USUAR_CX
  for EMS5.PERM_USUAR_CX;

prompt
prompt Creating synonym PERMIS_GRP_CCUSTO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.PERMIS_GRP_CCUSTO
  for EMS5.PERMIS_GRP_CCUSTO;

prompt
prompt Creating synonym PERMISSAO_CONTA_CORRENTE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.PERMISSAO_CONTA_CORRENTE
  for PRODUCAO.PERMISSAO_CONTA_CORRENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PERMISSAO_DO_GRUPO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PERMISSAO_DO_GRUPO
  for PRODUCAO.PERMISSAO_DO_GRUPO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PERMISSAO_EMPRESA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.PERMISSAO_EMPRESA
  for PRODUCAO.PERMISSAO_EMPRESA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PERMISSAO_FUNCIONARIO_CONTRATO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.PERMISSAO_FUNCIONARIO_CONTRATO
  for PRODUCAO.PERMISSAO_FUNCIONARIO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PERMISSAO_FUNCIONARIO_WEB
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.PERMISSAO_FUNCIONARIO_WEB
  for PRODUCAO.PERMISSAO_FUNCIONARIO_WEB@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PERMISSAO_GRUPO_CLIENTE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.PERMISSAO_GRUPO_CLIENTE
  for PRODUCAO.PERMISSAO_GRUPO_CLIENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PERMISSAO_GRUPO_CONTRATO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.PERMISSAO_GRUPO_CONTRATO
  for PRODUCAO.PERMISSAO_GRUPO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PERMISSAO_GRUPO_PRESTADOR
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.PERMISSAO_GRUPO_PRESTADOR
  for PRODUCAO.PERMISSAO_GRUPO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PESSOA
prompt =======================
prompt
create or replace synonym EMS506UNICOO.PESSOA
  for PRODUCAO.PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PESSOA_CARGA_NOME0012A0120
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.PESSOA_CARGA_NOME0012A0120
  for PRODUCAO.PESSOA_CARGA_NOME0012A0120@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PESSOA_CARGA_NOME0121A0368
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.PESSOA_CARGA_NOME0121A0368
  for PRODUCAO.PESSOA_CARGA_NOME0121A0368@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PESSOA_CARGA_NOME0372A9972
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.PESSOA_CARGA_NOME0372A9972
  for PRODUCAO.PESSOA_CARGA_NOME0372A9972@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PESSOA_CARGA_NOME7018_A_7046
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.PESSOA_CARGA_NOME7018_A_7046
  for PRODUCAO.PESSOA_CARGA_NOME7018_A_7046@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PESSOA_CARGA_NOME7048_A_7057
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.PESSOA_CARGA_NOME7048_A_7057
  for PRODUCAO.PESSOA_CARGA_NOME7048_A_7057@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PESSOA_CARGA_NOME7058_A_7059
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.PESSOA_CARGA_NOME7058_A_7059
  for PRODUCAO.PESSOA_CARGA_NOME7058_A_7059@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PESSOA_CARGA_NOME7060_A_7065
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.PESSOA_CARGA_NOME7060_A_7065
  for PRODUCAO.PESSOA_CARGA_NOME7060_A_7065@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PESSOA_CARGA_NOME7066_A_7078
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.PESSOA_CARGA_NOME7066_A_7078
  for PRODUCAO.PESSOA_CARGA_NOME7066_A_7078@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PESSOA_EXCLUIDA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PESSOA_EXCLUIDA
  for PRODUCAO.PESSOA_EXCLUIDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PESSOA_FISIC
prompt =============================
prompt
create or replace synonym EMS506UNICOO.PESSOA_FISIC
  for EMS5.PESSOA_FISIC;

prompt
prompt Creating synonym PESSOA_FISIC_ATIVID
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PESSOA_FISIC_ATIVID
  for EMS5.PESSOA_FISIC_ATIVID;

prompt
prompt Creating synonym PESSOA_FISIC_COMPL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PESSOA_FISIC_COMPL
  for EMS5.PESSOA_FISIC_COMPL;

prompt
prompt Creating synonym PESSOA_JURID
prompt =============================
prompt
create or replace synonym EMS506UNICOO.PESSOA_JURID
  for EMS5.PESSOA_JURID;

prompt
prompt Creating synonym PESSOA_JURID_ATIVID
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PESSOA_JURID_ATIVID
  for EMS5.PESSOA_JURID_ATIVID;

prompt
prompt Creating synonym PESSOA_PROPOSTA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PESSOA_PROPOSTA
  for PRODUCAO.PESSOA_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PESSOA_SEM_CNS
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PESSOA_SEM_CNS
  for PRODUCAO.PESSOA_SEM_CNS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PESSOA_SEM_DADOS
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PESSOA_SEM_DADOS
  for PRODUCAO.PESSOA_SEM_DADOS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PESSOAJURIDRAMONEGOC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PESSOAJURIDRAMONEGOC
  for EMS5.PESSOAJURIDRAMONEGOC;

prompt
prompt Creating synonym PLAN_TABLE
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.PLAN_TABLE
  for PRODUCAO.PLAN_TABLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PLANILHA_VENDOR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PLANILHA_VENDOR
  for EMS5.PLANILHA_VENDOR;

prompt
prompt Creating synonym PLANO_ACAO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.PLANO_ACAO
  for EMS5.PLANO_ACAO;

prompt
prompt Creating synonym PLANO_ACOMODACAO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PLANO_ACOMODACAO
  for PRODUCAO.PLANO_ACOMODACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PLANO_CCUSTO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.PLANO_CCUSTO
  for EMS5.PLANO_CCUSTO;

prompt
prompt Creating synonym PLANO_CTA_CTBL
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PLANO_CTA_CTBL
  for EMS5.PLANO_CTA_CTBL;

prompt
prompt Creating synonym PLANO_CTA_UNID_ORGAN
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PLANO_CTA_UNID_ORGAN
  for EMS5.PLANO_CTA_UNID_ORGAN;

prompt
prompt Creating synonym PLANO_DE_CONTAS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PLANO_DE_CONTAS
  for PRODUCAO.PLANO_DE_CONTAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PLANO_PAG_CAP_SOCIAL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PLANO_PAG_CAP_SOCIAL
  for PRODUCAO.PLANO_PAG_CAP_SOCIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PLANOAPROVACDESPESEEC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PLANOAPROVACDESPESEEC
  for EMS5.PLANOAPROVACDESPESEEC;

prompt
prompt Creating synonym PLSQL_PROFILER_DATA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PLSQL_PROFILER_DATA
  for PRODUCAO.PLSQL_PROFILER_DATA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PLSQL_PROFILER_RUNS
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PLSQL_PROFILER_RUNS
  for PRODUCAO.PLSQL_PROFILER_RUNS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PLSQL_PROFILER_UNITS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PLSQL_PROFILER_UNITS
  for PRODUCAO.PLSQL_PROFILER_UNITS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PORTAD_BCO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.PORTAD_BCO
  for EMS5.PORTAD_BCO;

prompt
prompt Creating synonym PORTAD_CARTCRED
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PORTAD_CARTCRED
  for EMS5.PORTAD_CARTCRED;

prompt
prompt Creating synonym PORTAD_EDI
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.PORTAD_EDI
  for EMS5.PORTAD_EDI;

prompt
prompt Creating synonym PORTAD_ESTAB
prompt =============================
prompt
create or replace synonym EMS506UNICOO.PORTAD_ESTAB
  for EMS5.PORTAD_ESTAB;

prompt
prompt Creating synonym PORTAD_FINALID_ECON
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PORTAD_FINALID_ECON
  for EMS5.PORTAD_FINALID_ECON;

prompt
prompt Creating synonym PORTAD_INADIMP
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PORTAD_INADIMP
  for EMS5.PORTAD_INADIMP;

prompt
prompt Creating synonym PORTAD_TIT_ACR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PORTAD_TIT_ACR
  for EMS5.PORTAD_TIT_ACR;

prompt
prompt Creating synonym PORTADOR
prompt =========================
prompt
create or replace synonym EMS506UNICOO.PORTADOR
  for EMS5.PORTADOR;

prompt
prompt Creating synonym PORTADOR_DE_COBRANCA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PORTADOR_DE_COBRANCA
  for PRODUCAO.PORTADOR_DE_COBRANCA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PORTE_ANESTESICO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PORTE_ANESTESICO
  for PRODUCAO.PORTE_ANESTESICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PORTE_ANESTESICO_CBHPM
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.PORTE_ANESTESICO_CBHPM
  for PRODUCAO.PORTE_ANESTESICO_CBHPM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PORTE_HONORARIO_MEDICO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.PORTE_HONORARIO_MEDICO
  for PRODUCAO.PORTE_HONORARIO_MEDICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PORTE_PESSOA_JURID
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PORTE_PESSOA_JURID
  for EMS5.PORTE_PESSOA_JURID;

prompt
prompt Creating synonym POS
prompt ====================
prompt
create or replace synonym EMS506UNICOO.POS
  for PRODUCAO.POS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym POS_COD_BARRA
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.POS_COD_BARRA
  for EMS5.POS_COD_BARRA;

prompt
prompt Creating synonym POS_OPERATOR
prompt =============================
prompt
create or replace synonym EMS506UNICOO.POS_OPERATOR
  for PRODUCAO.POS_OPERATOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym POS_PRESTADOR
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.POS_PRESTADOR
  for PRODUCAO.POS_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym POSICAO_ESTOQUE
prompt ================================
prompt
create or replace synonym EMS506UNICOO.POSICAO_ESTOQUE
  for PRODUCAO.POSICAO_ESTOQUE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRAZO_DE_RETORNO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PRAZO_DE_RETORNO
  for PRODUCAO.PRAZO_DE_RETORNO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRAZO_RETORNO_PRESTADOR
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.PRAZO_RETORNO_PRESTADOR
  for PRODUCAO.PRAZO_RETORNO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRC_MSG_CARNE_MEDPREV
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PRC_MSG_CARNE_MEDPREV
  for PRODUCAO.PRC_MSG_CARNE_MEDPREV@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRE_ACAOCAP
prompt ============================
prompt
create or replace synonym EMS506UNICOO.PRE_ACAOCAP
  for EMS5.PRE_ACAOCAP;

prompt
prompt Creating synonym PRE_AUTORIZACAO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PRE_AUTORIZACAO
  for PRODUCAO.PRE_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRE_MOVTO_DIVNDO_ACION
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.PRE_MOVTO_DIVNDO_ACION
  for EMS5.PRE_MOVTO_DIVNDO_ACION;

prompt
prompt Creating synonym PRECO_CONTRATO_PADRAO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PRECO_CONTRATO_PADRAO
  for PRODUCAO.PRECO_CONTRATO_PADRAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRECO_CONTRATO_PESSOA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PRECO_CONTRATO_PESSOA
  for PRODUCAO.PRECO_CONTRATO_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRECO_PRODUTO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.PRECO_PRODUTO
  for PRODUCAO.PRECO_PRODUTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRECO_REFERENCIA_CONTRATO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.PRECO_REFERENCIA_CONTRATO
  for PRODUCAO.PRECO_REFERENCIA_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRECO_REFERENCIA_PADRAO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.PRECO_REFERENCIA_PADRAO
  for PRODUCAO.PRECO_REFERENCIA_PADRAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PREFER_DEMONST_CTBL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PREFER_DEMONST_CTBL
  for EMS5.PREFER_DEMONST_CTBL;

prompt
prompt Creating synonym PREFER_USUAR_CFL
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PREFER_USUAR_CFL
  for EMS5.PREFER_USUAR_CFL;

prompt
prompt Creating synonym PREFER_USUAR_CMG
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PREFER_USUAR_CMG
  for EMS5.PREFER_USUAR_CMG;

prompt
prompt Creating synonym PREFIX_CARTAO_CR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PREFIX_CARTAO_CR
  for EMS5.PREFIX_CARTAO_CR;

prompt
prompt Creating synonym PREFIX_SERV_PUBLIC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PREFIX_SERV_PUBLIC
  for EMS5.PREFIX_SERV_PUBLIC;

prompt
prompt Creating synonym PREFIXREJTDOCARTAOCR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PREFIXREJTDOCARTAOCR
  for EMS5.PREFIXREJTDOCARTAOCR;

prompt
prompt Creating synonym PRESTADOR
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR
  for PRODUCAO.PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRESTADOR_BCK
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR_BCK
  for PRODUCAO.PRESTADOR_BCK@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRESTADOR_CIDADE_ATUACAO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR_CIDADE_ATUACAO
  for PRODUCAO.PRESTADOR_CIDADE_ATUACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRESTADOR_COTA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR_COTA
  for PRODUCAO.PRESTADOR_COTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRESTADOR_DEPENDENTE
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR_DEPENDENTE
  for PRODUCAO.PRESTADOR_DEPENDENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRESTADOR_DO_GRUPO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR_DO_GRUPO
  for PRODUCAO.PRESTADOR_DO_GRUPO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRESTADOR_ESTABELECIMENTO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR_ESTABELECIMENTO
  for PRODUCAO.PRESTADOR_ESTABELECIMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRESTADOR_EVENTUAL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR_EVENTUAL
  for PRODUCAO.PRESTADOR_EVENTUAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRESTADOR_EXCL_FATOR_MODERADOR
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR_EXCL_FATOR_MODERADOR
  for PRODUCAO.PRESTADOR_EXCL_FATOR_MODERADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRESTADOR_EXTERNO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR_EXTERNO
  for PRODUCAO.PRESTADOR_EXTERNO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRESTADOR_GERAL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR_GERAL
  for PRODUCAO.PRESTADOR_GERAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRESTADOR_PROPRIETARIO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR_PROPRIETARIO
  for PRODUCAO.PRESTADOR_PROPRIETARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRESTADOR_REMIDO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR_REMIDO
  for PRODUCAO.PRESTADOR_REMIDO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRESTADOR_SERVICO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR_SERVICO
  for PRODUCAO.PRESTADOR_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRESTADOR_TRANSFERENCIA_VALOR
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.PRESTADOR_TRANSFERENCIA_VALOR
  for PRODUCAO.PRESTADOR_TRANSFERENCIA_VALOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PREV_COMPRAS
prompt =============================
prompt
create or replace synonym EMS506UNICOO.PREV_COMPRAS
  for PRODUCAO.PREV_COMPRAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PREV_VENDAS
prompt ============================
prompt
create or replace synonym EMS506UNICOO.PREV_VENDAS
  for PRODUCAO.PREV_VENDAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PROCED_ANS
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.PROCED_ANS
  for PRODUCAO.PROCED_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PROCED_ANS_PLANO_SAUDE
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.PROCED_ANS_PLANO_SAUDE
  for PRODUCAO.PROCED_ANS_PLANO_SAUDE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PROCEDIMENTO_MULTIPLO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PROCEDIMENTO_MULTIPLO
  for PRODUCAO.PROCEDIMENTO_MULTIPLO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PROCES_EDI
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.PROCES_EDI
  for EMS5.PROCES_EDI;

prompt
prompt Creating synonym PROCES_ESOC
prompt ============================
prompt
create or replace synonym EMS506UNICOO.PROCES_ESOC
  for EMS5.PROCES_ESOC;

prompt
prompt Creating synonym PROCES_PAGTO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.PROCES_PAGTO
  for EMS5.PROCES_PAGTO;

prompt
prompt Creating synonym PROCES_PRESTAC_CTA_EEC
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.PROCES_PRESTAC_CTA_EEC
  for EMS5.PROCES_PRESTAC_CTA_EEC;

prompt
prompt Creating synonym PROCESS_FORMA_PAGTO_CX
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.PROCESS_FORMA_PAGTO_CX
  for EMS5.PROCESS_FORMA_PAGTO_CX;

prompt
prompt Creating synonym PROCESS_INTEGR_COMIS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PROCESS_INTEGR_COMIS
  for EMS5.PROCESS_INTEGR_COMIS;

prompt
prompt Creating synonym PROCESS_NEGOC_CX
prompt =================================
prompt
create or replace synonym EMS506UNICOO.PROCESS_NEGOC_CX
  for EMS5.PROCESS_NEGOC_CX;

prompt
prompt Creating synonym PROCESS_NEGOC_CX_ABAT
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PROCESS_NEGOC_CX_ABAT
  for EMS5.PROCESS_NEGOC_CX_ABAT;

prompt
prompt Creating synonym PROCESS_NEGOC_CX_CHEQ
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.PROCESS_NEGOC_CX_CHEQ
  for EMS5.PROCESS_NEGOC_CX_CHEQ;

prompt
prompt Creating synonym PROCESSNEGOCCXCARTAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PROCESSNEGOCCXCARTAO
  for EMS5.PROCESSNEGOCCXCARTAO;

prompt
prompt Creating synonym PROCESSO
prompt =========================
prompt
create or replace synonym EMS506UNICOO.PROCESSO
  for PRODUCAO.PROCESSO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PROCESSO_CAMPO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PROCESSO_CAMPO
  for PRODUCAO.PROCESSO_CAMPO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRODFEDERAT
prompt ============================
prompt
create or replace synonym EMS506UNICOO.PRODFEDERAT
  for PRODUCAO.PRODFEDERAT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRODUC_PERIOD
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.PRODUC_PERIOD
  for EMS5.PRODUC_PERIOD;

prompt
prompt Creating synonym PRODUCAO_TOTAL
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PRODUCAO_TOTAL
  for PRODUCAO.PRODUCAO_TOTAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRODUT_FINANC
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.PRODUT_FINANC
  for EMS5.PRODUT_FINANC;

prompt
prompt Creating synonym PRODUT_FINANC_BCO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.PRODUT_FINANC_BCO
  for EMS5.PRODUT_FINANC_BCO;

prompt
prompt Creating synonym PROGRAMAC_SCHED_EDI
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PROGRAMAC_SCHED_EDI
  for EMS5.PROGRAMAC_SCHED_EDI;

prompt
prompt Creating synonym PROJ_FINANC
prompt ============================
prompt
create or replace synonym EMS506UNICOO.PROJ_FINANC
  for EMS5.PROJ_FINANC;

prompt
prompt Creating synonym PROJ_FINANC_ESTAB
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.PROJ_FINANC_ESTAB
  for EMS5.PROJ_FINANC_ESTAB;

prompt
prompt Creating synonym PROJ_OPERAC_FINANC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PROJ_OPERAC_FINANC
  for EMS5.PROJ_OPERAC_FINANC;

prompt
prompt Creating synonym PROPOSTA
prompt =========================
prompt
create or replace synonym EMS506UNICOO.PROPOSTA
  for PRODUCAO.PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRORROGACAO_DA_GUIA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.PRORROGACAO_DA_GUIA
  for PRODUCAO.PRORROGACAO_DA_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PROTOCOLO
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.PROTOCOLO
  for PRODUCAO.PROTOCOLO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PROTOCOLO_CONTRATO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PROTOCOLO_CONTRATO
  for PRODUCAO.PROTOCOLO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PROTOCOLO_PROPOSTA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PROTOCOLO_PROPOSTA
  for PRODUCAO.PROTOCOLO_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PROXIMO_LANCTO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.PROXIMO_LANCTO
  for PRODUCAO.PROXIMO_LANCTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PROXIMO_LOTE
prompt =============================
prompt
create or replace synonym EMS506UNICOO.PROXIMO_LOTE
  for PRODUCAO.PROXIMO_LOTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PRVDOR_EDI
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.PRVDOR_EDI
  for EMS5.PRVDOR_EDI;

prompt
prompt Creating synonym PTU_ARQUIVO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.PTU_ARQUIVO
  for PRODUCAO.PTU_ARQUIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PTU_CAMPO
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.PTU_CAMPO
  for PRODUCAO.PTU_CAMPO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PTU_CONSULTA_BENEF_RETORNO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.PTU_CONSULTA_BENEF_RETORNO
  for PRODUCAO.PTU_CONSULTA_BENEF_RETORNO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PTU_CONSULTA_BENEFICIARIO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.PTU_CONSULTA_BENEFICIARIO
  for PRODUCAO.PTU_CONSULTA_BENEFICIARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PTU_CONSULTA_PRESTADOR_ENVIO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.PTU_CONSULTA_PRESTADOR_ENVIO
  for PRODUCAO.PTU_CONSULTA_PRESTADOR_ENVIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PTU_CONSULTA_PRESTADOR_RETORNO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.PTU_CONSULTA_PRESTADOR_RETORNO
  for PRODUCAO.PTU_CONSULTA_PRESTADOR_RETORNO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PTU_CONTROLE_TRANSACAO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.PTU_CONTROLE_TRANSACAO
  for PRODUCAO.PTU_CONTROLE_TRANSACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PTU_CONVERSAO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.PTU_CONVERSAO
  for PRODUCAO.PTU_CONVERSAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PTU_CONVERSAO_ITEM
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PTU_CONVERSAO_ITEM
  for PRODUCAO.PTU_CONVERSAO_ITEM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PTU_MENSAGEM_ERRO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.PTU_MENSAGEM_ERRO
  for PRODUCAO.PTU_MENSAGEM_ERRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PTU_NUMERO_TRANSACAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.PTU_NUMERO_TRANSACAO
  for PRODUCAO.PTU_NUMERO_TRANSACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PTU_REGISTRO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.PTU_REGISTRO
  for PRODUCAO.PTU_REGISTRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PTU_TIPO_TRANSACAO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.PTU_TIPO_TRANSACAO
  for PRODUCAO.PTU_TIPO_TRANSACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym PTU_TRANSACAO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.PTU_TRANSACAO
  for PRODUCAO.PTU_TRANSACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUANT_PRODUZ
prompt =============================
prompt
create or replace synonym EMS506UNICOO.QUANT_PRODUZ
  for EMS5.QUANT_PRODUZ;

prompt
prompt Creating synonym QUEBRAS_DE_ARQUIVO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.QUEBRAS_DE_ARQUIVO
  for PRODUCAO.QUEBRAS_DE_ARQUIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_LUCY_SNAPSHOT
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.QUEST_LUCY_SNAPSHOT
  for PRODUCAO.QUEST_LUCY_SNAPSHOT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_ADVISORY
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_ADVISORY
  for PRODUCAO.QUEST_PPCM_ADVISORY@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_ADVISORY_SNAP
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_ADVISORY_SNAP
  for PRODUCAO.QUEST_PPCM_ADVISORY_SNAP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_ANAL_EXCLUSION
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_ANAL_EXCLUSION
  for PRODUCAO.QUEST_PPCM_ANAL_EXCLUSION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_ANAL_RESULT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_ANAL_RESULT
  for PRODUCAO.QUEST_PPCM_ANAL_RESULT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_ANAL_RESULT_SEG
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_ANAL_RESULT_SEG
  for PRODUCAO.QUEST_PPCM_ANAL_RESULT_SEG@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_ANAL_TREND_CHANGE
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_ANAL_TREND_CHANGE
  for PRODUCAO.QUEST_PPCM_ANAL_TREND_CHANGE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_CUSTOM_SQL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_CUSTOM_SQL
  for PRODUCAO.QUEST_PPCM_CUSTOM_SQL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_DATA_EXCLUSION
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_DATA_EXCLUSION
  for PRODUCAO.QUEST_PPCM_DATA_EXCLUSION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_FUZZY_FUNC_RANGE
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_FUZZY_FUNC_RANGE
  for PRODUCAO.QUEST_PPCM_FUZZY_FUNC_RANGE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_FUZZY_FUNCTION
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_FUZZY_FUNCTION
  for PRODUCAO.QUEST_PPCM_FUZZY_FUNCTION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_INSTANCE
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_INSTANCE
  for PRODUCAO.QUEST_PPCM_INSTANCE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_IOSTAT
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_IOSTAT
  for PRODUCAO.QUEST_PPCM_IOSTAT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_IOSTAT_SNAP
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_IOSTAT_SNAP
  for PRODUCAO.QUEST_PPCM_IOSTAT_SNAP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_PARAMETERS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_PARAMETERS
  for PRODUCAO.QUEST_PPCM_PARAMETERS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_PEAK_ACTIVITY
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_PEAK_ACTIVITY
  for PRODUCAO.QUEST_PPCM_PEAK_ACTIVITY@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_PEAK_TIMES
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_PEAK_TIMES
  for PRODUCAO.QUEST_PPCM_PEAK_TIMES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_SEG_EQ_COEFF
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_SEG_EQ_COEFF
  for PRODUCAO.QUEST_PPCM_SEG_EQ_COEFF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_SEG_OMIT_DATA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_SEG_OMIT_DATA
  for PRODUCAO.QUEST_PPCM_SEG_OMIT_DATA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_SNAPSHOT
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_SNAPSHOT
  for PRODUCAO.QUEST_PPCM_SNAPSHOT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_SNAPSHOT_CATEGORIES
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_SNAPSHOT_CATEGORIES
  for PRODUCAO.QUEST_PPCM_SNAPSHOT_CATEGORIES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_SQL_CRITERIA
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_SQL_CRITERIA
  for PRODUCAO.QUEST_PPCM_SQL_CRITERIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_SQL_SNAPSHOT
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_SQL_SNAPSHOT
  for PRODUCAO.QUEST_PPCM_SQL_SNAPSHOT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_SQL_TEXT
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_SQL_TEXT
  for PRODUCAO.QUEST_PPCM_SQL_TEXT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_STATISTIC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_STATISTIC
  for PRODUCAO.QUEST_PPCM_STATISTIC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_STATISTIC_SNAP
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_STATISTIC_SNAP
  for PRODUCAO.QUEST_PPCM_STATISTIC_SNAP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_TCA_EXCLUSION
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_TCA_EXCLUSION
  for PRODUCAO.QUEST_PPCM_TCA_EXCLUSION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_TIME_SNAP
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_TIME_SNAP
  for PRODUCAO.QUEST_PPCM_TIME_SNAP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_TIMED_STATISTIC
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_TIMED_STATISTIC
  for PRODUCAO.QUEST_PPCM_TIMED_STATISTIC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_TREND_CHANGE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_TREND_CHANGE
  for PRODUCAO.QUEST_PPCM_TREND_CHANGE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_PPCM_VERSION
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.QUEST_PPCM_VERSION
  for PRODUCAO.QUEST_PPCM_VERSION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_ARCHIVE_DEST
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_ARCHIVE_DEST
  for PRODUCAO.QUEST_SOO_ARCHIVE_DEST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_APPNAME
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_APPNAME
  for PRODUCAO.QUEST_SOO_AT_APPNAME@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_EXECUTION_PLAN
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_EXECUTION_PLAN
  for PRODUCAO.QUEST_SOO_AT_EXECUTION_PLAN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_OPERATIONS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_OPERATIONS
  for PRODUCAO.QUEST_SOO_AT_OPERATIONS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_PARSE_CURSOR
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_PARSE_CURSOR
  for PRODUCAO.QUEST_SOO_AT_PARSE_CURSOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_PARSE_ERROR
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_PARSE_ERROR
  for PRODUCAO.QUEST_SOO_AT_PARSE_ERROR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_PARSE_WAITS
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_PARSE_WAITS
  for PRODUCAO.QUEST_SOO_AT_PARSE_WAITS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_SESSION_ID
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_SESSION_ID
  for PRODUCAO.QUEST_SOO_AT_SESSION_ID@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_SQL_BINDS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_SQL_BINDS
  for PRODUCAO.QUEST_SOO_AT_SQL_BINDS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_SQL_EXEC_ERROR
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_SQL_EXEC_ERROR
  for PRODUCAO.QUEST_SOO_AT_SQL_EXEC_ERROR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_SQL_EXECUTIONS
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_SQL_EXECUTIONS
  for PRODUCAO.QUEST_SOO_AT_SQL_EXECUTIONS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_SQL_FETCH
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_SQL_FETCH
  for PRODUCAO.QUEST_SOO_AT_SQL_FETCH@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_SQL_STATEMENT
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_SQL_STATEMENT
  for PRODUCAO.QUEST_SOO_AT_SQL_STATEMENT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_SQL_STMT_PIECES
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_SQL_STMT_PIECES
  for PRODUCAO.QUEST_SOO_AT_SQL_STMT_PIECES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_SQL_WAITS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_SQL_WAITS
  for PRODUCAO.QUEST_SOO_AT_SQL_WAITS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_TRACE_FILE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_TRACE_FILE
  for PRODUCAO.QUEST_SOO_AT_TRACE_FILE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_AT_WAIT_NAMES
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_AT_WAIT_NAMES
  for PRODUCAO.QUEST_SOO_AT_WAIT_NAMES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_BUFFER_BUSY
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_BUFFER_BUSY
  for PRODUCAO.QUEST_SOO_BUFFER_BUSY@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_EVENT_CATEGORIES
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_EVENT_CATEGORIES
  for PRODUCAO.QUEST_SOO_EVENT_CATEGORIES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_LOCK_TREE
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_LOCK_TREE
  for PRODUCAO.QUEST_SOO_LOCK_TREE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_PARAMETERS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_PARAMETERS
  for PRODUCAO.QUEST_SOO_PARAMETERS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_PARSE_TIME_TRACK
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_PARSE_TIME_TRACK
  for PRODUCAO.QUEST_SOO_PARSE_TIME_TRACK@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_PLAN_TABLE
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_PLAN_TABLE
  for PRODUCAO.QUEST_SOO_PLAN_TABLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_SB_BUFFER_BUSY
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_SB_BUFFER_BUSY
  for PRODUCAO.QUEST_SOO_SB_BUFFER_BUSY@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_SB_EVENT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_SB_EVENT
  for PRODUCAO.QUEST_SOO_SB_EVENT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_SB_IO_STAT
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_SB_IO_STAT
  for PRODUCAO.QUEST_SOO_SB_IO_STAT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_SCHEMA_VERSIONS
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_SCHEMA_VERSIONS
  for PRODUCAO.QUEST_SOO_SCHEMA_VERSIONS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_TRACE_ENTRIES
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_TRACE_ENTRIES
  for PRODUCAO.QUEST_SOO_TRACE_ENTRIES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym QUEST_SOO_VERSION
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.QUEST_SOO_VERSION
  for PRODUCAO.QUEST_SOO_VERSION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RADAR_TISS_DIAG_TERAP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.RADAR_TISS_DIAG_TERAP
  for PRODUCAO.RADAR_TISS_DIAG_TERAP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RAMO_ATIVIDADE
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.RAMO_ATIVIDADE
  for PRODUCAO.RAMO_ATIVIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RAMO_NEGOC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.RAMO_NEGOC
  for EMS5.RAMO_NEGOC;

prompt
prompt Creating synonym RAT_CTBL
prompt =========================
prompt
create or replace synonym EMS506UNICOO.RAT_CTBL
  for EMS5.RAT_CTBL;

prompt
prompt Creating synonym RAT_CTBL_CONTROL_CX
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.RAT_CTBL_CONTROL_CX
  for EMS5.RAT_CTBL_CONTROL_CX;

prompt
prompt Creating synonym RAT_CTBL_DEST
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.RAT_CTBL_DEST
  for EMS5.RAT_CTBL_DEST;

prompt
prompt Creating synonym RAT_CTBL_DEST_MAPA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.RAT_CTBL_DEST_MAPA
  for EMS5.RAT_CTBL_DEST_MAPA;

prompt
prompt Creating synonym RAT_CTBL_ORIG
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.RAT_CTBL_ORIG
  for EMS5.RAT_CTBL_ORIG;

prompt
prompt Creating synonym RAT_DESPES
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.RAT_DESPES
  for EMS5.RAT_DESPES;

prompt
prompt Creating synonym RAT_FINANC_CMG
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.RAT_FINANC_CMG
  for EMS5.RAT_FINANC_CMG;

prompt
prompt Creating synonym RAT_MOVTO_TIT_ACR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.RAT_MOVTO_TIT_ACR
  for EMS5.RAT_MOVTO_TIT_ACR;

prompt
prompt Creating synonym RAT_MOVTO_TIT_AP
prompt =================================
prompt
create or replace synonym EMS506UNICOO.RAT_MOVTO_TIT_AP
  for EMS5.RAT_MOVTO_TIT_AP;

prompt
prompt Creating synonym RAT_OPERAC_FINANC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.RAT_OPERAC_FINANC
  for EMS5.RAT_OPERAC_FINANC;

prompt
prompt Creating synonym RAT_PADR_APL
prompt =============================
prompt
create or replace synonym EMS506UNICOO.RAT_PADR_APL
  for EMS5.RAT_PADR_APL;

prompt
prompt Creating synonym RAT_PADR_APL_UN_ESTAB
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.RAT_PADR_APL_UN_ESTAB
  for EMS5.RAT_PADR_APL_UN_ESTAB;

prompt
prompt Creating synonym RAT_PADR_PAGTO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.RAT_PADR_PAGTO
  for EMS5.RAT_PADR_PAGTO;

prompt
prompt Creating synonym RAT_PARAM_CTBZ
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.RAT_PARAM_CTBZ
  for EMS5.RAT_PARAM_CTBZ;

prompt
prompt Creating synonym RATEIO
prompt =======================
prompt
create or replace synonym EMS506UNICOO.RATEIO
  for PRODUCAO.RATEIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RATEIO_TEMP
prompt ============================
prompt
create or replace synonym EMS506UNICOO.RATEIO_TEMP
  for PRODUCAO.RATEIO_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RATMOTIVMOVTOTITACR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.RATMOTIVMOVTOTITACR
  for EMS5.RATMOTIVMOVTOTITACR;

prompt
prompt Creating synonym REAJUSTE_CONTRATO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.REAJUSTE_CONTRATO
  for PRODUCAO.REAJUSTE_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REAJUSTE_CONTRATO_PADRAO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.REAJUSTE_CONTRATO_PADRAO
  for PRODUCAO.REAJUSTE_CONTRATO_PADRAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REAJUSTE_CONTRATO_PESSOA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.REAJUSTE_CONTRATO_PESSOA
  for PRODUCAO.REAJUSTE_CONTRATO_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REAJUSTE_CONTRATO_PLANO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.REAJUSTE_CONTRATO_PLANO
  for PRODUCAO.REAJUSTE_CONTRATO_PLANO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REAJUSTE_JUSTIFICATIVA_RPC
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.REAJUSTE_JUSTIFICATIVA_RPC
  for PRODUCAO.REAJUSTE_JUSTIFICATIVA_RPC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REAJUSTE_PADRAO_CATEGORIA
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.REAJUSTE_PADRAO_CATEGORIA
  for PRODUCAO.REAJUSTE_PADRAO_CATEGORIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RECEITA_BRUTA_PERIODO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.RECEITA_BRUTA_PERIODO
  for PRODUCAO.RECEITA_BRUTA_PERIODO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RECEITA_DIVERSA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.RECEITA_DIVERSA
  for PRODUCAO.RECEITA_DIVERSA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RECEP_MSG_EDI
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.RECEP_MSG_EDI
  for EMS5.RECEP_MSG_EDI;

prompt
prompt Creating synonym RECIBO
prompt =======================
prompt
create or replace synonym EMS506UNICOO.RECIBO
  for EMS5.RECIBO;

prompt
prompt Creating synonym RECIBO_TROCA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.RECIBO_TROCA
  for PRODUCAO.RECIBO_TROCA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RECOLHTO_RECTA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.RECOLHTO_RECTA
  for EMS5.RECOLHTO_RECTA;

prompt
prompt Creating synonym RECURSO_PERICIA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.RECURSO_PERICIA
  for PRODUCAO.RECURSO_PERICIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REDE_ATENDIMENTO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.REDE_ATENDIMENTO
  for PRODUCAO.REDE_ATENDIMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REDE_ATENDIMENTO_CONTRATO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.REDE_ATENDIMENTO_CONTRATO
  for PRODUCAO.REDE_ATENDIMENTO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REDE_ATENDIMENTO_DETALHE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.REDE_ATENDIMENTO_DETALHE
  for PRODUCAO.REDE_ATENDIMENTO_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REDE_ATENDIMENTO_PADRAO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.REDE_ATENDIMENTO_PADRAO
  for PRODUCAO.REDE_ATENDIMENTO_PADRAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REDE_ATENDIMENTO_PLANO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REDE_ATENDIMENTO_PLANO
  for PRODUCAO.REDE_ATENDIMENTO_PLANO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REDE_REFERENCIA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.REDE_REFERENCIA
  for PRODUCAO.REDE_REFERENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REDE_REFERENCIA_PREST
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.REDE_REFERENCIA_PREST
  for PRODUCAO.REDE_REFERENCIA_PREST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REEMBOLSO_USUARIO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.REEMBOLSO_USUARIO
  for PRODUCAO.REEMBOLSO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REFER_INTEGR_CMG
prompt =================================
prompt
create or replace synonym EMS506UNICOO.REFER_INTEGR_CMG
  for EMS5.REFER_INTEGR_CMG;

prompt
prompt Creating synonym REFERENCIA
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.REFERENCIA
  for PRODUCAO.REFERENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REFERENCIA_CONTABIL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.REFERENCIA_CONTABIL
  for PRODUCAO.REFERENCIA_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REFERENCIA_DE_PRODUCAO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REFERENCIA_DE_PRODUCAO
  for PRODUCAO.REFERENCIA_DE_PRODUCAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REFERENCIA_FATURAMENTO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REFERENCIA_FATURAMENTO
  for PRODUCAO.REFERENCIA_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REFERENCIA_GRUPO_FUNCIONARIO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.REFERENCIA_GRUPO_FUNCIONARIO
  for PRODUCAO.REFERENCIA_GRUPO_FUNCIONARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REFERENCIA_NOTA_FISCAL_ENTRADA
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.REFERENCIA_NOTA_FISCAL_ENTRADA
  for PRODUCAO.REFERENCIA_NOTA_FISCAL_ENTRADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REFERENCIA_PERIODO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.REFERENCIA_PERIODO
  for PRODUCAO.REFERENCIA_PERIODO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REG_CALC_BEM_PAT
prompt =================================
prompt
create or replace synonym EMS506UNICOO.REG_CALC_BEM_PAT
  for EMS5.REG_CALC_BEM_PAT;

prompt
prompt Creating synonym REG_LAYOUT_FISC
prompt ================================
prompt
create or replace synonym EMS506UNICOO.REG_LAYOUT_FISC
  for EMS5.REG_LAYOUT_FISC;

prompt
prompt Creating synonym REG_MOVTO_ALOC_BEM_PAT
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REG_MOVTO_ALOC_BEM_PAT
  for EMS5.REG_MOVTO_ALOC_BEM_PAT;

prompt
prompt Creating synonym REG_MOVTO_BEM_PAT
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.REG_MOVTO_BEM_PAT
  for EMS5.REG_MOVTO_BEM_PAT;

prompt
prompt Creating synonym REG_MOVTO_INCORP_BEM
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.REG_MOVTO_INCORP_BEM
  for EMS5.REG_MOVTO_INCORP_BEM;

prompt
prompt Creating synonym REG_MOVTO_PARAM_CALC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.REG_MOVTO_PARAM_CALC
  for EMS5.REG_MOVTO_PARAM_CALC;

prompt
prompt Creating synonym REG_PLANILHA_ORCTARIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.REG_PLANILHA_ORCTARIA
  for EMS5.REG_PLANILHA_ORCTARIA;

prompt
prompt Creating synonym REG_PROCES_ENTR_EDI
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.REG_PROCES_ENTR_EDI
  for EMS5.REG_PROCES_ENTR_EDI;

prompt
prompt Creating synonym REG_PROCES_SAIDA_EDI
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.REG_PROCES_SAIDA_EDI
  for EMS5.REG_PROCES_SAIDA_EDI;

prompt
prompt Creating synonym REGIAO_TRIBUTARIA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.REGIAO_TRIBUTARIA
  for PRODUCAO.REGIAO_TRIBUTARIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REGISTRO_AUXILIAR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.REGISTRO_AUXILIAR
  for PRODUCAO.REGISTRO_AUXILIAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REGRA_CALC_VAR_ORCTO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.REGRA_CALC_VAR_ORCTO
  for EMS5.REGRA_CALC_VAR_ORCTO;

prompt
prompt Creating synonym REGRA_DESC_FAT_CONTRATO_PESSOA
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.REGRA_DESC_FAT_CONTRATO_PESSOA
  for PRODUCAO.REGRA_DESC_FAT_CONTRATO_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REGRA_DESCONTO_FAT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.REGRA_DESCONTO_FAT
  for PRODUCAO.REGRA_DESCONTO_FAT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REGRA_DESCONTO_FAT_DETALHE
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.REGRA_DESCONTO_FAT_DETALHE
  for PRODUCAO.REGRA_DESCONTO_FAT_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REGRA_MSG_USUAR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.REGRA_MSG_USUAR
  for EMS5.REGRA_MSG_USUAR;

prompt
prompt Creating synonym REGRA_PAGTO_CX
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.REGRA_PAGTO_CX
  for EMS5.REGRA_PAGTO_CX;

prompt
prompt Creating synonym REGRA_PERDA_DEDUT
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.REGRA_PERDA_DEDUT
  for EMS5.REGRA_PERDA_DEDUT;

prompt
prompt Creating synonym REGRA_RANKING_BCIO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.REGRA_RANKING_BCIO
  for EMS5.REGRA_RANKING_BCIO;

prompt
prompt Creating synonym REGRA_RETORNO_AREA_ACAO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.REGRA_RETORNO_AREA_ACAO
  for PRODUCAO.REGRA_RETORNO_AREA_ACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REGRA_RETORNO_INTERC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.REGRA_RETORNO_INTERC
  for PRODUCAO.REGRA_RETORNO_INTERC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REGRA_RETORNO_INTERC_DETALHE
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.REGRA_RETORNO_INTERC_DETALHE
  for PRODUCAO.REGRA_RETORNO_INTERC_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REGRA_USUAR_INADIMP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.REGRA_USUAR_INADIMP
  for EMS5.REGRA_USUAR_INADIMP;

prompt
prompt Creating synonym REGRACONCILCTACORREN
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.REGRACONCILCTACORREN
  for EMS5.REGRACONCILCTACORREN;

prompt
prompt Creating synonym REL_UTILIZACAO_USUARIO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REL_UTILIZACAO_USUARIO
  for PRODUCAO.REL_UTILIZACAO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REL_VALIDACAO_CADASTRO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REL_VALIDACAO_CADASTRO
  for PRODUCAO.REL_VALIDACAO_CADASTRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RELAC_MOVTO_TIT_AP_AVP
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.RELAC_MOVTO_TIT_AP_AVP
  for EMS5.RELAC_MOVTO_TIT_AP_AVP;

prompt
prompt Creating synonym RELAC_PARC_CARTCRED
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.RELAC_PARC_CARTCRED
  for EMS5.RELAC_PARC_CARTCRED;

prompt
prompt Creating synonym RELACAPROPLEASINCORP
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.RELACAPROPLEASINCORP
  for EMS5.RELACAPROPLEASINCORP;

prompt
prompt Creating synonym RELACMOVTOCOBRINADIMP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.RELACMOVTOCOBRINADIMP
  for EMS5.RELACMOVTOCOBRINADIMP;

prompt
prompt Creating synonym RELACMOVTOCOBRTITACR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.RELACMOVTOCOBRTITACR
  for EMS5.RELACMOVTOCOBRTITACR;

prompt
prompt Creating synonym RELACMOVTOTITACRAVP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.RELACMOVTOTITACRAVP
  for EMS5.RELACMOVTOTITACRAVP;

prompt
prompt Creating synonym RELACTO_ACUM_PAGTO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_ACUM_PAGTO
  for EMS5.RELACTO_ACUM_PAGTO;

prompt
prompt Creating synonym RELACTO_CHEQ_ACR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_CHEQ_ACR
  for EMS5.RELACTO_CHEQ_ACR;

prompt
prompt Creating synonym RELACTO_CHEQ_ACR_AP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_CHEQ_ACR_AP
  for EMS5.RELACTO_CHEQ_ACR_AP;

prompt
prompt Creating synonym RELACTO_CLIEN_TERC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_CLIEN_TERC
  for EMS5.RELACTO_CLIEN_TERC;

prompt
prompt Creating synonym RELACTO_DEVOL_TIT_ACR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_DEVOL_TIT_ACR
  for EMS5.RELACTO_DEVOL_TIT_ACR;

prompt
prompt Creating synonym RELACTO_IVA_CHEQ_ACR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_IVA_CHEQ_ACR
  for EMS5.RELACTO_IVA_CHEQ_ACR;

prompt
prompt Creating synonym RELACTO_MOVTO_COMIS
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_MOVTO_COMIS
  for EMS5.RELACTO_MOVTO_COMIS;

prompt
prompt Creating synonym RELACTO_PARTICIP
prompt =================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_PARTICIP
  for EMS5.RELACTO_PARTICIP;

prompt
prompt Creating synonym RELACTO_PEND_CHEQ_ACR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_PEND_CHEQ_ACR
  for EMS5.RELACTO_PEND_CHEQ_ACR;

prompt
prompt Creating synonym RELACTO_PEND_TIT_ACR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_PEND_TIT_ACR
  for EMS5.RELACTO_PEND_TIT_ACR;

prompt
prompt Creating synonym RELACTO_PEND_TIT_AP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_PEND_TIT_AP
  for EMS5.RELACTO_PEND_TIT_AP;

prompt
prompt Creating synonym RELACTO_PROCESS_INTEGR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_PROCESS_INTEGR
  for EMS5.RELACTO_PROCESS_INTEGR;

prompt
prompt Creating synonym RELACTO_REG_PLANILHA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_REG_PLANILHA
  for EMS5.RELACTO_REG_PLANILHA;

prompt
prompt Creating synonym RELACTO_TIT_ACR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_TIT_ACR
  for EMS5.RELACTO_TIT_ACR;

prompt
prompt Creating synonym RELACTO_TIT_AP
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.RELACTO_TIT_AP
  for EMS5.RELACTO_TIT_AP;

prompt
prompt Creating synonym RELACTO_TIT_EM_BCO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_TIT_EM_BCO
  for EMS5.RELACTO_TIT_EM_BCO;

prompt
prompt Creating synonym RELACTO_UNID_ORCTARIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.RELACTO_UNID_ORCTARIA
  for EMS5.RELACTO_UNID_ORCTARIA;

prompt
prompt Creating synonym RELACTOLANCTOPARTICIP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.RELACTOLANCTOPARTICIP
  for EMS5.RELACTOLANCTOPARTICIP;

prompt
prompt Creating synonym RELACTOPARTICIPPESSOA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.RELACTOPARTICIPPESSOA
  for EMS5.RELACTOPARTICIPPESSOA;

prompt
prompt Creating synonym REM_ARQUIVO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.REM_ARQUIVO
  for PRODUCAO.REM_ARQUIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CAMPO
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.REM_CAMPO
  for PRODUCAO.REM_CAMPO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CAMPO_ITAU
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.REM_CAMPO_ITAU
  for PRODUCAO.REM_CAMPO_ITAU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CATEGORIA_LANCAMENTO_BANCO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.REM_CATEGORIA_LANCAMENTO_BANCO
  for PRODUCAO.REM_CATEGORIA_LANCAMENTO_BANCO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_COB_PARC_TEMP_ANS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.REM_COB_PARC_TEMP_ANS
  for PRODUCAO.REM_COB_PARC_TEMP_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_COMANDO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.REM_COMANDO
  for PRODUCAO.REM_COMANDO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_COMANDO_BCO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.REM_COMANDO_BCO
  for PRODUCAO.REM_COMANDO_BCO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CONTR_TP_PLANO_PROD
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.REM_CONTR_TP_PLANO_PROD
  for PRODUCAO.REM_CONTR_TP_PLANO_PROD@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CONTROLE_A400_TEMP
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REM_CONTROLE_A400_TEMP
  for PRODUCAO.REM_CONTROLE_A400_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CONTROLE_A500_TEMP
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REM_CONTROLE_A500_TEMP
  for PRODUCAO.REM_CONTROLE_A500_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CONTROLE_A550_TEMP
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REM_CONTROLE_A550_TEMP
  for PRODUCAO.REM_CONTROLE_A550_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CONTROLE_ARQUIVO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.REM_CONTROLE_ARQUIVO
  for PRODUCAO.REM_CONTROLE_ARQUIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CONTROLE_BENEF_ANS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REM_CONTROLE_BENEF_ANS
  for PRODUCAO.REM_CONTROLE_BENEF_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CONTROLE_DEVOLUCAO_ERRO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.REM_CONTROLE_DEVOLUCAO_ERRO
  for PRODUCAO.REM_CONTROLE_DEVOLUCAO_ERRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CONTROLE_GERACAO_A550
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.REM_CONTROLE_GERACAO_A550
  for PRODUCAO.REM_CONTROLE_GERACAO_A550@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CONTROLE_LOG
prompt =================================
prompt
create or replace synonym EMS506UNICOO.REM_CONTROLE_LOG
  for PRODUCAO.REM_CONTROLE_LOG@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CONTROLE_REMESSA_PRODUTO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.REM_CONTROLE_REMESSA_PRODUTO
  for PRODUCAO.REM_CONTROLE_REMESSA_PRODUTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CONTROLE_REMESSA_USU_PROD
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.REM_CONTROLE_REMESSA_USU_PROD
  for PRODUCAO.REM_CONTROLE_REMESSA_USU_PROD@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CONTROLE_REMESSA_USUARIO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.REM_CONTROLE_REMESSA_USUARIO
  for PRODUCAO.REM_CONTROLE_REMESSA_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CONVERSAO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.REM_CONVERSAO
  for PRODUCAO.REM_CONVERSAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CONVERSAO_CAMPO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.REM_CONVERSAO_CAMPO
  for PRODUCAO.REM_CONVERSAO_CAMPO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_CTRLE_REM_USUARIO_ENVIO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.REM_CTRLE_REM_USUARIO_ENVIO
  for PRODUCAO.REM_CTRLE_REM_USUARIO_ENVIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_DESTINATARIO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.REM_DESTINATARIO
  for PRODUCAO.REM_DESTINATARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_ESPECIE_TITULO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.REM_ESPECIE_TITULO
  for PRODUCAO.REM_ESPECIE_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_EVENTO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.REM_EVENTO
  for PRODUCAO.REM_EVENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_FORMULA
prompt ============================
prompt
create or replace synonym EMS506UNICOO.REM_FORMULA
  for PRODUCAO.REM_FORMULA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_GERACAO_ARQUIVO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.REM_GERACAO_ARQUIVO
  for PRODUCAO.REM_GERACAO_ARQUIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_GRUPO_INFORMACAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.REM_GRUPO_INFORMACAO
  for PRODUCAO.REM_GRUPO_INFORMACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_GRUPO_PRODUTO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.REM_GRUPO_PRODUTO
  for PRODUCAO.REM_GRUPO_PRODUTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_IMP_CCO_BENEF_ANS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.REM_IMP_CCO_BENEF_ANS
  for PRODUCAO.REM_IMP_CCO_BENEF_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_IMP_CONTROLE_A550
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.REM_IMP_CONTROLE_A550
  for PRODUCAO.REM_IMP_CONTROLE_A550@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_IMP_CONTROLE_BENEF_ANS
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.REM_IMP_CONTROLE_BENEF_ANS
  for PRODUCAO.REM_IMP_CONTROLE_BENEF_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_IMP_CONTROLE_TRANSF
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.REM_IMP_CONTROLE_TRANSF
  for PRODUCAO.REM_IMP_CONTROLE_TRANSF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_IMP_DIFERENCA_ANS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.REM_IMP_DIFERENCA_ANS
  for PRODUCAO.REM_IMP_DIFERENCA_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_IMP_MASSA_BENEF_ANS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.REM_IMP_MASSA_BENEF_ANS
  for PRODUCAO.REM_IMP_MASSA_BENEF_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_IMP_MASSA_DETALHE_ERROS
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.REM_IMP_MASSA_DETALHE_ERROS
  for PRODUCAO.REM_IMP_MASSA_DETALHE_ERROS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_IMP_MOTIVO_QUEST
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.REM_IMP_MOTIVO_QUEST
  for PRODUCAO.REM_IMP_MOTIVO_QUEST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_IMP_PTC_BENEF_ANS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.REM_IMP_PTC_BENEF_ANS
  for PRODUCAO.REM_IMP_PTC_BENEF_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_IMP_PTC_BENEF_ANS_DETALHE
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.REM_IMP_PTC_BENEF_ANS_DETALHE
  for PRODUCAO.REM_IMP_PTC_BENEF_ANS_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_IMP_QUESTIONAMENTO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REM_IMP_QUESTIONAMENTO
  for PRODUCAO.REM_IMP_QUESTIONAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_INFORMACAO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.REM_INFORMACAO
  for PRODUCAO.REM_INFORMACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_INFORMACAO_MASCARA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REM_INFORMACAO_MASCARA
  for PRODUCAO.REM_INFORMACAO_MASCARA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_INSTRUCAO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.REM_INSTRUCAO
  for PRODUCAO.REM_INSTRUCAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_INSTRUCAO_BCO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.REM_INSTRUCAO_BCO
  for PRODUCAO.REM_INSTRUCAO_BCO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_ITEM_PROC_EXC_ANS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.REM_ITEM_PROC_EXC_ANS
  for PRODUCAO.REM_ITEM_PROC_EXC_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_MASSA_BENEF_ANS
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.REM_MASSA_BENEF_ANS
  for PRODUCAO.REM_MASSA_BENEF_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_MASSA_PRODUTO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.REM_MASSA_PRODUTO
  for PRODUCAO.REM_MASSA_PRODUTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_MASSA_USU_PROD
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.REM_MASSA_USU_PROD
  for PRODUCAO.REM_MASSA_USU_PROD@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_MASSA_USUARIO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.REM_MASSA_USUARIO
  for PRODUCAO.REM_MASSA_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_MOTIVO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.REM_MOTIVO
  for PRODUCAO.REM_MOTIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_MOTIVO_BCO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.REM_MOTIVO_BCO
  for PRODUCAO.REM_MOTIVO_BCO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_MOVIMENTACAO_USU_PROD
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.REM_MOVIMENTACAO_USU_PROD
  for PRODUCAO.REM_MOVIMENTACAO_USU_PROD@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_MOVIMENTACAO_USUARIO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.REM_MOVIMENTACAO_USUARIO
  for PRODUCAO.REM_MOVIMENTACAO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_MOVIMENTO_CALC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.REM_MOVIMENTO_CALC
  for PRODUCAO.REM_MOVIMENTO_CALC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_MOVIMENTO_HEADER
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.REM_MOVIMENTO_HEADER
  for PRODUCAO.REM_MOVIMENTO_HEADER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_PARAMETRO_GERACAO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.REM_PARAMETRO_GERACAO
  for PRODUCAO.REM_PARAMETRO_GERACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_PRODUTO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.REM_PRODUTO
  for PRODUCAO.REM_PRODUTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_REGISTRO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.REM_REGISTRO
  for PRODUCAO.REM_REGISTRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_REGISTRO_DETALHE
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.REM_REGISTRO_DETALHE
  for PRODUCAO.REM_REGISTRO_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_REMESSA_BENEF_ANS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.REM_REMESSA_BENEF_ANS
  for PRODUCAO.REM_REMESSA_BENEF_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_REMESSA_BENEF_ANS_DETALHE
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.REM_REMESSA_BENEF_ANS_DETALHE
  for PRODUCAO.REM_REMESSA_BENEF_ANS_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_REMESSA_BENEF_IN35
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REM_REMESSA_BENEF_IN35
  for PRODUCAO.REM_REMESSA_BENEF_IN35@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_TAB_CONVERSAO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.REM_TAB_CONVERSAO
  for PRODUCAO.REM_TAB_CONVERSAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_TAB_CONVERSAO_EXP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.REM_TAB_CONVERSAO_EXP
  for PRODUCAO.REM_TAB_CONVERSAO_EXP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_TAB_CONVERSAO_IMP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.REM_TAB_CONVERSAO_IMP
  for PRODUCAO.REM_TAB_CONVERSAO_IMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_TIPO_INFORMACAO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.REM_TIPO_INFORMACAO
  for PRODUCAO.REM_TIPO_INFORMACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_TIPO_PLANO_PRODUTO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REM_TIPO_PLANO_PRODUTO
  for PRODUCAO.REM_TIPO_PLANO_PRODUTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_TIPO_REGISTRO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.REM_TIPO_REGISTRO
  for PRODUCAO.REM_TIPO_REGISTRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REM_USUARIO_REMESSA_PRODUTO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.REM_USUARIO_REMESSA_PRODUTO
  for PRODUCAO.REM_USUARIO_REMESSA_PRODUTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REMT_FALTA
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.REMT_FALTA
  for PRODUCAO.REMT_FALTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REMUN_ADMDRA_CARTAO_CR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REMUN_ADMDRA_CARTAO_CR
  for EMS5.REMUN_ADMDRA_CARTAO_CR;

prompt
prompt Creating synonym REMUN_PARC_CARTAO_CR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.REMUN_PARC_CARTAO_CR
  for EMS5.REMUN_PARC_CARTAO_CR;

prompt
prompt Creating synonym RENEGOC_ACR
prompt ============================
prompt
create or replace synonym EMS506UNICOO.RENEGOC_ACR
  for EMS5.RENEGOC_ACR;

prompt
prompt Creating synonym RENEGOC_INADIMP
prompt ================================
prompt
create or replace synonym EMS506UNICOO.RENEGOC_INADIMP
  for EMS5.RENEGOC_INADIMP;

prompt
prompt Creating synonym RENEGOC_INADIMP_VENCTO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.RENEGOC_INADIMP_VENCTO
  for EMS5.RENEGOC_INADIMP_VENCTO;

prompt
prompt Creating synonym RENEGOC_TERC
prompt =============================
prompt
create or replace synonym EMS506UNICOO.RENEGOC_TERC
  for EMS5.RENEGOC_TERC;

prompt
prompt Creating synonym RENOVACAO_CONTRATO_PRE_AUTORIZ
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.RENOVACAO_CONTRATO_PRE_AUTORIZ
  for PRODUCAO.RENOVACAO_CONTRATO_PRE_AUTORIZ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REORGTAB
prompt =========================
prompt
create or replace synonym EMS506UNICOO.REORGTAB
  for PRODUCAO.REORGTAB@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REPAS_CONCES_TELEF
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.REPAS_CONCES_TELEF
  for EMS5.REPAS_CONCES_TELEF;

prompt
prompt Creating synonym REPAS_PEND_APL
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.REPAS_PEND_APL
  for EMS5.REPAS_PEND_APL;

prompt
prompt Creating synonym REPASSE_DO_USUARIO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.REPASSE_DO_USUARIO
  for PRODUCAO.REPASSE_DO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym REPRES_FINANC
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.REPRES_FINANC
  for EMS5.REPRES_FINANC;

prompt
prompt Creating synonym REPRES_TIT_ACR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.REPRES_TIT_ACR
  for EMS5.REPRES_TIT_ACR;

prompt
prompt Creating synonym REPRES_TIT_ACR_FECHADO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.REPRES_TIT_ACR_FECHADO
  for EMS5.REPRES_TIT_ACR_FECHADO;

prompt
prompt Creating synonym REPRES_TIT_ACR_PEND
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.REPRES_TIT_ACR_PEND
  for EMS5.REPRES_TIT_ACR_PEND;

prompt
prompt Creating synonym REPRESENTANTE
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.REPRESENTANTE
  for EMS5.REPRESENTANTE;

prompt
prompt Creating synonym REQUISIT_EXCL_FATOR_MODERADOR
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.REQUISIT_EXCL_FATOR_MODERADOR
  for PRODUCAO.REQUISIT_EXCL_FATOR_MODERADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RESERVA_SOLICIT_VIAGEM
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.RESERVA_SOLICIT_VIAGEM
  for EMS5.RESERVA_SOLICIT_VIAGEM;

prompt
prompt Creating synonym RESIDUO_ACAOCAP
prompt ================================
prompt
create or replace synonym EMS506UNICOO.RESIDUO_ACAOCAP
  for EMS5.RESIDUO_ACAOCAP;

prompt
prompt Creating synonym RESPONSAVEL_TI
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.RESPONSAVEL_TI
  for PRODUCAO.RESPONSAVEL_TI@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RESTRIC_CCUSTO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.RESTRIC_CCUSTO
  for EMS5.RESTRIC_CCUSTO;

prompt
prompt Creating synonym RESTRIC_CLAS_RISCO_CMG
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.RESTRIC_CLAS_RISCO_CMG
  for EMS5.RESTRIC_CLAS_RISCO_CMG;

prompt
prompt Creating synonym RESULTADO_CUSTO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.RESULTADO_CUSTO
  for PRODUCAO.RESULTADO_CUSTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RESULTADO_USUARIO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.RESULTADO_USUARIO
  for PRODUCAO.RESULTADO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RESUMO_DETALHE_DIRF
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.RESUMO_DETALHE_DIRF
  for PRODUCAO.RESUMO_DETALHE_DIRF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RESUMO_DETALHE_FATURAMENTO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.RESUMO_DETALHE_FATURAMENTO
  for PRODUCAO.RESUMO_DETALHE_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RESUMO_DUPLICATA_FATURAMENTO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.RESUMO_DUPLICATA_FATURAMENTO
  for PRODUCAO.RESUMO_DUPLICATA_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RESUMO_MOVIMENTO_USUARIO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.RESUMO_MOVIMENTO_USUARIO
  for PRODUCAO.RESUMO_MOVIMENTO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RESUMO_PAGAMENTO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.RESUMO_PAGAMENTO
  for PRODUCAO.RESUMO_PAGAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RETIRADA_DE_TALAO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.RETIRADA_DE_TALAO
  for PRODUCAO.RETIRADA_DE_TALAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RETORNO_CLIENTE
prompt ================================
prompt
create or replace synonym EMS506UNICOO.RETORNO_CLIENTE
  for PRODUCAO.RETORNO_CLIENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RETORNO_TITULO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.RETORNO_TITULO
  for PRODUCAO.RETORNO_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RETORNO_TITULO_COPIA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.RETORNO_TITULO_COPIA
  for PRODUCAO.RETORNO_TITULO_COPIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RETORNO_TITULO_MOTIVO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.RETORNO_TITULO_MOTIVO
  for PRODUCAO.RETORNO_TITULO_MOTIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RETORNO_TITULO_PAGAR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.RETORNO_TITULO_PAGAR
  for PRODUCAO.RETORNO_TITULO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RETORNO_TITULO_PAGAR_MOTIVO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.RETORNO_TITULO_PAGAR_MOTIVO
  for PRODUCAO.RETORNO_TITULO_PAGAR_MOTIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RIGHT
prompt ======================
prompt
create or replace synonym EMS506UNICOO.RIGHT
  for PRODUCAO.RIGHT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym RISCO_COBR_ATIV
prompt ================================
prompt
create or replace synonym EMS506UNICOO.RISCO_COBR_ATIV
  for EMS5.RISCO_COBR_ATIV;

prompt
prompt Creating synonym ROGERIO_346128
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.ROGERIO_346128
  for PRODUCAO.ROGERIO_346128@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ROL_PROCEDIMENTO_ANS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.ROL_PROCEDIMENTO_ANS
  for PRODUCAO.ROL_PROCEDIMENTO_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ROTA_EEC
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ROTA_EEC
  for EMS5.ROTA_EEC;

prompt
prompt Creating synonym ROTA_EMPRES_TRANSP_EEC
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ROTA_EMPRES_TRANSP_EEC
  for EMS5.ROTA_EMPRES_TRANSP_EEC;

prompt
prompt Creating synonym ROTEI_VIAGEM_EEC
prompt =================================
prompt
create or replace synonym EMS506UNICOO.ROTEI_VIAGEM_EEC
  for EMS5.ROTEI_VIAGEM_EEC;

prompt
prompt Creating synonym ROTINA_CALCULO_PAGA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.ROTINA_CALCULO_PAGA
  for PRODUCAO.ROTINA_CALCULO_PAGA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ROTINA_CALCULO_PAGAMENTO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.ROTINA_CALCULO_PAGAMENTO
  for PRODUCAO.ROTINA_CALCULO_PAGAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ROTINA_COMISSAO_VENDAS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.ROTINA_COMISSAO_VENDAS
  for PRODUCAO.ROTINA_COMISSAO_VENDAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ROWTOCOL
prompt =========================
prompt
create or replace synonym EMS506UNICOO.ROWTOCOL
  for PRODUCAO.ROWTOCOL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SAIDAS_PREVISTAS
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SAIDAS_PREVISTAS
  for PRODUCAO.SAIDAS_PREVISTAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SALDO_CAIXA_DIARIO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SALDO_CAIXA_DIARIO
  for PRODUCAO.SALDO_CAIXA_DIARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SALDO_CENTRO_CUSTO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SALDO_CENTRO_CUSTO
  for PRODUCAO.SALDO_CENTRO_CUSTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SALDO_CONTAS
prompt =============================
prompt
create or replace synonym EMS506UNICOO.SALDO_CONTAS
  for PRODUCAO.SALDO_CONTAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SALES_TAX_TIT_ACR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SALES_TAX_TIT_ACR
  for EMS5.SALES_TAX_TIT_ACR;

prompt
prompt Creating synonym SALES_TAX_TIT_AP
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SALES_TAX_TIT_AP
  for EMS5.SALES_TAX_TIT_AP;

prompt
prompt Creating synonym SALESTAXITEMIMPLACR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SALESTAXITEMIMPLACR
  for EMS5.SALESTAXITEMIMPLACR;

prompt
prompt Creating synonym SALESTAXITEMIMPLAPB
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SALESTAXITEMIMPLAPB
  for EMS5.SALESTAXITEMIMPLAPB;

prompt
prompt Creating synonym SDO_ACR
prompt ========================
prompt
create or replace synonym EMS506UNICOO.SDO_ACR
  for EMS5.SDO_ACR;

prompt
prompt Creating synonym SDO_AP
prompt =======================
prompt
create or replace synonym EMS506UNICOO.SDO_AP
  for EMS5.SDO_AP;

prompt
prompt Creating synonym SDO_BEM_PAT
prompt ============================
prompt
create or replace synonym EMS506UNICOO.SDO_BEM_PAT
  for EMS5.SDO_BEM_PAT;

prompt
prompt Creating synonym SDO_CTA_CORREN
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.SDO_CTA_CORREN
  for EMS5.SDO_CTA_CORREN;

prompt
prompt Creating synonym SDO_CTA_CORREN_SPOOL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SDO_CTA_CORREN_SPOOL
  for EMS5.SDO_CTA_CORREN_SPOOL;

prompt
prompt Creating synonym SDO_CTA_CTBL
prompt =============================
prompt
create or replace synonym EMS506UNICOO.SDO_CTA_CTBL
  for EMS5.SDO_CTA_CTBL;

prompt
prompt Creating synonym SDO_CTA_CTBL_CCUSTO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SDO_CTA_CTBL_CCUSTO
  for EMS5.SDO_CTA_CTBL_CCUSTO;

prompt
prompt Creating synonym SDO_CTA_CTBL_CONSOLID
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SDO_CTA_CTBL_CONSOLID
  for EMS5.SDO_CTA_CTBL_CONSOLID;

prompt
prompt Creating synonym SDO_CTA_CTBL_MODUL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SDO_CTA_CTBL_MODUL
  for EMS5.SDO_CTA_CTBL_MODUL;

prompt
prompt Creating synonym SDO_CTBL
prompt =========================
prompt
create or replace synonym EMS506UNICOO.SDO_CTBL
  for EMS5.SDO_CTBL;

prompt
prompt Creating synonym SDO_FLUXO_CX
prompt =============================
prompt
create or replace synonym EMS506UNICOO.SDO_FLUXO_CX
  for EMS5.SDO_FLUXO_CX;

prompt
prompt Creating synonym SDO_FLUXO_CX_SPOOL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SDO_FLUXO_CX_SPOOL
  for EMS5.SDO_FLUXO_CX_SPOOL;

prompt
prompt Creating synonym SDO_IOF_PEND
prompt =============================
prompt
create or replace synonym EMS506UNICOO.SDO_IOF_PEND
  for EMS5.SDO_IOF_PEND;

prompt
prompt Creating synonym SDO_ORCTO_CTA_CCUSTO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SDO_ORCTO_CTA_CCUSTO
  for EMS5.SDO_ORCTO_CTA_CCUSTO;

prompt
prompt Creating synonym SDO_ORCTO_CTA_CTBL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SDO_ORCTO_CTA_CTBL
  for EMS5.SDO_ORCTO_CTA_CTBL;

prompt
prompt Creating synonym SDO_ORCTO_CTBL_BGC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SDO_ORCTO_CTBL_BGC
  for EMS5.SDO_ORCTO_CTBL_BGC;

prompt
prompt Creating synonym SEGMENT_EDI
prompt ============================
prompt
create or replace synonym EMS506UNICOO.SEGMENT_EDI
  for EMS5.SEGMENT_EDI;

prompt
prompt Creating synonym SEGMENT_ELEMENT_EDI
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SEGMENT_ELEMENT_EDI
  for EMS5.SEGMENT_ELEMENT_EDI;

prompt
prompt Creating synonym SEGUR_ACES_TAB
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.SEGUR_ACES_TAB
  for EMS5.SEGUR_ACES_TAB;

prompt
prompt Creating synonym SEGUR_AJUST_SIT_PERIOD
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_AJUST_SIT_PERIOD
  for EMS5.SEGUR_AJUST_SIT_PERIOD;

prompt
prompt Creating synonym SEGUR_CCUSTO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.SEGUR_CCUSTO
  for EMS5.SEGUR_CCUSTO;

prompt
prompt Creating synonym SEGUR_CENAR_CTBL
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_CENAR_CTBL
  for EMS5.SEGUR_CENAR_CTBL;

prompt
prompt Creating synonym SEGUR_CTA_CORREN
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_CTA_CORREN
  for EMS5.SEGUR_CTA_CORREN;

prompt
prompt Creating synonym SEGUR_DEMONST_CTBL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_DEMONST_CTBL
  for EMS5.SEGUR_DEMONST_CTBL;

prompt
prompt Creating synonym SEGUR_PADR_FLUXO_CX
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_PADR_FLUXO_CX
  for EMS5.SEGUR_PADR_FLUXO_CX;

prompt
prompt Creating synonym SEGUR_PLANO_CTA_CTBL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_PLANO_CTA_CTBL
  for EMS5.SEGUR_PLANO_CTA_CTBL;

prompt
prompt Creating synonym SEGUR_PROJ_FINANC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_PROJ_FINANC
  for EMS5.SEGUR_PROJ_FINANC;

prompt
prompt Creating synonym SEGUR_RESTRIC_CTA_CTBL
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_RESTRIC_CTA_CTBL
  for EMS5.SEGUR_RESTRIC_CTA_CTBL;

prompt
prompt Creating synonym SEGUR_RH_GRP_CCUSTO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_RH_GRP_CCUSTO
  for EMS5.SEGUR_RH_GRP_CCUSTO;

prompt
prompt Creating synonym SEGUR_TALON_CHEQ
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_TALON_CHEQ
  for EMS5.SEGUR_TALON_CHEQ;

prompt
prompt Creating synonym SEGUR_TIP_TRANS_CX
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_TIP_TRANS_CX
  for EMS5.SEGUR_TIP_TRANS_CX;

prompt
prompt Creating synonym SEGUR_UNID_CONTROL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_UNID_CONTROL
  for EMS5.SEGUR_UNID_CONTROL;

prompt
prompt Creating synonym SEGUR_UNID_FECHTO_CX
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_UNID_FECHTO_CX
  for EMS5.SEGUR_UNID_FECHTO_CX;

prompt
prompt Creating synonym SEGUR_UNID_NEGOC
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_UNID_NEGOC
  for EMS5.SEGUR_UNID_NEGOC;

prompt
prompt Creating synonym SEGUR_UNID_ORGAN
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_UNID_ORGAN
  for EMS5.SEGUR_UNID_ORGAN;

prompt
prompt Creating synonym SEGUR_VERS_ORCTO_BGC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_VERS_ORCTO_BGC
  for EMS5.SEGUR_VERS_ORCTO_BGC;

prompt
prompt Creating synonym SEGUR_VERS_ORCTO_CTBL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SEGUR_VERS_ORCTO_CTBL
  for EMS5.SEGUR_VERS_ORCTO_CTBL;

prompt
prompt Creating synonym SEGURADORA
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.SEGURADORA
  for EMS5.SEGURADORA;

prompt
prompt Creating synonym SEGURPADRBCOTIPCHEQ
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SEGURPADRBCOTIPCHEQ
  for EMS5.SEGURPADRBCOTIPCHEQ;

prompt
prompt Creating synonym SEGURPROCESPRESTACCTA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SEGURPROCESPRESTACCTA
  for EMS5.SEGURPROCESPRESTACCTA;

prompt
prompt Creating synonym SELECAO_DA_GUIA_APARTAM
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SELECAO_DA_GUIA_APARTAM
  for PRODUCAO.SELECAO_DA_GUIA_APARTAM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SELECAO_EMISSAO_PRE_AUTORIZ
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.SELECAO_EMISSAO_PRE_AUTORIZ
  for PRODUCAO.SELECAO_EMISSAO_PRE_AUTORIZ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SELECAO_LIQ_INSUFICIENTE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SELECAO_LIQ_INSUFICIENTE
  for PRODUCAO.SELECAO_LIQ_INSUFICIENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SELECAO_PRODUCAO_BASE_INSS
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.SELECAO_PRODUCAO_BASE_INSS
  for PRODUCAO.SELECAO_PRODUCAO_BASE_INSS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SELECAO_PRODUCAO_FOLHA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SELECAO_PRODUCAO_FOLHA
  for PRODUCAO.SELECAO_PRODUCAO_FOLHA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SELECAO_TEMP_TRANSF_CONTR
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SELECAO_TEMP_TRANSF_CONTR
  for PRODUCAO.SELECAO_TEMP_TRANSF_CONTR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SENHA_ORACLE
prompt =============================
prompt
create or replace synonym EMS506UNICOO.SENHA_ORACLE
  for PRODUCAO.SENHA_ORACLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SEQ_ESTRUT_UNID_ORGAN
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SEQ_ESTRUT_UNID_ORGAN
  for EMS5.SEQ_ESTRUT_UNID_ORGAN;

prompt
prompt Creating synonym SEQUENCIA_DIGITAL_USUARIO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SEQUENCIA_DIGITAL_USUARIO
  for PRODUCAO.SEQUENCIA_DIGITAL_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SER_FISC_NOTA
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.SER_FISC_NOTA
  for EMS5.SER_FISC_NOTA;

prompt
prompt Creating synonym SERIE_NOTA_FISCAL
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SERIE_NOTA_FISCAL
  for PRODUCAO.SERIE_NOTA_FISCAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERIE_RPS
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.SERIE_RPS
  for PRODUCAO.SERIE_RPS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERV_OPCIONAL_CONTRATO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SERV_OPCIONAL_CONTRATO
  for PRODUCAO.SERV_OPCIONAL_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERV_OPCIONAL_FAMILIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SERV_OPCIONAL_FAMILIA
  for PRODUCAO.SERV_OPCIONAL_FAMILIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERV_TIPO_DE_INTERNACAO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SERV_TIPO_DE_INTERNACAO
  for PRODUCAO.SERV_TIPO_DE_INTERNACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO
prompt ========================
prompt
create or replace synonym EMS506UNICOO.SERVICO
  for PRODUCAO.SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO31
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.SERVICO31
  for PRODUCAO.SERVICO31@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_01_02_2015
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_01_02_2015
  for PRODUCAO.SERVICO_01_02_2015@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_01_12_2014
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_01_12_2014
  for PRODUCAO.SERVICO_01_12_2014@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_06072015
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_06072015
  for PRODUCAO.SERVICO_06072015@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_19_11
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_19_11
  for PRODUCAO.SERVICO_19_11@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_2014
prompt =============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_2014
  for PRODUCAO.SERVICO_2014@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_2014_1
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_2014_1
  for PRODUCAO.SERVICO_2014_1@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_2014_BRASIL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_2014_BRASIL
  for PRODUCAO.SERVICO_2014_BRASIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_2014_UNIMEDNI
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_2014_UNIMEDNI
  for PRODUCAO.SERVICO_2014_UNIMEDNI@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_ANS
prompt ============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_ANS
  for PRODUCAO.SERVICO_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_BCK_DE_23_09_2014
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_BCK_DE_23_09_2014
  for PRODUCAO.SERVICO_BCK_DE_23_09_2014@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_BLABLA_OK
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_BLABLA_OK
  for PRODUCAO.SERVICO_BLABLA_OK@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_CARGA
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_CARGA
  for PRODUCAO.SERVICO_CARGA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_CARGA2
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_CARGA2
  for PRODUCAO.SERVICO_CARGA2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_CARGA3
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_CARGA3
  for PRODUCAO.SERVICO_CARGA3@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_CARGA4
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_CARGA4
  for PRODUCAO.SERVICO_CARGA4@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_CARGA5
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_CARGA5
  for PRODUCAO.SERVICO_CARGA5@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_CID
prompt ============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_CID
  for PRODUCAO.SERVICO_CID@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_CONCOMITANTE
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_CONCOMITANTE
  for PRODUCAO.SERVICO_CONCOMITANTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_CONCOMITANTE_DETALHE
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_CONCOMITANTE_DETALHE
  for PRODUCAO.SERVICO_CONCOMITANTE_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_CORRESPONDENTE
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_CORRESPONDENTE
  for PRODUCAO.SERVICO_CORRESPONDENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_DA_AUTORIZACAO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_DA_AUTORIZACAO
  for PRODUCAO.SERVICO_DA_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_DA_AUTORIZACAO_ANT2009
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_DA_AUTORIZACAO_ANT2009
  for PRODUCAO.SERVICO_DA_AUTORIZACAO_ANT2009@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_DA_CATEGORIA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_DA_CATEGORIA
  for PRODUCAO.SERVICO_DA_CATEGORIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_DA_CATEGORIA_CONTR_PES
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_DA_CATEGORIA_CONTR_PES
  for PRODUCAO.SERVICO_DA_CATEGORIA_CONTR_PES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_DA_GUIA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_DA_GUIA
  for PRODUCAO.SERVICO_DA_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_DA_GUIA_ANALISE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_DA_GUIA_ANALISE
  for PRODUCAO.SERVICO_DA_GUIA_ANALISE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_DA_PERICIA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_DA_PERICIA
  for PRODUCAO.SERVICO_DA_PERICIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_DE_INTERCAMBIO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_DE_INTERCAMBIO
  for PRODUCAO.SERVICO_DE_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_DOENCA_CONTROLADA
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_DOENCA_CONTROLADA
  for PRODUCAO.SERVICO_DOENCA_CONTROLADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_DOENCA_TRATAMENTO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_DOENCA_TRATAMENTO
  for PRODUCAO.SERVICO_DOENCA_TRATAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_DOENCA_USUARIO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_DOENCA_USUARIO
  for PRODUCAO.SERVICO_DOENCA_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_ESPECIALIDADE
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_ESPECIALIDADE
  for PRODUCAO.SERVICO_ESPECIALIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_ESPECIALIDADE_REQUISIT
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_ESPECIALIDADE_REQUISIT
  for PRODUCAO.SERVICO_ESPECIALIDADE_REQUISIT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_ESPECIALISTA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_ESPECIALISTA
  for PRODUCAO.SERVICO_ESPECIALISTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_ESPECIALISTA_REQUISITA
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_ESPECIALISTA_REQUISITA
  for PRODUCAO.SERVICO_ESPECIALISTA_REQUISITA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_EVENTO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_EVENTO
  for PRODUCAO.SERVICO_EVENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_FATOR_MODERADOR
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_FATOR_MODERADOR
  for PRODUCAO.SERVICO_FATOR_MODERADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_GENERICO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_GENERICO
  for PRODUCAO.SERVICO_GENERICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_GERADO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_GERADO
  for PRODUCAO.SERVICO_GERADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_INFORMACOES_PACOTE
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_INFORMACOES_PACOTE
  for PRODUCAO.SERVICO_INFORMACOES_PACOTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_INTERCAMBIO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_INTERCAMBIO
  for PRODUCAO.SERVICO_INTERCAMBIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_LUIZ_TABPTU
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_LUIZ_TABPTU
  for PRODUCAO.SERVICO_LUIZ_TABPTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_NOSSO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_NOSSO
  for PRODUCAO.SERVICO_NOSSO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_OFERECIDO_FATURA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_OFERECIDO_FATURA
  for PRODUCAO.SERVICO_OFERECIDO_FATURA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_OFERECIDO_PRODUTO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_OFERECIDO_PRODUTO
  for PRODUCAO.SERVICO_OFERECIDO_PRODUTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_PRE_AUTORIZ_CONTR_PES
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_PRE_AUTORIZ_CONTR_PES
  for PRODUCAO.SERVICO_PRE_AUTORIZ_CONTR_PES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_PRE_AUTORIZ_PRESTADOR
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_PRE_AUTORIZ_PRESTADOR
  for PRODUCAO.SERVICO_PRE_AUTORIZ_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_PRESTADOR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_PRESTADOR
  for PRODUCAO.SERVICO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_REFER_ANS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_REFER_ANS
  for PRODUCAO.SERVICO_REFER_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_ROMULO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_ROMULO
  for PRODUCAO.SERVICO_ROMULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_SETOR_LABORATORIO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_SETOR_LABORATORIO
  for PRODUCAO.SERVICO_SETOR_LABORATORIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_TAB_REFER
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_TAB_REFER
  for PRODUCAO.SERVICO_TAB_REFER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_TAB_REFER_106
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_TAB_REFER_106
  for PRODUCAO.SERVICO_TAB_REFER_106@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_TAB_REFER_20_11
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_TAB_REFER_20_11
  for PRODUCAO.SERVICO_TAB_REFER_20_11@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_TAB_REFER_22
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_TAB_REFER_22
  for PRODUCAO.SERVICO_TAB_REFER_22@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_TAB_REFER_BCK
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_TAB_REFER_BCK
  for PRODUCAO.SERVICO_TAB_REFER_BCK@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_TAB_REFER_REVERSAO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.SERVICO_TAB_REFER_REVERSAO
  for PRODUCAO.SERVICO_TAB_REFER_REVERSAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICO_TEMP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.SERVICO_TEMP
  for PRODUCAO.SERVICO_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICOBACKUP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.SERVICOBACKUP
  for PRODUCAO.SERVICOBACKUP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SERVICOS_PACOTE
prompt ================================
prompt
create or replace synonym EMS506UNICOO.SERVICOS_PACOTE
  for PRODUCAO.SERVICOS_PACOTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SETOR_LABORATORIO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SETOR_LABORATORIO
  for PRODUCAO.SETOR_LABORATORIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_ALTER_CONTRATO_PADRAO_TEMP
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.SIB_ALTER_CONTRATO_PADRAO_TEMP
  for PRODUCAO.SIB_ALTER_CONTRATO_PADRAO_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_CONFERENCIA_BACKUP_LCST
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.SIB_CONFERENCIA_BACKUP_LCST
  for PRODUCAO.SIB_CONFERENCIA_BACKUP_LCST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_CONFERENCIA_CNS
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SIB_CONFERENCIA_CNS
  for PRODUCAO.SIB_CONFERENCIA_CNS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_CONFERENCIA_CNS_2
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SIB_CONFERENCIA_CNS_2
  for PRODUCAO.SIB_CONFERENCIA_CNS_2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_CONFERENCIA_CNS_3
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SIB_CONFERENCIA_CNS_3
  for PRODUCAO.SIB_CONFERENCIA_CNS_3@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_CONFERENCIA_CNS_4
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SIB_CONFERENCIA_CNS_4
  for PRODUCAO.SIB_CONFERENCIA_CNS_4@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_ENDERECO_TEMP
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SIB_ENDERECO_TEMP
  for PRODUCAO.SIB_ENDERECO_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_MOVIMENTO_TEMP
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SIB_MOVIMENTO_TEMP
  for PRODUCAO.SIB_MOVIMENTO_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_RETORNO_ARQUIVO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SIB_RETORNO_ARQUIVO
  for PRODUCAO.SIB_RETORNO_ARQUIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_RETORNO_CONFERENCIA
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SIB_RETORNO_CONFERENCIA
  for PRODUCAO.SIB_RETORNO_CONFERENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_RETORNO_CONFERENCIA_ARQ
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.SIB_RETORNO_CONFERENCIA_ARQ
  for PRODUCAO.SIB_RETORNO_CONFERENCIA_ARQ@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_RETORNO_ERROS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SIB_RETORNO_ERROS
  for PRODUCAO.SIB_RETORNO_ERROS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_RETORNO_ERROS_CAMPO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SIB_RETORNO_ERROS_CAMPO
  for PRODUCAO.SIB_RETORNO_ERROS_CAMPO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_RETORNO_REGISTROS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SIB_RETORNO_REGISTROS
  for PRODUCAO.SIB_RETORNO_REGISTROS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIB_STATUS_ATIVACAO_TEMP
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SIB_STATUS_ATIVACAO_TEMP
  for PRODUCAO.SIB_STATUS_ATIVACAO_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIMUL_OPERAC_FINANC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SIMUL_OPERAC_FINANC
  for EMS5.SIMUL_OPERAC_FINANC;

prompt
prompt Creating synonym SIMULACAO_PROPOSTA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SIMULACAO_PROPOSTA
  for PRODUCAO.SIMULACAO_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SINONIMO_SERVICO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SINONIMO_SERVICO
  for PRODUCAO.SINONIMO_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SINONIMO_SERVICO_PRESTADOR
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.SINONIMO_SERVICO_PRESTADOR
  for PRODUCAO.SINONIMO_SERVICO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIT_CONTR_PESSOA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SIT_CONTR_PESSOA
  for PRODUCAO.SIT_CONTR_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SIT_ETAP_PROCES_EDI
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SIT_ETAP_PROCES_EDI
  for EMS5.SIT_ETAP_PROCES_EDI;

prompt
prompt Creating synonym SIT_MOVIMEN_MODUL
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SIT_MOVIMEN_MODUL
  for EMS5.SIT_MOVIMEN_MODUL;

prompt
prompt Creating synonym SIT_PERIOD_CTBL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.SIT_PERIOD_CTBL
  for EMS5.SIT_PERIOD_CTBL;

prompt
prompt Creating synonym SIT_RET_COBR
prompt =============================
prompt
create or replace synonym EMS506UNICOO.SIT_RET_COBR
  for EMS5.SIT_RET_COBR;

prompt
prompt Creating synonym SIT_RET_COBR_CONCES
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SIT_RET_COBR_CONCES
  for EMS5.SIT_RET_COBR_CONCES;

prompt
prompt Creating synonym SIT_RET_COBR_ESPEC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SIT_RET_COBR_ESPEC
  for EMS5.SIT_RET_COBR_ESPEC;

prompt
prompt Creating synonym SITUACAO_AUTORIZACAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SITUACAO_AUTORIZACAO
  for PRODUCAO.SITUACAO_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SITUACAO_CLIENTE
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SITUACAO_CLIENTE
  for PRODUCAO.SITUACAO_CLIENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SITUACAO_DA_GUIA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SITUACAO_DA_GUIA
  for PRODUCAO.SITUACAO_DA_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SITUACAO_DA_PESSOA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SITUACAO_DA_PESSOA
  for PRODUCAO.SITUACAO_DA_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SITUACAO_FORNECEDOR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SITUACAO_FORNECEDOR
  for PRODUCAO.SITUACAO_FORNECEDOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SITUACAO_PERICIA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SITUACAO_PERICIA
  for PRODUCAO.SITUACAO_PERICIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SITUACAO_PESSOA_AG_COMERCIAL
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.SITUACAO_PESSOA_AG_COMERCIAL
  for PRODUCAO.SITUACAO_PESSOA_AG_COMERCIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SITUACAO_PRESTADOR
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SITUACAO_PRESTADOR
  for PRODUCAO.SITUACAO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SITUACAO_SERV_AUTORIZACAO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SITUACAO_SERV_AUTORIZACAO
  for PRODUCAO.SITUACAO_SERV_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SITUACAO_SERVICO_PERICIA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SITUACAO_SERVICO_PERICIA
  for PRODUCAO.SITUACAO_SERVICO_PERICIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_DBREPORT_SQLSCRIPTS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SMP_DBREPORT_SQLSCRIPTS
  for PRODUCAO.SMP_DBREPORT_SQLSCRIPTS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_DBREPORT_TEMPLATE
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SMP_DBREPORT_TEMPLATE
  for PRODUCAO.SMP_DBREPORT_TEMPLATE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_LMV_DISPLAY_OPTION
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SMP_LMV_DISPLAY_OPTION
  for PRODUCAO.SMP_LMV_DISPLAY_OPTION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_LMV_REDO_LOG
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SMP_LMV_REDO_LOG
  for PRODUCAO.SMP_LMV_REDO_LOG@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_LMV_SEARCH_OBJECT
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SMP_LMV_SEARCH_OBJECT
  for PRODUCAO.SMP_LMV_SEARCH_OBJECT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_LMV_SEARCH_RESULT
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SMP_LMV_SEARCH_RESULT
  for PRODUCAO.SMP_LMV_SEARCH_RESULT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_LOG_SQL
prompt ============================
prompt
create or replace synonym EMS506UNICOO.SMP_LOG_SQL
  for PRODUCAO.SMP_LOG_SQL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_STANDBY_CONFIG_INFO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SMP_STANDBY_CONFIG_INFO
  for PRODUCAO.SMP_STANDBY_CONFIG_INFO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_STANDBY_SITE_INFO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SMP_STANDBY_SITE_INFO
  for PRODUCAO.SMP_STANDBY_SITE_INFO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VAI_DBCONFIG
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SMP_VAI_DBCONFIG
  for PRODUCAO.SMP_VAI_DBCONFIG@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VAR_EBU_ACTIVE_JOB_
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VAR_EBU_ACTIVE_JOB_
  for PRODUCAO.SMP_VAR_EBU_ACTIVE_JOB_@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VAR_EBU_SAVED_JOB_
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VAR_EBU_SAVED_JOB_
  for PRODUCAO.SMP_VAR_EBU_SAVED_JOB_@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VAR_OS_ACTIVE_JOB_
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VAR_OS_ACTIVE_JOB_
  for PRODUCAO.SMP_VAR_OS_ACTIVE_JOB_@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VAR_OS_SAVED_JOB_
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VAR_OS_SAVED_JOB_
  for PRODUCAO.SMP_VAR_OS_SAVED_JOB_@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VAR_SMR_ACTIVE_JOB_
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VAR_SMR_ACTIVE_JOB_
  for PRODUCAO.SMP_VAR_SMR_ACTIVE_JOB_@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VAR_SMR_CHANNEL_DEVICE_
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VAR_SMR_CHANNEL_DEVICE_
  for PRODUCAO.SMP_VAR_SMR_CHANNEL_DEVICE_@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VAR_SMR_DEFAULT_CHANNEL_
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VAR_SMR_DEFAULT_CHANNEL_
  for PRODUCAO.SMP_VAR_SMR_DEFAULT_CHANNEL_@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VAR_SMR_LIST_DATABASES_
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VAR_SMR_LIST_DATABASES_
  for PRODUCAO.SMP_VAR_SMR_LIST_DATABASES_@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VAR_SMR_RC_CONNECT_STRING_
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VAR_SMR_RC_CONNECT_STRING_
  for PRODUCAO.SMP_VAR_SMR_RC_CONNECT_STRING_@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VAR_SMR_SAVED_JOB_
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VAR_SMR_SAVED_JOB_
  for PRODUCAO.SMP_VAR_SMR_SAVED_JOB_@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VAR_SMR_TEMP_SCRIPTS_
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VAR_SMR_TEMP_SCRIPTS_
  for PRODUCAO.SMP_VAR_SMR_TEMP_SCRIPTS_@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VBO_JOB_CONFIG_TABLE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VBO_JOB_CONFIG_TABLE
  for PRODUCAO.SMP_VBO_JOB_CONFIG_TABLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VBO_REPORT_ELEMENTS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VBO_REPORT_ELEMENTS
  for PRODUCAO.SMP_VBO_REPORT_ELEMENTS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VBO_REPORT_INFO_SOURCES
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VBO_REPORT_INFO_SOURCES
  for PRODUCAO.SMP_VBO_REPORT_INFO_SOURCES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VBO_REPORTS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.SMP_VBO_REPORTS
  for PRODUCAO.SMP_VBO_REPORTS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VBO_REPORTS_CONFIG
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VBO_REPORTS_CONFIG
  for PRODUCAO.SMP_VBO_REPORTS_CONFIG@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VBO_REPORTS_TYPE_DEFN
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VBO_REPORTS_TYPE_DEFN
  for PRODUCAO.SMP_VBO_REPORTS_TYPE_DEFN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VBOR_BACKUP_CONFIGURATION
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VBOR_BACKUP_CONFIGURATION
  for PRODUCAO.SMP_VBOR_BACKUP_CONFIGURATION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VBOR_BLOB
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.SMP_VBOR_BLOB
  for PRODUCAO.SMP_VBOR_BLOB@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VBOR_CHANNELS_INFORMATION
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VBOR_CHANNELS_INFORMATION
  for PRODUCAO.SMP_VBOR_CHANNELS_INFORMATION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VBOR_DEFAULT_CONFIG
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VBOR_DEFAULT_CONFIG
  for PRODUCAO.SMP_VBOR_DEFAULT_CONFIG@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VBOR_STRATEGY_INFORMATION
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VBOR_STRATEGY_INFORMATION
  for PRODUCAO.SMP_VBOR_STRATEGY_INFORMATION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDD_OPERATIONS_TABLE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDD_OPERATIONS_TABLE
  for PRODUCAO.SMP_VDD_OPERATIONS_TABLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_EVENT
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_EVENT
  for PRODUCAO.SMP_VDE_EVENT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_EVENT_ARCHIVE
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_EVENT_ARCHIVE
  for PRODUCAO.SMP_VDE_EVENT_ARCHIVE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_EVENT_ARCHIVE_PURGE
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_EVENT_ARCHIVE_PURGE
  for PRODUCAO.SMP_VDE_EVENT_ARCHIVE_PURGE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_EVENT_DETAILS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_EVENT_DETAILS
  for PRODUCAO.SMP_VDE_EVENT_DETAILS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_EVENT_LOCK_TAB
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_EVENT_LOCK_TAB
  for PRODUCAO.SMP_VDE_EVENT_LOCK_TAB@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_EVENT_LOG
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_EVENT_LOG
  for PRODUCAO.SMP_VDE_EVENT_LOG@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_EVENT_OCCUR_DETAILS
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_EVENT_OCCUR_DETAILS
  for PRODUCAO.SMP_VDE_EVENT_OCCUR_DETAILS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_EVENT_OCCURRENCE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_EVENT_OCCURRENCE
  for PRODUCAO.SMP_VDE_EVENT_OCCURRENCE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_EVENT_TARGET_ACK
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_EVENT_TARGET_ACK
  for PRODUCAO.SMP_VDE_EVENT_TARGET_ACK@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_EVENT_TARGET_DETAILS
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_EVENT_TARGET_DETAILS
  for PRODUCAO.SMP_VDE_EVENT_TARGET_DETAILS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_EVENT_TARGET_INFO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_EVENT_TARGET_INFO
  for PRODUCAO.SMP_VDE_EVENT_TARGET_INFO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_EVENT_TARGET_STATE
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_EVENT_TARGET_STATE
  for PRODUCAO.SMP_VDE_EVENT_TARGET_STATE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_EVENT_UPDOWN_QUEUE
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_EVENT_UPDOWN_QUEUE
  for PRODUCAO.SMP_VDE_EVENT_UPDOWN_QUEUE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_METRIC_THRESHOLDS
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_METRIC_THRESHOLDS
  for PRODUCAO.SMP_VDE_METRIC_THRESHOLDS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_NODE_UPDOWN_QUEUE
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_NODE_UPDOWN_QUEUE
  for PRODUCAO.SMP_VDE_NODE_UPDOWN_QUEUE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_THRESHOLD_ASSOC
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_THRESHOLD_ASSOC
  for PRODUCAO.SMP_VDE_THRESHOLD_ASSOC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDE_TRY_REMOVE_EVENT_QUEUE
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDE_TRY_REMOVE_EVENT_QUEUE
  for PRODUCAO.SMP_VDE_TRY_REMOVE_EVENT_QUEUE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDF_MASLIST
prompt ================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDF_MASLIST
  for PRODUCAO.SMP_VDF_MASLIST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDG_EVENT_DELETE_LIST
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDG_EVENT_DELETE_LIST
  for PRODUCAO.SMP_VDG_EVENT_DELETE_LIST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDG_EVENT_NOTIF_LIST
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDG_EVENT_NOTIF_LIST
  for PRODUCAO.SMP_VDG_EVENT_NOTIF_LIST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDG_EVENTID_MAP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDG_EVENTID_MAP
  for PRODUCAO.SMP_VDG_EVENTID_MAP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDG_GATEWAY_MAP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDG_GATEWAY_MAP
  for PRODUCAO.SMP_VDG_GATEWAY_MAP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDG_JOBID_MAP
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDG_JOBID_MAP
  for PRODUCAO.SMP_VDG_JOBID_MAP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDG_NODE_LIST
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDG_NODE_LIST
  for PRODUCAO.SMP_VDG_NODE_LIST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDG_NODE_LOCK_TABLE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDG_NODE_LOCK_TABLE
  for PRODUCAO.SMP_VDG_NODE_LOCK_TABLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDI_AOBJECT_NOTIFICATION
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDI_AOBJECT_NOTIFICATION
  for PRODUCAO.SMP_VDI_AOBJECT_NOTIFICATION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDI_OBJECT_TABLE
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDI_OBJECT_TABLE
  for PRODUCAO.SMP_VDI_OBJECT_TABLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDI_POS
prompt ============================
prompt
create or replace synonym EMS506UNICOO.SMP_VDI_POS
  for PRODUCAO.SMP_VDI_POS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDI_TARGET_PROPERTIES
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDI_TARGET_PROPERTIES
  for PRODUCAO.SMP_VDI_TARGET_PROPERTIES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDJ_JOB
prompt ============================
prompt
create or replace synonym EMS506UNICOO.SMP_VDJ_JOB
  for PRODUCAO.SMP_VDJ_JOB@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDJ_JOB_LOCK
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDJ_JOB_LOCK
  for PRODUCAO.SMP_VDJ_JOB_LOCK@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDJ_JOB_LOG
prompt ================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDJ_JOB_LOG
  for PRODUCAO.SMP_VDJ_JOB_LOG@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDJ_JOB_LOG_COMMENT
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDJ_JOB_LOG_COMMENT
  for PRODUCAO.SMP_VDJ_JOB_LOG_COMMENT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDJ_JOB_LOG_INTERMED
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDJ_JOB_LOG_INTERMED
  for PRODUCAO.SMP_VDJ_JOB_LOG_INTERMED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDJ_JOB_OUTPUT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDJ_JOB_OUTPUT
  for PRODUCAO.SMP_VDJ_JOB_OUTPUT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDJ_JOB_PER_TARGET
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDJ_JOB_PER_TARGET
  for PRODUCAO.SMP_VDJ_JOB_PER_TARGET@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDJ_JOB_TARGET
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDJ_JOB_TARGET
  for PRODUCAO.SMP_VDJ_JOB_TARGET@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDM_ADDRESS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDM_ADDRESS
  for PRODUCAO.SMP_VDM_ADDRESS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDM_GLOBAL_INFO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDM_GLOBAL_INFO
  for PRODUCAO.SMP_VDM_GLOBAL_INFO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDM_LAST_NOTIF_SEQ_PERTYPE
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDM_LAST_NOTIF_SEQ_PERTYPE
  for PRODUCAO.SMP_VDM_LAST_NOTIF_SEQ_PERTYPE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDM_NOTIFICATION
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDM_NOTIFICATION
  for PRODUCAO.SMP_VDM_NOTIFICATION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDM_NOTIFICATION_DETAILS
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDM_NOTIFICATION_DETAILS
  for PRODUCAO.SMP_VDM_NOTIFICATION_DETAILS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDM_NOTIFICATION_NVPAIRS
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDM_NOTIFICATION_NVPAIRS
  for PRODUCAO.SMP_VDM_NOTIFICATION_NVPAIRS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDM_NOTIFICATION_SERVICES
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDM_NOTIFICATION_SERVICES
  for PRODUCAO.SMP_VDM_NOTIFICATION_SERVICES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDM_PAGING_CARRIER_INFO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDM_PAGING_CARRIER_INFO
  for PRODUCAO.SMP_VDM_PAGING_CARRIER_INFO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDM_SESSION_NOTIFTYPE_PAIR
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDM_SESSION_NOTIFTYPE_PAIR
  for PRODUCAO.SMP_VDM_SESSION_NOTIFTYPE_PAIR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDN_BLACKOUTSCHEDULE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDN_BLACKOUTSCHEDULE
  for PRODUCAO.SMP_VDN_BLACKOUTSCHEDULE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDN_GROUP_GROUP
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDN_GROUP_GROUP
  for PRODUCAO.SMP_VDN_GROUP_GROUP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDN_GROUP_LIST
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDN_GROUP_LIST
  for PRODUCAO.SMP_VDN_GROUP_LIST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDN_GROUP_TARGET
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDN_GROUP_TARGET
  for PRODUCAO.SMP_VDN_GROUP_TARGET@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDN_NODE_LIST
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDN_NODE_LIST
  for PRODUCAO.SMP_VDN_NODE_LIST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDN_NOTIFY
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.SMP_VDN_NOTIFY
  for PRODUCAO.SMP_VDN_NOTIFY@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDN_STATE
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.SMP_VDN_STATE
  for PRODUCAO.SMP_VDN_STATE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDN_TARGET_LIST
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDN_TARGET_LIST
  for PRODUCAO.SMP_VDN_TARGET_LIST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDN_TARGET_PROPERTIES
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDN_TARGET_PROPERTIES
  for PRODUCAO.SMP_VDN_TARGET_PROPERTIES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDN_TARGET_TYPE_DEFN
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDN_TARGET_TYPE_DEFN
  for PRODUCAO.SMP_VDN_TARGET_TYPE_DEFN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDO_JOBID_SERVICEID
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDO_JOBID_SERVICEID
  for PRODUCAO.SMP_VDO_JOBID_SERVICEID@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDP_NODE_INFO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDP_NODE_INFO
  for PRODUCAO.SMP_VDP_NODE_INFO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDP_NODE_INFO_VDD
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDP_NODE_INFO_VDD
  for PRODUCAO.SMP_VDP_NODE_INFO_VDD@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDP_NODE_OMS_MAP
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDP_NODE_OMS_MAP
  for PRODUCAO.SMP_VDP_NODE_OMS_MAP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDP_NODES
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.SMP_VDP_NODES
  for PRODUCAO.SMP_VDP_NODES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDP_OMS_NUM_NODES
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDP_OMS_NUM_NODES
  for PRODUCAO.SMP_VDP_OMS_NUM_NODES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDP_OMS_REGION_MAP
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDP_OMS_REGION_MAP
  for PRODUCAO.SMP_VDP_OMS_REGION_MAP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDP_PGSRV_REGION_MAP
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDP_PGSRV_REGION_MAP
  for PRODUCAO.SMP_VDP_PGSRV_REGION_MAP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDP_REGIONS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDP_REGIONS
  for PRODUCAO.SMP_VDP_REGIONS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDR_REGISTRY
prompt =================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDR_REGISTRY
  for PRODUCAO.SMP_VDR_REGISTRY@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDS_REPOS_VERSION
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDS_REPOS_VERSION
  for PRODUCAO.SMP_VDS_REPOS_VERSION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDS_SESSIONS_TABLE
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDS_SESSIONS_TABLE
  for PRODUCAO.SMP_VDS_SESSIONS_TABLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDU_CALLBACK_TABLE
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDU_CALLBACK_TABLE
  for PRODUCAO.SMP_VDU_CALLBACK_TABLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDU_OBJECTS_TABLE
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDU_OBJECTS_TABLE
  for PRODUCAO.SMP_VDU_OBJECTS_TABLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDU_PRINCIPALS_TABLE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDU_PRINCIPALS_TABLE
  for PRODUCAO.SMP_VDU_PRINCIPALS_TABLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDU_PRIVILEGE_TABLE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDU_PRIVILEGE_TABLE
  for PRODUCAO.SMP_VDU_PRIVILEGE_TABLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDV_DEFAULT_NOTIFY_PREFS
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDV_DEFAULT_NOTIFY_PREFS
  for PRODUCAO.SMP_VDV_DEFAULT_NOTIFY_PREFS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDV_DEFAULT_PERMISSIONS
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDV_DEFAULT_PERMISSIONS
  for PRODUCAO.SMP_VDV_DEFAULT_PERMISSIONS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDV_GENERAL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDV_GENERAL
  for PRODUCAO.SMP_VDV_GENERAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDV_MAPI_EMAIL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDV_MAPI_EMAIL
  for PRODUCAO.SMP_VDV_MAPI_EMAIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDV_NOTIFICATION_SCHEDULE
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDV_NOTIFICATION_SCHEDULE
  for PRODUCAO.SMP_VDV_NOTIFICATION_SCHEDULE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDV_PAGE
prompt =============================
prompt
create or replace synonym EMS506UNICOO.SMP_VDV_PAGE
  for PRODUCAO.SMP_VDV_PAGE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDV_PAGING
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.SMP_VDV_PAGING
  for PRODUCAO.SMP_VDV_PAGING@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDV_PREFERRED_CREDENTIALS
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDV_PREFERRED_CREDENTIALS
  for PRODUCAO.SMP_VDV_PREFERRED_CREDENTIALS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDV_SERVICE_PARMS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDV_SERVICE_PARMS
  for PRODUCAO.SMP_VDV_SERVICE_PARMS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDV_SMTP_EMAIL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDV_SMTP_EMAIL
  for PRODUCAO.SMP_VDV_SMTP_EMAIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDV_USER
prompt =============================
prompt
create or replace synonym EMS506UNICOO.SMP_VDV_USER
  for PRODUCAO.SMP_VDV_USER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDV_USER_LOCALE
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDV_USER_LOCALE
  for PRODUCAO.SMP_VDV_USER_LOCALE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VDV_USER_PREF
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.SMP_VDV_USER_PREF
  for PRODUCAO.SMP_VDV_USER_PREF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VTA_DB_APP_POSITION_
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VTA_DB_APP_POSITION_
  for PRODUCAO.SMP_VTA_DB_APP_POSITION_@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VTC_LAYOUT_PROPERTIES
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VTC_LAYOUT_PROPERTIES
  for PRODUCAO.SMP_VTC_LAYOUT_PROPERTIES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VTD_CLIENT_STATE
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VTD_CLIENT_STATE
  for PRODUCAO.SMP_VTD_CLIENT_STATE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VTD_DG_LOCATION
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VTD_DG_LOCATION
  for PRODUCAO.SMP_VTD_DG_LOCATION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VTD_HISTORICAL_LOCATION
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VTD_HISTORICAL_LOCATION
  for PRODUCAO.SMP_VTD_HISTORICAL_LOCATION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VTM_CHART_DEFN
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.SMP_VTM_CHART_DEFN
  for PRODUCAO.SMP_VTM_CHART_DEFN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VTM_CHART_STATE_TARG_SPEC
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.SMP_VTM_CHART_STATE_TARG_SPEC
  for PRODUCAO.SMP_VTM_CHART_STATE_TARG_SPEC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VTM_DISPLAY_STATE
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VTM_DISPLAY_STATE
  for PRODUCAO.SMP_VTM_DISPLAY_STATE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VTM_RECORDING_DATA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.SMP_VTM_RECORDING_DATA
  for PRODUCAO.SMP_VTM_RECORDING_DATA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VTM_UDCHART_COLUMNS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VTM_UDCHART_COLUMNS
  for PRODUCAO.SMP_VTM_UDCHART_COLUMNS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VTM_UDCHART_DEFN
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VTM_UDCHART_DEFN
  for PRODUCAO.SMP_VTM_UDCHART_DEFN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VTP_UDCLASS_COLUMNS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.SMP_VTP_UDCLASS_COLUMNS
  for PRODUCAO.SMP_VTP_UDCLASS_COLUMNS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VTP_UDCLASS_DEFN
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VTP_UDCLASS_DEFN
  for PRODUCAO.SMP_VTP_UDCLASS_DEFN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SMP_VXA_SYSTEM_PREFS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SMP_VXA_SYSTEM_PREFS
  for PRODUCAO.SMP_VXA_SYSTEM_PREFS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SOLIC_SOLICIT_VIAGEM
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.SOLIC_SOLICIT_VIAGEM
  for EMS5.SOLIC_SOLICIT_VIAGEM;

prompt
prompt Creating synonym SOLICIT_VIAGEM
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.SOLICIT_VIAGEM
  for EMS5.SOLICIT_VIAGEM;

prompt
prompt Creating synonym STRATEGY_PLANO_CONVERSAO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.STRATEGY_PLANO_CONVERSAO
  for PRODUCAO.STRATEGY_PLANO_CONVERSAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym SWAP_EMPREST
prompt =============================
prompt
create or replace synonym EMS506UNICOO.SWAP_EMPREST
  for EMS5.SWAP_EMPREST;

prompt
prompt Creating synonym SYS_EXPORT_TABLE_01
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.SYS_EXPORT_TABLE_01
  for PRODUCAO.SYS_EXPORT_TABLE_01@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym T10079091VERSORCTOCTBLBGC
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.T10079091VERSORCTOCTBLBGC
  for EMS5.T10079091VERSORCTOCTBLBGC;

prompt
prompt Creating synonym T10354173CLIENFINANC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.T10354173CLIENFINANC
  for EMS5.T10354173CLIENFINANC;

prompt
prompt Creating synonym T10494495CLIENFINANC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.T10494495CLIENFINANC
  for EMS5.T10494495CLIENFINANC;

prompt
prompt Creating synonym T11690752PARAMGERALGLD
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.T11690752PARAMGERALGLD
  for EMS5.T11690752PARAMGERALGLD;

prompt
prompt Creating synonym T13685767ANTECIPPEFPEND
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.T13685767ANTECIPPEFPEND
  for EMS5.T13685767ANTECIPPEFPEND;

prompt
prompt Creating synonym T148884REGRACONCILCTACORREN
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.T148884REGRACONCILCTACORREN
  for EMS5.T148884REGRACONCILCTACORREN;

prompt
prompt Creating synonym T1492874802TIPPROCESPRESTACCTA
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.T1492874802TIPPROCESPRESTACCTA
  for EMS5.T1492874802TIPPROCESPRESTACCTA;

prompt
prompt Creating synonym T15967653VERSORCTOCTBL
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.T15967653VERSORCTOCTBL
  for EMS5.T15967653VERSORCTOCTBL;

prompt
prompt Creating synonym T1764490339PARAMTEF
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.T1764490339PARAMTEF
  for EMS5.T1764490339PARAMTEF;

prompt
prompt Creating synonym T18928803ITEMRESERVASOLICIT
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.T18928803ITEMRESERVASOLICIT
  for EMS5.T18928803ITEMRESERVASOLICIT;

prompt
prompt Creating synonym T1950058FORNECFINANC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.T1950058FORNECFINANC
  for EMS5.T1950058FORNECFINANC;

prompt
prompt Creating synonym T19544282FUNCFINANC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.T19544282FUNCFINANC
  for EMS5.T19544282FUNCFINANC;

prompt
prompt Creating synonym T19756584INTSDOCONSOLIDPARAM
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.T19756584INTSDOCONSOLIDPARAM
  for EMS5.T19756584INTSDOCONSOLIDPARAM;

prompt
prompt Creating synonym T20258715NIVCARGOEEC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.T20258715NIVCARGOEEC
  for EMS5.T20258715NIVCARGOEEC;

prompt
prompt Creating synonym T245136PESSOAFISIC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.T245136PESSOAFISIC
  for EMS5.T245136PESSOAFISIC;

prompt
prompt Creating synonym T26105064RESERVASOLICITVIAGEM
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.T26105064RESERVASOLICITVIAGEM
  for EMS5.T26105064RESERVASOLICITVIAGEM;

prompt
prompt Creating synonym T28081048CHEQAP
prompt ================================
prompt
create or replace synonym EMS506UNICOO.T28081048CHEQAP
  for EMS5.T28081048CHEQAP;

prompt
prompt Creating synonym T2823317ITEMLOTEIMPLAP
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.T2823317ITEMLOTEIMPLAP
  for EMS5.T2823317ITEMLOTEIMPLAP;

prompt
prompt Creating synonym T29395490CALENDCOMIS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.T29395490CALENDCOMIS
  for EMS5.T29395490CALENDCOMIS;

prompt
prompt Creating synonym T30635522CCUSTO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.T30635522CCUSTO
  for EMS5.T30635522CCUSTO;

prompt
prompt Creating synonym T32699037PARAMEMPRESEEC
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.T32699037PARAMEMPRESEEC
  for EMS5.T32699037PARAMEMPRESEEC;

prompt
prompt Creating synonym T33536304ITEMCRITICSDOCTACTBL
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.T33536304ITEMCRITICSDOCTACTBL
  for EMS5.T33536304ITEMCRITICSDOCTACTBL;

prompt
prompt Creating synonym T386215PARAMEMPRESAPB
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.T386215PARAMEMPRESAPB
  for EMS5.T386215PARAMEMPRESAPB;

prompt
prompt Creating synonym T5019889TRADORGEXT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.T5019889TRADORGEXT
  for EMS5.T5019889TRADORGEXT;

prompt
prompt Creating synonym T53681BORDAP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.T53681BORDAP
  for EMS5.T53681BORDAP;

prompt
prompt Creating synonym T69535PESSOAJURID
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.T69535PESSOAJURID
  for EMS5.T69535PESSOAJURID;

prompt
prompt Creating synonym T9487046PROCESPRESTACCTAEEC
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.T9487046PROCESPRESTACCTAEEC
  for EMS5.T9487046PROCESPRESTACCTAEEC;

prompt
prompt Creating synonym T9656666LOTEIMPLTITAP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.T9656666LOTEIMPLTITAP
  for EMS5.T9656666LOTEIMPLTITAP;

prompt
prompt Creating synonym T9656666PASSAGSOLICITVIAGEM
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.T9656666PASSAGSOLICITVIAGEM
  for EMS5.T9656666PASSAGSOLICITVIAGEM;

prompt
prompt Creating synonym TAB_AUX_PTU
prompt ============================
prompt
create or replace synonym EMS506UNICOO.TAB_AUX_PTU
  for PRODUCAO.TAB_AUX_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TAB_COEF_CM_PAT
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TAB_COEF_CM_PAT
  for EMS5.TAB_COEF_CM_PAT;

prompt
prompt Creating synonym TAB_EQUIV_HONMED_DEPARA
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.TAB_EQUIV_HONMED_DEPARA
  for PRODUCAO.TAB_EQUIV_HONMED_DEPARA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TAB_EQUIV_HONMED_PARADE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.TAB_EQUIV_HONMED_PARADE
  for PRODUCAO.TAB_EQUIV_HONMED_PARADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TAB_EQUIV_SADT_DEPARA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TAB_EQUIV_SADT_DEPARA
  for PRODUCAO.TAB_EQUIV_SADT_DEPARA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TAB_EQUIV_SADT_PARADE
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TAB_EQUIV_SADT_PARADE
  for PRODUCAO.TAB_EQUIV_SADT_PARADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TAB_ESPEC_FINANC
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TAB_ESPEC_FINANC
  for EMS5.TAB_ESPEC_FINANC;

prompt
prompt Creating synonym TAB_FINANC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.TAB_FINANC
  for EMS5.TAB_FINANC;

prompt
prompt Creating synonym TAB_GERAL_CONVER_EDI
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TAB_GERAL_CONVER_EDI
  for EMS5.TAB_GERAL_CONVER_EDI;

prompt
prompt Creating synonym TAB_LIVRE_EDI
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TAB_LIVRE_EDI
  for EMS5.TAB_LIVRE_EDI;

prompt
prompt Creating synonym TAB_LIVRE_EMSBAS
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TAB_LIVRE_EMSBAS
  for EMS5.TAB_LIVRE_EMSBAS;

prompt
prompt Creating synonym TAB_LIVRE_EMSFIN
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TAB_LIVRE_EMSFIN
  for EMS5.TAB_LIVRE_EMSFIN;

prompt
prompt Creating synonym TAB_LIVRE_EMSUNI
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TAB_LIVRE_EMSUNI
  for EMS5.TAB_LIVRE_EMSUNI;

prompt
prompt Creating synonym TAB_LIVRE_EXTNAM
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TAB_LIVRE_EXTNAM
  for EMS5.TAB_LIVRE_EXTNAM;

prompt
prompt Creating synonym TAB_LIVRE_EXTNAM_1
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TAB_LIVRE_EXTNAM_1
  for EMS5.TAB_LIVRE_EXTNAM_1;

prompt
prompt Creating synonym TAB_LIVRE_EXTNAM_2
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TAB_LIVRE_EXTNAM_2
  for EMS5.TAB_LIVRE_EXTNAM_2;

prompt
prompt Creating synonym TAB_LIVRE_EXTNAM_3
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TAB_LIVRE_EXTNAM_3
  for EMS5.TAB_LIVRE_EXTNAM_3;

prompt
prompt Creating synonym TAB_LIVRE_EXTNAM_4
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TAB_LIVRE_EXTNAM_4
  for EMS5.TAB_LIVRE_EXTNAM_4;

prompt
prompt Creating synonym TAB_SERV_INSS
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TAB_SERV_INSS
  for EMS5.TAB_SERV_INSS;

prompt
prompt Creating synonym TABELA_AUTORIZ_PUERICULTURA
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.TABELA_AUTORIZ_PUERICULTURA
  for PRODUCAO.TABELA_AUTORIZ_PUERICULTURA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_CODIGO_RETENCAO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TABELA_CODIGO_RETENCAO
  for PRODUCAO.TABELA_CODIGO_RETENCAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_COMISSAO_VENDA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TABELA_COMISSAO_VENDA
  for PRODUCAO.TABELA_COMISSAO_VENDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_COMISSAO_VIGENCIA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TABELA_COMISSAO_VIGENCIA
  for PRODUCAO.TABELA_COMISSAO_VIGENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_COOPERATIVA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TABELA_COOPERATIVA
  for PRODUCAO.TABELA_COOPERATIVA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_DE_CODIGO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TABELA_DE_CODIGO
  for PRODUCAO.TABELA_DE_CODIGO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_DE_DOMINIO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TABELA_DE_DOMINIO
  for PRODUCAO.TABELA_DE_DOMINIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_DE_DOMINIO_DETALHE
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.TABELA_DE_DOMINIO_DETALHE
  for PRODUCAO.TABELA_DE_DOMINIO_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_DE_DOMINIO_SCHEMA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TABELA_DE_DOMINIO_SCHEMA
  for PRODUCAO.TABELA_DE_DOMINIO_SCHEMA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_DE_DOMINIO_VINCULO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.TABELA_DE_DOMINIO_VINCULO
  for PRODUCAO.TABELA_DE_DOMINIO_VINCULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_DE_MENSAGEM
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TABELA_DE_MENSAGEM
  for PRODUCAO.TABELA_DE_MENSAGEM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_EVENTO_FATURAMENTO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.TABELA_EVENTO_FATURAMENTO
  for PRODUCAO.TABELA_EVENTO_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_INSS
prompt ============================
prompt
create or replace synonym EMS506UNICOO.TABELA_INSS
  for PRODUCAO.TABELA_INSS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_IR
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.TABELA_IR
  for PRODUCAO.TABELA_IR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_IR_REFERENCIA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TABELA_IR_REFERENCIA
  for PRODUCAO.TABELA_IR_REFERENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_ISS
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.TABELA_ISS
  for PRODUCAO.TABELA_ISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_PAC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.TABELA_PAC
  for PRODUCAO.TABELA_PAC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_PROGRESS_HIST_DEDUCAO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.TABELA_PROGRESS_HIST_DEDUCAO
  for PRODUCAO.TABELA_PROGRESS_HIST_DEDUCAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_PROGRESSIVA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TABELA_PROGRESSIVA
  for PRODUCAO.TABELA_PROGRESSIVA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_PROGRESSIVA_HIST_FAIXA
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.TABELA_PROGRESSIVA_HIST_FAIXA
  for PRODUCAO.TABELA_PROGRESSIVA_HIST_FAIXA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_PROGRESSIVA_HISTORICO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.TABELA_PROGRESSIVA_HISTORICO
  for PRODUCAO.TABELA_PROGRESSIVA_HISTORICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_REFERENCIA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TABELA_REFERENCIA
  for PRODUCAO.TABELA_REFERENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_REFERENCIA_VALIDADE
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.TABELA_REFERENCIA_VALIDADE
  for PRODUCAO.TABELA_REFERENCIA_VALIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_TEXTO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TABELA_TEXTO
  for PRODUCAO.TABELA_TEXTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_VENDAS
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TABELA_VENDAS
  for PRODUCAO.TABELA_VENDAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_VINCULO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TABELA_VINCULO
  for PRODUCAO.TABELA_VINCULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABELA_VINCULO_CATEGORIA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TABELA_VINCULO_CATEGORIA
  for PRODUCAO.TABELA_VINCULO_CATEGORIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TABGERALCONVERDETEDI
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TABGERALCONVERDETEDI
  for EMS5.TABGERALCONVERDETEDI;

prompt
prompt Creating synonym TABPRGSSIVIMPTORETID
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TABPRGSSIVIMPTORETID
  for EMS5.TABPRGSSIVIMPTORETID;

prompt
prompt Creating synonym TALON_CHEQ
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.TALON_CHEQ
  for EMS5.TALON_CHEQ;

prompt
prompt Creating synonym TAR_WORKFLOW
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TAR_WORKFLOW
  for EMS5.TAR_WORKFLOW;

prompt
prompt Creating synonym TAX_VENDOR
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.TAX_VENDOR
  for EMS5.TAX_VENDOR;

prompt
prompt Creating synonym TAXA_A_PAGAR
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TAXA_A_PAGAR
  for PRODUCAO.TAXA_A_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TAXA_HISTORICO_PAGAR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TAXA_HISTORICO_PAGAR
  for PRODUCAO.TAXA_HISTORICO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TAXA_IMPOSTO_TRANSACAO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TAXA_IMPOSTO_TRANSACAO
  for PRODUCAO.TAXA_IMPOSTO_TRANSACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TAXA_TITULO_A_PAGAR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TAXA_TITULO_A_PAGAR
  for PRODUCAO.TAXA_TITULO_A_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TAXA_TITULO_A_RECEBER
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TAXA_TITULO_A_RECEBER
  for PRODUCAO.TAXA_TITULO_A_RECEBER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TAXA_TITULO_INTEGRACAO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TAXA_TITULO_INTEGRACAO
  for PRODUCAO.TAXA_TITULO_INTEGRACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TAXMOVTOOPERACFINANC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TAXMOVTOOPERACFINANC
  for EMS5.TAXMOVTOOPERACFINANC;

prompt
prompt Creating synonym TELEF
prompt ======================
prompt
create or replace synonym EMS506UNICOO.TELEF
  for EMS5.TELEF;

prompt
prompt Creating synonym TELEF_PESSOA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TELEF_PESSOA
  for EMS5.TELEF_PESSOA;

prompt
prompt Creating synonym TEMP_ABERTO_CONTABIL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TEMP_ABERTO_CONTABIL
  for PRODUCAO.TEMP_ABERTO_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_ACESSO_MODULO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TEMP_ACESSO_MODULO
  for PRODUCAO.TEMP_ACESSO_MODULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_ALTERACAO_PAGAR
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TEMP_ALTERACAO_PAGAR
  for PRODUCAO.TEMP_ALTERACAO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_ALTERACAO_RECEBER
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TEMP_ALTERACAO_RECEBER
  for PRODUCAO.TEMP_ALTERACAO_RECEBER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_ALTERACAO_TITULO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TEMP_ALTERACAO_TITULO
  for PRODUCAO.TEMP_ALTERACAO_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_ALTERACAO_TX_TITULO_PAGAR
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.TEMP_ALTERACAO_TX_TITULO_PAGAR
  for PRODUCAO.TEMP_ALTERACAO_TX_TITULO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_APROPRIA_FATURA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TEMP_APROPRIA_FATURA
  for PRODUCAO.TEMP_APROPRIA_FATURA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_AUDIT_MEDICA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TEMP_AUDIT_MEDICA
  for PRODUCAO.TEMP_AUDIT_MEDICA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_BOLETO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.TEMP_BOLETO
  for PRODUCAO.TEMP_BOLETO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_BOLETO_BANESPA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TEMP_BOLETO_BANESPA
  for PRODUCAO.TEMP_BOLETO_BANESPA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_CAIXA_MOVBAIXA
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TEMP_CAIXA_MOVBAIXA
  for PRODUCAO.TEMP_CAIXA_MOVBAIXA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_CARGA_PRECO_CONTRATO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_CARGA_PRECO_CONTRATO
  for PRODUCAO.TEMP_CARGA_PRECO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_CATEGORIA_PROPOSTA_PLANO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.TEMP_CATEGORIA_PROPOSTA_PLANO
  for PRODUCAO.TEMP_CATEGORIA_PROPOSTA_PLANO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_COINCIDENTE
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TEMP_COINCIDENTE
  for PRODUCAO.TEMP_COINCIDENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_COINCIDENTE_DETALHE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_COINCIDENTE_DETALHE
  for PRODUCAO.TEMP_COINCIDENTE_DETALHE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_COMP_IMPOSTO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TEMP_COMP_IMPOSTO
  for PRODUCAO.TEMP_COMP_IMPOSTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_CONCILIACAO_BANCARIA
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_CONCILIACAO_BANCARIA
  for PRODUCAO.TEMP_CONCILIACAO_BANCARIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_CONSULTA_CONTEST_AJIUS
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.TEMP_CONSULTA_CONTEST_AJIUS
  for PRODUCAO.TEMP_CONSULTA_CONTEST_AJIUS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_DADOS_FATURA_A800
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TEMP_DADOS_FATURA_A800
  for PRODUCAO.TEMP_DADOS_FATURA_A800@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_DADOS_LOTE
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TEMP_DADOS_LOTE
  for PRODUCAO.TEMP_DADOS_LOTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_DEMONSTRATIVO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TEMP_DEMONSTRATIVO
  for PRODUCAO.TEMP_DEMONSTRATIVO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_DEMONSTRATIVO_FINANC_CC
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.TEMP_DEMONSTRATIVO_FINANC_CC
  for PRODUCAO.TEMP_DEMONSTRATIVO_FINANC_CC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_DEMONSTRATIVO_FINANCEIRO
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.TEMP_DEMONSTRATIVO_FINANCEIRO
  for PRODUCAO.TEMP_DEMONSTRATIVO_FINANCEIRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_DEPENDENTE_PROPOSTA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_DEPENDENTE_PROPOSTA
  for PRODUCAO.TEMP_DEPENDENTE_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_DETALHE_PROV_LIQUIDAR
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_DETALHE_PROV_LIQUIDAR
  for PRODUCAO.TEMP_DETALHE_PROV_LIQUIDAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_DIRF
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.TEMP_DIRF
  for PRODUCAO.TEMP_DIRF@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_DISTRIB_ALTER_PAGAR
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_DISTRIB_ALTER_PAGAR
  for PRODUCAO.TEMP_DISTRIB_ALTER_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_EMISSAO_CHEQUE
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TEMP_EMISSAO_CHEQUE
  for PRODUCAO.TEMP_EMISSAO_CHEQUE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_EMITE_CARTA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TEMP_EMITE_CARTA
  for PRODUCAO.TEMP_EMITE_CARTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_EMPRESAS_ACUMULO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TEMP_EMPRESAS_ACUMULO
  for PRODUCAO.TEMP_EMPRESAS_ACUMULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_ENCONTRO_CONTAS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TEMP_ENCONTRO_CONTAS
  for PRODUCAO.TEMP_ENCONTRO_CONTAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_ENVIO_PAGAR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TEMP_ENVIO_PAGAR
  for PRODUCAO.TEMP_ENVIO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_ENVIO_RECEBER
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TEMP_ENVIO_RECEBER
  for PRODUCAO.TEMP_ENVIO_RECEBER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_ERRO_UNIMED
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TEMP_ERRO_UNIMED
  for PRODUCAO.TEMP_ERRO_UNIMED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_FALHA_DE_PROCESSO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TEMP_FALHA_DE_PROCESSO
  for PRODUCAO.TEMP_FALHA_DE_PROCESSO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_FAMILIA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TEMP_FAMILIA
  for PRODUCAO.TEMP_FAMILIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_FATURAMENTO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TEMP_FATURAMENTO
  for PRODUCAO.TEMP_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_FATURAMENTO_GFIP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TEMP_FATURAMENTO_GFIP
  for PRODUCAO.TEMP_FATURAMENTO_GFIP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_FLUXO_GERAL
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TEMP_FLUXO_GERAL
  for PRODUCAO.TEMP_FLUXO_GERAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_GERACAO_A800
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TEMP_GERACAO_A800
  for PRODUCAO.TEMP_GERACAO_A800@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_GERACAO_NFSE
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TEMP_GERACAO_NFSE
  for PRODUCAO.TEMP_GERACAO_NFSE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_GERACAO_RPC
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TEMP_GERACAO_RPC
  for PRODUCAO.TEMP_GERACAO_RPC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_GRE_FOLDER
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TEMP_GRE_FOLDER
  for PRODUCAO.TEMP_GRE_FOLDER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_GRE_ITEM
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TEMP_GRE_ITEM
  for PRODUCAO.TEMP_GRE_ITEM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_GRE_PARAMETRO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TEMP_GRE_PARAMETRO
  for PRODUCAO.TEMP_GRE_PARAMETRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_GRE_SELECT
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TEMP_GRE_SELECT
  for PRODUCAO.TEMP_GRE_SELECT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_GUIA_PRESTADOR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TEMP_GUIA_PRESTADOR
  for PRODUCAO.TEMP_GUIA_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_IMPCTB_LANCTO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TEMP_IMPCTB_LANCTO
  for PRODUCAO.TEMP_IMPCTB_LANCTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_IMPCTB_LOTE
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TEMP_IMPCTB_LOTE
  for PRODUCAO.TEMP_IMPCTB_LOTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_IMPCTB_MENSAGEM
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TEMP_IMPCTB_MENSAGEM
  for PRODUCAO.TEMP_IMPCTB_MENSAGEM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_IMPOSTO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TEMP_IMPOSTO
  for PRODUCAO.TEMP_IMPOSTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_INTEGRACAO_CONTABIL
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_INTEGRACAO_CONTABIL
  for PRODUCAO.TEMP_INTEGRACAO_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_INTEGRACAO_PAGTO_PAGAR
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.TEMP_INTEGRACAO_PAGTO_PAGAR
  for PRODUCAO.TEMP_INTEGRACAO_PAGTO_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_LAN
prompt =========================
prompt
create or replace synonym EMS506UNICOO.TEMP_LAN
  for PRODUCAO.TEMP_LAN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_LANCAMENTO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TEMP_LANCAMENTO
  for PRODUCAO.TEMP_LANCAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_LIBERA_TITULO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TEMP_LIBERA_TITULO
  for PRODUCAO.TEMP_LIBERA_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_LIM_CARENC_PROPOSTA_PLANO
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.TEMP_LIM_CARENC_PROPOSTA_PLANO
  for PRODUCAO.TEMP_LIM_CARENC_PROPOSTA_PLANO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_MENSAGEM
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TEMP_MENSAGEM
  for PRODUCAO.TEMP_MENSAGEM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_MOV_HIST_PRORATA_REC
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_MOV_HIST_PRORATA_REC
  for PRODUCAO.TEMP_MOV_HIST_PRORATA_REC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_MOV_US_CATEGORIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TEMP_MOV_US_CATEGORIA
  for PRODUCAO.TEMP_MOV_US_CATEGORIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_MOVIMENTACAO_USUARIO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_MOVIMENTACAO_USUARIO
  for PRODUCAO.TEMP_MOVIMENTACAO_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_MOVIMENTO_CAIXA_DOCTO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_MOVIMENTO_CAIXA_DOCTO
  for PRODUCAO.TEMP_MOVIMENTO_CAIXA_DOCTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_MUDA_UNIMED
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TEMP_MUDA_UNIMED
  for PRODUCAO.TEMP_MUDA_UNIMED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_OMEGA
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.TEMP_OMEGA
  for PRODUCAO.TEMP_OMEGA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_PEONA
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.TEMP_PEONA
  for PRODUCAO.TEMP_PEONA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_PODE_APAGAR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TEMP_PODE_APAGAR
  for PRODUCAO.TEMP_PODE_APAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_PRECO_CONTRATO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TEMP_PRECO_CONTRATO
  for PRODUCAO.TEMP_PRECO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_PRECO_CONTRATO_PESSOA
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_PRECO_CONTRATO_PESSOA
  for PRODUCAO.TEMP_PRECO_CONTRATO_PESSOA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_PRECO_HISTORICO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TEMP_PRECO_HISTORICO
  for PRODUCAO.TEMP_PRECO_HISTORICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_PRECO_USUARIO_PROPOSTA
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.TEMP_PRECO_USUARIO_PROPOSTA
  for PRODUCAO.TEMP_PRECO_USUARIO_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_PREVISAO_FLUXO_CAIXA
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_PREVISAO_FLUXO_CAIXA
  for PRODUCAO.TEMP_PREVISAO_FLUXO_CAIXA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_PROCESSO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TEMP_PROCESSO
  for PRODUCAO.TEMP_PROCESSO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_PRODUCAO_GFIP
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TEMP_PRODUCAO_GFIP
  for PRODUCAO.TEMP_PRODUCAO_GFIP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_PRORROGACAO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TEMP_PRORROGACAO
  for PRODUCAO.TEMP_PRORROGACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_PROTOCOLO_CONTRATO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_PROTOCOLO_CONTRATO
  for PRODUCAO.TEMP_PROTOCOLO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_RATEIO_PRODUCAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TEMP_RATEIO_PRODUCAO
  for PRODUCAO.TEMP_RATEIO_PRODUCAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_RAZAO_CONTABIL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TEMP_RAZAO_CONTABIL
  for PRODUCAO.TEMP_RAZAO_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_REL_APURACAO_CUSTO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_REL_APURACAO_CUSTO
  for PRODUCAO.TEMP_REL_APURACAO_CUSTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_REL_ENCONTRO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TEMP_REL_ENCONTRO
  for PRODUCAO.TEMP_REL_ENCONTRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_REL_IMPOSTO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TEMP_REL_IMPOSTO
  for PRODUCAO.TEMP_REL_IMPOSTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_REL_PRORATA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TEMP_REL_PRORATA
  for PRODUCAO.TEMP_REL_PRORATA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_REM_MASSA_USUARIO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TEMP_REM_MASSA_USUARIO
  for PRODUCAO.TEMP_REM_MASSA_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_RESUMO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.TEMP_RESUMO
  for PRODUCAO.TEMP_RESUMO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_SALDO_PRORATA_REC
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TEMP_SALDO_PRORATA_REC
  for PRODUCAO.TEMP_SALDO_PRORATA_REC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_SELECAO_TRANSF_CARENC
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_SELECAO_TRANSF_CARENC
  for PRODUCAO.TEMP_SELECAO_TRANSF_CARENC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_SELECAO_TRANSF_CONTR_PES
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.TEMP_SELECAO_TRANSF_CONTR_PES
  for PRODUCAO.TEMP_SELECAO_TRANSF_CONTR_PES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_SELECAO_TRANSFERENCIA
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_SELECAO_TRANSFERENCIA
  for PRODUCAO.TEMP_SELECAO_TRANSFERENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_SERVICO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TEMP_SERVICO
  for PRODUCAO.TEMP_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_SERVICO_DA_PERICIA
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_SERVICO_DA_PERICIA
  for PRODUCAO.TEMP_SERVICO_DA_PERICIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_SERVICO_TAB_REFER
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TEMP_SERVICO_TAB_REFER
  for PRODUCAO.TEMP_SERVICO_TAB_REFER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_TAB_GUIA
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TEMP_TAB_GUIA
  for PRODUCAO.TEMP_TAB_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_TABELA_REFERENCIA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TEMP_TABELA_REFERENCIA
  for PRODUCAO.TEMP_TABELA_REFERENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_TISS_XML
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TEMP_TISS_XML
  for PRODUCAO.TEMP_TISS_XML@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_TITULO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.TEMP_TITULO
  for PRODUCAO.TEMP_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_TITULO_HISTORICO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TEMP_TITULO_HISTORICO
  for PRODUCAO.TEMP_TITULO_HISTORICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_US_EMPRESA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TEMP_US_EMPRESA
  for PRODUCAO.TEMP_US_EMPRESA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_US_EMPRESA_COPIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TEMP_US_EMPRESA_COPIA
  for PRODUCAO.TEMP_US_EMPRESA_COPIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_USUARIO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TEMP_USUARIO
  for PRODUCAO.TEMP_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_USUARIO_IDENTIFICACAO
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_USUARIO_IDENTIFICACAO
  for PRODUCAO.TEMP_USUARIO_IDENTIFICACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_USUARIO_PROPOSTA_PLANO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.TEMP_USUARIO_PROPOSTA_PLANO
  for PRODUCAO.TEMP_USUARIO_PROPOSTA_PLANO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_USUARIOS_PROPOSTA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TEMP_USUARIOS_PROPOSTA
  for PRODUCAO.TEMP_USUARIOS_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEMP_USUARIOS_REPASSADOS
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TEMP_USUARIOS_REPASSADOS
  for PRODUCAO.TEMP_USUARIOS_REPASSADOS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TERMO_CONTABIL
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TERMO_CONTABIL
  for PRODUCAO.TERMO_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TERMO_DOCUMEN
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TERMO_DOCUMEN
  for EMS5.TERMO_DOCUMEN;

prompt
prompt Creating synonym TERMO_DOCUMEN_IDIOM
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TERMO_DOCUMEN_IDIOM
  for EMS5.TERMO_DOCUMEN_IDIOM;

prompt
prompt Creating synonym TERMO_RESPDE_BEM_PAT
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TERMO_RESPDE_BEM_PAT
  for EMS5.TERMO_RESPDE_BEM_PAT;

prompt
prompt Creating synonym TESTA_HORARIO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TESTA_HORARIO
  for PRODUCAO.TESTA_HORARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TESTE023
prompt =========================
prompt
create or replace synonym EMS506UNICOO.TESTE023
  for PRODUCAO.TESTE023@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TESTE_MODULO11
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TESTE_MODULO11
  for PRODUCAO.TESTE_MODULO11@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TESTE_RADAR
prompt ============================
prompt
create or replace synonym EMS506UNICOO.TESTE_RADAR
  for PRODUCAO.TESTE_RADAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEXT_PADR_DOCUMEN
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TEXT_PADR_DOCUMEN
  for EMS5.TEXT_PADR_DOCUMEN;

prompt
prompt Creating synonym TEXTO_CADASTRO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TEXTO_CADASTRO
  for PRODUCAO.TEXTO_CADASTRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEXTO_CLIENTE
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TEXTO_CLIENTE
  for PRODUCAO.TEXTO_CLIENTE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEXTO_DOCUMENTO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TEXTO_DOCUMENTO
  for PRODUCAO.TEXTO_DOCUMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEXTO_TITULO
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TEXTO_TITULO
  for PRODUCAO.TEXTO_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TEXTPADRDOCUMENIDIOM
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TEXTPADRDOCUMENIDIOM
  for EMS5.TEXTPADRDOCUMENIDIOM;

prompt
prompt Creating synonym TIME_CONNECTION
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TIME_CONNECTION
  for EMS5.TIME_CONNECTION;

prompt
prompt Creating synonym TIP_ABAT
prompt =========================
prompt
create or replace synonym EMS506UNICOO.TIP_ABAT
  for EMS5.TIP_ABAT;

prompt
prompt Creating synonym TIP_CALC
prompt =========================
prompt
create or replace synonym EMS506UNICOO.TIP_CALC
  for EMS5.TIP_CALC;

prompt
prompt Creating synonym TIP_CALC_ENCARGO_CTA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TIP_CALC_ENCARGO_CTA
  for EMS5.TIP_CALC_ENCARGO_CTA;

prompt
prompt Creating synonym TIP_CALC_ENCARGO_TAXAC
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TIP_CALC_ENCARGO_TAXAC
  for EMS5.TIP_CALC_ENCARGO_TAXAC;

prompt
prompt Creating synonym TIP_CALC_IMPTO_CMG
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TIP_CALC_IMPTO_CMG
  for EMS5.TIP_CALC_IMPTO_CMG;

prompt
prompt Creating synonym TIP_CHEQ
prompt =========================
prompt
create or replace synonym EMS506UNICOO.TIP_CHEQ
  for EMS5.TIP_CHEQ;

prompt
prompt Creating synonym TIP_CLIEN
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.TIP_CLIEN
  for EMS5.TIP_CLIEN;

prompt
prompt Creating synonym TIP_COL_BALANCT
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TIP_COL_BALANCT
  for EMS5.TIP_COL_BALANCT;

prompt
prompt Creating synonym TIP_DESPES_VIAGEM_EEC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TIP_DESPES_VIAGEM_EEC
  for EMS5.TIP_DESPES_VIAGEM_EEC;

prompt
prompt Creating synonym TIP_FLUXO_CTA_CTBL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TIP_FLUXO_CTA_CTBL
  for EMS5.TIP_FLUXO_CTA_CTBL;

prompt
prompt Creating synonym TIP_FLUXO_FINANC
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TIP_FLUXO_FINANC
  for EMS5.TIP_FLUXO_FINANC;

prompt
prompt Creating synonym TIP_FORNEC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.TIP_FORNEC
  for EMS5.TIP_FORNEC;

prompt
prompt Creating synonym TIP_GRP_CTA_CTBL
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TIP_GRP_CTA_CTBL
  for EMS5.TIP_GRP_CTA_CTBL;

prompt
prompt Creating synonym TIP_HIER_PAT
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TIP_HIER_PAT
  for EMS5.TIP_HIER_PAT;

prompt
prompt Creating synonym TIP_LANCTO_CTBL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TIP_LANCTO_CTBL
  for EMS5.TIP_LANCTO_CTBL;

prompt
prompt Creating synonym TIP_MOVTO_SPC
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TIP_MOVTO_SPC
  for EMS5.TIP_MOVTO_SPC;

prompt
prompt Creating synonym TIP_PROCES_DESPES
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TIP_PROCES_DESPES
  for EMS5.TIP_PROCES_DESPES;

prompt
prompt Creating synonym TIP_PROCES_PRESTAC_CTA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TIP_PROCES_PRESTAC_CTA
  for EMS5.TIP_PROCES_PRESTAC_CTA;

prompt
prompt Creating synonym TIP_PRODUT_FINANC
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TIP_PRODUT_FINANC
  for EMS5.TIP_PRODUT_FINANC;

prompt
prompt Creating synonym TIP_REG_EXTRAT_EXCEC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TIP_REG_EXTRAT_EXCEC
  for EMS5.TIP_REG_EXTRAT_EXCEC;

prompt
prompt Creating synonym TIP_REG_LAYOUT
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TIP_REG_LAYOUT
  for EMS5.TIP_REG_LAYOUT;

prompt
prompt Creating synonym TIP_REG_LAYOUT_EXCEC
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TIP_REG_LAYOUT_EXCEC
  for EMS5.TIP_REG_LAYOUT_EXCEC;

prompt
prompt Creating synonym TIP_REG_LAYOUT_EXTRAT
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TIP_REG_LAYOUT_EXTRAT
  for EMS5.TIP_REG_LAYOUT_EXTRAT;

prompt
prompt Creating synonym TIP_REPRES
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.TIP_REPRES
  for EMS5.TIP_REPRES;

prompt
prompt Creating synonym TIP_TOPIC
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.TIP_TOPIC
  for EMS5.TIP_TOPIC;

prompt
prompt Creating synonym TIP_TOPIC_IDIOM
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TIP_TOPIC_IDIOM
  for EMS5.TIP_TOPIC_IDIOM;

prompt
prompt Creating synonym TIP_TRANS_1099
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TIP_TRANS_1099
  for EMS5.TIP_TRANS_1099;

prompt
prompt Creating synonym TIP_TRANS_CX
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TIP_TRANS_CX
  for EMS5.TIP_TRANS_CX;

prompt
prompt Creating synonym TIP_TRANS_CX_ACR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TIP_TRANS_CX_ACR
  for EMS5.TIP_TRANS_CX_ACR;

prompt
prompt Creating synonym TIP_TRANS_CX_APL
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TIP_TRANS_CX_APL
  for EMS5.TIP_TRANS_CX_APL;

prompt
prompt Creating synonym TIP_TRANS_CX_CTA_CTBL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TIP_TRANS_CX_CTA_CTBL
  for EMS5.TIP_TRANS_CX_CTA_CTBL;

prompt
prompt Creating synonym TIP_TRANS_CX_NREAL_APB
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TIP_TRANS_CX_NREAL_APB
  for EMS5.TIP_TRANS_CX_NREAL_APB;

prompt
prompt Creating synonym TIP_TRANS_CX_PADR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TIP_TRANS_CX_PADR
  for EMS5.TIP_TRANS_CX_PADR;

prompt
prompt Creating synonym TIP_TRANS_CX_REAL_APB
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TIP_TRANS_CX_REAL_APB
  for EMS5.TIP_TRANS_CX_REAL_APB;

prompt
prompt Creating synonym TIP_TRANSP_EEC
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TIP_TRANSP_EEC
  for EMS5.TIP_TRANSP_EEC;

prompt
prompt Creating synonym TIP_TRANSP_ROTA_EEC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TIP_TRANSP_ROTA_EEC
  for EMS5.TIP_TRANSP_ROTA_EEC;

prompt
prompt Creating synonym TIP_UNID_ORGAN
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TIP_UNID_ORGAN
  for EMS5.TIP_UNID_ORGAN;

prompt
prompt Creating synonym TIPO_ACOMODACAO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TIPO_ACOMODACAO
  for PRODUCAO.TIPO_ACOMODACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_ACOMODACAO_TISS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TIPO_ACOMODACAO_TISS
  for PRODUCAO.TIPO_ACOMODACAO_TISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_ATENDIMENTO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TIPO_ATENDIMENTO
  for PRODUCAO.TIPO_ATENDIMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_ATENDIMENTO_IMPORTACAO
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.TIPO_ATENDIMENTO_IMPORTACAO
  for PRODUCAO.TIPO_ATENDIMENTO_IMPORTACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_BLOQUEIO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TIPO_BLOQUEIO
  for PRODUCAO.TIPO_BLOQUEIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_CARENCIA
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TIPO_CARENCIA
  for PRODUCAO.TIPO_CARENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_CATEGORIA_DE_SERVICO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.TIPO_CATEGORIA_DE_SERVICO
  for PRODUCAO.TIPO_CATEGORIA_DE_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_AFASTAMENTO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_AFASTAMENTO
  for PRODUCAO.TIPO_DE_AFASTAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_BANCO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_BANCO
  for PRODUCAO.TIPO_DE_BANCO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_CALCULO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_CALCULO
  for PRODUCAO.TIPO_DE_CALCULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_CARTA
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_CARTA
  for PRODUCAO.TIPO_DE_CARTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_CARTEIRA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_CARTEIRA
  for PRODUCAO.TIPO_DE_CARTEIRA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_CONTRATACAO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_CONTRATACAO
  for PRODUCAO.TIPO_DE_CONTRATACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_CONTRATO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_CONTRATO
  for PRODUCAO.TIPO_DE_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_CRITERIO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_CRITERIO
  for PRODUCAO.TIPO_DE_CRITERIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_DESPESA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_DESPESA
  for PRODUCAO.TIPO_DE_DESPESA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_ENDERECO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_ENDERECO
  for PRODUCAO.TIPO_DE_ENDERECO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_EVENTO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_EVENTO
  for PRODUCAO.TIPO_DE_EVENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_EVENTO_COPIA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_EVENTO_COPIA
  for PRODUCAO.TIPO_DE_EVENTO_COPIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_FAIXA_DE_IDADE
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_FAIXA_DE_IDADE
  for PRODUCAO.TIPO_DE_FAIXA_DE_IDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_FATURA_AVULSA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_FATURA_AVULSA
  for PRODUCAO.TIPO_DE_FATURA_AVULSA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_FATURAMENTO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_FATURAMENTO
  for PRODUCAO.TIPO_DE_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_GUIA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_GUIA
  for PRODUCAO.TIPO_DE_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_GUIA_TISS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_GUIA_TISS
  for PRODUCAO.TIPO_DE_GUIA_TISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_HORA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_HORA
  for PRODUCAO.TIPO_DE_HORA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_INTERNACAO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_INTERNACAO
  for PRODUCAO.TIPO_DE_INTERNACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_PLANO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_PLANO
  for PRODUCAO.TIPO_DE_PLANO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_PRESTADOR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_PRESTADOR
  for PRODUCAO.TIPO_DE_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_RECEPCAO
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_RECEPCAO
  for PRODUCAO.TIPO_DE_RECEPCAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_DE_USUARIO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TIPO_DE_USUARIO
  for PRODUCAO.TIPO_DE_USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_ENCERRAMENTO_RDC85
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.TIPO_ENCERRAMENTO_RDC85
  for PRODUCAO.TIPO_ENCERRAMENTO_RDC85@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_ESQUEMA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TIPO_ESQUEMA
  for PRODUCAO.TIPO_ESQUEMA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_EVENTO_FATURAMENTO
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.TIPO_EVENTO_FATURAMENTO
  for PRODUCAO.TIPO_EVENTO_FATURAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_FATURACO_CONTRATO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TIPO_FATURACO_CONTRATO
  for PRODUCAO.TIPO_FATURACO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_MATERIAL
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TIPO_MATERIAL
  for PRODUCAO.TIPO_MATERIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_MOVIMENTO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TIPO_MOVIMENTO
  for PRODUCAO.TIPO_MOVIMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_OCORRENCIA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TIPO_OCORRENCIA
  for PRODUCAO.TIPO_OCORRENCIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_PAGAMENTO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TIPO_PAGAMENTO
  for PRODUCAO.TIPO_PAGAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_PERICIA
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TIPO_PERICIA
  for PRODUCAO.TIPO_PERICIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_PLANO_CONTR_PES
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TIPO_PLANO_CONTR_PES
  for PRODUCAO.TIPO_PLANO_CONTR_PES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_PLANO_CONTRATO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TIPO_PLANO_CONTRATO
  for PRODUCAO.TIPO_PLANO_CONTRATO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_PLANO_PTU
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TIPO_PLANO_PTU
  for PRODUCAO.TIPO_PLANO_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_PRE_AUTORIZACAO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TIPO_PRE_AUTORIZACAO
  for PRODUCAO.TIPO_PRE_AUTORIZACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_PRESTADOR_SELECAO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TIPO_PRESTADOR_SELECAO
  for PRODUCAO.TIPO_PRESTADOR_SELECAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_PRESTADOR_SELECAO_ITEM
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.TIPO_PRESTADOR_SELECAO_ITEM
  for PRODUCAO.TIPO_PRESTADOR_SELECAO_ITEM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_RECURSO_AGENDA_COMERCIAL
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.TIPO_RECURSO_AGENDA_COMERCIAL
  for PRODUCAO.TIPO_RECURSO_AGENDA_COMERCIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_REG_PROTOCOLO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TIPO_REG_PROTOCOLO
  for PRODUCAO.TIPO_REG_PROTOCOLO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_TEXTO
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.TIPO_TEXTO
  for PRODUCAO.TIPO_TEXTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_TITULO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.TIPO_TITULO
  for PRODUCAO.TIPO_TITULO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_TRANSACAO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TIPO_TRANSACAO
  for PRODUCAO.TIPO_TRANSACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_TRATAMENTO_ESPECIAL
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TIPO_TRATAMENTO_ESPECIAL
  for PRODUCAO.TIPO_TRATAMENTO_ESPECIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPO_VENDA
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.TIPO_VENDA
  for PRODUCAO.TIPO_VENDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPOCART_EMISS_CART
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TIPOCART_EMISS_CART
  for PRODUCAO.TIPOCART_EMISS_CART@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIPTRANSPEMPRESTRANSP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TIPTRANSPEMPRESTRANSP
  for EMS5.TIPTRANSPEMPRESTRANSP;

prompt
prompt Creating synonym TISS_DADOS_ELEGIBILIDADE
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TISS_DADOS_ELEGIBILIDADE
  for PRODUCAO.TISS_DADOS_ELEGIBILIDADE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TISS_ENVIO_ANS
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TISS_ENVIO_ANS
  for PRODUCAO.TISS_ENVIO_ANS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TISS_ENVIO_ANS_CONTROLE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.TISS_ENVIO_ANS_CONTROLE
  for PRODUCAO.TISS_ENVIO_ANS_CONTROLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TISS_ENVIO_ANS_CONTROLE_IMP
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.TISS_ENVIO_ANS_CONTROLE_IMP
  for PRODUCAO.TISS_ENVIO_ANS_CONTROLE_IMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TISS_ENVIO_ANS_FALHAS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TISS_ENVIO_ANS_FALHAS
  for PRODUCAO.TISS_ENVIO_ANS_FALHAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TISS_ENVIO_ANS_FALHAS_IMP
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.TISS_ENVIO_ANS_FALHAS_IMP
  for PRODUCAO.TISS_ENVIO_ANS_FALHAS_IMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TISS_ENVIO_ANS_MOV_14_10_2015
prompt ==============================================
prompt
create or replace synonym EMS506UNICOO.TISS_ENVIO_ANS_MOV_14_10_2015
  for PRODUCAO.TISS_ENVIO_ANS_MOV_14_10_2015@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TISS_ENVIO_ANS_MOVIMENTO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TISS_ENVIO_ANS_MOVIMENTO
  for PRODUCAO.TISS_ENVIO_ANS_MOVIMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TISS_ENVIO_ANS_SERV
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TISS_ENVIO_ANS_SERV
  for PRODUCAO.TISS_ENVIO_ANS_SERV@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TISS_ENVIO_ANS_SERV_PCT
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.TISS_ENVIO_ANS_SERV_PCT
  for PRODUCAO.TISS_ENVIO_ANS_SERV_PCT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TISS_ENVIO_MOV_CONTROLE
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.TISS_ENVIO_MOV_CONTROLE
  for PRODUCAO.TISS_ENVIO_MOV_CONTROLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TISS_RADAR_DADOS_GERACAO
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TISS_RADAR_DADOS_GERACAO
  for PRODUCAO.TISS_RADAR_DADOS_GERACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TISS_RADAR_QUESTAO1
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TISS_RADAR_QUESTAO1
  for PRODUCAO.TISS_RADAR_QUESTAO1@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TISS_RADAR_QUESTAO2
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TISS_RADAR_QUESTAO2
  for PRODUCAO.TISS_RADAR_QUESTAO2@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TISS_RADAR_QUESTAO2_2014
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TISS_RADAR_QUESTAO2_2014
  for PRODUCAO.TISS_RADAR_QUESTAO2_2014@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TIT_ACR
prompt ========================
prompt
create or replace synonym EMS506UNICOO.TIT_ACR
  for EMS5.TIT_ACR;

prompt
prompt Creating synonym TIT_ACR_AVP
prompt ============================
prompt
create or replace synonym EMS506UNICOO.TIT_ACR_AVP
  for EMS5.TIT_ACR_AVP;

prompt
prompt Creating synonym TIT_ACR_COBR_ATIV
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TIT_ACR_COBR_ATIV
  for EMS5.TIT_ACR_COBR_ATIV;

prompt
prompt Creating synonym TIT_ACR_COBR_ESPECIAL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TIT_ACR_COBR_ESPECIAL
  for EMS5.TIT_ACR_COBR_ESPECIAL;

prompt
prompt Creating synonym TIT_ACR_ENVIO_SERASA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TIT_ACR_ENVIO_SERASA
  for EMS5.TIT_ACR_ENVIO_SERASA;

prompt
prompt Creating synonym TIT_ACR_FECHADO
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TIT_ACR_FECHADO
  for EMS5.TIT_ACR_FECHADO;

prompt
prompt Creating synonym TIT_ACR_MSG_FINANC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TIT_ACR_MSG_FINANC
  for EMS5.TIT_ACR_MSG_FINANC;

prompt
prompt Creating synonym TIT_ACR_TERC
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TIT_ACR_TERC
  for EMS5.TIT_ACR_TERC;

prompt
prompt Creating synonym TIT_AP
prompt =======================
prompt
create or replace synonym EMS506UNICOO.TIT_AP
  for EMS5.TIT_AP;

prompt
prompt Creating synonym TIT_AP_AVP
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.TIT_AP_AVP
  for EMS5.TIT_AP_AVP;

prompt
prompt Creating synonym TIT_AP_BCIO
prompt ============================
prompt
create or replace synonym EMS506UNICOO.TIT_AP_BCIO
  for EMS5.TIT_AP_BCIO;

prompt
prompt Creating synonym TIT_AP_FECHADO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TIT_AP_FECHADO
  for EMS5.TIT_AP_FECHADO;

prompt
prompt Creating synonym TIT_AP_LIBER
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TIT_AP_LIBER
  for EMS5.TIT_AP_LIBER;

prompt
prompt Creating synonym TIT_AP_LIBER_SEC
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TIT_AP_LIBER_SEC
  for EMS5.TIT_AP_LIBER_SEC;

prompt
prompt Creating synonym TIT_CANCDO_ACR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TIT_CANCDO_ACR
  for EMS5.TIT_CANCDO_ACR;

prompt
prompt Creating synonym TIT_CANCDO_APB
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TIT_CANCDO_APB
  for EMS5.TIT_CANCDO_APB;

prompt
prompt Creating synonym TIT_CARTA_ANUENCIA
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TIT_CARTA_ANUENCIA
  for EMS5.TIT_CARTA_ANUENCIA;

prompt
prompt Creating synonym TIT_CTBL
prompt =========================
prompt
create or replace synonym EMS506UNICOO.TIT_CTBL
  for EMS5.TIT_CTBL;

prompt
prompt Creating synonym TIT_DARF_AP
prompt ============================
prompt
create or replace synonym EMS506UNICOO.TIT_DARF_AP
  for EMS5.TIT_DARF_AP;

prompt
prompt Creating synonym TIT_INADIMP
prompt ============================
prompt
create or replace synonym EMS506UNICOO.TIT_INADIMP
  for EMS5.TIT_INADIMP;

prompt
prompt Creating synonym TITCALCRENEGOCINADIMP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TITCALCRENEGOCINADIMP
  for EMS5.TITCALCRENEGOCINADIMP;

prompt
prompt Creating synonym TITCONTRAEMPRESEMBCO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TITCONTRAEMPRESEMBCO
  for EMS5.TITCONTRAEMPRESEMBCO;

prompt
prompt Creating synonym TITULO_A_PAGAR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TITULO_A_PAGAR
  for PRODUCAO.TITULO_A_PAGAR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TITULO_A_PAGAR_TOTVS11
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TITULO_A_PAGAR_TOTVS11
  for PRODUCAO.TITULO_A_PAGAR_TOTVS11@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TITULO_A_RECEBER
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TITULO_A_RECEBER
  for PRODUCAO.TITULO_A_RECEBER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TITULO_A_RECEBER_TEMP
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TITULO_A_RECEBER_TEMP
  for PRODUCAO.TITULO_A_RECEBER_TEMP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TITULO_CARTA_EMITIDA
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TITULO_CARTA_EMITIDA
  for PRODUCAO.TITULO_CARTA_EMITIDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TITULO_CARTA_EMITIDA_ANT
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TITULO_CARTA_EMITIDA_ANT
  for PRODUCAO.TITULO_CARTA_EMITIDA_ANT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TITULO_GERADO_ENCONTRO
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TITULO_GERADO_ENCONTRO
  for PRODUCAO.TITULO_GERADO_ENCONTRO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TITULO_PARCELAMENTO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TITULO_PARCELAMENTO
  for PRODUCAO.TITULO_PARCELAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TITULOS_REATIVACAO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TITULOS_REATIVACAO
  for PRODUCAO.TITULOS_REATIVACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TMOVIMENTO_DOCUMENTO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TMOVIMENTO_DOCUMENTO
  for PRODUCAO.TMOVIMENTO_DOCUMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TMP_A400_MOV_PRESTADOR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TMP_A400_MOV_PRESTADOR
  for PRODUCAO.TMP_A400_MOV_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TMP_CARGA
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.TMP_CARGA
  for PRODUCAO.TMP_CARGA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TMP_CONTA_CONTABIL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TMP_CONTA_CONTABIL
  for PRODUCAO.TMP_CONTA_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TMP_DADOS_SRF_MANAD
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TMP_DADOS_SRF_MANAD
  for PRODUCAO.TMP_DADOS_SRF_MANAD@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TMP_DE_PARA_PRESTADOR
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TMP_DE_PARA_PRESTADOR
  for PRODUCAO.TMP_DE_PARA_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TMP_GUIA_SERV_POS_MES_ERRADO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.TMP_GUIA_SERV_POS_MES_ERRADO
  for PRODUCAO.TMP_GUIA_SERV_POS_MES_ERRADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TMP_IMP_EVENTO_PRESTADOR
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TMP_IMP_EVENTO_PRESTADOR
  for PRODUCAO.TMP_IMP_EVENTO_PRESTADOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TMP_MOVIMENTO_PREST_GUIA
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.TMP_MOVIMENTO_PREST_GUIA
  for PRODUCAO.TMP_MOVIMENTO_PREST_GUIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TMP_REAJUSTE_FAIXA_ETARIA
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.TMP_REAJUSTE_FAIXA_ETARIA
  for PRODUCAO.TMP_REAJUSTE_FAIXA_ETARIA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TMP_REL_USU
prompt ============================
prompt
create or replace synonym EMS506UNICOO.TMP_REL_USU
  for PRODUCAO.TMP_REL_USU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TMP_SELECAO_DADOS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TMP_SELECAO_DADOS
  for PRODUCAO.TMP_SELECAO_DADOS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TMP_SELECAO_GUIAS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TMP_SELECAO_GUIAS
  for PRODUCAO.TMP_SELECAO_GUIAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TMP_SERV_EXECUCAO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TMP_SERV_EXECUCAO
  for PRODUCAO.TMP_SERV_EXECUCAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TOPIC_COMPON_DOCUMEN
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TOPIC_COMPON_DOCUMEN
  for EMS5.TOPIC_COMPON_DOCUMEN;

prompt
prompt Creating synonym TOPIC_ESTIL
prompt ============================
prompt
create or replace synonym EMS506UNICOO.TOPIC_ESTIL
  for EMS5.TOPIC_ESTIL;

prompt
prompt Creating synonym TOPIC_GRP_USUAR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TOPIC_GRP_USUAR
  for EMS5.TOPIC_GRP_USUAR;

prompt
prompt Creating synonym TOPIC_IDIOM
prompt ============================
prompt
create or replace synonym EMS506UNICOO.TOPIC_IDIOM
  for EMS5.TOPIC_IDIOM;

prompt
prompt Creating synonym TOPICO
prompt =======================
prompt
create or replace synonym EMS506UNICOO.TOPICO
  for EMS5.TOPICO;

prompt
prompt Creating synonym TOT_AVP_PERIOD_ACR
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.TOT_AVP_PERIOD_ACR
  for EMS5.TOT_AVP_PERIOD_ACR;

prompt
prompt Creating synonym TOT_AVP_PERIOD_AP
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TOT_AVP_PERIOD_AP
  for EMS5.TOT_AVP_PERIOD_AP;

prompt
prompt Creating synonym TOT_LANCTO_CTBL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TOT_LANCTO_CTBL
  for EMS5.TOT_LANCTO_CTBL;

prompt
prompt Creating synonym TOTAL_CREDITO_LANCTO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.TOTAL_CREDITO_LANCTO
  for PRODUCAO.TOTAL_CREDITO_LANCTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TOTAL_DEBITO_LANCTO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TOTAL_DEBITO_LANCTO
  for PRODUCAO.TOTAL_DEBITO_LANCTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TOTAL_INTERNACOES_DOS_USUARIOS
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.TOTAL_INTERNACOES_DOS_USUARIOS
  for PRODUCAO.TOTAL_INTERNACOES_DOS_USUARIOS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TOTALIZACAO_DMED
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TOTALIZACAO_DMED
  for PRODUCAO.TOTALIZACAO_DMED@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TPERMISSAO_CONTA_CAIXA
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.TPERMISSAO_CONTA_CAIXA
  for PRODUCAO.TPERMISSAO_CONTA_CAIXA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TRAD_CCUSTO_EXT
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TRAD_CCUSTO_EXT
  for EMS5.TRAD_CCUSTO_EXT;

prompt
prompt Creating synonym TRAD_CTA_CORREN
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TRAD_CTA_CORREN
  for EMS5.TRAD_CTA_CORREN;

prompt
prompt Creating synonym TRAD_CTA_CTBL_EXT
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TRAD_CTA_CTBL_EXT
  for EMS5.TRAD_CTA_CTBL_EXT;

prompt
prompt Creating synonym TRAD_CTA_PAT_EXT
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TRAD_CTA_PAT_EXT
  for EMS5.TRAD_CTA_PAT_EXT;

prompt
prompt Creating synonym TRAD_DEMONST_CONCOR
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.TRAD_DEMONST_CONCOR
  for EMS5.TRAD_DEMONST_CONCOR;

prompt
prompt Creating synonym TRAD_ELEMENT_EDI
prompt =================================
prompt
create or replace synonym EMS506UNICOO.TRAD_ELEMENT_EDI
  for EMS5.TRAD_ELEMENT_EDI;

prompt
prompt Creating synonym TRAD_FINALID_ECON_EXT
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TRAD_FINALID_ECON_EXT
  for EMS5.TRAD_FINALID_ECON_EXT;

prompt
prompt Creating synonym TRAD_FLUXO_EXT
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TRAD_FLUXO_EXT
  for EMS5.TRAD_FLUXO_EXT;

prompt
prompt Creating synonym TRAD_INDIC_ECON
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TRAD_INDIC_ECON
  for EMS5.TRAD_INDIC_ECON;

prompt
prompt Creating synonym TRAD_ORG_EXT
prompt =============================
prompt
create or replace synonym EMS506UNICOO.TRAD_ORG_EXT
  for EMS5.TRAD_ORG_EXT;

prompt
prompt Creating synonym TRAD_PAIS_EXT
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TRAD_PAIS_EXT
  for EMS5.TRAD_PAIS_EXT;

prompt
prompt Creating synonym TRAD_PORTAD_EXT
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TRAD_PORTAD_EXT
  for EMS5.TRAD_PORTAD_EXT;

prompt
prompt Creating synonym TRAD_TIP_FLUXO_FINANC
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.TRAD_TIP_FLUXO_FINANC
  for EMS5.TRAD_TIP_FLUXO_FINANC;

prompt
prompt Creating synonym TRAD_TIT_CTBL
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TRAD_TIT_CTBL
  for EMS5.TRAD_TIT_CTBL;

prompt
prompt Creating synonym TRANS_1099
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.TRANS_1099
  for EMS5.TRANS_1099;

prompt
prompt Creating synonym TRANS_BCIA_BCO
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TRANS_BCIA_BCO
  for EMS5.TRANS_BCIA_BCO;

prompt
prompt Creating synonym TRANS_EDI
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.TRANS_EDI
  for EMS5.TRANS_EDI;

prompt
prompt Creating synonym TRANS_SEGMENT_EDI
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TRANS_SEGMENT_EDI
  for EMS5.TRANS_SEGMENT_EDI;

prompt
prompt Creating synonym TRANSFERE_CAIXA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TRANSFERE_CAIXA
  for PRODUCAO.TRANSFERE_CAIXA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TRANSPORTADORA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.TRANSPORTADORA
  for PRODUCAO.TRANSPORTADORA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TST_HORARIO_EXTRA
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.TST_HORARIO_EXTRA
  for PRODUCAO.TST_HORARIO_EXTRA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TUSS
prompt =====================
prompt
create or replace synonym EMS506UNICOO.TUSS
  for PRODUCAO.TUSS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TUSS_23_11_10
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.TUSS_23_11_10
  for PRODUCAO.TUSS_23_11_10@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym TX_INTRACOMPANY
prompt ================================
prompt
create or replace synonym EMS506UNICOO.TX_INTRACOMPANY
  for EMS5.TX_INTRACOMPANY;

prompt
prompt Creating synonym ULT_SEQUENCIA_LANC_CONTABIL
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.ULT_SEQUENCIA_LANC_CONTABIL
  for PRODUCAO.ULT_SEQUENCIA_LANC_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym UNID_APROVAC_EEC
prompt =================================
prompt
create or replace synonym EMS506UNICOO.UNID_APROVAC_EEC
  for EMS5.UNID_APROVAC_EEC;

prompt
prompt Creating synonym UNID_CONTROL_FINANC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.UNID_CONTROL_FINANC
  for EMS5.UNID_CONTROL_FINANC;

prompt
prompt Creating synonym UNID_FECHTO_CTA_CORREN
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.UNID_FECHTO_CTA_CORREN
  for EMS5.UNID_FECHTO_CTA_CORREN;

prompt
prompt Creating synonym UNID_FECHTO_CX
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.UNID_FECHTO_CX
  for EMS5.UNID_FECHTO_CX;

prompt
prompt Creating synonym UNID_FECHTO_PRODUT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.UNID_FECHTO_PRODUT
  for EMS5.UNID_FECHTO_PRODUT;

prompt
prompt Creating synonym UNID_FEDERAC
prompt =============================
prompt
create or replace synonym EMS506UNICOO.UNID_FEDERAC
  for EMS5.UNID_FEDERAC;

prompt
prompt Creating synonym UNID_MEDID
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.UNID_MEDID
  for EMS5.UNID_MEDID;

prompt
prompt Creating synonym UNID_NEGOC
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.UNID_NEGOC
  for EMS5.UNID_NEGOC;

prompt
prompt Creating synonym UNID_ORCTARIA
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.UNID_ORCTARIA
  for EMS5.UNID_ORCTARIA;

prompt
prompt Creating synonym UNID_ORGAN
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.UNID_ORGAN
  for EMS5.UNID_ORGAN;

prompt
prompt Creating synonym UNIDADE_ATENDIMENTO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.UNIDADE_ATENDIMENTO
  for PRODUCAO.UNIDADE_ATENDIMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym UNIDADE_DE_VALOR
prompt =================================
prompt
create or replace synonym EMS506UNICOO.UNIDADE_DE_VALOR
  for PRODUCAO.UNIDADE_DE_VALOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym UNIDADE_MEDIDA
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.UNIDADE_MEDIDA
  for PRODUCAO.UNIDADE_MEDIDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym UNIDADE_TOM_ISS_ALIQUOTA_CLASS
prompt ===============================================
prompt
create or replace synonym EMS506UNICOO.UNIDADE_TOM_ISS_ALIQUOTA_CLASS
  for PRODUCAO.UNIDADE_TOM_ISS_ALIQUOTA_CLASS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym UNIDADE_TOMADORA_ISS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.UNIDADE_TOMADORA_ISS
  for PRODUCAO.UNIDADE_TOMADORA_ISS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym USUAR_APB_MODUL_PERMIS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.USUAR_APB_MODUL_PERMIS
  for EMS5.USUAR_APB_MODUL_PERMIS;

prompt
prompt Creating synonym USUAR_APL
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.USUAR_APL
  for EMS5.USUAR_APL;

prompt
prompt Creating synonym USUAR_CHEQ_ACR_TERC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.USUAR_CHEQ_ACR_TERC
  for EMS5.USUAR_CHEQ_ACR_TERC;

prompt
prompt Creating synonym USUAR_EVENT_CORREIO
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.USUAR_EVENT_CORREIO
  for EMS5.USUAR_EVENT_CORREIO;

prompt
prompt Creating synonym USUAR_FINANC
prompt =============================
prompt
create or replace synonym EMS506UNICOO.USUAR_FINANC
  for EMS5.USUAR_FINANC;

prompt
prompt Creating synonym USUAR_FINANC_ESTAB_ACR
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.USUAR_FINANC_ESTAB_ACR
  for EMS5.USUAR_FINANC_ESTAB_ACR;

prompt
prompt Creating synonym USUAR_FINANC_ESTAB_APB
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.USUAR_FINANC_ESTAB_APB
  for EMS5.USUAR_FINANC_ESTAB_APB;

prompt
prompt Creating synonym USUAR_INADIMP
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.USUAR_INADIMP
  for EMS5.USUAR_INADIMP;

prompt
prompt Creating synonym USUAR_LIBER
prompt ============================
prompt
create or replace synonym EMS506UNICOO.USUAR_LIBER
  for EMS5.USUAR_LIBER;

prompt
prompt Creating synonym USUAR_LIBER_CCUSTO
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.USUAR_LIBER_CCUSTO
  for EMS5.USUAR_LIBER_CCUSTO;

prompt
prompt Creating synonym USUAR_LIBER_IMPL
prompt =================================
prompt
create or replace synonym EMS506UNICOO.USUAR_LIBER_IMPL
  for EMS5.USUAR_LIBER_IMPL;

prompt
prompt Creating synonym USUAR_LIBER_SEC
prompt ================================
prompt
create or replace synonym EMS506UNICOO.USUAR_LIBER_SEC
  for EMS5.USUAR_LIBER_SEC;

prompt
prompt Creating synonym USUAR_LIBER_SUBST
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.USUAR_LIBER_SUBST
  for EMS5.USUAR_LIBER_SUBST;

prompt
prompt Creating synonym USUAR_LIBER_UNID_NEGOC
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.USUAR_LIBER_UNID_NEGOC
  for EMS5.USUAR_LIBER_UNID_NEGOC;

prompt
prompt Creating synonym USUAR_NIV_USUAR
prompt ================================
prompt
create or replace synonym EMS506UNICOO.USUAR_NIV_USUAR
  for EMS5.USUAR_NIV_USUAR;

prompt
prompt Creating synonym USUAR_UNIV
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.USUAR_UNIV
  for EMS5.USUAR_UNIV;

prompt
prompt Creating synonym USUARIO
prompt ========================
prompt
create or replace synonym EMS506UNICOO.USUARIO
  for PRODUCAO.USUARIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym USUARIO_ATENDIMENTO_LIBERADO
prompt =============================================
prompt
create or replace synonym EMS506UNICOO.USUARIO_ATENDIMENTO_LIBERADO
  for PRODUCAO.USUARIO_ATENDIMENTO_LIBERADO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym USUARIO_CARTA_EMITIDA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.USUARIO_CARTA_EMITIDA
  for PRODUCAO.USUARIO_CARTA_EMITIDA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym USUARIO_DOENCA_TRATAMENTO
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.USUARIO_DOENCA_TRATAMENTO
  for PRODUCAO.USUARIO_DOENCA_TRATAMENTO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym USUARIO_EVENTUAL
prompt =================================
prompt
create or replace synonym EMS506UNICOO.USUARIO_EVENTUAL
  for PRODUCAO.USUARIO_EVENTUAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym USUARIO_EVENTUAL_LOCAL
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.USUARIO_EVENTUAL_LOCAL
  for PRODUCAO.USUARIO_EVENTUAL_LOCAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym USUARIO_FEDERACAO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.USUARIO_FEDERACAO
  for PRODUCAO.USUARIO_FEDERACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym USUARIO_IDENTIFICACAO
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.USUARIO_IDENTIFICACAO
  for PRODUCAO.USUARIO_IDENTIFICACAO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym USUARIO_NAO_PAGA_COPARTIC
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.USUARIO_NAO_PAGA_COPARTIC
  for PRODUCAO.USUARIO_NAO_PAGA_COPARTIC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym USUARIO_PROPOSTA
prompt =================================
prompt
create or replace synonym EMS506UNICOO.USUARIO_PROPOSTA
  for PRODUCAO.USUARIO_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym USUARIO_TRATAMENTO_ESPECIAL
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.USUARIO_TRATAMENTO_ESPECIAL
  for PRODUCAO.USUARIO_TRATAMENTO_ESPECIAL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym USUARIOS_EMISS_CART
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.USUARIOS_EMISS_CART
  for PRODUCAO.USUARIOS_EMISS_CART@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym UTILIZ_CENAR_CTBL
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.UTILIZ_CENAR_CTBL
  for EMS5.UTILIZ_CENAR_CTBL;

prompt
prompt Creating synonym V_CODIGO_DE_HISTORICO_CP
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.V_CODIGO_DE_HISTORICO_CP
  for PRODUCAO.V_CODIGO_DE_HISTORICO_CP@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym V_FORNECEDOR
prompt =============================
prompt
create or replace synonym EMS506UNICOO.V_FORNECEDOR
  for PRODUCAO.V_FORNECEDOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VAL_APROP_CMG_CAMBIAL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VAL_APROP_CMG_CAMBIAL
  for EMS5.VAL_APROP_CMG_CAMBIAL;

prompt
prompt Creating synonym VAL_APROP_CTBL_ACR
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.VAL_APROP_CTBL_ACR
  for EMS5.VAL_APROP_CTBL_ACR;

prompt
prompt Creating synonym VAL_APROP_CTBL_AP
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.VAL_APROP_CTBL_AP
  for EMS5.VAL_APROP_CTBL_AP;

prompt
prompt Creating synonym VAL_APROP_CTBL_APL
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.VAL_APROP_CTBL_APL
  for EMS5.VAL_APROP_CTBL_APL;

prompt
prompt Creating synonym VAL_APROP_CTBL_CMG
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.VAL_APROP_CTBL_CMG
  for EMS5.VAL_APROP_CTBL_CMG;

prompt
prompt Creating synonym VAL_APROP_CTBL_SHC
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.VAL_APROP_CTBL_SHC
  for EMS5.VAL_APROP_CTBL_SHC;

prompt
prompt Creating synonym VAL_FASB_FATUR
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.VAL_FASB_FATUR
  for EMS5.VAL_FASB_FATUR;

prompt
prompt Creating synonym VAL_MERC_OPERAC_FINANC
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.VAL_MERC_OPERAC_FINANC
  for EMS5.VAL_MERC_OPERAC_FINANC;

prompt
prompt Creating synonym VAL_MOVTO_AP
prompt =============================
prompt
create or replace synonym EMS506UNICOO.VAL_MOVTO_AP
  for EMS5.VAL_MOVTO_AP;

prompt
prompt Creating synonym VAL_MOVTO_TIT_ACR
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.VAL_MOVTO_TIT_ACR
  for EMS5.VAL_MOVTO_TIT_ACR;

prompt
prompt Creating synonym VAL_ORIGIN_BEM_PAT
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.VAL_ORIGIN_BEM_PAT
  for EMS5.VAL_ORIGIN_BEM_PAT;

prompt
prompt Creating synonym VAL_TIT_ACR
prompt ============================
prompt
create or replace synonym EMS506UNICOO.VAL_TIT_ACR
  for EMS5.VAL_TIT_ACR;

prompt
prompt Creating synonym VAL_TIT_AP
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.VAL_TIT_AP
  for EMS5.VAL_TIT_AP;

prompt
prompt Creating synonym VALIDTABPRGSSIVIMPTO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VALIDTABPRGSSIVIMPTO
  for EMS5.VALIDTABPRGSSIVIMPTO;

prompt
prompt Creating synonym VALIDVALMINTRANS1099
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VALIDVALMINTRANS1099
  for EMS5.VALIDVALMINTRANS1099;

prompt
prompt Creating synonym VALMOVTOACRCORRECVAL
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VALMOVTOACRCORRECVAL
  for EMS5.VALMOVTOACRCORRECVAL;

prompt
prompt Creating synonym VALMOVTOAPCORRECVAL
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.VALMOVTOAPCORRECVAL
  for EMS5.VALMOVTOAPCORRECVAL;

prompt
prompt Creating synonym VALOR_DA_HORA
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.VALOR_DA_HORA
  for PRODUCAO.VALOR_DA_HORA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$COMPARISON_RESULTS
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.VBZ$COMPARISON_RESULTS
  for PRODUCAO.VBZ$COMPARISON_RESULTS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$COMPARISONS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.VBZ$COMPARISONS
  for PRODUCAO.VBZ$COMPARISONS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$DB_OBJ_NAMES
prompt =================================
prompt
create or replace synonym EMS506UNICOO.VBZ$DB_OBJ_NAMES
  for PRODUCAO.VBZ$DB_OBJ_NAMES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$DESTINATIONS
prompt =================================
prompt
create or replace synonym EMS506UNICOO.VBZ$DESTINATIONS
  for PRODUCAO.VBZ$DESTINATIONS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$DIRECTIVES
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.VBZ$DIRECTIVES
  for PRODUCAO.VBZ$DIRECTIVES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$EDITED_SCRIPTS
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.VBZ$EDITED_SCRIPTS
  for PRODUCAO.VBZ$EDITED_SCRIPTS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$EX_UPDATES
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.VBZ$EX_UPDATES
  for PRODUCAO.VBZ$EX_UPDATES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$EXEMPLARS
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.VBZ$EXEMPLARS
  for PRODUCAO.VBZ$EXEMPLARS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$HISTORY
prompt ============================
prompt
create or replace synonym EMS506UNICOO.VBZ$HISTORY
  for PRODUCAO.VBZ$HISTORY@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$IMPACT_LOG
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.VBZ$IMPACT_LOG
  for PRODUCAO.VBZ$IMPACT_LOG@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$OBJECT_GRANTS
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.VBZ$OBJECT_GRANTS
  for PRODUCAO.VBZ$OBJECT_GRANTS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$OUTPUT_LOG
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.VBZ$OUTPUT_LOG
  for PRODUCAO.VBZ$OUTPUT_LOG@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$ROLE_GRANTS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.VBZ$ROLE_GRANTS
  for PRODUCAO.VBZ$ROLE_GRANTS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$SCHEMAMAPS
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.VBZ$SCHEMAMAPS
  for PRODUCAO.VBZ$SCHEMAMAPS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$SCRIPTS
prompt ============================
prompt
create or replace synonym EMS506UNICOO.VBZ$SCRIPTS
  for PRODUCAO.VBZ$SCRIPTS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$SYS_PRIV_GRANTS
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.VBZ$SYS_PRIV_GRANTS
  for PRODUCAO.VBZ$SYS_PRIV_GRANTS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VBZ$VERSION
prompt ============================
prompt
create or replace synonym EMS506UNICOO.VBZ$VERSION
  for PRODUCAO.VBZ$VERSION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_APPLICATION
prompt ================================
prompt
create or replace synonym EMS506UNICOO.VDK_APPLICATION
  for PRODUCAO.VDK_APPLICATION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_CLUSTER
prompt ============================
prompt
create or replace synonym EMS506UNICOO.VDK_CLUSTER
  for PRODUCAO.VDK_CLUSTER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_CLUSTER_COLUMN
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.VDK_CLUSTER_COLUMN
  for PRODUCAO.VDK_CLUSTER_COLUMN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_COLLECTION_ITEMS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_COLLECTION_ITEMS
  for PRODUCAO.VDK_COLLECTION_ITEMS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_COLUMN
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.VDK_COLUMN
  for PRODUCAO.VDK_COLUMN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_CONSTRAINT
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.VDK_CONSTRAINT
  for PRODUCAO.VDK_CONSTRAINT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_CONSTRAINT_COLUMN
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_CONSTRAINT_COLUMN
  for PRODUCAO.VDK_CONSTRAINT_COLUMN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_DATABASE
prompt =============================
prompt
create or replace synonym EMS506UNICOO.VDK_DATABASE
  for PRODUCAO.VDK_DATABASE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_DATAFILE
prompt =============================
prompt
create or replace synonym EMS506UNICOO.VDK_DATAFILE
  for PRODUCAO.VDK_DATAFILE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_DATAFILE_STATS
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.VDK_DATAFILE_STATS
  for PRODUCAO.VDK_DATAFILE_STATS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_DATAFILE_STATS_BEGIN
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.VDK_DATAFILE_STATS_BEGIN
  for PRODUCAO.VDK_DATAFILE_STATS_BEGIN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_DBUSER
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.VDK_DBUSER
  for PRODUCAO.VDK_DBUSER@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_DELETE_QUEUE
prompt =================================
prompt
create or replace synonym EMS506UNICOO.VDK_DELETE_QUEUE
  for PRODUCAO.VDK_DELETE_QUEUE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_FUNCTION
prompt =============================
prompt
create or replace synonym EMS506UNICOO.VDK_FUNCTION
  for PRODUCAO.VDK_FUNCTION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_HOST_INFO
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.VDK_HOST_INFO
  for PRODUCAO.VDK_HOST_INFO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_IND_PARTITIONS
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.VDK_IND_PARTITIONS
  for PRODUCAO.VDK_IND_PARTITIONS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_IND_SUBPARTITIONS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_IND_SUBPARTITIONS
  for PRODUCAO.VDK_IND_SUBPARTITIONS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_INDEX
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.VDK_INDEX
  for PRODUCAO.VDK_INDEX@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_INDEX_COLUMN
prompt =================================
prompt
create or replace synonym EMS506UNICOO.VDK_INDEX_COLUMN
  for PRODUCAO.VDK_INDEX_COLUMN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_INSTANCE
prompt =============================
prompt
create or replace synonym EMS506UNICOO.VDK_INSTANCE
  for PRODUCAO.VDK_INSTANCE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_INSTANCE_BUFFER_STATS
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.VDK_INSTANCE_BUFFER_STATS
  for PRODUCAO.VDK_INSTANCE_BUFFER_STATS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_INSTANCE_BUFFER_STATS_B
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.VDK_INSTANCE_BUFFER_STATS_B
  for PRODUCAO.VDK_INSTANCE_BUFFER_STATS_B@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_INSTANCE_PARAMS
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.VDK_INSTANCE_PARAMS
  for PRODUCAO.VDK_INSTANCE_PARAMS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_INSTANCE_ROLLBACK_STATS
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.VDK_INSTANCE_ROLLBACK_STATS
  for PRODUCAO.VDK_INSTANCE_ROLLBACK_STATS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_INSTANCE_SORT_STATS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.VDK_INSTANCE_SORT_STATS
  for PRODUCAO.VDK_INSTANCE_SORT_STATS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_INSTANCE_STATS
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.VDK_INSTANCE_STATS
  for PRODUCAO.VDK_INSTANCE_STATS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_INSTANCE_STATS_BEGIN
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.VDK_INSTANCE_STATS_BEGIN
  for PRODUCAO.VDK_INSTANCE_STATS_BEGIN@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_LOG_TABLE
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.VDK_LOG_TABLE
  for PRODUCAO.VDK_LOG_TABLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_OBJECT
prompt ===========================
prompt
create or replace synonym EMS506UNICOO.VDK_OBJECT
  for PRODUCAO.VDK_OBJECT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_PART_INDEXES
prompt =================================
prompt
create or replace synonym EMS506UNICOO.VDK_PART_INDEXES
  for PRODUCAO.VDK_PART_INDEXES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_PART_KEY_COLUMNS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_PART_KEY_COLUMNS
  for PRODUCAO.VDK_PART_KEY_COLUMNS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_PART_TABLES
prompt ================================
prompt
create or replace synonym EMS506UNICOO.VDK_PART_TABLES
  for PRODUCAO.VDK_PART_TABLES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_REP_CONTROL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.VDK_REP_CONTROL
  for PRODUCAO.VDK_REP_CONTROL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_REQUEST
prompt ============================
prompt
create or replace synonym EMS506UNICOO.VDK_REQUEST
  for PRODUCAO.VDK_REQUEST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_SEGMENT
prompt ============================
prompt
create or replace synonym EMS506UNICOO.VDK_SEGMENT
  for PRODUCAO.VDK_SEGMENT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_SEQUENCE
prompt =============================
prompt
create or replace synonym EMS506UNICOO.VDK_SEQUENCE
  for PRODUCAO.VDK_SEQUENCE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_SERVICE
prompt ============================
prompt
create or replace synonym EMS506UNICOO.VDK_SERVICE
  for PRODUCAO.VDK_SERVICE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_SESSION
prompt ============================
prompt
create or replace synonym EMS506UNICOO.VDK_SESSION
  for PRODUCAO.VDK_SESSION@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_SQL
prompt ========================
prompt
create or replace synonym EMS506UNICOO.VDK_SQL
  for PRODUCAO.VDK_SQL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_SQL_OBJECTS
prompt ================================
prompt
create or replace synonym EMS506UNICOO.VDK_SQL_OBJECTS
  for PRODUCAO.VDK_SQL_OBJECTS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_SQL_STATEMENT_WORK
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.VDK_SQL_STATEMENT_WORK
  for PRODUCAO.VDK_SQL_STATEMENT_WORK@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_STORAGE_DEVICE
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.VDK_STORAGE_DEVICE
  for PRODUCAO.VDK_STORAGE_DEVICE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_SUBPART_KEY_COLUMNS
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.VDK_SUBPART_KEY_COLUMNS
  for PRODUCAO.VDK_SUBPART_KEY_COLUMNS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_SYNONYM
prompt ============================
prompt
create or replace synonym EMS506UNICOO.VDK_SYNONYM
  for PRODUCAO.VDK_SYNONYM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TAB_PARTITIONS
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.VDK_TAB_PARTITIONS
  for PRODUCAO.VDK_TAB_PARTITIONS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TAB_SUBPARTITIONS
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TAB_SUBPARTITIONS
  for PRODUCAO.VDK_TAB_SUBPARTITIONS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TABLE
prompt ==========================
prompt
create or replace synonym EMS506UNICOO.VDK_TABLE
  for PRODUCAO.VDK_TABLE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TABLESPACE
prompt ===============================
prompt
create or replace synonym EMS506UNICOO.VDK_TABLESPACE
  for PRODUCAO.VDK_TABLESPACE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_ANALYSIS_1690
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_ANALYSIS_1690
  for PRODUCAO.VDK_TMP_ANALYSIS_1690@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_ANALYSIS_1697
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_ANALYSIS_1697
  for PRODUCAO.VDK_TMP_ANALYSIS_1697@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_ANALYSIS_2001
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_ANALYSIS_2001
  for PRODUCAO.VDK_TMP_ANALYSIS_2001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_ANALYSIS_2002
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_ANALYSIS_2002
  for PRODUCAO.VDK_TMP_ANALYSIS_2002@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_ANALYSIS_2003
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_ANALYSIS_2003
  for PRODUCAO.VDK_TMP_ANALYSIS_2003@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_JOURNAL_1690
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_JOURNAL_1690
  for PRODUCAO.VDK_TMP_JOURNAL_1690@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_JOURNAL_1697
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_JOURNAL_1697
  for PRODUCAO.VDK_TMP_JOURNAL_1697@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_JOURNAL_2001
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_JOURNAL_2001
  for PRODUCAO.VDK_TMP_JOURNAL_2001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_JOURNAL_2002
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_JOURNAL_2002
  for PRODUCAO.VDK_TMP_JOURNAL_2002@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_JOURNAL_2003
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_JOURNAL_2003
  for PRODUCAO.VDK_TMP_JOURNAL_2003@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_RECOMMENDATION_1690
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_RECOMMENDATION_1690
  for PRODUCAO.VDK_TMP_RECOMMENDATION_1690@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_RECOMMENDATION_1697
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_RECOMMENDATION_1697
  for PRODUCAO.VDK_TMP_RECOMMENDATION_1697@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_RECOMMENDATION_2001
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_RECOMMENDATION_2001
  for PRODUCAO.VDK_TMP_RECOMMENDATION_2001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_RECOMMENDATION_2002
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_RECOMMENDATION_2002
  for PRODUCAO.VDK_TMP_RECOMMENDATION_2002@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_RECOMMENDATION_2003
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_RECOMMENDATION_2003
  for PRODUCAO.VDK_TMP_RECOMMENDATION_2003@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_RULE_JOURNAL_1690
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_RULE_JOURNAL_1690
  for PRODUCAO.VDK_TMP_RULE_JOURNAL_1690@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_RULE_JOURNAL_1697
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_RULE_JOURNAL_1697
  for PRODUCAO.VDK_TMP_RULE_JOURNAL_1697@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_RULE_JOURNAL_2001
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_RULE_JOURNAL_2001
  for PRODUCAO.VDK_TMP_RULE_JOURNAL_2001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_RULE_JOURNAL_2002
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_RULE_JOURNAL_2002
  for PRODUCAO.VDK_TMP_RULE_JOURNAL_2002@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_RULE_JOURNAL_2003
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_RULE_JOURNAL_2003
  for PRODUCAO.VDK_TMP_RULE_JOURNAL_2003@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLCOLUMNREF_1690
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLCOLUMNREF_1690
  for PRODUCAO.VDK_TMP_SQLCOLUMNREF_1690@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLCOLUMNREF_1697
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLCOLUMNREF_1697
  for PRODUCAO.VDK_TMP_SQLCOLUMNREF_1697@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLCOLUMNREF_2001
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLCOLUMNREF_2001
  for PRODUCAO.VDK_TMP_SQLCOLUMNREF_2001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLCOLUMNREF_2002
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLCOLUMNREF_2002
  for PRODUCAO.VDK_TMP_SQLCOLUMNREF_2002@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLCOLUMNREF_2003
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLCOLUMNREF_2003
  for PRODUCAO.VDK_TMP_SQLCOLUMNREF_2003@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLDEPEND_1690
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLDEPEND_1690
  for PRODUCAO.VDK_TMP_SQLDEPEND_1690@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLDEPEND_1697
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLDEPEND_1697
  for PRODUCAO.VDK_TMP_SQLDEPEND_1697@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLDEPEND_2001
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLDEPEND_2001
  for PRODUCAO.VDK_TMP_SQLDEPEND_2001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLDEPEND_2002
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLDEPEND_2002
  for PRODUCAO.VDK_TMP_SQLDEPEND_2002@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLDEPEND_2003
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLDEPEND_2003
  for PRODUCAO.VDK_TMP_SQLDEPEND_2003@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLHINTREF_1690
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLHINTREF_1690
  for PRODUCAO.VDK_TMP_SQLHINTREF_1690@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLHINTREF_1697
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLHINTREF_1697
  for PRODUCAO.VDK_TMP_SQLHINTREF_1697@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLHINTREF_2001
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLHINTREF_2001
  for PRODUCAO.VDK_TMP_SQLHINTREF_2001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLHINTREF_2002
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLHINTREF_2002
  for PRODUCAO.VDK_TMP_SQLHINTREF_2002@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLHINTREF_2003
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLHINTREF_2003
  for PRODUCAO.VDK_TMP_SQLHINTREF_2003@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLINDEX_1690
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLINDEX_1690
  for PRODUCAO.VDK_TMP_SQLINDEX_1690@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLINDEX_1697
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLINDEX_1697
  for PRODUCAO.VDK_TMP_SQLINDEX_1697@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLINDEX_2001
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLINDEX_2001
  for PRODUCAO.VDK_TMP_SQLINDEX_2001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLINDEX_2002
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLINDEX_2002
  for PRODUCAO.VDK_TMP_SQLINDEX_2002@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLINDEX_2003
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLINDEX_2003
  for PRODUCAO.VDK_TMP_SQLINDEX_2003@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTABLE_1690
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTABLE_1690
  for PRODUCAO.VDK_TMP_SQLTABLE_1690@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTABLE_1697
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTABLE_1697
  for PRODUCAO.VDK_TMP_SQLTABLE_1697@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTABLE_2001
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTABLE_2001
  for PRODUCAO.VDK_TMP_SQLTABLE_2001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTABLE_2002
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTABLE_2002
  for PRODUCAO.VDK_TMP_SQLTABLE_2002@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTABLE_2003
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTABLE_2003
  for PRODUCAO.VDK_TMP_SQLTABLE_2003@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTABLEREF_1690
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTABLEREF_1690
  for PRODUCAO.VDK_TMP_SQLTABLEREF_1690@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTABLEREF_1697
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTABLEREF_1697
  for PRODUCAO.VDK_TMP_SQLTABLEREF_1697@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTABLEREF_2001
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTABLEREF_2001
  for PRODUCAO.VDK_TMP_SQLTABLEREF_2001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTABLEREF_2002
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTABLEREF_2002
  for PRODUCAO.VDK_TMP_SQLTABLEREF_2002@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTABLEREF_2003
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTABLEREF_2003
  for PRODUCAO.VDK_TMP_SQLTABLEREF_2003@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTEXT_1690
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTEXT_1690
  for PRODUCAO.VDK_TMP_SQLTEXT_1690@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTEXT_1697
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTEXT_1697
  for PRODUCAO.VDK_TMP_SQLTEXT_1697@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTEXT_2001
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTEXT_2001
  for PRODUCAO.VDK_TMP_SQLTEXT_2001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTEXT_2002
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTEXT_2002
  for PRODUCAO.VDK_TMP_SQLTEXT_2002@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLTEXT_2003
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLTEXT_2003
  for PRODUCAO.VDK_TMP_SQLTEXT_2003@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLXREF_1690
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLXREF_1690
  for PRODUCAO.VDK_TMP_SQLXREF_1690@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLXREF_1697
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLXREF_1697
  for PRODUCAO.VDK_TMP_SQLXREF_1697@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLXREF_2001
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLXREF_2001
  for PRODUCAO.VDK_TMP_SQLXREF_2001@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLXREF_2002
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLXREF_2002
  for PRODUCAO.VDK_TMP_SQLXREF_2002@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_TMP_SQLXREF_2003
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VDK_TMP_SQLXREF_2003
  for PRODUCAO.VDK_TMP_SQLXREF_2003@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VDK_USER_RULE
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.VDK_USER_RULE
  for PRODUCAO.VDK_USER_RULE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VEIC_EEC
prompt =========================
prompt
create or replace synonym EMS506UNICOO.VEIC_EEC
  for EMS5.VEIC_EEC;

prompt
prompt Creating synonym VEJA_TAMBEM
prompt ============================
prompt
create or replace synonym EMS506UNICOO.VEJA_TAMBEM
  for EMS5.VEJA_TAMBEM;

prompt
prompt Creating synonym VENCIMENTO_PEDIDO_VENDAS
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.VENCIMENTO_PEDIDO_VENDAS
  for PRODUCAO.VENCIMENTO_PEDIDO_VENDAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VENCTO_CALEND_COMIS
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.VENCTO_CALEND_COMIS
  for EMS5.VENCTO_CALEND_COMIS;

prompt
prompt Creating synonym VENDEDOR
prompt =========================
prompt
create or replace synonym EMS506UNICOO.VENDEDOR
  for PRODUCAO.VENDEDOR@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VERS_ORCTO_CTBL
prompt ================================
prompt
create or replace synonym EMS506UNICOO.VERS_ORCTO_CTBL
  for EMS5.VERS_ORCTO_CTBL;

prompt
prompt Creating synonym VERS_ORCTO_CTBL_BGC
prompt ====================================
prompt
create or replace synonym EMS506UNICOO.VERS_ORCTO_CTBL_BGC
  for EMS5.VERS_ORCTO_CTBL_BGC;

prompt
prompt Creating synonym VERS_ORCTO_VALIDO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.VERS_ORCTO_VALIDO
  for EMS5.VERS_ORCTO_VALIDO;

prompt
prompt Creating synonym VERSORCTOUNIDORCTARIA
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VERSORCTOUNIDORCTARIA
  for EMS5.VERSORCTOUNIDORCTARIA;

prompt
prompt Creating synonym VIGENCIA_ERRADA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.VIGENCIA_ERRADA
  for PRODUCAO.VIGENCIA_ERRADA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VINCULO_CONTA_CONTABIL
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.VINCULO_CONTA_CONTABIL
  for PRODUCAO.VINCULO_CONTA_CONTABIL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VINCULO_EMPREGATICIO
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VINCULO_EMPREGATICIO
  for PRODUCAO.VINCULO_EMPREGATICIO@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VINCULO_PLANO_CONTAS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VINCULO_PLANO_CONTAS
  for PRODUCAO.VINCULO_PLANO_CONTAS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VISITA_PROPOSTA
prompt ================================
prompt
create or replace synonym EMS506UNICOO.VISITA_PROPOSTA
  for PRODUCAO.VISITA_PROPOSTA@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VMQ_DATABASE_PARAMS_DYNAMIC
prompt ============================================
prompt
create or replace synonym EMS506UNICOO.VMQ_DATABASE_PARAMS_DYNAMIC
  for PRODUCAO.VMQ_DATABASE_PARAMS_DYNAMIC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VMQ_DATABASE_PARAMS_STATIC
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.VMQ_DATABASE_PARAMS_STATIC
  for PRODUCAO.VMQ_DATABASE_PARAMS_STATIC@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VMQ_SQL_FAKE_INDEX
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.VMQ_SQL_FAKE_INDEX
  for PRODUCAO.VMQ_SQL_FAKE_INDEX@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VMQ_SQL_FAKE_INDEX_COLUMNS
prompt ===========================================
prompt
create or replace synonym EMS506UNICOO.VMQ_SQL_FAKE_INDEX_COLUMNS
  for PRODUCAO.VMQ_SQL_FAKE_INDEX_COLUMNS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VMQ_SQL_IMPORT_STATS
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.VMQ_SQL_IMPORT_STATS
  for PRODUCAO.VMQ_SQL_IMPORT_STATS@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VMQ_SQL_ITEM
prompt =============================
prompt
create or replace synonym EMS506UNICOO.VMQ_SQL_ITEM
  for PRODUCAO.VMQ_SQL_ITEM@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VMQ_SQL_PLAN_COST_ALL
prompt ======================================
prompt
create or replace synonym EMS506UNICOO.VMQ_SQL_PLAN_COST_ALL
  for PRODUCAO.VMQ_SQL_PLAN_COST_ALL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VMQ_SQL_PLAN_COST_FIRST
prompt ========================================
prompt
create or replace synonym EMS506UNICOO.VMQ_SQL_PLAN_COST_FIRST
  for PRODUCAO.VMQ_SQL_PLAN_COST_FIRST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VMQ_SQL_PLAN_RULE
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.VMQ_SQL_PLAN_RULE
  for PRODUCAO.VMQ_SQL_PLAN_RULE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VMQ_SQL_STATS_COST_ALL
prompt =======================================
prompt
create or replace synonym EMS506UNICOO.VMQ_SQL_STATS_COST_ALL
  for PRODUCAO.VMQ_SQL_STATS_COST_ALL@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VMQ_SQL_STATS_COST_FIRST
prompt =========================================
prompt
create or replace synonym EMS506UNICOO.VMQ_SQL_STATS_COST_FIRST
  for PRODUCAO.VMQ_SQL_STATS_COST_FIRST@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VMQ_SQL_STATS_RULE
prompt ===================================
prompt
create or replace synonym EMS506UNICOO.VMQ_SQL_STATS_RULE
  for PRODUCAO.VMQ_SQL_STATS_RULE@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VMQ_SQL_TEXT
prompt =============================
prompt
create or replace synonym EMS506UNICOO.VMQ_SQL_TEXT
  for PRODUCAO.VMQ_SQL_TEXT@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym VMQ_SQL_UNQUALIFIED_NAMES
prompt ==========================================
prompt
create or replace synonym EMS506UNICOO.VMQ_SQL_UNQUALIFIED_NAMES
  for PRODUCAO.VMQ_SQL_UNQUALIFIED_NAMES@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym WTPROCESSNEGOCCXCART
prompt =====================================
prompt
create or replace synonym EMS506UNICOO.WTPROCESSNEGOCCXCART
  for EMS5.WTPROCESSNEGOCCXCART;

prompt
prompt Creating synonym ZU_ACERTO_PTU
prompt ==============================
prompt
create or replace synonym EMS506UNICOO.ZU_ACERTO_PTU
  for PRODUCAO.ZU_ACERTO_PTU@UNICOO_HOMOLOGA;

prompt
prompt Creating synonym ZU_ACERTO_SERVICO
prompt ==================================
prompt
create or replace synonym EMS506UNICOO.ZU_ACERTO_SERVICO
  for PRODUCAO.ZU_ACERTO_SERVICO@UNICOO_HOMOLOGA;

prompt
prompt Creating view V_CLIENTES_DUPLOS
prompt ===============================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_CLIENTES_DUPLOS AS
SELECT C.CDCLIENTE,
       C.CDGRUPO_CLIENTE GRUPO_UNICOO,
       TG.CDGRUPO_CLIENTE_EMS_PF GRUPO_TOTVS,
       TG.NOGRUPO_CLIENTE,
       P.NOPESSOA
  FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA C, TI_GRUPO_DE_CLIENTE TG, PESSOA P
 WHERE C.NRREGISTRO_CLIENTE = P.NRREGISTRO
   AND TG.CDGRUPO_CLIENTE = C.CDGRUPO_CLIENTE
   AND TG.CDGRUPO_CLIENTE_EMS_PJ <> 'NAOM'
   AND EXISTS
 (SELECT 1
          FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA C1,
               TI_GRUPO_DE_CLIENTE              TG1,
               PESSOA                           P1
         WHERE C1.NRREGISTRO_CLIENTE = P1.NRREGISTRO
           AND TG1.CDGRUPO_CLIENTE = C1.CDGRUPO_CLIENTE
           AND P1.NRREGISTRO = P.NRREGISTRO
           AND TG1.CDGRUPO_CLIENTE_EMS_PF <> TG.CDGRUPO_CLIENTE_EMS_PF
           AND TG1.CDGRUPO_CLIENTE_EMS_PJ <> 'NAOM')
           ORDER BY P.NRREGISTRO;

prompt
prompt Creating view V_CODIGO_DE_HISTORICO_REC
prompt =======================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_CODIGO_DE_HISTORICO_REC AS
SELECT
/*
**********************************************************************************************
*  Objeto  : view V_CODIGO_DE_HISTORICO_REC
**********************************************************************************************
* Sistema      : Pagar,Receber,Caixa e Banco,Recebimento
* Objetivo     : Simular uma tabela com conteudo de conta contabil como historico
* Data Criacao :
**********************************************************************************************
* Alteracoes :
+-------------------------------------------------------------------------------------------------------------------------------------------+
| DATA       | RESPONSAVEL     | VERSAO        | PENDENCIA | ALTERACAO                                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|
| 26/12/2007 | Simone          | CR 4.600.001  | 1625.112  | Adicionada a coluna cdsituacao                                                 |
|-------------------------------------------------------------------------------------------------------------------------------------------|
*/
E.CDEMPRESA,
       H.CDHISTORICO,
       substr(H.NOHISTORICO,1,45) NOHISTORICO,
       H.CDCONTA_CONTABIL,
       h.cdsituacao
FROM   producao.EMPRESA@UNICOO_HOMOLOGA             E,
       producao.CODIGO_DE_HISTORICO@UNICOO_HOMOLOGA H
WHERE  H.CDMODULO = 'CR'
 AND   H.NRPLANO_CONTAS = E.NRPLANO_FINANC
--------------------------------------------------------------------------------------------------------------------------------------------
-- Fim da view v_codigo_de_historico_rec
--------------------------------------------------------------------------------------------------------------------------------------------
;

prompt
prompt Creating view V_COMPARATIVO_TIT_ACR
prompt ===================================
prompt
create or replace force view ems506unicoo.v_comparativo_tit_acr as
select b.nrregistro_titulo,
       b.nrdocumento,
       b.cdcliente,
       b.nrregistro,
       b.cdsituacao,
       b.descsituacao,
       a.sit_ti_controle,
       a.sit_ti_tit_apb,
       sum(b.vltitulo) vltitulo,
       sum(b.vlrecebido) vlrecebido,
       sum(b.vlaberto)   vlaberto,
       sum(a.val_titulo) vltit_integrado,
       sum(a.vloriginal) vloriginal_ap,
       sum(a.val_sdo_tit_ap) val_sdo_tit_ap,
       (sum(b.vlaberto) - sum(a.val_sdo_tit_ap)) diferenca,
       count(*) titulos
  from ti_tit_acr_comparativo   a,
       ti_matriz_receber         b
where a.nrsequencial_origem(+) = b.nrregistro_titulo
group by  b.cdsituacao,
          b.descsituacao,
         a.sit_ti_controle,
         a.sit_ti_tit_apb,
         b.nrregistro,
         b.nrregistro_titulo,
         b.nrdocumento,
         b.cdcliente
order by 1,3;

prompt
prompt Creating view V_COMPARATIVO_TIT_APB
prompt ===================================
prompt
create or replace force view ems506unicoo.v_comparativo_tit_apb as
select b.nrregistro_titulo,
       b.nrdocumento,
       b.cdfornecedor,
       b.cdgrupo_fornecedor,
       b.cdsituacao,
       a.sit_ti_controle,
       a.sit_ti_tit_apb,
       sum(b.vltitulo) vltitulo,
       sum(b.vlpago) vlpago,
       sum(b.vldevido) vldevido,
       sum(a.val_titulo) vltit_integrado,
       sum(a.val_imposto) vlimposto,
       sum(a.vloriginal) vloriginal_ap,
       sum(a.val_sdo_tit_ap) val_sdo_tit_ap,
       (sum(b.vldevido) - sum(a.val_sdo_tit_ap)) diferenca,
       count(*) titulos
  from ti_tit_apb_comparativo a,
       ti_matriz_pagar b
where a.nrsequencial_origem(+) = b.nrregistro_titulo
group by b.cdsituacao,
         a.sit_ti_controle,
         a.sit_ti_tit_apb,
         b.nrregistro_titulo,
         b.nrdocumento,
         b.cdgrupo_fornecedor,
         b.cdfornecedor
order by 1,2;

prompt
prompt Creating view V_CONTA_CCUSTO
prompt ============================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_CONTA_CCUSTO AS
SELECT -- Josias - 01-07-2014 - Ajustes Necessários
       U.COD_PLANO_CTA_CTBL,
       U.COD_ESTAB,
       U.COD_EMPRESA,
       U.COD_CTA_CTBL,
       U.DAT_INIC_VALID,
       U.DAT_FIM_VALID,
       C.COD_CCUSTO,
       U.INDCRITERDISTRIBCCUSTO
FROM   CRITERDISTRIBCTACTBL U,
       ITEM_LISTA_CCUSTO C
WHERE  C.COD_ESTAB = U.COD_ESTAB
AND    C.CODMAPADISTRIBCCUSTO = U.CODMAPADISTRIBCCUSTO
AND    C.COD_EMPRESA          = U.COD_EMPRESA
AND    C.COD_ESTAB            = U.COD_ESTAB
AND    U.INDCRITERDISTRIBCCUSTO = 'Definidos'
UNION
select U.COD_PLANO_CTA_CTBL,
       U.COD_ESTAB,
       U.COD_EMPRESA,
       U.COD_CTA_CTBL,
       U.DAT_INIC_VALID,
       U.DAT_FIM_VALID,
       NULL COD_CCUSTO,
       U.INDCRITERDISTRIBCCUSTO
from criterdistribctactbl U WHERE U.INDCRITERDISTRIBCCUSTO <> 'Definidos'
;

prompt
prompt Creating view V_CONTA_FORNECEDOR_ANALISE
prompt ========================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_CONTA_FORNECEDOR_ANALISE AS
select "CDFORNECEDOR","NRBANCO","NRAGENCIA","NRCONTA_BANCARIA","TPCONTA","AOENVIO_BANCO","AOCONTA_PRESTADOR","CDMODULO_ULTIMA_ALTERACAO"
  from (SELECT distinct t.*
          FROM FORNECEDOR_AGENCIA_BANCARIA         T,
               PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA F,
               TI_PESSOA                           P,
               FORNEC_FINANC                       FF
         WHERE T.CDFORNECEDOR = F.CDFORNECEDOR
           AND F.NRREGISTRO_FORNECEDOR = P.NRREGISTRO
           AND FF.U##COD_EMPRESA = '1'
           AND P.CDN_FORNECEDOR = FF.CDN_FORNECEDOR
           AND P.CDN_FORNECEDOR IS NOT NULL
        --AND T.TPCONTA = 'CC'
        )
minus
select "CDFORNECEDOR","NRBANCO","NRAGENCIA","NRCONTA_BANCARIA","TPCONTA","AOENVIO_BANCO","AOCONTA_PRESTADOR","CDMODULO_ULTIMA_ALTERACAO"
  from FORNECEDOR_AGENCIA_BANCARIA f
 where not exists (select 1
          from producao.fornecedor@unicoo_homologa ff,
               ti_grupo_de_fornecedor              fg
         where FG.CDGRUPO_FORNECEDOR = ff.cdgrupo_fornecedor
           and fg.cod_grp_fornecedor = 'NAOM'
           and f.cdfornecedor = ff.cdfornecedor)
;

prompt
prompt Creating view V_ERROS_TIT_ACR
prompt =============================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_ERROS_TIT_ACR AS
SELECT txfalha, txajuda, COUNT(*) qtde FROM ti_falha_de_processo tf
WHERE EXISTS (SELECT 1 FROM ti_tit_acr tr
WHERE tf.nrseq_controle_integracao = tr.nrseq_controle_integracao)
GROUP BY txfalha, txajuda
ORDER BY 3 DESC;

prompt
prompt Creating view V_ERROS_TIT_APB
prompt =============================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_ERROS_TIT_APB AS
SELECT TXFALHA, TXAJUDA, COUNT(*) QTDE_ERROS
  FROM TI_FALHA_DE_PROCESSO TF, TI_TIT_APB TP
 WHERE TF.NRSEQ_CONTROLE_INTEGRACAO = TP.NRSEQ_CONTROLE_INTEGRACAO
 AND TF.TXFALHA NOT LIKE 'Rateio contábil não permitido em uma conta de Saldo !'
 AND TF.TXFALHA NOT LIKE 'Imposto%ao foi vinculado ao fornecedor%'
 GROUP BY TF.TXFALHA, TXAJUDA
 ORDER BY 3 DESC;

prompt
prompt Creating view V_FALHAS_TIT_ACR
prompt ==============================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_FALHAS_TIT_ACR AS
SELECT TXFALHA, TXAJUDA, COUNT(*) qtde_erros
  FROM TI_FALHA_DE_PROCESSO TF
 WHERE EXISTS
 (SELECT 1
          FROM ti_tit_acr F
         WHERE F.NRSEQ_CONTROLE_INTEGRACAO = TF.NRSEQ_CONTROLE_INTEGRACAO)
   AND TXFALHA NOT LIKE '%liente Financeiro %'
   and txfalha not like 'Título já existente no Contas a Receber !%'
 GROUP BY TXFALHA, TXAJUDA
 ORDER BY 3 DESC;

prompt
prompt Creating view V_FORNECEDORES_DUPLOS
prompt ===================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_FORNECEDORES_DUPLOS AS
SELECT F.CDFORNECEDOR, F.CDGRUPO_FORNECEDOR GRUPO_UNICOO, T.COD_GRP_FORNECEDOR GRUPO_TOTVS, PE.NOPESSOA
  FROM TI_GRUPO_DE_FORNECEDOR T, PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA F, PESSOA PE
 WHERE F.CDGRUPO_FORNECEDOR = T.CDGRUPO_FORNECEDOR
 AND T.COD_GRP_FORNECEDOR <> 'NAOM'
 AND PE.NRREGISTRO = F.NRREGISTRO_FORNECEDOR
   AND EXISTS
 (SELECT 1
          FROM TI_GRUPO_DE_FORNECEDOR              T2,
               PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA F2
         WHERE F2.CDGRUPO_FORNECEDOR = T2.CDGRUPO_FORNECEDOR
           AND F2.NRREGISTRO_FORNECEDOR = F.NRREGISTRO_FORNECEDOR
           AND T2.COD_GRP_FORNECEDOR <> T.COD_GRP_FORNECEDOR
           AND T2.COD_GRP_FORNECEDOR <> 'NAOM')
         ORDER BY PE.NRREGISTRO;

prompt
prompt Creating view V_PESSOA_JURIDICA
prompt ===============================
prompt
create or replace force view ems506unicoo.v_pessoa_juridica as
select "NUM_PESSOA_JURID"
  from (select num_pessoa_jurid
          from ESTABELECIMENTO t
        union
        select num_pessoa
          from REPRESENTANTE t) a;

prompt
prompt Creating function F_TI_PARAMETRO_INTEGRACAO
prompt ===========================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_PARAMETRO_INTEGRACAO" (PCDPARAMETRO IN VARCHAR2) return varchar2 is
  Result VARCHAR2(99);
begin
/*
 josias - 01-07-2014 - atualizações necessárias
*/

   -- Funcao F_PARAMETRO
   -- Retorna  O VALOR DO PARAMETRO
   -- Respons?vel : ISRAEL ZATTA 07/07/2000

begin
   select vlparametro into result
   from   ti_parametro_integracao
   where  cdparametro = pcdparametro;
exception
   when no_data_found then
      raise_application_error(-20001,'Parametro '''||PCDPARAMETRO||''' nao encontrato');
   when Others then
      raise_application_error(-20001,'Erro pesquisando Parametro '''||PCDPARAMETRO||''||sqlerrm);
END;

  return(Result);
end ;
/

prompt
prompt Creating view V_TI_CLIENTE
prompt ==========================
prompt
create or replace force view ems506unicoo.v_ti_cliente as
select
        /*
        ***************************************************************************************************************
        Criação          : -
        Data             : -
        Módulo Principal : Integração EMS5
        Módulos          : -
        Telas            : CR05FC7
        Objetivo         : Enviar os clientes Unicoo para o EMS5

        Alteracoes
        +------------------------------------------------------------------------------------------------------------------------------------------+
        | DATA       | RESPONSAVEL   | VERSAO        | PENDÊNCIA | ALTERACAO                                                                       |
        |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
        | 20/10/2009 | ALECSANDRO    |               |           | Adicionado o numero do imovel no endereco                                       |
        |            |               |               |           | Quando o CPF/CNPJ for null colocar espaço em branco
        |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
        | 27/10/2009 | ALECSANDRO    |               |           | Quando o CNPJ e/ou CPF FOR nulo o sistema passou a utilizar os parametros       |
        |            |               |               |           | COD_ID_FEDER_PESSOA_JURIDICA e COD_ID_FEDER_PESSOA_FISICA
        |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
        | 01/07/2014 | JOSIAS        |               |           | Ajustes necessários                                                             |
        |------------|---------------|---------------|---------------------------------------------------------------------------------------------|

        */
       decode(tip.cdn_cliente,null,'I','A') cod_acao,
       f_TI_parametro_integracao('COD_EMPRESA')  cod_empresa,
       nvl(tip.cdn_cliente,0) cod_cliente,
--       substr(p.nopessoa,1,40) nom_cliente,
       p.nopessoa nom_cliente,
       --cl.nom_abrev nom_abrev,
       TIP.NOABREVIADO_CLIENTE nom_abrev,
       p.tppessoa ind_tipo_pessoa,
       case
           when replace(replace(p.nrcgc_cpf,'-',null),'.',null) is not null then
                replace(replace(p.nrcgc_cpf,'-',null),'.',null)
           when p.tppessoa = 'F' then
                f_ti_parametro_integracao('COD_ID_FEDER_PESSOA_FISICA')
           else
                f_ti_parametro_integracao('COD_ID_FEDER_PESSOA_JURIDICA')
       end  cod_id_feder_jurid,

       case when p.tppessoa = 'J' THEN
         NVL(P.NRINSCEST_RG, 'ISENTO') ELSE nvl(TRIM(NRINSCEST_RG),' ') END cod_id_feder_estad_jurid,
         --f_ti_parametro_integracao('COD_ID_FEDER')  cod_id_feder_estad_jurid,
       ' ' cod_id_munic_jurid,
       ' ' cod_id_previd_social,
       'S' log_fins_lucrat,
       ' ' cod_id_feder_matriz,
       case
           when replace(replace(p.nrcgc_cpf,'-',null),'.',null) is not null then
                replace(replace(p.nrcgc_cpf,'-',null),'.',null)
           when p.tppessoa = 'F' then
                f_ti_parametro_integracao('COD_ID_FEDER_PESSOA_FISICA')
           else
                f_ti_parametro_integracao('COD_ID_FEDER_PESSOA_JURIDICA')
       end cod_id_feder,

       case when p.tppessoa = 'F' THEN
         NVL(P.NRINSCEST_RG, 'ISENTO') ELSE nvl(TRIM(NRINSCEST_RG),' ') END cod_id_estad_fisic,
       nvl(p.noorgao_emissor_rg, ' ') cod_org_emis_id_estad,
       nvl(p.cdestado_emissor_rg,' ') cod_id_feder_emis_estad,
       decode(p.tppessoa,'F',p.dtnascimento,null) dat_nascimento,
       nvl(substr(PAIS.NOPAIS_EMISSOR_ID,1,3),f_ti_parametro_integracao('COD_PAIS')) cod_pais_nasc,
       nvl(cn.cdestado,f_ti_parametro_integracao('COD_ID_FEDER'))  cod_id_feder_nasc,
       decode(p.tppessoa,'F',NVL(SUBSTR(p.nomae,1,40), ' '),' ') nom_mae,
       NVL(PAIS.NONACIONALIDADE,f_TI_parametro_integracao('NOM_NACIONALIDADE')) nom_nacionalidade,
       ' ' nom_profissao,
       nvl(p.cdestadocivil,' ') ind_estado_civil,
--       NVL(ed.nologradouro||decode(ed.nrimovel,null,null,' '||ed.nrimovel),'NAO INFORMADO') nom_endereco,
       NVL(ed.nologradouro,'NAO INFORMADO') nom_endereco,
       --Comentei o nom_endereco para trazer somente o logradouro e criei a linha abaixo para trazer o numero do imovel
       ed.nrimovel nrimovel,
       ed.txcomplemento nom_ender_compl,
       NVL(ed.nobairro,'NAO INFORMADO') nom_bairro,
       nvl(trim(cd.nocidade),f_ti_parametro_integracao('NOCIDADE_DEFAULT_INCLUSAO'))  nom_cidade,
       nvl(trim(cd.cdestado),f_ti_parametro_integracao('COD_ID_FEDER')) cod_unid_feder,
       nvl(trim(decode(ed.nrcep,'00000000',' ', ed.nrcep)),f_ti_parametro_integracao('NRCEP_DEFAULT_INCLUSAO')) cod_cep,
       ' ' cod_cx_post,
       substr(nvl(
           case
               when ed.nrddd is null and ed.nrtelefone is null then null
               when ed.nrtelefone is null                          then null
               when ed.nrddd      is null                          then ed.nrtelefone
           else
               replace(ed.nrddd,0,'')||' '||ed.nrtelefone
           end,' '),1,20) cod_telefone_1,
      substr(nvl(
         case
             when ed.nrddd is null and ed.nrcelular is null then null
             when ed.nrcelular is null                          then null
             when ed.nrddd      is null                          then ed.nrcelular
         else
             replace(ed.nrddd,0,'')||' '||ed.nrcelular
         end, ' '),1,20)cod_telefone_2,
      ' ' cod_telefone_3,
      substr(nvl(case
             when ed.nrddd is null and ed.nrfax is null then null
             when ed.nrfax is null                          then null
             when ed.nrddd      is null                          then ed.nrfax
         else
             replace(ed.nrddd,0,'')||' '||ed.nrfax
         end,' '),1,20) cod_fax,
      ' ' cod_ramal_fax,
     SUBSTR(NVL(ED.CDEMAIL,' '),0,40) cod_e_mail,
      ' ' nom_home_page,
      --Vinicius 31/10/2016 Inclusão dos campos de endereço de cobrança
      NVL(edcobr.nologradouro,'NAO INFORMADO') nom_endereco_cobr,
      edcobr.txcomplemento nom_ender_compl_cobr,
      NVL(edcobr.nobairro,'NAO INFORMADO') nom_bairro_cobr,
      nvl(trim(cdcobr.nocidade),f_ti_parametro_integracao('NOCIDADE_DEFAULT_INCLUSAO')) nom_cidade_cobr,
      nvl(trim(cdcobr.cdestado),f_ti_parametro_integracao('COD_ID_FEDER')) cod_unid_feder_cobr,
      nvl(trim(decode(edcobr.nrcep,'00000000',' ', edcobr.nrcep)),f_ti_parametro_integracao('NRCEP_DEFAULT_INCLUSAO')) cod_cep_cobr,
      edcobr.nrimovel nrimovel_cobr,
      ' ' cod_cx_post_cobr,
      ---------
             'END CORRESP ORIGINAL: ' || CHR(13) ||
             TRIM(ed.NOLOGRADOURO) || DECODE(ed.NRIMOVEL,NULL,'',', ') ||
                                             DECODE(ed.NRIMOVEL,NULL,'',ed.NRIMOVEL) ||
                                             DECODE(ed.TXCOMPLEMENTO,NULL,'',' - ') ||
                                             DECODE(ed.TXCOMPLEMENTO,NULL,'',TRIM(ed.TXCOMPLEMENTO)) ||
                                             DECODE(ed.NOBAIRRO,NULL,'',' - ') || ed.NOBAIRRO ||
             DECODE(ed.CDEMAIL,NULL,'',
                                                CHR(10) || CHR(13) ||
                                                'E-MAIL CORRESP:' || CHR(13) ||
                                                ed.CDEMAIL ) ||

             DECODE(ed.CDEMAIL_ADICIONAL,NULL,'',
                                                CHR(10) || CHR(13) ||
                                                'E-MAIL ADIC CORRESP:' || CHR(13) ||
                                                ed.CDEMAIL_ADICIONAL ) ||
             DECODE(EDCOBR.NOLOGRADOURO,NULL,'',
                                                CHR(10) || CHR(13) ||
                                                'END COBR ORIGINAL:' || CHR(13) ||
                                                 TRIM(edcobr.NOLOGRADOURO) || DECODE(edcobr.NRIMOVEL,NULL,'',', ') ||
                                                 DECODE(edcobr.NRIMOVEL,NULL,'',edcobr.NRIMOVEL) ||
                                                 DECODE(edcobr.TXCOMPLEMENTO,NULL,'',' - ') ||
                                                 DECODE(edcobr.TXCOMPLEMENTO,NULL,'',TRIM(edcobr.TXCOMPLEMENTO)) ||
                                                 DECODE(edcobr.NOBAIRRO,NULL,'',' - ') || edcobr.NOBAIRRO) ||
             DECODE(edcobr.CDEMAIL,NULL,'',
                                                CHR(10) || CHR(13) ||
                                                'E-MAIL COBR:' || CHR(13) ||
                                                edcobr.CDEMAIL ) ||

             DECODE(edcobr.CDEMAIL_ADICIONAL,NULL,'',
                                                CHR(10) || CHR(13) ||
                                                'E-MAIL ADIC COBR:' || CHR(13) ||
                                                edcobr.CDEMAIL_ADICIONAL )
      dest_anot_tabela,
      (select decode(p.tppessoa,'F',gce.cdgrupo_cliente_ems_pf,gce.cdgrupo_cliente_ems_pj)
         from ti_grupo_de_cliente gce
        where gce.cdgrupo_cliente = nvl(g.cdgrupo_cliente,'99')) cod_grp_clien,
      '999' cod_tip_clien, -- Rever Fazer de-para
      f_ti_parametro_integracao('DAT_IMPL_CLIEN') dat_impl_clien,
      decode(p.tppessoa,'F',f_ti_parametro_integracao('COD_PORTAD_PREFER_PESSOA_FISICA'),f_ti_parametro_integracao('COD_PORTAD_PREFER_PESSOA_JURIDICA')) cod_portad_prefer,
      f_ti_parametro_integracao('COD_CART_BCIA_PREFER')  cod_cart_bcia_prefer,
      NVL(cl.nrconta_corrente, ' ')                   cod_cta_corren_bco,
      ' '                                 cod_digito_cta_corren,
      NVL(cl.nragencia, ' ')                          cod_agenc_bcia,
      ' '                                 cod_digito_agenc_bcia,
      --nvl(decode(to_number(decode(cl.nrbanco,null,'0',lpad(cl.nrbanco,3,'0'))),0,' '),'341') cod_banco,
--      nvl(decode(cl.nrbanco,null,' ',cl.nrbanco),'341') cod_banco,
      nvl(TRIM(TO_CHAR(CL.NRBANCO)),' ') COD_BANCO,
--      f_TI_parametro_integracao('COD_TIP_FLUXO_FINANC_PREFER_CLIENTE')  cod_tip_fluxo_financ, -- Revisar
      decode(p.tppessoa,'F',f_ti_parametro_integracao('COD_TIP_FLUXO_FINANC_PREFER_CLIENTE_F'),
                            f_ti_parametro_integracao('COD_TIP_FLUXO_FINANC_PREFER_CLIENTE_J')) cod_tip_fluxo_financ,
      'S' log_calc_multa,
      0 num_dias_atraso_avdeb,
      '0' ind_ocorrencia,
      trunc(sysdate) dat_processamento,
      'RC' cdsituacao,
      ci.nrsequencial nrseq_controle_integracao,
      null nrseq_favorecido,
      cl.nrregistro_cliente nrpessoa
 from ti_controle_integracao  ci,
      producao.cliente@UNICOO_HOMOLOGA cl,
      grupo_de_cliente g,
      pessoa p,
      estado_civil ec,
      endereco ed,
      endereco edcobr,
      producao.cidade@UNICOO_HOMOLOGA cd,
      producao.cidade@UNICOO_HOMOLOGA cdcobr,
      ti_pessoa tip,
      PAIS_EMISSOR_CART_IDENTIDADE@UNICOO_HOMOLOGA PAIS,
      producao.cidade@UNICOO_HOMOLOGA CN
where
/* ed.nrregistro                    = f_ti_retorna_registro(cl.nrregistro_cliente)
  and ed.tpendereco                    = f_ti_tip_endereco(f_ti_retorna_registro(cl.nrregistro_cliente))
 */
  --Vinicius 31/10/2016
      ed.nrregistro(+)                 = cl.nrregistro_cliente
  and ed.aocorrespondencia(+)          = 'S'
  and edcobr.nrregistro(+)             = cl.nrregistro_cliente
  and edcobr.tpendereco(+)             = 'COBR'
  and cdcobr.cdcidade(+)               = edcobr.cdcidade
  ---
  and cd.cdcidade(+)                   = ed.cdcidade
  and cl.nrregistro_cliente            = p.nrregistro
  and cl.cdgrupo_cliente               = g.cdgrupo_cliente(+)
  and p.cdestadocivil                  = ec.cdestadocivil(+)
  and p.nrregistro                     = ci.nrsequencial_origem
  and ci.cdidentificador               = cl.cdcliente
  and p.nrregistro(+)                  = tip.nrregistro
  and ci.tpintegracao                  ='CL'
  and pais.CDPAIS_EMISSOR_ID(+)        = P.CDPAIS_EMISSOR_ID
  and cn.cdcidade(+)                   = p.cdcidade_naturalidade
--  and ci.nrsequencial=1363871
;

prompt
prompt Creating view V_TI_CONTROLE_INTEGRACAO
prompt ======================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TI_CONTROLE_INTEGRACAO AS
SELECT -- Josias - 01-07-2014 - Ajustes Necessários
       (SELECT '[' || CDVALOR || '] ' || UPPER(T.CDPROCESSO)
          FROM TI_TIPO_PROCESSO_INTEGRACAO T
         WHERE T.CDVALOR = I.TPINTEGRACAO) TIPO,
       I.DTGERACAO,
       I.DTPROCESSAMENTO,
       I.DTINTEGRACAO,
       DECODE(I.CDACAO,
              'A',
              '[A] ALTERAÇÃO',
              'E',
              '[E] EXCLUSÃO',
              'I',
              '[I] INCLUSÃO',
              'R',
              '[R] REPROCESSO',
              'INEXISTENTE') AS "AÇÃO",
       I.CDIDENTIFICADOR,
       DECODE(I.CDSITUACAO,
              'IT',
              '[IT] INTEGRADO',
              'ER',
              '[ER] ERRO',
              'CA',
              '[CA] CANCELADO',
              'RE',
              '[RE] REPROCESSAR',
              'RC',
              '[RC] RECEBIDO',
              'PE',
              '[PE] PENDENTE',
              'GE',
              '[GE] GERADO',
              I.CDSITUACAO)   "SITUAÇÃO",
       I.CDEMPRESA            EMPRESA,
       I.CDDIVISAO            "DIVISÃO",
       I.CDCENTRO_CUSTO       "CENTRO DE CUSTO",
       I.CDMOVIMENTO          MOVIMENTO,
       -------
       NRSEQUENCIAL,
       TPINTEGRACAO,
       NRSEQUENCIAL_ORIGEM,
       CDACAO,
       TXOBSERVACAO,
       CDSITUACAO,
       NRSEQ_CONTROLE_INTEGRACAO_ORG,
       CDMODULO,
       NRSESSAO

  FROM TI_CONTROLE_INTEGRACAO I
 ORDER BY NRSEQUENCIAL DESC
;

prompt
prompt Creating view V_TI_CONTROLE_INTEGRACAO_DP
prompt =========================================
prompt
create or replace force view ems506unicoo.v_ti_controle_integracao_dp as
select ci.tpintegracao,ci.cdsituacao,count(*) qtt
from ti_controle_integracao ci
group by ci.tpintegracao,ci.cdsituacao
order by ci.tpintegracao,ci.cdsituacao;

prompt
prompt Creating view V_TI_CONTROLE_INTEGRACAO_HOJE
prompt ===========================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TI_CONTROLE_INTEGRACAO_HOJE AS
SELECT -- Josias - 01-07-2014 - Ajustes Necessários
       TPINTEGRACAO,
       CASE
          WHEN CI.TPINTEGRACAO='CL' then 'Cliente'
          when ci.tpintegracao='FN' THEN 'Fornecedor'
          When ci.tpintegracao='TR' Then 'Titulo a Receber'
          when ci.tpintegracao='TP' then 'Titulo a Pagar'
          When ci.tpintegracao='CT' THEN 'Contabilidade'
          When ci.tpintegracao='FT' then 'Faturamento'
          When ci.tpintegracao='CX' then 'Caixa e Bancos'
       else
          'Desconhecido'
       end nointegracao,
       CDSITUACAO,
       case
           when ci.cdsituacao='ER' Then 'Erro ao enviar p/ integrac?o'
           when ci.cdsituacao='PE' Then 'Erro ao enviar p/ EMS5'
           when ci.cdsituacao='IT' THEN 'Integrado'
           When ci.cdsituacao='GE' Then 'Gerado - Status Inicial'
           When ci.cdsituacao='VD' then 'Em Validac?o'
           When ci.cdsituacao='RE' THEN 'Reprocessado'
           When ci.cdsituacao='RC' THEN 'Pronto p/ enviar p/ EMS5'
       else
           cdsituacao
       end nosituacao,
       MAX(DTPROCESSAMENTO) DTPROCESSAMENTO,COUNT(*) QTREGISTROS
FROM TI_CONTROLE_INTEGRACAO CI
WHERE
       TRUNC(DTPROCESSAMENTO)=TRUNC(SYSDATE)
GROUP BY
TPINTEGRACAO,CDSITUACAO
;

prompt
prompt Creating view V_TI_CX_BX78
prompt ==========================
prompt
create or replace force view ems506unicoo.v_ti_cx_bx78 as
select distinct
       xx.nrsequencial nrseq_controle_integracao,
       'RC' cdsituacao,
       ' ' cod_cart_bcia,
       p.cdn_cliente cod_cliente,
       e.cod_empresa cod_empresa,
       aa.cod_espec_docto cod_espec_docto,
       aa.cod_estab cod_estab,
       aa.cod_parcela cod_parcela,
       f_ti_parametro_integracao('PORTADO_BX_CREDITO') cod_portador,
       aa.cod_tit_acr_bco cod_tit_acr_bco,
       aa.cod_titulo_acr cod_titulo_acr,
       aa.cod_ser_docto cod_ser_docto,
       ht.dtmovimento dat_baixa,
       sysdate dat_envio,
       sysdate dat_processamento,
       'BX78 via Integração : '||ht.nrmovimento des_text_histor,
       nvl(ht.vldesconto,0) val_desconto,
       nvl(ht.vlabatimento,0)+nvl(ht.vlabatimento_2,0) val_abatimento,
       nvl(ht.vl_ir_fonte_fat,0) val_ir,
       nvl(ht.vljuros,0) val_juros,
       nvl(ht.vlmulta,0) val_multa,
       nvl(ht.vlrecebido,0) val_liq_titulo,
       nvl(ht.vltitulo,0) val_titulo,
       c.nrregistro_cliente nrpessoa,
       ht.nrregistro_titulo nrregistro_titulo,
       ht.nrmovimento_caixa nrmovimento_baixa,
       tr.nrdocumento nrdocumento,
       tr.nrnossonumero nrnossonumero,
       ht.txhistorico txhistorico,
       ' ' nrbanco,
       ' ' nragencia,
       ' ' nrconta_corrente
  from historico_do_titulo         ht,
       titulo_a_receber            tr,
       producao.cliente@UNICOO_HOMOLOGA                     c,
       ti_pessoa                   p,
       ti_empresa                  e,
       (select acr.cod_ser_docto,
                 acr.cod_titulo_acr,
                 acr.cod_espec_docto,
                 acr.cod_cliente,
                 acr.cod_estab,
                 acr.cod_parcela,
                 cix.nrsequencial_origem,
                 acr.cod_tit_acr_bco
            from ti_tit_acr             acr,
                 ti_controle_integracao cix
          where acr.nrseq_controle_integracao=cix.nrsequencial
            and acr.cdsituacao='IT'
            AND ACR.NRSEQ_CONTROLE_INTEGRACAO=CIX.NRSEQUENCIAL
            ) aa,
       ti_controle_integracao      xx
 where ht.nrregistro_titulo = tr.nrregistro_titulo
   and tr.cdcliente = c.cdcliente
   and ht.nrmovimento = xx.nrsequencial_origem
   and c.nrregistro_cliente = p.nrregistro
   and tr.cdempresa = e.cdempresa
   and aa.nrsequencial_origem=tr.nrregistro_titulo
   AND XX.TPINTEGRACAO='BC';

prompt
prompt Creating view V_TI_CX_BX_ACR
prompt ============================
prompt
create or replace force view ems506unicoo.v_ti_cx_bx_acr as
select distinct
       xx.nrsequencial nrseq_controle_integracao,
       'RC' cdsituacao,
       ' ' cod_cart_bcia,
       p.cdn_cliente cod_cliente,
       e.cod_empresa cod_empresa,
       aa.cod_espec_docto cod_espec_docto,
       aa.cod_estab cod_estab,
       aa.cod_parcela cod_parcela,
       tc.cod_portador cod_portador,
       aa.cod_tit_acr_bco cod_tit_acr_bco,
       aa.cod_titulo_acr cod_titulo_acr,
       aa.cod_ser_docto cod_ser_docto,
       ht.dtmovimento dat_baixa,
       sysdate dat_envio,
       sysdate dat_processamento,
       'BX via Integração : '||ht.nrmovimento des_text_histor,
       nvl(ht.vldesconto,0) val_desconto,
       nvl(ht.vlabatimento,0)+nvl(ht.vlabatimento_2,0) val_abatimento,
       nvl(ht.vl_ir_fonte_fat,0) val_ir,
       nvl(ht.vljuros,0) val_juros,
       nvl(ht.vlmulta,0) val_multa,
       nvl(ht.vlrecebido,0) val_liq_titulo,
       nvl(ht.vltitulo,0) val_titulo,
       c.nrregistro_cliente nrpessoa,
       ht.nrregistro_titulo nrregistro_titulo,
       ht.nrmovimento_caixa nrmovimento_baixa,
       tr.nrdocumento nrdocumento,
       tr.nrnossonumero nrnossonumero,
       ht.txhistorico txhistorico,
       ht.nrbanco nrbanco,
       ht.nragencia nragencia,
       ht.nrconta_corrente nrconta_corrente
  from historico_do_titulo         ht,
       titulo_a_receber            tr,
       producao.cliente@UNICOO_HOMOLOGA                     c,
       ti_tipo_movimento_cmg_caixa tc,
       ti_pessoa                   p,
       ti_empresa                  e,
       (select acr.cod_ser_docto,
                 acr.cod_titulo_acr,
                 acr.cod_espec_docto,
                 acr.cod_cliente,
                 acr.cod_estab,
                 acr.cod_parcela,
                 cix.nrsequencial_origem,
                 acr.cod_tit_acr_bco
            from ti_tit_acr             acr,
                 ti_controle_integracao cix
          where acr.nrseq_controle_integracao=cix.nrsequencial
            and acr.cdsituacao='IT'
            AND ACR.NRSEQ_CONTROLE_INTEGRACAO=CIX.NRSEQUENCIAL
            ) aa,
       ti_controle_integracao      xx
 where ht.nrregistro_titulo = tr.nrregistro_titulo
   and tr.cdcliente = c.cdcliente
   and ht.nrmovimento = xx.nrsequencial_origem
   and ht.nrconta_corrente = tc.nrconta_corrente
   and c.nrregistro_cliente = p.nrregistro
   and tr.cdempresa = e.cdempresa
   and aa.nrsequencial_origem=tr.nrregistro_titulo
   AND XX.TPINTEGRACAO='BR';

prompt
prompt Creating view V_TI_CX_BX_APB
prompt ============================
prompt
create or replace force view ems506unicoo.v_ti_cx_bx_apb as
select distinct
       xx.nrsequencial nrseq_controle_integracao,
       'RC' cdsituacao,
       ' ' cod_cart_bcia,
       p.cdn_fornecedor cod_fornecedor,
       e.cod_empresa cod_empresa,
       ' ' cod_espec_docto,
       e.cod_estab cod_estab,
       nvl(substr(tp.nrdocumento,11,2),'01') cod_parcela,
       tc.cod_portador cod_portador,
       nvl(tp.nrnossonumero,' ')   cod_tit_apb_bco,
       substr(tp.nrdocumento,1,10) cod_titulo_apb,
       ' ' cod_ser_docto,
       htp.dtmovimento dat_baixa,
       sysdate dat_envio,
       sysdate dat_processamento,
       'BX via Integração' des_text_histor,
       nvl(htp.vldesconto,0) val_desconto,
       nvl(htp.vlabatimento,0)+nvl(htp.vlabatimento_2,0) val_abatimento,
       0 val_ir,
       nvl(htp.vljuros,0) val_juros,
       nvl(htp.vlmulta,0) val_multa,
       nvl(htp.vlpago,0) val_liq_titulo,
       nvl(htp.vltitulo,0) val_titulo,
       f.nrregistro_fornecedor nrpessoa,
       htp.nrregistro_titulo nrregistro_titulo,
       htp.nrmovimento_caixa nrmovimento_baixa,
       tp.nrdocumento nrdocumento,
       nvl(tp.nrnossonumero,' ') nrnossonumero,
       htp.txhistorico txhistorico,
       htp.nrbanco nrbanco,
       htp.nragencia nragencia,
       htp.nrconta_bancaria nrconta_corrente
  from historico_do_titulo_pagar         htp,
       titulo_a_pagar            tp,
       producao.fornecedor@UNICOO_HOMOLOGA                     f,
       ti_tipo_movimento_cmg_caixa tc,
       ti_pessoa                   p,
       ti_empresa                  e,
       ti_controle_integracao      xx
 where htp.nrregistro_titulo = tp.nrregistro_titulo
   and tp.cdfornecedor = f.cdfornecedor
   and htp.nrmovimento = xx.nrsequencial_origem
   and htp.nrconta_bancaria = tc.nrconta_corrente
   and f.nrregistro_fornecedor = p.nrregistro
   and tp.cdempresa = e.cdempresa;

prompt
prompt Creating view V_TI_FORNECEDOR_UNICOO
prompt ====================================
prompt
create or replace force view ems506unicoo.v_ti_fornecedor_unicoo as
select  distinct
        vi.cdfornecedor,
        vi.nrregistro_fornecedor,
        fo.cdfornecedor cdfornecedor_filho
  from producao.fornecedor@UNICOO_HOMOLOGA fo,
       titulo_a_pagar tap,
       (select fo.cdfornecedor,
               fo.nrregistro_fornecedor
          from producao.fornecedor@UNICOO_HOMOLOGA fo,
               titulo_a_pagar tp,
               (select max(tp.dttitulo) dttitulo,
                       f.nrregistro_fornecedor
                  from titulo_a_Pagar tp,
                       producao.fornecedor@UNICOO_HOMOLOGA f
                 where f.cdfornecedor = tp.cdfornecedor
              group by f.nrregistro_fornecedor) x
         where fo.cdfornecedor          = tp.cdfornecedor
           and fo.nrregistro_fornecedor = x.nrregistro_fornecedor
           and tp.dttitulo              = x.dttitulo) vi
where fo.cdfornecedor          = tap.cdfornecedor
  and fo.nrregistro_fornecedor = vi.nrregistro_fornecedor;

prompt
prompt Creating view V_TI_ITEM_LANCAMENTO_CTBL
prompt =======================================
prompt
create or replace force view ems506unicoo.v_ti_item_lancamento_ctbl as
select  -- Josias 01-07-2014 - ajustes necessários
        V.NRPERIODO,
        V.NRLANCAMENTO LANCTO,
        V.NRSEQ_LANCTO SEQ,
        V.COD_CTA_CTBL CONTA,
        V.COD_CCUSTO   CCUSTO,
        V.IND_NATUR_LANCTO_CTBL NAT_CONT,
        V.VAL_LANCTO_CTBL VALOR,
        V.DES_HISTOR_LANCTO_CTBL HISTORICO,
        DECODE(V.CDSITUACAO,
              'IT',
              '[IT] INTEGRADO',
              'ER',
              '[ER] ERRO',
              'CA',
              '[CA] CANCELADO',
              'RE',
              '[RE] REPROCESSAR',
              'RC',
              '[RC] RECEBIDO',
              'PE',
              '[PE] PENDENTE',
              'GE',
              '[GE] GERADO',
              V.CDSITUACAO) SITUACAO,
        COD_HISTOR_PADR CDHIST,
        DAT_LANCTO DTLANCTO,
        COD_PROJ_FINANC,
        IND_OCORRENCIA,
        DAT_PROCESSAMENTO DTPROCESSAMENTO,
        DAT_GERACAO       DTGERACAO,
        DES_DOCTO DOCTO,
        COD_EMPRESA EMPRESA,
        COD_UNID_NEGOC UNIDADE,
        NUM_ITEM_LANCTO_CTBL,
        NRSEQ_CONTROLE_INTEGRACAO
from TI_ITEM_LANCAMENTO_CTBL V
;

prompt
prompt Creating view V_TI_LANCAMENTO_CTBL
prompt ==================================
prompt
create or replace force view ems506unicoo.v_ti_lancamento_ctbl as
select
      /*
      ***************************************************************************************************************
      Criação          : Alecsandro Ferreira dos Santos
      Data             : 04/11/2009
      Módulo Principal : Integração EMS5
      Módulos          : -
      Telas            :
      Objetivo         : Agrupar os lancamentos contábeis por data

      Alteracoes
      +------------------------------------------------------------------------------------------------------------------------------------------+
      | DATA       | RESPONSAVEL   | VERSAO        | PENDÊNCIA | ALTERACAO                                                                       |
      |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
      | 04/11/2009 | ALECSANDRO    |               |           | A tabela TI_LANCAMENTO_CONTABIL foi alterada para TI_ITEM_LANCAMENTO_CONTABIL   |
      |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
      | 01/07/2014 | JOSIAS        |               |           | Ajustes necessários                                                             |
      |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
      */
      nrseq_CONTROLE_INTEGRACAO,trunc(lc.dat_lancto) dat_lancto, to_number(to_char(trunc(lc.dat_lancto),'DD')) num_lancto_ctbl
from
      ems506unicoo.ti_item_lancamento_ctbl lc
group by
      nrseq_CONTROLE_INTEGRACAO,trunc(dat_lancto)
;

prompt
prompt Creating view V_TI_LOTE_CTBL
prompt ============================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TI_LOTE_CTBL AS
SELECT -- Josias 01-07-2014 - Ajustes necessários
       T.NRPERIODO,
       T.DES_LOTE_CTBL DESCRICAO,
       T.COD_PLANO_CTA_CTBL PLANO,
       T.COD_PLANO_CCUSTO PLANO_CCUSTO,
       T.DAT_LOTE_CTBL DATA,
       T.DAT_PROCESSAMENTO DTPROCESSAMENTO,
       T.DAT_GERACAO DTGERACAO,
       T.AOLOTE_INTEGRACAO,
       T.NRSEQ_CONTROLE_INTEGRACAO
FROM   TI_LOTE_CTBL T
;

prompt
prompt Creating view V_TI_MONITOR_INTEGRACAO
prompt =====================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TI_MONITOR_INTEGRACAO AS
SELECT -- Josias 01-07-2014 - Ajustes necessários
DECODE(CDSITUACAO,'CA','CANCELADO',
                  'GE','GERADO',
                  'RC','RECEBIDO',
                  'ER','ERRO',
                  'PE','PENDENTE',
                  'RE','REPROCESSADO',
                  'IT','INTEGRADO',
                  'VD','EM VALIDACAO',
                  CDSITUACAO) DSSITUACAO,
TPINTEGRACAO,
DECODE(TPINTEGRACAO,'CL','CLIENTE',
                    'FN','FORNECEDOR',
                    'TR','TITULO A RECEBER',
                    'TP','TITULO A PAGAR',
                    'CT','CONTABILIDADE',
                    'CX','CAIXA E BANCOS',
                    'FT','FATURAMENTO',
                    'EM','ESTORNO MENSALIDADE',
                    TPINTEGRACAO) NOINTEGRACAO,
COUNT(*) QTREGISTROS,
MAX(CI.DTPROCESSAMENTO) DTULTIMO_PROCESSAMENTO
FROM
       TI_CONTROLE_INTEGRACAO CI
WHERE
       CI.CDSITUACAO NOT IN ('RE','CA')
GROUP BY
      CDSITUACAO ,TPINTEGRACAO
;

prompt
prompt Creating view V_TI_MOVIMENTO_CTA_COR_MON
prompt ========================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TI_MOVIMENTO_CTA_COR_MON AS
SELECT -- Josias 01-07-2014 - Ajustes necessários
       V.COD_DOCTO_MOVTO_CTA_BCO  MOVIMENTO,
       TRUNC(V.DAT_MOVTO_CTA_CORREN)     DATA,
       V.VAL_MOVTO_CTA_CORREN     VALOR,
       V.DES_HISTOR_PADR          HISTORICO,
       DECODE(V.CDSITUACAO,
              'IT',
              '[IT] INTEGRADO',
              'ER',
              '[ER] ERRO',
              'CA',
              '[CA] CANCELADO',
              'RE',
              '[RE] REPROCESSAR',
              'RC',
              '[RC] RECEBIDO',
              'PE',
              '[PE] PENDENTE',
              'GE',
              '[GE] GERADO',
              V.CDSITUACAO) SITUACAO,
       V.COD_CTA_CORREN           CONTA,
       COD_TIP_TRANS_CX           TRANSACAO,
       IND_FLUXO_MOVTO_CTA_CORREN TIPO,
       COD_CENAR_CTBL             CENARIO,
       COD_HISTOR_PADR            HIST_PADRAO,
       DAT_ENVIO                  ENVIO,
       DAT_PROCESSAMENTO          PROCESSAMENTO,
       COD_PLANO_CCUSTO           PLANO,
       COD_CCUSTO                 CCUSTO,
       IND_ERRO_VALID             POSSUIERRO,
       NRSEQ_CONTROLE_INTEGRACAO
  FROM TI_MOVIMENTO_CTA_CORRENTE V
;

prompt
prompt Creating view V_TI_MOVIMENTO_CTA_CORRENTE
prompt =========================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TI_MOVIMENTO_CTA_CORRENTE AS
SELECT -- Josias 01-07-2014 - Ajustes necessários
        TC.CDACAO                   COD_ACAO,
        TC.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
        'RC' CDSITUACAO,
        TMC.COD_CTA_CORREN,
        MC.DTMOVIMENTO DAT_MOVTO_CTA_CORREN,
        'RE' IND_TIP_MOVTO_CTA_CORREN,
        TM.COD_TIP_TRANS_CX,
        CASE
           WHEN MC.CDMOVIMENTO IN ('90','92','94') THEN 'ENT'
           WHEN MC.CDMOVIMENTO IN ('91','93','95') THEN 'SAI'
        END IND_FLUXO_MOVTO_CTA_CORREN,
        TM.COD_CENAR_CTBL,
        TM.COD_HISTOR_PADR,
        MC.VLMOVIMENTO VAL_MVTO_CTA_CORREN,
        LTRIM(MC.CDSERIE_DOCUMENTO||' '||MC.NRDOCUMENTO) COD_DOCTO_MOVTO_CTA_BCO,
        'CMG' COD_MODUL_DTSUL,
        'NAO' IND_ERRO_VALID,
        --TM.DES_HISTOR_PADR,
        LTRIM(RTRIM(MC.TXHISTORICO)) || ' - '||'MOVIMENTO INTEGRADO A PARTIR DO UNICOO **NRMOVIMENTO = '||TC.NRSEQUENCIAL_ORIGEM||'**' DES_HISTOR_PADR,
        -1 NUM_ID_MOVTO_CTA_CORREN,
        CASE
           WHEN MC.CDMOVIMENTO IN ('90','92','94') THEN 'CR'
           WHEN MC.CDMOVIMENTO IN ('91','93','95') THEN 'DB'
        END IND_NATUR_LANCTO_CTBL,
        TMC.COD_ESTAB,
        TM.COD_UNID_NEGOC,
        MC.TXHISTORICO HISTORICO
FROM
        MOVIMENTO_CAIXA MC,
        TI_CONTROLE_INTEGRACAO TC,
        TI_TIPO_MOVIMENTO_CMG TM,
        TI_TIPO_MOVIMENTO_CMG_CAIXA TMC
WHERE
        TC.NRSEQUENCIAL_ORIGEM = MC.NRMOVIMENTO
AND     TC.TPINTEGRACAO='CX'
AND     MC.CDHISTORICO = TM.CDHISTORICO
AND     DECODE(MC.NRCONTA_CORRENTE,'Movim. H.U.','Movim. H.U.','*') = TM.CAIXA
AND     MC.NRCONTA_CORRENTE = TMC.NRCONTA_CORRENTE
;

prompt
prompt Creating view V_TI_MOVTO_CTA_CORRENTE_CUSTOM
prompt ============================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TI_MOVTO_CTA_CORRENTE_CUSTOM AS
SELECT  -- Josias 01-07-2014 - Ajustes necessários
        TC.CDACAO                   COD_ACAO,
        TC.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
        'RC' CDSITUACAO,
        TMC.COD_CTA_CORREN,
        MC.DTMOVIMENTO DAT_MOVTO_CTA_CORREN,
        'RE' IND_TIP_MOVTO_CTA_CORREN,
        TM.COD_TIP_TRANS_CX,
        CASE
           WHEN MC.CDMOVIMENTO IN ('90','92','94') THEN 'ENT'
           WHEN MC.CDMOVIMENTO IN ('91','93','95') THEN 'SAI'
        END IND_FLUXO_MOVTO_CTA_CORREN,
        TM.COD_CENAR_CTBL,
        TM.COD_HISTOR_PADR,
        MC.VLMOVIMENTO VAL_MVTO_CTA_CORREN,
        LTRIM(MC.CDSERIE_DOCUMENTO||' '||MC.NRDOCUMENTO) COD_DOCTO_MOVTO_CTA_BCO,
        'CMG' COD_MODUL_DTSUL,
        'NAO' IND_ERRO_VALID,
        --TM.DES_HISTOR_PADR,
        LTRIM(RTRIM(MC.TXHISTORICO)) || ' - '||'MOVIMENTO INTEGRADO A PARTIR DO UNICOO **NRMOVIMENTO = '||TC.NRSEQUENCIAL_ORIGEM||'**' DES_HISTOR_PADR,
        -1 NUM_ID_MOVTO_CTA_CORREN,
        CASE
           WHEN MC.CDMOVIMENTO IN ('90','92','94') THEN 'CR'
           WHEN MC.CDMOVIMENTO IN ('91','93','95') THEN 'DB'
        END IND_NATUR_LANCTO_CTBL,
        TMC.COD_ESTAB,
        TM.COD_UNID_NEGOC,
        MC.TXHISTORICO HISTORICO
FROM
        MOVIMENTO_CAIXA MC,
        TI_CONTROLE_INTEGRACAO TC,
        TI_TIPO_MOVIMENTO_CMG TM,
        TI_TIPO_MOVIMENTO_CMG_CAIXA TMC
WHERE
        TC.NRSEQUENCIAL_ORIGEM = MC.NRMOVIMENTO
AND     TC.TPINTEGRACAO='CX'
AND     MC.CDHISTORICO = TM.CDHISTORICO
AND     DECODE(MC.NRCONTA_CORRENTE,'Movim. H.U.','Movim. H.U.','*') = TM.CAIXA
AND     MC.NRCONTA_CORRENTE = TMC.NRCONTA_CORRENTE
;

prompt
prompt Creating view V_TI_RATEIO_CONTABIL
prompt ==================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TI_RATEIO_CONTABIL AS
SELECT
       CDEMPRESA,
       NRPERIODO,
       TPPERIODO,
       NRLANCAMENTO,
       NRSEQ_LANCTO,
       NRDOCUMENTO,
       VLLANCAMENTO,
       'DB' TPLANCAMENTO,
       CDCONTA_DEB
FROM
       RATEIO
WHERE
       CDCONTA_DEB IS NOT NULL
UNION
SELECT
       CDEMPRESA,
       NRPERIODO,
       TPPERIODO,
       NRLANCAMENTO,
       NRSEQ_LANCTO,
       NRDOCUMENTO,
       VLLANCAMENTO,
       'CR' TPLANCAMENTO,
       CDCONTA_CRED
FROM
       RATEIO
WHERE
       CDCONTA_CRED IS NOT NULL;

prompt
prompt Creating view V_TI_TIPO_INTEGRACAO
prompt ==================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TI_TIPO_INTEGRACAO AS
SELECT -- Josias 01-07-2014 - Ajustes necessários
       'INT_TI_CLIENTE' CDTABELA FROM DUAL
;

prompt
prompt Creating function F_TI_IR_ACR
prompt =============================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_IR_ACR" (p_NRRegistro_Titulo number) return number
is
/*
 Alessandro - 17-01-2015 - Criação objeto
*/

vval_ir titulo_a_receber.vl_ir_fonte_fat%type;
begin
  select sum(ttr.vltaxa) into vval_ir from taxa_titulo_a_receber ttr
    where ttr.nrregistro_titulo= p_NRRegistro_Titulo;

  return nvl(vval_ir,0);

end;
/

prompt
prompt Creating function F_TI_TIP_MOVTO_TIT_ACR
prompt ========================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_TIP_MOVTO_TIT_ACR" (
                                                  PCDEmpresa varchar2,
                                                  PCDModulo  varchar2,
                                                  pCDMovimento varchar2,
                                                  pCOD_GRP_CLIENTE VARCHAR2) RETURN number
IS
/*
 josias - 01-07-2014 - atualizações necessárias
*/

       vResult number;
begin

--dbms_output.enable(9999999999999999999999999);
--dbms_output.put_line('P1. Empresa: ' || pcdempresa || ' Movimento: ' || pcdmovimento ||
--                     ' Modulo: ' || pcdmodulo || ' Grupo: ' || pcod_grp_cliente);
     begin
        select
               tmt.nrsequencial
        into
            vResult
        from ti_tipo_movimento_tit_acr tmt
        where
             (tmt.cdempresa='*' or tmt.cdempresa=pcdempresa)
             and
             tmt.cdmovimento=pcdmovimento
             and
             tmt.cdmodulo=pcdmodulo
             and
             ( tmt.cod_grp_clien='*' or tmt.cod_grp_clien=pCOD_GRP_CLIENTE);
     exception
               when no_data_found then vResult:=-1;
               when others        then vResult:=-2;
     end;
--dbms_output.put_line('SAINDO: ' || vResult);

     Return vResult;
end;
/

prompt
prompt Creating function F_TI_TIP_PESSOA_CLIENTE
prompt =========================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_TIP_PESSOA_CLIENTE" (pCDN_CLIENTE VARCHAR2) RETURN VARCHAR2
IS
/*
 josias - 01-07-2014 - atualizações necessárias
*/

       vResult varchar2(1);
begin
    select decode(count(*),0,'F','J')
    INTO
    vResult from ems5.pessoa_jurid  pj,
         ems5.cliente cl
    where
         cl.num_pessoa=pj.num_pessoa_jurid
         and
         cl.cdn_cliente=pCDN_CLIENTE;

      return vResult;
end;
/

prompt
prompt Creating view V_TI_TIT_ACR
prompt ==========================
prompt
create or replace force view ems506unicoo.v_ti_tit_acr as
select distinct
        /*
        ***************************************************************************************************************
        Criação          : -
        Data             : -
        Módulo Principal : Integração EMS5
        Módulos          : -
        Telas            : CR05FC7
        Objetivo         : Enviar os titulos do Unicoo para o EMS5

        Alteracoes
        +-------------------------------------------------------------------------------------------------------------------------------------------+
        | DATA       | RESPONSAVEL    | VERSAO        | PENDÊNCIA | ALTERACAO                                                                       |
        |------------|----------------|---------------|---------------------------------------------------------------------------------------------|
        | 19/10/2009 | ALECSANDRO     |               |           | A view não estava considerando o grupo de cliente pessoa fisica                 |
        |------------|----------------|---------------|---------------------------------------------------------------------------------------------|
        | 30/10/2009 | ALECSANDRO     |               |           | A view passou a tratar titulos que não possuem origem no faturamento            |
        |------------|----------------|---------------|---------------------------------------------------------------------------------------------|
        | 20/11/2009 | ALECSANDRO     |               |           | Correção no processo de definição de série do docto                             |
        |------------|----------------|---------------|---------------------------------------------------------------------------------------------|
        | 24/04/2013 | EDMILSON/RAFAEL|               |           | Adicionado tratamento para nrnossonumero do ajius para 12 caracteres para baixa |
        |------------|----------------|---------------|---------------------------------------------------------------------------------------------|
        | 01/07/2014 | JOSIAS         |               |           | Ajustes necessários                                                             |
        |------------|----------------|---------------|---------------------------------------------------------------------------------------------|
        */

        ucl.nrregistro_cliente nrpessoa,
        tr.cdcliente,
        nvl(tip.cdn_cliente,0) cod_cliente,
        nvl(tr.nrdocumento,tr.nrregistro_titulo) nrdocumento,
        tmt.cod_estab,

        f_ti_tip_pessoa_cliente(tip.cdn_cliente) ind_tipo_pessoa,

        ecl.cod_id_feder cod_id_feder_jurid,
        ecl.cod_id_feder cod_id_feder,
        tmt.cod_espec_docto,
        case
            when
                 tmt.cdmodulo='FT' and tr.nrdocumento  like '%-%'
            then  tmt.cdmovimento
        else
            ' '
        end cod_ser_docto,
        case
            when tr.nrdocumento  not like '%-%' then nvl(substr(nrdocumento,1,10),tr.nrregistro_titulo)
            when /*length(tr.nrdocumento)  and*/ tr.nrdocumento  like '%-%' then substr(nrdocumento,instr(nrdocumento,'-')+1,10)
        else
           nvl(substr(nrdocumento,instr(nrdocumento,'-')+1,10),tr.nrregistro_titulo)
        end cod_titulo_acr,

        case when tr.nrdocumento not like '%-%' and length(tr.nrdocumento)>10  then
                  case when tmt.cdmodulo <> 'FT' and nvl(tr.nrparcela,0) > 0 then
                       lpad(tr.nrparcela,2,'0')
                  else
                       substr(nrdocumento,11,2)
                  end
             when tr.nrdocumento not like '%-%' and length(tr.nrdocumento)<=10 then
                  case when tmt.cdmodulo <> 'FT' and nvl(tr.nrparcela,0) > 0 then
                       lpad(tr.nrparcela,2,'0')
                  else
                       ' '
                  end
             when tr.cdsituacao='2' then 'P'
        else
           ' '
        end cod_parcela,

        tr.dttitulo               dat_emissao,
        tr.dtvencimento           dat_vencto,
        tr.dtvencimento           dat_previsao_liquidac,
        tr.vltitulo val_titulo,
        null dat_desconto,
        tr.vltitulo  val_liq_titulo,
        0 val_desconto,
        --tmt.cod_portador,
		    --nvl((select tb.cod_portador_acr from ti_banco tb where tb.cod_banco_unicoo = ucl.nrbanco),tmt.cod_portador) cod_portador,
		    nvl((select tb.cod_portador_acr from ti_banco tb where tb.cod_banco_unicoo = tr.nrbanco),tmt.cod_portador) cod_portador,
        nvl(tr.txhistorico, ' ') des_text_histor,
        tmt.cod_cart_bcia,
        'IMP'    ind_tip_espec_docto,
        0 ind_ocorrencia,
        trunc(sysdate) dat_processamento,
        tmt.cod_empresa,
        nvl(tmt.cod_ccusto,' ') cod_ccusto,
        tmt.cod_cta_ctbl,

/*        case
            when tr.cdportador='033' then nvl(substr(tr.nrnossonumero,-8,8),' ') -- Alessandro 24/10/2013
            when length(tr.nrnossonumero)=10 then nvl(lpad(tr.nrnossonumero,12,'0'),' ')
            when length(tr.nrnossonumero)=8  then nvl(lpad(tr.nrnossonumero,12,'0'),' ') -- Alessandro 24/07/2012 <<AJIUS>> alterado para 12 para permitir baixa
            --when tr.cdempresa='00002' then '0000'||tr.nrnossonumero
        else
            nvl(tr.nrnossonumero,' ')
        end cod_tit_acr_bco,
*/
        nvl(tr.nrnossonumero,' ') cod_tit_acr_bco,

        nvl(tmt.cod_tip_fluxo_financ_ems2,tmt.cod_tip_fluxo_financ) cod_tip_fluxo_financ,
        --nvl(tr.vl_ir_fonte_fat,0) val_ir,
        f_ti_ir_acr(tr.nrregistro_titulo) val_ir,
        'RC' cdsituacao,
        f_ti_parametro_integracao('COD_PAIS') cod_pais,
        ci.nrsequencial nrseq_controle_integracao,
        f_ti_parametro_integracao('COD_PLANO_CCUSTO') cod_plano_ccusto,

        --TRATAR O PLANO DE CONTAS ATUAL E OS 2 ANTERIORES
        case
          when tr.dttitulo >= f_ti_parametro_integracao('DT_PLANO_CONTAS') then
             f_ti_parametro_integracao('COD_PLANO_CTA_CTBL') --PLANO ATUAL

          when tr.dttitulo >= f_ti_parametro_integracao('DT_INI_PLANO_CONTAS_2') and tr.dttitulo <= f_ti_parametro_integracao('DT_FIM_PLANO_CONTAS_2') then
             f_ti_parametro_integracao('COD_PLANO_CTA_CTBL_2') --PLANO VENCIDO MAIS RECENTE

          when tr.dttitulo >= f_ti_parametro_integracao('DT_INI_PLANO_CONTAS_3') and tr.dttitulo <= f_ti_parametro_integracao('DT_FIM_PLANO_CONTAS_3') then
             f_ti_parametro_integracao('COD_PLANO_CTA_CTBL_3') --PLANO VENCIDO ANTERIOR
          else
             f_ti_parametro_integracao('COD_PLANO_CTA_CTBL_4') --PLANO VENCIDO MAIS ANTIGO

        end cod_plano_cta_ctbl,

        tr.nrparcela
 from   titulo_a_receber       tr,
        pessoa                 ps,
        Ti_Tipo_Movimento_Tit_Acr tmt,
        ti_controle_integracao ci,
        PRODUCAO.cliente@UNICOO_HOMOLOGA                ucl,
        EMS5.Cliente           ecl,
        ti_pessoa              tip,
        ti_empresa             emp
 where  ecl.cdn_cliente     = tip.cdn_cliente
   and  tip.nrregistro      = ucl.nrregistro_cliente
   and  ucl.cdcliente       = tr.cdcliente
   and  tmt.nrsequencial    = f_ti_tip_movto_tit_acr(ci.cdempresa,
                                                  ci.cdmodulo,
                                                  ci.cdmovimento,
                                                  nvl(ecl.cod_grp_clien,tmt.cod_grp_clien))
  and  ps.nrregistro          = ucl.nrregistro_cliente
  and  ci.nrsequencial_origem = tr.nrregistro_titulo
  and  emp.cdempresa           = tr.cdempresa
  and  nvl(ecl.cod_empresa,f_ti_parametro_integracao('COD_EMPRESA'))         = emp.cod_empresa
  and  ci.cdsituacao          <> 'RE'

  and  ci.tpintegracao        = 'TR'
;

prompt
prompt Creating view V_TI_TIT_ACR_CTBL
prompt ===============================
prompt
create or replace force view ems506unicoo.v_ti_tit_acr_ctbl as
select -- Josias 01-07-2014 - ajustes necessários
       distinct
        tmt.cod_estab,
        f_ti_parametro_integracao('COD_ID_FEDER') cod_unid_federac,
        nvl(tmt.cod_tip_fluxo_financ_ems2,tmt.cod_tip_fluxo_financ) cod_tip_fluxo_financ,
        tmt.cod_cta_ctbl,
        nvl(tmt.cod_ccusto, ' ') cod_ccusto,
        case
            when tr.cdsituacao = '2' then
                tr.vltitulo
                -- f_saldo_titulo_receber(tr.nrregistro_titulo)
        else
          case
            when tmt.cod_estab = '01' and f_ti_parametro_integracao('AO_APROP_IR') = 'S' then
               tr.vltitulo + nvl(F_TI_IR_ACR(tr.nrregistro_titulo),0)--+ nvl(tr.vl_ir_fonte_fat,0)
               --f_saldo_titulo_receber(tr.nrregistro_titulo) + nvl(tr.vl_ir_fonte_fat,0)-- importar cartao
            else
              tr.vltitulo-- + nvl(tr.vl_ir_fonte_fat,0)
            end
        end val_aprop_ctbl ,

        tr.dttitulo       dat_processamento,
        ci.nrsequencial      nrseq_controle_integracao,
        'RC' cdsituacao
   from titulo_a_receber tr,
        ti_tipo_movimento_tit_acr tmt,
        ti_controle_integracao ci,
        PRODUCAO.cliente@UNICOO_HOMOLOGA ucl,
        cliente ecl,
        ti_pessoa tip
where   tip.cdn_cliente = ecl.cdn_cliente

   and  tip.nrregistro  = ucl.nrregistro_cliente
   --AND TIP.NRCGC_CPF = ECL.COD_ID_FEDER
   and  ecl.cdn_cliente = tip.cdn_cliente
   and  ucl.cdcliente=tr.cdcliente
   and  tmt.nrsequencial=f_ti_tip_movto_tit_acr(ci.cdempresa,
                                                ci.cdmodulo,
                                                ci.cdmovimento,
                                                ecl.cod_grp_clien
                                               )
   and  ci.nrsequencial_origem=tr.nrregistro_titulo
   and  ci.tpintegracao='TR'
;

prompt
prompt Creating view V_TI_TIT_ACR_ESTORNO
prompt ==================================
prompt
create or replace force view ems506unicoo.v_ti_tit_acr_estorno as
select -- Josias 01-07-2014 - ajustes necessários
    'RC' cdsituacao,
    TA.COD_EMPRESA,
    TA.cod_espec_docto,
    TA.cod_estab,
    TA.cod_ser_docto,
    TA.cod_tit_acr,
    ta.cod_parcela,
    TA.cod_tit_acr_bco,
    TA.COD_REFER,
    MT.num_id_movto_tit_acr,
    TA.num_id_tit_acr,
    TA.cod_portador,
    SYSDATE dat_transacao,
    SYSDATE dat_envio,
    ta.cdn_cliente,
    sysdate dat_processamento,
    'Titulo' ind_niv_operac_acr,
    'Estorno' ind_tip_operac_acr

FROM
      tit_acr ta,
      movto_tit_acr MT
WHERE
       MT.U##COD_ESTAB=TA.U##COD_ESTAB
       AND
       MT.NUM_ID_TIT_ACR=TA.NUM_ID_TIT_ACR
       AND
       MT.IND_TRANS_ACR_ABREV='IMPL'
;

prompt
prompt Creating view V_TI_TIT_ACR_IMPOSTO
prompt ==================================
prompt
create or replace force view ems506unicoo.v_ti_tit_acr_imposto as
select -- Josias 01-07-2014 - ajustes necessários
       -- Alessandro 17/01/2015 - novo tratamento dos impostos
      distinct
      ci.nrsequencial nrseq_controle_integracao,
      'RC' cdsituacao,
      case
          when tr.nrdocumento  not like '%-%' and length(tr.nrdocumento)>10  then SUBSTR(NRDOCUMENTO,11,2)
          when tr.nrdocumento  not like '%-%' and length(tr.nrdocumento)<=10 then ' '
          when tr.cdsituacao='2' then 'P'
      else
         ' '
      end cod_parcela,
      --f_ti_parametro_integracao('IND_CLASSIFIC_IMPOSTO') ind_clas_impto, -- '3280A' ind_clas_impto,
      nvl(xx.cod_classif_impto_t11,'XXX') ind_clas_impto,
      case
          when tr.nrdocumento  not like '%-%' then SUBSTR(NRDOCUMENTO,1,10)
          when /*length(tr.nrdocumento)  and*/ tr.nrdocumento  like '%-%' then SUBSTR(NRDOCUMENTO,instr(nrdocumento,'-')+1,10)
      else
         substr(nrdocumento,instr(nrdocumento,'-')+1,10)
      end cod_titulo_acr,
      '  ' cod_unid_federac,
      --f_ti_parametro_integracao('COD_CLASSIFIC_IMPOSTO_CLIENTE') cod_classif_impto, --'3280A' cod_classif_impto,
      nvl(xx.cod_classif_impto_t11,'XXX') cod_classif_impto,
      --to_number('1,5') val_aliq_impto,
      trunc(nvl(dd.vlaliquota_evento_contribuicao,(ttr.vltaxa*100/tr.vltitulo)),2) val_aliq_impto,--vinicius incluido nlv
      --tr.vl_ir_fonte_fat val_rendto_tribut,
      NVL(dd.vlbase_evento_contribuicao,ttr.vltaxa) val_rendto_tribut, --vinicius incluido nvl
      case
          when
               tmt.cdmodulo='FT' and tr.nrdocumento  like '%-%'
          then  tmt.cdmovimento
      else
          ' '
      end cod_ser_docto,
      --f_ti_parametro_integracao('CODIGO_IMPOSTO_CLIENTE') cod_imposto,  --'3280A' cod_imposto,
      nvl(xx.cod_imposto_t11,'XXX') cod_imposto,
      0 ind_ocorrencia,
      cod_estab,
      cod_espec_docto,
      sysdate dat_processamento,
      --tr.vl_ir_fonte_fat val_imposto
      ttr.vltaxa val_imposto
from  titulo_a_receber tr,
      pessoa ps,
      ti_tipo_movimento_tit_acr tmt,
      ti_controle_integracao ci,
      PRODUCAO.cliente@UNICOO_HOMOLOGA ucl,
      cliente ecl,
      ti_pessoa tip,
            --
      taxa_titulo_a_receber ttr,
      TI_TAXA_A_RECEBER xx,
      resumo_detalhe_faturamento dd,
      tipo_evento_faturamento tef
where ecl.cdn_cliente  = tip.cdn_cliente
  and ucl.cdcliente    = tr.cdcliente
  and tip.nrregistro   = ucl.nrregistro_cliente
  and tmt.nrsequencial = f_ti_tip_movto_tit_acr(ci.cdempresa,
                                              ci.cdmodulo,
                                              ci.cdmovimento,
                                              ecl.cod_grp_clien)
  and ps.nrregistro          = ucl.nrregistro_cliente
  and ci.nrsequencial_origem = tr.nrregistro_titulo
  and ci.tpintegracao        = 'TR'
  and tip.cdn_cliente is not null
  --and vl_ir_fonte_fat > 0
  and ecl.u##cod_empresa=f_ti_parametro_integracao('COD_EMPRESA')
  --
  and ttr.nrregistro_titulo=ci.nrsequencial_origem
  and xx.cod_taxa_unicoo(+)=ttr.cdtaxa
  and dd.nrfatura = tr.nrdocumento
  and tef.cdevento=dd.cdevento
  and tef.cdtaxa_contribuicao=ttr.cdtaxa
;

prompt
prompt Creating function F_TI_TIP_MOVTO_TIT_APB
prompt ========================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_TIP_MOVTO_TIT_APB" (
                                                  PCDEmpresa varchar2,
                                                  PCDModulo  varchar2,
                                                  pCDMovimento varchar2,
                                                  pcod_grp_fornecedor VARCHAR2,
                                                  PCDDivisao   varchar2,
                                                  pCDCentro_Custo varchar2,
                                                  pcod_espec_docto varchar2 default null
                                                  ) RETURN number
IS
/*
 josias - 01-07-2014 - atualizações necessárias
*/

       vResult number;
       vCOD_Estab varchar2(4);
begin
     begin
        begin
            select cod_estab
              into vCod_Estab
              from ti_estabelecimento et
             where et.cddivisao = pcddivisao;
        exception
             when no_data_found then
                  vcod_estab:='*';
        end;

        select
               tmt.nrsequencial
        into
            vResult
        from ti_tipo_movimento_tit_apb tmt
        where
             ( vCOD_Estab = '*' or  tmt.cod_estab = vCod_Estab or tmt.cod_estab = '$T' OR tmt.cod_estab = '01')
             and
             (tmt.cdempresa  = '*' or tmt.cdempresa=pcdempresa)
             and
             tmt.cdmovimento = pcdmovimento
             and
             tmt.cdmodulo    = pcdmodulo
             and
             (tmt.cod_grp_fornecedor = '*' or tmt.cod_grp_fornecedor=pcod_grp_fornecedor)
             AND
             (tmt.cddivisao =  '*' or tmt.cddivisao = pcddivisao)
             and
             (tmt.cdcentro_custo='*' or nvl(tmt.cdcentro_custo,' ')=pcdcentro_custo);
             --and tmt.cod_espec_docto = nvl(pcod_espec_docto,tmt.cod_espec_docto);
     exception
               when no_data_found then vResult:=-1;
               when others        then vResult:=-2;
     end;
     Return vResult;
end;
/

prompt
prompt Creating function F_TI_TIP_PESSOA_FORNECEDOR
prompt ============================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_TIP_PESSOA_FORNECEDOR" (pcdn_fornecedor varchar2) return varchar2
is  vResult varchar2(1);
/*
 josias - 01-07-2014 - atualizações necessárias
*/

begin
    select decode(count(*),0,'F','J')
      into vresult from ems5.pessoa_jurid  pj,
           ems5.fornecedor fn
    where fn.num_pessoa     = pj.num_pessoa_jurid
      and fn.cdn_fornecedor = pcdn_fornecedor;

      return vresult;
end;
/

prompt
prompt Creating view V_TI_TIT_APB
prompt ==========================
prompt
create or replace force view ems506unicoo.v_ti_tit_apb as
select distinct -- josias - 28-05-2014 colocado o distinct pois estava retornando mais de um registro na query
                ufn.nrregistro_fornecedor nrpessoa,
                tp.cdfornecedor,
                tip.cdn_fornecedor cdfornecedor_ems5,
                substr(tp.nrdocumento, 1, 10) cod_titulo_ap,
                0 val_per_desc,
                nvl(tmt.cod_cart_bcia,' ') cod_cart_bcia,
                sysdate dat_processamento,
                nvl(tmt.cod_tip_fluxo_financ,' ') cod_tip_fluxo_finan,
                0 cdn_fornecedor,
                1 qtd_parcela,
                nvl(f_ti_tip_pessoa_fornecedor(tip.cdn_fornecedor),' ') ind_tipo_pessoa,
                nvl(tmt.cod_ser_docto,' ') cod_ser_docto,
                nvl(substr(tp.nrdocumento, 11, 2), '01') cod_parcela,

                case
                  when f_ti_parametro_integracao('INTEGRA_VALOR_LIQUIDO_TIT_APB') = 'S' then
                   0 --Devem ser migrados valores liquidos... Edmilson 01/09/2014
                  else
                   case
                     when tmt.Cdmovimento in
                          (f_ti_parametro_integracao('HISTORICO_COM_VALOR_LIQUIDO_APB')) then
                      0
                     else
                      nvl(tp.vldesconto, 0) + nvl(tp.vlabatimento, 0) -- Alessandro 26/12/2012
                      + nvl(tp.vlabatimento_2, 0)
                   end
                end val_desconto, -- Alessandro 26/12/2012

                'RC' cdsituacao,
                case
                  when tmt.cod_ccusto = '$T' then
                   nvl(to_char(tp.cdcentro_custo), ' ')
                  else
                   nvl(tmt.cod_ccusto, ' ')
                end cod_ccusto,
                (select distinct fe.cod_id_feder
                   from fornecedor fe
                  where fe.cdn_fornecedor = tip.cdn_fornecedor) cod_id_feder,
                tmt.cod_espec_docto cod_espec_docto,
                --tp.dttitulo                                        dat_emissao,
                tp.Dtemissao_Nf dat_emissao,
                tp.dtvencimento dat_vencto,
                tp.dtvencimento dat_previsao_pagto,

                case
                  when f_ti_parametro_integracao('INTEGRA_VALOR_LIQUIDO_TIT_APB') = 'S' then
                   null --Devem ser migrados valores liquidos... Edmilson 01/09/2014
                  else
                   case
                     when tmt.Cdmovimento in
                          (f_ti_parametro_integracao('HISTORICO_COM_VALOR_LIQUIDO_APB')) then
                      null
                     else
                      decode(substr(tp.txhistorico, 1, 11),
                             'Ref.Integra',
                             '31/12/2050',
                             tp.dtvencimento)
                   end
                end dat_desconto, -- Alessandro 26/12/2012

                case
                  when f_ti_parametro_integracao('INTEGRA_VALOR_LIQUIDO_TIT_APB') = 'S' then
                   nvl(tp.vlbruto, tp.vltitulo) - nvl(tp.vldesconto, 0) -
                   nvl(tp.vlabatimento, 0) - nvl(tp.vlabatimento_2, 0)
                  else
                   case
                     when tmt.Cdmovimento in
                          (f_ti_parametro_integracao('HISTORICO_COM_VALOR_LIQUIDO_APB')) then
                     -- Josias 27-11-2014, ajustardo para subir titulos de OPMS com valor liquido.
                      nvl(tp.vlbruto, tp.vltitulo) - nvl(tp.vldesconto, 0) -
                      nvl(tp.vlabatimento, 0) - nvl(tp.vlabatimento_2, 0)
                     else
                      nvl(tp.vlbruto, tp.vltitulo)
                   end
                end val_bruto,

                nvl(tp.vlbruto, tp.vltitulo) - nvl(tp.vldesconto, 0) -
                nvl(tp.vlabatimento, 0) - nvl(tp.vlabatimento_2, 0) val_titulo,
                0 num_dias_atraso,
                nvl(tp.vljuros, 0) val_juros,
                0 val_perc_juros_dia_atraso,
                0 val_perc_multa_atraso,
                nvl(tmt.cod_portador,0) cod_portador,
                nvl(tmt.cod_forma_pagto,' ') cod_forma_pagto,
                nvl(tmt.cod_empresa,' ') cod_empresa,
                case
                  when tmt.cod_estab = '$T' then
                   (select dd.cod_estab
                      from ti_estabelecimento dd
                     where dd.cddivisao = ci.cddivisao) --TRATA A DIVISAO DO TITULO
                  else
                   tmt.cod_estab
                end cod_estab,
                tmt.cod_tip_fluxo_financ,
                ci.nrsequencial nrseq_controle_integracao,
                '0' ind_ocorrencia,
                tp.nrregistro_titulo,
                nvl(f_ti_parametro_integracao('COD_PLANO_CCUSTO'),' ') cod_plano_ccusto,
                --TRATAR O PLANO DE CONTAS ATUAL E OS 2 ANTERIORES
                case
                  when tp.dttitulo > f_ti_parametro_integracao('DT_PLANO_CONTAS') then
                     f_ti_parametro_integracao('COD_PLANO_CTA_CTBL') --PLANO ATUAL

                  when tp.dttitulo > f_ti_parametro_integracao('DT_INI_PLANO_CONTAS_2') and tp.dttitulo <= f_ti_parametro_integracao('DT_FIM_PLANO_CONTAS_2') then
                     f_ti_parametro_integracao('COD_PLANO_CTA_CTBL_2') --PLANO VENCIDO MAIS RECENTE

                  when tp.dttitulo > f_ti_parametro_integracao('DT_INI_PLANO_CONTAS_3') and tp.dttitulo <= f_ti_parametro_integracao('DT_FIM_PLANO_CONTAS_3') then
                     f_ti_parametro_integracao('COD_PLANO_CTA_CTBL_3') --PLANO VENCIDO ANTERIOR
                  else
                     f_ti_parametro_integracao('COD_PLANO_CTA_CTBL_4') --PLANO VENCIDO MAIS ANTIGO

                end cod_plano_cta_ctbl,

       nvl(substr('Valor original do Titulo: '||nvl(tp.vlbruto, tp.vltitulo)|| decode(nvl(tp.vlpago,0),0,'',' Valor pago: ' || tp.vlpago)
                                               || decode(tp.dtultimo_recebimento,null,'', ' Data do Ultimo pagamento: '||  tp.dtultimo_recebimento) ||'. '
                                               ||tp.txhistorico,0,2000),' ')   des_text_histor
  from titulo_a_pagar            tp,
       pessoa                    ps,
       ti_tipo_movimento_tit_apb tmt,
       ti_controle_integracao    ci,
       PRODUCAO.fornecedor@UNICOO_HOMOLOGA                ufn,
       fornecedor                                         efn,
       ti_pessoa                 tip,
       ti_empresa                emp
 where ufn.cdfornecedor = tp.cdfornecedor
   and tip.nrregistro = ufn.nrregistro_fornecedor
   and efn.cdn_fornecedor = tip.cdn_fornecedor
   and tmt.nrsequencial =
       f_ti_tip_movto_tit_apb(tp.cdempresa,
                              ci.cdmodulo,
                              ci.cdmovimento,
                              efn.cod_grp_fornec,
                              ci.cddivisao,
                              ci.cdcentro_custo,
                              tmt.cod_espec_docto)
   and ps.nrregistro = ufn.nrregistro_fornecedor
   and ci.nrsequencial_origem = tp.nrregistro_titulo
   and ci.tpintegracao = 'TP'
   and ci.cdsituacao <> 'RE'
   and tip.cdn_fornecedor is not null
   and emp.cdempresa = tp.cdempresa
   and nvl(efn.cod_empresa, f_ti_parametro_integracao('COD_EMPRESA')) =
       emp.cod_empresa
 -- AND TP.NRDOCUMENTO  = '033717'
;

prompt
prompt Creating view V_TI_TIT_APB_CTBL
prompt ===============================
prompt
create or replace force view ems506unicoo.v_ti_tit_apb_ctbl as
select -- Josias 01-07-2014 - ajustes necessários
       distinct
       cod_cta_ctbl,
       sysdate dat_processamento,
       case
          when tmt.cod_estab  = '$T' then
              (select dd.cod_estab from ti_estabelecimento dd where dd.cddivisao = ci.cddivisao) --TRATA A DIVISAO DO TITULO
       else
          tmt.cod_estab
       end cod_estab,
       tmt.cod_tip_fluxo_financ cod_tip_fluxo_financ,
       f_ti_parametro_integracao('COD_ID_FEDER') cod_unid_federac,

       case when f_ti_parametro_integracao('INTEGRA_VALOR_LIQUIDO_TIT_APB') = 'S' then
             nvl(tp.vlbruto,tp.vltitulo) - (nvl(tp.vldesconto,0)
                                             +
                                            nvl(tp.vlabatimento,0)
                                             +
                                            nvl(tp.vlabatimento_2,0))
       else
            case when tmt.Cdmovimento in (f_ti_parametro_integracao('HISTORICO_COM_VALOR_LIQUIDO_APB'))  then
                 nvl(tp.vlbruto,tp.vltitulo) - (nvl(tp.vldesconto,0)
                                                +
                                                nvl(tp.vlabatimento,0)
                                                +
                                                nvl(tp.vlabatimento_2,0))
            else
                nvl(tp.vlbruto,tp.vltitulo)
            end
       end val_aprop_ctbl,

       ci.nrsequencial nrseq_controle_integracao,
       case
         when tmt.cod_ccusto = '$T'  then nvl(to_char(tp.cdcentro_custo),' ')
       else
           nvl(tmt.cod_ccusto,' ')
       end cod_ccusto,
       'RC' cdsituacao,
       tp.nrregistro_titulo,
       tp.cdcentro_custo,
       tmt.cod_ccusto tipo_ccusto
  from titulo_a_pagar tp,
       pessoa ps,
       ti_tipo_movimento_tit_apb tmt,
       ti_controle_integracao ci,
       PRODUCAO.fornecedor@UNICOO_HOMOLOGA ufn,
       fornecedor  efn,
       ti_pessoa  tip
 where ufn.cdfornecedor    = tp.cdfornecedor
   and tip.nrregistro      = ufn.nrregistro_fornecedor
   and efn.cdn_fornecedor  = tip.cdn_fornecedor
   and ufn.cdfornecedor    = tp.cdfornecedor
  and tmt.nrsequencial=f_ti_tip_movto_tit_apb(ci.cdempresa,
                                              ci.cdmodulo,
                                              ci.cdmovimento,
                                              efn.cod_grp_fornec,
                                              ci.cddivisao,
                                              ci.cdcentro_custo
                                              )
  and ps.nrregistro=ufn.nrregistro_fornecedor
  and ci.nrsequencial_origem=tp.nrregistro_titulo
  and ci.tpintegracao='TP'
  and ci.cdsituacao <> 'RE'
  and tip.cdn_fornecedor is not null
  --and not exists (select 1 from ti_titulo_apb_nao_migra xx where xx.nrregistro_titulo = tp.nrregistro_titulo)
;

prompt
prompt Creating function F_TI_IMPOSTO_AGRUPADO
prompt =======================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_IMPOSTO_AGRUPADO" (pcdtaxa varchar2,
pnrregistro_titulo number )return varchar2
is
/*
 josias - 01-07-2014 - atualizações necessárias
*/

  vResult varchar2(6);
  vCount number;
  vCount_taxas number;
  vCdTaxa_agrupamento varchar2(6);
begin
      begin
          select distinct
                 trim(cod_taxa_agrupamento)
            into vCdTaxa_agrupamento
            from TI_taxa_a_pagar ttp
           where ttp.cod_taxa = pcdtaxa;

          select count(*)
            into vCount
            from ti_taxa_a_pagar tp
           where tp.cod_taxa_agrupamento=vCdTaxa_agrupamento;

          if vcount > 0 then -- Possui taxa de agrupamento
            select count(*)
              into vCount_taxas
              from taxa_titulo_a_pagar ttp,
                   ti_taxa_a_pagar tp
             where nrregistro_titulo=pnrregistro_titulo
               and tp.cod_taxa=ttp.cdtaxa
               and tp.cod_taxa_agrupamento is not null;

            if vCount = vCount_taxas then
               vResult := vCDtaxa_agrupamento;
            else
               vResult := pcdtaxa;
            end if;
          else
               vResult := pcdtaxa;
          end if;
      exception
           when others then
               vResult := pcdtaxa;
      end;
   return vresult;
end;
/

prompt
prompt Creating view V_TI_TIT_APB_IMPOSTO
prompt ==================================
prompt
create or replace force view ems506unicoo.v_ti_tit_apb_imposto as
select   vi.cod_ser_docto,
         vi.ind_clas_impto,
         vi.val_impto_ja_recolhid,
         vi.val_outras_deduc_impto,
         vi.cod_titulo_ap,
         vi.val_rendto_tribut,
         vi.val_aliq_impto,
         vi.val_deduc_faixa_imto,
         vi.cod_estab,
         vi.cod_espec_docto,
         vi.cod_parcela,
         vi.cod_unid_federac,
         vi.cod_imposto,
         vi.cod_classif_impto,
         vi.val_deduc_inss,
         ----
         sum(vi.val_deduc_depend) val_deduc_depend,
         sum(vi.val_deduc_pensao) val_deduc_pensao,
         sum(vi.val_deduc_outras_deduc) val_deduc_outras_deduc,
         sum(vi.val_base_liq_impto) val_base_liq_impto,
         sum(vi.val_imposto) val_imposto,
         ----------
         vi.dat_vencto,
         vi.des_text_histor,
         vi.dat_processamento,
         vi.cdsituacao,
         vi.val_deduc_faixa_impto,
         vi.cod_cta_ctbl cod_cta_ctbl,
         vi.nrseq_controle_integracao,
         vi.cod_plano_ctb_cbtl,
         vi.ind_ocorrencia,
         vi.cod_tip_fluxo_financ
  from --impto_vincul_fornec ipf , Braz 05/01/2015
       (select distinct
               substr(nvl(trim(cod_ser_docto),ttp.cdtaxa),1,3) cod_ser_docto,
               nvl(trim(f_ti_imposto_agrupado(ind_clas_impto,ttp.nrregistro_titulo)),ttp.cdtaxa) ind_clas_impto,
               0 val_impto_ja_recolhid,
               0 val_outras_deduc_impto,
               tp.nrdocumento cod_titulo_ap,
               0 val_rendto_tribut,
               0 val_aliq_impto,
               0 val_deduc_faixa_imto,
               case
                   when cod_estab = '$T' then
                      (select dd.cod_estab from ti_estabelecimento dd where dd.cddivisao = ti.cddivisao) --TRATA A DIVISAO DO TITULO
                   else
                        tpe.cod_estab
                end cod_estab,

                TPE.cod_espec_docto,
               ' ' cod_parcela,
               nvl(tpm.cod_unid_federac,' ') cod_unid_federac,
               --f_ti_imposto_agrupado(tpm.cod_taxa , ttp.nrregistro_titulo) cod_imposto, -- Alessandro 01/09/2014
               nvl(trim(f_ti_imposto_agrupado(tpm.cod_imposto , ttp.nrregistro_titulo)),substr(ttp.cdtaxa,1,5)) cod_imposto,
               nvl(trim(f_ti_imposto_agrupado(tpm.cod_classif_impto,ttp.nrregistro_titulo)),substr(ttp.cdtaxa,1,5)) cod_classif_impto,
               0 val_deduc_inss,
               (nvl(ttp.vldeducao_dependente,0)) val_deduc_depend,
               (nvl(ttp.vldeducao_pensao,0)) val_deduc_pensao,
               (nvl(ttp.vldeducao_outras,0)) val_deduc_outras_deduc,
               (nvl(ttp.vlbase_imposto,0)) val_base_liq_impto,
               (ttp.vltaxa) val_imposto,

               case when nvl(ttp.dtvencimento,tti.dtvencimento) > tti.dtvencimento then
                    nvl(ttp.dtvencimento,tti.dtvencimento)
               else
                    tti.dtvencimento
               end dtvencimento,

               tti.dtvencimento dat_vencto,
               ' ' des_text_histor,
               sysdate dat_processamento,
               'RC' cdsituacao,
               0 val_deduc_faixa_impto,
               tpm.cod_cta_ctbl cod_cta_ctbl,
               ti.nrsequencial nrseq_controle_integracao,
               cod_plano_ctb_cbtl,
               0 ind_ocorrencia,
               tpm.cod_tip_fluxo_financ,
               efn.cdn_fornecedor
         from titulo_a_pagar            tp,
              pessoa                    p,
              Ti_Tipo_Movimento_Tit_Apb tpe,
              ti_controle_integracao    ti,
              taxa_titulo_a_pagar       ttp,
              ti_taxa_a_pagar           tpm,
              titulo_a_pagar            tti,
              producao.fornecedor@unicoo_homologa ufn,
              fornecedor                efn,
              ti_pessoa                 tip
        where efn.cdn_fornecedor = tip.cdn_fornecedor
            and tip.nrregistro   = ufn.nrregistro_fornecedor
            and tpe.nrsequencial = f_ti_tip_movto_tit_apb(ti.cdempresa,
                                                          ti.cdmodulo,
                                                          ti.cdmovimento,
                                                          efn.cod_grp_fornec,
                                                          ti.cddivisao,
                                                          ti.cdcentro_custo )
            and tti.nrregistro_titulo     = ttp.nrregistro_titulo_taxa
            and tpm.cod_taxa(+)              = ttp.cdtaxa
            and tp.nrregistro_titulo      = ttp.nrregistro_titulo
            and ti.nrsequencial_origem    = tp.nrregistro_titulo
            and ufn.nrregistro_fornecedor = p.nrregistro
            and ti.tpintegracao           = 'TP'
            and ti.cdsituacao             <> 'RE'
            and nvl(tpm.aointegraimposto,'S') = 'S'
--            and tp.nrregistro_titulo          = 617055
            and ufn.cdfornecedor               = tp.cdfornecedor ) vi
--          and not exists (select 1 from ti_titulo_apb_nao_migra xx where xx.nrregistro_titulo = tp.nrregistro_titulo)
/*
 where ipf.cdn_fornecedor    = vi.cdn_fornecedor --Braz 05/01/2015 para obrigar impostos vinculados
   and ipf.cod_imposto       = vi.cod_imposto
   and ipf.cod_classif_impto = vi.cod_classif_impto*/
 group by vi.cod_ser_docto,
          vi.ind_clas_impto,
          vi.val_impto_ja_recolhid,
          vi.val_outras_deduc_impto,
          vi.cod_titulo_ap,
          vi.val_rendto_tribut,
          vi.val_aliq_impto,
          vi.val_deduc_faixa_imto,
          vi.cod_estab,
          vi.cod_espec_docto,
          vi.cod_parcela,
          vi.cod_unid_federac,
          vi.cod_imposto,
          vi.cod_classif_impto,
          vi.val_deduc_inss,
          vi.dat_vencto,
          vi.des_text_histor,
          vi.dat_processamento,
          vi.cdsituacao,
          vi.val_deduc_faixa_impto,
          vi.cod_cta_ctbl,
          vi.nrseq_controle_integracao,
          vi.cod_plano_ctb_cbtl,
          vi.ind_ocorrencia,
          vi.cod_tip_fluxo_financ
;

prompt
prompt Creating view V_TI_TIT_APB_IMPOSTO_MONITOR
prompt ==========================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TI_TIT_APB_IMPOSTO_MONITOR AS
SELECT  -- Josias 01-07-2014 - ajustes necessários
               COD_ESTAB ESTABELECIMENTO,
               DECODE(V.CDSITUACAO,
              'IT',
              '[IT] INTEGRADO',
              'ER',
              '[ER] ERRO',
              'CA',
              '[CA] CANCELADO',
              'RE',
              '[RE] REPROCESSAR',
              'RC',
              '[RC] RECEBIDO',
              'PE',
              '[PE] PENDENTE',
              'GE',
              '[GE] GERADO',
              V.CDSITUACAO) SITUACAO,
        COD_IMPOSTO IMPOSTO,
        COD_CLASSIF_IMPTO CLASSIF,
        COD_SER_DOCTO SERIE,
        COD_TITULO_AP NRDOCUMENTO,
        VAL_IMPTO_JA_RECOLHID VALOR_JA_RECOLHIDO,
        VAL_OUTRAS_DEDUC_IMPTO VALOR_OUTROS,
        VAL_RENDTO_TRIBUT      VALOR_REND_TRIB,
        VAL_ALIQ_IMPTO         VALOR_ALIQ,
--        VAL_DEDUC_FAIXA_IMTO   VALOR_DED_FAIXA,
        COD_ESPEC_DOCTO ESPECIE_DOC,
        COD_PARCELA PARCELA,
        COD_UNID_FEDERAC ESTADO,
        VAL_DEDUC_INSS   VALOR_DED_INSS,
        VAL_DEDUC_DEPEND VALOR_DED_DEP,
        VAL_DEDUC_PENSAO VALOR_DED_PENSAO,
        VAL_DEDUC_OUTRAS_DEDUC VALOR_DED_DEMAIS,
        VAL_BASE_LIQ_IMPTO VALOR_BASE_IMP_LQDO,
        VAL_DEDUC_FAIXA_IMPTO VALOR_DED_FAIXA,
        VAL_IMPOSTO        VALOR,
        DAT_VENCTO         VENCIMENTO,
        DES_TEXT_HISTOR    HISTORICO,
        DAT_PROCESSAMENTO  PROCESSAMENTO,
        COD_CTA_CTBL CONTA,
        COD_PLANO_CTB_CBTL PLANO,
        IND_OCORRENCIA OCORRENCIA,
        COD_TIP_FLUXO_FINANC FLUXO_FINANCEIRO,
        NRSEQ_CONTROLE_INTEGRACAO
FROM TI_TIT_APB_IMPOSTO V
;

prompt
prompt Creating view V_TI_TIT_APB_MONITOR
prompt ==================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TI_TIT_APB_MONITOR AS
SELECT -- Josias 01-07-2014 - ajustes necessários
       A.NRPESSOA REGISTRO,
       NVL((SELECT '[' || T.CDFORNECEDOR || '] ' || V.NOPESSOA
             FROM V_FORNECEDOR V, TITULO_A_PAGAR T
            WHERE V.CDFORNECEDOR = T.CDFORNECEDOR
              AND T.NRREGISTRO_TITULO = A.NRREGISTRO_TITULO),
           NVL((SELECT 'FOR/TIT NÃO ENCONTRADO P/ REG.[' || P.NRREGISTRO || '] ' ||
                      P.NOPESSOA
                 FROM PESSOA P
                WHERE P.NRREGISTRO = A.NRPESSOA),
               '##REGISTRO DA PESSOA NÃO ENCONTRADO##')) FORNECEDOR,
       (SELECT P.NRCGC_CPF FROM PESSOA P WHERE P.NRREGISTRO = A.NRPESSOA) CGC_CPF,
       DECODE(A.CDSITUACAO,
              'IT',
              '[IT] INTEGRADO',
              'ER',
              '[ER] ERRO',
              'CA',
              '[CA] CANCELADO',
              'RE',
              '[RE] REPROCESSAR',
              'RC',
              '[RC] RECEBIDO',
              'PE',
              '[PE] PENDENTE',
              'GE',
              '[GE] GERADO',
              A.CDSITUACAO) SITUACAO,
       B.NRDOCUMENTO,
       A.DAT_EMISSAO EMISSAO,
       A.DAT_VENCTO VENCTO,
       A.VAL_TITULO VALOR,
       A.COD_ESTAB ESTAB,
       A.COD_ESPEC_DOCTO ESPECIE,
       A.COD_SER_DOCTO SERIE,
       A.COD_CCUSTO CCUSTO,
       A.COD_PARCELA PARCELA,
       (SELECT '[' || CP.CDHISTORICO || '] ' || CP.NOHISTORICO
          FROM V_CODIGO_DE_HISTORICO_CP CP
         WHERE CP.CDEMPRESA = B.CDEMPRESA
           AND CP.CDHISTORICO = B.CDHISTORICO) HISTORICO,
       A.NRSEQ_CONTROLE_INTEGRACAO

  FROM TI_TIT_APB A, TITULO_A_PAGAR B
 WHERE A.NRREGISTRO_TITULO = B.NRREGISTRO_TITULO(+)
;

prompt
prompt Creating view V_TIT_APB_DESM
prompt ============================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TIT_APB_DESM AS
SELECT tci."NRSEQUENCIAL",tci."TPINTEGRACAO",tci."DTGERACAO",tci."NRSEQUENCIAL_ORIGEM",tci."DTPROCESSAMENTO",tci."DTINTEGRACAO",tci."CDACAO",tci."CDIDENTIFICADOR",tci."TXOBSERVACAO",tci."CDSITUACAO",tci."NRSEQ_CONTROLE_INTEGRACAO_ORG",tci."CDEMPRESA",tci."CDMODULO",tci."CDMOVIMENTO",tci."NRSESSAO",tci."CDDIVISAO",tci."CDCENTRO_CUSTO",tci."TPDOCUMENTO"
  FROM TI_CONTROLE_INTEGRACAO TCI, TI_TIT_APB TP, TIT_AP TAP
 WHERE TP.COD_ESTAB = TAP.COD_ESTAB
   AND TP.COD_ESPEC_DOCTO = TAP.COD_ESPEC_DOCTO
   AND TP.COD_TITULO_AP = TAP.COD_TIT_AP
   AND TP.VAL_TITULO = TAP.VAL_ORIGIN_TIT_AP
   AND TP.COD_PARCELA = TAP.COD_PARCELA
   AND EXISTS
 (SELECT NRREGISTRO_TIT_DESM, NRDOCUMENTO, DTTITULO, DTVENCIMENTO
          FROM TITULO_A_PAGAR P
         WHERE NRREGISTRO_TIT_DESM IS NOT NULL
           AND DTTITULO >= '01/10/2014'
           AND TCI.NRSEQUENCIAL_ORIGEM = P.NRREGISTRO_TITULO
           AND TCI.CDIDENTIFICADOR = P.NRDOCUMENTO)
   AND TCI.CDSITUACAO = 'IT'
   AND TCI.NRSEQUENCIAL = TP.NRSEQ_CONTROLE_INTEGRACAO
   AND  EXISTS (SELECT COUNT(*)
          FROM MOVTO_TIT_AP M
         WHERE M.NUM_ID_TIT_AP = TAP.NUM_ID_TIT_AP
           HAVING COUNT(*) = 1)
 ORDER BY TCI.CDEMPRESA, TP.COD_TITULO_AP;

prompt
prompt Creating view V_TIT_APB_DESM_MOV
prompt ================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TIT_APB_DESM_MOV AS
SELECT tci."NRSEQUENCIAL",tci."TPINTEGRACAO",tci."DTGERACAO",tci."NRSEQUENCIAL_ORIGEM",tci."DTPROCESSAMENTO",tci."DTINTEGRACAO",tci."CDACAO",tci."CDIDENTIFICADOR",tci."TXOBSERVACAO",tci."CDSITUACAO",tci."NRSEQ_CONTROLE_INTEGRACAO_ORG",tci."CDEMPRESA",tci."CDMODULO",tci."CDMOVIMENTO",tci."NRSESSAO",tci."CDDIVISAO",tci."CDCENTRO_CUSTO",tci."TPDOCUMENTO"
  FROM TI_CONTROLE_INTEGRACAO TCI, TI_TIT_APB TP, TIT_AP TAP
 WHERE TP.COD_ESTAB = TAP.COD_ESTAB
   AND TP.COD_ESPEC_DOCTO = TAP.COD_ESPEC_DOCTO
   AND TP.COD_TITULO_AP = TAP.COD_TIT_AP
   AND TP.VAL_TITULO = TAP.VAL_ORIGIN_TIT_AP
   AND TP.COD_PARCELA = TAP.COD_PARCELA
   AND EXISTS
 (SELECT NRREGISTRO_TIT_DESM, NRDOCUMENTO, DTTITULO, DTVENCIMENTO
          FROM TITULO_A_PAGAR P
         WHERE NRREGISTRO_TIT_DESM IS NOT NULL
           AND DTTITULO >= '01/10/2014'
           AND TCI.NRSEQUENCIAL_ORIGEM = P.NRREGISTRO_TITULO
           AND TCI.CDIDENTIFICADOR = P.NRDOCUMENTO)
   AND TCI.CDSITUACAO = 'IT'
   AND TCI.NRSEQUENCIAL = TP.NRSEQ_CONTROLE_INTEGRACAO
   AND EXISTS (SELECT COUNT(*)
          FROM MOVTO_TIT_AP M
         WHERE M.NUM_ID_TIT_AP = TAP.NUM_ID_TIT_AP
           HAVING COUNT(*) > 1)
 ORDER BY TCI.CDEMPRESA, TP.COD_TITULO_AP;

prompt
prompt Creating view V_TITULO_FECHADO_ACR_INF
prompt ======================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TITULO_FECHADO_ACR_INF AS
SELECT DISTINCT '"'|| TMT.COD_EMPRESA ||'"'||' ' ||--TMT.COD_EMPRESA COD_EMPRES_ORIG, 10
                '"'||TMT.COD_ESTAB||'"'||' '||--COD_ESTAB_ORIG, 20
                '"'|| TMT.COD_ESPEC_DOCTO||'"'|| ' ' -- COD_ESPEC_DOCTO_ORIG, 30
                 ||'"'||
                CASE
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' THEN
                   SUBSTR(NRDOCUMENTO, 1, 10)
                  WHEN TR.NRDOCUMENTO LIKE '%-%' THEN
                   SUBSTR(NRDOCUMENTO, INSTR(NRDOCUMENTO, '-') + 1, 10)
                  ELSE
                   SUBSTR(NRDOCUMENTO, INSTR(NRDOCUMENTO, '-') + 1, 10)
                END ||'"'||' '|| -- COD_TITULO_ACR,
                '"'||
                CASE
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' AND
                       LENGTH(TR.NRDOCUMENTO) > 10 THEN
                   CASE
                     WHEN TMT.CDMODULO <> 'FT' AND NVL(TR.NRPARCELA, 0) > 0 THEN
                      LPAD(TR.NRPARCELA, 2, '0')
                     ELSE
                      SUBSTR(NRDOCUMENTO, 11, 2)
                   END
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' AND
                       LENGTH(TR.NRDOCUMENTO) <= 10 THEN
                   CASE
                     WHEN TMT.CDMODULO <> 'FT' AND NVL(TR.NRPARCELA, 0) > 0 THEN
                      LPAD(TR.NRPARCELA, 2, '0')
                     ELSE
                      null
                   END
                  WHEN TR.CDSITUACAO = '2' THEN
                   'P'
                  ELSE
                   '0'
                END ||'"'||' '||--COD_PARCELA,
                TIP.CDN_CLIENTE||' '||'"'||-- CDN_CLIEN_ORIG,
                TMT.COD_PORTADOR||'"'||' '||-- COD_PORTAD_ORIG,
                TMT.COD_CART_BCIA ||' '||-- COD_CART_BCIA_ORIG,
                TR.DTTITULO ||' '||--DAT_EMIS_DOCTO,
                TR.DTVENCIMENTO||' '||--TR.DTVENCIMENTO DAT_VENCTO,
                CASE
                  WHEN TR.CDSITUACAO = '2' THEN
                   TR.VLTITULO
                  ELSE
                   CASE
                     WHEN TMT.COD_ESTAB = '02' THEN
                      TR.VLTITULO
                     ELSE
                      TR.VLTITULO + NVL(F_TI_IR_ACR(TR.NRREGISTRO_TITULO), 0)
                   END
                END ||' '||--VAL_ORIGIN_TIT_ACR,
                0 ||' '||--, --VERIFICAR DOUGLAS
                F_SALDO_TITULO_RECEBER(TR.NRREGISTRO_TITULO) ||' '||--VAL_SDO_TIT_ACR,
               '"'|| NULL||'"'||' '||--DAT_DESCONTO,
                0 ||' '||--VAL_DESC_TIT_ACR,
               '"'|| CASE
                  WHEN TR.CDPORTADOR = '033' THEN
                   NVL(SUBSTR(TR.NRNOSSONUMERO, -8, 8), ' ')
                  WHEN LENGTH(TR.NRNOSSONUMERO) = 10 THEN
                   NVL(LPAD(TR.NRNOSSONUMERO, 12, '0'), ' ')
                  WHEN LENGTH(TR.NRNOSSONUMERO) = 8 THEN
                   NVL(LPAD(TR.NRNOSSONUMERO, 12, '0'), ' ')
                  ELSE
                   NVL(TR.NRNOSSONUMERO, ' ')
                END ||'"'||' '||--COD_TIT_ACR_BCO,
                '"'||TMT.COD_CTA_CTBL||'"'||' '||-- COD_CTA_CTBL_CR,
                '"'||TMT.COD_CCUSTO||'"'||' '||-- COD_CCUSTO_CR,
                NVL(TR.DTULTIMO_RECEBIMENTO,TRUNC(SYSDATE))||' '||--dat_ult_pagto
                'no' ||' '||--LOG_ESPEC_DOCTO_CTBZ, --verificar douglas Especie Documento Co
                '"'||'' ||'"'||' '||-- COD_PED_VDA, --Pedido Venda
                '"'||'' ||'"'||' '||-- COD_NATUR_OPERAC, --verificar douglas Natureza Operação
                'no' ||' '||-- LOG_EMIS_BORD, --verificar douglas Emite Borderô
                '"'||'' ||'"'||' '||--COD_REFER, --referencia verificar para nao repetir com os de titulos abertos
                '"'||'' ||'"'||' '||-- IDI_ORIG, --Origem ?
                '"'||'' ||'"'||' '||-- COD_COND_PAGTO, --verificar douglas condição pagamento
                '0'||' '||-- COD_INDIC_ECON_ORIG,
                'no' ||' '||-- LOG_EMITE_DUPL, --verificar douglas Emite Duplicata
                '"'||'' ||'"'||' '||-- COD_ESPEC_DOCTO_ANTECIP, --verificar douglas Espécie Antecipação
                '"'||'' ||'"'||' '||-- COD_DOCTO_ANTECIP, -- verificar douglas Documento Antecipaca
                '"'||'' ||'"'||' '||-- COD_PARC_ANTECIP, --verificar douglas parcela antecipacao
                0 ||' '||-- NUM_BORD_ACR, --verificar borderô
                '"'||'Normal' ||'"'||' '||-- IND_TIP_ESPEC_DOCTO, --verificar douglas tipo espécie
                TR.DTVENCIMENTO ||' '||--DAT_PREV_PAGTO,
               0 ||' '||-- VAL_PERC_DESC_ANTECIP, --perc Descto Antecip
                ROUND(TO_NUMBER((TR.VLJUROS * 100 / (TR.VLTITULO))), 2)||' '||-- VAL_PERC_JUROS_ACR,
                'no' ||' '||-- LOG_EMITE_ETIQ,
                'no' ||' '||-- LOG_EMITE_AVISO_LANCTO,
                TR.DTULTIMO_RECEBIMENTO||' '||-- DAT_ABAT_TIT_ACR,
                TR.VLABATIMENTO ||' '||--VAL_ABAT_TIT_ACR,
                '"'||'ems506unicoo' ||'"'||' '||--COD_USUARIO,
                '"'||'' ||'"'||' '||-- COD_PED_CLIEN,
                '"'||'Normal' ||'"'||' '||-- IDI_SIT, --verificar douglas
                'yes' ||' '||--LOG_EMIS_BOLETO,
                1 ||' '||--COD_REPRES_VENDAS, --verificar douglas
                '"'||'' ||'"'||' '||-- IDI_VENCTO, --verificar douglas
                0 ||' '||-- VAL_ABAT_FASB, --verificar douglas Abatimento Fasb
                0 ||' '||-- VAL_DESC_FASB, --verificar douglas Desconto Fasb
                0 ||' '||-- VAL_LIQ_FASB, --verificar douglas Liquido Fasb
                0 ||' '||-- VAL_ORIGIN_FASB, --verificar douglas Original Fasb
                0 ||' '||-- VAL_SDO_FASB, --verificar douglas Saldo Fasb
                TR.VLFATURADO ||' '||-- VAL_FATUR_ACR,
                TR.DTENVIO_BANCO||' '||--  DAT_DESTINAC_COBR, --verificar
                TR.DTCONFIRMA_BANCO||' '||--  DAT_CONFIR,
                '"'||'Enviado ao Banco' ||'"'||' '||-- IDI_FORMA_COBR, --verificar douglas  Forma Cobranca
                TR.DTULTIMO_ENVIO ||' '||-- DAT_ULT_COBR,
                '"'||'' ||'"'||' '||-- COD_AGENC_BCIA,
                '"'||'' ||'"'||' '||-- COD_INSTRUC_BCIA, -- verificar douglas
                'yes' ||' '||-- LOG_ENVDO_EDI, --verificar douglas
                TMT.COD_PORTADOR||'"'||' ' ||'"'||--COD_PORTAD_BXA_ORIG,
                TMT.COD_CART_BCIA||'"'||' '||--COD_CART_BCIA_BXA_ORIG,
                NULL||' '||-- DAT_FLUXO_CX,
                0 ||' '||-- NUM_FLUXO_CX,
                0 ||' '||-- CDN_CLIEN_MATRIZ,
                'no' ||' '||-- LOG_CALC_FASB,
                'no' ||' '||-- LOG_CALC_CMCAC,
                0 ||' '||-- VAL_COTAC_FASB_EMIS,
                0 ||' '||-- VAL_COTAC_FASB_VENCTO,
                0 ||' '||-- VAL_COTAC_CM_EMIS,
                0 ||' '||-- VAL_COTAC_ANBID_EMIS,
                'no' ||' '||-- LOG_CARTA_COBR,
                '"'||NVL(TMT.COD_TIP_FLUXO_FINANC_EMS2, TMT.COD_TIP_FLUXO_FINANC)||'"'||' '||-- COD_TIP_FLUXO_FINANC,
                'no' ||' '||-- LOG_DUPL_VENDOR_CONFDO,
                '"'||'' ||'"'||' '||-- COD_OCOR_BCIA_BCO,
                '"'||'' ||'"'||' '||-- COD_COND_PAGTO_PADR,
                '"'||'' ||'"'||' '||-- COD_OPERAC_FINANC,
                NULL ||' '||-- DAT_PREVIS,
                '"'||'' ||'"'||' '||-- NOM_ARQ_MOVIMEN_BCIA,
                '"'||'Normal' ||'"'||' '||-- IDI_SIT_TIT_ACR, --VERIFICAR DOUGLAS
                0 ||' '||-- QTD_DIAS_CARENC_JUROS_ACR,
                TR.DTVENCIMENTO ||' '||--DAT_VENCTO_ORIGIN_TIT_ACR,
                TR.DTENVIO_BANCO ||' '||--DAT_ENVIO,
                '"'||TMT.COD_CART_BCIA||'"'||' '||-- COD_CART_BCIA_TIT_ORIGIN,
                '"'||'Interno' ||'"'||' '||-- LOG_DESTINAC_COBR,
                'no' ||' '||-- IDI_MERC,
                TR.VLRECEBIDO||' '||-- VAL_PAGTO,
                TR.DTULTIMO_RECEBIMENTO ||' '||--DAT_LIQUIDAC_TIT_ACR,
                '"'||   CASE
                  WHEN TMT.CDMODULO = 'FT' AND TR.NRDOCUMENTO LIKE '%-%' THEN
                   TMT.CDMOVIMENTO
                  ELSE
                   ' '
                END ||'"'||' '||--COD_SER_DOCTO_ORIG,
                '"'||'' ||'"'||' '||-- COD_SER_DOCTO_ANTECIP,
                0 ||' '||-- VAL_DESPES_BCIA,
                0 ||' '||-- NUM_ID_TIT_ACR,
                0 ||' '||-- VAL_COTAC_INDIC_ECON,
                0 ||' '||-- VAL_OUTROS_VALORES,
                0 ||' '||-- VAL_FRETE,
                '"'||'' ||'"'||' '||-- DES_OBS,
                0 ||' '||-- NUM_SEQ,
                0 ||' '||-- VAL_ORIGIN_MOED_ESTRANG,
                0 ||' '||-- VAL_LIQ_MOED_ESTRANG,
                0 ||' '||-- VAL_SDO_MOED_ESTRANG,
                0 ||' '||-- VAL_DESC_MOED_ESTRANG,
                0 ||' '||-- VAL_ABAT_MOED_ESTRANG,
                0 ||' '||-- VAL_OUTROS_MOED_ESTRANG,
                0 ||' '||-- VAL_FRETE_MOED_ESTRANG,
                0 ||' '||-- VAL_FATUR_ACR_MOED_ESTRANG,
                '"'||'' ||'"'||' '||-- COD_DOCTO,
                '"'||'' ||'"'||' '||-- COD_IMPTO_RETID,
                TR.VLMULTA ||' '||--VAL_MULTA,
                0 ||' '||-- VAL_MULTA_MOED_ESTRANG,
                TR.DTULTIMO_RECEBIMENTO||' '||-- DAT_MULTA,
                ROUND(TO_NUMBER((TR.VLJUROS * 100 / (TR.VLTITULO))), 2)||' '||-- VAL_PERC_MULTA_ACR,
                '"'||'' ||'"'||' '||-- COD_ENDER_ENTREG,
                'no' ||' '||-- LOG_COBR_CARTOR,
                'no' ||' '||-- LOG_AVISO_DB_EMITID,
                0 ||' '||-- VAL_OUTRAS_DESPES,
                '"'||'' ||'"'||' '||-- COD_PROCES_EXPORT,
                'no' ||' '||-- LOG_CONTRAT_CAMBIO,
                '"'||'' ||'"'||' '||-- COD_UNID_NEGOC, --verificar douglas
                0 ||' '||-- VAL_COFINS,
                0 ||' '||-- VAL_PIS,
                0 ||' '||-- VAL_CSLL,
                'no' ||' '||-- LOG_RETENC_IMPTO,
                0 ||' '||-- VAL_BASE_CALC_IMPTO,
                '"'||'' ||'"'||' '||-- COD_LIVRE_1,
                '"'||'' ||'"'||' '||-- COD_LIVRE_2,
                'no' ||' '||-- LOG_LIVRE_1,
                'no' ||' '||-- LOG_LIVRE_2,
                0 ||' '||-- NUM_LIVRE_1,
                0 ||' '||-- NUM_LIVRE_2,
                0 ||' '||-- VAL_LIVRE_1,
                0 ||' '||-- VAL_LIVRE_2,
                NULL ||' '||--DAT_LIVRE_1,
                NULL REGISTRO,
                TR.NRREGISTRO_TITULO
  FROM TITULO_A_RECEBER                 TR,
       PESSOA                           PS,
       TI_TIPO_MOVIMENTO_TIT_ACR        TMT,
       PRODUCAO.CLIENTE@UNICOO_HOMOLOGA UCL,
       EMS5.CLIENTE                     ECL,
       TI_PESSOA                        TIP,
       TI_EMPRESA                       EMP
 WHERE ECL.CDN_CLIENTE = TIP.CDN_CLIENTE
   AND TIP.NRREGISTRO = UCL.NRREGISTRO_CLIENTE
   AND UCL.CDCLIENTE = TR.CDCLIENTE
   AND TMT.NRSEQUENCIAL =
       F_TI_TIP_MOVTO_TIT_ACR(TR.CDEMPRESA,
                              DECODE(TR.TPDOCUMENTO, 'FAT', 'FT', 'CR'),
                              DECODE(DECODE(TR.TPDOCUMENTO,
                                            'FAT',
                                            'FT',
                                            'CR'),
                                     'CR',
                                     TR.CDHISTORICO,
                                     SUBSTR(TR.NRDOCUMENTO, 0, 2)),
                              NVL(ECL.COD_GRP_CLIEN, TMT.COD_GRP_CLIEN))
   AND PS.NRREGISTRO = UCL.NRREGISTRO_CLIENTE
   AND EMP.CDEMPRESA = TR.CDEMPRESA
   AND NVL(ECL.COD_EMPRESA, F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')) =
       EMP.COD_EMPRESA
;

prompt
prompt Creating view V_TITULO_FECHADO_ACR_MOV
prompt ======================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TITULO_FECHADO_ACR_MOV AS
SELECT DISTINCT
               '"'|| TMT.COD_EMPRESA ||'"'||' ' ||--cod_empres_orig
               '"'||TMT.COD_ESTAB||'"'||' '||-- cod_estab_orig
               '"'|| TMT.COD_ESPEC_DOCTO||'"'|| ' ' --cod_espec_docto_orig
               ||'"'||
               CASE
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' THEN
                   SUBSTR(TR.NRDOCUMENTO, 1, 10)
                  WHEN TR.NRDOCUMENTO LIKE '%-%' THEN
                   SUBSTR(TR.NRDOCUMENTO, INSTR(TR.NRDOCUMENTO, '-') + 1, 10)
                  ELSE
                   SUBSTR(TR.NRDOCUMENTO, INSTR(TR.NRDOCUMENTO, '-') + 1, 10)
                END ||'"'||' '|| --cod_tit_acr
                '"'||
                CASE
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' AND
                       LENGTH(TR.NRDOCUMENTO) > 10 THEN
                   CASE
                     WHEN TMT.CDMODULO <> 'FT' AND NVL(TR.NRPARCELA, 0) > 0 THEN
                      LPAD(TR.NRPARCELA, 2, '0')
                     ELSE
                      SUBSTR(TR.NRDOCUMENTO, 11, 2)
                   END
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' AND
                       LENGTH(TR.NRDOCUMENTO) <= 10 THEN
                   CASE
                     WHEN TMT.CDMODULO <> 'FT' AND NVL(TR.NRPARCELA, 0) > 0 THEN
                      LPAD(TR.NRPARCELA, 2, '0')
                     ELSE
                     '0'
                   END
                  WHEN TR.CDSITUACAO = '2' THEN
                   'P'
                  ELSE
                   '0'
                END ||'"'||' '|| --cod_parcela
             (SELECT TM.COD_TRANSACAO FROM TI_TIPO_MOVTO_TIT_ACR_FECHADO TM
             WHERE TM.CDTRANSACAO =  E.CDTRANSACAO) ||' '||--idi_transacao
                TIP.CDN_CLIENTE||' '||--cdn_cliente
                '"'|| TMT.COD_PORTADOR||'"'||' '||--cod_portad_orig
                TMT.COD_CART_BCIA||' '||--cod_cart_bcia_orig
                TR.DTTITULO ||' '||--dat_emis
                TR.DTVENCIMENTO||' '||--dat_vencto_tit_acr
                CASE
                  WHEN TR.CDSITUACAO = '2' THEN
                   TR.VLTITULO
                  ELSE
                   CASE
                     WHEN TMT.COD_ESTAB = '02' THEN
                      TR.VLTITULO
                     ELSE
                      TR.VLTITULO + NVL(F_TI_IR_ACR(TR.NRREGISTRO_TITULO), 0)
                   END
                END ||' '||--val_origin_tit_acr

                CASE
                  WHEN TR.CDSITUACAO = '2' THEN
                   TR.VLTITULO
                  ELSE
                   CASE
                     WHEN TMT.COD_ESTAB = '02' THEN
                      TR.VLTITULO
                     ELSE
                      TR.VLTITULO + NVL(F_TI_IR_ACR(TR.NRREGISTRO_TITULO), 0)
                   END
                END ||' '||--val_liq_tit_acr
                HDT.DTMOVIMENTO ||' '||--dat_cr_movto_tit_acr
                NVL(TR.DTULTIMO_RECEBIMENTO, trunc(sysdate)) ||' '||--dat_pagto
                '31/12/9999' ||' '|| --dat_desconto
                0 ||' '||--val_desc_tit_acr
                TR.VLJUROS ||' '||--val_juros
                 0 ||' '||--val_antecip
                '"'||''||'"'||' '||--cod_refer
                'yes' ||' '||--log_ctbzdo
                'no' ||' ' ||--log_espec_docto_ctbz
                '"'||TMT.COD_CTA_CTBL||'"'||' '||  --cod_cta_ctbl_cr
                '"'||TMT.COD_CCUSTO||'"'||' '||--cod_ccusto_cr
                '"'||''||'"'||' '||--cod_ped_vda
                '"'||''||'"'||' '||--cod_natur_operac
                '0'||' '||-- COD_INDIC_ECON_ORIG,
                '"'||''||'"'||' '||--cod_espec_docto_antecip
                '"'||''||'"'||' '||--cod_docto_antecip
                '"'||''||'"'||' '||--cod_parc_antecip
                HDT.DTMOVIMENTO ||' '||--dat_movto_tit_acr
                '"'||'Normal' ||'"'||' '||--ind_tip_espec_docto
                '31/12/9999'||' '||--dat_abat_tit_acr
                0 ||' '||--val_abat_tit_acr
                'yes' ||' '||--log_envdo_edi
                NULL ||' '||--dat_gerac_bord
                '"'||'' ||'"'||' '||--cod_repres_vendas
                HDT.DTMOVIMENTO ||' '||--dat_transacao
                0||' '|| --    val_abat_fasb
                0||' '|| --    val_antecip_fasb
                0||' '|| --    val_movto_fasb
                0||' '|| --    val_desc_fasb
                0||' '|| --    val_juros_fasb
                0 ||' '|| --   val_liq_fasb
                0||' '|| --    val_origin_fasb
                HDT.VLRECEBIDO ||' '||--val_movto_tit_acr
                0 ||' '||--val_ganho_perda_origin
                0 ||' '||--val_fatory
                0 ||' '||--val_fatorx
                0 ||' '||--val_fatorf
                CASE
                  WHEN UPPER(E.NOTRANSACAO) LIKE '%ESTORN%' THEN
                   'yes'
                  ELSE
                   'no'
                END ||' '||'"'||--log_movto_estorn

                CASE
                  WHEN TR.CDPORTADOR = '033' THEN
                   NVL(SUBSTR(TR.NRNOSSONUMERO, -8, 8), ' ')
                  WHEN LENGTH(TR.NRNOSSONUMERO) = 10 THEN
                   NVL(LPAD(TR.NRNOSSONUMERO, 12, '0'), ' ')
                  WHEN LENGTH(TR.NRNOSSONUMERO) = 8 THEN
                   NVL(LPAD(TR.NRNOSSONUMERO, 12, '0'), ' ')
                  ELSE
                   NVL(TR.NRNOSSONUMERO, ' ')
                END ||'"'||' '||--cod_tit_acr_bco
                'yes' ||' '||--log_confir_movto_envdo_bco
                'yes' ||' '||--log_ctbz_comis
                '"'||'' ||'"'||' '||--cod_docto_bco_pagto
                '"'||'' ||'"'||' '||--cod_docto
                '"'||'' ||'"'||' '||--cod_cta_corren
                '"'||'' ||'"'||' '||--cod_agenc_bcia
                '"'||'' ||'"'||' '||--cod_banco
                2 ||' '||--idi_lancto
                0 ||' '||--val_efeito_maxi
                0 ||' '||--val_acerto_cmcac
                0 ||' '||--val_movto_cmcac
                0 ||' '||--val_antecip_cmcac
                0 ||' '||--val_desc_cmcac
                0 ||' '||--val_juros_cmcac
                0 ||' '||--val_pres
                0 ||' '||--val_impto_icms
                0 ||' '||--val_abat_cmcac
                'no' ||' '||--log_calc_comis
                'no' ||' '||--log_aviso_db_emitid
                00 ||' '||--hra_envio
                '31/12/9999' ||' '||--dat_envio
                '"'||'' ||'"'||' '||--cod_instruc_bcia_bco
                0 ||' '||--val_despes_bcia
                0 ||' '||--cdn_ret_bco
                0 ||' '||--log_tit_subst
                1 ||' '||--idi_sit_tit_acr
                'no' ||' '||--log_selec
                0 ||' '||--val_variac_cm
                case when hdt.cdmovimento = 70 then '2' else '1' end ||' '||--idi_tip_alter
                '"'||'' ||'"'||' '||--nom_arq_movimen_bcia
                '"'||'' ||'"'||' '||--cod_control
                '"'||'' ||'"'||' '||--cod_docto_movto_cta_bco
                 '"'||'ems506unicoo' ||'"'||' '||--cod_usuario
                3   ||' '||--idi_merc
                '"'||'' ||'"'||' '||--cod_indic_econ_moed
                0 ||' '||--idi_orig

             '"'||   CASE
                  WHEN TMT.CDMODULO = 'FT' AND TR.NRDOCUMENTO LIKE '%-%' THEN
                   TMT.CDMOVIMENTO
                  ELSE
                   ' '
                END ||'"'||' '||-- COD_SER_DOCTO_ORIG,
                '"'||'' ||'"'||' '||--COD_SER_DOCTO_ANTECIP,
                '"'||'' ||'"'||' '||-- COD_ESPEC_ADIANT,
                0 ||' '||-- VAL_COTAC_INDIC_ECON,
                0 ||' '||-- VAL_OUTROS_VALORES,
                0 ||' '||-- VAL_FRETE,
                0 ||' '||-- NUM_CHEQUE,
                '"'||'' ||'"'||' '||-- DES_OBS,
                0 ||' '||-- NUM_SEQ,
                0 ||' '||-- VAL_ORIGIN_MOED_ESTRANG, --    Original Moeda Estra
                0 ||' '||-- VAL_LIQ_MOED_ESTRANG, --    Liquido Moeda Estran
                0 ||' '||-- VAL_ANTECIP_MOED_ESTRANG, --    Antecipacao Moeda Es
                0 ||' '||-- VAL_FRETE_MOED_ESTRANG, --    Frete Moeda Estrange
                0 ||' '||-- VAL_OUTROS_MOED_ESTRANG, --    Outros Moeda Estrang
                0 ||' '||-- VAL_PAGTO_MOED_ESTRANG, --    Pagamento Moeda Estr
                0 ||' '||-- VAL_DESC_MOED_ESTRANG, --    Desconto Moeda Estra
                0 ||' '||-- VAL_JUROS_MOED_ESTRANG, --    Juros Moeda Estrange
                0 ||' '||-- VAL_ABAT_MOED_ESTRANG, --    Abatimento Moeda Est
                0 ||' '||-- VAL_DESPES_BCO_MOED_ESTRANG, --    Despesa Banco Moeda
                300 ||' '||-- NUM_ID_MOVTO_TIT_ACR TOKEN,
                0 ||' '||-- VAL_VARIAC_CM_ANTECIP, --    Variacao Correcao mo
                0 ||' '||-- VAL_OUTROS_VALORES_FASB, --    Outros Valores Fasb
                0 ||' '||-- VAL_OUTROS_VALORES_CMCAC, --    Outros Valores Cmcac
                0 ||' '||-- VAL_OUTROS_VALORES_PRES, --    Outros Valores Prese
                0 ||' '||-- VAL_FRETE_FASB, --    Frete Fasb
                0 ||' '||-- VAL_FRETE_CMCAC, --    Frete Cmcac
                0 ||' '||-- VAL_FRETE_PRES, --    Frete Presente
                0 ||' '||-- VAL_IMPTO_OPERAC_FINANC, --    Imposto Operação
                0 ||' '||-- VAL_IMPTO_MOED_ESTRANG, --    Imposto Moeda Estran
                0 ||' '||-- VAL_DESPES_FINANC, --    Valor Despesa Financ
                0 ||' '||-- VAL_DESPES_MOED_ESTRANG, --    Despesa Moeda Estran
                NULL ||' '||-- NUM_ID_TIT_AP_PAI, --    Token
                HDT.VLMULTA ||' '||-- VAL_MULTA,
                0 ||' '||-- VAL_MULTA_MOED_ESTRANG,
                'no' ||' '||-- LOG_BXA_TRANSF,
                0 ||' '||-- VAL_MULTA_FASB, --    Multa Fasb
                0 ||' '||-- VAL_MULTA_CMCAC, --    Multa Cmcac
                0 ||' '||-- VAL_IOF_FASB, --    Imposto Operações Fi
                0 ||' '||-- VAL_IOF_CMCAC, --    Imposto Operações Fi
                0 ||' '||-- VAL_DESPES_BCIA_FASB, --    Despesa Bancaria Fas
                0 ||' '||-- VAL_DESPES_BCIA_CMCAC, --    Despesa Bancaria Cmc
                0 ||' '||-- VAL_DESPES_FINANC_FASB, --    Despesa Financeiro F
                0 ||' '||-- VAL_DESPES_FINANC_CMCAC, --    Despesa Financeiro C
                0 ||' '||-- NUM_RECIBO,
                0 ||' '||-- NUM_BLOCO,
                '"'||'' ||'"'|| ' '||--NOM_ARQ_DOCTO_OPERAC_FINANC,
                0 ||' '||-- VAL_DESPES_CART_RECBDA,
                'no' ||' '||-- LOG_INTEGR_CMG,
                'no' ||' '||-- LOG_PORTAD_CENTRAL,
                '"'||'' ||'"'||' '||-- COD_CONTRAT_CAMBIO,
                '31/12/9999' ||' '||--DAT_CONTRAT_CAMBIO_IMPORT,
                '"'||'' ||'"'||' '||--COD_PROCES_EXPORT,
                0 ||' '||-- NUM_ENCTRO_CTA,
                0 ||' '||-- IDI_TIP_PAGTO,
                '"'||'' ||'"'||' '||-- COD_ESTAB_CONTRAT_CAMBIO,
                '"'||'' ||'"'||' '||-- COD_REFER_CONTRAT_CAMBIO,
                '31/12/9999' ||' '||--DAT_REFER_CONTRAT_CAMBIO,
                0 ||' '||-- VAL_PIS, --   Programa integracao
                0 ||' '||-- VAL_COFINS, --   Cofins
                0 ||' '||-- VAL_CSLL, --   Contrib social sobre
                0 ||' '||-- VAL_PIS_FASB, --   Programa integracao
                0 ||' '||-- VAL_COFINS_FASB, --   Cofins Fasb
                0 ||' '||-- VAL_CSLL_FASB, --   Contrib social sobre
                0 ||' '||-- VAL_PIS_CMCAC, --   Programa integracao
                0 ||' '||-- VAL_COFINS_CMCAC, --   Cofins Cmcac
                0 ||' '||-- VAL_CSLL_CMCAC, --   Contrib social sobre
                '31/12/9999' ||' '||--DAT_VINCUL_CONTRAT_CAMBIO,
                '"'||'' ||'"'||' '||-- COD_CTA_CTBL_DB,
                '"'||'' ||'"'||' '||-- COD_CCUSTO_DB,
                'no' ||' '||-- LOG_RETENC_IMPTO,
                'no' ||' '||-- LOG_ESTORDO_IMPTO_RETID,
                '"'||'' ||'"'||' '||-- COD_LIVRE_1,
                '"'||'' ||'"'||' '||-- COD_LIVRE_2,
                'no' ||' '||-- LOG_LIVRE_1,
                'no' ||' '||-- LOG_LIVRE_2,
                0 ||' '||-- NUM_LIVRE_1,
                0 ||' '||-- NUM_LIVRE_2,
                0 ||' '||-- VAL_LIVRE_1,
                0 ||' '||-- VAL_LIVRE_2,
                '31/12/9999' ||' '||--DAT_LIVRE_1,
                '31/12/9999' ||' '||--DAT_LIVRE_2,
                0 ||' '-- VAL_PAGTO,
                MOVIMENTO,
                TR.NRREGISTRO_TITULO

  FROM TITULO_A_RECEBER                 TR,
       PESSOA                           PS,
       TI_TIPO_MOVIMENTO_TIT_ACR        TMT,
       PRODUCAO.CLIENTE@UNICOO_HOMOLOGA UCL,
       EMS5.CLIENTE                     ECL,
       TI_PESSOA                        TIP,
       TI_EMPRESA                       EMP,
       HISTORICO_DO_TITULO              HDT,
       EMS_TRANSACAO_ACR                E
 WHERE ECL.CDN_CLIENTE = TIP.CDN_CLIENTE
   AND TIP.NRREGISTRO = UCL.NRREGISTRO_CLIENTE
   AND UCL.CDCLIENTE = TR.CDCLIENTE
   AND TR.NRREGISTRO_TITULO = HDT.NRREGISTRO_TITULO
   AND HDT.CDMOVIMENTO = E.CDMOVIMENTO
   AND TMT.NRSEQUENCIAL =
       F_TI_TIP_MOVTO_TIT_ACR(TR.CDEMPRESA,
                              DECODE(TR.TPDOCUMENTO, 'FAT', 'FT', 'CR'),
                              DECODE(DECODE(TR.TPDOCUMENTO,
                                            'FAT',
                                            'FT',
                                            'CR'),
                                     'CR',
                                     TR.CDHISTORICO,
                                     SUBSTR(TR.NRDOCUMENTO, 0, 2)),
                              NVL(ECL.COD_GRP_CLIEN, TMT.COD_GRP_CLIEN))
   AND PS.NRREGISTRO = UCL.NRREGISTRO_CLIENTE
   AND EMP.CDEMPRESA = TR.CDEMPRESA
   AND NVL(ECL.COD_EMPRESA, F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')) =
       EMP.COD_EMPRESA
;

prompt
prompt Creating view V_TITULO_FECHADO_INF_APB
prompt ======================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TITULO_FECHADO_INF_APB AS
SELECT DISTINCT TMT.COD_EMPRESA COD_EMPRESA_ORIG,
                TMT.COD_ESTAB COD_ESTAB_ORIG,
                TMT.COD_ESPEC_DOCTO COD_ESPEC_DOCTO_ORIG,
                NVL(TMT.COD_SER_DOCTO, ' ') COD_SER_DOCTO_ORIG,
                SUBSTR(TP.NRDOCUMENTO, 1, 10) COD_TIT_AP,
                NVL(SUBSTR(TP.NRDOCUMENTO, 11, 2), '01') COD_PARCELA,
                TIP.CDN_FORNECEDOR CDN_FORNEC_ORIG,
                0 IDI_TRANSACAO,
                ' ' COD_REFER,
                TP.DTEMISSAO_NF DAT_TRANSACAO,
                TP.DTEMISSAO_NF DAT_EMIS_DOCTO,
                TP.DTVENCIMENTO DAT_VENCTO_TIT_AP,
                F_SALDO_TITULO_PAGAR(TP.NRREGISTRO_TITULO) VAL_SDO,
                TMT.COD_CTA_CTBL COD_CTA_CTBL,
                TMT.COD_CCUSTO COD_CCUSTO,
                CASE
                  WHEN F_TI_PARAMETRO_INTEGRACAO('INTEGRA_VALOR_LIQUIDO_TIT_APB') = 'S' THEN
                   NULL
                  ELSE
                   CASE
                     WHEN TMT.CDMOVIMENTO IN
                          (F_TI_PARAMETRO_INTEGRACAO('HISTORICO_COM_VALOR_LIQUIDO_APB')) THEN
                      NULL
                     ELSE
                      DECODE(SUBSTR(TP.TXHISTORICO, 1, 11),
                             'Ref.Integra',
                             '31/12/2050',
                             TP.DTVENCIMENTO)
                   END
                END DAT_DESCONTO,
                CASE
                  WHEN F_TI_PARAMETRO_INTEGRACAO('INTEGRA_VALOR_LIQUIDO_TIT_APB') = 'S' THEN
                   0
                  ELSE
                   CASE
                     WHEN TMT.CDMOVIMENTO IN
                          (F_TI_PARAMETRO_INTEGRACAO('HISTORICO_COM_VALOR_LIQUIDO_APB')) THEN
                      0
                     ELSE
                      NVL(TP.VLDESCONTO, 0) + NVL(TP.VLABATIMENTO, 0)
                      + NVL(TP.VLABATIMENTO_2, 0)
                   END
                END VAL_DESC_TIT_AP,
                NVL(TP.VLBRUTO, TP.VLTITULO) - NVL(TP.VLDESCONTO, 0) -
                NVL(TP.VLABATIMENTO, 0) - NVL(TP.VLABATIMENTO_2, 0) VAL_ORIGIN_TIT_AP,
                TP.DTULTIMO_RECEBIMENTO DAT_ULT_PAGTO,
                ' ' COD_CTA_CTBL_DB,
                ' ' COD_CCUSTO_DB,
                0 IDI_LANCTO,
                TP.DTVENCIMENTO DAT_PREV_PAGTO,
                ' ' COD_PED,
                0 NUM_ESTADO_OP,
                ' ' DES_OBS,
                CASE
                  WHEN F_PARAMETRO('NRUNIMED') = 033 THEN
                   CASE
                     WHEN TMT.COD_SER_DOCTO = 'PM' THEN
                      CASE (SELECT FF.COD_BANCO
                          FROM FORNEC_FINANC FF
                         WHERE FF.CDN_FORNECEDOR = EFN.CDN_FORNECEDOR
                           AND FF.COD_EMPRESA = TMT.COD_EMPRESA)
                        WHEN '748' THEN
                         '74811'
                        WHEN '341' THEN
                         '34111'
                        WHEN '001' THEN
                         '111'
                        WHEN '033' THEN
                         '3311'
                        WHEN '999' THEN
                         '99999'
                        WHEN '409' THEN
                         '112'
                        WHEN '237' THEN
                         '112'
                        WHEN '1' THEN
                         '111'
                        WHEN '33' THEN
                         '3311'
                      END
                     ELSE
                      TMT.COD_PORTADOR
                   END
                  ELSE
                   TMT.COD_PORTADOR
                END COD_PORTAD_ORIG,
                0 IDI_ORIG,
                0 IDI_TIP,
                0 NUM_CHEQUE,
                0 NUM_BORD_AP,
                0 LOG_EMIS_BORD,
                0 LOG_ATUALIZA_BORD,
                TMT.COD_CART_BCIA COD_CART_BCIA_ORIG,
                ' ' COD_ESPEC_DOCT_ANT,
                ' ' COD_SER_DOCTO_ANT,
                ' ' COD_TIT_AP_ANT,
                ' ' COD_PARCELA_ANT,
                0 val_erc_multa,
                NVL(TP.VLJUROS,0) val_juros_dia_atraso,
                0 val_sdo_fasb,
                0 val_desc_fasb,
                0 val_juros_fasb,
                0 val_origin_fasb,
                ' ' des_instruc_bcia,
                ' ' cb4_tit_ap_bco_cobdor, --verificar douglas
                NULL dat_fluxo_cx,
                0 num_fluxo_cx,
                0 cdn_emit, --verificar douglas,
                NVL((SELECT SUM(vltaxa) FROM taxa_titulo_a_pagar ttp
                WHERE ttp.nrregistro_titulo = tp.nrregistro_titulo),0) val_imposto,
                CASE
         WHEN (TO_NUMBER((NVL(TP.DTULTIMO_RECEBIMENTO, TRUNC(SYSDATE)) -
                         TP.DTVENCIMENTO))) < 0 THEN
          0
         ELSE
          (TO_NUMBER((NVL(TP.DTULTIMO_RECEBIMENTO, TRUNC(SYSDATE)) -
                     TP.DTVENCIMENTO)))
       END qtd_dias_atraso_liquidac,
0 val_perc_juros_difer,
ROUND(TO_NUMBER((TP.VLJUROS * 100 / (TP.VLTITULO))), 2) val_perc_juros_dia_atraso,
0 val_movto_fluxo_cx,
0 log_calc_fasb,
0 log_calc_cmcac,
0 val_cotac_fasb_emis,
0 val_cotac_fasb_vencto,
0 val_cotac_cmcac_emis,
0 val_cotac_anbid_emis,
(SELECT SUM(vltaxa) FROM taxa_titulo_a_pagar ttp, ti_taxa_a_pagar tax
WHERE tax.cod_taxa = ttp.cdtaxa
AND ttp.nrregistro_titulo = tp.nrregistro_titulo
AND tax.nom_taxa = 'IR%') val_impto_renda,



TP.NRREGISTRO_TITULO
/*
UFN.NRREGISTRO_FORNECEDOR NRPESSOA,
                TP.CDFORNECEDOR,


                0 VAL_PER_DESC,
                 COD_CART_BCIA,
                SYSDATE DAT_PROCESSAMENTO,
                TMT.COD_TIP_FLUXO_FINANC COD_TIP_FLUXO_FINAN,
                0 CDN_FORNECEDOR,
                1 QTD_PARCELA,
                F_TI_TIP_PESSOA_FORNECEDOR(TIP.CDN_FORNECEDOR) IND_TIPO_PESSOA,



                -- Alessandro 26/12/2012

                'RC' CDSITUACAO,
                CASE
                  WHEN TMT.COD_CCUSTO = '$T' THEN
                   NVL(TO_CHAR(TP.CDCENTRO_CUSTO), ' ')
                  ELSE
                   NVL(TMT.COD_CCUSTO, ' ')
                END COD_CCUSTO,
                (SELECT DISTINCT FE.COD_ID_FEDER
                   FROM FORNECEDOR FE
                  WHERE FE.CDN_FORNECEDOR = UFN.CDFORNECEDOR_EMS5) COD_ID_FEDER,

                TP.DTEMISSAO_NF DAT_EMISSAO,
                TP.DTVENCIMENTO DAT_VENCTO,
                TP.DTVENCIMENTO DAT_PREVISAO_PAGTO,


                CASE
                  WHEN F_TI_PARAMETRO_INTEGRACAO('INTEGRA_VALOR_LIQUIDO_TIT_APB') = 'S' THEN
                   NVL(TP.VLBRUTO, TP.VLTITULO) - NVL(TP.VLDESCONTO, 0) -
                   NVL(TP.VLABATIMENTO, 0) - NVL(TP.VLABATIMENTO_2, 0)
                  ELSE
                   CASE
                     WHEN TMT.CDMOVIMENTO IN
                          (F_TI_PARAMETRO_INTEGRACAO('HISTORICO_COM_VALOR_LIQUIDO_APB')) THEN
                      NVL(TP.VLBRUTO, TP.VLTITULO) - NVL(TP.VLDESCONTO, 0) -
                      NVL(TP.VLABATIMENTO, 0) - NVL(TP.VLABATIMENTO_2, 0)
                     ELSE
                      NVL(TP.VLBRUTO, TP.VLTITULO)
                   END
                END VAL_BRUTO,

                NVL(TP.VLBRUTO, TP.VLTITULO) - NVL(TP.VLDESCONTO, 0) -
                NVL(TP.VLABATIMENTO, 0) - NVL(TP.VLABATIMENTO_2, 0) VAL_TITULO,

                0 NUM_DIAS_ATRASO,
                NVL(TP.VLJUROS, 0) VAL_JUROS,
                0 VAL_PERC_JUROS_DIA_ATRASO,
                0 VAL_PERC_MULTA_ATRASO,

                COD_PORTADOR,

                TMT.COD_FORMA_PAGTO COD_FORMA_PAGTO,


                TMT.COD_TIP_FLUXO_FINANC,
                '0' IND_OCORRENCIA,
                TP.NRREGISTRO_TITULO,
                COD_PLANO_CCUSTO,
                 COD_PLANO_CTA_CTBL,
                ' ' DES_TEXT_HISTOR*/
  FROM TITULO_A_PAGAR                      TP,
       PESSOA                              PS,
       TI_TIPO_MOVIMENTO_TIT_APB           TMT,
       PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA UFN,
       FORNECEDOR                          EFN,
       TI_PESSOA                           TIP,
       TI_EMPRESA                          EMP
 WHERE UFN.CDFORNECEDOR = TP.CDFORNECEDOR
   AND TIP.NRREGISTRO = UFN.NRREGISTRO_FORNECEDOR
   AND EFN.CDN_FORNECEDOR = TIP.CDN_FORNECEDOR
   AND TMT.NRSEQUENCIAL =
       F_TI_TIP_MOVTO_TIT_APB(TP.CDEMPRESA,
                              'CP',
                              TP.CDHISTORICO,
                              EFN.COD_GRP_FORNEC,
                              '*',
                              NULL,
                              TMT.COD_ESPEC_DOCTO)
   AND PS.NRREGISTRO = UFN.NRREGISTRO_FORNECEDOR
   AND TIP.CDN_FORNECEDOR IS NOT NULL
   AND EMP.CDEMPRESA = TP.CDEMPRESA
   AND NVL(EFN.COD_EMPRESA, F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')) =
       EMP.COD_EMPRESA
;

prompt
prompt Creating view V_TITULO_FECHADOS_ACR_INF
prompt =======================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TITULO_FECHADOS_ACR_INF AS
SELECT DISTINCT '"'|| TMT.COD_EMPRESA ||'"'||' ' ||--TMT.COD_EMPRESA COD_EMPRES_ORIG, 10
                '"'||TMT.COD_ESTAB||'"'||' '||--COD_ESTAB_ORIG, 20
                '"'|| TMT.COD_ESPEC_DOCTO||'"'|| ' ' -- COD_ESPEC_DOCTO_ORIG, 30
                 ||'"'||
                CASE
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' THEN
                   SUBSTR(NRDOCUMENTO, 1, 10)
                  WHEN TR.NRDOCUMENTO LIKE '%-%' THEN
                   SUBSTR(NRDOCUMENTO, INSTR(NRDOCUMENTO, '-') + 1, 10)
                  ELSE
                   SUBSTR(NRDOCUMENTO, INSTR(NRDOCUMENTO, '-') + 1, 10)
                END ||'"'||' '|| -- COD_TITULO_ACR,
                '"'||
                CASE
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' AND
                       LENGTH(TR.NRDOCUMENTO) > 10 THEN
                   CASE
                     WHEN TMT.CDMODULO <> 'FT' AND NVL(TR.NRPARCELA, 0) > 0 THEN
                      LPAD(TR.NRPARCELA, 2, '0')
                     ELSE
                      SUBSTR(NRDOCUMENTO, 11, 2)
                   END
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' AND
                       LENGTH(TR.NRDOCUMENTO) <= 10 THEN
                   CASE
                     WHEN TMT.CDMODULO <> 'FT' AND NVL(TR.NRPARCELA, 0) > 0 THEN
                      LPAD(TR.NRPARCELA, 2, '0')
                     ELSE
                      null
                   END
                  WHEN TR.CDSITUACAO = '2' THEN
                   'P'
                  ELSE
                   null
                END ||'"'||' '||--COD_PARCELA,
                TIP.CDN_CLIENTE||' '||'"'||-- CDN_CLIEN_ORIG,
                TMT.COD_PORTADOR||'"'||' '||-- COD_PORTAD_ORIG,
                TMT.COD_CART_BCIA ||' '||-- COD_CART_BCIA_ORIG,
                TR.DTTITULO ||' '||--DAT_EMIS_DOCTO,
                TR.DTVENCIMENTO||' '||--TR.DTVENCIMENTO DAT_VENCTO,
                CASE
                  WHEN TR.CDSITUACAO = '2' THEN
                   TR.VLTITULO
                  ELSE
                   CASE
                     WHEN TMT.COD_ESTAB = '02' THEN
                      TR.VLTITULO
                     ELSE
                      TR.VLTITULO + NVL(F_TI_IR_ACR(TR.NRREGISTRO_TITULO), 0)
                   END
                END ||' '||--VAL_ORIGIN_TIT_ACR,
                0 ||' '||--, --VERIFICAR DOUGLAS
                F_SALDO_TITULO_RECEBER(TR.NRREGISTRO_TITULO) ||' '||--VAL_SDO_TIT_ACR,
               '"'|| NULL||'"'||' '||--DAT_DESCONTO,
                0 ||' '||--VAL_DESC_TIT_ACR,
               '"'|| CASE
                  WHEN TR.CDPORTADOR = '033' THEN
                   NVL(SUBSTR(TR.NRNOSSONUMERO, -8, 8), ' ')
                  WHEN LENGTH(TR.NRNOSSONUMERO) = 10 THEN
                   NVL(LPAD(TR.NRNOSSONUMERO, 12, '0'), ' ')
                  WHEN LENGTH(TR.NRNOSSONUMERO) = 8 THEN
                   NVL(LPAD(TR.NRNOSSONUMERO, 12, '0'), ' ')
                  ELSE
                   NVL(TR.NRNOSSONUMERO, ' ')
                END ||'"'||' '||--COD_TIT_ACR_BCO,
                '"'||TMT.COD_CTA_CTBL||'"'||' '||-- COD_CTA_CTBL_CR,
                '"'||TMT.COD_CCUSTO||'"'||' '||-- COD_CCUSTO_CR,
                NVL(TR.DTULTIMO_RECEBIMENTO,TRUNC(SYSDATE))||' '||--dat_ult_pagto
                'no' ||' '||--LOG_ESPEC_DOCTO_CTBZ, --verificar douglas Especie Documento Co
                '"'||'' ||'"'||' '||-- COD_PED_VDA, --Pedido Venda
                '"'||'' ||'"'||' '||-- COD_NATUR_OPERAC, --verificar douglas Natureza Operação
                'no' ||' '||-- LOG_EMIS_BORD, --verificar douglas Emite Borderô
                '"'||'' ||'"'||' '||--COD_REFER, --referencia verificar para nao repetir com os de titulos abertos
                '"'||'' ||'"'||' '||-- IDI_ORIG, --Origem ?
                '"'||'' ||'"'||' '||-- COD_COND_PAGTO, --verificar douglas condição pagamento
                '0'||' '||-- COD_INDIC_ECON_ORIG,
                'no' ||' '||-- LOG_EMITE_DUPL, --verificar douglas Emite Duplicata
                '"'||'' ||'"'||' '||-- COD_ESPEC_DOCTO_ANTECIP, --verificar douglas Espécie Antecipação
                '"'||'' ||'"'||' '||-- COD_DOCTO_ANTECIP, -- verificar douglas Documento Antecipaca
                '"'||'' ||'"'||' '||-- COD_PARC_ANTECIP, --verificar douglas parcela antecipacao
                0 ||' '||-- NUM_BORD_ACR, --verificar borderô
                '"'||'Normal' ||'"'||' '||-- IND_TIP_ESPEC_DOCTO, --verificar douglas tipo espécie
                TR.DTVENCIMENTO ||' '||--DAT_PREV_PAGTO,
               0 ||' '||-- VAL_PERC_DESC_ANTECIP, --perc Descto Antecip
                ROUND(TO_NUMBER((TR.VLJUROS * 100 / (TR.VLTITULO))), 2)||' '||-- VAL_PERC_JUROS_ACR,
                'no' ||' '||-- LOG_EMITE_ETIQ,
                'no' ||' '||-- LOG_EMITE_AVISO_LANCTO,
                TR.DTULTIMO_RECEBIMENTO||' '||-- DAT_ABAT_TIT_ACR,
                TR.VLABATIMENTO ||' '||--VAL_ABAT_TIT_ACR,
                '"'||'ems506unicoo' ||'"'||' '||--COD_USUARIO,
                '"'||'' ||'"'||' '||-- COD_PED_CLIEN,
                '"'||'Normal' ||'"'||' '||-- IDI_SIT, --verificar douglas
                'yes' ||' '||--LOG_EMIS_BOLETO,
                1 ||' '||--COD_REPRES_VENDAS, --verificar douglas
                '"'||'' ||'"'||' '||-- IDI_VENCTO, --verificar douglas
                0 ||' '||-- VAL_ABAT_FASB, --verificar douglas Abatimento Fasb
                0 ||' '||-- VAL_DESC_FASB, --verificar douglas Desconto Fasb
                0 ||' '||-- VAL_LIQ_FASB, --verificar douglas Liquido Fasb
                0 ||' '||-- VAL_ORIGIN_FASB, --verificar douglas Original Fasb
                0 ||' '||-- VAL_SDO_FASB, --verificar douglas Saldo Fasb
                TR.VLFATURADO ||' '||-- VAL_FATUR_ACR,
                TR.DTENVIO_BANCO||' '||--  DAT_DESTINAC_COBR, --verificar
                TR.DTCONFIRMA_BANCO||' '||--  DAT_CONFIR,
                '"'||'Enviado ao Banco' ||'"'||' '||-- IDI_FORMA_COBR, --verificar douglas  Forma Cobranca
                TR.DTULTIMO_ENVIO ||' '||-- DAT_ULT_COBR,
                '"'||'' ||'"'||' '||-- COD_AGENC_BCIA,
                '"'||'' ||'"'||' '||-- COD_INSTRUC_BCIA, -- verificar douglas
                'yes' ||' '||-- LOG_ENVDO_EDI, --verificar douglas
                TMT.COD_PORTADOR||'"'||' ' ||'"'||--COD_PORTAD_BXA_ORIG,
                TMT.COD_CART_BCIA||'"'||' '||--COD_CART_BCIA_BXA_ORIG,
                NULL||' '||-- DAT_FLUXO_CX,
                0 ||' '||-- NUM_FLUXO_CX,
                0 ||' '||-- CDN_CLIEN_MATRIZ,
                'no' ||' '||-- LOG_CALC_FASB,
                'no' ||' '||-- LOG_CALC_CMCAC,
                0 ||' '||-- VAL_COTAC_FASB_EMIS,
                0 ||' '||-- VAL_COTAC_FASB_VENCTO,
                0 ||' '||-- VAL_COTAC_CM_EMIS,
                0 ||' '||-- VAL_COTAC_ANBID_EMIS,
                'no' ||' '||-- LOG_CARTA_COBR,
                '"'||NVL(TMT.COD_TIP_FLUXO_FINANC_EMS2, TMT.COD_TIP_FLUXO_FINANC)||'"'||' '||-- COD_TIP_FLUXO_FINANC,
                'no' ||' '||-- LOG_DUPL_VENDOR_CONFDO,
                '"'||'' ||'"'||' '||-- COD_OCOR_BCIA_BCO,
                '"'||'' ||'"'||' '||-- COD_COND_PAGTO_PADR,
                '"'||'' ||'"'||' '||-- COD_OPERAC_FINANC,
                NULL ||' '||-- DAT_PREVIS,
                '"'||'' ||'"'||' '||-- NOM_ARQ_MOVIMEN_BCIA,
                '"'||'Normal' ||'"'||' '||-- IDI_SIT_TIT_ACR, --VERIFICAR DOUGLAS
                0 ||' '||-- QTD_DIAS_CARENC_JUROS_ACR,
                TR.DTVENCIMENTO ||' '||--DAT_VENCTO_ORIGIN_TIT_ACR,
                TR.DTENVIO_BANCO ||' '||--DAT_ENVIO,
                '"'||TMT.COD_CART_BCIA||'"'||' '||-- COD_CART_BCIA_TIT_ORIGIN,
                '"'||'Interno' ||'"'||' '||-- LOG_DESTINAC_COBR,
                'no' ||' '||-- IDI_MERC,
                TR.VLRECEBIDO||' '||-- VAL_PAGTO,
                TR.DTULTIMO_RECEBIMENTO ||' '||--DAT_LIQUIDAC_TIT_ACR,
                '"'||   CASE
                  WHEN TMT.CDMODULO = 'FT' AND TR.NRDOCUMENTO LIKE '%-%' THEN
                   TMT.CDMOVIMENTO
                  ELSE
                   ' '
                END ||'"'||' '||--COD_SER_DOCTO_ORIG,
                '"'||'' ||'"'||' '||-- COD_SER_DOCTO_ANTECIP,
                0 ||' '||-- VAL_DESPES_BCIA,
                0 ||' '||-- NUM_ID_TIT_ACR,
                0 ||' '||-- VAL_COTAC_INDIC_ECON,
                0 ||' '||-- VAL_OUTROS_VALORES,
                0 ||' '||-- VAL_FRETE,
                '"'||'' ||'"'||' '||-- DES_OBS,
                0 ||' '||-- NUM_SEQ,
                0 ||' '||-- VAL_ORIGIN_MOED_ESTRANG,
                0 ||' '||-- VAL_LIQ_MOED_ESTRANG,
                0 ||' '||-- VAL_SDO_MOED_ESTRANG,
                0 ||' '||-- VAL_DESC_MOED_ESTRANG,
                0 ||' '||-- VAL_ABAT_MOED_ESTRANG,
                0 ||' '||-- VAL_OUTROS_MOED_ESTRANG,
                0 ||' '||-- VAL_FRETE_MOED_ESTRANG,
                0 ||' '||-- VAL_FATUR_ACR_MOED_ESTRANG,
                '"'||'' ||'"'||' '||-- COD_DOCTO,
                '"'||'' ||'"'||' '||-- COD_IMPTO_RETID,
                TR.VLMULTA ||' '||--VAL_MULTA,
                0 ||' '||-- VAL_MULTA_MOED_ESTRANG,
                TR.DTULTIMO_RECEBIMENTO||' '||-- DAT_MULTA,
                ROUND(TO_NUMBER((TR.VLJUROS * 100 / (TR.VLTITULO))), 2)||' '||-- VAL_PERC_MULTA_ACR,
                '"'||'' ||'"'||' '||-- COD_ENDER_ENTREG,
                'no' ||' '||-- LOG_COBR_CARTOR,
                'no' ||' '||-- LOG_AVISO_DB_EMITID,
                0 ||' '||-- VAL_OUTRAS_DESPES,
                '"'||'' ||'"'||' '||-- COD_PROCES_EXPORT,
                'no' ||' '||-- LOG_CONTRAT_CAMBIO,
                '"'||'' ||'"'||' '||-- COD_UNID_NEGOC, --verificar douglas
                0 ||' '||-- VAL_COFINS,
                0 ||' '||-- VAL_PIS,
                0 ||' '||-- VAL_CSLL,
                'no' ||' '||-- LOG_RETENC_IMPTO,
                0 ||' '||-- VAL_BASE_CALC_IMPTO,
                '"'||'' ||'"'||' '||-- COD_LIVRE_1,
                '"'||'' ||'"'||' '||-- COD_LIVRE_2,
                'no' ||' '||-- LOG_LIVRE_1,
                'no' ||' '||-- LOG_LIVRE_2,
                0 ||' '||-- NUM_LIVRE_1,
                0 ||' '||-- NUM_LIVRE_2,
                0 ||' '||-- VAL_LIVRE_1,
                0 ||' '||-- VAL_LIVRE_2,
                NULL ||' '||--DAT_LIVRE_1,
                NULL REGISTRO,
                TR.NRREGISTRO_TITULO
  FROM TITULO_A_RECEBER                 TR,
       PESSOA                           PS,
       TI_TIPO_MOVIMENTO_TIT_ACR        TMT,
       PRODUCAO.CLIENTE@UNICOO_HOMOLOGA UCL,
       EMS5.CLIENTE                     ECL,
       TI_PESSOA                        TIP,
       TI_EMPRESA                       EMP
 WHERE ECL.CDN_CLIENTE = TIP.CDN_CLIENTE
   AND TIP.NRREGISTRO = UCL.NRREGISTRO_CLIENTE
   AND UCL.CDCLIENTE = TR.CDCLIENTE
   AND TMT.NRSEQUENCIAL =
       F_TI_TIP_MOVTO_TIT_ACR(TR.CDEMPRESA,
                              DECODE(TR.TPDOCUMENTO, 'FAT', 'FT', 'CR'),
                              DECODE(DECODE(TR.TPDOCUMENTO,
                                            'FAT',
                                            'FT',
                                            'CR'),
                                     'CR',
                                     TR.CDHISTORICO,
                                     SUBSTR(TR.NRDOCUMENTO, 0, 2)),
                              NVL(ECL.COD_GRP_CLIEN, TMT.COD_GRP_CLIEN))
   AND PS.NRREGISTRO = UCL.NRREGISTRO_CLIENTE
   AND EMP.CDEMPRESA = TR.CDEMPRESA
   AND NVL(ECL.COD_EMPRESA, F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')) =
       EMP.COD_EMPRESA
;

prompt
prompt Creating view V_TITULOS_FECHADOS_INFORMACOES
prompt ============================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TITULOS_FECHADOS_INFORMACOES AS
SELECT DISTINCT '"'|| TMT.COD_EMPRESA ||'"'||' ' ||--TMT.COD_EMPRESA COD_EMPRES_ORIG, 10
                '"'||TMT.COD_ESTAB||'"'||' '||--COD_ESTAB_ORIG, 20
                '"'|| TMT.COD_ESPEC_DOCTO||'"'|| ' ' -- COD_ESPEC_DOCTO_ORIG, 30
                 ||'"'||
                CASE
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' THEN
                   SUBSTR(NRDOCUMENTO, 1, 10)
                  WHEN TR.NRDOCUMENTO LIKE '%-%' THEN
                   SUBSTR(NRDOCUMENTO, INSTR(NRDOCUMENTO, '-') + 1, 10)
                  ELSE
                   SUBSTR(NRDOCUMENTO, INSTR(NRDOCUMENTO, '-') + 1, 10)
                END ||'"'||' '|| -- COD_TITULO_ACR,
                '"'||
                CASE
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' AND
                       LENGTH(TR.NRDOCUMENTO) > 10 THEN
                   CASE
                     WHEN TMT.CDMODULO <> 'FT' AND NVL(TR.NRPARCELA, 0) > 0 THEN
                      LPAD(TR.NRPARCELA, 2, '0')
                     ELSE
                      SUBSTR(NRDOCUMENTO, 11, 2)
                   END
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' AND
                       LENGTH(TR.NRDOCUMENTO) <= 10 THEN
                   CASE
                     WHEN TMT.CDMODULO <> 'FT' AND NVL(TR.NRPARCELA, 0) > 0 THEN
                      LPAD(TR.NRPARCELA, 2, '0')
                     ELSE
                      null
                   END
                  WHEN TR.CDSITUACAO = '2' THEN
                   'P'
                  ELSE
                   null
                END ||'"'||' '||--COD_PARCELA,
                TIP.CDN_CLIENTE||' '||'"'||-- CDN_CLIEN_ORIG,
                TMT.COD_PORTADOR||'"'||' '||-- COD_PORTAD_ORIG,
                TMT.COD_CART_BCIA ||' '||-- COD_CART_BCIA_ORIG,
                TR.DTTITULO ||' '||--DAT_EMIS_DOCTO,
                TR.DTVENCIMENTO||' '||--TR.DTVENCIMENTO DAT_VENCTO,
                CASE
                  WHEN TR.CDSITUACAO = '2' THEN
                   TR.VLTITULO
                  ELSE
                   CASE
                     WHEN TMT.COD_ESTAB = '02' THEN
                      TR.VLTITULO
                     ELSE
                      TR.VLTITULO + NVL(F_TI_IR_ACR(TR.NRREGISTRO_TITULO), 0)
                   END
                END ||' '||--VAL_ORIGIN_TIT_ACR,
                0 ||' '||--, --VERIFICAR DOUGLAS
                F_SALDO_TITULO_RECEBER(TR.NRREGISTRO_TITULO) ||' '||--VAL_SDO_TIT_ACR,
               '"'|| NULL||'"'||' '||--DAT_DESCONTO,
                0 ||' '||--VAL_DESC_TIT_ACR,
               '"'|| CASE
                  WHEN TR.CDPORTADOR = '033' THEN
                   NVL(SUBSTR(TR.NRNOSSONUMERO, -8, 8), ' ')
                  WHEN LENGTH(TR.NRNOSSONUMERO) = 10 THEN
                   NVL(LPAD(TR.NRNOSSONUMERO, 12, '0'), ' ')
                  WHEN LENGTH(TR.NRNOSSONUMERO) = 8 THEN
                   NVL(LPAD(TR.NRNOSSONUMERO, 12, '0'), ' ')
                  ELSE
                   NVL(TR.NRNOSSONUMERO, ' ')
                END ||'"'||' '||--COD_TIT_ACR_BCO,
                '"'||TMT.COD_CTA_CTBL||'"'||' '||-- COD_CTA_CTBL_CR,
                '"'||TMT.COD_CCUSTO||'"'||' '||-- COD_CCUSTO_CR,
                NVL(TR.DTULTIMO_RECEBIMENTO,TRUNC(SYSDATE))||' '||--dat_ult_pagto
                'no' ||' '||--LOG_ESPEC_DOCTO_CTBZ, --verificar douglas Especie Documento Co
                '"'||'' ||'"'||' '||-- COD_PED_VDA, --Pedido Venda
                '"'||'' ||'"'||' '||-- COD_NATUR_OPERAC, --verificar douglas Natureza Operação
                'no' ||' '||-- LOG_EMIS_BORD, --verificar douglas Emite Borderô
                '"'||'' ||'"'||' '||--COD_REFER, --referencia verificar para nao repetir com os de titulos abertos
                '"'||'' ||'"'||' '||-- IDI_ORIG, --Origem ?
                '"'||'' ||'"'||' '||-- COD_COND_PAGTO, --verificar douglas condição pagamento
                '0'||' '||-- COD_INDIC_ECON_ORIG,
                'no' ||' '||-- LOG_EMITE_DUPL, --verificar douglas Emite Duplicata
                '"'||'' ||'"'||' '||-- COD_ESPEC_DOCTO_ANTECIP, --verificar douglas Espécie Antecipação
                '"'||'' ||'"'||' '||-- COD_DOCTO_ANTECIP, -- verificar douglas Documento Antecipaca
                '"'||'' ||'"'||' '||-- COD_PARC_ANTECIP, --verificar douglas parcela antecipacao
                0 ||' '||-- NUM_BORD_ACR, --verificar borderô
                '"'||'Normal' ||'"'||' '||-- IND_TIP_ESPEC_DOCTO, --verificar douglas tipo espécie
                TR.DTVENCIMENTO ||' '||--DAT_PREV_PAGTO,
               0 ||' '||-- VAL_PERC_DESC_ANTECIP, --perc Descto Antecip
                ROUND(TO_NUMBER((TR.VLJUROS * 100 / (TR.VLTITULO))), 2)||' '||-- VAL_PERC_JUROS_ACR,
                'no' ||' '||-- LOG_EMITE_ETIQ,
                'no' ||' '||-- LOG_EMITE_AVISO_LANCTO,
                TR.DTULTIMO_RECEBIMENTO||' '||-- DAT_ABAT_TIT_ACR,
                TR.VLABATIMENTO ||' '||--VAL_ABAT_TIT_ACR,
                '"'||'ems506unicoo' ||'"'||' '||--COD_USUARIO,
                '"'||'' ||'"'||' '||-- COD_PED_CLIEN,
                '"'||'Normal' ||'"'||' '||-- IDI_SIT, --verificar douglas
                'yes' ||' '||--LOG_EMIS_BOLETO,
                1 ||' '||--COD_REPRES_VENDAS, --verificar douglas
                '"'||'' ||'"'||' '||-- IDI_VENCTO, --verificar douglas
                0 ||' '||-- VAL_ABAT_FASB, --verificar douglas Abatimento Fasb
                0 ||' '||-- VAL_DESC_FASB, --verificar douglas Desconto Fasb
                0 ||' '||-- VAL_LIQ_FASB, --verificar douglas Liquido Fasb
                0 ||' '||-- VAL_ORIGIN_FASB, --verificar douglas Original Fasb
                0 ||' '||-- VAL_SDO_FASB, --verificar douglas Saldo Fasb
                TR.VLFATURADO ||' '||-- VAL_FATUR_ACR,
                TR.DTENVIO_BANCO||' '||--  DAT_DESTINAC_COBR, --verificar
                TR.DTCONFIRMA_BANCO||' '||--  DAT_CONFIR,
                '"'||'Enviado ao Banco' ||'"'||' '||-- IDI_FORMA_COBR, --verificar douglas  Forma Cobranca
                TR.DTULTIMO_ENVIO ||' '||-- DAT_ULT_COBR,
                '"'||'' ||'"'||' '||-- COD_AGENC_BCIA,
                '"'||'' ||'"'||' '||-- COD_INSTRUC_BCIA, -- verificar douglas
                'yes' ||' '||-- LOG_ENVDO_EDI, --verificar douglas
                TMT.COD_PORTADOR||'"'||' ' ||'"'||--COD_PORTAD_BXA_ORIG,
                TMT.COD_CART_BCIA||'"'||' '||--COD_CART_BCIA_BXA_ORIG,
                NULL||' '||-- DAT_FLUXO_CX,
                0 ||' '||-- NUM_FLUXO_CX,
                0 ||' '||-- CDN_CLIEN_MATRIZ,
                'no' ||' '||-- LOG_CALC_FASB,
                'no' ||' '||-- LOG_CALC_CMCAC,
                0 ||' '||-- VAL_COTAC_FASB_EMIS,
                0 ||' '||-- VAL_COTAC_FASB_VENCTO,
                0 ||' '||-- VAL_COTAC_CM_EMIS,
                0 ||' '||-- VAL_COTAC_ANBID_EMIS,
                'no' ||' '||-- LOG_CARTA_COBR,
                '"'||NVL(TMT.COD_TIP_FLUXO_FINANC_EMS2, TMT.COD_TIP_FLUXO_FINANC)||'"'||' '||-- COD_TIP_FLUXO_FINANC,
                'no' ||' '||-- LOG_DUPL_VENDOR_CONFDO,
                '"'||'' ||'"'||' '||-- COD_OCOR_BCIA_BCO,
                '"'||'' ||'"'||' '||-- COD_COND_PAGTO_PADR,
                '"'||'' ||'"'||' '||-- COD_OPERAC_FINANC,
                NULL ||' '||-- DAT_PREVIS,
                '"'||'' ||'"'||' '||-- NOM_ARQ_MOVIMEN_BCIA,
                '"'||'Normal' ||'"'||' '||-- IDI_SIT_TIT_ACR, --VERIFICAR DOUGLAS
                0 ||' '||-- QTD_DIAS_CARENC_JUROS_ACR,
                TR.DTVENCIMENTO ||' '||--DAT_VENCTO_ORIGIN_TIT_ACR,
                TR.DTENVIO_BANCO ||' '||--DAT_ENVIO,
                '"'||TMT.COD_CART_BCIA||'"'||' '||-- COD_CART_BCIA_TIT_ORIGIN,
                '"'||'Interno' ||'"'||' '||-- LOG_DESTINAC_COBR,
                'no' ||' '||-- IDI_MERC,
                TR.VLRECEBIDO||' '||-- VAL_PAGTO,
                TR.DTULTIMO_RECEBIMENTO ||' '||--DAT_LIQUIDAC_TIT_ACR,
                '"'||   CASE
                  WHEN TMT.CDMODULO = 'FT' AND TR.NRDOCUMENTO LIKE '%-%' THEN
                   TMT.CDMOVIMENTO
                  ELSE
                   ' '
                END ||'"'||' '||--COD_SER_DOCTO_ORIG,
                '"'||'' ||'"'||' '||-- COD_SER_DOCTO_ANTECIP,
                0 ||' '||-- VAL_DESPES_BCIA,
                0 ||' '||-- NUM_ID_TIT_ACR,
                0 ||' '||-- VAL_COTAC_INDIC_ECON,
                0 ||' '||-- VAL_OUTROS_VALORES,
                0 ||' '||-- VAL_FRETE,
                '"'||'' ||'"'||' '||-- DES_OBS,
                0 ||' '||-- NUM_SEQ,
                0 ||' '||-- VAL_ORIGIN_MOED_ESTRANG,
                0 ||' '||-- VAL_LIQ_MOED_ESTRANG,
                0 ||' '||-- VAL_SDO_MOED_ESTRANG,
                0 ||' '||-- VAL_DESC_MOED_ESTRANG,
                0 ||' '||-- VAL_ABAT_MOED_ESTRANG,
                0 ||' '||-- VAL_OUTROS_MOED_ESTRANG,
                0 ||' '||-- VAL_FRETE_MOED_ESTRANG,
                0 ||' '||-- VAL_FATUR_ACR_MOED_ESTRANG,
                '"'||'' ||'"'||' '||-- COD_DOCTO,
                '"'||'' ||'"'||' '||-- COD_IMPTO_RETID,
                TR.VLMULTA ||' '||--VAL_MULTA,
                0 ||' '||-- VAL_MULTA_MOED_ESTRANG,
                TR.DTULTIMO_RECEBIMENTO||' '||-- DAT_MULTA,
                ROUND(TO_NUMBER((TR.VLJUROS * 100 / (TR.VLTITULO))), 2)||' '||-- VAL_PERC_MULTA_ACR,
                '"'||'' ||'"'||' '||-- COD_ENDER_ENTREG,
                'no' ||' '||-- LOG_COBR_CARTOR,
                'no' ||' '||-- LOG_AVISO_DB_EMITID,
                0 ||' '||-- VAL_OUTRAS_DESPES,
                '"'||'' ||'"'||' '||-- COD_PROCES_EXPORT,
                'no' ||' '||-- LOG_CONTRAT_CAMBIO,
                '"'||'' ||'"'||' '||-- COD_UNID_NEGOC, --verificar douglas
                0 ||' '||-- VAL_COFINS,
                0 ||' '||-- VAL_PIS,
                0 ||' '||-- VAL_CSLL,
                'no' ||' '||-- LOG_RETENC_IMPTO,
                0 ||' '||-- VAL_BASE_CALC_IMPTO,
                '"'||'' ||'"'||' '||-- COD_LIVRE_1,
                '"'||'' ||'"'||' '||-- COD_LIVRE_2,
                'no' ||' '||-- LOG_LIVRE_1,
                'no' ||' '||-- LOG_LIVRE_2,
                0 ||' '||-- NUM_LIVRE_1,
                0 ||' '||-- NUM_LIVRE_2,
                0 ||' '||-- VAL_LIVRE_1,
                0 ||' '||-- VAL_LIVRE_2,
                NULL ||' '||--DAT_LIVRE_1,
                NULL REGISTRO,
                TR.NRREGISTRO_TITULO
  FROM TITULO_A_RECEBER                 TR,
       PESSOA                           PS,
       TI_TIPO_MOVIMENTO_TIT_ACR        TMT,
       PRODUCAO.CLIENTE@UNICOO_HOMOLOGA UCL,
       EMS5.CLIENTE                     ECL,
       TI_PESSOA                        TIP,
       TI_EMPRESA                       EMP
 WHERE ECL.CDN_CLIENTE = TIP.CDN_CLIENTE
   AND TIP.NRREGISTRO = UCL.NRREGISTRO_CLIENTE
   AND UCL.CDCLIENTE = TR.CDCLIENTE
   AND TMT.NRSEQUENCIAL =
       F_TI_TIP_MOVTO_TIT_ACR(TR.CDEMPRESA,
                              DECODE(TR.TPDOCUMENTO, 'FAT', 'FT', 'CR'),
                              DECODE(DECODE(TR.TPDOCUMENTO,
                                            'FAT',
                                            'FT',
                                            'CR'),
                                     'CR',
                                     TR.CDHISTORICO,
                                     SUBSTR(TR.NRDOCUMENTO, 0, 2)),
                              NVL(ECL.COD_GRP_CLIEN, TMT.COD_GRP_CLIEN))
   AND PS.NRREGISTRO = UCL.NRREGISTRO_CLIENTE
   AND EMP.CDEMPRESA = TR.CDEMPRESA
   AND NVL(ECL.COD_EMPRESA, F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')) =
       EMP.COD_EMPRESA
;

prompt
prompt Creating view V_TITULOS_FECHADOS_MOVIMENTOS
prompt ===========================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.V_TITULOS_FECHADOS_MOVIMENTOS AS
SELECT DISTINCT
               ''''|| TMT.COD_EMPRESA ||''''||' ' ||--cod_empres_orig
               ''''||TMT.COD_ESTAB||''''||' '||-- cod_estab_orig
               ''''|| TMT.COD_ESPEC_DOCTO||''''|| ' ' --cod_espec_docto_orig
               ||''''||
               CASE
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' THEN
                   SUBSTR(TR.NRDOCUMENTO, 1, 10)
                  WHEN TR.NRDOCUMENTO LIKE '%-%' THEN
                   SUBSTR(TR.NRDOCUMENTO, INSTR(TR.NRDOCUMENTO, '-') + 1, 10)
                  ELSE
                   SUBSTR(TR.NRDOCUMENTO, INSTR(TR.NRDOCUMENTO, '-') + 1, 10)
                END ||''''||' '|| --cod_tit_acr

                ''''||
                CASE
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' AND
                       LENGTH(TR.NRDOCUMENTO) > 10 THEN
                   CASE
                     WHEN TMT.CDMODULO <> 'FT' AND NVL(TR.NRPARCELA, 0) > 0 THEN
                      LPAD(TR.NRPARCELA, 2, '0')
                     ELSE
                      SUBSTR(TR.NRDOCUMENTO, 11, 2)
                   END
                  WHEN TR.NRDOCUMENTO NOT LIKE '%-%' AND
                       LENGTH(TR.NRDOCUMENTO) <= 10 THEN
                   CASE
                     WHEN TMT.CDMODULO <> 'FT' AND NVL(TR.NRPARCELA, 0) > 0 THEN
                      LPAD(TR.NRPARCELA, 2, '0')
                     ELSE
                      ' '
                   END
                  WHEN TR.CDSITUACAO = '2' THEN
                   'P'
                  ELSE
                   ' '
                END ||''''||' '||''''|| --cod_parcela
                E.CDTRANSACAO||''''||' '||--idi_transacao
                TIP.CDN_CLIENTE||' '||''''||--cdn_cliente
                TMT.COD_PORTADOR||''''||' ' ||''''||--cod_portad_orig
                TMT.COD_CART_BCIA||''''||' '||--cod_cart_bcia_orig
                TR.DTTITULO ||' '||--dat_emis
                TR.DTVENCIMENTO||' '||--dat_vencto_tit_acr
                CASE
                  WHEN TR.CDSITUACAO = '2' THEN
                   TR.VLTITULO
                  ELSE
                   CASE
                     WHEN TMT.COD_ESTAB = '02' THEN
                      TR.VLTITULO
                     ELSE
                      TR.VLTITULO + NVL(F_TI_IR_ACR(TR.NRREGISTRO_TITULO), 0)
                   END
                END ||' '||--val_origin_tit_acr

                CASE
                  WHEN TR.CDSITUACAO = '2' THEN
                   TR.VLTITULO
                  ELSE
                   CASE
                     WHEN TMT.COD_ESTAB = '02' THEN
                      TR.VLTITULO
                     ELSE
                      TR.VLTITULO + NVL(F_TI_IR_ACR(TR.NRREGISTRO_TITULO), 0)
                   END
                END ||' '||--val_liq_tit_acr
                NULL ||' '||--dat_cr_movto_tit_acr
                TR.DTULTIMO_RECEBIMENTO ||' '||--dat_pagto
                NULL ||' '|| --dat_desconto
                0 ||' '||--val_desc_tit_acr
                TR.VLJUROS ||' '||--val_juros
                 0 ||' '||--val_antecip
                ''''||' '||''''||' '||--cod_refer
                1 ||' '||--log_ctbzdo
                0 ||' ' ||--log_espec_docto_ctbz
                ''''||TMT.COD_CTA_CTBL||''''||' '||  --cod_cta_ctbl_cr
                ''''||NVL(TMT.COD_CCUSTO, ' ')||''''||' '||--cod_ccusto_cr
                ''''||' ' ||''''||' '||--cod_ped_vda
                ''''||' ' ||''''||' '||--cod_natur_operac
                ''''||'REAL'||''''||' '||--cod_indic_econ_orig
                ''''||' ' ||''''||' '||--cod_espec_docto_antecip
                ''''||' ' ||''''||' '||--cod_docto_antecip
                ''''||' ' ||''''||' '||--cod_parc_antecip
                HDT.DTMOVIMENTO ||' '||--dat_movto_tit_acr
                ''''||' ' ||''''||' '||--ind_tip_espec_docto
                NULL||' '||--dat_abat_tit_acr
                0 ||' '||--val_abat_tit_acr
                1 ||' '||--log_envdo_edi
                NULL ||' '||--dat_gerac_bord
                ''''||' ' ||''''||' '||--cod_repres_vendas
                HDT.DTMOVIMENTO ||' '||--dat_transacao
                0||' '|| --    val_abat_fasb
                0||' '|| --    val_antecip_fasb
                0||' '|| --    val_movto_fasb
                0 ||' '|| --    val_desc_fasb
                0||' '|| --    val_juros_fasb
                0 ||' '|| --   val_liq_fasb
                0||' '|| --    val_origin_fasb
                HDT.VLRECEBIDO ||' '||--val_movto_tit_acr
                0 ||' '||--val_ganho_perda_origin
                0 ||' '||--val_fatory
                0 ||' '||--val_fatorx
                0 ||' '||--val_fatorf
                CASE
                  WHEN UPPER(E.NOTRANSACAO) LIKE '%ESTORN%' THEN
                   1
                  ELSE
                   0
                END ||' '||''''||--log_movto_estorn

                CASE
                  WHEN TR.CDPORTADOR = '033' THEN
                   NVL(SUBSTR(TR.NRNOSSONUMERO, -8, 8), ' ')
                  WHEN LENGTH(TR.NRNOSSONUMERO) = 10 THEN
                   NVL(LPAD(TR.NRNOSSONUMERO, 12, '0'), ' ')
                  WHEN LENGTH(TR.NRNOSSONUMERO) = 8 THEN
                   NVL(LPAD(TR.NRNOSSONUMERO, 12, '0'), ' ')
                  ELSE
                   NVL(TR.NRNOSSONUMERO, ' ')
                END ||''''||' '||--cod_tit_acr_bco
                0 ||' '||--log_confir_movto_envdo_bco
                0 ||' '||--log_ctbz_comis
                ''''||' ' ||''''||' '||--cod_docto_bco_pagto
                ''''||' ' ||''''||' '||--cod_docto
                ''''||' ' ||''''||' '||--cod_cta_corren
                ''''||' ' ||''''||' '||--cod_agenc_bcia
                ''''||' ' ||''''||' '||--cod_banco
                0 ||' '||--idi_lancto
                0 ||' '||--val_efeito_maxi
                0 ||' '||--val_acerto_cmcac
                0 ||' '||--val_movto_cmcac
                0 ||' '||--val_antecip_cmcac
                0 ||' '||--val_desc_cmcac
                0 ||' '||--val_juros_cmcac
                0 ||' '||--val_pres
                0 ||' '||--val_impto_icms
                0 ||' '||--val_abat_cmcac
                0 ||' '||--log_calc_comis
                0 ||' '||--log_aviso_db_emitid
                NULL ||' '||--hra_envio
                NULL ||' '||--dat_envio
                ''''||' ' ||''''||' '||--cod_instruc_bcia_bco
                0 ||' '||--val_despes_bcia
                0 ||' '||--cdn_ret_bco
                0 ||' '||--log_tit_subst
                ''''||' ' ||''''||' '||--idi_sit_tit_acr
                0 ||' '||--log_selec
                0 ||' '||--val_variac_cm
                ''''||' ' ||''''||' '||--idi_tip_alter
                ''''||' ' ||''''||' '||--nom_arq_movimen_bcia
                ''''||' ' ||''''||' '||--cod_control
                ''''||' ' ||''''||' '||--cod_docto_movto_cta_bco
                 ''''||'ems506unicoo' ||''''||' '||--cod_usuario
                0 ||' '||--idi_merc
                ''''||' ' ||''''||' '||--cod_indic_econ_moed
                0 ||' '||--idi_orig

             ''''||   CASE
                  WHEN TMT.CDMODULO = 'FT' AND TR.NRDOCUMENTO LIKE '%-%' THEN
                   TMT.CDMOVIMENTO
                  ELSE
                   ' '
                END ||''''||' '||-- COD_SER_DOCTO_ORIG,
                ''''||' ' ||''''||' '||--COD_SER_DOCTO_ANTECIP,
                ''''||' ' ||''''||' '||-- COD_ESPEC_ADIANT,
                0 ||' '||-- VAL_COTAC_INDIC_ECON,
                0 ||' '||-- VAL_OUTROS_VALORES,
                0 ||' '||-- VAL_FRETE,
                0 ||' '||-- NUM_CHEQUE,
                ''''||' ' ||''''||' '||-- DES_OBS,
                0 ||' '||-- NUM_SEQ,
                0 ||' '||-- VAL_ORIGIN_MOED_ESTRANG, --    Original Moeda Estra
                0 ||' '||-- VAL_LIQ_MOED_ESTRANG, --    Liquido Moeda Estran
                0 ||' '||-- VAL_ANTECIP_MOED_ESTRANG, --    Antecipacao Moeda Es
                0 ||' '||-- VAL_FRETE_MOED_ESTRANG, --    Frete Moeda Estrange
                0 ||' '||-- VAL_OUTROS_MOED_ESTRANG, --    Outros Moeda Estrang
                0 ||' '||-- VAL_PAGTO_MOED_ESTRANG, --    Pagamento Moeda Estr
                0 ||' '||-- VAL_DESC_MOED_ESTRANG, --    Desconto Moeda Estra
                0 ||' '||-- VAL_JUROS_MOED_ESTRANG, --    Juros Moeda Estrange
                0 ||' '||-- VAL_ABAT_MOED_ESTRANG, --    Abatimento Moeda Est
                0 ||' '||-- VAL_DESPES_BCO_MOED_ESTRANG, --    Despesa Banco Moeda
                0 ||' '||-- NUM_ID_MOVTO_TIT_ACR,
                0 ||' '||-- VAL_VARIAC_CM_ANTECIP, --    Variacao Correcao mo
                0 ||' '||-- VAL_OUTROS_VALORES_FASB, --    Outros Valores Fasb
                0 ||' '||-- VAL_OUTROS_VALORES_CMCAC, --    Outros Valores Cmcac
                0 ||' '||-- VAL_OUTROS_VALORES_PRES, --    Outros Valores Prese
                0 ||' '||-- VAL_FRETE_FASB, --    Frete Fasb
                0 ||' '||-- VAL_FRETE_CMCAC, --    Frete Cmcac
                0 ||' '||-- VAL_FRETE_PRES, --    Frete Presente
                0 ||' '||-- VAL_IMPTO_OPERAC_FINANC, --    Imposto Operação
                0 ||' '||-- VAL_IMPTO_MOED_ESTRANG, --    Imposto Moeda Estran
                0 ||' '||-- VAL_DESPES_FINANC, --    Valor Despesa Financ
                0 ||' '||-- VAL_DESPES_MOED_ESTRANG, --    Despesa Moeda Estran
                0 ||' '||-- NUM_ID_TIT_AP_PAI, --    Token
                HDT.VLMULTA ||' '||-- VAL_MULTA,
                0 ||' '||-- VAL_MULTA_MOED_ESTRANG,
                0 ||' '||-- LOG_BXA_TRANSF,
                0 ||' '||-- VAL_MULTA_FASB, --    Multa Fasb
                0 ||' '||-- VAL_MULTA_CMCAC, --    Multa Cmcac
                0 ||' '||-- VAL_IOF_FASB, --    Imposto Operações Fi
                0 ||' '||-- VAL_IOF_CMCAC, --    Imposto Operações Fi
                0 ||' '||-- VAL_DESPES_BCIA_FASB, --    Despesa Bancaria Fas
                0 ||' '||-- VAL_DESPES_BCIA_CMCAC, --    Despesa Bancaria Cmc
                0 ||' '||-- VAL_DESPES_FINANC_FASB, --    Despesa Financeiro F
                0 ||' '||-- VAL_DESPES_FINANC_CMCAC, --    Despesa Financeiro C
                0 ||' '||-- NUM_RECIBO,
                0 ||' '||-- NUM_BLOCO,
                ''''||' ' ||''''||' '||--NOM_ARQ_DOCTO_OPERAC_FINANC,
                0 ||' '||-- VAL_DESPES_CART_RECBDA,
                0 ||' '||-- LOG_INTEGR_CMG,
                0 ||' '||-- LOG_PORTAD_CENTRAL,
                ''''||' ' ||''''||' '||-- COD_CONTRAT_CAMBIO,
                NULL ||' '||--DAT_CONTRAT_CAMBIO_IMPORT,
                ''''||' ' ||''''||' '||--COD_PROCES_EXPORT,
                0 ||' '||-- NUM_ENCTRO_CTA,
                0 ||' '||-- IDI_TIP_PAGTO,
                ''''||' ' ||''''||' '||-- COD_ESTAB_CONTRAT_CAMBIO,
                ''''||' ' ||''''||' '||-- COD_REFER_CONTRAT_CAMBIO,
                NULL ||' '||--DAT_REFER_CONTRAT_CAMBIO,
                0 ||' '||-- VAL_PIS, --   Programa integracao
                0 ||' '||-- VAL_COFINS, --   Cofins
                0 ||' '||-- VAL_CSLL, --   Contrib social sobre
                0 ||' '||-- VAL_PIS_FASB, --   Programa integracao
                0 ||' '||-- VAL_COFINS_FASB, --   Cofins Fasb
                0 ||' '||-- VAL_CSLL_FASB, --   Contrib social sobre
                0 ||' '||-- VAL_PIS_CMCAC, --   Programa integracao
                0 ||' '||-- VAL_COFINS_CMCAC, --   Cofins Cmcac
                0 ||' '||-- VAL_CSLL_CMCAC, --   Contrib social sobre
                NULL ||' '||--DAT_VINCUL_CONTRAT_CAMBIO,
                ''''||' ' ||''''||' '||-- COD_CTA_CTBL_DB,
                ''''||' ' ||''''||' '||-- COD_CCUSTO_DB,
                0 ||' '||-- LOG_RETENC_IMPTO,
                0 ||' '||-- LOG_ESTORDO_IMPTO_RETID,
                ''''||' ' ||''''||' '||-- COD_LIVRE_1,
                ''''||' ' ||''''||' '||-- COD_LIVRE_2,
                0 ||' '||-- LOG_LIVRE_1,
                0 ||' '||-- LOG_LIVRE_2,
                0 ||' '||-- NUM_LIVRE_1,
                0 ||' '||-- NUM_LIVRE_2,
                0 ||' '||-- VAL_LIVRE_1,
                0 ||' '||-- VAL_LIVRE_2,
                NULL ||' '||--DAT_LIVRE_1,
                NULL ||' '||--DAT_LIVRE_2,
                0 ||' '-- VAL_PAGTO,
                MOVIMENTO,
                TR.NRREGISTRO_TITULO

  FROM TITULO_A_RECEBER                 TR,
       PESSOA                           PS,
       TI_TIPO_MOVIMENTO_TIT_ACR        TMT,
       PRODUCAO.CLIENTE@UNICOO_HOMOLOGA UCL,
       EMS5.CLIENTE                     ECL,
       TI_PESSOA                        TIP,
       TI_EMPRESA                       EMP,
       HISTORICO_DO_TITULO              HDT,
       EMS_TRANSACAO_ACR                E
 WHERE ECL.CDN_CLIENTE = TIP.CDN_CLIENTE
   AND TIP.NRREGISTRO = UCL.NRREGISTRO_CLIENTE
   AND UCL.CDCLIENTE = TR.CDCLIENTE
   AND TR.NRREGISTRO_TITULO = HDT.NRREGISTRO_TITULO
   AND HDT.CDMOVIMENTO = E.CDMOVIMENTO
   AND TMT.NRSEQUENCIAL =
       F_TI_TIP_MOVTO_TIT_ACR(TR.CDEMPRESA,
                              DECODE(TR.TPDOCUMENTO, 'FAT', 'FT', 'CR'),
                              DECODE(DECODE(TR.TPDOCUMENTO,
                                            'FAT',
                                            'FT',
                                            'CR'),
                                     'CR',
                                     TR.CDHISTORICO,
                                     SUBSTR(TR.NRDOCUMENTO, 0, 2)),
                              NVL(ECL.COD_GRP_CLIEN, TMT.COD_GRP_CLIEN))
   AND PS.NRREGISTRO = UCL.NRREGISTRO_CLIENTE
   AND EMP.CDEMPRESA = TR.CDEMPRESA
   AND NVL(ECL.COD_EMPRESA, F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')) =
       EMP.COD_EMPRESA
;

prompt
prompt Creating view VI_DESCONTO_DUPLICADO
prompt ===================================
prompt
CREATE OR REPLACE FORCE VIEW EMS506UNICOO.VI_DESCONTO_DUPLICADO AS
SELECT TR.VLTITULO,
        F_SALDO_TITULO_RECEBER(TR.NRREGISTRO_TITULO) VLSALDO,
        TR.VLRECEBIDO,
        TR.VLDESCONTO,
        TR.VLDESCONTO / 2 VLDIF,
        (F_SALDO_TITULO_RECEBER(TR.NRREGISTRO_TITULO) * -1) VLDIF2,
        TR.NRREGISTRO_TITULO
   FROM TITULO_A_RECEBER TR
  WHERE F_SALDO_TITULO_RECEBER(TR.NRREGISTRO_TITULO) < 0
    AND EXISTS (SELECT 1
           FROM HISTORICO_DO_TITULO HT
          WHERE HT.DTMOVIMENTO >= '01/10/2014'
            AND HT.NRREGISTRO_TITULO = TR.NRREGISTRO_TITULO
            AND HT.NRDOCUMENTO = TR.NRDOCUMENTO
            AND HT.CDMOVIMENTO = 70)
    AND (F_SALDO_TITULO_RECEBER(TR.NRREGISTRO_TITULO) * -1) =
        (TR.VLDESCONTO / 2)
 --AND ABS(F_SALDO_TITULO_RECEBER(TR.NRREGISTRO_TITULO)) =(TR.VLDESCONTO/2)
;

prompt
prompt Creating package INF$_LOG
prompt =========================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."INF$_LOG"
IS
  PROCEDURE Cria_Replicacao;

  PROCEDURE Cria_Log(PnoDonoTabela IN varchar2, PnoTabela IN varchar2,
  PnoTablespaceDados in varchar2,PnoTablespaceIndice in varchar2);

  PROCEDURE Cria_Rep(PnoDonoTabela IN varchar2, PnoTabela IN varchar2,
  PnoTablespaceDados in varchar2,PnoTablespaceIndice in varchar2);

END INF$_LOG;
/

prompt
prompt Creating package INF$_UTL
prompt =========================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."INF$_UTL" AUTHID CURRENT_USER is

  -- Author  : CARLOS
  -- Created : 13/01/2006 17:51
  -- Ult.Alt.: 18/03/2006 17:52
  -- Objetivo : Pacotes de utilitarios gerais

  /*
A DESENVOLVER:
   *) Colocar o processo de contagem
         .contagem_inicio(nrTotal);
         .contagem_atualiza(nrAtual);
         .contagem_finaliza();
         .contagem_recupera(nrtotal,nratual,perc_atual);
         formato: action->
                  client_info-> #9999999999/9999999999;%999/100;
         controlar o nome do processo e que fase que esta

   *) colocar o processo de registro de logs
        .Registro_Inicio
        .Registro_grava
        .Registro_Fecha
        .Registro_Recupera
        Processo de gravar em arquivo texto ou em buffer no servidor oracle para que
              no final do processo recupere as informacoes de logs gerados.
              e util em processo que da o commit so no final, e e necessario verificar o
              log do que aconteceu se n?o finalizou o processo.

   *) colocar processo de chave de controle de informacoes das tabelas
       o processo consiste em ter 2 ou 3 bytes que sejam o byte de controle de cada linha da tabela
       e no final tem uma chave que contera o numero de linhas e os bytes de controle de cada linha
       e isto ficara armazenado numa tabela especifica para o ocntrole do conteudo.
       Isto e util para tabelas que tenham o conteudo configurado na informenge e n?o devam ser alterados
       e com o processo de verificaca pode-se saber qual linha foi alterado.
       tabela de controle_conteudo (nodono,notabela,nrtamanho_linha,nrtotal_linha,nrbytes_chave,txchave)
       considerando que a chave tenha 4 bytes aparentemente da para controlar 8192 linhas com o tamanho medio de 1024 bytes
       processo de gera_chave_conteudo, verifica_conteudo.

DESENVOLVIDO:
 13/01) Criacao da package
        Criacao da procedure Executa_Sql_Dinamico
 16/02) Separacao das procedures abre_cursor e fecha_cursor para
        utilizar apenas um unico cursor aberto durante o processo.
 18/02) Utilizacao de tabela de memoria em vez de campo varchar2
        para objetos maiores que 32K

 */
    procedure Executa_SQL_Dinamico( ptxComandoSQl    IN CLOB,
                                    pcdRetorno       OUT varchar2,
                                    pnrRegProcessado OUT number,
                                    ptxErro          OUT varchar2
                                  );
    procedure abre_cursor;
    procedure fecha_cursor;
    procedure exporta_dados( ptab       in varchar2,
                             powner     in varchar2
                           );

    procedure importa_dados( ptab       in varchar2,
                             pfazupdate in varchar2
                           );
end INF$_UTL;
/

prompt
prompt Creating package INF$_VERSAO
prompt ============================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."INF$_VERSAO" AUTHID CURRENT_USER is

  -- Autor    : CARLOS
  -- Criado   : 28/11/2004 19:03
  -- Ult.Alt. : 11/07/2006 15:28
  -- Objetivo : INSTALACAO E ATUALIZACAO DE VERSAO

/*
   Comandos criados por Fabiano em 29/06/2006

   /SUB --> Comando origem subistituido por outro
   /IGN --> Comando nao deve ser aplicado, entao ignora
   /ESX --> Erro de Sintaxe
   /SCH --> Sem Chance, deve prever o caso pois ha restricoes
   /EXC --> Comando aparentemente ja foi executado, mas nao identificou como ok
   /CCM --> Completar comando
   /NAP --> Nao aplicado neste momento, mas tudo certo com o comando
   /OWF --> Owner fixo
   /CST --> Customizacao no destino
*/

/*
A DESENVOLVER:


   *) revoke esta gerando erro: "ORA-00990: missing or invalid privilege"

   *) Na Gera_comandos Indice nao esta tratando ASC/DESC

   *) Complementar  funcao acerta_dono: para resolucao da troca do nome do usuario

   *) Prever controle de objetos custumizados e objetos de replicacao
       LG$_REPCTRL_VIEWM (REP_VIEW_MATERIALIZADA)
                  -- cadastro de views materializadas
       REP_OBJETO_CUSTOM
                  -- cadastro de objetos customizados

   *) Prever:
        Dominio (tabela_de_codigo)                                UDO
        Parametros                                                UPA
        Relatorios (Gerador)                                      URE
        Arquivos (Gerador)                                        UAR
        Logs     (Gerador)                                        ULG
        Menu                                                      UME


DESENVOLVIDO:
 16/01) Criacao dos processos para carga/implemtacao de objetos
 22/02) Implementacao do modelo de repositorio REP_....
 15/03) Create sequence tem ";" - retirar
 15/03) falta o nome do dono (usuario) no drop sequence
 15/03) No altera sequence colocar (usuario) e retirar star with (nao pode ter) e retirar ";"
 15/03) Create index nao pode ter pctused
 15/03) using index nao pode ter pctused (pk e uk)
 15/03) invalid caracter no grant (;)
 15/03) no alter constraint esta UNIQUE KEY e deve ser so UNIQUE
 15/03) Alter table add constraint (foreing key) referentes falta o nome do dono (usuario)
 15/03) Alter table ... modify constraint PK FK ou UK nao existe
 15/03) Create index com relacao de campo vazia - alguns casos (caso de alteracoes troca de tabela)
 15/03) Aspas dentro de comentarios de colunas -> tratar aspas
 15/03) Alter table com add coluna NOT NULL -> separar em 3 comandos:
        - Alter table ...Add coluna
        - Alter table add constraint NOT NULL
        - script para preenchimento da coluna
 17/03) Preparar email descrever o programa para exportar/importar xml e rodar o processo
 20/03) Erro na compilacao dos programas ORA-24344: success with compilation error
      verificar pois da como OK
      o problema era o chr(13)+chr(10) e o oracle considera apenas chr(10) LF
      testar os comandos:
             idrepositorio = 3 and idelemento = 282 and nritem = 1  - gerado
             idrepositorio = 3 and idelemento = 282 and nritem = 2  - alterar a mao
             FN_ANS_VINCULO_BENEFICIARIO
      testar tambem colocar o usuario entre "" e o nome tambem ""
21/03) melhorar a resolucao de sequencia pela dependencia dos objetos procedure acerta_sequencia
      COLOCAR O TESTE2 NA PACKAGE.. FALTA INICIAR POR TBL E SEQ.
21/03) colocar o script de execucao de implementacao como procedure
21/03) carrega_objetos, quando esta gravado no dba_source com espaco antes do nome da funcao,proce
       estava trazendo o espaco e na criacao iria dar erro. corrigido retirando o espaco a esquerda
       quando for a primeira linha
22/03) carrega_view: 1) substitui chr(13) por chr(10) e chr(13)+chr(10) por chr(10)
                     2) retirar os espacos no final da linha
                     3) Retirar as linhas em branco no final da view
22/03) carrega_source: 1) retira os espacos no final da linha
                       2) Retirar as linhas em branco no final da procedure,function,package...
22/03) carrega_trigger:1) retira os espacos no final da linha
                       2) Retirar as linhas em branco no final da trigger
22/03) Apura_Diferenca (trigger)
       qdo houver qualquer alteracao na trigger forca a alteracao dos campos e do corpo (prgs)
22/03) carrega_table: retirar os fim+de+linha e espacos do final
26/03) Retirado';' do create e drop synonym, estava gerando o erro: "ORA-00911: invalid character"
31/03) Corrigido:Na Carga de Objetos (carrega_objetos) esta fixo o numero (1) e o texto
31/03) Corrigido:Na Apuracao de diferenca (apura_diferencas) esta fixo o numero do repositorio (3)
11/07) Separado em uma instrucao para cada campo apenas quando for alteracao de campo em uma tabela ja existente
       para que fique mais facil de descobrir qual campo e quando der erro na efitivac?o da alterac?o
11/07) Corrigido, quando e  Alterac?o de PK,UK,FK esta gerando apenas add constraint e esta faltando a drop contraint
11/07) Corrigido o erro: alter table ... modify constraint check... esta gerando erro: "ORA-00933: SQL command not properly ended"
       Agora as contraints de check quando sobre alteracao apaga e cria novamente.
11/07) Alter table ... add constraint ... foreign key ( ) references .. esta gerando erro: "ORA-00936: missing expression"
       acontece quando nao teve mudancas nos campos mas sim em deferralble ,etc
       no apurar diferenca de constraints quado for alteracao sempre descarregar todos os campos
11/07) Corrigido a sequencia dos comandos: Esta dropando a tabela e depois as constraint de uk,pk,e fk
07/08) Acrescentado os campos de tpacao e tpelemento na tabela rep_aux_comandos bem como o tratamento para o preenchimento
21/08) Corrigido a sequencia dos comandos: quando dropava primary key e criava a primary key de uma mesma tabela n?o estava na ordem correta
01/09) Corrigido o estouro na carga da view quando era maior que 32K na procedure carrega_view.
01/09) apura_diferenca consiste se os nomes s?o iguais dos usuarios e agora tem commit no final
30/09) Corrigir o estouro na geracao do comando da view quando era maior que 32K na procedure gera_view.
30/09) Criado o campo rep_identificacao.txrepositorio para o texto indicativo do que representa o repositorio gerado
       e alterado o campo TXORIGEM para NOUSUORIGEM, deixando mais claro o que significa o campo.
30/09) Criado o campo rep_aux_comandos.nrfase para processar a execucao dos comandos por fase e algerado a procedure
       implementa_objeto para exigir a fase
30/09) Criada a procedure ALTERA_NOME_USUARIO
30/09) Criada a procedure APAGA_REPOSITORIO

  */


 /*   function CHECA_PRE_REQUISITO(PcdSistema IN VARCHAR2,
                           PcdModulo IN VARCHAR2,
                           PnrVersao_Req IN VARCHAR2,
                           PaoTipo IN VARCHAR2 := NULL)
                    return VARCHAR2;

    function REGISTRA_VERSAO(PcdSistema IN VARCHAR2,
                      PcdModulo IN VARCHAR2,
                      PnrVersao IN VARCHAR2,
                      PdtVersao in DATE,
                      PaoTipo IN VARCHAR2 := NULL)
               return VARCHAR2;*/

    procedure IMPLEMENTA_OBJETO (pIdRepositorio in number,
                                 pNrFase        in number,
                                 pnrSequencia   in number := null,
                                 pcdSituacao    in varchar2 := null);

    procedure APURA_DIFERENCAS (pIdReposOrigem  in number,
                                pIdReposDestino in number,
                                pIdReposDifer   in number);

    procedure CARREGA_OBJETOS (pIdRepositorio in number,
                               pnoUsuOrigem  in varchar2,
                               ptxRepositorio in varchar2);

    procedure GERA_COMANDOS (pidRepositorio in number);


    procedure ALTERA_NOME_USUARIO (pIdRepositorio  in number,
                                   pnoUsuOrigem    in varchar2,
                                   pnoUsuDestino   in varchar2);

    procedure APAGA_REPOSITORIO (pIdRepositorio  in number,
                                 ptxConfirma     in varchar2);


    procedure gera_fase( pIdRepositorio in number );
/*
========= INFORMACOES ==========

Metodo:
   os objetos sao classificados em
      Tipo: Tabela, Indice,Procedure,Menu ... etc
      Subtipo: Tabela:  Tabela Log, Tabela Tempor , indice Log, Indice Tempor
      Tamanho: Grande,Medio,Pequeno
      Crescimento: Rapido, Medio, Lento
      e de acordo com a classificacao e acrescentado os parametros de armazenamento

OBJETOS/ELEMENTOS DA BASE DE DADOS
   Create table                                              TBL
   Comment on table                                          CMT
   Comment on column                                         CMC
   Alter table...add constraint...check       (C)            CCH
   Alter table...add constraint...foreign key (R)            CFK
   Alter table...add constraint...primary key (P)            CPK
   Alter table...add constraint...unique key  (U)            CUK
   Create index                                              IDX
   Create sequence                                           SEQ
   Create view                                               VIW
   Create FUNCTION                                           FUN
   Create PACKAGE,PACKAGE BODY                               PCK
   Create PROCEDURE                                          PRO
   Create TRIGGER                                            TRG
   Create TYPE, TYPE BODY                                    TYP
   Create JAVA SOURCE                                        JAV
   Create synonym                                            SYN
   Grant                                                     PRV

   ** Nao Trata:
      Database links     dln
      Clusters           clu
      Jobs               job
      Libraries          lib
      Directories        dir
      Queues             que
      Materialized Views vim
      Dimension          dim
      Java Class         jcl
      Java Data          jdt

OBJETOS/ELEMENTOS DO PRODUTO UNICOO
   Menu                                                      UME
   Dominio (tabela_de_codigo)                                UDO
   Parametros                                                UPA
   Relatorios (Gerador)                                      URE
   Arquivos (Gerador)                                        UAR
   Logs     (Gerador)                                        ULG

OUTROS ELEMENTOS
   Scripts SQL                                               SQL
   Dados de Tabelas                                          DAD (?)

*/

end INF$_VERSAO;
/

prompt
prompt Creating package PCK_ATIVO_FIXO
prompt ===============================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_ATIVO_FIXO" AS
  /*
  ***************************************************************************************************************
  Criac?o          : Edmilson Braz Filho
  Data             : 07/12/2013
  Objetivo         : Integrar os Titulos do Sistema MV com o Ativo Fixo.

  Alterac?es
  +----------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                     |
  |----------------------------------------------------------------------------------------------------------------------------------------|
  | 07/12/2013 | Edmilson Braz |               |           | Criac?o da Func?o.                                                            |
  +----------------------------------------------------------------------------------------------------------------------------------------+
  ****************************************************************************************************************
  */

  Type Cursor_Type is ref Cursor;

  PROCEDURE P_INTEGRA_ATIVO_FIXO(P_DTINICIO  in DATE,
                                 P_DTFIM     in DATE,
                                 P_RESULTADO out pck_ativo_fixo.Cursor_type);

END;
/

prompt
prompt Creating package PCK_BX78_TIT_EMS
prompt =================================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_BX78_TIT_EMS" is

  /*
  ************************************************************************************************************************************************
  Criac?o          : Alessandro de Paula Santos
  Data             : 04/02/2015
  Modulo Principal : Integrac?o Unicoo X EMS5
  Modulos          : Integrac?o Unicoo X EMS5
  Objetivo         : Realizar a integrac?o do Unicoo com o EMS5 baixa movimento 78
  Alteracoes
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
  |----------------------------------------------------------------------------------------------------------------------------------------------|
  | 16/09/2014 | Alessandro      |                 |           | - Criação PCK.                                                                  |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  ************************************************************************************************************************************************
  */
  -- Public type declarations
  /*  type <TypeName> is <Datatype>;

  -- Public constant declarations
  <ConstantName> constant <Datatype> := <Value>;

  -- Public variable declarations
  <VariableName> <Datatype>;


  -- Public function and procedure declarations
  function <FunctionName>(<Parameter> <Datatype>) return <Datatype>;*/
  gCommit           number := 0;

  gSessao_Movimento number := 500;

  type cursor_type is ref cursor;

  procedure p_ins_bx_controle(pcdidentificador               varchar2,
                              pnrsequencial_origem           number   default null,
                              pcdmodulo                      varchar2 default null,
                              pcdempresa                     varchar2 default null,
                              pnrseq_controle_integracao_org number   default null);

  procedure p_commit;

  procedure p_processa_acr78(pnrsequencial   in number  default null,
                           pnrsessao       in number  default null,
                           pcdsituacao                in out varchar2);

end pck_bx78_tit_ems;
/

prompt
prompt Creating package PCK_BX_TIT_EMS
prompt ===============================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_BX_TIT_EMS" is

  /*
  ************************************************************************************************************************************************
  Criac?o          : Alessandro de Paula Santos
  Data             : 16/09/2014
  Modulo Principal : Integrac?o Unicoo X EMS5
  Modulos          : Integrac?o Unicoo X EMS5
  Objetivo         : Realizar a integrac?o do Unicoo com o EMS5
  Alteracoes
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
  |----------------------------------------------------------------------------------------------------------------------------------------------|
  | 16/09/2014 | Alessandro      |                 |           | - Criação PCK.                                                                  |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  ************************************************************************************************************************************************
  */
  -- Public type declarations
  /*  type <TypeName> is <Datatype>;

  -- Public constant declarations
  <ConstantName> constant <Datatype> := <Value>;

  -- Public variable declarations
  <VariableName> <Datatype>;


  -- Public function and procedure declarations
  function <FunctionName>(<Parameter> <Datatype>) return <Datatype>;*/
  gCommit number := 0;

  gSessao_Movimento number := 500;

  type cursor_type is ref cursor;

  procedure p_ins_bx_controle(pcdidentificador               varchar2,
                              pnrsequencial_origem           number default null,
                              pcdmodulo                      varchar2 default null,
                              pcdempresa                     varchar2 default null,
                              pnrseq_controle_integracao_org number default null);

  procedure p_commit;

  procedure p_processa_acr(pnrsequencial in number default null,
                           pnrsessao     in number default null,
                           pcdsituacao   in out varchar2);

  procedure p_processa_apb(pnrsequencial in number default null,
                           pnrsessao     in number default null,
                           pcdsituacao   in out varchar2);

  PROCEDURE P_BX_TIT_PERDA(pNrMovimento historico_do_titulo.nrmovimento%type); --vinicius 25/03/2015

end pck_bx_tit_ems;
/

prompt
prompt Creating package PCK_EMS506ACERTOS_INTEGRACAO
prompt =============================================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_EMS506ACERTOS_INTEGRACAO" is
  procedure pacertafornecedor;
 end;
/

prompt
prompt Creating package PCK_EMS506CUSTOM
prompt =================================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_EMS506CUSTOM" is

  -- Author  : ALECSANDRO
  -- Created : 02/07/2009 17:04:09
  -- Purpose : Alecsandro Ferreira dos Santos

  -- Public type declarations
  /*  type <TypeName> is <Datatype>;

  -- Public constant declarations
  <ConstantName> constant <Datatype> := <Value>;

  -- Public variable declarations
  <VariableName> <Datatype>;


  -- Public function and procedure declarations
  function <FunctionName>(<Parameter> <Datatype>) return <Datatype>;*/

  gCommit number := 0;
  gSessao_Movimento number:=500;
  type cursor_type is ref cursor;



  procedure p_TI_Movimento_Cta_Corrente(pnrseq_controle_integracao number,
                         pnrsessao                  number,
                         pcdsituacao                in out varchar2);



end PCK_EMS506CUSTOM;
/

prompt
prompt Creating package PCK_EMS506UNICOO
prompt =================================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_EMS506UNICOO" IS

  /*
  ************************************************************************************************************************************************
  Criac?o          : Alecsandro Ferreira dos Santos
  Data             : 02/07/2009
  Modulo Principal : Integrac?o Unicoo X EMS5
  Modulos          : Integrac?o Unicoo X EMS5
  Objetivo         : Realizar a integrac?o do Unicoo com o EMS5
  Alteracoes
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
  |----------------------------------------------------------------------------------------------------------------------------------------------|
  | 09/03/2012 | Alessandro      |                 |           | - Implementada controle de cancelamento de faturas, para permitir cancelar      |
  |            |                 |                 |           |   faturas no modulo faturamento que est?o contabilizadas no EMS5, foi criado o  |a
  |            |                 |                 |           |   parametro CANCELFTCTBL com o valor "S" utiliza o controle, valor "N" n?o      |
  |            |                 |                 |           |   utiliza o controle.                                                           |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 21/03/2012 | Alessandro      |                 |           | - Foi realizado correc?o para controla a integrac?o das Faturas Cancelas com o  |
  |            |                 |                 |           |   EMS5, o parametro CANCELFTCTBL foi alterado, com o valor "S" n?o mudou, para  |
  |            |                 |                 |           |   o valor "N" a integrac?o n?o barra o cancelamento no modulo de Faturamento,   |
  |            |                 |                 |           |   mas so envia o estorno para o EMS5 quando o titulo esta contabilizado,        |
  |            |                 |                 |           |   enquanto isso o cancelamento fica pendente na integrac?o com a situac?o ER,   |
  |            |                 |                 |           |   quando o titulo e contabilizado a integrac?o libera o cancelamento            |
  |            |                 |                 |           |   para integrar.                                                                |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 31/05/2012 | Edmilson Braz Fo|                 |           | - O processo de integracao do ACR estava usando o historico do movimento 1 do   |
  |            |                 |                 |           |   titulo a receber para titulos sem fatura, porem, para o ajius n?o esta sendo  |
  |            |                 |                 |           |   o historico nesse movto, o processo foi alterado para pegar o titulo caso     |
  |            |                 |                 |           |   nulo no movimento.                                                            |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 26/09/2012 | Josias Rodrigues|                 |           | - Foram impororados os objetos: p_vincula_imposto_fornec,                       |
  |            |                 |                 |           |   p_gerar_dados_banc_fornec, p_contabilizacao                                   |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  ************************************************************************************************************************************************
  */

  -- Public type declarations
  /*  type <TypeName> is <Datatype>;

  -- Public constant declarations
  <ConstantName> constant <Datatype> := <Value>;

  -- Public variable declarations
  <VariableName> <Datatype>;


  -- Public function and procedure declarations
  function <FunctionName>(<Parameter> <Datatype>) return <Datatype>;*/

  GCOMMIT           NUMBER := 0;
  GCOUNTOFRECORDS   NUMBER := F_TI_PARAMETRO_INTEGRACAO('COMMIT');
  GSESSAO_MOVIMENTO NUMBER := 500;
  vlmatriz          number := 0;
  TYPE CURSOR_TYPE IS REF CURSOR;

  PROCEDURE P_INS_TI_CONTROLE_INTEGRACAO(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER);

--  FUNCTION F_MIGRA_VENDEDORES RETURN VARCHAR2;
  procedure P_MIGRA_VENDEDORES;

  PROCEDURE P_DEFINE_TI_PESSOA(PNRCGC_CPF              VARCHAR2,
                               PNOPESSOA               VARCHAR2,
                               PNOABREVIADO            VARCHAR2,
                               PDTNASCIMENTO           DATE,
                               PTPPESSOA               VARCHAR2,
                               PNRREGISTRO             NUMBER,
                               PTPORIGEM               VARCHAR2,
                               PNOABREVIADO_FORNECEDOR IN OUT VARCHAR2,
                               PCDN_FORNECEDOR         IN OUT VARCHAR2,
                               PNOABREVIADO_CLIENTE    IN OUT VARCHAR2,
                               PCDN_CLIENTE            IN OUT VARCHAR2,
                               PAODEFINEPESSOA         VARCHAR2 -- < s/n>
                               );

  /*procedure p_ti_tit_acr_estorno(pnrseq_controle_integracao number,
                              pNRDOCUMENTO                   VARCHAR2,
                              pCDSituacao                in out varchar2);
  */

  PROCEDURE P_TI_TIT_ACR_ESTORNO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PNRDOCUMENTO               VARCHAR2,
                                 PCDSITUACAO                IN OUT VARCHAR2,
                                 PNRSESSAO                  NUMBER);

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_ACR(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;

  PROCEDURE P_JOB_ERRO;
  PROCEDURE P_JOB_FALHA;

  FUNCTION F_PERMITE_CANC_INT_FI_TIT_APB(PCDUNIMED VARCHAR2,
                                         PNRFATURA VARCHAR2) RETURN VARCHAR2;

  PROCEDURE P_UPDATE_CONTROLE_INTEGRACAO(PNRSEQUENCIAL NUMBER,
                                         PCDSITUACAO   VARCHAR2,
                                         PTXOBSERVACAO VARCHAR2);

  PROCEDURE P_APAGA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER);
  PROCEDURE P_JOB;
  FUNCTION F_PERMITE_ALTERAR_TIT_ACR(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;
  FUNCTION F_PERMITE_ALTERAR_TIT_APB(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_APB(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;
  PROCEDURE P_COMMIT_NEW;
  PROCEDURE P_COMMIT;
  PROCEDURE P_VALIDA_CONTROLE_INTEGRACAO(PTPINTEGRACAO VARCHAR2,
                                         PNRSESSAO     NUMBER);

  PROCEDURE P_MONITOR_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PTPINTEGRACAO              VARCHAR DEFAULT '*');

  PROCEDURE P_TI_FORNECEDOR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                            PNRSESSAO                  NUMBER,
                            PCDSITUACAO                IN OUT VARCHAR2);
  PROCEDURE P_REPROCESSA_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                    P_TPINTEGRACAO             VARCHAR2);
  /*procedure p_reprocessa_integracao(pNRSeq_Controle_integracao number);*/

  PROCEDURE P_TI_CLIENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2);
  PROCEDURE P_TI_TIT_ACR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2);
  PROCEDURE P_TI_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2);

  PROCEDURE P_TI_MOVIMENTO_CTA_CORRENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                        PNRSESSAO                  NUMBER,
                                        PCDSITUACAO                IN OUT VARCHAR2);

  PROCEDURE P_TI_PROCESSA_INTEGRACAO(PTPINTEGRACAO    VARCHAR2,
                                     PNRSEQUENCIAL    NUMBER,
                                     PNRSESSAO        NUMBER,
                                     PCDIDENTIFICADOR VARCHAR2,
                                     PCDSITUACAO      IN OUT VARCHAR2);

  PROCEDURE P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                          PCDINTEGRACAO              VARCHAR2,
                          PTXFALHA                   VARCHAR2,
                          PTXAJUDA                   VARCHAR2,
                          PCDSITUACAO                IN OUT VARCHAR2,
                          PNRMENSAGEM                NUMBER DEFAULT NULL);

  PROCEDURE P_GERAR_DADOS_BANC_FORNEC;

  FUNCTION F_RET_MASC_BANCO(VPCOD_BANCO IN VARCHAR2, VPTIPO IN VARCHAR2)
    RETURN NUMBER;

  FUNCTION F_DEFINIR_NUMERICO(VP_CODIGO VARCHAR2) RETURN NUMBER;

  PROCEDURE P_VINCULA_IMPOSTO_FORNEC;
  PROCEDURE P_VINCULA_IMPOSTO_CLIENTE;

  PROCEDURE P_CONTABILIZACAO(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                             PNRPERIODO                 IN NUMBER,
                             PCDLOTE_INTEGRACAO         IN VARCHAR2,
                             PTXDESCRICAO_LOTE          IN VARCHAR2,
                             PDTLOTE                    IN DATE,
                             PCDEMPRESA                 IN VARCHAR2,
                             PTPPERIODO                 IN VARCHAR2,
                             PI_NRLOTE                  IN NUMBER,
                             PI_CDFUNCIONARIO           IN VARCHAR2);

  PROCEDURE P_INSERE_FORNECEDOR(PNRREGISTRO_TITULO IN NUMBER);
  PROCEDURE P_INSERE_CLIENTE(PNRREGISTRO_TITULO IN NUMBER);
  PROCEDURE VALIDA_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                           PCDFORNECEDOR_EMS5         IN NUMBER);

  PROCEDURE P_INS_TI_CONTROLE_INTEGR_CAN(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER);
  procedure P_CARGA_PESSOA_UNIMED;
  procedure P_COD_UNIMED_FORNECEDOR;

  procedure P_CARGA_INICIAL_FORNECEDOR;

  PROCEDURE P_CARGA_INICIAL_CLIENTE;

  PROCEDURE p_carga_tit_acr;

  PROCEDURE p_carga_tit_apb;

  procedure p_atualiza_status_cliente(p_qtsessoes number);
  procedure p_atualiza_status_cliente_JK(p_qtsessoes number);

  procedure p_atualiza_status_baixa_acr(p_qtsessoes number);

  procedure p_atualiza_status_fornecedor(p_qtsessoes number);
  procedure p_atualiza_status_fornec_JK(p_qtsessoes number);

  procedure p_atualiza_status_tit_apb(p_qtsessoes number);

  procedure p_atualiza_status_tit_apb_JK(p_qtsessoes number);

--  procedure p_atualiza_status_tit_acr(p_qtsessoes number);

  procedure p_atualiza_status_tit_acr_fech(p_qtsessoes number);
  procedure p_atualiza_status_tit_acr_aber(p_qtsessoes number);

  procedure p_atualiza_status_tit_acr_JK(p_qtsessoes number);

  procedure p_gera_carga_matriz_acr;
  procedure p_gera_carga_matriz_apb;

  procedure p_apagar_matriz_acr(papagar boolean);
  procedure p_apagar_matriz_apb(papagar boolean);

  procedure p_carga_tit_acr_fechado;

  procedure p_gera_dados_comparativo_acr;

  procedure p_gera_dados_comparativo_apb;

  procedure p_apaga_pessoa_juridica;

  procedure p_reprocessa_status_pe(pnrseq_controle_integracao ti_controle_integracao.nrsequencial%type,
                                   ptpintegracao              ti_controle_integracao.tpintegracao%type);

  procedure p_carga_baixa_tit_acr;
  procedure P_GERA_SERIE_NOTA;
  procedure p_atualiza_fluxo_financ_fornec;
  procedure P_ATUALIZA_BLOQUEIO_CLIENTE;

procedure insere_hash(ptpintegracao varchar2,
                      pnrsequencial_origem number,
                      pcdidentificador varchar2);

end pck_ems506unicoo;
/

prompt
prompt Creating package PCK_EMS506UNICOO_A
prompt ===================================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_EMS506UNICOO_A" IS

  /*
  ************************************************************************************************************************************************
  Criac?o          : Alecsandro Ferreira dos Santos
  Data             : 02/07/2009
  Modulo Principal : Integrac?o Unicoo X EMS5
  Modulos          : Integrac?o Unicoo X EMS5
  Objetivo         : Realizar a integrac?o do Unicoo com o EMS5
  Alteracoes
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
  |----------------------------------------------------------------------------------------------------------------------------------------------|
  | 09/03/2012 | Alessandro      |                 |           | - Implementada controle de cancelamento de faturas, para permitir cancelar      |
  |            |                 |                 |           |   faturas no modulo faturamento que est?o contabilizadas no EMS5, foi criado o  |a
  |            |                 |                 |           |   parametro CANCELFTCTBL com o valor "S" utiliza o controle, valor "N" n?o      |
  |            |                 |                 |           |   utiliza o controle.                                                           |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 21/03/2012 | Alessandro      |                 |           | - Foi realizado correc?o para controla a integrac?o das Faturas Cancelas com o  |
  |            |                 |                 |           |   EMS5, o parametro CANCELFTCTBL foi alterado, com o valor "S" n?o mudou, para  |
  |            |                 |                 |           |   o valor "N" a integrac?o n?o barra o cancelamento no modulo de Faturamento,   |
  |            |                 |                 |           |   mas so envia o estorno para o EMS5 quando o titulo esta contabilizado,        |
  |            |                 |                 |           |   enquanto isso o cancelamento fica pendente na integrac?o com a situac?o ER,   |
  |            |                 |                 |           |   quando o titulo e contabilizado a integrac?o libera o cancelamento            |
  |            |                 |                 |           |   para integrar.                                                                |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 31/05/2012 | Edmilson Braz Fo|                 |           | - O processo de integracao do ACR estava usando o historico do movimento 1 do   |
  |            |                 |                 |           |   titulo a receber para titulos sem fatura, porem, para o ajius n?o esta sendo  |
  |            |                 |                 |           |   o historico nesse movto, o processo foi alterado para pegar o titulo caso     |
  |            |                 |                 |           |   nulo no movimento.                                                            |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 26/09/2012 | Josias Rodrigues|                 |           | - Foram impororados os objetos: p_vincula_imposto_fornec,                       |
  |            |                 |                 |           |   p_gerar_dados_banc_fornec, p_contabilizacao                                   |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  ************************************************************************************************************************************************
  */

  -- Public type declarations
  /*  type <TypeName> is <Datatype>;

  -- Public constant declarations
  <ConstantName> constant <Datatype> := <Value>;

  -- Public variable declarations
  <VariableName> <Datatype>;


  -- Public function and procedure declarations
  function <FunctionName>(<Parameter> <Datatype>) return <Datatype>;*/

  GCOMMIT           NUMBER := 0;
  GCOUNTOFRECORDS   NUMBER := F_TI_PARAMETRO_INTEGRACAO('COMMIT');
  GSESSAO_MOVIMENTO NUMBER := 500;
  vlmatriz          number := 0;
  TYPE CURSOR_TYPE IS REF CURSOR;

  PROCEDURE P_INS_TI_CONTROLE_INTEGRACAO(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER);
  procedure P_MIGRA_VENDEDORES;

  PROCEDURE P_DEFINE_TI_PESSOA(PNRCGC_CPF              VARCHAR2,
                               PNOPESSOA               VARCHAR2,
                               PDTNASCIMENTO           DATE,
                               PTPPESSOA               VARCHAR2,
                               PNRREGISTRO             NUMBER,
                               PTPORIGEM               VARCHAR2,
                               PNOABREVIADO_FORNECEDOR IN OUT VARCHAR2,
                               PCDN_FORNECEDOR         IN OUT VARCHAR2,
                               PNOABREVIADO_CLIENTE    IN OUT VARCHAR2,
                               PCDN_CLIENTE            IN OUT VARCHAR2,
                               PAODEFINEPESSOA         VARCHAR2 -- < s/n>
                               );

  /*procedure p_ti_tit_acr_estorno(pnrseq_controle_integracao number,
                              pNRDOCUMENTO                   VARCHAR2,
                              pCDSituacao                in out varchar2);
  */

  PROCEDURE P_TI_TIT_ACR_ESTORNO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PNRDOCUMENTO               VARCHAR2,
                                 PCDSITUACAO                IN OUT VARCHAR2,
                                 PNRSESSAO                  NUMBER);

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_ACR(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;

  PROCEDURE P_JOB_ERRO;
  PROCEDURE P_JOB_FALHA;

  FUNCTION F_PERMITE_CANC_INT_FI_TIT_APB(PCDUNIMED VARCHAR2,
                                         PNRFATURA VARCHAR2) RETURN VARCHAR2;

  PROCEDURE P_UPDATE_CONTROLE_INTEGRACAO(PNRSEQUENCIAL NUMBER,
                                         PCDSITUACAO   VARCHAR2,
                                         PTXOBSERVACAO VARCHAR2);

  PROCEDURE P_APAGA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER);
  PROCEDURE P_JOB;
  FUNCTION F_PERMITE_ALTERAR_TIT_ACR(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;
  FUNCTION F_PERMITE_ALTERAR_TIT_APB(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_APB(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;
  PROCEDURE P_COMMIT_NEW;
  PROCEDURE P_COMMIT;
  PROCEDURE P_VALIDA_CONTROLE_INTEGRACAO(PTPINTEGRACAO VARCHAR2,
                                         PNRSESSAO     NUMBER);

  PROCEDURE P_MONITOR_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PTPINTEGRACAO              VARCHAR DEFAULT '*');

  PROCEDURE P_TI_FORNECEDOR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                            PNRSESSAO                  NUMBER,
                            PCDSITUACAO                IN OUT VARCHAR2);
  PROCEDURE P_REPROCESSA_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                    P_TPINTEGRACAO             VARCHAR2);
  /*procedure p_reprocessa_integracao(pNRSeq_Controle_integracao number);*/

  PROCEDURE P_TI_CLIENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2);
  PROCEDURE P_TI_TIT_ACR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2);
  PROCEDURE P_TI_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2);

  PROCEDURE P_TI_MOVIMENTO_CTA_CORRENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                        PNRSESSAO                  NUMBER,
                                        PCDSITUACAO                IN OUT VARCHAR2);

  PROCEDURE P_TI_PROCESSA_INTEGRACAO(PTPINTEGRACAO    VARCHAR2,
                                     PNRSEQUENCIAL    NUMBER,
                                     PNRSESSAO        NUMBER,
                                     PCDIDENTIFICADOR VARCHAR2,
                                     PCDSITUACAO      IN OUT VARCHAR2);

  PROCEDURE P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                          PCDINTEGRACAO              VARCHAR2,
                          PTXFALHA                   VARCHAR2,
                          PTXAJUDA                   VARCHAR2,
                          PCDSITUACAO                IN OUT VARCHAR2,
                          PNRMENSAGEM                NUMBER DEFAULT NULL);

  PROCEDURE P_GERAR_DADOS_BANC_FORNEC(VP_COD_EMPRESA IN NUMBER);

  FUNCTION F_RET_MASC_BANCO(VPCOD_BANCO IN VARCHAR2, VPTIPO IN VARCHAR2)
    RETURN NUMBER;

  FUNCTION F_DEFINIR_NUMERICO(VP_CODIGO VARCHAR2) RETURN NUMBER;

  PROCEDURE P_VINCULA_IMPOSTO_FORNEC;

  PROCEDURE P_CONTABILIZACAO(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                             PNRPERIODO                 IN NUMBER,
                             PCDLOTE_INTEGRACAO         IN VARCHAR2,
                             PTXDESCRICAO_LOTE          IN VARCHAR2,
                             PDTLOTE                    IN DATE,
                             PCDEMPRESA                 IN VARCHAR2,
                             PTPPERIODO                 IN VARCHAR2,
                             PI_NRLOTE                  IN NUMBER,
                             PI_CDFUNCIONARIO           IN VARCHAR2);

  PROCEDURE P_INSERE_FORNECEDOR(PNRREGISTRO_TITULO IN NUMBER);
  PROCEDURE P_INSERE_CLIENTE(PNRREGISTRO_TITULO IN NUMBER);
  PROCEDURE VALIDA_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                           PCDFORNECEDOR_EMS5         IN NUMBER);

  PROCEDURE P_INS_TI_CONTROLE_INTEGR_CAN(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER);
  procedure P_CARGA_PESSOA_UNIMED;
  procedure P_COD_UNIMED_FORNECEDOR;

  procedure P_CARGA_INICIAL_FORNECEDOR;

  PROCEDURE P_CARGA_INICIAL_CLIENTE;

  PROCEDURE p_carga_tit_acr;

  PROCEDURE p_carga_tit_apb;

  procedure p_carga_tit_acr_fechado;

  procedure p_atualiza_status_cliente(p_qtsessoes number);

  procedure p_atualiza_status_baixa_acr(p_qtsessoes number);

  procedure p_atualiza_status_fornecedor(p_qtsessoes number);

  procedure p_atualiza_status_tit_apb(p_qtsessoes number);

  procedure p_atualiza_status_tit_acr(p_qtsessoes number);

  procedure p_gera_carga_matriz_acr(vpcdempresa  varchar2,
                                    vpdtcontabil date,
                                    vpdtvenc_ini date,
                                    vpdtvenc_fin date);

  procedure p_gera_carga_matriz_apb(vpcdempresa  varchar2,
                                    vpdtcontabil date,
                                    vpdtvenc_ini date,
                                    vpdtvenc_fin date);

  procedure p_gera_dados_comparativo_acr;

  procedure p_gera_dados_comparativo_apb;

  procedure p_apaga_pessoa_juridica;

  procedure p_reprocessa_status_pe(pnrseq_controle_integracao ti_controle_integracao.nrsequencial%type,
                                   ptpintegracao              ti_controle_integracao.tpintegracao%type);

  procedure p_carga_baixa_tit_acr;

  procedure p_atualiza_fluxo_financ_fornec;



end pck_ems506unicoo;
/

prompt
prompt Creating package PCK_EMS506UNICOO_UNIMEDJP
prompt ==========================================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_EMS506UNICOO_UNIMEDJP" is

  /*
  ************************************************************************************************************************************************
  Criac?o          : Jefferson M Ximenes
  Data             : 09/01/2014
  Modulo Principal : Integrac?o Unicoo X EMS5
  Modulos          : Integrac?o Unicoo X EMS5
  Objetivo         : Realizar a integrac?o do Unicoo com o EMS5   Alteracoes

                     Criado para atender a necessidade de se processar título de forma individual no SistInt
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
  |----------------------------------------------------------------------------------------------------------------------------------------------|
             |                 |                 |           |                                                             |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  ************************************************************************************************************************************************
  */



  gCommit           number := 0;
  gCountofrecords   number := f_ti_parametro_integracao('COMMIT');
  gSessao_Movimento number := 500;
  type cursor_type is ref cursor;


  procedure p_reprocessa_integracao_UJP(pNRSeq_Controle_integracao number,
                                        P_TPINTEGRACAO             VARCHAR2);


  procedure p_envia_para_monitor(pNRSeq_Controle_integracao number );

  procedure p_gera_distrib_apb(pNRSeq_Controle_integracao number );

  procedure p_gera_imposto_apb(pNRSeq_Controle_integracao number );




end PCK_EMS506UNICOO_UNIMEDJP;
/

prompt
prompt Creating package PCK_EMS506UNICOO_VINI
prompt ======================================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_EMS506UNICOO_VINI" IS

  /*
  ************************************************************************************************************************************************
  Criac?o          : Alecsandro Ferreira dos Santos
  Data             : 02/07/2009
  Modulo Principal : Integrac?o Unicoo X EMS5
  Modulos          : Integrac?o Unicoo X EMS5
  Objetivo         : Realizar a integrac?o do Unicoo com o EMS5
  Alteracoes
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
  |----------------------------------------------------------------------------------------------------------------------------------------------|
  | 09/03/2012 | Alessandro      |                 |           | - Implementada controle de cancelamento de faturas, para permitir cancelar      |
  |            |                 |                 |           |   faturas no modulo faturamento que est?o contabilizadas no EMS5, foi criado o  |a
  |            |                 |                 |           |   parametro CANCELFTCTBL com o valor "S" utiliza o controle, valor "N" n?o      |
  |            |                 |                 |           |   utiliza o controle.                                                           |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 21/03/2012 | Alessandro      |                 |           | - Foi realizado correc?o para controla a integrac?o das Faturas Cancelas com o  |
  |            |                 |                 |           |   EMS5, o parametro CANCELFTCTBL foi alterado, com o valor "S" n?o mudou, para  |
  |            |                 |                 |           |   o valor "N" a integrac?o n?o barra o cancelamento no modulo de Faturamento,   |
  |            |                 |                 |           |   mas so envia o estorno para o EMS5 quando o titulo esta contabilizado,        |
  |            |                 |                 |           |   enquanto isso o cancelamento fica pendente na integrac?o com a situac?o ER,   |
  |            |                 |                 |           |   quando o titulo e contabilizado a integrac?o libera o cancelamento            |
  |            |                 |                 |           |   para integrar.                                                                |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 31/05/2012 | Edmilson Braz Fo|                 |           | - O processo de integracao do ACR estava usando o historico do movimento 1 do   |
  |            |                 |                 |           |   titulo a receber para titulos sem fatura, porem, para o ajius n?o esta sendo  |
  |            |                 |                 |           |   o historico nesse movto, o processo foi alterado para pegar o titulo caso     |
  |            |                 |                 |           |   nulo no movimento.                                                            |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 26/09/2012 | Josias Rodrigues|                 |           | - Foram impororados os objetos: p_vincula_imposto_fornec,                       |
  |            |                 |                 |           |   p_gerar_dados_banc_fornec, p_contabilizacao                                   |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  ************************************************************************************************************************************************
  */

  -- Public type declarations
  /*  type <TypeName> is <Datatype>;

  -- Public constant declarations
  <ConstantName> constant <Datatype> := <Value>;

  -- Public variable declarations
  <VariableName> <Datatype>;


  -- Public function and procedure declarations
  function <FunctionName>(<Parameter> <Datatype>) return <Datatype>;*/

  GCOMMIT           NUMBER := 0;
  GCOUNTOFRECORDS   NUMBER := F_TI_PARAMETRO_INTEGRACAO('COMMIT');
  GSESSAO_MOVIMENTO NUMBER := 500;
  TYPE CURSOR_TYPE IS REF CURSOR;

  PROCEDURE P_INS_TI_CONTROLE_INTEGRACAO(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER);
  PROCEDURE P_DEFINE_TI_PESSOA(PNRCGC_CPF              VARCHAR2,
                               PNOPESSOA               VARCHAR2,
                               PDTNASCIMENTO           DATE,
                               PTPPESSOA               VARCHAR2,
                               PNRREGISTRO             NUMBER,
                               PTPORIGEM               VARCHAR2,
                               PNOABREVIADO_FORNECEDOR IN OUT VARCHAR2,
                               PCDN_FORNECEDOR         IN OUT VARCHAR2,
                               PNOABREVIADO_CLIENTE    IN OUT VARCHAR2,
                               PCDN_CLIENTE            IN OUT VARCHAR2,
                               PAODEFINEPESSOA         VARCHAR2 -- < s/n>
                               );

  /*procedure p_ti_tit_acr_estorno(pnrseq_controle_integracao number,
                              pNRDOCUMENTO                   VARCHAR2,
                              pCDSituacao                in out varchar2);
  */

  PROCEDURE P_TI_TIT_ACR_ESTORNO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PNRDOCUMENTO               VARCHAR2,
                                 PCDSITUACAO                IN OUT VARCHAR2,
                                 PNRSESSAO                  NUMBER);

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_ACR(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;

  PROCEDURE P_JOB_ERRO;
  PROCEDURE P_JOB_FALHA;

  FUNCTION F_PERMITE_CANC_INT_FI_TIT_APB(PCDUNIMED VARCHAR2,
                                         PNRFATURA VARCHAR2) RETURN VARCHAR2;

  PROCEDURE P_UPDATE_CONTROLE_INTEGRACAO(PNRSEQUENCIAL NUMBER,
                                         PCDSITUACAO   VARCHAR2,
                                         PTXOBSERVACAO VARCHAR2);

  PROCEDURE P_APAGA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER);
  PROCEDURE P_JOB;
  FUNCTION F_PERMITE_ALTERAR_TIT_ACR(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;
  FUNCTION F_PERMITE_ALTERAR_TIT_APB(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_APB(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;
  PROCEDURE P_COMMIT_NEW;
  PROCEDURE P_COMMIT;
  PROCEDURE P_VALIDA_CONTROLE_INTEGRACAO(PTPINTEGRACAO VARCHAR2,
                                         PNRSESSAO     NUMBER);

  PROCEDURE P_MONITOR_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PTPINTEGRACAO              VARCHAR DEFAULT '*');

  PROCEDURE P_TI_FORNECEDOR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                            PNRSESSAO                  NUMBER,
                            PCDSITUACAO                IN OUT VARCHAR2);
  PROCEDURE P_REPROCESSA_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                    P_TPINTEGRACAO             VARCHAR2);
  /*procedure p_reprocessa_integracao(pNRSeq_Controle_integracao number);*/

  PROCEDURE P_TI_CLIENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2);
  PROCEDURE P_TI_TIT_ACR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2);
  PROCEDURE P_TI_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2);

  PROCEDURE P_TI_MOVIMENTO_CTA_CORRENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                        PNRSESSAO                  NUMBER,
                                        PCDSITUACAO                IN OUT VARCHAR2);

  PROCEDURE P_TI_PROCESSA_INTEGRACAO(PTPINTEGRACAO    VARCHAR2,
                                     PNRSEQUENCIAL    NUMBER,
                                     PNRSESSAO        NUMBER,
                                     PCDIDENTIFICADOR VARCHAR2,
                                     PCDSITUACAO      IN OUT VARCHAR2);

  PROCEDURE P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                          PCDINTEGRACAO              VARCHAR2,
                          PTXFALHA                   VARCHAR2,
                          PTXAJUDA                   VARCHAR2,
                          PCDSITUACAO                IN OUT VARCHAR2,
                          PNRMENSAGEM                NUMBER DEFAULT NULL);

  PROCEDURE P_GERAR_DADOS_BANC_FORNEC(VP_COD_EMPRESA IN NUMBER);

  FUNCTION F_RET_MASC_BANCO(VPCOD_BANCO IN VARCHAR2, VPTIPO IN VARCHAR2)
    RETURN NUMBER;

  FUNCTION F_DEFINIR_NUMERICO(VP_CODIGO VARCHAR2) RETURN NUMBER;

  PROCEDURE P_VINCULA_IMPOSTO_FORNEC;

  PROCEDURE P_CONTABILIZACAO(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                             PNRPERIODO                 IN NUMBER,
                             PCDLOTE_INTEGRACAO         IN VARCHAR2,
                             PTXDESCRICAO_LOTE          IN VARCHAR2,
                             PDTLOTE                    IN DATE,
                             PCDEMPRESA                 IN VARCHAR2,
                             PTPPERIODO                 IN VARCHAR2,
                             PI_NRLOTE                  IN NUMBER,
                             PI_CDFUNCIONARIO           IN VARCHAR2);

  PROCEDURE P_INSERE_FORNECEDOR(PNRREGISTRO_TITULO IN NUMBER);
  PROCEDURE P_INSERE_CLIENTE(PNRREGISTRO_TITULO IN NUMBER);
  PROCEDURE VALIDA_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                           PCDFORNECEDOR_EMS5         IN NUMBER);

  PROCEDURE P_INS_TI_CONTROLE_INTEGR_CAN(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER);
  procedure P_CARGA_PESSOA_UNIMED;
  procedure P_COD_UNIMED_FORNECEDOR;

  procedure P_CARGA_INICIAL_FORNECEDOR;

  PROCEDURE P_CARGA_INICIAL_CLIENTE;

  PROCEDURE p_carga_tit_acr;

  PROCEDURE p_carga_tit_apb;

  procedure p_carga_tit_acr_fechado;

END PCK_EMS506UNICOO_vini;
/

prompt
prompt Creating package PCK_EMS506UNICOO_VJ
prompt ====================================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_EMS506UNICOO_VJ" IS

  /*
  ************************************************************************************************************************************************
  Criac?o          : Alecsandro Ferreira dos Santos
  Data             : 02/07/2009
  Modulo Principal : Integrac?o Unicoo X EMS5
  Modulos          : Integrac?o Unicoo X EMS5
  Objetivo         : Realizar a integrac?o do Unicoo com o EMS5
  Alteracoes
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
  |----------------------------------------------------------------------------------------------------------------------------------------------|
  | 09/03/2012 | Alessandro      |                 |           | - Implementada controle de cancelamento de faturas, para permitir cancelar      |
  |            |                 |                 |           |   faturas no modulo faturamento que est?o contabilizadas no EMS5, foi criado o  |a
  |            |                 |                 |           |   parametro CANCELFTCTBL com o valor "S" utiliza o controle, valor "N" n?o      |
  |            |                 |                 |           |   utiliza o controle.                                                           |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 21/03/2012 | Alessandro      |                 |           | - Foi realizado correc?o para controla a integrac?o das Faturas Cancelas com o  |
  |            |                 |                 |           |   EMS5, o parametro CANCELFTCTBL foi alterado, com o valor "S" n?o mudou, para  |
  |            |                 |                 |           |   o valor "N" a integrac?o n?o barra o cancelamento no modulo de Faturamento,   |
  |            |                 |                 |           |   mas so envia o estorno para o EMS5 quando o titulo esta contabilizado,        |
  |            |                 |                 |           |   enquanto isso o cancelamento fica pendente na integrac?o com a situac?o ER,   |
  |            |                 |                 |           |   quando o titulo e contabilizado a integrac?o libera o cancelamento            |
  |            |                 |                 |           |   para integrar.                                                                |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 31/05/2012 | Edmilson Braz Fo|                 |           | - O processo de integracao do ACR estava usando o historico do movimento 1 do   |
  |            |                 |                 |           |   titulo a receber para titulos sem fatura, porem, para o ajius n?o esta sendo  |
  |            |                 |                 |           |   o historico nesse movto, o processo foi alterado para pegar o titulo caso     |
  |            |                 |                 |           |   nulo no movimento.                                                            |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 26/09/2012 | Josias Rodrigues|                 |           | - Foram impororados os objetos: p_vincula_imposto_fornec,                       |
  |            |                 |                 |           |   p_gerar_dados_banc_fornec, p_contabilizacao                                   |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  ************************************************************************************************************************************************
  */

  -- Public type declarations
  /*  type <TypeName> is <Datatype>;

  -- Public constant declarations
  <ConstantName> constant <Datatype> := <Value>;

  -- Public variable declarations
  <VariableName> <Datatype>;


  -- Public function and procedure declarations
  function <FunctionName>(<Parameter> <Datatype>) return <Datatype>;*/

  GCOMMIT           NUMBER := 0;
  GCOUNTOFRECORDS   NUMBER := F_TI_PARAMETRO_INTEGRACAO('COMMIT');
  GSESSAO_MOVIMENTO NUMBER := 500;
  vlmatriz          number := 0;
  TYPE CURSOR_TYPE IS REF CURSOR;

  PROCEDURE P_INS_TI_CONTROLE_INTEGRACAO(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER);
  PROCEDURE P_DEFINE_TI_PESSOA(PNRCGC_CPF              VARCHAR2,
                               PNOPESSOA               VARCHAR2,
                               PDTNASCIMENTO           DATE,
                               PTPPESSOA               VARCHAR2,
                               PNRREGISTRO             NUMBER,
                               PTPORIGEM               VARCHAR2,
                               PNOABREVIADO_FORNECEDOR IN OUT VARCHAR2,
                               PCDN_FORNECEDOR         IN OUT VARCHAR2,
                               PNOABREVIADO_CLIENTE    IN OUT VARCHAR2,
                               PCDN_CLIENTE            IN OUT VARCHAR2,
                               PAODEFINEPESSOA         VARCHAR2 -- < s/n>
                               );

  /*procedure p_ti_tit_acr_estorno(pnrseq_controle_integracao number,
                              pNRDOCUMENTO                   VARCHAR2,
                              pCDSituacao                in out varchar2);
  */

  PROCEDURE P_TI_TIT_ACR_ESTORNO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PNRDOCUMENTO               VARCHAR2,
                                 PCDSITUACAO                IN OUT VARCHAR2,
                                 PNRSESSAO                  NUMBER);

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_ACR(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;

  PROCEDURE P_JOB_ERRO;
  PROCEDURE P_JOB_FALHA;

  FUNCTION F_PERMITE_CANC_INT_FI_TIT_APB(PCDUNIMED VARCHAR2,
                                         PNRFATURA VARCHAR2) RETURN VARCHAR2;

  PROCEDURE P_UPDATE_CONTROLE_INTEGRACAO(PNRSEQUENCIAL NUMBER,
                                         PCDSITUACAO   VARCHAR2,
                                         PTXOBSERVACAO VARCHAR2);

  PROCEDURE P_APAGA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER);
  PROCEDURE P_JOB;
  FUNCTION F_PERMITE_ALTERAR_TIT_ACR(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;
  FUNCTION F_PERMITE_ALTERAR_TIT_APB(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_APB(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2;
  PROCEDURE P_COMMIT_NEW;
  PROCEDURE P_COMMIT;
  PROCEDURE P_VALIDA_CONTROLE_INTEGRACAO(PTPINTEGRACAO VARCHAR2,
                                         PNRSESSAO     NUMBER);

  PROCEDURE P_MONITOR_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PTPINTEGRACAO              VARCHAR DEFAULT '*');

  PROCEDURE P_TI_FORNECEDOR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                            PNRSESSAO                  NUMBER,
                            PCDSITUACAO                IN OUT VARCHAR2);
  PROCEDURE P_REPROCESSA_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                    P_TPINTEGRACAO             VARCHAR2);
  /*procedure p_reprocessa_integracao(pNRSeq_Controle_integracao number);*/

  PROCEDURE P_TI_CLIENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2);
  PROCEDURE P_TI_TIT_ACR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2);
  PROCEDURE P_TI_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2);

  PROCEDURE P_TI_MOVIMENTO_CTA_CORRENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                        PNRSESSAO                  NUMBER,
                                        PCDSITUACAO                IN OUT VARCHAR2);

  PROCEDURE P_TI_PROCESSA_INTEGRACAO(PTPINTEGRACAO    VARCHAR2,
                                     PNRSEQUENCIAL    NUMBER,
                                     PNRSESSAO        NUMBER,
                                     PCDIDENTIFICADOR VARCHAR2,
                                     PCDSITUACAO      IN OUT VARCHAR2);

  PROCEDURE P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                          PCDINTEGRACAO              VARCHAR2,
                          PTXFALHA                   VARCHAR2,
                          PTXAJUDA                   VARCHAR2,
                          PCDSITUACAO                IN OUT VARCHAR2,
                          PNRMENSAGEM                NUMBER DEFAULT NULL);

  PROCEDURE P_GERAR_DADOS_BANC_FORNEC(VP_COD_EMPRESA IN NUMBER);

  FUNCTION F_RET_MASC_BANCO(VPCOD_BANCO IN VARCHAR2, VPTIPO IN VARCHAR2)
    RETURN NUMBER;

  FUNCTION F_DEFINIR_NUMERICO(VP_CODIGO VARCHAR2) RETURN NUMBER;

  PROCEDURE P_VINCULA_IMPOSTO_FORNEC;

  PROCEDURE P_CONTABILIZACAO(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                             PNRPERIODO                 IN NUMBER,
                             PCDLOTE_INTEGRACAO         IN VARCHAR2,
                             PTXDESCRICAO_LOTE          IN VARCHAR2,
                             PDTLOTE                    IN DATE,
                             PCDEMPRESA                 IN VARCHAR2,
                             PTPPERIODO                 IN VARCHAR2,
                             PI_NRLOTE                  IN NUMBER,
                             PI_CDFUNCIONARIO           IN VARCHAR2);

  PROCEDURE P_INSERE_FORNECEDOR(PNRREGISTRO_TITULO IN NUMBER);
  PROCEDURE P_INSERE_CLIENTE(PNRREGISTRO_TITULO IN NUMBER);
  PROCEDURE VALIDA_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                           PCDFORNECEDOR_EMS5         IN NUMBER);

  PROCEDURE P_INS_TI_CONTROLE_INTEGR_CAN(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER);
  procedure P_CARGA_PESSOA_UNIMED;
  procedure P_COD_UNIMED_FORNECEDOR;

  procedure P_CARGA_INICIAL_FORNECEDOR;

  PROCEDURE P_CARGA_INICIAL_CLIENTE;

  PROCEDURE p_carga_tit_acr;

  PROCEDURE p_carga_tit_apb;

  procedure p_carga_tit_acr_fechado(pdttitulo date);

  procedure p_atualiza_status_cliente (p_qtsessoes number);

  procedure p_atualiza_status_fornecedor(p_qtsessoes number);

  procedure p_atualiza_status_tit_apb(p_qtsessoes number);

  procedure p_gera_carga_matriz_acr(vpcdempresa  varchar2 ,
                                    vpdtcontabil date,
                                    vpdtvenc_ini  date ,
                                    vpdtvenc_fin   date );

  procedure p_gera_carga_matriz_apb(vpcdempresa  varchar2 ,
                                    vpdtcontabil date,
                                    vpdtvenc_ini  date ,
                                    vpdtvenc_fin   date );

  procedure p_gera_dados_comparativo_acr;

  procedure p_gera_dados_comparativo_apb;


  procedure p_apaga_pessoa_juridica;

end pck_ems506unicoo_VJ;
/

prompt
prompt Creating package PCK_EMS_ACR_UNICOO
prompt ===================================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_EMS_ACR_UNICOO" is

  -- Author  : ALECSANDRO
  -- Created : 26/11/2008 22:25:51
  -- Purpose : Alecsandro Ferreira dos Santos

  -- Alteracao : Alessandro
  -- Data      : 06/05/2010
  -- Desc.     : Controle de Desconto financeiro.

  -- Public type declarations
  --  type <TypeName> is <Datatype>;

  -- Public constant declarations
  cCDFuncionario       constant funcionario.cdfuncionario%type := 'EMSACR';
  cNRMotivo_Exc_titulo constant faturamento.nrmotivo_exclusao%type := 1;
  cTXMotivo_Exc_Titulo constant faturamento.txobservacoes%type := 'Exclus?o de titulo do EMS';

  -- Public variable declarations
  -- <VariableName> <Datatype>;
  procedure GravaFalha(pNum_id_movto_tit_acr number, pTxFalha varchar2);

  procedure atualizarTituloNoUnicoo(pNum_id_movto_tit_acr number,
                                    pNum_id_tit_acr       number,
                                    ptxfalha_unicoo       in out varchar2);
  procedure CorrigeTituloNoUnicoo;

  procedure AtualizaBaixaNoUnicoo;

  function BuscaTituloUnicoo(pNum_id_movto_tit_acr number) return boolean;

end pck_ems_acr_unicoo;
/

prompt
prompt Creating package PCK_EMS_ACR_UNICOO_BKP
prompt =======================================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_EMS_ACR_UNICOO_BKP" is

  -- Author  : ALECSANDRO
  -- Created : 26/11/2008 22:25:51
  -- Purpose : Alecsandro Ferreira dos Santos

    -- Alteracao : Alessandro
  -- Data      : 06/05/2010
  -- Desc.     : Controle de Desconto financeiro.

  -- Public type declarations
--  type <TypeName> is <Datatype>;

  -- Public constant declarations
  cCDFuncionario       constant funcionario.cdfuncionario%type := 'EMSACR';
  cNRMotivo_Exc_titulo constant faturamento.nrmotivo_exclusao%type :=1;
  cTXMotivo_Exc_Titulo constant faturamento.txobservacoes%type := 'Exclus?o de titulo do EMS';

  -- Public variable declarations
  -- <VariableName> <Datatype>;
  procedure GravaFalha( pNum_id_movto_tit_acr number,
                         pTxFalha               varchar2
                        ) ;

  procedure atualizarTituloNoUnicoo(
                                   pNum_id_movto_tit_acr number,
                                   ptxfalha_unicoo       in out varchar2
                                  );
  procedure CorrigeTituloNoUnicoo;

  procedure AtualizaBaixaNoUnicoo;

end pck_ems_acr_unicoo_bkp;
/

prompt
prompt Creating package PCK_EXECUTA_MIGRACAO
prompt =====================================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_EXECUTA_MIGRACAO" IS

  TYPE TYP_EXECUTAR IS RECORD(
    ROTINA VARCHAR2(400),
    ERRO   VARCHAR2(2000));

  TYPE TYP_TB_EXECUTAR IS TABLE OF TYP_EXECUTAR INDEX BY BINARY_INTEGER;

  PROCEDURE EXECUTAR(P_EXECUTAR IN OUT TYP_TB_EXECUTAR);

END;
/

prompt
prompt Creating package PCK_INTEGRA_PAGAMENTO_PAGAR
prompt ============================================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_INTEGRA_PAGAMENTO_PAGAR" is

  procedure pr_integra_pagamento_pagar(pnrseq_pagto_controle in number,
                                       pcdfuncionario        in varchar2,
                                       pSender               in Varchar2,
                                       pNrTempo              in Varchar2,
                                       pnrsequencial         out number,
                                       pHouve_falha          out Varchar2);

  procedure pr_cancela_integr_pagto_pagar(pnrseq_pagto_controle in number,
                                          pSender               in Varchar2,
                                          pNrTempo              in Varchar2,
                                          pHouve_falha          out Varchar2);

end  pck_integra_pagamento_pagar;
/

prompt
prompt Creating package PCK_UNICOO_GPS
prompt ===============================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_UNICOO_GPS" is

/*
************************************************************************************************************************************************
Criac?o          : Alecsandro Ferreira dos Santos
Data             : 02/07/2009
Modulo Principal : Integrac?o Unicoo X GPS
Modulos          : Integrac?o Unicoo X GPS
Objetivo         : Realizar a integrac?o do Unicoo com o GPS
Alteracoes
+----------------------------------------------------------------------------------------------------------------------------------------------+
| DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
|----------------------------------------------------------------------------------------------------------------------------------------------|
| 08/10/2014 | Alessandro      |                 |           |                                                                                 |
|            | Vinicius        |                 |           |
|            |                 |                 |           |
|            |                 |                 |           |
+----------------------------------------------------------------------------------------------------------------------------------------------+
************************************************************************************************************************************************
*/

  -- Public type declarations
  /*  type <TypeName> is <Datatype>;

  -- Public constant declarations
  <ConstantName> constant <Datatype> := <Value>;

  -- Public variable declarations
  <VariableName> <Datatype>;


  -- Public function and procedure declarations
  function <FunctionName>(<Parameter> <Datatype>) return <Datatype>;*/

  gCommit number := 0;
  gSessao_Movimento number:=500;
  type cursor_type is ref cursor;

  procedure p_proposta;
  procedure p_faixa_etaria_especial;
  procedure p_modulo_da_proposta;
  procedure p_situacao_da_proposta;
  procedure p_historico_tabela_preco;
  procedure p_termo_de_adesao;
  procedure p_carteira_do_usuario;


end pck_unicoo_gps;
/

prompt
prompt Creating package PCK_UNICOOGPS
prompt ==============================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."PCK_UNICOOGPS" is

  /*
  *********************************************************************************************************************************************
  criação          : vinicius justino
  data             : 02/12/2014 16:43
  módulo principal : migração
  módulos          : migração unicoo -> gestão de planos
  telas            : migração
  objetivo         :
  alteracoes
  +-------------------------------------------------------------------------------------------------------------------------------------------+
  | data       | responsavel    | versao          | pendência | alteracao                                                                     |
  +------------+----------------+-----------------+-----------+-------------------------------------------------------------------------------+
  |            |                |                 |           |                                                                               |
  +-------------------------------------------------------------------------------------------------------------------------------------------+
  *********************************************************************************************************************************************
  */

  cursor c_ctrl_propost(pnum_sqcial_bnficiar gp.import_bnfciar.num_seqcial_bnfciar%type) is
    select distinct cdp.nrpessoa_paga,
                    m.in_tipo_pessoa,
                    cdp.nrregistro,
                    cdp.nrcontrato,
                    (select distinct case
                                       when (cdp.tpfatura = 'U' or
                                            cp.cdcontratacao_ans = 1 or
                                            f.nrpessoa_paga is not null or
                                            f.dtinicio_contrato is not null) then
                                        f.nrfamilia
                                       else
                                        0
                                     end nrfamilia
                       from contrato_da_pessoa cdp,
                            familia            f,
                            contrato_plano     cpl,
                            contrato_padrao    cp,
                            usuario            us,
                            import_bnfciar     ib
                      where us.cdcontrato = cp.cdcontrato
                        and us.nrregistro = cpl.nrregistro
                        and us.nrcontrato = cpl.nrcontrato
                        and us.cdcontrato = cpl.cdcontrato
                        and us.nrregistro = f.nrregistro
                        and us.nrcontrato = f.nrcontrato
                        and us.nrfamilia = f.nrfamilia
                        and cdp.nrregistro = cpl.nrregistro
                        and cdp.nrcontrato = cpl.nrcontrato
                        and ib.num_seqcial_bnfciar = us.nrsequencial_usuario
                        and ib.num_seqcial_bnfciar = u.nrsequencial_usuario) nrfamilia,

                    (select distinct case
                                       when (cdp.tpfatura = 'L' or cdp.tpfatura = 'I') then
                                           nvl((select l.cdlotacao
                                                 from lotacao l
                                                where l.nrregistro =
                                                      cdp.nrregistro
                                                  and l.nrcontrato =
                                                      cdp.nrcontrato
                                                  and us.cdlotacao = l.cdlotacao),
                                               nvl(f.cdlotacao, '0'))
                                       else
                                        '0'
                                     end cdlotacao
                       from contrato_da_pessoa cdp,
                            familia            f,
                            contrato_plano     cpl,
                            contrato_padrao    cp,
                            usuario            us,
                            import_bnfciar     ib
                      where us.cdcontrato = cp.cdcontrato
                        and us.nrregistro = cpl.nrregistro
                        and us.nrcontrato = cpl.nrcontrato
                        and us.cdcontrato = cpl.cdcontrato
                        and us.nrregistro = f.nrregistro
                        and us.nrcontrato = f.nrcontrato
                        and us.nrfamilia = f.nrfamilia
                        and cdp.nrregistro = cpl.nrregistro
                        and cdp.nrcontrato = cpl.nrcontrato
                        and ib.num_seqcial_bnfciar = us.nrsequencial_usuario
                        and ib.num_seqcial_bnfciar = u.nrsequencial_usuario) cdlotacao,

                    tdd.cdcontrato_agr cdcontrato,
                    cp.tpusu_contrato tpusu_contrato,
                    cdp.tpfatura,
                    cdp.cdnivel_preco,
                    cp.tpcontrato tpcontrato,
                    u.cdareaacao,
                    cdp.dtiniciocontrato,
                    0 cdfator_moderador,
                    cdp.dtfimcontrato dtfimcontrato,
                    rt.cd_modalidade,
                    rt.cd_plano,
                    rt.cd_tipo_plano,
                    rt.cdfator_moderador cdfatormoderador,
                    0 nrperiodo_ult_reajuste,
                    decode(cp.tpcontrato, 'PM', '1', 'SP', '2') cd_forma_pagto,
                    u.tpplano tpplano,
                    u.cdorigem,
                    u.nrsequencial_usuario
      from usuario               u,
           contrato_da_pessoa    cdp,
           contrato_padrao       cp,
           migracao_plano        rt,
           temp_depara_detalhado tdd,
           gp.modalid            m
     where u.nrregistro = cdp.nrregistro
       and u.nrcontrato = cdp.nrcontrato
       and u.cdcontrato = cp.cdcontrato
       and rt.cdcontrato = u.cdcontrato
       and rt.tpplano = u.tpplano
       and rt.nrcontrato = u.nrcontrato
       and tdd.cdcontrato = rt.cdcontrato
       and nrsequencial_usuario = pnum_sqcial_bnficiar
       and m.cd_modalidade      = rt.cd_modalidade;

  --funções
  function f_insumo(pcdclasse varchar2) return varchar2;
  function fn_fator_benef(pnrcontrato        contrato_coparticipacao.nrcontrato%type,
                          pnrregistro        contrato_coparticipacao.nrregistro%type,
                          pcdcontrato_padrao contrato_coparticipacao.cdcontrato%type,
                          pnrfamilia         familia.nrfamilia%type,
                          pdtexclusao        usuario.dtexclusao%type)

   return varchar2;

  function f_busca_cobranca_carteira(pDtReferencia   in Date,
                                     pCdcontrato     in Varchar2,
                                     pTpContrato     in Varchar2,
                                     pTpUsu_Contrato in Varchar2)
    return number;

  function fn_nr_meses_criterio(ptpcriterio tipo_de_criterio.tpcriterio%type)
    return char;

  procedure p_migra_ramo_atividade;

  --estrutura
  procedure p_migra_modulo_cobertura;
  procedure p_migra_tipo_plano;
  procedure p_migra_estrutura;
  procedure p_migra_pl_gr_pa;
  procedure p_migra_abrangencia;
  procedure p_migra_procedimentos;
  procedure p_migra_pla_mod;
  procedure p_migra_qtdmoeda;
  procedure p_migra_forpagtx;
  procedure p_migra_quantitativo_permitido;
  procedure p_migra_regra_estrutura;
  procedure p_migra_trans_mod_proced;
  procedure p_insert_trans_mod_proced(pcd_transacao    number,
                                      pcd_modulo       number,
                                      pcd_procedimento number);
  procedure p_insert_trmodtpi(pcd_transacao    number,
                              pcd_modulo       number,
                              pcd_tipo_insumo  number,
                              pcd_insumo       number);

  --propostas
  --procedure p_gera_lotacao; -- comentado pois a chamada foi adicionada no inicio de p_migra_lotacao
  procedure p_migra_lotacao; -- mc ferj
  procedure p_atualiza_proposta_sem_lot(pnrsequencial_proposta import_propost.num_seqcial_propost%type);
  procedure p_atualiza_proposta_com_lot(pnrsequencial_proposta import_propost.num_seqcial_propost%type);
  procedure p_atualiza_status_proposta;
  procedure apaga_contrato(pnrcontrato in varchar2);
  procedure apaga_proposta_totvs(pcd_modalidade in number,
                                 pnr_proposta   in number);
  procedure apaga_proposta_import(pnr_contrato_antigo  in number,
                                  pnum_seqcial_propost in number);

  --beneficiários
  procedure p_gera_proposta_r2(papenas_contratos_ativos char,
                               pinicia_sequences        char,
                               pnrcontrato              char);
  procedure p_atualiza_beneficiario_g(pnrsequencial_usuario import_bnfciar.num_seqcial_bnfciar%type);
  procedure p_atualiza_status_benef;
  procedure apaga_beneficiario(pnrsequencial_usuario in number);
  procedure apaga_beneficiario_totvs(pnrsequencial_usuario in number);
  procedure apaga_beneficiario_import(pnrsequencial_usuario in number);
  procedure p_migra_carteira;
  procedure p_migra_mensagem_prodmed;
  procedure p_migra_fator_moderador;
  procedure p_cria_demais_regras_fator;

  --regra de mensalidade
  procedure p_migra_regra_proposta;
  procedure p_insert_regra_menslid(pcdd_regra number,
                                   pdes_regra varchar2,
                                   pdat_inic  date,
                                   pdat_fim   date);
  procedure p_insert_regra_menslid_estrut(pcdd_regra     number,
                                          pcd_modalidade number,
                                          pcd_plano      number,
                                          pcd_tipo_plano number,
                                          pdat_inic      date,
                                          pdat_fim       date,
                                          pnr_proposta   number,
                                          pnr_usuario    number);
  procedure p_insert_regra_menslid_reaj(pcdd_regra number,
                                        pnrcompet  number);
  procedure p_insert_regra_menslid_criter(pcdd_regra           number,
                                          pcd_padrao_cobertura varchar2,
                                          pcd_modulo           number,
                                          pcd_grau_parentesco  number,
                                          pnr_faixa            number,
                                          pnridade_inicio      number,
                                          pnridade_fim         number,
                                          pvlpreco_mensal      number,
                                          pvlpreco_inscricao   number,
                                          pdat_inic            date,
                                          pdat_fim             date,
                                          pnrqtusuario_inicio  number,
                                          pnrqtusuario_fim     number);
  procedure p_regras_mensalidade(pnrcontrato contrato_da_pessoa.nrcontrato%type,
                                 pnrperiodo  periodo_competencia.nrperiodo%type);

  --regra de desconto
  procedure p_regras_desconto;

  --apoio
  procedure p_valida_servicos;
  procedure p_verifica_rows_tab;
  procedure p_reprocessa_proposta;
  procedure p_reprocessa_beneficiario;
  procedure p_carrega_depara;
  procedure p_carga_unimed;
  procedure p_valida_depara_familia;

  /* MÉTODO COMENTADO POR SEGURANÇA. ELE TRUNCA TODAS AS TABELAS EM TM_TABELAS_MOVIMENTACAO.
     DESCOMENTE E COMPILE NOVAMENTE SE PRECISAR UTILIZÁ-LO*/
  --procedure p_apaga_base_movimentacao;

  --dados pessoa
  procedure p_migra_cidade;
  procedure p_migra_cep;
  procedure p_migra_dados_pessoa;
  procedure p_migra_pessoa_fisica;
  procedure p_migra_pessoajuridica;
  procedure p_migra_endereco;
  procedure p_migra_contato;
  
  --contratante
  procedure p_contratante;

  --autorizacao
  procedure p_import_guia_autorizacao(pdatageracao   date,
                                      pnrautorizacao number);
  procedure p_obs_guia_autor;
  procedure p_atualiza_status_guia_aut(pnrsessoes number);

  --especialidade prestador
  procedure p_migra_especialidade;

  --faturas
  procedure p_import_fatura(pnrperiodo_inicio number,
                            pnrperiodo_fim    number);

  --pos
  procedure p_pos_migracao;

  procedure p_gera_modulo_proposta_r2(pnrsequencial_proposta number);

  procedure gera_regra_menslid(anrperiodocorte number,
                               anrcontrato     varchar2);

  procedure p_migra_grupo_procedimento;

  procedure p_migra_reajuste(pnrcontrato_antigo in number);

  procedure p_grava_benef_aposdem_sem_lot;
  procedure p_grava_benef_aposdem_com_lot;

  procedure p_insere_falha(pnrcontroleintegracao number,
                           pcdintegracao         varchar2,
                           ptxfalha              varchar2,
                           ptxajuda              varchar2,
                           pnrsequencialorigem   number);

  procedure p_gera_beneficiario(pnrregistro number, pnrcontrato number);

  procedure p_repasse_proposta(pnrsequencial_proposta number);

  procedure p_grava_modulo_benef_r2(pnrsequencial_beneficiario usuario.nrsequencial_usuario%type);

  procedure p_migra_contratante;

  procedure p_repasse_benef(pnum_seqcial_bnfciar import_bnfciar.num_seqcial_bnfciar%type);

  procedure p_grava_proposta_sem_lotacao(pproposta c_ctrl_propost%rowtype);

  procedure p_grava_proposta_com_lotacao(pproposta c_ctrl_propost%rowtype);

end pck_unicoogps;
/

prompt
prompt Creating package UTL_PARALELO
prompt =============================
prompt
CREATE OR REPLACE PACKAGE EMS506UNICOO."UTL_PARALELO"
IS

TYPE TYP_EXECUTAR IS RECORD (ROTINA    VARCHAR2(400),
                             ERRO      VARCHAR2(2000));

TYPE TYP_TB_EXECUTAR IS TABLE OF TYP_EXECUTAR INDEX BY BINARY_INTEGER;


PROCEDURE EXECUTAR(P_EXECUTAR IN OUT TYP_TB_EXECUTAR);

END;
/

prompt
prompt Creating function F_CST_PESQUISA_TXT
prompt ====================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_CST_PESQUISA_TXT"
(pString in varchar2) return varchar2 is

/*
Funcao utilizada na guia online para retirar acentos dos campos de txindicacao e txcomplemento
josias - 01-07-2014 - atualizações necessárias
*/


--
vStringReturn varchar2(2000);
vretorno number;
vqtt number;
x number;
vcaracter varchar2(1);
--
begin

  vretorno := 0;
  x := 1;
  vqtt := length(trim(pString));

  while x <= vqtt loop

     vcaracter := substr(pString,x,1);

     --if vcaracter not in ('q','w','e','r','t','y','u','i','o','p','a','s','d','f','g','h','j','k','l','z','x','c','v','b','n','m',' ','Q','W','E','R','T','Y','U','I','O','P','A','S','D','F','G','H','J','K','L','Z','X','C','V','B','N','M','1','2','3','4','5','6','7','8','9','0','/','-',')','(','_','o','.','-',',','+','*','''')
     if vcaracter not in ('1','2','3','4','5','6','7','8','9','0')
     then
       vretorno := 1;
     end if;

     x := x + 1;

  end loop;
  --
  return vretorno;
  --
end;
/

prompt
prompt Creating function F_REDUZ_BAIRRO
prompt ================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_REDUZ_BAIRRO"
    (P_COMPL    IN VARCHAR2 ,
     P_TAMANHO IN NUMBER)
Return Varchar2
is
   V_BAIRRO_REDUZ            VARCHAR2(25) ;
   I                        NUMBER;

begin
   V_BAIRRO_REDUZ := UPPER(TRIM(P_COMPL));

   -- RETIRANDO ESPACOS DUPLOS
   I:= 0;
   WHILE I<=5
   LOOP
      V_BAIRRO_REDUZ := REPLACE(V_BAIRRO_REDUZ,'  ',' ');
      I := I + 1;
   END LOOP;

--   V_BAIRRO_REDUZ := REPLACE(V_BAIRRO_REDUZ,'ANDAR','AND');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'CONDOMINIO','COND');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'CONJUNTO','CONJ');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'COMENDADOR','COMEND');

      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'ENGENHEIRO ','ENG.');

      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'JARDIM','JD');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'PARQUE','PQ');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'PRACA','PCA');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'PRAÇA','PCA');

      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'PRESIDENTE ','PRES.');

      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'SAO ','S.');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'SANTA','STA');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'SANTO','STO');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'SENHORA','SRA');

      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'VILA','VL ');

      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,' DA ',' ');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,' DE ',' ');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,' DAS ',' ');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,' DO ',' ');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,' DOS ',' ');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,' - ','-');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'- ','-');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,' -','-');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,' / ','/');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,'/ ','/');
      V_BAIRRO_REDUZ       := REPLACE(V_BAIRRO_REDUZ,' /','/');


   Return V_BAIRRO_REDUZ ;
end F_REDUZ_BAIRRO;
/

prompt
prompt Creating function F_REDUZ_COMPL
prompt ===============================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_REDUZ_COMPL"
    (P_COMPL    IN VARCHAR2 ,
     P_TAMANHO IN NUMBER)
Return Varchar2
is
   V_COMPL_REDUZ            VARCHAR2(25) ;
   I                        NUMBER;

begin
   V_COMPL_REDUZ := UPPER(TRIM(P_COMPL));

   -- RETIRANDO ESPACOS DUPLOS
   I:= 0;
   WHILE I<=5
   LOOP
      V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'  ',' ');
      I := I + 1;
   END LOOP;

   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'ANDAR','AND');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'ANTIGA ','ANT.');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'ARMAZEMS','ARMAZ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'ARMAZENS','ARMAZ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'ARMAZEM','ARMAZ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'APTO ','AP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'APTO','AP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'APT ','AP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'APT/ ','AP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'APT/','AP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'APT- ','AP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'APT-','AP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'AP/ ','AP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'AP/','AP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'AP- ','AP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'AP-','AP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'APARTAMENTO ','AP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'APARTAM ','AP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'APART ','AP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'BLOCOS ','BL');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'BLOCO ','BL');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'BLOCO','BL');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'BLC','BL');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'BL/ ','BL');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'BL/','BL');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'BL ','BL');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'BEIJA FLOR','BJ.FLOR');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'CASAS','CSAS');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'CASA','CSA');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'COBERTURA','COB');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'COBERT','COB');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'CONDOMINIO','COND');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'CONDOMIN','COND');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'CONDOM','COND');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'CONJUNTO ','CONJ.');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'CX.POSTAL','CX.P');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'CX POSTAL','CX.P');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'CAIXA POSTAL','CX.P');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'CX.POSTA','CX.P');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'CX POSTA','CX.P');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'CAIXA POSTA','CX.P');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'CX.POST','CX.P');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'CX POST','CX.P');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'EDIFICIO','ED');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'EDIFIC','ED');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'EDIF','ED');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'ENTRADA','ENTR');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'ESTRADA','EST');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'ESTRAD','EST');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'FRENTE','FTE');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'FUNDOS','FDS');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'GALERIA','GAL');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'JARDIM','JD');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'LOJAS ','LJS');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'LOJA ','LJ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'LOTES ','LTS');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'LOTE ','LT');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'LOTEAMENTO','LT');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'LOTEAMENT','LT');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'LOTEAMEN','LT');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'LOTEAME','LT');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'LOTEAM','LT');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'NOVA ','N ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'NOVO ','N ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'PADARIA','PADAR');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'PARQUE','PQ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'PRACA','PCA');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'PREDIO','PRED');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'PORTAO','PTO');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'PORTARIA','PTR');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'QUADRA','QD');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'QUADR','QD');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'QDR','QD');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'RUA ','R ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'SALAS/','S');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'SALAS ','S');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'SALA/','S');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'SALA ','S');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'SOBRADO','SOB');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'SHOPPING','SHOP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'SHOPING','SHOP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'SHOPPIN','SHOP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'SHOPPI','SHOP');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'SL ','S');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'SL/ ','S');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'SL/','S');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'S/L-','SL');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'S/L- ','SL');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'S/L ','SL');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'S/L','SL');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'SOBRELOJA','S/LJ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'SOBRE LOJA','S/LJ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'S LOJA','S/LJ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'TRAVESSA','TR');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'TRAV.','TR ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'TRAV ','TR ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'VILA','VL');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,' DA ',' ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,' DE ',' ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,' DAS ',' ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,' DO ',' ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,' DOS ',' ');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,' S/N',' SN');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,' S/',' S');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'0O','0');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'1O','1');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'2O','2');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'3O','3');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'4O','4');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'5O','5');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'6O','6');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'7O','7');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'8O','8');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'9O','9');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,', ',',');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'. ','.');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,' - ','-');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'- ','-');
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,' -','-');

   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,'  ',' ');

  -- teste Alex 28/02/2017
   V_COMPL_REDUZ := REPLACE(V_COMPL_REDUZ,' ','');
  

   Return V_COMPL_REDUZ ;
end F_REDUZ_COMPL;
/

prompt
prompt Creating function F_REDUZ_END
prompt =============================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_REDUZ_END"
    (P_ENDER    IN VARCHAR2 ,
     P_TAMANHO IN NUMBER)
Return Varchar2
is
   V_ENDER_REDUZ            VARCHAR2(40) ;
   I                        NUMBER;

begin
   V_ENDER_REDUZ := UPPER(TRIM(P_ENDER));

   -- RETIRANDO ESPACOS DUPLOS
   I:= 0;
   WHILE I<=5
   LOOP
      V_ENDER_REDUZ := REPLACE(V_ENDER_REDUZ,'  ',' ');
      I := I + 1;
   END LOOP;

-- AQUI
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'RUA'       ,'R' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'AVENIDA'   ,'AV' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'ALAMEDA '  ,'ALAM.' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'PREDIO '   ,'PRED.' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'VILA '     ,'VL.' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'CONDOMINIO '     ,'COND.' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'BEIJA FLOR','BJ.FLOR' ) ;

      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'TRAVESSA'  ,'TR' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'BLOCO'     ,'BL' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'VIADUTO '  ,'VIAD.' ) ;
      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'PARQUE'    ,'PQ' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'RODOVIA'   ,'RDV' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'TRAV'      ,'TR' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'ESTRADA'   ,'EST' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'CORONEL'   ,'CEL' ) ;            
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'PRESIDENTE ' ,'PRES.' ) ;
            
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'EDIFICIO'   ,'ED' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'GENERAL'    ,'GEN' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'COMANDANTE'    ,'CMT' ) ;

      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'DOUTOR'     ,'DR' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'MARECHAL'   ,'MAL' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'MINISTRO'   ,'MIN' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'PREFEITO'   ,'PREF' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'CAPITAO'    ,'CAP' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'PROFESSORA' ,'PROF' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'PROFESSOR'  ,'PROF' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'JORNALISTA' ,'JORN' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'PADRE'      ,'PE' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'PASTOR'     ,'PR' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'PRACA'      ,'PCA' ) ;
      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'VISCONDE'   ,'VISC' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'TENENTE'    ,'TEN' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'QUADRA'     ,'Q' ) ;                                                                  
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'LOTE'       ,'L' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'BARAO'      ,'BR' ) ;      

      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'BARONEZA'  ,'BSA' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'BARAO'     ,'BR' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'DEPUTADO'  ,'DEP' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'DESEMBARGADOR' ,'DES' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'NOSSA SENHORA' ,'N S' ) ;      

      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'ALMIRANTE'     ,'ALTE' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'MUNICIPAL'     ,'MUN' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'REPUBLICA'     ,'REP' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'AGRICULA'      ,'AGR' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'SOLDADO'       ,'SD' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'SARGENTO'      ,'SGT' ) ;      

      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'FAZENDA'       ,'FAZ' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'JORNALISTA'    ,'JOR' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'EMBAIXADOR'    ,'EMB' ) ;
            

      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,' DA ',' ');
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,' DE ',' ');
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,' DAS ',' ');
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,' DO ',' ');
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,' DOS ',' ');
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,' - ','-');

      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'LOJA'          ,'LJ' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'CONJUNTO'      ,'CONJ' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'GOVERNADOR'    ,'GOV' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'ESCRITOR'      ,'ESC' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'INTENDENTE'    ,'INT' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'SENADOR'       ,'SEN' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'VEREADOR '     ,'VER.' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'MISSIONARIO '   ,'MISS.' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'EXPEDICIONARIO '   ,'EXP' ) ;      
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'ENGENHEIRO'    ,'ENG' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'ANTIGA '    ,'ANT.' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'SALA '    ,'S.' ) ;

      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,'. '   ,'.' ) ;
      V_ENDER_REDUZ       := REPLACE(V_ENDER_REDUZ,', '   ,',' ) ;


   Return V_ENDER_REDUZ ;
end F_REDUZ_END;
/

prompt
prompt Creating function F_REDUZ_END_ABREV
prompt ===================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_REDUZ_END_ABREV"
    (P_ENDER    IN VARCHAR2 ,
     P_TAMANHO IN NUMBER)
Return Varchar2
is
   V_ENDER_REDUZ            VARCHAR2(40);
   V_ENDERECO               VARCHAR2(40);
   I                        NUMBER;
   POS                      NUMBER;
   ESPACOS                  NUMBER;
   INICIO                   VARCHAR2(40);
   MEIO                     VARCHAR2(40);
   FIM                      VARCHAR2(40);

begin
   V_ENDER_REDUZ := UPPER(TRIM(P_ENDER));
   V_ENDERECO    := UPPER(TRIM(P_ENDER));
   I             := 1;
   POS           := 1;
   ESPACOS       := 0;
   INICIO        := '';
   MEIO          := '';
   FIM           := '';
   
   WHILE I<=LENGTH(V_ENDER_REDUZ)
   LOOP
      IF SUBSTR(V_ENDER_REDUZ,POS,1) = ' '
      THEN
         ESPACOS := ESPACOS + 1;
         IF ESPACOS = 2
         THEN
            INICIO := SUBSTR(V_ENDER_REDUZ,1,POS-1);
 
            WHILE ESPACOS <3
            LOOP
               POS := POS + 1;
               IF SUBSTR(V_ENDER_REDUZ,POS,1) = ' '
               THEN
                  ESPACOS := ESPACOS + 1;
                  FIM := SUBSTR(V_ENDER_REDUZ,POS+1,LENGTH(V_ENDER_REDUZ));
               ELSE MEIO := MEIO || SUBSTR(V_ENDER_REDUZ,POS,1);
               END IF;
               IF POS > LENGTH(V_ENDER_REDUZ)
               THEN
                  ESPACOS := ESPACOS +1;
               END IF;                               
            END LOOP;
            I:=41;            
            ---
         END IF;
      END IF;
      POS := POS + 1;
      I   := I+1;
   END LOOP;

   IF (INICIO IS NULL)
   THEN
      V_ENDER_REDUZ := V_ENDERECO;
   ELSE
      IF FIM IS NOT NULL
      THEN
--         IF '1234567890' LIKE MEIO--'0','1','2','3','4','5','6','7','8','9')
         IF (MEIO LIKE '%0%' OR MEIO LIKE '%1%' OR MEIO LIKE '%2%' OR MEIO LIKE '%3%' OR MEIO LIKE '%4%' OR 
             MEIO LIKE '%5%' OR MEIO LIKE '%6%' OR MEIO LIKE '%7%' OR MEIO LIKE '%8%' OR MEIO LIKE '%9%')
         THEN
            V_ENDER_REDUZ := INICIO || ' ' || MEIO || ' ' || FIM;
         ELSE      
            V_ENDER_REDUZ := INICIO || ' ' || SUBSTR(MEIO,1,1) || ' ' || FIM;
         END IF;
      ELSE      
         V_ENDER_REDUZ := INICIO || ' ' || MEIO;
      END IF;
   END IF;
   
   Return V_ENDER_REDUZ ;
end F_REDUZ_END_ABREV;
/

prompt
prompt Creating function F_TI_ACENTO
prompt =============================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_ACENTO" (pTexto varchar2) return varchar2
is
/*
 josias - 01-07-2014 - atualizações necessárias
*/

   vString_atual varchar2(20);
   vString_novo  varchar2(20);
   vtexto varchar2(100);
   vcount number;
begin
     vcount:=1;
     vtexto:=substr(ptexto,1,100);
     vString_atual:='?AEIOUaeiou';
     vString_novo :=' AEIOUaeiou';

    while true loop

      vtexto:=translate(
                         vtexto,
                         substr(vString_atual,vcount,1),
                         substr(vString_novo,vcount,1)
                       );
        vcount:=vCount+1;
      if vcount>length(vString_atual) then
         exit;
      end if;

    end loop;
  return vtexto;
end;
/

prompt
prompt Creating function F_TI_CHARTONUMBER
prompt ===================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_CHARTONUMBER" (pTexto varchar2) return varchar2
is
/*
 josias - 01-07-2014 - atualizações necessárias
*/

   vtexto varchar2(100);

begin
SELECT TRIM(TRANSLATE(PTEXTO,TRANSLATE(PTEXTO,'1234567890',' '),' '))
INTO
VTEXTO
 FROM DUAL;
  return vtexto;
end;
/

prompt
prompt Creating function F_TI_NOSSONUMERO
prompt ==================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_NOSSONUMERO" (pCDUNIMED varchar2,
                                            pNRNOSSONUMERO VARCHAR2,
                                            pcdoperacao    varchar2
                                            ) return varchar2
is
/*
 josias - 01-07-2014 - atualizações necessárias
*/

     vresult varchar2(2);
begin
     begin
          if f_parametro(pcdunimed)='003' and pcdoperacao in ('003','004') then
             vResult:=pnrnossonumero;
          else
              select
                  case
                      when length(pnrnossonumero)=10 then lpad(pnrnossonumero,12,'0')
                  else
                      pnrnossonumero
                  end
              into
                  vResult
              from dual;
          end if;
          Return vResult;
    end;
end;
/

prompt
prompt Creating function F_TI_TIP_ENDERECO
prompt ===================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_TIP_ENDERECO" (pnrregistro number) return varchar2
is
/*
 josias - 01-07-2014 - atualizações necessárias
*/

       vResult varchar2(4);
begin
   select edx.tpendereco
     into vresult
     from (select ed.tpendereco
             FROM endereco ed,
                  ti_tipo_de_endereco te
            where te.tpendereco=ed.tpendereco
              and ed.nrregistro=pnrregistro
              AND ED.AOCORRESPONDENCIA = 'S' --VINICIUS NOVA IGUAÇU 17/-6
            order by te.nrprioridade) edx
   where rownum = 1;
   return vresult;
end;
/

prompt
prompt Creating function F_TI_RETORNA_REGISTRO
prompt =======================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_RETORNA_REGISTRO" (pnrregistro in number) return varchar2 is
  result number;
  
  /*
 josias - 01-07-2014 - atualizações necessárias
*/

BEGIN
  

BEGIN
   select nrregistro
     into result
     from  endereco e
    where nrregistro = pnrregistro
      and e.tpendereco = f_ti_tip_endereco(pnrregistro)
      AND E.AOCORRESPONDENCIA = 'S';--VINICIUS NOVA IGUAÇU 17/06
exception
   when others then
       RETURN   (f_ti_parametro_integracao('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO'));
END;

  return(Result);
end ;
/

prompt
prompt Creating function F_TI_RETORNA_REGISTRO_COBR
prompt ============================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_RETORNA_REGISTRO_COBR" (pnrregistro in number) return varchar2 is
  result number;

  /*
 josias - 01-07-2014 - atualizações necessárias
*/

BEGIN


BEGIN
   select nrregistro
     into result
     from  endereco e
    where nrregistro = pnrregistro
      and e.tpendereco = 'COBR'
exception
   when others then
       RETURN   (f_ti_parametro_integracao('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO'));
END;

  return(Result);
end ;
/

prompt
prompt Creating function F_TI_SITUACAO_INTEGRACAO
prompt ==========================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_SITUACAO_INTEGRACAO" (pnrsequencial number,pCDintegracao varchar2) return varchar2
is
/*
 josias - 01-07-2014 - atualizações necessárias
*/

    vResult varchar2(10);
begin
       vResult:='ER';
       if pCDintegracao='TI_CLIENTE' then
          select  cdsituacao
          into
                 vResult from ti_cliente cl
          where
                 cl.nrseq_controle_integracao=pnrsequencial;
       elsif pCDintegracao='TI_FORNECEDOR' then
          select  cdsituacao
          into
                 vResult from ti_fornecedor cl
          where
                 cl.nrseq_controle_integracao=pnrsequencial;
       elsif pCDintegracao='TI_TIT_APB' then
          select  cdsituacao
          into
                 vResult from ti_TIT_APB ta
          where
                 TA.nrseq_controle_integracao=pnrsequencial;
       elsif pCDintegracao='TI_TIT_ACR' then
          select  cdsituacao
          into
                 vResult from ti_tit_acr cl
          where
                 cl.nrseq_controle_integracao=pnrsequencial;
       elsif pCDintegracao='TI_TIT_ACR_ESTORNO' then
          select  cdsituacao
          into
                 vResult from ti_tit_acr_estorno cl
          where
                 cl.nrseq_controle_integracao=pnrsequencial;

       end if;
       Return vResult;
end;
/

prompt
prompt Creating function F_TI_TIP_FORNECEDOR
prompt =====================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_TIP_FORNECEDOR" (Pcdfornecedor varchar2) return varchar2
is
/*
 josias - 01-07-2014 - atualizações necessárias
*/

     vresult varchar2(2);
begin
     begin
        SELECT
                    case
                        when pr.cdprestador is null then 'F'||to_char(fn.cdgrupo_fornecedor)
                    else
                       'P'|| pr.tpprestador
                    end
        into vResult
        FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FN,
               PRESTADOR PR
        WHERE
               FN.CDFORNECEDOR=PR.CDPRESTADOR(+)
               AND
               FN.CDFORNECEDOR=Pcdfornecedor;
     exception
               when others then vResult:='ER';
     end;
     Return vResult;
end;
/

prompt
prompt Creating function F_TI_TIP_MOVTO_CMG
prompt ====================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_TIP_MOVTO_CMG" (
                                                  PCDEmpresa varchar2,
                                                  PCDModulo  varchar2,
                                                  pCDHistorico varchar2) RETURN number
IS
/*
 josias - 01-07-2014 - atualizações necessárias
*/

       vResult number;
begin
     begin
        select
               tmt.nrsequencial
        into
            vResult
        from ti_tipo_movimento_CMG tmt
        where
             (tmt.cdempresa='*' or tmt.cdempresa=pcdempresa)
             and
             tmt.cdhistorico=pcdhistorico
             and
             tmt.cdmodulo=pcdmodulo;
     exception
               when no_data_found then vResult:=-1;
               when others        then vResult:=-2;
     end;
     Return vResult;
end;
/

prompt
prompt Creating function F_TI_TITULO_ACR_ATIVO
prompt =======================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_TI_TITULO_ACR_ATIVO" (pNRNOSSONUMERO VARCHAR2) RETURN number
IS
/*
 josias - 01-07-2014 - atualizações necessárias
*/

       vResult number(4);
       vNRNossoNumero varchar2(20);
begin
       vNRNossoNumero:='00'||pnrnossonumero;
       begin
            select ta.num_id_tit_acr
            into
                   vResult
            from ems5.tit_acr ta
            where
                 TA.COD_TIT_ACR_BCO=vNRNossoNumero
                 AND
                   NOT exists (
                              select 1
                              from
                                     ems5.movto_tit_acr  mt
                              where
                                     mt.num_id_tit_acr=ta.num_id_tit_acr
                                     and
                                     mt.ind_trans_acr_abrev='ESTT');
      exception
           when others then vResult:=0;
      end;
      return vResult;
end;
/

prompt
prompt Creating function F_VENCIMENTO_TITULO
prompt =====================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."F_VENCIMENTO_TITULO" (pDTVencimento date,
                                               pdtrecebimento date,
                                               ptipo varchar2
                                               ) return date
is
/*
 josias - 01-07-2014 - atualizações necessárias
*/

begin
     Return                   pdtrecebimento;
end;
/

prompt
prompt Creating function SQUIRREL_GET_ERROR_OFFSET
prompt ===========================================
prompt
CREATE OR REPLACE FUNCTION EMS506UNICOO."SQUIRREL_GET_ERROR_OFFSET" (query IN varchar2) return number authid current_user is      l_theCursor     integer default dbms_sql.open_cursor;      l_status        integer; begin          begin          dbms_sql.parse(  l_theCursor, query, dbms_sql.native );          exception                  when others then l_status := dbms_sql.last_error_position;          end;          dbms_sql.close_cursor( l_theCursor );          return l_status; end;
/

prompt
prompt Creating procedure P_ACERTA_CPF
prompt ===============================
prompt
CREATE OR REPLACE PROCEDURE EMS506UNICOO."P_ACERTA_CPF" IS

  VAOEXISTE CHAR;
  VCPF      PESSOA.NRCGC_CPF%TYPE;
  VCONT     NUMBER := 0;

  CURSOR C_CPF IS
  /*SELECT DISTINCT PE.NRREGISTRO
        FROM EMS506UNICOO.TI_CLIENTE           TC,
             EMS506UNICOO.TI_FALHA_DE_PROCESSO TF,
             PESSOA                            PE
       WHERE TC.CDSITUACAO <> 'IT'
         AND TC.NRSEQ_CONTROLE_INTEGRACAO = TF.NRSEQ_CONTROLE_INTEGRACAO
         AND TC.NRPESSOA = PE.NRREGISTRO
         AND PE.TPPESSOA = 'F'
         AND (
             F_VALIDADOR_CPF(PE.NRCGC_CPF) = 'F')*/

    select t.nrpessoa nrregistro
      from ti_cliente t, pessoa pe
     where cdsituacao = '80'
     and pe.nrregistro = t.nrpessoa
     and pe.tppessoa = 'F' ;

BEGIN
  FOR CPF IN C_CPF LOOP

    VCPF := UNICOOGPS.PCK_GERA_CPF.GERA_CPF;

    BEGIN
      SELECT 'S' INTO VAOEXISTE FROM PESSOA PE WHERE PE.NRCGC_CPF = VCPF;
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        VAOEXISTE := 'N';
    END;

    IF VAOEXISTE = 'N' THEN

      DELETE TI_PESSOA TI WHERE TI.NRREGISTRO = CPF.NRREGISTRO;

      VCONT := VCONT + 1;

      DELETE FROM TI_CLIENTE TC WHERE TC.NRPESSOA = CPF.NRREGISTRO;

      VCONT := VCONT + 1;

      DELETE FROM TI_CONTROLE_INTEGRACAO TCI
       WHERE TCI.NRSEQUENCIAL_ORIGEM = CPF.NRREGISTRO
         AND TCI.TPINTEGRACAO = 'CL';

      VCONT := VCONT + 1;

      UPDATE PESSOA PE
         SET PE.NRCGC_CPF = VCPF
       WHERE PE.NRREGISTRO = CPF.NRREGISTRO;

      VCONT := VCONT + 1;

      IF VCONT > 1000 THEN
        COMMIT;
        VCONT := VCONT + 1;

      END IF;

    END IF;

  END LOOP;

  COMMIT;

END;
/

prompt
prompt Creating procedure P_ATUALIZA_FLUXO_FINANC_FORNEC
prompt =================================================
prompt
CREATE OR REPLACE PROCEDURE EMS506UNICOO."P_ATUALIZA_FLUXO_FINANC_FORNEC"

is

v integer;
w integer;

Cursor c is
select
  distinct f.nrregistro_fornecedor
from
producao.historico_do_titulo_pagar@unicoo_homologa h,
producao.fornecedor@unicoo_homologa f,
ems5.fornecedor ef,
ti_pessoa p
where h.cdhistorico          is not null
and   h.cdfornecedor         is not null
and   h.cdfornecedor         = f.cdfornecedor
and   f.nrregistro_fornecedor = p.nrregistro
and   p.cdn_fornecedor        = ef.cdn_fornecedor
order by 1;

Cursor D is
     select
       tip.cdn_fornecedor,
       t.cdhistorico
     from
       (select
           f1.nrregistro_fornecedor,
           h1.cdhistorico,
           tp.dttitulo,
           count(*) maior
        from
           producao.historico_do_titulo_pagar@unicoo_homologa h1,
           producao.fornecedor@unicoo_homologa f1,
           producao.titulo_a_pagar@unicoo_homologa tp
        where h1.cdhistorico          is not null
        and   h1.cdfornecedor         is not null
        and   h1.cdfornecedor         = f1.cdfornecedor
        and   h1.nrregistro_titulo    = tp.nrregistro_titulo
        group by (f1.nrregistro_fornecedor,h1.cdhistorico, tp.dttitulo)
        order by 1,2,4 desc, 3 desc) t,
     ti_pessoa tip,
     ems5.fornecedor ef5
     where t.nrregistro_fornecedor = tip.nrregistro
     and   tip.cdn_fornecedor      = ef5.cdn_fornecedor
     and   tip.nrregistro          = registro
     and   rownum =1;


begin

  for v in c loop

     for w in d loop


     update ems5.fornec_financ ffe
        set ffe.cod_tip_fluxo_financ = decode((select tia.cod_tip_fluxo_financ from ems506unicoo.ti_tipo_movimento_tit_apb tia
                                                where tia.cdmovimento = w.cdhistorico),null,
                                                decode((select ps.tppessoa from pessoa ps where ps.nrregistro = v.nrregistro_fornecedor),
                                                    'J',
                                                    (select pi.vlparametro from ti_parametro_integracao pi where pi.cdparametro = 'COD_TIP_FLUXO_FINANC_PREFER_FOR_J'),
                                                    (select pi.vlparametro from ti_parametro_integracao pi where pi.cdparametro = 'COD_TIP_FLUXO_FINANC_PREFER_FOR_F')),
                                                    (select tia.cod_tip_fluxo_financ from ems506unicoo.ti_tipo_movimento_tit_apb tia
                                                where tia.cdmovimento = w.cdhistorico))
        where ffe.cdn_fornecedor = w.cdn_fornecedor;

    end loop;

    commit;

  end loop;
end;
end;
/

prompt
prompt Creating procedure P_GERA_SERIE_NOTA
prompt ====================================
prompt
CREATE OR REPLACE PROCEDURE EMS506UNICOO."P_GERA_SERIE_NOTA" AS


/*
***************************************************************************************************************
Criac?o          : -
Data             : -
Modulo Principal : Integrac?o EMS5
Modulos          : -
Objetivo         : Migrar série Unicoo x Totvs 12
Alteracoes
+------------------------------------------------------------------------------------------------------------------------------------------+
| DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
|------------|---------------|---------------|---------------------------------------------------------------------------------------------|
| 17/06/2016 | VINICIUS      |               |           | Criação da procedure   |
|------------|---------------|---------------|---------------------------------------------------------------------------------------------|
*/

  VAOEXISTE CHAR;

  CURSOR C_SERIES IS

    SELECT DISTINCT T.CDMOVIMENTO u##cod_ser_fisc_nota,
                    T.CDMOVIMENTO cod_ser_fisc_nota,
                    T.NOMOVIMENTO des_ser_fisc_nota,
                    ' ' cod_livre_1,
                    0 log_livre_1,
                    0 num_livre_1,
                    0 val_livre_1,
                    TRUNC(SYSDATE) dat_livre_1,
                    0 log_envio_bco_histor,
                    ' ' cod_livre_2,
                    NULL dat_livre_2,
                    0 log_livre_2,
                    0 num_livre_2,
                    0 val_livre_2,
                    0 cdd_version
      FROM TI_TIPO_MOVIMENTO_TIT_ACR T
     WHERE CDMODULO = 'FT';

BEGIN

  FOR CS IN C_SERIES LOOP

    BEGIN
      SELECT 'S'
        INTO VAOEXISTE
        FROM EMS5.SER_FISC_NOTA S
       WHERE S.U##COD_SER_FISC_NOTA = CS.COD_SER_FISC_NOTA;
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        VAOEXISTE := 'N';
    END;

    IF VAOEXISTE = 'N' THEN

      INSERT INTO EMS5.SER_FISC_NOTA
      VALUES
        (CS.u##cod_ser_fisc_nota,
         CS.cod_ser_fisc_nota,
         CS.des_ser_fisc_nota,
         CS.cod_livre_1,
         CS.log_livre_1,
         CS.num_livre_1,
         CS.val_livre_1,
         CS.dat_livre_1,
         CS.log_envio_bco_histor,
         CS.cod_livre_2,
         CS.dat_livre_2,
         CS.log_livre_2,
         CS.num_livre_2,
         CS.val_livre_2,
         CS.cdd_version,
         EMS5.SER_FISC_NOTA_SEQ.NEXTVAL);
    END IF;
  END LOOP;
  COMMIT;
END;
/

prompt
prompt Creating procedure P_TESTE_NOME_ABREVIADO
prompt =========================================
prompt
CREATE OR REPLACE PROCEDURE EMS506UNICOO."P_TESTE_NOME_ABREVIADO" is

  vaoexiste_nome char;
  vnom_abrev     varchar2(12);
  qttamanho      number;
  vnum_aux       number;
  vcount         number;

  cursor c_clientes is
  
    select p.nrregistro,
           nvl(p.noabreviado, p.nopessoa) nopessoa,
           case
             when tppessoa = 'F' THEN
              nvl(p.nomae, 'NAO INFORMADO')
             ELSE
              ' '
           end nomae,
           p.dtnascimento,
           p.tppessoa,
           nvl(trim(replace(replace(replace(p.nrcgc_cpf, '-', null),
                                    ',',
                                    null),
                            '.',
                            null)),
               '00000000000000') nrcgc_cpf
      from PRODUCAO.cliente@UNICOO_HOMOLOGA c,
           pessoa                           p,
           ti_grupo_de_cliente              t
     where p.nrregistro = c.nrregistro_cliente
       and t.cdgrupo_cliente = c.cdgrupo_cliente
       and t.cdgrupo_cliente_ems_pj <> 'NAOM';

begin

  for cc in c_clientes loop
  
    begin
      select t.noabrev_ems
        into vnom_abrev
        from temp_nomeabrev t
       where t.nopessoa = cc.nopessoa
         and t.nomae = cc.nomae
         and t.dtnascimento = cc.dtnascimento
         and t.nrcgc_cpg = cc.nrcgc_cpf
         and rownum = 1;
    exception
      when no_data_found then
      
        vnom_abrev := f_abrevia_nome(cc.nopessoa, 12, 'PEA');
      
        begin
          select 'S'
            into vaoexiste_nome
            from temp_nomeabrev t
           where t.noabrev_ems = vnom_abrev
           and rownum = 1;
        exception
          when no_data_found then
            vaoexiste_nome := 'N';
        end;
      
        if vaoexiste_nome = 'S' then
        
          begin
            select count(*)
              into vnum_aux
              from temp_nomeabrev t
             where t.noabrev_ems = vnom_abrev;
          end;
        
          qttamanho := length(vnum_aux);
        
          vnom_abrev := substr(vnom_abrev, 0, 12 - qttamanho) || vnum_aux;
        
        end if;
      
    end;
  
    insert into temp_nomeabrev
      (nrregistro,
       nopessoa,
       nomae,
       dtnascimento,
       tppessoa,
       noabrev_ems,
       nrcgc_cpg)
    values
      (cc.nrregistro,
       cc.nopessoa,
       cc.nomae,
       cc.dtnascimento,
       cc.tppessoa,
       vnom_abrev,
       cc.nrcgc_cpf);
  
    vcount := vcount + 1;
  
    if vcount > 1000 then
      commit;
      vcount := 0;
    end if;
  end loop;

commit;
end;
/

prompt
prompt Creating procedure P_VALIDA_CONTA_CLIENTE_TR
prompt ============================================
prompt
CREATE OR REPLACE PROCEDURE EMS506UNICOO."P_VALIDA_CONTA_CLIENTE_TR" AS

/*
***************************************************************************************************************
Criac?o          : -
Data             : -
Modulo Principal : Integrac?o EMS5
Modulos          : -
Objetivo         : Pré Validação dos títulos a receber: Conta de Saldo x Grupo Cliente
Alteracoes
+------------------------------------------------------------------------------------------------------------------------------------------+
| DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
|------------|---------------|---------------|---------------------------------------------------------------------------------------------|
| 17/06/2016 | VINICIUS      |               |           | Criação da procedure   |
|------------|---------------|---------------|---------------------------------------------------------------------------------------------|
*/


  VAOEXISTE   CHAR;
  VCONT       NUMBER := 0;
  VCDSITUACAO VARCHAR2(2);

  CURSOR C_TITULOS IS
  
    SELECT C.COD_GRP_CLIEN,
           TR.COD_ESPEC_DOCTO,
           TR.DAT_VENCTO,
           TR.NRSEQ_CONTROLE_INTEGRACAO
      FROM TI_TIT_ACR TR, TI_CLIENTE C
     WHERE TR.COD_CLIENTE = C.COD_CLIENTE
       AND TR.CDSITUACAO = 'RC'
     ORDER BY 1;

BEGIN

  FOR C IN C_TITULOS LOOP
    BEGIN
      SELECT 'S'
        INTO VAOEXISTE
        FROM EMS5.CTA_GRP_CLIEN G
       WHERE G.U##COD_ESPEC_DOCTO = C.COD_ESPEC_DOCTO
         AND G.U##COD_GRP_CLIEN = C.COD_GRP_CLIEN
         AND C.DAT_VENCTO BETWEEN G.DAT_INIC_VALID AND G.DAT_FIM_VALID;
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        VAOEXISTE := 'N';
    END;
  
    IF VAOEXISTE = 'S' THEN
    
      VCONT := VCONT + 1;
    
    ELSE
    
       UPDATE TI_TIT_ACR TR
         SET TR.CDSITUACAO = 'ER'
       WHERE TR.NRSEQ_CONTROLE_INTEGRACAO = C.NRSEQ_CONTROLE_INTEGRACAO;
    
    
      PCK_EMS506UNICOO.P_GRAVA_FALHA(C.NRSEQ_CONTROLE_INTEGRACAO,
                                     'TI_TIT_ACR',
                                     'Não existe conta de saldo para grupo cliente ' ||
                                     c.cod_grp_clien || ' Espécie ' ||
                                     C.COD_ESPEC_DOCTO,
                                     'Realizar parametrização na tela Conta Contábil x Grupo Cliente (Financeiro)',
                                     VCDSITUACAO,
                                     NULL);
      VCONT := VCONT + 1;
    
    END IF;
  
    IF VCONT > 1000 THEN
    
      COMMIT;
    
      VCONT := 0;
    
    END IF;
  
  END LOOP;
COMMIT;
END P_VALIDA_CONTA_CLIENTE_TR;
/

prompt
prompt Creating package body INF$_LOG
prompt ==============================
prompt
CREATE OR REPLACE PACKAGE BODY EMS506UNICOO."INF$_LOG"
IS

/***************************************************************************************************
 * Package para criacao de logs e replicacao
 *
 * o usuario dono desta package tem que ter permissao select any dictionary para o acesso a v$parameters
 * conforme os comandos a seguir:
 *            connect sys/
 *            -- grant select any dictionary to <USUARIO_BANCO>;
 *            -- grant select, references on SYS.V_$PARAMETER to <USUARIO_BANCO>;
 *
 *
 * Atualizacoes:
 * 11/06/2002  - Acrescentado campos Usuario_Rede,Maquina,Programa
 * 02/10/2002  - Tratamento para geracao do codigo completo do cria_replicacao
 *             - Tratamento de multiplos locais de origem  $1, $2
 * 03/02/2003  - Tratamento para quando ocorrer erro os erros ora-2291 e ora2292 pular o registro
 *               deixando o registro para a proxima replicacao
 *             - Tratamento para gerar os nomes das procedure de replicacao para nao repetir os nomes
 *               quando tiver a mesma tabela em locais diferentes
 *             - Tratamento para gerar uma sequence de controle para cada local de replicacao
 *
*/

vBuffer   varchar2(512);
vNoLocal  varchar2(30) ; ---:= '/oradb/DBRO/tmp';
ft_rep 	  utl_file.file_type;

procedure inf_grava_linha(plinha varchar2) is
 begin
 dbms_output.put_line(plinha);
 --utl_file.put_line(ft_rep,plinha);
 end inf_grava_linha;

procedure inf_salta_linha  is
 begin
 dbms_output.put_line('');
-- utl_file.new_line(ft_rep);
 end inf_salta_linha;

procedure inf_cria_arquivo (pArquivo varchar2) is
begin
-- select value into vnoLocal from v$parameter where name = 'utl_file_dir';
 vNoLocal := '/backup';
 DBMS_OUTPUT.ENABLE(1000000);
 ft_rep := utl_file.fopen(vNoLocal,pArquivo,'w');
end inf_cria_arquivo;

procedure inf_fecha_arquivo is
begin
 utl_file.fclose(ft_rep);
end inf_fecha_arquivo;

------------------------------------------------------
PROCEDURE CRIA_REPLICACAO
IS
BEGIN
DECLARE
   vnoDonoTabela varchar(30);
   vnoTabela     varchar(30);
   vnoConstPK    varchar(30);
   vTotRg        Number;
   vTotRgCh      Number;
   vAtuRg        Number;

    cursor c_$Tab is
     Select T.cdGrupo,T.nrTabela,T.noTabela,T.nrUltAtualiz,T.noDonoTabela,
            T.dtUltAtualiz,T.aoSituacao,G.noGrupo,G.noOrigem,G.noDonoLog,
            G.aoSituacao aoSitGrupo,G.nrProcesso,
            G.DtUltAtualiz dtUltAtuGrupo,G.nrUltLog,G.aoAcao_Excessao
 from LG$_CONTROLE_TAB T, LG$_CONTROLE_GRP G
             where T.cdGrupo = G.cdGrupo
               and T.aoSituacao = 'A'
             order by T.nrTabela;

   cursor c_$Campo is
     Select owner,table_name,column_name,data_type,column_id
       from ALL_tab_columns TC
      where TC.owner      = vnoDonoTabela
        and TC.table_name = vnoTabela
        and TC.data_type not in ('LONG','RAW','LONGRAW')
      order by TC.column_id;

   cursor c_$chave is
     Select *
       from ALL_cons_columns CC
      where CC.owner           = vnoDonoTabela
        and CC.constraint_name = vnoConstPK
      order by CC.position;


BEGIN
   inf_cria_arquivo('CriaRepl.sql');
   inf_grava_linha('--- Script para criacao da package INF$_REP. -----');
   inf_grava_linha('--- utilizada para a replicacao de dados     -----');
   inf_salta_linha;
   inf_grava_linha('--- PROCURE PELO TEXTO ABAIXO E VERIQUE SE ESTA OK AS CONEXOES GERADAS-----');
   inf_grava_linha('---                   "VERIFIQUE PARA MUDAR AQUI"                       ---');
   inf_salta_linha;
   inf_grava_linha('--- ***********************************************************************');
   inf_grava_linha('create or replace package INF$_REP');
   inf_grava_linha('AS');
   inf_salta_linha;
   inf_salta_linha;
   inf_grava_linha('   PROCEDURE REPLICA_DADOS(PnrProcesso IN NUMBER);');
   inf_salta_linha;
   inf_grava_linha('   PROCEDURE PROCESSA_TMP(PnrTabela IN NUMBER,Pnr_Log IN NUMBER,pNr_SeqMin in NUMBER, pNr_SeqMax in NUMBER); ');
   inf_salta_linha;
   inf_grava_linha('   PROCEDURE PROCESSA(PnrTabela IN NUMBER, PnrSequencia IN NUMBER, PtpOperacao IN VARCHAR2);');
   inf_salta_linha;

   for r_$tab in c_$tab loop
       inf_grava_linha('   PROCEDURE rp'||to_char(r_$tab.nrTabela)||'_' || r_$tab.noTabela || '(Pnr_Sequencia IN NUMBER, Ptp_Operacao IN VARCHAR2);');
       inf_salta_linha;
   end loop;

   inf_salta_linha;
   inf_grava_linha('end INF$_REP;');
   inf_grava_linha('/');
   inf_salta_linha;
   inf_salta_linha;

   inf_grava_linha('--- *********************************************************************');
   inf_grava_linha('create or replace package body INF$_REP');
   inf_grava_linha('AS');
   inf_salta_linha;

   inf_grava_linha( '-----------------------------------------------------------------------------------------' );
   inf_grava_linha( 'PROCEDURE REPLICA_DADOS(PnrProcesso IN number)' );
   inf_grava_linha( 'IS' );
   inf_grava_linha( 'BEGIN' );
   inf_grava_linha( 'DECLARE' );
   inf_grava_linha( 'vnr_SeqMin number;' );
   inf_grava_linha( 'vnr_SeqMax number;' );
   inf_grava_linha( 'vdt_HoraAtual date;' );
   inf_grava_linha( 'vtx_SeqMax varchar2(38);' );
   inf_grava_linha( 'vtx_SeqMin varchar2(38);' );
   inf_grava_linha( 'vcd_ocorrencia number;' );
   inf_grava_linha( 'vtx_Ocorrencia varchar2(100);' );
   inf_grava_linha( 'vtx_Msg_Acao varchar2(100);' );
   inf_grava_linha( 'vcd_Grupo number;' );
   inf_grava_linha( 'vNr_Log number;' );
   inf_grava_linha( 'vTp_Operacao varchar2(1);' );
   inf_grava_linha( 'vnr_Tabela number;' );
   inf_grava_linha( 'vnr_Sequencia number;' );
   inf_grava_linha( 'vnr_RegProcess number;' );
   inf_grava_linha( 'vnr_RegProcInc number;' );
   inf_grava_linha( 'vnr_RegProcAlt number;' );
   inf_grava_linha( 'vnr_RegProcExc number;' );
   inf_salta_linha();
   inf_grava_linha( 'cursor c_$Grp is' );
   inf_grava_linha( 'Select * from LG$_CONTROLE_GRP' );
   inf_grava_linha( 'where nrProcesso = PnrProcesso' );
   inf_grava_linha( 'and aoSituacao = ''A''' );
   inf_grava_linha( 'order by cdGrupo;' );
   inf_salta_linha();
   inf_grava_linha( 'cursor c_$Tab is' );
   inf_grava_linha( 'Select * from LG$_CONTROLE_TAB' );
   inf_grava_linha( 'where cdGrupo = vcd_Grupo' );
   inf_grava_linha( 'and aoSituacao = ''A'';' );
   inf_salta_linha();
   inf_grava_linha( 'cursor c_$Tmp is' );
   inf_grava_linha( 'Select * from LG$_CONTROLE_TMP' );
   inf_grava_linha( 'where nrLog = vNr_Log' );
   inf_grava_linha( 'order by nrSequencia;' );
   inf_salta_linha();
   inf_grava_linha( 'TYPE rt_TabTmp IS RECORD (' );
   inf_grava_linha( 'nrTabela NUMBER := 0,' );
   inf_grava_linha( 'nrUltAtualiz NUMBER := 0,' );
   inf_grava_linha( 'dtUltAtualiz DATE,' );
   inf_grava_linha( 'nrNovAtualiz NUMBER := 0,' );
   inf_grava_linha( 'dtNovAtualiz DATE,' );
   inf_grava_linha( 'nrRegProcess NUMBER := 0' );
   inf_grava_linha( ');' );
   inf_salta_linha();
   inf_grava_linha( 'TYPE tt_TabTmp IS TABLE OF rt_TabTmp' );
   inf_grava_linha( 'INDEX BY BINARY_INTEGER;' );
   inf_salta_linha();
   inf_grava_linha( 't_TabTmp tt_TabTmp;' );
   inf_salta_linha();
   inf_grava_linha( 'vnr_RegTab NUMBER := 0;' );
   inf_salta_linha();
   inf_salta_linha();
   inf_grava_linha( '--- Definicao de procedure para gravacao' );
   inf_grava_linha( 'PROCEDURE GRAVA_TRANSACAO IS' );
   inf_salta_linha();
   inf_grava_linha( 'begin' );
   inf_grava_linha( 'if vcd_Ocorrencia = 0 then' );
   inf_salta_linha();
   inf_grava_linha( '--- ATUALIZA O CONTROLE_TAB' );
   inf_grava_linha( 'for r_$TAB in c_$TAB loop' );
   inf_salta_linha();
   inf_salta_linha();
   inf_grava_linha( 'vnr_RegTab := r_$TAB.nrTabela;' );
   inf_salta_linha();
   inf_grava_linha( 'UPDATE LG$_CONTROLE_TAB' );
   inf_grava_linha( 'SET nrUltAtualiz = t_tabTmp(vnr_RegTab).nrNovAtualiz,' );
   inf_grava_linha( 'nrRegProcess = t_tabTmp(vnr_RegTab).nrRegProcess,' );
   inf_grava_linha( 'dtUltAtualiz = vdt_HoraAtual,' );
   inf_grava_linha( 'nrUltLog = vNr_Log' );
   inf_grava_linha( 'WHERE nrTabela = vnr_RegTab;' );
   inf_salta_linha();
   inf_grava_linha( 'end loop;' );
   inf_salta_linha();
   inf_grava_linha( 'end if;' );
   inf_salta_linha();
   inf_grava_linha( '--- ATUALIZA O CONTROLE_GRP' );
   inf_grava_linha( 'UPDATE LG$_CONTROLE_GRP' );
   inf_grava_linha( 'SET cdOcorrencia = vcd_Ocorrencia,' );
   inf_grava_linha( 'txOcorrencia = vtx_Ocorrencia,' );
   inf_grava_linha( 'txMsg_Acao = vtx_Msg_Acao,' );
   inf_grava_linha( 'nrUltLog = vNr_log,' );
   inf_grava_linha( 'dtUltAtualiz = vdt_HoraAtual' );
   inf_grava_linha( 'WHERE cdGrupo = vcd_Grupo;' );
   inf_salta_linha();
   inf_salta_linha();
   inf_grava_linha( 'update LG$_CONTROLE_LOG set' );
   inf_grava_linha( 'DTHORAINICIO = vdt_HoraAtual,' );
   inf_grava_linha( 'DTHORAFIM = sysdate,' );
   inf_grava_linha( 'NRREGPROCESS = vnr_RegProcess,' );
   inf_grava_linha( 'NRREGPROCINC = vnr_RegProcInc,' );
   inf_grava_linha( 'NRREGPROCALT = vnr_RegProcAlt,' );
   inf_grava_linha( 'NRREGPROCEXC = vnr_RegProcExc,' );
   inf_grava_linha( 'CDOCORRENCIA = vcd_Ocorrencia,' );
   inf_grava_linha( 'TXOCORRENCIA = vtx_Ocorrencia,' );
   inf_grava_linha( 'TXMSG_ACAO = vtx_Msg_Acao' );
   inf_grava_linha( 'where nrLog = vNr_Log;' );
   inf_salta_linha();
   inf_grava_linha( 'commit;' );
   inf_salta_linha();
   inf_salta_linha();
   inf_grava_linha( 'END GRAVA_TRANSACAO;' );
   inf_grava_linha( '--- fim da procedure de gravacao' );
   inf_salta_linha();
   inf_salta_linha();
   inf_salta_linha();
   inf_grava_linha( 'BEGIN' );
   inf_salta_linha();
   inf_grava_linha( 'dbms_application_info.set_client_info(''$TRNSF-'');' );
   inf_salta_linha();
   inf_salta_linha();
   inf_grava_linha( '--- loop de grupo/transacao' );
   inf_grava_linha( 'for r_$Grp in c_$Grp loop' );
   inf_salta_linha();
   inf_grava_linha( 'BEGIN' );
   inf_salta_linha();
   inf_grava_linha( 'vdt_HoraAtual := Sysdate;' );
   inf_grava_linha( 'vTx_SeqMax := to_char(vNr_SeqMax);' );
   inf_grava_linha( 'vnr_RegProcess := 0;' );
   inf_grava_linha( 'vnr_RegProcInc := 0;' );
   inf_grava_linha( 'vnr_RegProcAlt := 0;' );
   inf_grava_linha( 'vnr_RegProcExc := 0;' );
   inf_grava_linha( 'vcd_Ocorrencia := 0;' );
   inf_grava_linha( 'vtx_Ocorrencia := null;' );
   inf_grava_linha( 'vtx_Msg_Acao := null;' );
   inf_grava_linha( 'vcd_Grupo := r_$GRP.cdGrupo;');
   inf_salta_linha();
   inf_grava_linha( '--- os selects estao separados para prever erro de conexao' );
   inf_grava_linha( 'select LG$_SEQ_LOG.nextval into vNr_Log' );
   inf_grava_linha( 'from dual;' );
   begin
      inf_grava_linha( 'if r_$grp.norigem is null then' );
      inf_grava_linha( 'null;' );
      for rTmp in (select distinct noorigem from lg$_controle_grp ) loop
          inf_grava_linha( 'elsif r_$Grp.norigem = '''|| rTmp.noorigem ||''' then' );
          inf_grava_linha( 'select LG$_SEQ_CONTROLE.nextval@'|| rTmp.noorigem ||' into vNr_SeqMax    --- VERIFIQUE PARA MUDAR AQUI ---' );
          inf_grava_linha( 'from dual;' );
      end loop;
      inf_grava_linha( 'endif;' );
   end;
   inf_salta_linha();
   inf_grava_linha( 'dbms_output.put_line (''Replicacao #'' || to_char(vNr_Log) || '' inicio:'' || to_char(vdt_horaAtual,''dd/mm/yy hh24miss''));' );
   inf_grava_linha( 'insert into LG$_CONTROLE_LOG' );
   inf_grava_linha( '(nrLog, cdGrupo,dtHoraInicio)' );
   inf_grava_linha( 'values (vNr_Log,vcd_Grupo,vdt_HoraAtual);' );
   inf_salta_linha();
   inf_salta_linha();
   inf_grava_linha( 'for r_$TAB in c_$TAB loop' );
   inf_salta_linha();
   inf_grava_linha( 'vnr_RegTab := r_$TAB.nrTabela;' );
   inf_grava_linha( 't_tabTmp(vnr_RegTab).nrNovAtualiz := nvl(r_$TAB.nrUltAtualiz,0);' );
   inf_grava_linha( 't_tabTmp(vnr_RegTab).dtNovAtualiz := r_$TAB.dtUltAtualiz;' );
   inf_grava_linha( 't_tabTmp(vnr_RegTab).nrRegProcess := 0;' );
   inf_salta_linha();
   inf_grava_linha( 'vNr_SeqMin := nvl(r_$TAB.nrUltAtualiz,0);' );
   inf_grava_linha( 'vtx_SeqMin := to_char(vNr_SeqMin);' );
   inf_salta_linha();
   inf_grava_linha( 'inf$_rep.processa_tmp(r_$TAB.nrTabela,vNr_Log,vNr_SeqMin,vNr_SeqMax);' );
   inf_grava_linha( 'dbms_output.put_line (''executou processa_tmp para:'' || r_$TAB.noTabela);' );
   inf_salta_linha();
   inf_grava_linha( 'end loop;' );
   inf_grava_linha( 'commit;' );
   inf_salta_linha();
   inf_grava_linha( 'BEGIN' );
   inf_grava_linha( '--- abre transacao' );
   inf_grava_linha( 'dbms_output.put_line (''transacao aberta '');' );
   inf_salta_linha();
   inf_grava_linha( 'for r_$Tmp in c_$Tmp loop' );
   inf_grava_linha( 'vtp_Operacao := NULL;' );
   inf_salta_linha();
   inf_grava_linha( 'dbms_application_info.set_client_info(''$TRNSF-''||to_char(r_$TMP.nrSequencia,''9999999999999999999999''));' );
   inf_salta_linha();
   inf_grava_linha( 'loop' );
   inf_grava_linha( 'BEGIN' );
   inf_grava_linha( 'inf$_rep.processa(r_$TMP.nrTabela,r_$TMP.nrSequencia,vtp_Operacao);' );
   inf_grava_linha( 'dbms_output.put_line (''executou processa TAB:'' || to_char(r_$TMP.nrTabela,''99'') || '' SEQ:'' || to_char(r_$TMP.nrSequencia,''9999999999'') || '' OPE:'' || nvl(vtp_operacao,''$'') );' );
   inf_grava_linha( 'vtp_Operacao := NULL;' );
   inf_salta_linha();
   inf_grava_linha( 'EXCEPTION' );
   inf_grava_linha( 'WHEN OTHERS THEN' );
   inf_grava_linha( 'vcd_Ocorrencia := SQLCODE;' );
   inf_grava_linha( 'vtx_Ocorrencia := SqlErrM(vcd_Ocorrencia);' );
   inf_grava_linha( 'dbms_output.put_line (VTX_OCORRENCIA);' );
   inf_salta_linha();
   inf_grava_linha( 'END;' );
   inf_grava_linha( '--- Tratamento de erros -------------------------------------------------------------' );
   inf_grava_linha( '---   ORA-00001 - unique constraint violed                                   (-1) ---' );
   inf_grava_linha( '---   ORA-00100 - no data found                                             (100) ---' );
   inf_grava_linha( '---   ORA-01403 - no data found                                            (1403) ---' );
   inf_grava_linha( '---   ORA-02291 - integrity constraint .. violated - parent key not found  (2291) ---' );
   inf_grava_linha( '---   ORA-02292 - integrity constraint .. violated - child record found    (2292) ---' );
   inf_grava_linha( '-------------------------------------------------------------------------------------' );
   inf_grava_linha( 'if vcd_Ocorrencia <> 0 then' );
   inf_grava_linha( 'if r_$Grp.aoAcao_excessao = ''E'' or vcd_Ocorrencia not in (-1,100,1403,2291,2292) then ---- Gera erro e aborta' );
   inf_grava_linha( 'vtx_Msg_Acao := ''Processo abortado pelo erro'';' );
   inf_salta_linha();
   inf_grava_linha( 'elsif vcd_Ocorrencia in (2291,2292) then' );
   inf_grava_linha( 'vtx_Mesg_Acao := ''Registro deixado para reprocessamento futuro'';' );
   inf_salta_linha();
   inf_grava_linha( 'elsif r_$Grp.aoAcao_excessao = ''S'' then --- sobrepoe' );
   inf_grava_linha( 'if r_$TMP.tpOperacao = ''I'' and vcd_Ocorrencia = -1 then' );
   inf_grava_linha( 'vtx_Msg_Acao := ''Registro reprocessado como ALTERACAO'';' );
   inf_grava_linha( 'end if;' );
   inf_grava_linha( 'if r_$TMP.tpOperacao = ''A'' and vcd_Ocorrencia in ( 100,1403) then' );
   inf_grava_linha( 'vtx_Msg_Acao := ''Registro reprocessado como INCLUSAO'';' );
   inf_grava_linha( 'end if;' );
   inf_grava_linha( 'if r_$TMP.tpOperacao = ''E'' and vcd_Ocorrencia in ( 100,1403) then' );
   inf_grava_linha( 'vtx_Msg_Acao := ''Registro nao excluido por nao existir'';' );
   inf_grava_linha( 'end if;' );
   inf_salta_linha();
   inf_grava_linha( 'elsif r_$Grp.aoAcao_excessao = ''D'' then --- Descarta' );
   inf_grava_linha( 'if r_$TMP.tpOperacao = ''I'' then' );
   inf_grava_linha( 'vtx_Msg_Acao := ''Inclusao descartada'';' );
   inf_grava_linha( 'elsif r_$TMP.tpOperacao = ''A'' then' );
   inf_grava_linha( 'vtx_Msg_Acao := ''Alteracao descartada'';' );
   inf_grava_linha( 'elsif r_$TMP.tpOperacao = ''E'' then' );
   inf_grava_linha( 'vtx_Msg_Acao := ''Exclusao descartada'';' );
   inf_grava_linha( 'end if;' );
   inf_grava_linha( 'end if;' );
   inf_salta_linha();
   inf_grava_linha( 'insert into LG$_CONTROLE_MSG' );
   inf_grava_linha( '(NrLog,NrTabela,nrSequencia,cdOcorrencia,' );
   inf_grava_linha( 'TxOcorrencia,txMsg_Acao)' );
   inf_grava_linha( 'values' );
   inf_grava_linha( '(vnr_Log,r_$TMP.nrTabela,r_$TMP.nrSequencia,vcd_Ocorrencia,' );
   inf_grava_linha( 'vtx_ocorrencia,vtx_Msg_Acao);' );
   inf_salta_linha();
   inf_grava_linha( 'if r_$Grp.aoAcao_excessao = ''E'' or vcd_Ocorrencia not in (-1,100,1403,2291,2292) then ---- Gera erro e aborta' );
   inf_grava_linha( 'vnr_Tabela := r_$TMP.nrTabela;' );
   inf_grava_linha( 'vnr_Sequencia := r_$TMP.nrSequencia;' );
   inf_grava_linha( 'raise NO_DATA_FOUND;' );
   inf_salta_linha();
   inf_grava_linha( 'elsif vcd_Ocorrencia in (2291,2292) then' );
   inf_grava_linha( 'vtp_Operacao := null  --- nao faz nada para pular' );
   inf_salta_linha();
   inf_grava_linha( 'elsif r_$Grp.aoAcao_excessao = ''S'' then' );
   inf_grava_linha( 'if r_$TMP.tpOperacao = ''I'' and vcd_Ocorrencia = -1 then' );
   inf_grava_linha( '--- reprocessa como ALTERACAO, pois o registro ja existe' );
   inf_grava_linha( 'vtp_Operacao := ''A'';' );
   inf_grava_linha( 'end if;' );
   inf_grava_linha( 'if r_$TMP.tpOperacao = ''A'' and vcd_Ocorrencia in (100,1403) then' );
   inf_grava_linha( '---- reprocessa com INCLUSAO, pois o registro nao existe' );
   inf_grava_linha( 'vtp_Operacao := ''I'';' );
   inf_grava_linha( 'end if;' );
   inf_grava_linha( 'end if;' );
   inf_salta_linha();
   inf_grava_linha( 'vcd_Ocorrencia := 0; ---- Retira o erro se for Descartar ou sobrepor' );
   inf_grava_linha( 'vtx_Ocorrencia := null; ---- Mas mantem o txMsg_Acao para registrar no log a ultima acao' );
   inf_salta_linha();
   inf_grava_linha( 'exit when vtp_Operacao is NULL;' );
   inf_grava_linha( 'else' );
   inf_grava_linha( 'exit; --- continua o processo normalmente' );
   inf_grava_linha( 'end if;' );
   inf_grava_linha( 'end loop;' );
   inf_grava_linha( 't_tabTmp(r_$TMP.nrTabela).nrNovAtualiz := r_$TMP.nrSequencia;' );
   inf_grava_linha( 't_tabTmp(r_$TMP.nrTabela).nrRegProcess := t_tabTmp(r_$TMP.nrTabela).nrRegProcess + 1;' );
   inf_grava_linha( 'vnr_RegProcess := vnr_RegProcess + 1;' );
   inf_grava_linha( 'if r_$TMP.tpOperacao = ''I'' then' );
   inf_grava_linha( 'vnr_RegProcInc := vnr_RegProcInc + 1;' );
   inf_grava_linha( 'elsif r_$TMP.tpOperacao = ''A'' then' );
   inf_grava_linha( 'vnr_RegProcAlt := vnr_RegProcAlt + 1;' );
   inf_grava_linha( 'elsif r_$TMP.tpOperacao = ''E'' then' );
   inf_grava_linha( 'vnr_RegProcExc := vnr_RegProcExc + 1;' );
   inf_grava_linha( 'end if;' );
   inf_grava_linha( 'dbms_output.put_line (''proc.tab: '' || ''t'' || '' seq:'' || ''s'' );' );
   inf_salta_linha();
   inf_grava_linha( 'if TRUNC(vnr_RegProcess / 100) = vnr_RegProcess/100 then' );
   inf_grava_linha( '----- Executa a gravacao da transacao de 100 em 100 registros' );
   inf_grava_linha( 'GRAVA_TRANSACAO;' );
   inf_salta_linha();
   inf_grava_linha( 'end if;' );
   inf_salta_linha();
   inf_grava_linha( 'end loop;' );
   inf_grava_linha( 'commit;' );
   inf_salta_linha();
   inf_grava_linha( 'EXCEPTION' );
   inf_grava_linha( 'WHEN OTHERS THEN' );
   inf_grava_linha( 'ROLLBACK;' );
   inf_grava_linha( '-- TRATA O ERRO QUE JA ESTA EM VTX_OCORRENCIA DO EXCEPTION ANTERIOR' );
   inf_grava_linha( '--- INSERE DE NOVO POR CAUSA DO ROLLBACK' );
   inf_grava_linha( 'insert into LG$_CONTROLE_MSG' );
   inf_grava_linha( '(NrLog,NrTabela,nrSequencia,cdOcorrencia,' );
   inf_grava_linha( 'TxOcorrencia,txMsg_Acao)' );
   inf_grava_linha( 'values' );
   inf_grava_linha( '(vnr_Log,vnr_Tabela,vnr_Sequencia,vcd_Ocorrencia,' );
   inf_grava_linha( 'vtx_ocorrencia,vtx_Msg_Acao);' );
   inf_salta_linha();
   inf_grava_linha( 'END;' );
   inf_salta_linha();
   inf_grava_linha( 'delete LG$_CONTROLE_TMP where nrLog = vNr_Log;' );
   inf_salta_linha();
   inf_grava_linha( '----- Executa a gravacao da transacao' );
   inf_grava_linha( 'GRAVA_TRANSACAO;' );
   inf_salta_linha();
   inf_grava_linha( 'dbms_output.put_line (''Replicacao de dados final: '' || to_char(sysdate,''dd/mm/yy hh24miss''));' );
   inf_salta_linha();
   inf_salta_linha();
   inf_grava_linha( 'EXCEPTION' );
   inf_grava_linha( 'WHEN OTHERS THEN' );
   inf_grava_linha( 'vcd_Ocorrencia := SQLCODE;' );
   inf_grava_linha( 'vtx_Ocorrencia := SqlErrM(vcd_Ocorrencia);' );
   inf_grava_linha( 'vtx_Msg_Acao := ''Processo abortado pelo erro'';' );
   inf_salta_linha();
   inf_grava_linha( 'dbms_output.put_line (VTX_OCORRENCIA);' );
   inf_salta_linha();
   inf_grava_linha( '-- TRATA O ERRO DE COMUNICAO REMOTA PARA A OUTRA BASE' );
   inf_grava_linha( '-- OU QUANDO ESTA PEGANDO O NUMERO DA SEQUENCE@BASE,' );
   inf_grava_linha( '-- OU QUANDO ESTA CARREGANDO A TABELA TEMPORARIA (PROCESSA TMP)' );
   inf_grava_linha( '--- INSERE DE NOVO POR CAUSA DO ROLLBACK' );
   inf_salta_linha();
   inf_grava_linha( 'ROLLBACK;' );
   inf_grava_linha( 'insert into LG$_CONTROLE_LOG' );
   inf_grava_linha( '(nrLog,cdGrupo,dtHoraInicio,dtHoraFim,' );
   inf_grava_linha( 'cdOcorrencia,txOcorrencia,txMsg_Acao)' );
   inf_grava_linha( 'values (vNr_Log,vcd_Grupo,vdt_HoraAtual,sysdate,' );
   inf_grava_linha( 'vcd_Ocorrencia,vtx_Ocorrencia,vtx_Msg_Acao);' );
   inf_grava_linha( 'commit;' );
   inf_salta_linha();
   inf_salta_linha();
   inf_grava_linha( 'END;' );
   inf_grava_linha( 'end loop;' );
   inf_salta_linha();
   inf_grava_linha( 'dbms_application_info.set_client_info(null);' );
   inf_salta_linha();
   inf_grava_linha( 'END;' );
   inf_grava_linha( 'END REPLICA_DADOS ;' );
   inf_salta_linha();

   inf_grava_linha( '-----------------------------------------------------------------------------------------' );
   inf_grava_linha('--- VERIFIQUE PARA MUDAR AQUI ---');
   inf_grava_linha('PROCEDURE PROCESSA_TMP(PnrTabela IN NUMBER,Pnr_Log IN NUMBER,pNr_SeqMin in NUMBER, pNr_SeqMax in NUMBER)');
   inf_grava_linha('IS');
   inf_grava_linha('BEGIN');
   inf_grava_linha('  if PnrTabela = 0 then ');
   inf_grava_linha('     null;');
   inf_salta_linha;

   for r_$tab in c_$tab loop
       inf_grava_linha('  elsif  PnrTabela = ' || to_char(r_$tab.nrTabela) || ' then ');
       inf_grava_linha('  insert into ' || r_$tab.noDonoTabela || '.LG$_CONTROLE_TMP        ');
       inf_grava_linha('        select pNr_Log, ' || r_$tab.nrTabela || ',nrSequencia$$,tpOperacao$$         ');
       inf_grava_linha('          from ' || r_$tab.noDonoLog || '.LG$_' || substr(r_$tab.noTabela,1,22) || '_$1' || '@' || r_$tab.noOrigem );
---       inf_grava_linha('         where nrSequencia$$ > pNr_SeqMin      ');
       inf_grava_linha('         where nrSequencia$$ <=  pNr_SeqMax;   ');
---       inf_grava_linha('           and tpOperacao$$ <> ''V'' ');
---       inf_grava_linha('           and noUsuario$$ not like ''$TRNSF%''; ');
       inf_salta_linha;
   end loop;

   inf_grava_linha('  end if;');
   inf_salta_linha;
   inf_grava_linha('END;');

   inf_grava_linha( '-----------------------------------------------------------------------------------------' );
   inf_grava_linha('--- VERIFIQUE PARA MUDAR AQUI ---');
   inf_grava_linha('procedure processa(PnrTabela IN NUMBER,PnrSequencia IN NUMBER, PtpOperacao IN VARCHAR2)');
   inf_grava_linha('IS');
   inf_grava_linha('BEGIN');
   inf_grava_linha('  if PnrTabela = 0 then ');
   inf_grava_linha('     null;');
   inf_salta_linha;

   for r_$tab in c_$tab loop
       inf_grava_linha('  elsif  PnrTabela = ' || to_char(r_$tab.nrTabela) || ' then ');
       inf_grava_linha('      rp'||to_char(r_$tab.nrTabela)||'_' || r_$tab.noTabela || '(PnrSequencia,PtpOperacao);');
       inf_salta_linha;
   end loop;

   inf_grava_linha('  end if;');
   inf_salta_linha;
   inf_grava_linha('END;');

   for r_$tab in c_$tab loop

       vnoTabela     := r_$tab.noTabela;
       vnoDonoTabela := r_$tab.noDonoTabela;
       select constraint_name into vnoConstPK
         from ALL_constraints
        where owner      = vnoDonoTabela
          and Table_name = vnoTabela
          and constraint_type = 'P';

       inf_grava_linha('---------------------------------------------------------------------');
       inf_grava_linha('PROCEDURE RP'||to_char(r_$tab.nrTabela)||'_' || r_$tab.noTabela || '(pNR_sequencia in number, pTP_Operacao in VARCHAR2)');
       inf_grava_linha('IS');
       inf_grava_linha('---');
       inf_grava_linha('BEGIN');
       inf_grava_linha('   DECLARE');
       inf_salta_linha;
       inf_grava_linha('   vtp_Operacao$$  varchar2(1); ');
       inf_grava_linha('   vnr_Vazio       number; ');
       inf_salta_linha;
       inf_grava_linha('   cursor c_dados  is');
       inf_grava_linha('           select TpOperacao$$,');

       select count(*) into vTotRg
         from ALL_tab_columns TC
        where TC.owner      = vnoDonoTabela
          and TC.table_name = vnoTabela
          and TC.data_type not in ('LONG','RAW','LONGRAW');

       select count(*) into vTotRgCh
         from ALL_cons_columns CC
        where CC.owner           = vnoDonoTabela
          and CC.constraint_name = vnoConstPK;

       vAtuRg := 0;
       for r_$campo in c_$campo loop
           vAtuRg := vAtuRg + 1;
           select '                  ' || r_$campo.Column_Name ||
                  decode(vAtuRg,vTotRg,'',',') into vBuffer from dual ;
           inf_grava_linha(vBuffer);
       end loop;
       inf_grava_linha('             from  ' || r_$tab.noDonoLog || '.' || 'LG$_' || r_$tab.noTabela || '@' || r_$tab.noOrigem );
       inf_grava_linha('            where nrSequencia$$ = pNR_sequencia and tpOperacao$$ <> ''V''  ;');
       inf_salta_linha;
       inf_grava_linha('   BEGIN');
       inf_salta_linha;
       inf_grava_linha('   for r_dados in c_dados loop');
       inf_salta_linha;
       inf_grava_linha('       if pTP_Operacao is NULL then ');
       inf_grava_linha('          vtp_Operacao$$ := r_dados.tpOperacao$$; ');
       inf_grava_linha('       else ');
       inf_grava_linha('          vtp_Operacao$$ := pTP_Operacao; ');
       inf_grava_linha('       end if; ');
       inf_salta_linha;
       inf_grava_linha('       if vtp_Operacao$$ in (''A'',''E'') then ');
       inf_grava_linha('          select 0 into vnr_vazio from ' || r_$tab.noDonoTabela || '.' || r_$tab.noTabela );
       vAtuRg := 0;
       for r_$chave in c_$chave loop
           vAtuRg := vAtuRg + 1;
           select decode(vAtuRg,1,'           where ','              and ') ||
                  r_$chave.Column_Name || ' = r_dados.' || r_$chave.Column_Name ||
                  decode(vAtuRg,vTotRgCh,';','') into vBuffer from dual ;
           inf_grava_linha(vBuffer);
       end loop;
       inf_grava_linha('       end if; ');
       inf_salta_linha;
       inf_grava_linha('       if vtp_Operacao$$ = ''I'' then');
       inf_grava_linha('          insert into ' || r_$tab.noDonoTabela || '.' || r_$tab.noTabela );
       inf_grava_linha('                      (');

       vAtuRg := 0;
       for r_$campo in c_$campo loop
           vAtuRg := vAtuRg + 1;
           select '               ' || r_$campo.Column_Name ||
                  decode(vAtuRg,vTotRg,'',',') into vBuffer from dual ;
           inf_grava_linha(vBuffer);
       end loop;
       inf_grava_linha('                      )');
       inf_grava_linha('                     values');
       inf_grava_linha('                     (');

       vAtuRg := 0;
       for r_$campo in c_$campo loop
           vAtuRg := vAtuRg + 1;
           select '               r_dados.' || r_$campo.Column_Name ||
                  decode(vAtuRg,vTotRg,'',',') into vBuffer from dual ;
           inf_grava_linha(vBuffer);
       end loop;
       inf_grava_linha('                              );');
       inf_salta_linha;
       inf_grava_linha('       elsif vtp_Operacao$$ = ''A'' then');
       inf_grava_linha('          update ' || r_$tab.noDonoTabela || '.' || r_$tab.noTabela );

       vAtuRg := 0;
       for r_$campo in c_$campo loop
           vAtuRg := vAtuRg + 1;
           select decode(vAtuRg,1,'             set ','                 ') ||
                  rpad(r_$campo.column_name,30) || ' = r_dados.' || r_$campo.Column_Name ||
                  decode(vAtuRg,vTotRg,'',',') into vBuffer from dual ;
           inf_grava_linha(vBuffer);
       end loop;

       vAtuRg := 0;
       for r_$chave in c_$chave loop
           vAtuRg := vAtuRg + 1;
           select decode(vAtuRg,1,'           where ','               and ') ||
                  r_$chave.Column_Name || ' = r_dados.' || r_$chave.Column_Name ||
                  decode(vAtuRg,vTotRgCh,';','') into vBuffer from dual ;
           inf_grava_linha(vBuffer);
       end loop;
       inf_salta_linha;
       inf_grava_linha('       elsif vtp_Operacao$$ = ''E'' then ');
       inf_grava_linha('          delete ' || r_$tab.noDonoTabela || '.' || r_$tab.noTabela );

       vAtuRg := 0;
       for r_$chave in c_$chave loop
           vAtuRg := vAtuRg + 1;
           select decode(vAtuRg,1,'          where ','               and ') ||
                  r_$chave.Column_Name || ' = r_dados.' || r_$chave.Column_Name ||
                  decode(vAtuRg,vTotRgCh,';','') into vBuffer from dual ;
           inf_grava_linha(vBuffer);
       end loop;
       inf_grava_linha('       end if;');
       inf_salta_linha;
       inf_grava_linha('   end loop;');
       inf_salta_linha;
       inf_grava_linha('   delete '|| r_$tab.noDonoLog || '.' || 'LG$_' || substr(r_$tab.noTabela,1,22) || '_$1' || '@' || r_$tab.noOrigem );
       inf_grava_linha('   where nrSequencia$$ = pNR_sequencia;');
       inf_salta_linha;
       inf_grava_linha('  END;');
       inf_grava_linha('END RP'||to_char(r_$tab.nrTabela)||'_' || r_$tab.noTabela || ';');
       inf_salta_linha;
   end loop;

   inf_salta_linha;
   inf_grava_linha('END INF$_REP;');
   inf_grava_linha('/');
   inf_salta_linha;
   inf_fecha_arquivo;

END;
END CRIA_REPLICACAO;


------------------------------------------------------
PROCEDURE CRIA_LOG(PnoDonoTabela IN varchar2, PnoTabela IN varchar2,
                   PnoTablespaceDados in varchar2,PnoTablespaceIndice in varchar2)
IS
BEGIN

DECLARE
   vnoDonoTabela varchar2(30);
   vnoTabela     varchar2(30);
   vnoConstPK    varchar2(30);
	 v_nrinitial   number;
	 v_nrnext      number;
   vTotRg        Number;
   vAtuRg        Number;
	 v_sql         integer;
	 v_nrlin 			 number;

   cursor c_$Campo is
     Select owner,table_name,column_name,data_type,column_id,data_precision,data_scale,data_length
       from ALL_tab_columns TC
      where TC.owner      = vnoDonoTabela
        and TC.table_name = vnoTabela
        and TC.data_type not in ('LONG','RAW','LONGRAW')
      order by TC.column_id;

   cursor c_$chave is
     Select *
       from ALL_cons_columns CC
      where CC.owner          = vnoDonoTabela
        and CC.constraint_name = vnoConstPK
      order by CC.position;

BEGIN

   vNoTabela     := UPPER(pNoTabela);
   vNoDonoTabela := UPPER(pNoDonoTabela);

	 BEGIN
   inf_cria_arquivo('CriaLog.sql');
	 EXCEPTION
	 WHEN UTL_FILE.INVALID_PATH THEN
	     DBMS_OUTPUT.PUT_LINE('invalid path');
   WHEN UTL_FILE.INVALID_MODE THEN
	     DBMS_OUTPUT.PUT_LINE('INVALID MODE');
	 WHEN UTL_FILE.INVALID_OPERATION THEN
	     DBMS_OUTPUT.PUT_LINE('INVALID OPERATION');
   WHEN OTHERS THEN
	     DBMS_OUTPUT.PUT_LINE('OTHERS');
   END ;

   inf_grava_linha('--- Script para criacao das tabelas LG$_     -----');
   inf_grava_linha('--- e a trigger para a atulizacao            -----');
   inf_salta_linha;

   --- gera tabela LG$_notabela

   inf_salta_linha;
   inf_grava_linha('Create table LG$_' || vNoTabela );
   inf_grava_linha('   (' );
   inf_grava_linha('    DTATUALIZACAO$$                DATE         NOT NULL  ,');
   inf_grava_linha('    NRSEQUENCIA$$                  NUMBER       NOT NULL  ,');
   inf_grava_linha('    TPOPERACAO$$                   VARCHAR2(1)  NOT NULL  ,');
   inf_grava_linha('    NOUSUARIO$$                    VARCHAR2(30) NOT NULL  ,');
   inf_grava_linha('    NOUSUARIO_REDE$$               VARCHAR2(30) NULL  ,');
   inf_grava_linha('    NOMAQUINA$$                    VARCHAR2(64) NULL  ,');
   inf_grava_linha('    NOPROGRAMA$$                   VARCHAR2(48) NULL  ,');

   vAtuRg := 0;
   select count(*) into vTotRg
       from ALL_tab_columns TC
      where TC.owner      = vnoDonoTabela
        and TC.table_name = vnoTabela
        and TC.data_type not in ('LONG','RAW','LONGRAW');

   for r_$campo in c_$campo loop
       vAtuRg := vAtuRg + 1;
       select '    ' ||
              rpad(r_$campo.column_name,30) ||
              ' ' ||
              rpad(r_$campo.data_type ||
              decode(r_$campo.data_type,'DATE','',
                                        'LONG','',
                                        'NUMBER',decode(r_$campo.data_precision ,NULL, '',
                                        decode(r_$campo.data_scale,0,'('||r_$campo.data_precision||')',
                                                                     '('||r_$campo.data_precision||','||r_$campo.data_scale||')') ),
              decode(r_$campo.data_length,0,'',concat('(',to_char(r_$campo.data_length) || ')'))),15) ||
              decode(vAtuRg,vTotRg,'',',') into vBuffer from dual ;
       inf_grava_linha(vBuffer);

   end loop;

   inf_grava_linha('   ) tablespace '||PnoTablespaceDados);
	 inf_grava_linha('     pctfree 3 pctused 80 initrans 2 maxtrans 255');
	 -- calcula initial e next para dados
	 begin
       select initial_extent,next_extent into v_nrinitial,v_nrnext
	       from user_tables where table_name = vnotabela;
   exception
	 when no_data_found then
	      v_nrinitial := 10240;
				v_nrnext := 10240;
	 end;
	 inf_grava_linha('     storage( initial '||v_nrInitial);
	 inf_grava_linha('              next '||v_nrnext);
	 inf_grava_linha('              minextents 1 maxextents 121 pctincrease 0);');
	 inf_grava_linha('alter table LG$_'||vnotabela);
	 inf_grava_linha(' add CONSTRAINT PK_LG$_'||vNoTabela||' PRIMARY KEY (NRSEQUENCIA$$, TPOPERACAO$$)');
   inf_grava_linha(' using index tablespace '||PnoTablespaceIndice  );
	 -- calcula initial e next para indice
   v_nrinitial := V_NRINITIAL /10;
	 v_nrnext := V_NRNEXT /10;

	 inf_grava_linha('  storage( initial '||v_nrInitial);
	 inf_grava_linha('           next '||v_nrnext);
	 inf_grava_linha('           minextents 1 maxextents 121 pctincrease 0);');

   inf_salta_linha;


   --- gera trigger para atualizacao da tabela LG$_<notabela>

   inf_grava_linha('CREATE OR REPLACE TRIGGER TLG$_' || vNoTabela );
   inf_grava_linha('BEFORE DELETE OR INSERT OR UPDATE  ');
   inf_grava_linha('ON ' || vNoTabela );
   inf_grava_linha('REFERENCING OLD AS OLD NEW AS NEW FOR EACH ROW ');
   inf_salta_linha;
   inf_grava_linha('DECLARE ');
   inf_grava_linha('   v_nrSequencia    number; ');
   inf_grava_linha('   v_tpOperacao       char;');
   inf_grava_linha('   v_noUsuario        varchar2(30);');
   inf_grava_linha('   v_noUsuario_Rede   varchar2(30);');
   inf_grava_linha('   v_noMaquina      varchar2(64);');
   inf_grava_linha('   v_noPrograma     varchar2(48);');
   inf_grava_linha('BEGIN');
   inf_salta_linha;
   inf_grava_linha('   dbms_application_info.read_client_info(v_noUsuario);');
   inf_grava_linha('   select nvl(v_noUsuario,username), osuser,         machine,     program ');
   inf_grava_linha('     into v_noUsuario,               v_noUsuario_rede, v_nomaquina, v_noprograma');
   inf_grava_linha('        from v$session WHERE AUDSID = USERENV(''SESSIONID'');');
   inf_salta_linha;
   inf_grava_linha('   if    INSERTING  then v_tpOperacao := ''I''; ');
   inf_grava_linha('   elsif UPDATING   then v_tpOperacao := ''A''; ');
   inf_grava_linha('   elsif DELETING   then v_tpOperacao := ''E''; ');
   inf_grava_linha('   end if; ');
   inf_salta_linha;
   inf_grava_linha('   select LG$_SEQ_CONTROLE.nextval into ');
   inf_grava_linha('          v_nrSequencia from dual; ');
   inf_salta_linha;
   inf_grava_linha('   if v_tpOperacao in (''I'',''A'') then');
   inf_grava_linha('      if v_tpOperacao = ''A'' then ');
   inf_grava_linha('         insert into LG$_' || vNoTabela);
   inf_grava_linha('               (dtAtualizacao$$,nrSequencia$$,tpOperacao$$,noUsuario$$,');
   inf_grava_linha('                noUsuario_Rede$$,noMaquina$$,noPrograma$$,');
   vAtuRg := 0;
   for r_$campo in c_$campo loop
       vAtuRg := vAtuRg + 1;
       select '                   ' || r_$campo.Column_Name ||
              decode(vAtuRg,vTotRg,'',',') into vBuffer from dual ;
       inf_grava_linha(vBuffer);
   end loop;
   inf_grava_linha('               )');
   inf_grava_linha('        values');
   inf_grava_linha('               (sysdate,v_nrSequencia,''V'',v_noUsuario,');
   inf_grava_linha('                v_noUsuario_rede,v_noMaquina,v_noPrograma,');

   vAtuRg := 0;
   for r_$campo in c_$campo loop
       vAtuRg := vAtuRg + 1;
       select '                   :old.' || r_$campo.Column_Name ||
              decode(vAtuRg,vTotRg,'',',') into vBuffer from dual ;
       inf_grava_linha(vBuffer);
   end loop;
   inf_grava_linha('               ); ');
   inf_grava_linha('      end if;');
   inf_salta_linha;

   inf_grava_linha('      insert into LG$_' || vNoTabela);
   inf_grava_linha('               (dtAtualizacao$$,nrSequencia$$,tpOperacao$$,noUsuario$$,');
   inf_grava_linha('                noUsuario_Rede$$,noMaquina$$,noPrograma$$,');
   vAtuRg := 0;
   for r_$campo in c_$campo loop
       vAtuRg := vAtuRg + 1;
       select '                ' || r_$campo.Column_Name ||
              decode(vAtuRg,vTotRg,'',',') into vBuffer from dual ;
       inf_grava_linha(vBuffer);
   end loop;
   inf_grava_linha('               )');
   inf_grava_linha('        values');
   inf_grava_linha('               (sysdate,v_nrSequencia,v_tpOperacao,v_noUsuario,');
   inf_grava_linha('                v_noUsuario_rede,v_noMaquina,v_noPrograma,');
   vAtuRg := 0;
   for r_$campo in c_$campo loop
       vAtuRg := vAtuRg + 1;
       select '                :new.' || r_$campo.Column_Name ||
              decode(vAtuRg,vTotRg,'',',') into vBuffer from dual ;
       inf_grava_linha(vBuffer);
   end loop;
   inf_grava_linha('               ); ');
   inf_salta_linha;
   inf_grava_linha('   elsif v_tpOperacao = ''E'' then');
   inf_grava_linha('      insert into LG$_' || vNoTabela );
   inf_grava_linha('               (dtAtualizacao$$,nrSequencia$$,tpOperacao$$,noUsuario$$,');
   inf_grava_linha('                noUsuario_Rede$$,noMaquina$$,noPrograma$$,');
   vAtuRg := 0;
   for r_$campo in c_$campo loop
       vAtuRg := vAtuRg + 1;
       select '                ' || r_$campo.Column_Name ||
              decode(vAtuRg,vTotRg,'',',') into vBuffer from dual ;
       inf_grava_linha(vBuffer);
   end loop;
   inf_grava_linha('               )');
   inf_grava_linha('        values');
   inf_grava_linha('               (sysdate,v_nrSequencia,v_tpOperacao,v_noUsuario,');
   inf_grava_linha('                v_noUsuario_rede,v_noMaquina,v_noPrograma,');
   vAtuRg := 0;
   for r_$campo in c_$campo loop
       vAtuRg := vAtuRg + 1;
       select '                :old.' || r_$campo.Column_Name ||
              decode(vAtuRg,vTotRg,'',',') into vBuffer from dual ;
       inf_grava_linha(vBuffer);
   end loop;
   inf_grava_linha('               ); ');
   inf_grava_linha('   end if;');
   inf_grava_linha('END;');
   inf_salta_linha;
   inf_grava_linha('/');
   inf_salta_linha;
   inf_salta_linha;
   inf_fecha_arquivo;

END;

END CRIA_LOG;


------------------------------------------------------
PROCEDURE CRIA_REP(PnoDonoTabela IN varchar2, PnoTabela IN varchar2,
                   PnoTablespaceDados in varchar2,PnoTablespaceIndice in varchar2)
IS
BEGIN

DECLARE
   vnoDonoTabela varchar2(30);
   vnoTabela     varchar2(30);
   vnoConstPK    varchar2(30);
	 v_nrinitial   number;
	 v_nrnext      number;
   vTotRg        Number;
   vAtuRg        Number;
	 v_sql         integer;
	 v_nrlin 			 number;

   cursor c_$Campo is
     Select owner,table_name,column_name,data_type,column_id,data_precision,data_scale,data_length
       from ALL_tab_columns TC
      where TC.owner      = vnoDonoTabela
        and TC.table_name = vnoTabela
        and TC.data_type not in ('LONG','RAW','LONGRAW')
      order by TC.column_id;

   cursor c_$chave is
     Select *
       from ALL_cons_columns CC
      where CC.owner          = vnoDonoTabela
        and CC.constraint_name = vnoConstPK
      order by CC.position;

BEGIN

   vNoTabela     := UPPER(pNoTabela);
   vNoDonoTabela := UPPER(pNoDonoTabela);

	 BEGIN
   inf_cria_arquivo('CriaRep.sql');
	 EXCEPTION
	 WHEN UTL_FILE.INVALID_PATH THEN
	     DBMS_OUTPUT.PUT_LINE('invalid path');
   WHEN UTL_FILE.INVALID_MODE THEN
	     DBMS_OUTPUT.PUT_LINE('INVALID MODE');
	 WHEN UTL_FILE.INVALID_OPERATION THEN
	     DBMS_OUTPUT.PUT_LINE('INVALID OPERATION');
   WHEN OTHERS THEN
	     DBMS_OUTPUT.PUT_LINE('OTHERS');
   END ;

   inf_grava_linha('--- Script para criacao das tabelas LG$_     -----');
   inf_grava_linha('--- e a trigger para a atulizacao            -----');
   inf_salta_linha;

   --- gera tabela LG$_notabela

   inf_salta_linha;
   inf_grava_linha('Create table LG$_' || substr(vNoTabela,1,22) || '_$1');
   inf_grava_linha('   (' );
   inf_grava_linha('    NRSEQUENCIA$$                  NUMBER       NOT NULL  ,');
   inf_grava_linha('    TPOPERACAO$$                   VARCHAR2(1)  NOT NULL  ');

   inf_grava_linha('   ) tablespace '||PnoTablespaceDados);
	 inf_grava_linha('     pctfree 3 pctused 80 initrans 2 maxtrans 255');
	 -- calcula initial e next para dados
   v_nrinitial := 4096;
   v_nrnext    := 4096;

	 inf_grava_linha('     storage( initial '||v_nrInitial);
	 inf_grava_linha('              next '||v_nrnext);
	 inf_grava_linha('              minextents 1 maxextents 121 pctincrease 0);');
   inf_salta_linha;
	 inf_grava_linha('alter table LG$_'||substr(vnotabela,1,22)|| '_$1' );
	 inf_grava_linha(' add CONSTRAINT PKL$_'||substr(vNoTabela,1,22) || '_$1  PRIMARY KEY (NRSEQUENCIA$$, TPOPERACAO$$)');
   inf_grava_linha(' using index tablespace '||PnoTablespaceIndice  );
	 -- calcula initial e next para indice

	 inf_grava_linha('  storage( initial '||v_nrInitial);
	 inf_grava_linha('           next '||v_nrnext);
	 inf_grava_linha('           minextents 1 maxextents 121 pctincrease 0);');

   inf_salta_linha;
	 inf_grava_linha('--- da grants para que a replicacao possa apagar os dados ' );
	 inf_grava_linha('grant all on LG$_'||substr(vnotabela,1,22)|| '_$1 to R_ROS;' );
   inf_salta_linha;

   --- gera trigger para atualizacao da tabela LG$_<notabela>

   inf_grava_linha('CREATE OR REPLACE TRIGGER TLG$_' || substr(vNoTabela,1,22) || '_$1');
   inf_grava_linha('BEFORE INSERT ');
   inf_grava_linha('ON ' || 'LG$_' || vNoTabela );
   inf_grava_linha('REFERENCING OLD AS OLD NEW AS NEW FOR EACH ROW ');
   inf_salta_linha;
   inf_grava_linha('DECLARE ');
   inf_salta_linha;
   inf_grava_linha('/*************************************************');
   inf_grava_linha(' *  log para replicacao local 1     ');
   inf_grava_linha(' *      origem: DBRO                ');
   inf_grava_linha(' *      destino: DBXV               ');
   inf_grava_linha(' */ ');
   inf_salta_linha;
   inf_grava_linha('BEGIN ');
   inf_grava_linha('   IF :NEW.tpOperacao$$ IN (''A'',''E'',''I'') and :NEW.noUsuario$$ not like ''$TRNSF%'' THEN ');
   inf_grava_linha('      insert into LG$_'|| substr(vNoTabela,1,22) || '_$1 ');
   inf_grava_linha('             ( nrSequencia$$, ');
   inf_grava_linha('               tpOperacao$$ ');
   inf_grava_linha('              ) ');
   inf_grava_linha('             values ');
   inf_grava_linha('             (:NEW.nrSequencia$$, ');
   inf_grava_linha('              :NEW.tpOperacao$$ ');
   inf_grava_linha('             ); ');
   inf_grava_linha('   END IF; ');
   inf_grava_linha('END; ');
   inf_salta_linha;
   inf_grava_linha('/');
   inf_salta_linha;
   inf_salta_linha;
   inf_fecha_arquivo;

END;

END CRIA_REP;



END INF$_LOG;
/

prompt
prompt Creating package body PCK_BX78_TIT_EMS
prompt ======================================
prompt
CREATE OR REPLACE PACKAGE BODY EMS506UNICOO."PCK_BX78_TIT_EMS" is

  /*
  ************************************************************************************************************************************************
  Criac?o          : Alessandro de Paula Santos
  Data             : 16/09/2014
  Modulo Principal : Integrac?o Unicoo X EMS5
  Modulos          : Integrac?o Unicoo X EMS5
  Objetivo         : Realizar a integrac?o do Unicoo com o EMS5 movimento 78
  Alteracoes
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
  |----------------------------------------------------------------------------------------------------------------------------------------------|
  | 16/09/2014 | Alessandro      |                 |           | - Criação PCK.                                                                  |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  ************************************************************************************************************************************************
  */

  -- BR - Baixa Titulo a Receber
  -- BP - Baixa Titulo a Pagar
  -- AF - Adintamento Fornecedor

  -- parametros genericos
  vversaofinanceiro varchar2(10);
  wnaoreprocessa    ti_parametro_integracao.cdparametro%type;
  ttit_ap           tit_ap%rowtype;
  vcommit           number;
  --=========================--
  -- Grava falha de processo --
  -----------------------------
  procedure p_grava_falha(pNRSeq_Controle_integracao number,
                          pCdIntegracao              varchar2,
                          ptxfalha                   varchar2,
                          ptxajuda                   varchar2,
                          pCDSituacao                in OUT varchar2,
                          pnrmensagem                number default null) is
  begin
    pCDSituacao := 'ER';
    begin
      insert into ti_falha_de_processo
        (nrsequencial,
         nrseq_controle_integracao,
         cdintegracao,
         txfalha,
         txajuda,
         dtfalha,
         nrmensagem)
      values
        (sq_ti_falha_de_processo.nextval,
         pnrseq_controle_integracao,
         pCdIntegracao,
         ptxfalha,
         ptxajuda,
         sysdate,
         pnrmensagem);
    exception
      when others then
        raise_application_error(-20001,
                                pnrseq_controle_integracao ||
                                 pCdIntegracao || ptxfalha ||
                                 ptxajuda);
    end;
    --p_update_controle_integracao(pNRSeq_Controle_integracao,
     --                            PCDSITUACAO, NULL);
  end;

  procedure p_ins_bx_controle(pcdidentificador               varchar2,
                              pnrsequencial_origem           number,
                              pcdmodulo                      varchar2,
                              pcdempresa                     varchar2,
                              pnrseq_controle_integracao_org number) is
    vsequencial ti_controle_integracao.nrsequencial%type;
  begin

    if not f_ti_parametro_integracao('TP_INTEGRACAO_ONLINE_UNICOO_EMS5') like '%' || 'BC' || '%' then
      return;
    end if;

    select sq_ti_controle_integracao.nextval into vsequencial
      from dual;

    insert into ti_controle_integracao
                (nrsequencial,
                 tpintegracao,
                 dtgeracao,
                 nrsequencial_origem,
                 dtprocessamento,
                 dtintegracao,
                 cdacao,
                 cdidentificador,
                 cdsituacao,
                 cdempresa,
                 cdmodulo,
                 Nrseq_Controle_Integracao_Org)
                 values
                (vsequencial,
                 pcdmodulo,
                 sysdate,
                 pnrsequencial_origem,
                 null,
                 null,
                 'I',
                 pcdidentificador,
                 'GE',
                 pcdempresa,
                 pcdmodulo,
                 pnrseq_controle_integracao_org);
  end;

  procedure p_processa_acr78(pnrsequencial   in number  default null,
                           pnrsessao       in number  default null,
                           pcdsituacao     in out varchar2) is
    vnrsessao            number;
    vnrconta_corrente    varchar2(12);
    vconta               number;
    vcdsituacao          ti_controle_integracao.cdsituacao%type;
    vAchou               Boolean;
    vCdportador          varchar2(10);
  begin
     vAchou:=true;

     if pNRsessao is null then
     begin
        select sq_ti_sessao.nextval
          into vnrsessao
          from dual;

        update ti_controle_integracao ci set ci.nrsessao = vnrsessao
         where ci.tpintegracao = 'BC'
           and ci.cdsituacao in ('GE','ER');
     end;
     else
        vnrsessao := pNRsessao ;
     end if;

     vAchou  := false;

     for xx in (select ci.nrsequencial, ci.nrsequencial_origem , ci.cdidentificador
                  from ti_controle_integracao ci
                 where ci.tpintegracao = 'BC'
                   and ci.nrsessao = vnrsessao
                   and ci.nrsequencial = pnrsequencial) loop

         vnrconta_corrente:=f_ti_parametro_integracao('PORTADO_BX_CREDITO');

         if vnrconta_corrente is null then
            vcdsituacao := 'ER';
            vAchou      := false;
            p_grava_falha(xx.nrsequencial,
                                     'Baixa Receber',
                                     'DePara CX/BCO Unicoo x CX/BCO TOTVS11',
                                     'Cadastar na tabela ti_tipo_movimento_cmg_caixa u número da conta do caixa :'||vnrconta_corrente,
                                     vcdsituacao,
                                     null);
         else
            vAchou      := true ;
         end if;

         select count(*)
           into vconta
           from v_ti_cx_bx78 a
          where a.nrseq_controle_integracao = xx.nrsequencial;

         if vconta <> 0 then
             vcdsituacao := 'RC';
             vAchou      := True;
         else
             vcdsituacao:='ER';
             vAchou:=false;
             p_grava_falha(xx.nrsequencial,
                                     'Baixa Receber',
                                     'Erro na Pesquisa Titulo TOTVS11',
                                     'Verifique a existencia do titulo no TOTVS11: '||xx.cdidentificador||' - '||sqlerrm,
                                     vcdsituacao,
                                     null);
         end if;

         if vAchou then
         begin
           vcdsituacao := 'RC';
           vconta      := 0;
           insert into ti_cx_bx_acr
           select  nrseq_controle_integracao,
                    cdsituacao,
                    cod_cart_bcia,
                    cod_cliente,
                    cod_empresa,
                    cod_espec_docto,
                    cod_estab,
                    cod_parcela,
                    cod_portador,
                    cod_ser_docto,
                    cod_tit_acr_bco,
                    cod_titulo_acr,
                    dat_baixa,
                    dat_envio,
                    dat_processamento,
                    des_text_histor,
                    val_desconto,
                    val_abatimento,
                    val_ir,
                    val_juros,
                    val_multa,
                    val_liq_titulo,
                    val_titulo,
                    nrpessoa,
                    nrregistro_titulo,
                    nrmovimento_baixa,
                    nrdocumento,
                    nrnossonumero,
                    txhistorico,
                    nrbanco,
                    nragencia,
                    nrconta_corrente
              from v_ti_cx_bx78 a
             where a.nrseq_controle_integracao = xx.nrsequencial;
         exception
             when others then
               vcdsituacao:='ER';
               vAchou:=false;
               p_grava_falha(xx.nrsequencial,
                                         'Baixa Receber',
                                         'Erro na Inclusão ti_cx_bx_acr',
                                         'Verifique a existencia do titulo teste: '||xx.cdidentificador||' - '||sqlerrm,
                                         vcdsituacao,
                                         null);

          end;
          end if;

          update ti_controle_integracao ci set ci.cdsituacao=vcdsituacao
           where ci.nrsequencial = xx.nrsequencial;

          p_commit();
      end loop;
  end;
  procedure p_commit is
  begin
    if vCommit >= 500 then
      commit;
      vCommit := 1;
    end if;
    vCommit := vCommit + 1;
  end;


begin
  -- Initialization
  select vlparametro
    into wnaoreprocessa
    from ti_parametro_integracao
   where cdparametro = 'TPINTEGRACAONAOREPROCESSA';
  vcommit := 1;
  null;
end pck_bx78_tit_ems;
/

prompt
prompt Creating package body PCK_BX_TIT_EMS
prompt ====================================
prompt
CREATE OR REPLACE PACKAGE BODY EMS506UNICOO."PCK_BX_TIT_EMS" is

  /*
  ************************************************************************************************************************************************
  Criac?o          : Alessandro de Paula Santos
  Data             : 16/09/2014
  Modulo Principal : Integrac?o Unicoo X EMS5
  Modulos          : Integrac?o Unicoo X EMS5
  Objetivo         : Realizar a integrac?o do Unicoo com o EMS5
  Alteracoes
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
  |----------------------------------------------------------------------------------------------------------------------------------------------|
  | 16/09/2014 | Alessandro      |                 |           | - Criação PCK.                                                                  |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  ************************************************************************************************************************************************
  */

  -- BR - Baixa Titulo a Receber
  -- BP - Baixa Titulo a Pagar
  -- AF - Adintamento Fornecedor

  -- parametros genericos
  vversaofinanceiro varchar2(10);
  wnaoreprocessa    ti_parametro_integracao.cdparametro%type;
  ttit_ap           tit_ap%rowtype;
  vcommit           number;
  --=========================--
  -- Grava falha de processo --
  -----------------------------
  procedure p_grava_falha(pNRSeq_Controle_integracao number,
                          pCdIntegracao              varchar2,
                          ptxfalha                   varchar2,
                          ptxajuda                   varchar2,
                          pCDSituacao                in OUT varchar2,
                          pnrmensagem                number default null) is
  begin
    pCDSituacao := 'ER';
    begin
      insert into ti_falha_de_processo
        (nrsequencial,
         nrseq_controle_integracao,
         cdintegracao,
         txfalha,
         txajuda,
         dtfalha,
         nrmensagem)
      values
        (sq_ti_falha_de_processo.nextval,
         pnrseq_controle_integracao,
         pCdIntegracao,
         ptxfalha,
         ptxajuda,
         sysdate,
         pnrmensagem);
    exception
      when others then
        raise_application_error(-20001,
                                pnrseq_controle_integracao || pCdIntegracao ||
                                ptxfalha || ptxajuda);
    end;
    --p_update_controle_integracao(pNRSeq_Controle_integracao,
    --                            PCDSITUACAO, NULL);
  end;

  PROCEDURE P_BX_TIT_PERDA(pNrMovimento historico_do_titulo.nrmovimento%type) IS
    -- Receber Baixa por Perda
    /*
    VINICIUS 25/03/2015
    */
    --declare

    cursor c_titulo /*(pNrMovimento_cur historico_do_titulo.nrmovimento%type)*/
    is
      select tr.nrdocumento,
             tr.nrregistro_titulo,
             ht.dtmovimento,
             ht.vlrecebido,
             a.u##cod_ser_docto cod_ser,
             a.cod_tit_acr cod_tit,
             'PE' status,
             a.u##cod_espec_docto
        from tit_acr        a,
             titulo_a_receber       tr,
             historico_do_titulo    ht,
             ti_controle_integracao ci
       where a.cod_refer = 'TR' || lpad(ci.nrsequencial, 8, '0')
         and tr.nrregistro_titulo = ht.nrregistro_titulo
         and ci.nrsequencial_origem = tr.nrregistro_titulo
         and ci.tpintegracao = 'TR'
         and ci.cdsituacao = 'IT'
         and ht.dtmovimento >= '01/10/2014'
         and ht.cdmovimento = 71
         and ht.nrmovimento = pNrMovimento
         and not exists
       (select 1
                from TI_BX_PERDA tt
               where tt.nrdocumento = ht.nrdocumento);

    cursor c_tit is
      select nrdocumento,
             nrregistro_titulo,
             dtmovimento,
             vlrecebido,
             cod_ser,
             cod_tit,
             status,
             cod_espe
        from TI_BX_PERDA t
       where t.status = 'PE';

  begin

    begin
      for y in c_titulo /*(pNrMovimento)*/
       loop

        INSERT INTO TI_BX_PERDA
        VALUES
          (Y.nrdocumento,
           Y.nrregistro_titulo,
           Y.dtmovimento,
           Y.vlrecebido,
           Y.cod_ser,
           Y.cod_tit,
           Y.status,
           Y.u##cod_espec_docto);
        COMMIT;

      end loop;

    end;

    for x in c_tit loop

      update tit_acr a
         set a.dat_indcao_perda_dedut = x.dtmovimento
       where a.u##cod_espec_docto = x.cod_espe
         and a.u##cod_ser_docto = x.cod_ser
         and a.u##cod_tit_acr = x.cod_tit;
      COMMIT;
      update TI_BX_PERDA o
         set o.status = 'XX'
       where o.nrdocumento = x.nrdocumento;
      COMMIT;
    end loop;
    commit;
  end P_BX_TIT_PERDA;

  procedure p_ins_bx_controle(pcdidentificador               varchar2,
                              pnrsequencial_origem           number,
                              pcdmodulo                      varchar2,
                              pcdempresa                     varchar2,
                              pnrseq_controle_integracao_org number) is
    vsequencial ti_controle_integracao.nrsequencial%type;
  begin

    if not f_ti_parametro_integracao('TP_INTEGRACAO_ONLINE_UNICOO_EMS5') like
        '%' || 'BR' || '%' then
      return;
    end if;

    select sq_ti_controle_integracao.nextval into vsequencial from dual;

    insert into ti_controle_integracao
      (nrsequencial,
       tpintegracao,
       dtgeracao,
       nrsequencial_origem,
       dtprocessamento,
       dtintegracao,
       cdacao,
       cdidentificador,
       cdsituacao,
       cdempresa,
       cdmodulo,
       Nrseq_Controle_Integracao_Org)
    values
      (vsequencial,
       pcdmodulo,
       sysdate,
       pnrsequencial_origem,
       null,
       null,
       'I',
       pcdidentificador,
       'GE',
       pcdempresa,
       pcdmodulo,
       pnrseq_controle_integracao_org);
  end;

  procedure p_processa_acr(pnrsequencial in number default null,
                           pnrsessao     in number default null,
                           pcdsituacao   in out varchar2) is
    vnrsessao         number;
    vnrconta_corrente varchar2(12);
    vconta            number;
    vcdsituacao       ti_controle_integracao.cdsituacao%type;
    vAchou            Boolean;
    vCdportador       varchar2(10);
  begin
    vAchou := true;

    if pNRsessao is null then
      begin
        select sq_ti_sessao.nextval into vnrsessao from dual;

        update ti_controle_integracao ci
           set ci.nrsessao = vnrsessao
         where ci.tpintegracao = 'BR'
           and ci.cdsituacao in ('GE', 'ER');
      end;
    else
      vnrsessao := pNRsessao;
    end if;

    vAchou := false;

    for xx in (select ci.nrsequencial,
                      ci.nrsequencial_origem,
                      ci.cdidentificador
                 from ti_controle_integracao ci
                where ci.tpintegracao = 'BR'
                  and ci.nrsessao = vnrsessao) loop

      for y in (select ht.nrconta_corrente vnrconta_corrente
                  from historico_do_titulo             ht,
                       titulo_a_receber                tr,
                       PRODUCAO.cliente@UNICOO_HOMOLOGA                         c,
                       ems506unicoo.ti_tipo_movimento_cmg_caixa tm
                 where ht.nrregistro_titulo = tr.nrregistro_titulo
                   and tr.cdcliente = c.cdcliente
                   and ht.nrconta_corrente || 'x' = tm.nrconta_corrente(+)
                   and ht.nrmovimento = xx.nrsequencial_origem) loop

        if sql%Rowcount = 0 then
          vcdsituacao := 'ER';
          vAchou      := false;
          p_grava_falha(xx.nrsequencial,
                        'Baixa Receber',
                        'Movimento Unicoo Nao Encontrado',
                        'Movimento de Baixa do Unicoo não encontrado, título : ' ||
                        xx.cdidentificador,
                        vcdsituacao,
                        null);
        else
          if y.vnrconta_corrente is null then
            vcdsituacao := 'ER';
            vAchou      := false;
            p_grava_falha(xx.nrsequencial,
                          'Baixa Receber',
                          'DePara CX/BCO Unicoo x CX/BCO TOTVS11',
                          'Cadastar na tabela ti_tipo_movimento_cmg_caixa u número da conta do caixa :' ||
                          vnrconta_corrente,
                          vcdsituacao,
                          null);
          else
            vAchou := true;
          end if;
        end if;
      end loop;

      select count(*)
        into vconta
        from v_ti_cx_bx_acr a
       where a.nrseq_controle_integracao = xx.nrsequencial;

      if vconta <> 0 then
        vcdsituacao := 'RC';
        vAchou      := True;
      else
        vcdsituacao := 'ER';
        vAchou      := false;
        p_grava_falha(xx.nrsequencial,
        'Baixa Receber',
        'Erro na Pesquisa Titulo TOTVS11',
        'Verifique a existencia do titulo no TOTVS11: ' ||
        xx.cdidentificador || ' - ' || sqlerrm,
        vcdsituacao,
        null);
      end if;

      if vAchou then
        begin
          vcdsituacao := 'RC';
          vconta      := 0;
          insert into ti_cx_bx_acr
            select nrseq_controle_integracao,
                   cdsituacao,
                   cod_cart_bcia,
                   cod_cliente,
                   cod_empresa,
                   cod_espec_docto,
                   cod_estab,
                   cod_parcela,
                   cod_portador,
                   cod_ser_docto,
                   cod_tit_acr_bco,
                   cod_titulo_acr,
                   dat_baixa,
                   dat_envio,
                   dat_processamento,
                   des_text_histor,
                   val_desconto,
                   val_abatimento,
                   val_ir,
                   val_juros,
                   val_multa,
                   val_liq_titulo,
                   val_titulo,
                   nrpessoa,
                   nrregistro_titulo,
                   nrmovimento_baixa,
                   nrdocumento,
                   nrnossonumero,
                   txhistorico,
                   nrbanco,
                   nragencia,
                   nrconta_corrente
              from v_ti_cx_bx_acr a
             where a.nrseq_controle_integracao = xx.nrsequencial;
        exception
          when others then
            vcdsituacao := 'ER';
            vAchou      := false;
            p_grava_falha(xx.nrsequencial,
                          'Baixa Receber',
                          'Erro na Inclusão ti_cx_bx_acr',
                          'Verifique a existencia do titulo no Unicoo: ' ||
                          xx.cdidentificador || ' - ' || sqlerrm,
                          vcdsituacao,
                          null);

        end;
      end if;

      update ti_controle_integracao ci
         set ci.cdsituacao = vcdsituacao
       where ci.nrsequencial = xx.nrsequencial;

      p_commit();
    end loop;
  end;

  procedure p_processa_apb(pnrsequencial in number default null,
                           pnrsessao     in number default null,
                           pcdsituacao   in out varchar2) is

    vnrsessao         number;
    vnrconta_corrente varchar2(12);
    vconta            number;
    vcdsituacao       ti_controle_integracao.cdsituacao%type;
    vAchou            Boolean;
    vAoTiTErro        char;
  begin
    vAchou := true;
    if pNRsessao is null then
      begin
        select sq_ti_sessao.nextval into vnrsessao from dual;

        update ti_controle_integracao ci
           set ci.nrsessao = vnrsessao
         where ci.tpintegracao = 'BP'
           and ci.cdsituacao in ('GE', 'ER');
      end;
    else
      vnrsessao := pNRsessao;
    end if;

    for xx in (select ci.nrsequencial,
                      ci.nrsequencial_origem,
                      ci.cdidentificador
                 from ti_controle_integracao ci
                where ci.tpintegracao = 'BP'
                  and ci.nrsessao = vnrsessao) loop
      begin
        select htp.nrconta_bancaria
          into vnrconta_corrente
          from historico_do_titulo_pagar htp,
               titulo_a_pagar   tp,
               PRODUCAO.fornecedor@UNICOO_HOMOLOGA       f
         where htp.nrregistro_titulo = tp.nrregistro_titulo
           and tp.cdfornecedor = f.cdfornecedor
           and htp.nrmovimento = xx.nrsequencial_origem;
      exception
        when others then
          vcdsituacao := 'ER';
          vAchou      := false;
          p_grava_falha(xx.nrsequencial,
                        'Baixa Pagar',
                        'Erro na Inclusão ti_cx_bx_apb',
                        'Verifique a existencia do titulo no Unicoo: ' ||
                        xx.cdidentificador || ' - ' || sqlerrm,
                        vcdsituacao,
                        null);
      end;

      select count(*)
        into vconta
        from ti_tipo_movimento_cmg_caixa a
       where a.nrconta_corrente = vnrconta_corrente;

      if vconta = 0 then
        begin
          vcdsituacao := 'ER';
          vAchou      := false;
          p_grava_falha(xx.nrsequencial,
                        'Baixa Pagar',
                        'DePara CX/BCO Unicoo x CX/BCO TOTVS11',
                        'Cadastar na tabela ti_tipo_movimento_cmg_caixa depara para a ocorrencia :' ||
                        vnrconta_corrente,
                        vcdsituacao,
                        null);
        end;
      else
        begin
          select tap.*
            into ttit_ap
            from ti_controle_integracao    u,
                 historico_do_titulo_pagar ht,
                 tit_ap                    tap
           where ht.nrregistro_titulo = u.nrsequencial_origem
             and u.tpintegracao = 'TP'
             and u.cdsituacao = 'IT'
             and tap.cod_refer = 'I' || lpad(u.nrsequencial, 9, '0')
             and ht.nrmovimento = xx.nrsequencial_origem;

          begin
            insert into ti_cx_bx_apb
              select nrseq_controle_integracao,
                     cdsituacao,
                     cod_cart_bcia,
                     cod_fornecedor,
                     cod_empresa,
                     ttit_ap.cod_espec_docto,
                     ttit_ap.Cod_Estab,
                     ttit_ap.cod_parcela,
                     cod_portador,
                     ttit_ap.cod_ser_docto,
                     cod_tit_apb_bco,
                     ttit_ap.cod_tit_ap,
                     dat_baixa,
                     dat_envio,
                     dat_processamento,
                     des_text_histor,
                     val_desconto,
                     val_abatimento,
                     val_ir,
                     val_juros,
                     val_multa,
                     val_liq_titulo,
                     val_titulo,
                     nrpessoa,
                     nrregistro_titulo,
                     nrmovimento_baixa,
                     nrdocumento,
                     nrnossonumero,
                     txhistorico,
                     nrbanco,
                     nragencia,
                     nrconta_corrente
                from v_ti_cx_bx_apb a
               where a.nrseq_controle_integracao = xx.nrsequencial;

            vcdsituacao := 'RC';

            vAchou := true;
          exception
            when others then
              vcdsituacao := 'ER';
              vAchou      := false;
              p_grava_falha(xx.nrsequencial,
                            'Baixa Pagar',
                            'Erro pesquisando inplantação do titulo ti_cx_bx_apb',
                            'Verifique o registro do titulo de implantação : ' ||
                            xx.cdidentificador || ' - ' || sqlerrm,
                            vcdsituacao,
                            null);
          end;
        exception

          when no_data_found then
       BEGIN     --VINICIUS VERIFICA SE O TITULO ESTÁ COM ERRO
          BEGIN
           select 'S'
            into vAoTiTErro
            from ti_controle_integracao    u,
                 historico_do_titulo_pagar ht
           where ht.nrregistro_titulo = u.nrsequencial_origem
             and u.tpintegracao = 'TP'
             and u.cdsituacao <> 'IT'
             and ht.nrmovimento = xx.nrsequencial_origem
             AND ROWNUM = 1;

          END;

          IF vAoTiTErro = 'S' THEN
            vcdsituacao := 'ER';
            vAchou      := false;
            p_grava_falha(xx.nrsequencial,
                          'Baixa Pagar',
                          'Erro na Inclusão ti_cx_bx_apb',
                          'Verifique o título, pois está com ERRO na integração: ' ||
                          xx.cdidentificador || ' - ' || sqlerrm,
                          vcdsituacao,
                          null);

          END IF;

          EXCEPTION WHEN OTHERS THEN

           vcdsituacao := 'GE'; --Vinicius - 27-04-2015 Alterado para reprocessamento do Job ao não encontrar o titulo
            vAchou      := false;

            END;

          when others then
            vcdsituacao := 'ER';
            vAchou      := false;
            p_grava_falha(xx.nrsequencial,
                          'Baixa Pagar',
                          'Erro na Inclusão ti_cx_bx_apb',
                          'Verifique a existencia do titulo no Unicoo: ' ||
                          xx.cdidentificador || ' - ' || sqlerrm,
                          vcdsituacao,
                          null);
        end;

      end if;
      update ti_controle_integracao ci
         set ci.cdsituacao = vcdsituacao
       where ci.nrsequencial = xx.nrsequencial;

      p_commit();
    end loop;
    commit;
  end;

  procedure p_commit is
  begin
    if vCommit >= 500 then
      commit;
      vCommit := 1;
    end if;
    vCommit := vCommit + 1;
  end;

begin
  -- Initialization
  select vlparametro
    into wnaoreprocessa
    from ti_parametro_integracao
   where cdparametro = 'TPINTEGRACAONAOREPROCESSA';
  vcommit := 1;
  null;
end pck_bx_tit_ems;
/

prompt
prompt Creating package body PCK_EMS506ACERTOS_INTEGRACAO
prompt ==================================================
prompt
CREATE OR REPLACE PACKAGE BODY EMS506UNICOO."PCK_EMS506ACERTOS_INTEGRACAO" is

   procedure pacertafornecedor is
   begin
      for x in (
             select distinct
                    c.rowid                  idfornecedor,
                    a.cdn_fornecedor         codigoems,
                    c.cdfornecedor           fornecedorunicoo,
                    d.rowid                  idtipessoa       ,
                    c.cdfornecedor_ems5      cdems_fornecedor,
                    d.cdn_fornecedor         cdems_tipessoa

               from fornecedor                  a,
                    pessoa                                  b,
                    PRODUCAO.fornecedor@UNICOO_HOMOLOGA                              c,
                    ems506unicoo.ti_pessoa                           d
              where
                    1=1
                and b.nrregistro                                     = c.nrregistro_fornecedor
                and b.nrcgc_cpf                                      = a.cod_id_feder
                and b.nrregistro                                     = d.nrregistro

                and ( c.cdfornecedor_ems5 is null or d.cdn_fornecedor is null )
               )
      loop

         begin
            if x.cdems_fornecedor is null then
               update PRODUCAO.fornecedor@UNICOO_HOMOLOGA
                  set cdfornecedor_ems5 = x.codigoems
                where rowid = x.idfornecedor;
            end if;

            if x.cdems_tipessoa is null then
               update ems506unicoo.ti_pessoa
                  set cdn_fornecedor = x.codigoems
                where rowid = x.idtipessoa;
            end if;
         exception
           when others then
              null;
         end;
      end loop;
   end;
end pck_ems506acertos_integracao;
/

prompt
prompt Creating package body PCK_EMS506CUSTOM
prompt ======================================
prompt
CREATE OR REPLACE PACKAGE BODY EMS506UNICOO."PCK_EMS506CUSTOM" is
  /*  -- Private type declarations
  type <TypeName> is <Datatype>;
  -- Private constant declarations
  <ConstantName> constant <Datatype> := <Value>;
  -- Private variable declarations
  <VariableName> <Datatype>;
  -- Function and procedure implementations
  function <FunctionName>(<Parameter> <Datatype>) return <Datatype> is
    <LocalVariable> <Datatype>;
  begin
    <Statement>;
    return(<Result>);
  end;*/
   -- parametros genericos
   vversaofinanceiro        varchar2(10);
   wnaoreprocessa           ti_parametro_integracao.cdparametro%type;
   ttit_ap                  tit_ap%rowtype;



  PROCEDURE P_TI_MOVIMENTO_CTA_CORRENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                        PNRSESSAO                  NUMBER,
                                        PCDSITUACAO                IN OUT VARCHAR2) IS
  CURSOR C_INTEGRA_CMG IS
  SELECT CI.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
         CI.CDSITUACAO,
         CI.CDIDENTIFICADOR,
         CI.NRSEQUENCIAL_ORIGEM
  FROM
         TI_CONTROLE_INTEGRACAO  CI
  WHERE
         CI.NRSESSAO    =PNRSESSAO
  AND    CI.TPINTEGRACAO='CX'
  AND    CI.CDSITUACAO= PCDSITUACAO
  AND    (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO
      OR
          PNRSEQ_CONTROLE_INTEGRACAO=0);
  VCDINTEGRACAO VARCHAR2(100);
   BEGIN
      FOR L_INTEGRA_CMG IN C_INTEGRA_CMG LOOP
         BEGIN
            PCDSITUACAO:='RC';
            VCDINTEGRACAO := 'TI_MOV_CTA_CORREN';
            INSERT INTO TI_MOVIMENTO_CTA_CORRENTE
            (NRSEQ_CONTROLE_INTEGRACAO,
             CDSITUACAO,
             COD_CTA_CORREN,
             DAT_MOVTO_CTA_CORREN,
             IND_TIP_MOVTO_CTA_CORREN,
             COD_TIP_TRANS_CX,
             IND_FLUXO_MOVTO_CTA_CORREN,
             COD_CENAR_CTBL,
             COD_HISTOR_PADR,
             VAL_MOVTO_CTA_CORREN,
             COD_DOCTO_MOVTO_CTA_BCO,
             COD_MODUL_DTSUL,
             IND_ERRO_VALID,
             DES_HISTOR_PADR,
             NUM_ID_MOVTO_CTA_CORREN
             )
             SELECT
                    MCT.NRSEQ_CONTROLE_INTEGRACAO,
                    MCT.CDSITUACAO,
                    MCT.COD_CTA_CORREN,
                    MCT.DAT_MOVTO_CTA_CORREN,
                    MCT.IND_TIP_MOVTO_CTA_CORREN,
                    MCT.COD_TIP_TRANS_CX,
                    MCT.IND_FLUXO_MOVTO_CTA_CORREN,
                    MCT.COD_CENAR_CTBL,
                    MCT.COD_HISTOR_PADR,
                    MCT.VAL_MVTO_CTA_CORREN,
                    MCT.COD_DOCTO_MOVTO_CTA_BCO,
                    MCT.COD_MODUL_DTSUL,
                    MCT.IND_ERRO_VALID,
                    MCT.DES_HISTOR_PADR,
                    MCT.NUM_ID_MOVTO_CTA_CORREN
             FROM
                    V_TI_MOVIMENTO_CTA_CORRENTE MCT
             WHERE
                    NRSEQ_CONTROLE_INTEGRACAO = L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO;
            IF SQL%ROWCOUNT = 0 THEN
               IF PCDSITUACAO='RC' THEN
                  PCK_EMS506UNICOO.P_GRAVA_FALHA(L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO,
                                VCDINTEGRACAO,
                                'A VIEW V_TI_MOVIMENTO_CTA_CORRENTE N?O ENCONTROU MOVIMENTO CAIXA PARA O PROCESSO ==> ' ||
                                L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO ||
                                'NRMOVIMENTO ==> ' || L_INTEGRA_CMG.NRSEQUENCIAL_ORIGEM,
                                NULL,
                                PCDSITUACAO,
                                NULL);
               END IF;
            END IF;
         EXCEPTION
            WHEN DUP_VAL_ON_INDEX THEN
               PCK_EMS506UNICOO.P_GRAVA_FALHA(L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO,
                             VCDINTEGRACAO,
                             'O MOVIMENTO JA FOI ENVIADO PARA A TI_MOVIMENTO_CTA_CORRENTE ',
                             NULL,
                             PCDSITUACAO,
                             -1);
            WHEN OTHERS THEN
               PCK_EMS506UNICOO.P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                             VCDINTEGRACAO,
                             'ERRO AO INCLUIR MOVIMENTO CAIXA NA TABELA TI_MOVIMENTO_CTA_CORRENTE ==> ' ||
                             SQLERRM || ' PROCESSO ==> ' ||
                             L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO ||
                             'NRMOVIMENTO ==> ' || L_INTEGRA_CMG.NRSEQUENCIAL_ORIGEM,
                             NULL,
                             PCDSITUACAO,
                             NULL);
         END;
         --====================================--
         -- Atualizar o situac?o da integrac?o --
         ----------------------------------------
         PCK_EMS506UNICOO.p_update_controle_integracao(l_integra_cmg.nrseq_controle_integracao,
                                               pcdsituacao ,
                                               null);
      END LOOP;
  end;


begin
  -- Initialization
  null;
end PCK_EMS506CUSTOM;
/

prompt
prompt Creating package body PCK_EMS506UNICOO
prompt ======================================
prompt
CREATE OR REPLACE PACKAGE BODY EMS506UNICOO."PCK_EMS506UNICOO" IS

  /*  -- Private type declarations
  type <TypeName> is <Datatype>;
  -- Private constant declarations
  <ConstantName> constant <Datatype> := <Value>;
  -- Private variable declarations
  <VariableName> <Datatype>;
  -- Function and procedure implementations
  function <FunctionName>(<Parameter> <Datatype>) return <Datatype> is
    <LocalVariable> <Datatype>;
  begin
    <Statement>;
    return(<Result>);
  end;*/
  /*
  ************************************************************************************************************************************************
  Criac?o          : Alecsandro Ferreira dos Santos
  Data             : 02/07/2009
  Modulo Principal : Integrac?o Unicoo X EMS5
  Modulos          : Integrac?o Unicoo X EMS5
  Objetivo         : Realizar a integrac?o do Unicoo com o EMS5
  Alteracoes
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
  |----------------------------------------------------------------------------------------------------------------------------------------------|
  | 09/03/2012 | Alessandro      |                 |           | - Implementada controle de cancelamento de faturas, para permitir cancelar      |
  |            |                 |                 |           |   faturas no modulo faturamento que est?o contabilizadas no EMS5, foi criado o  |
  |            |                 |                 |           |   parametro CANCELFTCTBL com o valor "S" utiliza o controle, valor "N" n?o      |
  |            |                 |                 |           |   utiliza o controle.                                                           |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 21/03/2012 | Alessandro      |                 |           | - Foi realizado correc?o para controla a integrac?o das Faturas Cancelas com o  |
  |            |                 |                 |           |   EMS5, o parametro CANCELFTCTBL foi alterado, com o valor "S" n?o mudou, para  |
  |            |                 |                 |           |   o valor "N" a integrac?o n?o barra o cancelamento no modulo de Faturamento,   |
  |            |                 |                 |           |   mas so envia o estorno para o EMS5 quando o titulo esta contabilizado,        |
  |            |                 |                 |           |   enquanto isso o cancelamento fica pendente na integrac?o com a situac?o ER,   |
  |            |                 |                 |           |   quando o titulo e contabilizado a integrac?o libera o cancelamento            |
  |            |                 |                 |           |   para integrar.                                                                |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 31/05/2012 | Edmilson Braz Fo|                 |           | - O processo de integracao do ACR estava usando o historico do movimento 1 do   |
  |            |                 |                 |           |   titulo a receber para titulos sem fatura, porem, para o ajius n?o esta sendo  |
  |            |                 |                 |           |   o historico nesse movto, o processo foi alterado para pegar o titulo caso     |
  |            |                 |                 |           |   nulo no movimento.                                                            |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  ************************************************************************************************************************************************
  */
  -- parametros genericos
  VVERSAOFINANCEIRO VARCHAR2(10);

  PCPF_DTNASCIMENTO  TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;
  pcdempresa_tit_acr TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;
  pdtini_tit_acr     TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;
  pdtfim_tit_acr     TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;
  pcdempresa_tit_apb TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;
  pdtini_tit_apb     TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;
  pdtfim_tit_apb     TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;
  pcod_empresa_unicoo TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;
  pcod_empresa       TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;

  PMIGRAR_TITULOS_ACR_FECHADOS TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;
  PDT_INI_TITULOS_ACR_FECHADOS TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;
  PDT_CONTABIL_APB TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;
  PDT_CONTABIL_ACR TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;

  TTIT_AP TIT_AP%ROWTYPE;

  FUNCTION md5 (valor VARCHAR) RETURN VARCHAR2 IS
     v_input VARCHAR2(32000) := valor;
     hexkey VARCHAR2(32) := NULL;
  BEGIN
     hexkey := RAWTOHEX(DBMS_OBFUSCATION_TOOLKIT.md5(input => UTL_RAW.cast_to_raw(v_input)));
     RETURN NVL(hexkey,'');
  END;

  function gerar_hash_fornecedor_unicoo(pcdidentificador varchar2, pnrsequencial_origem number)
    return varchar2 is
    v_linha       varchar2(32000) := ' ';
    v_linha_final varchar2(32000) := ' ';
    v_retorno     varchar2(100);
  begin
    begin
      select f.cdfornecedor || f.cdgrupo_fornecedor ||
             f.cdsituacao_fornecedor || f.nrregistro_fornecedor ||
             f.dtexclusao || f.cdconta_contabil || f.cdforma_pagamento ||
             f.nrbanco || f.nragencia || f.nrconta_corrente ||
             f.dtultima_movimentacao || f.nrprevidencia ||
             f.cdcondicaopagamento || f.nrdiaentrega || f.txnegociacao ||
             f.txobservacao || f.vllimitecredito ||
             f.dtalteracaolimitecredito || f.cdusuariolimitecredito ||
             f.vllimitecreditogasto || f.vllimitecreditodisponivel ||
             f.dtinclusao || f.cdusuarioinclusao || f.dtfundacao ||
             f.vltotalcompras || f.nrmediaatraso || f.vlprimeiracompras ||
             f.dtprimeiracompras || f.vlultimacompras || f.dtultimacompras ||
             f.vlmaiorcompras || f.dtmaiorcompras || f.vlultimacotacao ||
             f.dtultimacotacao || f.dtalteracao || f.cdusuarioalteracao ||
             f.cdusuarioexclusao || f.nofantasia || f.aocamara ||
             f.txadmin_camara || f.aoparticipa_encontro || f.cdemail ||
             f.nrlayout || f.aosempre_participa_dirf ||
             f.dtvalidadeconsultanvisa || f.cdtipo_enquadramento_empresa ||
             f.aoopcao_simples_nacional || f.cdcodigofornimp
        into v_linha
        from producao.fornecedor@unicoo_homologa f
       where f.cdfornecedor = pcdidentificador;
    exception
      when others then
        v_linha := pcdidentificador;
    end;

    v_linha_final := v_linha;

    begin
      select p.nrregistro || p.nopessoa || p.cdsitpessoa || p.tppessoa ||
             p.nrcgc_cpf || p.nrinscest_rg || p.cdramoativ ||
             p.dtnascimento || p.cdsexo || p.cdestadocivil || p.nomae ||
             p.nrreg_nascto || p.nocartorio_reg || p.txobservacoes ||
             p.nooperador || p.nonaturalidade || p.cdnacionalidade ||
             p.noorgao_emissor_rg || p.nrpis || p.cdgrau_de_instrucao ||
             p.cdreligiao || p.nopai || p.noesposo || p.cdetnia ||
             p.nrinscmun || p.nrcei || p.nrcartao_convenio || p.noabreviado ||
             p.cdpais_emissor_id || p.nrcns || p.dtexpedicao_rg ||
             p.cdestado_emissor_rg || p.nrdeclaracao_nasc_vivo ||
             p.cdcidade_naturalidade || p.aoestrangeiro || p.nosocial ||
             p.norazao_social || p.tpgenero_social
        into v_linha
        from pessoa p
       where p.nrregistro = pnrsequencial_origem;
    exception
      when others then
        v_linha := pnrsequencial_origem;
    end;

    v_linha_final := v_linha_final || v_linha;

    v_retorno := md5(v_linha_final);

    return v_retorno;

  end gerar_hash_fornecedor_unicoo;

  function gerar_hash_cliente_unicoo(pcdidentificador varchar2, pnrsequencial_origem number)
    return varchar2 is
    v_linha       varchar2(32000) := ' ';
    v_linha_final varchar2(32000) := ' ';
    v_retorno     varchar2(100);
  begin
    begin
      select c.nrregistro_cliente || c.nrcontrato || c.cdgrupo_cliente ||
             c.cdsituacao_cliente || c.cdconta_contabil || c.dtexclusao ||
             c.dtultima_movimentacao || c.aoemite_titulo ||
             c.txmensagem_boleto || c.cdcliente || c.cdcategoria ||
             c.cdclassificacao || c.cdbloqueio || c.vllimitecredito ||
             c.nrprazomaximo || c.dtalteracaolimitecredito ||
             c.cdusuariolimitecredito || c.vltotaldebito ||
             c.vllimite_credito || c.nrprazo_maximo ||
             c.dtalteracao_limite_credito || c.cdusuario_limite_credito ||
             c.vltotal_debito || c.vltotal_credito ||
             c.dtinicio_libera_bloqueio || c.dtfim_libera_bloqueio ||
             c.aodebito_automatico || c.nrbanco || c.nragencia ||
             c.nrconta_corrente || c.cdgrupo_economico ||
             c.dtinicio_deb_automatico || c.dtfim_deb_automatico ||
             c.nrretorno || c.cdformapagamentopadrao || c.cdplanopagamento ||
             c.aogera_dmed
        into v_linha
        from producao.cliente@unicoo_homologa c
       where c.cdcliente = pcdidentificador;
    exception
      when others then
        v_linha := pcdidentificador;
    end;

    v_linha_final := v_linha;

    begin
      select p.nrregistro || p.nopessoa || p.cdsitpessoa || p.tppessoa ||
             p.nrcgc_cpf || p.nrinscest_rg || p.cdramoativ ||
             p.dtnascimento || p.cdsexo || p.cdestadocivil || p.nomae ||
             p.nrreg_nascto || p.nocartorio_reg || p.txobservacoes ||
             p.nooperador || p.nonaturalidade || p.cdnacionalidade ||
             p.noorgao_emissor_rg || p.nrpis || p.cdgrau_de_instrucao ||
             p.cdreligiao || p.nopai || p.noesposo || p.cdetnia ||
             p.nrinscmun || p.nrcei || p.nrcartao_convenio || p.noabreviado ||
             p.cdpais_emissor_id || p.nrcns || p.dtexpedicao_rg ||
             p.cdestado_emissor_rg || p.nrdeclaracao_nasc_vivo ||
             p.cdcidade_naturalidade || p.aoestrangeiro || p.nosocial ||
             p.norazao_social || p.tpgenero_social
        into v_linha
        from pessoa p
       where p.nrregistro = pnrsequencial_origem;
    exception
      when others then
        v_linha := pnrsequencial_origem;
    end;

    v_linha_final := v_linha_final || v_linha;

    v_retorno := md5(v_linha_final);

    return v_retorno;

  end gerar_hash_cliente_unicoo;

function get_hash(ptpintegracao varchar2,
                  pcdidentificador varchar2,
                  pnrsequencial_origem number) return varchar2 is
  hash_anterior varchar2(100);
begin
  begin
    select h.txhash into hash_anterior
      from ti_hash h
     where h.tpintegracao = ptpintegracao
       and h.nrsequencial_origem = pnrsequencial_origem
       and h.cdidentificador = pcdidentificador;
  exception
    when NO_DATA_FOUND then
      hash_anterior := ' ';
  end;

  return hash_anterior;
end get_hash;

  PROCEDURE VALIDA_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                           PCDFORNECEDOR_EMS5         IN NUMBER) IS
    TTI_TIT_APB TI_TIT_APB%ROWTYPE;
    JAEXISTE    NUMBER;
  BEGIN
    SELECT *
      INTO TTI_TIT_APB
      FROM TI_TIT_APB A
     WHERE NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
    BEGIN
      SELECT COUNT(1)
        INTO JAEXISTE
        FROM TIT_AP A, TI_EMPRESA EMP
       WHERE 1 = 1
         AND A.CDN_FORNECEDOR = PCDFORNECEDOR_EMS5
         AND A.COD_TIT_AP = TTI_TIT_APB.COD_TITULO_AP
         AND A.COD_ESPEC_DOCTO = TTI_TIT_APB.COD_ESPEC_DOCTO
         AND A.COD_SER_DOCTO = TTI_TIT_APB.COD_SER_DOCTO
         AND A.COD_EMPRESA = EMP.COD_EMPRESA
         AND A.COD_PARCELA = TTI_TIT_APB.COD_PARCELA
         AND EMP.CDEMPRESA =
             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
      -- fabiano, nao foi encontrado necessidade de manter a delecao deste registro.
      --          delete ti_tit_apb where nrseq_controle_integracao = pnrseq_controle_integracao;
      -- fabiano,  caso encontre mais que 1 titulo, entao gera falha
DBMS_OUTPUT.PUT_LINE( 'P54 ACHOU TITULO NO EMS5? ' || JAEXISTE || ' - ' || pnrseq_controle_integracao);
      IF JAEXISTE > 0 THEN
--        DBMS_OUTPUT.PUT_LINE( 'P55 DELETANDO TI_TIT_APB POIS JÁ EXISTE NO EMS5! ' || pnrseq_controle_integracao);
        delete ti_tit_apb where nrseq_controle_integracao = pnrseq_controle_integracao;
-- teste alex 16/05/2017          RAISE_APPLICATION_ERROR(-20010, 'Titulo ja existe no EMS');
      END IF;
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        NULL;
    END;
  END VALIDA_TIT_APB;

  PROCEDURE CANCELA_CONTROLE_TIT_IMPOSTOS(PNRSESSAO IN NUMBER) IS
    WTPDOC VARCHAR2(40);
  BEGIN
    /*
       Cancela os controles de titulos do contas a pagar unicoo referentes
       a impostos ( TX ), pois esses titulos n?o s?o integrados para o EMS
    */
    WTPDOC := F_PARAMETRO('TPDOCPRE');
    IF WTPDOC IS NULL THEN
      RAISE_APPLICATION_ERROR(-20001, 'Parametro TPDOCPRE n?o encontrado');
    END IF;
    FOR X IN (SELECT A.ROWID
                FROM TI_CONTROLE_INTEGRACAO A, TITULO_A_PAGAR B
               WHERE A.NRSEQUENCIAL_ORIGEM = B.NRREGISTRO_TITULO
                 AND A.CDSITUACAO IN ('GE', 'ER', 'PE', 'RC') --ADICIONADO OUTRAS SITUACOES ALEM DE GE --BRAZ 11/11/10
                 AND A.TPINTEGRACAO = 'TP'
                 AND A.NRSESSAO = PNRSESSAO
                 AND B.TPDOCUMENTO = WTPDOC
                 AND NOT EXISTS
               (SELECT 1
                        FROM TAXA_TITULO_INTEGRACAO T
                       WHERE T.NRREGISTRO_TITULO_TAXA = B.NRREGISTRO_TITULO)) LOOP
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'A integracao do unicoo com o ems5 nao integra titulos de previsao'
       WHERE ROWID = X.ROWID;
    END LOOP;
  END CANCELA_CONTROLE_TIT_IMPOSTOS;

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_ACR(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
    VCTBZDA NUMBER; -- Alessandro 29/09/2011
    QTD_MOV NUMBER;
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TR'
         AND CI.NRSEQUENCIAL_ORIGEM = PNRRREGISTRO_TITULO
         AND CI.CDIDENTIFICADOR = PNRDOCUMENTO
         AND CI.CDIDENTIFICADOR NOT IN ('CA', 'RE');
    VACHOU BOOLEAN;
  BEGIN
    VACHOU := FALSE;
    FOR L_TITULO IN C_TITULO LOOP
      IF L_TITULO.CDSITUACAO = 'IT' THEN
        VACHOU := TRUE;
      ELSIF L_TITULO.CDSITUACAO IN ('GE', 'ER') THEN
        UPDATE TI_CONTROLE_INTEGRACAO TA
           SET TA.CDSITUACAO = 'CA', TA.TXOBSERVACAO = 'LINHA 152'
         WHERE TA.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
      ELSE
        BEGIN
          UPDATE TI_TIT_ACR TA
             SET TA.CDSITUACAO = 'CA'
           WHERE TA.NRSEQ_CONTROLE_INTEGRACAO = L_TITULO.NRSEQUENCIAL;
          -----
          UPDATE TI_CONTROLE_INTEGRACAO TA
             SET TA.CDSITUACAO = 'CA', TA.TXOBSERVACAO = 'LINHA 166'
           WHERE TA.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
        EXCEPTION
          WHEN OTHERS THEN
            VACHOU := TRUE;
            RAISE_APPLICATION_ERROR(-20101,
                                    'Erro ao cancelar a integrao da fatura ' ||
                                    PNRDOCUMENTO || ' ' || SQLERRM);
        END;
      END IF;
    END LOOP;
    IF VACHOU THEN
      SELECT COUNT(*)
        INTO QTD_MOV
        FROM EMS_MOVIMENTO_TITULO_ACR EMS, MOVTO_TIT_ACR MOV --BRAZ 10/12
       WHERE EMS.NUM_ID_MOVTO_TIT_ACR = MOV.NUM_ID_MOVTO_TIT_ACR
         AND MOV.U##COD_ESTAB = EMS.COD_ESTAB
         AND EMS.NRREGISTRO_TITULO = PNRRREGISTRO_TITULO;
      IF QTD_MOV > 1 THEN
        VRESULT := 'N';
      ELSE
        IF F_TI_PARAMETRO_INTEGRACAO('CANCELFTCTBL') = 'S' THEN
          -- ALESSANDRO 09/03/2012
          -- vResult:='S'; -- Alessandro 07/03/2012
          -- Inicio Alessandro 29/09/2011
          VCTBZDA := 0;
          SELECT MOV.LOG_APROP_CTBL_CTBZDA
            INTO VCTBZDA
            FROM EMS_MOVIMENTO_TITULO_ACR EMS, MOVTO_TIT_ACR MOV --BRAZ 10/12
           WHERE EMS.NUM_ID_MOVTO_TIT_ACR = MOV.NUM_ID_MOVTO_TIT_ACR
             AND MOV.U##COD_ESTAB = EMS.COD_ESTAB
             AND EMS.NRREGISTRO_TITULO = PNRRREGISTRO_TITULO;
          IF VCTBZDA = 0 THEN
            VRESULT := 'N';
            RAISE_APPLICATION_ERROR(-20101,
                                    'Titulo no EMS5 n?o esta contabilizado. Contabilize antes de Cancelar.');
          ELSE
            VRESULT := 'S';
          END IF;
          -- Final Alessandro 29/09/2011
        ELSE
          VRESULT := 'S';
        END IF; -- ALESSANDRO 09/03/2012
      END IF;
    ELSE
      VRESULT := 'S';
    END IF;
    RETURN VRESULT;
  END;

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_APB(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TP'
         AND CI.NRSEQUENCIAL_ORIGEM = PNRRREGISTRO_TITULO
         AND CI.CDIDENTIFICADOR = PNRDOCUMENTO
         AND CI.CDIDENTIFICADOR NOT IN ('CA', 'RE');
    VACHOU BOOLEAN;
  BEGIN
    VACHOU := FALSE;
    FOR L_TITULO IN C_TITULO LOOP
      IF L_TITULO.CDSITUACAO = 'IT' THEN
        VACHOU := TRUE;
      ELSIF L_TITULO.CDSITUACAO IN ('GE', 'ER') THEN
        UPDATE TI_CONTROLE_INTEGRACAO TA
           SET TA.CDSITUACAO = 'CA', TA.TXOBSERVACAO = 'LINHA 250'
         WHERE TA.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
      ELSE
        BEGIN
          UPDATE TI_TIT_APB TA
             SET TA.CDSITUACAO = 'CA'
           WHERE TA.NRSEQ_CONTROLE_INTEGRACAO = L_TITULO.NRSEQUENCIAL;
        EXCEPTION
          WHEN OTHERS THEN
            VACHOU := TRUE;
            RAISE_APPLICATION_ERROR(-20101,
                                    'Erro ao cancelar a integrao da fatura ' ||
                                    PNRDOCUMENTO || ' ' || SQLERRM);
        END;
      END IF;
    END LOOP;
    IF VACHOU THEN
      VRESULT := 'N';
    ELSE
      VRESULT := 'S';
    END IF;
    RETURN VRESULT;
  END;

  FUNCTION F_PERMITE_ALTERAR_TIT_ACR(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
  BEGIN
    -- select DECODE(count(*),0,'S','N')
    SELECT CASE
             WHEN COUNT(*) < 1 THEN
              'S'
             ELSE
              'N'
           END
      INTO VRESULT
      FROM EMS_MOVIMENTO_TITULO_ACR EMS, EMS506UNICOO.TIT_ACR TTA --BRAZ 10/12
     WHERE EMS.NRDOCUMENTO = PNRDOCUMENTO
       AND EMS.NRREGISTRO_TITULO = PNRREGISTRO_TITULO
       AND EMS.NUM_ID_TIT_ACR = TTA.NUM_ID_TIT_ACR
       AND EMS.COD_ESTAB = TTA.U##COD_ESTAB
       AND EMS.IND_TRANS_ACR_ABREV = 'IMPL';
    -----------------------------
    RETURN VRESULT;
  END;

  FUNCTION F_PERMITE_ALTERAR_TIT_APB(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
  BEGIN
    SELECT DECODE(COUNT(*), 0, 'S', 'N')
      INTO VRESULT
      FROM TI_MOVTO_TIT_AP EMS, TIT_AP TTA
     WHERE EMS.NRDOCUMENTO = PNRDOCUMENTO
       AND EMS.NRREGISTRO_TITULO = PNRREGISTRO_TITULO
       AND EMS.NUM_ID_TIT_AP = TTA.NUM_ID_TIT_AP
       AND EMS.COD_ESTAB = TTA.U##COD_ESTAB
       AND EMS.IND_TRANS_AP_ABREV = 'IMPL';
    -----------------------------
    RETURN VRESULT;
  END;

  PROCEDURE P_INS_TI_CONTROLE_INTEGRACAO(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER) IS
    VSEQUENCIAL TI_CONTROLE_INTEGRACAO.NRSEQUENCIAL%TYPE;
  BEGIN
    IF NOT F_TI_PARAMETRO_INTEGRACAO('TP_INTEGRACAO_ONLINE_UNICOO_EMS5') LIKE
        '%' || PTPINTEGRACAO || '%' THEN
      RETURN;
    END IF;
    SELECT SQ_TI_CONTROLE_INTEGRACAO.NEXTVAL INTO VSEQUENCIAL FROM DUAL;
    INSERT INTO TI_CONTROLE_INTEGRACAO
      (NRSEQUENCIAL,
       TPINTEGRACAO,
       DTGERACAO,
       NRSEQUENCIAL_ORIGEM,
       DTPROCESSAMENTO,
       DTINTEGRACAO,
       CDACAO,
       CDIDENTIFICADOR,
       CDSITUACAO,
       CDEMPRESA,
       CDMODULO,
       NRSEQ_CONTROLE_INTEGRACAO_ORG)
    VALUES
      (VSEQUENCIAL,
       PTPINTEGRACAO,
       SYSDATE,
       PNRSEQUENCIAL_ORIGEM,
       NULL,
       NULL,
       PCDACAO,
       PCDIDENTIFICADOR,
       'GE',
       PCDEMPRESA,
       PCDMODULO,
       PNRSEQ_CONTROLE_INTEGRACAO_ORG);
  END;

  PROCEDURE P_INS_TI_CONTROLE_INTEGR_CAN(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER) IS
    VSEQUENCIAL TI_CONTROLE_INTEGRACAO.NRSEQUENCIAL%TYPE;
  BEGIN
    IF NOT F_TI_PARAMETRO_INTEGRACAO('TP_INTEGRACAO_ONLINE_UNICOO_EMS5') LIKE
        '%' || PTPINTEGRACAO || '%' THEN
      RETURN;
    END IF;
    SELECT SQ_TI_CONTROLE_INTEGRACAO.NEXTVAL INTO VSEQUENCIAL FROM DUAL;
    INSERT INTO TI_CONTROLE_INTEGRACAO
      (NRSEQUENCIAL,
       TPINTEGRACAO,
       DTGERACAO,
       NRSEQUENCIAL_ORIGEM,
       DTPROCESSAMENTO,
       DTINTEGRACAO,
       CDACAO,
       CDIDENTIFICADOR,
       CDSITUACAO,
       CDEMPRESA,
       CDMODULO,
       NRSEQ_CONTROLE_INTEGRACAO_ORG)
    VALUES
      (VSEQUENCIAL,
       PTPINTEGRACAO,
       SYSDATE,
       PNRSEQUENCIAL_ORIGEM,
       NULL,
       NULL,
       PCDACAO,
       PCDIDENTIFICADOR,
       'CA',
       PCDEMPRESA,
       PCDMODULO,
       PNRSEQ_CONTROLE_INTEGRACAO_ORG);
  END;

  PROCEDURE P_DEFINE_TI_PESSOA(PNRCGC_CPF              VARCHAR2,
                               PNOPESSOA               VARCHAR2,
                               PNOABREVIADO            VARCHAR2,
                               PDTNASCIMENTO           DATE,
                               PTPPESSOA               VARCHAR2,
                               PNRREGISTRO             NUMBER,
                               PTPORIGEM               VARCHAR2,
                               PNOABREVIADO_FORNECEDOR IN OUT VARCHAR2,
                               PCDN_FORNECEDOR         IN OUT VARCHAR2,
                               PNOABREVIADO_CLIENTE    IN OUT VARCHAR2,
                               PCDN_CLIENTE            IN OUT VARCHAR2,
                               PAODEFINEPESSOA         VARCHAR2 -- < S/N>
                               ) IS
    VTI_PESSOA       TI_PESSOA%ROWTYPE;
    VTI_PESSOA_PAI   TI_PESSOA%ROWTYPE;
    VCOUNT           NUMBER;
    VEXISTE_PESSOA   CHAR;
    VEXISTE_REGISTRO CHAR;
    CNOM_ABREVIADO   TI_PESSOA.NOABREVIADO_CLIENTE%TYPE := 'p' ||
                                                           PNRREGISTRO;
    VCOD_EMS         NUMBER := 1000;
    VCOD_EMS_AUX     NUMBER := 0;
    VEXISTE_COD      CHAR;
    vaoexiste_nome   char;
    vnom_abrev       varchar2(12);
    qttamanho        number;
    vnum_aux         number := 0;
    vcount           number;

    FUNCTION F_TESTA_NOME(PNOME_ABREV TI_PESSOA.NOABREVIADO_CLIENTE%TYPE)
      RETURN CHAR IS

      VEXISTE_NOME CHAR;

    BEGIN
      BEGIN
        SELECT 'S'
          INTO VEXISTE_NOME
          FROM TI_PESSOA P
         WHERE P.NOABREVIADO_CLIENTE = PNOME_ABREV
           AND ROWNUM = 1;
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          VEXISTE_NOME := 'N';
      END;

      RETURN VEXISTE_NOME;

    END;
    --======================--
    -- Definir a Pessoa Pai --
    --------------------------
    PROCEDURE P_DEFINE_PESSOA_PAI IS
    BEGIN
      IF PTPPESSOA = 'F' THEN
        BEGIN
          --============--
          -- CPF / NOME --
          ----------------
          SELECT TI.*
            INTO VTI_PESSOA_PAI
            FROM PESSOA PS, TI_PESSOA TI
           WHERE TI.NRREGISTRO = PS.NRREGISTRO
             AND PS.NRCGC_CPF = PNRCGC_CPF
             AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
             AND PS.TPPESSOA = PTPPESSOA
             AND TI.NRREGISTRO_PAI IS NULL
             AND ROWNUM = 1
           ORDER BY TI.NRREGISTRO DESC;
          VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO := 'CPF_PESSOA';
        EXCEPTION
          WHEN NO_DATA_FOUND THEN

            IF PCPF_DTNASCIMENTO = 'S' THEN
              BEGIN
                --==========================--
                -- CPF / DATA DE NASCIMENTO --
                ------------------------------
                SELECT TI.*
                  INTO VTI_PESSOA_PAI
                  FROM PESSOA PS, TI_PESSOA TI
                 WHERE TI.NRREGISTRO = PS.NRREGISTRO
                   AND PS.NRCGC_CPF = PNRCGC_CPF
                   AND PS.DTNASCIMENTO = PDTNASCIMENTO
                   AND PS.TPPESSOA = PTPPESSOA
                   AND PS.DTNASCIMENTO IS NOT NULL
                   AND ROWNUM = 1
                 ORDER BY TI.NRREGISTRO DESC;
                VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO := 'CPF_DTNASCIMENTO';
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VTI_PESSOA_PAI := NULL;
              END;
            ELSE
              VTI_PESSOA_PAI := NULL;
            END IF;
        END;
      ELSE
        BEGIN
          --======--
          -- CNPJ --
          ----------
          SELECT TI.*
            INTO VTI_PESSOA_PAI
            FROM PESSOA PS, TI_PESSOA TI
           WHERE TI.NRREGISTRO = PS.NRREGISTRO
             AND PS.NRCGC_CPF = PNRCGC_CPF
             AND PS.TPPESSOA = PTPPESSOA
             AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
             AND TI.NRREGISTRO_PAI IS NULL
             AND ROWNUM = 1
           ORDER BY TI.NRREGISTRO DESC;
          VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO := 'CNPJ';
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            VTI_PESSOA_PAI := NULL;
        END;
      END IF;
    END P_DEFINE_PESSOA_PAI; -- p_define_pessoa_pai

  BEGIN

    VTI_PESSOA_PAI := NULL;
    VEXISTE_COD    := 'N';

    BEGIN
      SELECT 'S'
        INTO VEXISTE_REGISTRO
        FROM TI_PESSOA T
       WHERE T.NRREGISTRO = PNRREGISTRO;
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        VEXISTE_REGISTRO := 'N';
    END;

    IF VEXISTE_REGISTRO = 'N' THEN

      BEGIN
        SELECT 'S'
          INTO VEXISTE_PESSOA
          FROM TI_PESSOA TP
         WHERE TP.NRCGC_CPF = PNRCGC_CPF
           AND ROWNUM = 1
           and f_ti_parametro_integracao('UNIFICA_PESSOA') = 'S';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          VEXISTE_PESSOA := 'N';
      END;

      --SE NAO EXISTE NINGUEM COM ESTE CPF/CNPJ INSERE NA TABELA TI_PESSOA
      IF VEXISTE_PESSOA = 'N' THEN

        VTI_PESSOA.NRREGISTRO          := PNRREGISTRO;
        VTI_PESSOA.NRREGISTRO_PAI      := NULL;
        VTI_PESSOA.TXREGRA_AGRUPAMENTO := NULL;
        VTI_PESSOA.NOPESSOA            := PNOPESSOA;
        VTI_PESSOA.DTNASCIMENTO        := PDTNASCIMENTO;
        VTI_PESSOA.NRCGC_CPF           := PNRCGC_CPF;

        --VINICIUS 30/08 NOVA DEFINICAO PARA NOME ABREVIADO NO EMS5
        --vnom_abrev := trim(F_ABREVIA_NOME(VTI_PESSOA.NOPESSOA, 12, 'PEA'));

        --ALEX 26/04/2018 - USAR NOME ABREVIADO AO INVEZ DO NOME COMPLETO
        vnom_abrev := trim(F_ABREVIA_NOME(replace(nvl(pNOABREVIADO,VTI_PESSOA.NOPESSOA),'UNIMED','U.'), 12, 'PEA'));

        vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

        WHILE vaoexiste_nome = 'S' LOOP

          vnum_aux := vnum_aux + 1;

          qttamanho := length(vnum_aux);

          vnom_abrev := substr(vnom_abrev, 0, (12 - qttamanho)) || vnum_aux;

          vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

        END LOOP;

        VTI_PESSOA.NOABREVIADO_CLIENTE := vnom_abrev;

        VTI_PESSOA.NOABREVIADO_FORNECEDOR := vnom_abrev;

        /* VTI_PESSOA.NOABREVIADO_CLIENTE := CASE
                                              WHEN f_ti_parametro_integracao('INTR_EMS2') = 'S' THEN
                                               SUBSTR(PNRCGC_CPF, 0, 12)
                                              ELSE
                                               PNRCGC_CPF
                                            END;

          VTI_PESSOA.NOABREVIADO_FORNECEDOR := CASE
                                                 WHEN f_ti_parametro_integracao('INTR_EMS2') = 'S' THEN
                                                  SUBSTR(PNRCGC_CPF, 0, 12)
                                                 ELSE
                                                  PNRCGC_CPF
                                               END;
        */

        --SE A ORIGEM FOR "UNIMED" NAO PREENCHE O CODIGO CLIENTE / FORNECEDOR
        IF PTPORIGEM = 'UNIMED' THEN
          VTI_PESSOA.CDN_FORNECEDOR := NULL;
          VTI_PESSOA.CDN_CLIENTE    := NULL;
        ELSE
          --SE A ORIGEM NAO FOR FOR "UNIMED" PREENCHE O CODIGO CLIENTE / FORNECEDOR

          --BUSCAR MAIOR CDN_CLIENTE x CDN_FORNECEDOR no EMS5 E GRAVAR EM VCOD_EMS
          BEGIN
            SELECT MAX(CDN_CLIENTE) + 1 INTO VCOD_EMS_AUX FROM ems5.cliente;
          exception
            when others then
              vcod_ems_aux := 0;
          END;
          if vcod_ems_aux > vcod_ems then
            vcod_ems := vcod_ems_aux;
          end if;

          BEGIN
            SELECT MAX(CDN_fornecedor) + 1 INTO VCOD_EMS_AUX FROM ems5.fornecedor;
          exception
            when others then
              vcod_ems_aux := 0;
          END;
          if vcod_ems_aux > vcod_ems then
            vcod_ems := vcod_ems_aux;
          end if;

          if VCOD_EMS < 1000 then
            VCOD_EMS := 1000;
          end if;

          BEGIN
            SELECT 'S'
              INTO VEXISTE_COD
              FROM TI_PESSOA TP
             WHERE NVL(TP.CDN_CLIENTE, 0) >= VCOD_EMS
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS;
              VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS;
          END;

          IF VEXISTE_COD = 'S' THEN
            BEGIN
              SELECT MAX(CDN_CLIENTE) + 1 INTO VCOD_EMS_AUX FROM TI_PESSOA;
            END;
            VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS_AUX;
            VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS_AUX;

          END IF;

        END IF;

        INSERT INTO TI_PESSOA
          (NRREGISTRO,
           NOABREVIADO_CLIENTE,
           NOABREVIADO_FORNECEDOR,
           CDN_FORNECEDOR,
           CDN_CLIENTE,
           NRREGISTRO_PAI,
           TXREGRA_AGRUPAMENTO,
           NOPESSOA,
           DTNASCIMENTO,
           NRCGC_CPF,
           DTGERACAO,
           DTULTIMA_ATUALIZACAO)
        VALUES
          (VTI_PESSOA.NRREGISTRO,
           VTI_PESSOA.NOABREVIADO_CLIENTE,
           VTI_PESSOA.NOABREVIADO_FORNECEDOR,
           VTI_PESSOA.CDN_FORNECEDOR,
           VTI_PESSOA.CDN_CLIENTE,
           VTI_PESSOA.NRREGISTRO_PAI,
           VTI_PESSOA.TXREGRA_AGRUPAMENTO,
           VTI_PESSOA.NOPESSOA,
           VTI_PESSOA.DTNASCIMENTO,
           VTI_PESSOA.NRCGC_CPF,
           SYSDATE,
           SYSDATE);
        PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
        PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
        PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
        PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;

      ELSE

        --SE ACHOU UM CPF/CPNJ PROCURA O REGISTRO PAI
        P_DEFINE_PESSOA_PAI;

        --SE ENCONTROU FAZ OS VINCULOS
        IF VTI_PESSOA_PAI.NRREGISTRO IS NOT NULL THEN

          VTI_PESSOA.NRREGISTRO             := PNRREGISTRO;
          VTI_PESSOA.NOABREVIADO_CLIENTE    := VTI_PESSOA_PAI.NOABREVIADO_CLIENTE;
          VTI_PESSOA.NOABREVIADO_FORNECEDOR := VTI_PESSOA_PAI.NOABREVIADO_FORNECEDOR;
          VTI_PESSOA.CDN_FORNECEDOR         := VTI_PESSOA_PAI.CDN_FORNECEDOR;
          VTI_PESSOA.CDN_CLIENTE            := VTI_PESSOA_PAI.CDN_CLIENTE;
          VTI_PESSOA.NRREGISTRO_PAI         := VTI_PESSOA_PAI.NRREGISTRO;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO    := VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO;
          VTI_PESSOA.NOPESSOA               := PNOPESSOA;
          VTI_PESSOA.DTNASCIMENTO           := PDTNASCIMENTO;
          VTI_PESSOA.NRCGC_CPF              := PNRCGC_CPF;

          INSERT INTO TI_PESSOA
            (NRREGISTRO,
             NOABREVIADO_CLIENTE,
             NOABREVIADO_FORNECEDOR,
             CDN_FORNECEDOR,
             CDN_CLIENTE,
             NRREGISTRO_PAI,
             TXREGRA_AGRUPAMENTO,
             NOPESSOA,
             DTNASCIMENTO,
             NRCGC_CPF,
             DTGERACAO,
             DTULTIMA_ATUALIZACAO)
          VALUES
            (VTI_PESSOA.NRREGISTRO,
             VTI_PESSOA.NOABREVIADO_CLIENTE,
             VTI_PESSOA.NOABREVIADO_FORNECEDOR,
             VTI_PESSOA.CDN_FORNECEDOR,
             VTI_PESSOA.CDN_CLIENTE,
             VTI_PESSOA.NRREGISTRO_PAI,
             VTI_PESSOA.TXREGRA_AGRUPAMENTO,
             VTI_PESSOA.NOPESSOA,
             VTI_PESSOA.DTNASCIMENTO,
             VTI_PESSOA.NRCGC_CPF,
             SYSDATE,
             SYSDATE);
          PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
          PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
          PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
          PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;

          --SE NAO ENCONTROU INSERE PESSOA COM CPF/CNPJ REPETIDO, MAS ALTERANDO O NOME ABREVIADO
        ELSE

          VTI_PESSOA.NRREGISTRO          := PNRREGISTRO;
          VTI_PESSOA.NRREGISTRO_PAI      := NULL;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO := NULL;
          VTI_PESSOA.NOPESSOA            := PNOPESSOA;
          VTI_PESSOA.DTNASCIMENTO        := PDTNASCIMENTO;
          VTI_PESSOA.NRCGC_CPF           := PNRCGC_CPF;

          --VINICIUS 30/08 NOVA DEFINICAO PARA NOME ABREVIADO NO EMS5
          --vnom_abrev := trim(F_ABREVIA_NOME(VTI_PESSOA.NOPESSOA, 12, 'PEA'));

          --ALEX 26/04/2018 - USAR NOME ABREVIADO AO INVEZ DO NOME COMPLETO
          vnom_abrev := trim(F_ABREVIA_NOME(replace(nvl(pNOABREVIADO,VTI_PESSOA.NOPESSOA),'UNIMED','U.'), 12, 'PEA'));

          vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

          WHILE vaoexiste_nome = 'S' LOOP

            vnum_aux := vnum_aux + 1;

            qttamanho := length(vnum_aux);

            vnom_abrev := substr(vnom_abrev, 0, (12 - qttamanho)) ||
                          vnum_aux;

            vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

          END LOOP;

          VTI_PESSOA.NOABREVIADO_CLIENTE := vnom_abrev;

          VTI_PESSOA.NOABREVIADO_FORNECEDOR := vnom_abrev;

          IF PTPORIGEM = 'UNIMED' THEN
            VTI_PESSOA.CDN_FORNECEDOR := NULL;
            VTI_PESSOA.CDN_CLIENTE    := NULL;
          ELSE

            --BUSCAR MAIOR CDN_CLIENTE x CDN_FORNECEDOR no EMS5 E GRAVAR EM VCOD_EMS
            BEGIN
              SELECT MAX(CDN_CLIENTE) + 1 INTO VCOD_EMS_AUX FROM ems5.cliente;
            exception
              when others then
                vcod_ems_aux := 0;
            END;
            if vcod_ems_aux > vcod_ems then
              vcod_ems := vcod_ems_aux;
            end if;

            BEGIN
              SELECT MAX(CDN_fornecedor) + 1 INTO VCOD_EMS_AUX FROM ems5.fornecedor;
            exception
              when others then
                vcod_ems_aux := 0;
            END;
            if vcod_ems_aux > vcod_ems then
              vcod_ems := vcod_ems_aux;
            end if;

            if VCOD_EMS < 1000 then
              VCOD_EMS := 1000;
            end if;

            BEGIN
              SELECT 'S'
                INTO VEXISTE_COD
                FROM TI_PESSOA TP
               WHERE NVL(TP.CDN_CLIENTE, 0) >= VCOD_EMS
                 AND ROWNUM = 1;
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS;
                VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS;
            END;

            IF VEXISTE_COD = 'S' THEN
              BEGIN
                SELECT MAX(CDN_CLIENTE) + 1
                  INTO VCOD_EMS_AUX
                  FROM TI_PESSOA;
              END;
              VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS_AUX;
              VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS_AUX;

            END IF;

          END IF;

          INSERT INTO TI_PESSOA
            (NRREGISTRO,
             NOABREVIADO_CLIENTE,
             NOABREVIADO_FORNECEDOR,
             CDN_FORNECEDOR,
             CDN_CLIENTE,
             NRREGISTRO_PAI,
             TXREGRA_AGRUPAMENTO,
             NOPESSOA,
             DTNASCIMENTO,
             NRCGC_CPF,
             DTGERACAO,
             DTULTIMA_ATUALIZACAO)
          VALUES
            (VTI_PESSOA.NRREGISTRO,
             VTI_PESSOA.NOABREVIADO_CLIENTE,
             VTI_PESSOA.NOABREVIADO_FORNECEDOR,
             VTI_PESSOA.CDN_FORNECEDOR,
             VTI_PESSOA.CDN_CLIENTE,
             VTI_PESSOA.NRREGISTRO_PAI,
             VTI_PESSOA.TXREGRA_AGRUPAMENTO,
             VTI_PESSOA.NOPESSOA,
             VTI_PESSOA.DTNASCIMENTO,
             VTI_PESSOA.NRCGC_CPF,
             SYSDATE,
             SYSDATE);
          PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
          PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
          PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
          PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;

        END IF;

      END IF;
    ELSE
      --NAO FAZ NADA

      NULL;

    END IF;

  END P_DEFINE_TI_PESSOA;

  PROCEDURE P_JOB_FALHA IS
    CURSOR C_FALHA IS
      SELECT MP.CDACAO, FP.*
        FROM TI_MENSAGEM_PROCESSO MP, TI_FALHA_DE_PROCESSO FP
       WHERE FP.CDINTEGRACAO = MP.CDINTEGRACAO
         AND FP.NRMENSAGEM = MP.NRMENSAGEM;
    VSQL LONG;
  BEGIN
    FOR L_FALHA IN C_FALHA LOOP
      IF L_FALHA.CDACAO = 'CA' THEN
        VSQL := 'update ' || L_FALHA.CDINTEGRACAO || ' set ' ||
                ' cdsituacao=' || '''' || 'CA' || '''' ||
                ' where nrseq_controle_integracao=' ||
                L_FALHA.NRSEQ_CONTROLE_INTEGRACAO;
        EXECUTE IMMEDIATE VSQL;
      ELSIF L_FALHA.CDACAO = 'AT' THEN
        VSQL := 'begin pck_ems506unicoo.p_update_controle_integracao(' ||
                L_FALHA.NRSEQ_CONTROLE_INTEGRACAO ||
                ',f_ti_situacao_integracao(' ||
                L_FALHA.NRSEQ_CONTROLE_INTEGRACAO || ',' || '''' ||
                L_FALHA.CDINTEGRACAO || '''' || '),null ); end;';
        --            dbms_output.put_line(vsql);
        EXECUTE IMMEDIATE VSQL;
        BEGIN
          -- nao apagar falhas
          --pck_ems506unicoo.p_apaga_falha(l_falha.nrseq_controle_integracao);
          NULL;
        END;
      END IF;
      PCK_EMS506UNICOO.P_JOB();
    END LOOP;
  END;

  FUNCTION F_PERMITE_CANC_INT_FI_TIT_APB(PCDUNIMED VARCHAR2,
                                         PNRFATURA VARCHAR2) RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
    CURSOR C_TITULO IS
      SELECT *
        FROM AREA_DE_ACAO AA, TITULO_A_PAGAR TP
       WHERE AA.CDPRESTADOR = TP.CDFORNECEDOR
         AND AA.CDAREAACAO = PCDUNIMED
         AND TP.NRDOCUMENTO = PNRFATURA;
    VAOALTERAR VARCHAR2(1);
    VAOCANCELA VARCHAR2(1);
  BEGIN
    VRESULT := 'S';
    FOR L_TITULO IN C_TITULO LOOP
      VAOALTERAR := F_PERMITE_ALTERAR_TIT_APB(L_TITULO.NRDOCUMENTO,
                                              L_TITULO.NRREGISTRO_TITULO);
      IF VAOALTERAR = 'N' THEN
        VRESULT := 'N';
      ELSE
        VAOCANCELA := F_PERMITE_CANCELAR_TI_TIT_APB(L_TITULO.NRDOCUMENTO,
                                                    L_TITULO.NRREGISTRO_TITULO);
        IF VAOCANCELA = 'N' THEN
          VRESULT := 'N';
        END IF;
      END IF;
    END LOOP;
    RETURN VRESULT;
  END;

  PROCEDURE P_UPDATE_CONTROLE_INTEGRACAO(PNRSEQUENCIAL NUMBER,
                                         PCDSITUACAO   VARCHAR2,
                                         PTXOBSERVACAO VARCHAR2) IS
  BEGIN
    UPDATE TI_CONTROLE_INTEGRACAO TI
       SET TI.CDSITUACAO      = PCDSITUACAO,
           TI.TXOBSERVACAO    = PTXOBSERVACAO,
           TI.DTINTEGRACAO    = DECODE(PCDSITUACAO, 'IT', SYSDATE, NULL),
           TI.DTPROCESSAMENTO = SYSDATE
     WHERE TI.NRSEQUENCIAL = PNRSEQUENCIAL;
  END P_UPDATE_CONTROLE_INTEGRACAO;

  PROCEDURE P_AJUSTES IS
    PROCEDURE P_ATUALIZA_NOSSONUMERO IS
      CURSOR C_TITULO IS
        SELECT TI.COD_PARCELA, TA.ROWID, TI.COD_TIT_ACR_BCO
          FROM EMS506UNICOO.TI_TIT_ACR TI, TIT_ACR TA
         WHERE TI.COD_TITULO_ACR = TA.COD_TIT_ACR
           AND TI.COD_SER_DOCTO = TA.COD_SER_DOCTO
           AND TI.COD_ESPEC_DOCTO = TA.COD_ESPEC_DOCTO
           AND TI.COD_PARCELA = TA.COD_PARCELA
           AND TA.COD_TIT_ACR_BCO <> TI.COD_TIT_ACR_BCO
           AND 1 = 2;
    BEGIN
      FOR L_TITULO IN C_TITULO LOOP
        UPDATE TIT_ACR Z
           SET Z.COD_TIT_ACR_BCO    = L_TITULO.COD_TIT_ACR_BCO,
               Z.U##COD_TIT_ACR_BCO = L_TITULO.COD_TIT_ACR_BCO
         WHERE Z.ROWID = L_TITULO.ROWID;
      END LOOP;
    END P_ATUALIZA_NOSSONUMERO;

  BEGIN
    P_ATUALIZA_NOSSONUMERO;
    --          p_atualiza_cliente;
  END P_AJUSTES;

  --=========================--
  -- Grava falha de processo --
  -----------------------------
  PROCEDURE P_APAGA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER) IS
  BEGIN
    DELETE FROM TI_FALHA_DE_PROCESSO
     WHERE NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
  END;

  PROCEDURE P_JOB IS
    VTPINTEGRACAO TI_PARAMETRO_INTEGRACAO.VLPARAMETRO%TYPE;
  BEGIN
    VTPINTEGRACAO := F_TI_PARAMETRO_INTEGRACAO('TP_INTEGRACAO_ONLINE_UNICOO_EMS5');
    IF VTPINTEGRACAO LIKE '%' || 'CL' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'CL');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'FN' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'FN');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'TR' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'TR');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'TP' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'TP');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'FT' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'FT');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'CX' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'CX');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'BP' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'BP');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'BR' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'BR');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'CP' || '%' THEN
      -- cancelamento titulo pagar no ems
      P_MONITOR_INTEGRACAO(0, 'CP');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'BC' || '%' THEN
      -- cdhistorico 78
      P_MONITOR_INTEGRACAO(0, 'BC');
    END IF;
    COMMIT;
  END P_JOB;

  PROCEDURE P_JOB_ERRO IS
  BEGIN
    UPDATE TI_CONTROLE_INTEGRACAO CI
       SET CI.CDSITUACAO = 'GE'
     WHERE CI.CDSITUACAO = 'ER';
    P_COMMIT_NEW;
    PCK_EMS506UNICOO.P_JOB();
  END;

  PROCEDURE P_COMMIT IS
  BEGIN
    IF GCOMMIT >= GCOUNTOFRECORDS THEN
      COMMIT;
      GCOMMIT := 0;
    END IF;
    GCOMMIT := GCOMMIT + 1;
  END;

  PROCEDURE P_COMMIT_NEW IS
  BEGIN
    IF GCOMMIT >= GCOUNTOFRECORDS THEN
      --COMMIT;
      GCOMMIT := 0;
    END IF;
    GCOMMIT := GCOMMIT + 1;
  END;

  PROCEDURE P_REENVIA_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER) IS
  BEGIN
    UPDATE TI_CLIENTE C
       SET CDSITUACAO = 'RC'
     WHERE C.NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
    --       p_apaga_falha(pNRSeq_Controle_integracao);
  END;

  PROCEDURE P_REPROCESSA_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                    P_TPINTEGRACAO             VARCHAR2) IS
    CURSOR C_REPROCESSA IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND CI.CDSITUACAO IN ('PE')
         AND ((CI.TPINTEGRACAO = P_TPINTEGRACAO) OR (P_TPINTEGRACAO = '*'))
       ORDER BY CI.NRSEQUENCIAL;
    V_SEQ_CONTROLE_INTEGRACAO NUMBER(10);
  BEGIN
    FOR L_REPROCESSA IN C_REPROCESSA LOOP
      SELECT SQ_TI_CONTROLE_INTEGRACAO.NEXTVAL
        INTO V_SEQ_CONTROLE_INTEGRACAO
        FROM DUAL;
      INSERT INTO TI_CONTROLE_INTEGRACAO
        (NRSEQUENCIAL,
         TPINTEGRACAO,
         DTGERACAO,
         NRSEQUENCIAL_ORIGEM,
         DTPROCESSAMENTO,
         DTINTEGRACAO,
         CDACAO,
         CDIDENTIFICADOR,
         CDSITUACAO,
         NRSEQ_CONTROLE_INTEGRACAO_ORG,
         CDEMPRESA,
         CDMODULO,
         CDMOVIMENTO,
         CDDIVISAO)
        SELECT V_SEQ_CONTROLE_INTEGRACAO,
               TPINTEGRACAO,
               SYSDATE DTGERACAO,
               NRSEQUENCIAL_ORIGEM,
               NULL,
               DTINTEGRACAO,
               L_REPROCESSA.CDACAO,
               CDIDENTIFICADOR,
               'GE',
               L_REPROCESSA.NRSEQUENCIAL,
               L_REPROCESSA.CDEMPRESA,
               L_REPROCESSA.CDMODULO,
               L_REPROCESSA.CDMOVIMENTO,
               L_REPROCESSA.CDDIVISAO
          FROM TI_CONTROLE_INTEGRACAO CI
         WHERE CI.NRSEQUENCIAL = L_REPROCESSA.NRSEQUENCIAL;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.DTPROCESSAMENTO = SYSDATE, CI.CDSITUACAO = 'RE'
       WHERE CI.NRSEQUENCIAL = L_REPROCESSA.NRSEQUENCIAL;
      IF L_REPROCESSA.TPINTEGRACAO = 'CL' THEN
        UPDATE TI_CLIENTE CL
           SET CL.CDSITUACAO = 'RE' -- REPROCESSA
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'FN' THEN
        UPDATE TI_FORNECEDOR FN
           SET FN.CDSITUACAO = 'RE' -- REPROCESSA
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'TR' THEN
        UPDATE TI_TIT_ACR CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'TP' THEN
        UPDATE TI_TIT_APB CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'CT' THEN
        UPDATE TI_LOTE_CTBL CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'CX' THEN
        UPDATE TI_LOTE_CTBL CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO IN ('FT', 'EM') THEN
        UPDATE TI_TIT_ACR_ESTORNO CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'BP' THEN
        UPDATE TI_CX_BX_APB BP
           SET BP.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'BR' THEN
        UPDATE TI_CX_BX_ACR BR
           SET BR.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      END IF;
    END LOOP;
    P_COMMIT_NEW;
    PCK_EMS506UNICOO.P_JOB();
  END;

  --======================================================--
  -- Define o mdulo origem dos titulos do contas a pagar --
  ----------------------------------------------------------
  PROCEDURE P_DEFINE_MODULO_TIT_APB(PNRSESSAO TI_CONTROLE_INTEGRACAO.NRSESSAO%TYPE) IS
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TP'
         AND CI.CDMODULO IS NULL
         AND CI.NRSESSAO = PNRSESSAO;
    VCDMOVIMENTO  TI_CONTROLE_INTEGRACAO.CDMOVIMENTO%TYPE;
    VCDDIVISAO    TI_CONTROLE_INTEGRACAO.CDDIVISAO%TYPE;
    VCDMODULO     TI_CONTROLE_INTEGRACAO.CDMODULO%TYPE;
    VCDSITUACAO   TI_CONTROLE_INTEGRACAO.CDSITUACAO%TYPE;
    VTXOBSERVACAO TI_CONTROLE_INTEGRACAO.TXOBSERVACAO%TYPE;
    VQTDESPECIE   NUMBER;
  BEGIN
    FOR L_TITULO IN C_TITULO LOOP
      BEGIN
        --===================================--
        -- Titulos de prestadores e Unimeds --
        ---------------------------------------
        -- Alessandro 18/07/2012
        /*select pr.tpprestador
         into vcdmovimento
         from titulo_a_pagar tp,
              prestador pr
        where
              f_ti_parametro_integracao('CLASSIFICA_INTEGRACAO_PAGPREST') = 'PR'
          and pr.cdprestador                                             = tp.cdfornecedor
          and tp.nrregistro_titulo                                       = l_titulo.nrsequencial_origem
          and tp.cdfuncionario                                          <> 'MVINTEGRA';*/
        SELECT PR.TPPRESTADOR
          INTO VCDMOVIMENTO
          FROM TITULO_A_PAGAR TP, PRESTADOR PR
         WHERE F_TI_PARAMETRO_INTEGRACAO('CLASSIFICA_INTEGRACAO_PAGPREST') = 'PR'
           AND PR.CDPRESTADOR = TP.CDFORNECEDOR
           AND TP.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
           AND TP.CDFUNCIONARIO <> 'MVINTEGRA'
              --
              --and tp.tpdocumento <> wtpdoc
           AND TP.NRDOCUMENTO NOT LIKE 'TX%'
              --
           AND NOT EXISTS
         (SELECT 1
                  FROM REM_IMP_CONTROLE_A550 XX
                 WHERE XX.TP_ARQUIVO IN ('4', '6', '8') -- tp_arquivo = 5 -- Receber  -- tp_arquivo = 6 -- Pagar;-- Alessandro 13/05/2014
                   AND XX.NRREGISTRO_TITULO = TP.NRREGISTRO_TITULO);
        -- Alessandro 18/07/2012
        VCDDIVISAO  := NULL;
        VCDMODULO   := 'PR';
        VCDSITUACAO := 'GE';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          --=========================--
          -- Titulos de fornecedores --
          -----------------------------

          IF VVERSAOFINANCEIRO = '1' THEN
            BEGIN
              SELECT CDHISTORICO, HT.CDCENTRO_CUSTO
                INTO VCDMOVIMENTO, VCDDIVISAO
                FROM HISTORICO_DO_TITULO_PAGAR HT
               WHERE HT.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
                 AND HT.CDMOVIMENTO IN ('1', '3');
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VCDMOVIMENTO  := NULL;
                VCDMODULO     := NULL;
                VCDDIVISAO    := NULL;
                VCDSITUACAO   := 'CA';
                VTXOBSERVACAO := 'Nao encontrado movimento 1 ou 3 na tabela historico_do_titulo_pagar ';
            END;
          ELSE
            ----------------------------------------------------
            -- Verificar se o titulo tem somente uma especie.
            -- Josias 05-06-2014 - -João Pessoa
            ----------------------------------------------------
            BEGIN
              SELECT COUNT(*)
                INTO VQTDESPECIE
                FROM (SELECT DISTINCT C.COD_ESPEC_DOCTO
                        FROM TITULO_A_PAGAR            TP,
                             DISTRIBUICAO_TITULO_PAGAR DTP,
                             TI_TIPO_MOVIMENTO_TIT_APB C
                       WHERE TP.NRREGISTRO_TITULO = DTP.NRREGISTRO_TITULO
                         AND C.CDEMPRESA = TP.CDEMPRESA
                         AND C.CDMOVIMENTO =
                             TO_CHAR(NVL(DTP.CDHISTORICO, TP.CDHISTORICO))
                         AND TP.NRREGISTRO_TITULO =
                             L_TITULO.NRSEQUENCIAL_ORIGEM);
              --Quando houver mais de uma especie deverá localizar a distribuicao de maior valor,
              --caso o parametro DEFINE_HISTORICO_PADRAO_APB seja igual a GF, o valor do historico sera
              --substituido pelo exitente no cadastro de grupo de fornecedor (ti_grupo_fornecedor)...
              --Inicio trata espécie duplkicada...
              IF VQTDESPECIE > 1 THEN
                BEGIN
                  VTXOBSERVACAO := 'Titulo rateado pelo critério do maior valor';
                  SELECT CDHISTORICO, CDDIVISAO
                    INTO VCDMOVIMENTO, VCDDIVISAO
                    FROM (SELECT NVL(B.CDHISTORICO, HT.CDHISTORICO) CDHISTORICO,
                                 NVL(B.CDDIVISAO, HT.CDDIVISAO) CDDIVISAO,
                                 NVL(SUM(DECODE(B.TIPO_DISTRIB,
                                                'V',
                                                B.VLDISTRIBUICAO,
                                                -1 * B.VLDISTRIBUICAO)),
                                     0) VALOR
                            FROM TITULO_A_PAGAR            HT,
                                 DISTRIBUICAO_TITULO_PAGAR B
                           WHERE HT.NRREGISTRO_TITULO =
                                 B.NRREGISTRO_TITULO(+)
                             AND HT.NRREGISTRO_TITULO =
                                 L_TITULO.NRSEQUENCIAL_ORIGEM
                           GROUP BY NVL(B.CDHISTORICO, HT.CDHISTORICO),
                                    NVL(B.CDDIVISAO, HT.CDDIVISAO)
                           ORDER BY 3 DESC)
                   WHERE ROWNUM = 1;
                  IF F_TI_PARAMETRO_INTEGRACAO('DEFINE_HISTORICO_PADRAO_APB') = 'GF' THEN
                    BEGIN
                      VTXOBSERVACAO := 'Titulo rateado pelo critério do Grupo do Fornecedor';
                      SELECT GF.CD_HISTORICO_PADRAO
                        INTO VCDMOVIMENTO
                        FROM TITULO_A_PAGAR                      TP,
                             PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FN,
                             TI_GRUPO_DE_FORNECEDOR              GF
                       WHERE GF.CDGRUPO_FORNECEDOR = FN.CDGRUPO_FORNECEDOR
                         AND TP.CDFORNECEDOR = TP.CDFORNECEDOR
                         AND TP.NRREGISTRO_TITULO =
                             L_TITULO.NRSEQUENCIAL_ORIGEM
                         AND GF.CD_HISTORICO_PADRAO IS NOT NULL;
                    EXCEPTION
                      WHEN NO_DATA_FOUND THEN
                        VCDMOVIMENTO  := NULL;
                        VCDMODULO     := NULL;
                        VCDDIVISAO    := NULL;
                        VCDSITUACAO   := 'ER';
                        VTXOBSERVACAO := 'Histórico não cadastrado no Grupo de Fornecedor';
                        P_GRAVA_FALHA(L_TITULO.NRSEQUENCIAL,
                                      'TP',
                                      VTXOBSERVACAO,
                                      NULL,
                                      VCDSITUACAO,
                                      NULL);
                    END;
                  END IF;
                EXCEPTION
                  WHEN NO_DATA_FOUND THEN
                    VCDMOVIMENTO  := NULL;
                    VCDMODULO     := NULL;
                    VCDDIVISAO    := NULL;
                    VCDSITUACAO   := 'ER';
                    VTXOBSERVACAO := 'Não encontrado titulo de origem ';
                    P_GRAVA_FALHA(L_TITULO.NRSEQUENCIAL,
                                  'TP',
                                  VTXOBSERVACAO,
                                  NULL,
                                  VCDSITUACAO,
                                  NULL);
                END;
                --Fim trata espécie duplkicada...
              ELSE
                BEGIN
                  SELECT MIN(CDHISTORICO), MIN(CDDIVISAO)
                    INTO VCDMOVIMENTO, VCDDIVISAO
                    FROM (SELECT DISTINCT NVL(B.CDHISTORICO, HT.CDHISTORICO) CDHISTORICO,
                                          NVL(B.CDDIVISAO, HT.CDDIVISAO) CDDIVISAO
                            FROM TITULO_A_PAGAR            HT,
                                 DISTRIBUICAO_TITULO_PAGAR B
                           WHERE HT.NRREGISTRO_TITULO =
                                 B.NRREGISTRO_TITULO(+)
                             AND HT.NRREGISTRO_TITULO =
                                 L_TITULO.NRSEQUENCIAL_ORIGEM);
                EXCEPTION
                  WHEN NO_DATA_FOUND THEN
                    VCDMOVIMENTO  := NULL;
                    VCDMODULO     := NULL;
                    VCDDIVISAO    := NULL;
                    VCDSITUACAO   := 'ER';
                    VTXOBSERVACAO := 'Não encontrado titulo de origem ';
                    P_GRAVA_FALHA(L_TITULO.NRSEQUENCIAL,
                                  'TP',
                                  VTXOBSERVACAO,
                                  NULL,
                                  VCDSITUACAO,
                                  NULL);
                END;
              END IF;
            END;
          END IF;
          IF NVL(VCDSITUACAO, 'x') <> 'ER' THEN
            VCDMODULO   := 'CP';
            VCDSITUACAO := 'GE';
            --====================--
            -- Classifica imposto --
            ------------------------
            BEGIN
              SELECT PR.TPPRESTADOR
                INTO VCDMOVIMENTO
                FROM TAXA_TITULO_INTEGRACAO TTI,
                     TITULO_A_PAGAR         TP,
                     PRESTADOR              PR
               WHERE PR.CDPRESTADOR = TTI.CDFORNECEDOR
                 AND TP.NRREGISTRO_TITULO = TTI.NRREGISTRO_TITULO_TAXA
                 AND TP.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
                    --
                 AND NOT EXISTS
               (SELECT 1
                        FROM TAXA_TITULO_INTEGRACAO T
                       WHERE T.NRREGISTRO_TITULO_TAXA = TP.NRREGISTRO_TITULO);
              VCDMODULO  := F_TI_PARAMETRO_INTEGRACAO('CLASSIFICA_IMPOSTO_INTEGRACAO_PAGPREST');
              VCDDIVISAO := NULL;
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                NULL;
            END;
          END IF;
      END;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDMODULO     = VCDMODULO,
             CI.CDMOVIMENTO  = VCDMOVIMENTO,
             CI.CDSITUACAO   = VCDSITUACAO,
             CI.CDDIVISAO    = VCDDIVISAO,
             CI.TXOBSERVACAO = VTXOBSERVACAO
       WHERE CI.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
      P_COMMIT_NEW;
    END LOOP;
  END;

  --========================================================--
  -- Define o mdulo origem dos titulos do contas a receber --
  ------------------------------------------------------------
  PROCEDURE P_DEFINE_MODULO_TIT_ACR(PNRSESSAO TI_CONTROLE_INTEGRACAO.NRSESSAO%TYPE) IS
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TR'
         AND CI.CDMODULO IS NULL
         AND CI.NRSESSAO = PNRSESSAO;
    VCDMOVIMENTO TI_CONTROLE_INTEGRACAO.CDMOVIMENTO%TYPE;
    VCDMODULO    TI_CONTROLE_INTEGRACAO.CDMODULO%TYPE;
    VCDSITUACAO  TI_CONTROLE_INTEGRACAO.CDSITUACAO%TYPE;
  BEGIN
    FOR L_TITULO IN C_TITULO LOOP
      BEGIN
        --====================--
        -- Titulos de faturas --
        ------------------------
        SELECT SUBSTR(FT.NRFATURA, 1, INSTR(FT.NRFATURA, '-') - 1)
          INTO VCDMOVIMENTO
          FROM FATURAMENTO FT
         WHERE FT.NRFATURA = L_TITULO.CDIDENTIFICADOR;
        VCDMODULO   := 'FT';
        VCDSITUACAO := 'GE';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          BEGIN
            --===============================--
            -- Titulos de faturas parceladas --
            -----------------------------------
            SELECT SUBSTR(DF.NRFATURA, 1, INSTR(DF.NRFATURA, '-') - 1)
              INTO VCDMOVIMENTO
              FROM DUPLICATA_FATURAMENTO DF
             WHERE DF.NRDUPLICATA = L_TITULO.CDIDENTIFICADOR;
            VCDMODULO   := 'FT';
            VCDSITUACAO := 'GE';
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                --===============================================--
                -- Titulos que no possuem origem no faturamento --
                ---------------------------------------------------
                SELECT NVL(HT.CDHISTORICO, TR.CDHISTORICO)
                  INTO VCDMOVIMENTO
                  FROM HISTORICO_DO_TITULO HT, TITULO_A_RECEBER TR
                 WHERE HT.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
                   AND HT.NRREGISTRO_TITULO = TR.NRREGISTRO_TITULO
                   AND
                      --ht.cdmovimento='1';-- Alessandro 21/10/2014
                       HT.CDMOVIMENTO IN ('1', '3'); -- Alessandro 21/10/2014
                VCDMODULO   := 'CR';
                VCDSITUACAO := 'GE';
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VCDMOVIMENTO := NULL;
                  VCDMODULO    := NULL;
                  VCDSITUACAO  := 'CA';
                  -- gravar falha
                WHEN OTHERS THEN
                  VCDMOVIMENTO := NULL;
                  VCDMODULO    := NULL;
                  VCDSITUACAO  := 'CA';
                  -- gravar falha
              END;
          END;
      END;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDMODULO    = VCDMODULO,
             CI.CDMOVIMENTO = VCDMOVIMENTO,
             CI.CDSITUACAO  = VCDSITUACAO
       WHERE CI.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
    END LOOP;
  END;

  PROCEDURE P_MONITOR_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PTPINTEGRACAO              VARCHAR DEFAULT '*') IS
    CURSOR C_PROCESSA(PNRSESSAO NUMBER, PTPINTEGRACAO VARCHAR2) IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.CDSITUACAO = 'VD'
         AND CI.TPINTEGRACAO NOT IN ('MV', 'FE')
         AND CI.TPINTEGRACAO = PTPINTEGRACAO
       ORDER BY CI.NRSEQUENCIAL;
    VCDSITUACAO VARCHAR2(2);
    /*-------------------------------
    GE --> PI --> PR  // Prepara
    PR --> VI --> VD  // Valida
    VD --> OK         // Processa
    Gerao --> Preparao Inicio --> Preparado
    Preparado --> Validao Inicial --> Validado
    Validado --> OK
    -------------------------------*/
    VNRSESSAO     NUMBER(10);
    VTPINTEGRACAO VARCHAR2(2);
  BEGIN
    WHILE TRUE LOOP
      SELECT SQ_TI_SESSAO.NEXTVAL INTO VNRSESSAO FROM DUAL;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.NRSESSAO = VNRSESSAO
       WHERE (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = CI.TPINTEGRACAO)
         AND CI.CDSITUACAO = 'GE'
         AND ROWNUM <= GSESSAO_MOVIMENTO;
      IF SQL%ROWCOUNT = 0 THEN
        EXIT;
      ELSE
        ----------------------------------------------------------
        P_VALIDA_CONTROLE_INTEGRACAO(PTPINTEGRACAO, VNRSESSAO);
        ----------------------------------------------------------
        IF PTPINTEGRACAO = 'TP' THEN
          P_DEFINE_MODULO_TIT_APB(VNRSESSAO);
        ELSIF PTPINTEGRACAO = 'TR' THEN
          P_DEFINE_MODULO_TIT_ACR(VNRSESSAO);
        END IF;
        --====================--
        -- Prepara Integrao --
        ------------------------
        VCDSITUACAO := 'VD';
        UPDATE TI_CONTROLE_INTEGRACAO CI
           SET CI.CDSITUACAO = VCDSITUACAO
         WHERE CI.NRSESSAO = VNRSESSAO
           AND CI.CDSITUACAO = 'GE'
           AND CI.TPINTEGRACAO NOT IN ('MV', 'FE');
        --=====================--
        -- Processa Integrao --
        -------------------------
        VTPINTEGRACAO := PTPINTEGRACAO;
        FOR L_PROCESSA IN C_PROCESSA(VNRSESSAO, VTPINTEGRACAO) LOOP
          VCDSITUACAO := 'VD';

          P_TI_PROCESSA_INTEGRACAO(L_PROCESSA.TPINTEGRACAO,
                                   L_PROCESSA.NRSEQUENCIAL,
                                   VNRSESSAO,
                                   L_PROCESSA.CDIDENTIFICADOR,
                                   VCDSITUACAO);
        END LOOP;
        P_COMMIT_NEW;
      END IF;
    END LOOP;
    --COMMIT;
  END P_MONITOR_INTEGRACAO;

  PROCEDURE P_VALIDA_CONTROLE_INTEGRACAO(PTPINTEGRACAO VARCHAR2,
                                         PNRSESSAO     NUMBER) IS
  BEGIN
    P_AJUSTES;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'FT') THEN
      --=============================================--
      -- Cancela integrao de fornecedores diversos --
      -------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'FATURA REATIVADA NO UNICOO'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND EXISTS (SELECT 1
                FROM FATURAMENTO FT
               WHERE FT.NRFATURA = CI.CDIDENTIFICADOR
                 AND FT.DTCANCELAMENTO IS NULL);
      --=============================================--
      -- Cancela integrao de fornecedores diversos --
      -------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'FATURA JA CANCELADA NO EMS5'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND EXISTS (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS, TIT_ACR TTA
               WHERE TTA.U##COD_ESTAB = EMS.COD_ESTAB
                 AND TTA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
                 AND TTA.LOG_TIT_ACR_ESTORDO = 1
                 AND EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR)
         AND NOT EXISTS
       (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS, TIT_ACR TTA
               WHERE TTA.U##COD_ESTAB = EMS.COD_ESTAB
                 AND TTA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
                 AND TTA.LOG_TIT_ACR_ESTORDO = 0
                 AND EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR);
      --=============================================--
      -- Cancela integrao de fornecedores diversos CASO NAO ENCONTRE TITULO NO EMS--
      -------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'FATURA JA CANCELADA OU NAO INTEGRADA NO EMS5'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND NOT EXISTS
       (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS, TIT_ACR TTA
               WHERE TTA.U##COD_ESTAB = EMS.COD_ESTAB
                 AND TTA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
                 AND TTA.LOG_TIT_ACR_ESTORDO = 0
                 AND EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR);
      -- Alessandro 19/03/2012
      --=============================================--
      -- Fatura Integrada com EMS5 e nao Contabilizada
      ------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'ER',
             CI.TXOBSERVACAO = 'FATURA INTEGRADA EMS5 e Nao Contabilizada'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO --386511633--
         AND EXISTS
       (SELECT 1
                FROM TI_CONTROLE_INTEGRACAO CI1,
                     TI_TIT_ACR_ESTORNO     T,
                     TIT_ACR                TA,
                     MOVTO_TIT_ACR          MT
               WHERE MT.U##COD_ESTAB = TA.U##COD_ESTAB
                 AND MT.NUM_ID_TIT_ACR = TA.NUM_ID_TIT_ACR
                 AND MT.IND_TRANS_ACR_ABREV = 'IMPL'
                 AND TA.NUM_ID_TIT_ACR = T.NUM_ID_TIT_ACR
                 AND CI1.NRSEQUENCIAL = T.NRSEQ_CONTROLE_INTEGRACAO
                 AND MT.LOG_APROP_CTBL_CTBZDA = 0
                 AND CI1.NRSEQUENCIAL = CI.NRSEQUENCIAL);
      -- Alessandro 19/03/2012
    END IF;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'TP') THEN
      -- cancela os titulos do contas a pagar que sao de impostos, pois nao devem ser integrados
      -----------------------------------------------
      CANCELA_CONTROLE_TIT_IMPOSTOS(PNRSESSAO);
      -----------------------------------------------
      IF F_TI_PARAMETRO_INTEGRACAO('INTEGRA_SOMENTE_TITULOS_PRESTADORES') = 'S' THEN
        --=============================================--
        -- Cancela integrao de fornecedores diversos --
        -------------------------------------------------
        UPDATE TI_CONTROLE_INTEGRACAO CI
           SET CI.CDSITUACAO   = 'CA',
               CI.TXOBSERVACAO = 'A integração do unicoo com o ems5 integra apenas titulos de prestadores'
         WHERE CI.TPINTEGRACAO = 'TP'
           AND CI.CDSITUACAO = 'GE'
           AND CI.NRSESSAO = PNRSESSAO
           AND NOT EXISTS
         (SELECT 1
                  FROM TITULO_A_PAGAR                      TP,
                       PRESTADOR                           PR,
                       PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FN
                 WHERE FN.CDFORNECEDOR = PR.CDPRESTADOR
                   AND FN.CDFORNECEDOR = TP.CDFORNECEDOR
                   AND CI.NRSEQUENCIAL_ORIGEM = TP.NRREGISTRO_TITULO)
              -- Titulo no  de imposto de prestador com saldo negativo
           AND NOT EXISTS
         (SELECT 1
                  FROM TITULO_A_PAGAR TP --taxa_titulo_integracao tti,
                 WHERE CI.NRSEQUENCIAL_ORIGEM = TP.NRREGISTRO_TITULO);
      END IF;
    END IF;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'TR') THEN
      IF F_TI_PARAMETRO_INTEGRACAO('INTEGRA_SOMENTE_TITULOS_FATURAMENTO') = 'S' THEN
        --=====================================--
        -- Cancela a integrao de titulos que --
        -- no possuem origem no faturamento   --
        -----------------------------------------
        UPDATE TI_CONTROLE_INTEGRACAO CI
           SET CI.CDSITUACAO   = 'CA',
               CI.TXOBSERVACAO = 'TITULO NO POSSUI ORIGEM NO FATURAMENTO'
         WHERE CI.TPINTEGRACAO = 'TR'
           AND CI.CDSITUACAO = 'GE'
           AND CI.NRSESSAO = PNRSESSAO
           AND NOT EXISTS (SELECT 1
                  FROM FATURAMENTO FT
                 WHERE FT.NRFATURA = CI.CDIDENTIFICADOR)
           AND NOT EXISTS
         (SELECT 1
                  FROM DUPLICATA_FATURAMENTO DF
                 WHERE DF.NRDUPLICATA = CI.CDIDENTIFICADOR);
      END IF;
    END IF;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'FT') THEN
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'TITULO CANC NO FATURAMENTO E NAO EXISTE NO EMS/RECEBER UNICOO'
       WHERE CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'FT'
         AND NOT EXISTS
       (SELECT 1
                FROM TI_TIT_ACR_ESTORNO TAC
               WHERE TAC.NRSEQ_CONTROLE_INTEGRACAO = CI.NRSEQUENCIAL)
         AND NOT EXISTS (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS
               WHERE EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR)
         AND NOT EXISTS
       (SELECT 1
                FROM TITULO_A_RECEBER TR
               WHERE TR.NRDOCUMENTO = CI.CDIDENTIFICADOR);
    END IF;
  END P_VALIDA_CONTROLE_INTEGRACAO;

  --=========================--
  -- Grava falha de processo --
  -----------------------------
  PROCEDURE P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                          PCDINTEGRACAO              VARCHAR2,
                          PTXFALHA                   VARCHAR2,
                          PTXAJUDA                   VARCHAR2,
                          PCDSITUACAO                IN OUT VARCHAR2,
                          PNRMENSAGEM                NUMBER DEFAULT NULL) IS
  BEGIN
    PCDSITUACAO := 'ER';
    BEGIN
      INSERT INTO TI_FALHA_DE_PROCESSO
        (NRSEQUENCIAL,
         NRSEQ_CONTROLE_INTEGRACAO,
         CDINTEGRACAO,
         TXFALHA,
         TXAJUDA,
         DTFALHA,
         NRMENSAGEM)
      VALUES
        (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
         PNRSEQ_CONTROLE_INTEGRACAO,
         PCDINTEGRACAO,
         PTXFALHA,
         PTXAJUDA,
         SYSDATE,
         PNRMENSAGEM);
    EXCEPTION
      WHEN OTHERS THEN
        RAISE_APPLICATION_ERROR(-20001,
                                PNRSEQ_CONTROLE_INTEGRACAO || PCDINTEGRACAO ||
                                PTXFALHA || PTXAJUDA);
    END;
    P_UPDATE_CONTROLE_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO,
                                 PCDSITUACAO,
                                 NULL);
  END;

  PROCEDURE P_TIT_PAGAR_CANCELADO_EMS(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER) IS
    TTI_TIT_APB             TI_TIT_APB%ROWTYPE;
    TTI_CONTROLE_INTEGRACAO TI_CONTROLE_INTEGRACAO%ROWTYPE;
    TTIT_AP                 TIT_AP%ROWTYPE;
    TFORNECEDOR_EMS         FORNECEDOR%ROWTYPE;
    TTIT_CANCDO_APB         TIT_CANCDO_APB%ROWTYPE;
    VSIT                    VARCHAR2(2);
    -- procedure para inserir historico de cancelamento no unicoo
    PROCEDURE INSERE_HISTORICO_80(PNRREGISTRO_TITULO IN NUMBER) IS
      THISTORICO_DO_TITULO_PAGAR HISTORICO_DO_TITULO_PAGAR%ROWTYPE;
    BEGIN
      SELECT *
        INTO THISTORICO_DO_TITULO_PAGAR
        FROM HISTORICO_DO_TITULO_PAGAR
       WHERE NRREGISTRO_TITULO = PNRREGISTRO_TITULO;
      SELECT PRODUCAO.SEQ_NRMOVHIST_PAGAR.NEXTVAL@UNICOO_HOMOLOGA
        INTO THISTORICO_DO_TITULO_PAGAR.NRMOVIMENTO
        FROM DUAL;
      THISTORICO_DO_TITULO_PAGAR.CDMOVIMENTO   := '80';
      THISTORICO_DO_TITULO_PAGAR.CDFUNCIONARIO := 'CANCEMS';
      THISTORICO_DO_TITULO_PAGAR.DTMOVIMENTO   := SYSDATE;
      INSERT INTO HISTORICO_DO_TITULO_PAGAR
      VALUES THISTORICO_DO_TITULO_PAGAR;
    END;

  BEGIN
    -- busca o controle
    SELECT *
      INTO TTI_CONTROLE_INTEGRACAO
      FROM TI_CONTROLE_INTEGRACAO
     WHERE TPINTEGRACAO = 'CP'
       AND NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO;
    -- busca o cancelamento do titulo
    SELECT *
      INTO TTIT_CANCDO_APB
      FROM TIT_CANCDO_APB
     WHERE NUM_ID_TIT_AP = TTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM;
    -- busca o fornecedor do ems
    SELECT EFN.*
      INTO TFORNECEDOR_EMS
      FROM FORNECEDOR EFN, TI_EMPRESA EMP
     WHERE EFN.CDN_FORNECEDOR = TTIT_CANCDO_APB.CDN_FORNECEDOR
       AND EFN.COD_EMPRESA = EMP.COD_EMPRESA
       AND EMP.CDEMPRESA = F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
    SELECT *
      INTO TTI_TIT_APB
      FROM TI_TIT_APB M
     WHERE M.COD_TITULO_AP = TTIT_CANCDO_APB.COD_TIT_AP
       AND M.COD_ID_FEDER = TFORNECEDOR_EMS.COD_ID_FEDER
       AND M.CDSITUACAO = 'IT';
    INSERE_HISTORICO_80(TTI_TIT_APB.NRREGISTRO_TITULO);
    UPDATE TI_CONTROLE_INTEGRACAO
       SET CDSITUACAO = 'IT'
     WHERE NRSEQUENCIAL = TTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL;
  EXCEPTION
    WHEN OTHERS THEN
      P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                    'CP',
                    'Erro ao cancelar o titulo no unicoo',
                    SQLERRM,
                    VSIT);
  END;

  --========================--
  -- Controle de integrao --
  ----------------------------
  PROCEDURE P_TI_PROCESSA_INTEGRACAO(PTPINTEGRACAO    VARCHAR2,
                                     PNRSEQUENCIAL    NUMBER,
                                     PNRSESSAO        NUMBER,
                                     PCDIDENTIFICADOR VARCHAR2,
                                     PCDSITUACAO      IN OUT VARCHAR2) IS
  BEGIN
    IF PTPINTEGRACAO = 'TP' THEN
      --================--
      -- Titulo a pagar --
      --------------------
      P_TI_TIT_APB(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'CL' THEN
      --============--
      -- Cliente --
      ----------------
      P_TI_CLIENTE(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'FN' THEN
      --============--
      -- Fornecedor --
      ----------------
      P_TI_FORNECEDOR(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'TR' THEN
      --==================--
      -- Titulo a receber --
      ----------------------
      P_TI_TIT_ACR(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'FT' THEN
      --=============================--
      -- Cancelamento do faturamento --
      ---------------------------------
      P_TI_TIT_ACR_ESTORNO(PNRSEQUENCIAL,
                           PCDIDENTIFICADOR,
                           PCDSITUACAO,
                           PNRSESSAO);
    ELSIF PTPINTEGRACAO = 'CX' THEN
      --=============================--
      -- Caixa e Bancos              --
      ---------------------------------
      P_TI_MOVIMENTO_CTA_CORRENTE(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'CP' THEN
      --=============================--
      -- Titulo Cancelado no EMS     --
      ---------------------------------
      P_TIT_PAGAR_CANCELADO_EMS(PNRSEQUENCIAL);
    ELSIF PTPINTEGRACAO = 'BP' THEN
      EMS506UNICOO.PCK_BX_TIT_EMS.P_PROCESSA_APB(PNRSEQUENCIAL,
                                                 PNRSESSAO,
                                                 PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'BR' THEN
      EMS506UNICOO.PCK_BX_TIT_EMS.P_PROCESSA_ACR(PNRSEQUENCIAL,
                                                 PNRSESSAO,
                                                 PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'BC' THEN
      EMS506UNICOO.PCK_BX78_TIT_EMS.P_PROCESSA_ACR78(PNRSEQUENCIAL,
                                                     PNRSESSAO,
                                                     PCDSITUACAO);
    END IF;
  END P_TI_PROCESSA_INTEGRACAO;

  PROCEDURE P_TI_VALIDA_ENDERECO(PNRREGISTRO                IN NUMBER,
                                 PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                                 PCDINTEGRACAO              IN VARCHAR2,
                                 PCDSITUACAO                IN OUT VARCHAR2) IS
    VCDCIDADE ENDERECO.CDCIDADE%TYPE;
  BEGIN
    BEGIN
      ---------------------
      -- Verifica Endereco --
      ---------------------
      BEGIN
        SELECT CDCIDADE
          INTO VCDCIDADE
          FROM ENDERECO ED
         WHERE ED.NRREGISTRO = PNRREGISTRO
           AND ED.TPENDERECO = F_TI_TIP_ENDERECO(PNRREGISTRO);
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          -- Josias 03-07-2014
          --- pegar como default a cidade do endereço defaul
          SELECT CDCIDADE
            INTO VCDCIDADE
            FROM ENDERECO ED
           WHERE ED.NRREGISTRO = 10405
                --    F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO') VINICIUS NOVA IGUAÇU
             AND TPENDERECO = 'COBR';
          --  F_TI_TIP_ENDERECO(F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO'));
      END;
      BEGIN
        ---------------------
        -- Verifica Cidade --
        ---------------------
        SELECT CDCIDADE
          INTO VCDCIDADE
          FROM ENDERECO ED
         WHERE ED.NRREGISTRO = 10405
              -- F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO') VINICIUS NOVA IGUAÇU
           AND TPENDERECO = 'COBR';
        --  F_TI_TIP_ENDERECO(F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO'));
        SELECT CDCIDADE
          INTO VCDCIDADE
          FROM PRODUCAO.CIDADE@UNICOO_HOMOLOGA
         WHERE CDCIDADE = VCDCIDADE;
        PCDSITUACAO := 'RC';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        PCDINTEGRACAO,
                        'Cidade não cadastrada',
                        'Pessoa ==> ' || PNRREGISTRO || ' A Cidade ==> ' ||
                        VCDCIDADE || ' Não existe',
                        PCDSITUACAO,
                        NULL);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        PCDINTEGRACAO,
                        'Cidade no cadastrada',
                        'Pessoa ==> ' || PNRREGISTRO ||
                        ' Erro ao pesquisar cidade ' || SQLERRM,
                        PCDSITUACAO,
                        NULL);
      END;
    EXCEPTION
      /*
      when no_data_found then


                    p_grava_falha(pnrseq_controle_integracao,
                                  pCDIntegracao,
                                  'Endereo no cadastrado',
                                  'Pessoa ==> '||pnrregistro,
                                  pCDSituacao,
                                  null);
       */
      WHEN OTHERS THEN
        P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                      PCDINTEGRACAO,
                      'Erro ao validar o endereo',
                      'Erro ao pesquisar endereco ' || SQLERRM,
                      PCDSITUACAO,
                      NULL);
    END;
  END;

  --==================================--
  -- Grava Fornecedor - TI_FORNECEDOR --
  --------------------------------------
  PROCEDURE P_TI_FORNECEDOR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                            PNRSESSAO                  NUMBER,
                            PCDSITUACAO                IN OUT VARCHAR2) IS

    --VARIAVEIS PARA TRATAR E REDUZ O ENDERECO
    VQTLOGRA             NUMBER;
    VQTCOMPL             NUMBER;
    VQTLOGRA_REDUZ       NUMBER;
    VQTCOMPL_REDUZ       NUMBER;
    VQTLOGRA_REDUZ_ABREV NUMBER;
    VQTNRIMOVEL          NUMBER;
    VLOGRA               VARCHAR2(50);
    VCOMPL               VARCHAR2(15);
    VLOGRA_REDUZ         VARCHAR2(50);
    VCOMPL_REDUZ         VARCHAR2(15);
    VLOGRA_REDUZ_ABREV   VARCHAR2(50);

    --VLOGRADOURO E VCOMPLEMENTO RECEBERAO OS CONTEUDOS DO ENDERECO E COMPLEMENTO APOS ANALISE DE TAMANHOS
    VLOGRADOURO  VARCHAR2(40);
    VCOMPLEMENTO VARCHAR2(10);
    VBAIRRO      VARCHAR2(25);

    --VARIAVIES QUE CONTROLAM O NUMERO MAXIMO DE REGISTROS NOS CAMPOS DE ENDERECO
    VQTLOGRADOURO  NUMBER := 40;
    VQTCOMPLEMENTO NUMBER := 10;

    CURSOR C_INTEGRA_CLIFOR IS
      SELECT CI.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
             CI.CDSITUACAO,
             CI.CDIDENTIFICADOR,
             CI.CDACAO,
             CI.NRSEQUENCIAL_ORIGEM
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'FN'
         AND CI.CDSITUACAO = PCDSITUACAO
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0);
    TTI_CONTROLE_INTEGRACAO TI_CONTROLE_INTEGRACAO%ROWTYPE;
    TFORNECEDOR             PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA%ROWTYPE;
    TGRUPO_DE_FORNECEDOR    GRUPO_DE_FORNECEDOR%ROWTYPE;
    TPESSOA                 PESSOA%ROWTYPE;
    TESTADO_CIVIL           ESTADO_CIVIL%ROWTYPE;
    TENDERECO               ENDERECO%ROWTYPE;
    TCIDADE                 PRODUCAO.CIDADE@UNICOO_HOMOLOGA%ROWTYPE;
    TTI_PESSOA              TI_PESSOA%ROWTYPE;
    TTI_GRUPO_DE_FORNECEDOR TI_GRUPO_DE_FORNECEDOR%ROWTYPE;
    TCDN_FORNECEDOR         TI_PESSOA.CDN_FORNECEDOR%TYPE;
    pSEPARADOR_ENDERECO_NUMERO VARCHAR2(5);
  BEGIN

    pSEPARADOR_ENDERECO_NUMERO := f_ti_parametro_integracao('SEPARADOR_ENDERECO_NUMERO');

    FOR L_INTEGRA_CLIFOR IN C_INTEGRA_CLIFOR LOOP
      BEGIN
        PCDSITUACAO := 'RC';
        BEGIN
          SELECT *
            INTO TFORNECEDOR
            FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA
           WHERE CDFORNECEDOR = L_INTEGRA_CLIFOR.CDIDENTIFICADOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20100,
                                    'Forn. no unicoo nao encontrado: ' ||
                                    L_INTEGRA_CLIFOR.CDIDENTIFICADOR);
        END;
        BEGIN
          -----------------------------------------------------------------------
          -- Josias 01-07-2014 - Alteração para pegar o codigo do fornecedor do EMS
          -- que esta gravado na ti_pessoa e nao mais no fornecedor
          -----------------------------------------------------------------------
          SELECT P.CDN_FORNECEDOR
            INTO TCDN_FORNECEDOR
            FROM TI_PESSOA P
           WHERE P.NRREGISTRO = TFORNECEDOR.NRREGISTRO_FORNECEDOR;
        EXCEPTION
          WHEN OTHERS THEN
            RAISE_APPLICATION_ERROR(-20100,
                                    'Erro -> pessoa nao cadastrada para fornecedor na TI_PESSOA ' ||
                                    TFORNECEDOR.CDFORNECEDOR);
        END;
        BEGIN
          SELECT *
            INTO TGRUPO_DE_FORNECEDOR
            FROM GRUPO_DE_FORNECEDOR
           WHERE CDGRUPO_FORNECEDOR = TFORNECEDOR.CDGRUPO_FORNECEDOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20101,
                                    'Grupo do Forn. no unicoo nao encontrado: ' ||
                                    TFORNECEDOR.CDGRUPO_FORNECEDOR);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TPESSOA
            FROM PESSOA
           WHERE NRREGISTRO = TFORNECEDOR.NRREGISTRO_FORNECEDOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20102,
                                    'Cadastro de Pessoa do fornecor nao encontrado: ' ||
                                    L_INTEGRA_CLIFOR.CDIDENTIFICADOR);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TESTADO_CIVIL
            FROM ESTADO_CIVIL
           WHERE CDESTADOCIVIL = TPESSOA.CDESTADOCIVIL;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TENDERECO
            FROM ENDERECO
           WHERE NRREGISTRO = TPESSOA.NRREGISTRO
             AND TPENDERECO = F_TI_TIP_ENDERECO(TPESSOA.NRREGISTRO);
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            -- josias 29-06-2014
            -- coloquei para pegar o endereço da unimed como default
            --SELECT *
            --  INTO TENDERECO
            --  FROM ENDERECO
            -- WHERE NRREGISTRO = 9999999999
            --      F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO') VINICIUS NOVA IGUAÇU
            --  AND TPENDERECO = 'COBR';
            --     F_TI_TIP_ENDERECO(F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO'));
            --          raise_application_error(-20103,'Fornecedor sem endereco: '||l_integra_clifor.cdidentificador);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TCIDADE
            FROM PRODUCAO.CIDADE@UNICOO_HOMOLOGA
           WHERE CDCIDADE = TENDERECO.CDCIDADE;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            -- Josias 01-07-2014 - retirado esse erro, pois foi criado parametro para
            -- preenher o nome da cidades.
            --raise_application_error(-20104,'Cidade do fornecedor invalido: '||l_integra_clifor.cdidentificador);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TTI_GRUPO_DE_FORNECEDOR
            FROM TI_GRUPO_DE_FORNECEDOR
           WHERE CDGRUPO_FORNECEDOR =
                 TGRUPO_DE_FORNECEDOR.CDGRUPO_FORNECEDOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20104,
                                    'Grupo de fornecedor invalido: ' ||
                                    TGRUPO_DE_FORNECEDOR.CDGRUPO_FORNECEDOR);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TTI_PESSOA
            FROM TI_PESSOA
           WHERE NRREGISTRO = TPESSOA.NRREGISTRO;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20104,
                                    'Pessoa de integracao nao encontrado: ' ||
                                    TPESSOA.NRREGISTRO);
            NULL;
        END;
        begin
          select distinct 1
            into vlmatriz
            from ti_matriz_pagar v
           where v.nrregistro = tfornecedor.nrregistro_fornecedor;
        exception
          when no_data_found then
            vlmatriz := 0;
        end;

        --QTDE E CONTEUDOS DO ENDERECO
        VQTLOGRA             := LENGTH(TRIM(tendereco.nologradouro));
        VQTCOMPL             := LENGTH(TRIM(tendereco.txcomplemento));
        VQTLOGRA_REDUZ       := LENGTH(TRIM(F_REDUZ_END(tendereco.nologradouro,0)));
        VQTCOMPL_REDUZ       := LENGTH(TRIM(F_REDUZ_COMPL(tendereco.txcomplemento,0)));
        VQTLOGRA_REDUZ_ABREV := LENGTH(TRIM(F_REDUZ_END_ABREV(F_REDUZ_END(tendereco.nologradouro,0),0)));
        VQTNRIMOVEL          := LENGTH(tendereco.nrimovel) + length(nvl(pSEPARADOR_ENDERECO_NUMERO,', ')); /*tamanho do separador, que pode ser (,) (, ) etc*/
        VLOGRA               := TRIM(tendereco.nologradouro);
        VCOMPL               := NVL(TRIM(tendereco.txcomplemento), ' ');
        VLOGRA_REDUZ         := TRIM(F_REDUZ_END(tendereco.nologradouro, 0));
        VCOMPL_REDUZ         := TRIM(F_REDUZ_COMPL(tendereco.txcomplemento,
                                                   0));
        VLOGRA_REDUZ_ABREV   := TRIM(F_REDUZ_END_ABREV(F_REDUZ_END(tendereco.nologradouro,0),0));

        --TRATATIVA DOS ENDEÇOES E LOGRADOUROS (21/10/2016)
        --COMPLEMENTO NULO OU ATÉ 10 E O LOGRADOURO + NRIMOVEL ATÉ 40
        --LINHAS 1 E 2 DA PLANILHA
        IF ((VCOMPL IS NULL OR LENGTH(VCOMPL) <= VQTCOMPLEMENTO) AND
           VQTLOGRA + NVL((VQTNRIMOVEL), 0) <= VQTLOGRADOURO) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA;
          ELSE
            VLOGRADOURO := VLOGRA || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TENDERECO.NRIMOVEL;
          END IF;

          VCOMPLEMENTO := VCOMPL;

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '1', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DAS LINHAS 1 E 2
          --LOGRADOURO+NRIMOVEL ACIMA DE 40, PORÉM LOGRAD+IMOVEL REDUZ ATÉ 40 E O COMPLEMENTO ATÉ 10
          --LINHA 3 DA PLANILHA
        ELSIF (((VQTCOMPL <= VQTCOMPLEMENTO) OR (VQTCOMPL IS NULL)) AND
              VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) <= VQTLOGRADOURO) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA_REDUZ;
          ELSE
            VLOGRADOURO := VLOGRA_REDUZ || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TENDERECO.NRIMOVEL;
          END IF;

          VCOMPLEMENTO := VCOMPL;

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '3', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 3
          --COMPLEMENTO ACIMA DE 10, PORÉM COMPL REDUZ ATÉ 10 E O LOGRADOURO + NRIMOVEL ATÉ 40
          --LINHA 4 DA PLANILHA
        ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
              VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
              VQTLOGRA + NVL((VQTNRIMOVEL), 0) <= VQTLOGRADOURO) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA;
          ELSE
            VLOGRADOURO := VLOGRA || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TENDERECO.NRIMOVEL;
          END IF;

          VCOMPLEMENTO := VCOMPL_REDUZ;

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '4', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 4
          --COMPLEMENTO ACIMA DE 10, PORÉM COMPL REDUZ ATÉ 10 E O LOGRADOURO + NRIMOVEL ACIMA DE 40, PORÉM LOGR+IMOVEL REDUZ ATÉ 40
          --LINHA 5 DA PLANILHA
        ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
              VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
              (VQTLOGRA + NVL((VQTNRIMOVEL), 0) > VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) <= VQTLOGRADOURO)) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA_REDUZ;
          ELSE
            VLOGRADOURO := VLOGRA_REDUZ || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TENDERECO.NRIMOVEL;
          END IF;

          VCOMPLEMENTO := VCOMPL_REDUZ;

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '5', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 5

          --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO + NRIMOVEL ATE 40
          --LINHA 6 DA PLANILHA
        ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
              VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
              (VQTLOGRA + NVL((VQTNRIMOVEL), 0) + 1 + VQTCOMPL_REDUZ <=
              VQTLOGRADOURO)) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA || '-' || VCOMPL_REDUZ;
          ELSE
            VLOGRADOURO := VLOGRA || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TENDERECO.NRIMOVEL || '-' ||
                           VCOMPL_REDUZ;
          END IF;

          VCOMPLEMENTO := ' ';

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '6', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 6
          --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO REDUZ + NRIMOVEL ATE 40
          --LINHA 7 DA PLANILHA
        ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
              VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
              (VQTLOGRA + NVL((VQTNRIMOVEL), 0) + 1 + VQTCOMPL_REDUZ >
              VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) + 1 +
              VQTCOMPL_REDUZ <= VQTLOGRADOURO)) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA_REDUZ || '-' || VCOMPL_REDUZ;
          ELSE
            VLOGRADOURO := VLOGRA_REDUZ || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TENDERECO.NRIMOVEL || '-' ||
                           VCOMPL_REDUZ;
          END IF;

          VCOMPLEMENTO := ' ';

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '7', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 7
          --COMPLEMENTO NULO OU ATÉ 10, LOGR REDUZ + NR ACIMA DE 40, PORÉM LOGRADOURO REDUZ E ABREV + NRIMOVEL ATE 40
          --LINHA 8 DA PLANILHA
        ELSIF ((VQTCOMPL <= VQTCOMPLEMENTO OR VCOMPL IS NULL) AND
              (VQTLOGRA + NVL((VQTNRIMOVEL), 0) > VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) > VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL), 0) <=
              VQTLOGRADOURO)) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA_REDUZ_ABREV;
          ELSE
            VLOGRADOURO := VLOGRA_REDUZ_ABREV || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TENDERECO.NRIMOVEL;
          END IF;

          VCOMPLEMENTO := VCOMPL;

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 8

          --COMPLEMENTO ACIMA DE 10, PORÉM REDUZ ATÉ 10 E LOGR REDUZ + NR ACIMA DE 40, PORÉM LOGRADOURO REDUZ E ABREV + NRIMOVEL ATE 40
          --LINHA 9 DA PLANILHA
        ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
              VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
              (VQTLOGRA + NVL((VQTNRIMOVEL), 0) > VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) > VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL), 0) <=
              VQTLOGRADOURO)) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA_REDUZ_ABREV;
          ELSE
            VLOGRADOURO := VLOGRA_REDUZ_ABREV || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TENDERECO.NRIMOVEL;
          END IF;

          VCOMPLEMENTO := VCOMPL_REDUZ;

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 9
          --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO REDUZ E ABREVIADO (ÚLTIMO RECURSO) + NRIMOVEL ATE 40
          --LINHA 10 DA PLANILHA
        ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
              VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
              (VQTLOGRA + NVL((VQTNRIMOVEL), 0) + 1 + VQTCOMPL_REDUZ >
              VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) + 1 +
              VQTCOMPL_REDUZ > VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL), 0) + 1 +
              VQTCOMPL_REDUZ <= VQTLOGRADOURO)) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA_REDUZ_ABREV || '-' || VCOMPL_REDUZ;
          ELSE
            VLOGRADOURO := VLOGRA_REDUZ_ABREV || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TENDERECO.NRIMOVEL || '-' ||
                           VCOMPL_REDUZ;
          END IF;

          VCOMPLEMENTO := ' ';

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 10
        else
          --*****ver se ficará
          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '0', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --SE NAO CONSEGUIU ABREVIAR, TRUNCA 1AS 40 POSICOES DO LOGRADOURO ABREVIADO E 1AS 10 DO COMPLEMENTO
            IF TENDERECO.NRIMOVEL IS NULL THEN
              VLOGRADOURO := SUBSTR(VLOGRA_REDUZ_ABREV,1,40);
            else
              --concatena numero no inicio pois a parte final do logradouro sera truncada
              VLOGRADOURO := substr(TENDERECO.nrimovel || ' ' || VLOGRA_REDUZ_ABREV,1,40);
            end if;

            VCOMPLEMENTO := substr(VCOMPL_REDUZ,1,10);

          /*   -- ERRO - NAO ENTROU EM NENHUM DOS IFS ACIMA
              ELSIF ((LENGTH(TENDERECO.TXCOMPLEMENTO) > VQTCOMPLEMENTO AND LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0))> VQTCOMPLEMENTO) AND
                   ((LENGTH(TRIM(TENDERECO.NOLOGRADOURO)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
                   ((LENGTH(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
                   ((LENGTH(F_REDUZ_END_ABREV(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO)
                   ) THEN

                -- VER COM O VINI PARA GRAVAR FALHA NO PROCESSO
                VLOGRADOURO  := NULL;
                VCOMPLEMENTO := NULL;

                INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '9', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);
          */
        END IF;

        --VALIDACAO DO TAMANHO DO BAIRRO
        --SE NAO ENVIAR O BAIRRO COMPLETO, TENTA O REDUZIDO E POR ÚLTIMO TRUNCA
        VBAIRRO := '';

        IF LENGTH(TENDERECO.NOBAIRRO) > 20 THEN
          IF LENGTH(f_reduz_bairro(TENDERECO.NOBAIRRO, 0)) > 20 THEN
            VBAIRRO := SUBSTR(F_REDUZ_BAIRRO(TENDERECO.NOBAIRRO, 0), 1, 20); --20 POSICOES DO REDUZIDO
          ELSE
            VBAIRRO := f_reduz_bairro(TENDERECO.NOBAIRRO, 0); -- BAIRRO REDUZIDO
          END IF;
        ELSE
          VBAIRRO := TENDERECO.NOBAIRRO; -- BAIRRO INTEIRO
        END IF;

        --INSERT INTO END_MIGRA VALUES (VBAIRRO,NULL,TENDERECO.NOBAIRRO,NULL,NULL,NULL,TENDERECO.NRREGISTRO);

        --FINAL DA VERIFICACAO E TRATAMENTO DO ENDERECO

        if ((tti_grupo_de_fornecedor.cod_grp_fornecedor = 'NAOM') and
           (vlmatriz = 0)) then

          null;

        else

          INSERT INTO TI_FORNECEDOR
            (NRSEQ_CONTROLE_INTEGRACAO,
             NRSEQ_FAVORECIDO,
             CDSITUACAO,
             COD_ACAO,
             COD_AGENC_BCIA,
             COD_BANCO,
             COD_CEP,
             COD_CEP_PAGTO,
             COD_CTA_CORREN_BCO,
             COD_CX_POST,
             COD_CX_POST_PAGTO,
             COD_DIGITO_AGENC_BCIA,
             COD_DIGITO_CTA_CORREN,
             COD_E_MAIL,
             COD_EMPRESA,
             COD_FAX,
             COD_FORMA_PAGTO,
             COD_FORNECEDOR,
             COD_GRP_FORNECEDOR,
             COD_ID_ESTAD_FISIC,
             COD_ID_FEDER,
             COD_ID_FEDER_ESTAD_JURID,
             COD_ID_FEDER_JURID,
             COD_ID_FEDER_MATRIZ,
             COD_ID_FEDER_NASC,
             COD_ID_MUNIC_JURID,
             COD_ID_PREVID_SOCIAL,
             COD_ORG_EMIS_ID_ESTAD,
             COD_PAIS_NASC,
             COD_PORTAD_PREFER,
             COD_RAMAL_FAX,
             COD_TELEFONE_1,
             COD_TELEFONE_2,
             COD_TELEFONE_3,
             COD_TIP_FLUXO_FINANC,
             COD_TIP_FORNECEDOR,
             COD_UNID_FEDER,
             COD_UNID_FEDER_EMIS_ESTAD,
             COD_UNID_FEDER_PAGTO,
             DAT_ENVIO,
             DAT_IMPL_FORNECEDOR,
             DAT_NASCIMENTO,
             DAT_PROCESSAMENTO,
             DEST_ANOT_TABELA,
             IND_ESTADO_CIVIL,
             IND_OCORRENCIA,
             IND_TIPO_PESSOA,
             LOG_FINS_LUCRAT,
             NOM_ABREV,
             NOM_BAIRRO,
             NOM_BAIRRO_PAGTO,
             NOM_CIDADE,
             NOM_CIDADE_PAGTO,
             NOM_ENDER_COMPL,
             NOM_ENDER_COMPL_PAGTO,
             NOM_ENDERECO,
             NOM_ENDERECO_PAGTO,
             NOM_FORNECEDOR,
             NOM_HOME_PAGE,
             NOM_MAE,
             NOM_NACIONALIDADE,
             NOM_PROFISSAO,
             NRPESSOA)

          VALUES

            (L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO, -- nrseq_controle_integracao,
             0, --nrseq_favorecido,
             'RC', --cdsituacao,
             L_INTEGRA_CLIFOR.CDACAO, --cd cod_acao,
             ' ', --cod_agenc_bcia,
             ' ', --cod_banco,
             -- josias 29-06-2014
             -- coloquei o cep padrão de americana para evitar os erros.
             NVL(TENDERECO.NRCEP,
                 F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')), --cod_cep,
             NVL(TENDERECO.NRCEP,
                 F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')), --cod_cep_pagto,
             ' ', --cod_cta_corren_bco,
             ' ', --cod_cx_post,
             ' ', --cod_cx_post_pagto,
             ' ', --cod_digito_agenc_bcia,
             ' ', --cod_digito_cta_corren,
             nvl(substr(tendereco.cdemail, 1, 40), ' '), --cod_e_mail,
             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA'), --cod_empresa,
             ' ', --cod_fax,
             F_TI_PARAMETRO_INTEGRACAO('COD_FORMA_PAGTO'), --cod_forma_pagto,
             TCDN_FORNECEDOR, --cod_fornecedor,
             TTI_GRUPO_DE_FORNECEDOR.COD_GRP_FORNECEDOR, -- cod_grp_fornecedor,

             --F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_estad_fisic,
             NVL(TENDERECO.CDESTADO,
                 F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER')), --cod_id_estad_fisic,

             CASE WHEN TPESSOA.NRCGC_CPF IS NOT NULL THEN TPESSOA.NRCGC_CPF WHEN
             TPESSOA.TPPESSOA = 'F' THEN
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_PESSOA_FISICA') ELSE
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_PESSOA_JURIDICA') END, --cod_id_feder,
             --F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_feder_estad_jurid,
             CASE WHEN TPESSOA.TPPESSOA = 'J' THEN
             NVL(TPESSOA.NRINSCEST_RG, 'ISENTO') ELSE ' ' END, --cod_id_feder_estad_jurid
             NVL(TPESSOA.NRCGC_CPF, ' '), --cod_id_feder_jurid,
             ' ', --F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_feder_matriz,
             ' ', --F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_feder_nasc,
             ' ', --cod_id_munic_jurid,
             ' ', --cod_id_previd_social,
             NVL(TPESSOA.NOORGAO_EMISSOR_RG, ' '), --cod_org_emis_id_estad,
             F_TI_PARAMETRO_INTEGRACAO('COD_PAIS'), --cod_pais_nasc,
             DECODE(TPESSOA.TPPESSOA,
                    'F',
                    F_TI_PARAMETRO_INTEGRACAO('COD_PORTAD_PREFER_PESSOA_FISICA'),
                    F_TI_PARAMETRO_INTEGRACAO('COD_PORTAD_PREFER_PESSOA_JURIDICA')), --cod_portad_prefer,
             ' ', --cod_ramal_fax,
             ' ', --cod_telefone_1,
             ' ', --cod_telefone_2,
             ' ', --cod_telefone_3,

             --           F_TI_PARAMETRO_INTEGRACAO('COD_TIP_FLUXO_FINANC_PREFER_FOR'), --cod_tip_fluxo_financ,
             DECODE(TPESSOA.TPPESSOA,
                    'F',
                    F_TI_PARAMETRO_INTEGRACAO('COD_TIP_FLUXO_FINANC_PREFER_FOR_F'),
                    F_TI_PARAMETRO_INTEGRACAO('COD_TIP_FLUXO_FINANC_PREFER_FOR_J')), --cod_tip_fluxo_financ,

             999, --cod_tip_fornecedor,
             --F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_unid_feder,
             --F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_unid_feder_emis_estad,
             NVL(TENDERECO.CDESTADO,
                 F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER')), --COD_UNID_FEDER
             NVL(TENDERECO.CDESTADO,
                 F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER')), --COD_UNID_FEDER_EMIS_ESTAD

             ' ', --cod_unid_feder_pagto,
             SYSDATE, --dat_envio,
             F_TI_PARAMETRO_INTEGRACAO('DAT_IMPL_FORNECEDOR'), --dat_impl_fornecedor,
             TPESSOA.DTNASCIMENTO, --dat_nascimento,
             SYSDATE, --dat_processamento,

             -- O CAMPO DEST_ANOT_TABELA RECEBERÁ O ENDEREÇO COMPLETO (LOGRAD + NR + COMPL + BAIRRO
             -- PARA DEPOIS ENVIÁ-LO PARA O CAMPO NOM_ENDER_TEXT QUE NÃO EXISTE NA TI_FORNECEDOR
             -- O TI_FORNECEDOR.P (PROGRESS) FARÁ ESTA TRANSFERÊNCIA DE CONTEÚDO ENTRE ESTES CAMPOS
             -- NA A CHAMADA DA API
             'ENDERECO ORIGINAL: ' || CHR(13) ||
             TRIM(TENDERECO.NOLOGRADOURO) ||
             DECODE(TENDERECO.NRIMOVEL, NULL, '', ', ') ||
             DECODE(TENDERECO.NRIMOVEL, NULL, '', TENDERECO.NRIMOVEL) ||
             DECODE(TENDERECO.TXCOMPLEMENTO, NULL, '', ' - ') ||
             DECODE(TENDERECO.TXCOMPLEMENTO,
                    NULL,
                    '',
                    TRIM(TENDERECO.TXCOMPLEMENTO)) ||
             DECODE(TENDERECO.NOBAIRRO, NULL, '', ' - ') ||
             TENDERECO.NOBAIRRO ||
             DECODE(TENDERECO.CDEMAIL_ADICIONAL,
                    NULL,
                    '',
                    CHR(10) || CHR(13) || 'E-MAIL ADICIONAL:' || CHR(13) ||
                    TENDERECO.CDEMAIL_ADICIONAL), --dest_anot_tabela,

             ' ', --ind_estado_civil,
             0, --ind_ocorrencia,
             TPESSOA.TPPESSOA, --ind_tipo_pessoa,
             'S', --log_fins_lucrat,
             TTI_PESSOA.NOABREVIADO_FORNECEDOR, --nom_abrev,
             -- josias 29-06-2014

             /*
             SUBSTR(NVL(TENDERECO.NOBAIRRO,
                        ' '),--F_TI_PARAMETRO_INTEGRACAO('NOBAIRRO_DEFAULT_INCLUSAO')),
                    1,
                    20), --nom_bairro,
             SUBSTR(NVL(TENDERECO.NOBAIRRO,
                        ' '),--F_TI_PARAMETRO_INTEGRACAO('NOBAIRRO_DEFAULT_INCLUSAO')),
                    1,
                    20), --nom_bairro_pagto,
             */
             NVL(VBAIRRO,
                 F_TI_PARAMETRO_INTEGRACAO('NOBAIRRO_DEFAULT_INCLUSAO')), --NOM_BAIRRO
             NVL(VBAIRRO,
                 F_TI_PARAMETRO_INTEGRACAO('NOBAIRRO_DEFAULT_INCLUSAO')), --NOM_BAIRRO_PAGTO

             NVL(TRIM(TCIDADE.NOCIDADE),
                 F_TI_PARAMETRO_INTEGRACAO('NOCIDADE_DEFAULT_INCLUSAO')), --nom_cidade,
             NVL(TRIM(TCIDADE.NOCIDADE),
                 F_TI_PARAMETRO_INTEGRACAO('NOCIDADE_DEFAULT_INCLUSAO')), --nom_cidade_pagto,
             --NVL(SUBSTR(TENDERECO.TXCOMPLEMENTO, 1,10), ' '), --nom_ender_compl,
             --NVL(SUBSTR(TENDERECO.TXCOMPLEMENTO, 1,10), ' '), --nom_ender_compl_pagto,
             NVL(VCOMPLEMENTO, ' '), --NOM_ENDER_COMPL
             NVL(VCOMPLEMENTO, ' '), --NOM_ENDER_COMPL_PAGTO
             /*
             nvl2(replace(replace(replace(tendereco.nologradouro, ' ',''),',',''),'.',''),
             f_abrevia_nome(trim(tendereco.nologradouro)||decode(tendereco.nrimovel,null,null,','||
                            tendereco.nrimovel),40,'PEA')
                   ,'Sem Endereco'),                         --nom_endereco,
             NVL(TRIM(F_ABREVIA_NOME(TRANSLATE(TENDERECO.NOLOGRADOURO,
                                               '0123456789,.;:]',
                                               '              ') ||
                                     DECODE(TENDERECO.NRIMOVEL,
                                            NULL,
                                            NULL,
                                            ',' || TENDERECO.NRIMOVEL),
                                     40,
                                     'PEA')),
                 'Sem Endereco'), --nom_endereco,
             */

             /*
             decode(TRIM(TENDERECO.NOLOGRADOURO),NULL,NULL,
                                                 decode(TENDERECO.NRIMOVEL,NULL,TENDERECO.NOLOGRADOURO,
                                                                           TENDERECO.NOLOGRADOURO || ', ' || TENDERECO.NRIMOVEL)), --NOM_ENDERECO


             decode(TRIM(TENDERECO.NOLOGRADOURO),NULL,NULL,
                                                 decode(TENDERECO.NRIMOVEL,NULL,TENDERECO.NOLOGRADOURO,
                                                                           TENDERECO.NOLOGRADOURO || ', ' || TENDERECO.NRIMOVEL)), --NOM_ENDERECO_PAGTO

             */
             NVL(VLOGRADOURO,
                 F_TI_PARAMETRO_INTEGRACAO('NOLOGRADOURO_DEFAULT_INCLUSAO')), --NOM_ENDERECO
             NVL(VLOGRADOURO,
                 F_TI_PARAMETRO_INTEGRACAO('NOLOGRADOURO_DEFAULT_INCLUSAO')), --NOM_ENDERECO_PAGTO

             --             NVL(TRIM(TENDERECO.NOLOGRADOURO), 'Sem endereço'), --nom_endereco_pagto,

             TPESSOA.NOPESSOA, --nom_fornecedor,
             ' ', --nom_home_page,
             -- Josias - 29-06-2014
             -- coloquei o truncamento pois estava estourando mais de 40 posições.
             F_ABREVIA_NOME(TPESSOA.NOMAE, 40, ''), --nom_mae,
             ' ', --F_TI_PARAMETRO_INTEGRACAO('NOM_NACIONALIDADE'), --nom_nacionalidade,
             NULL, --nom_profissao,
             TFORNECEDOR.NRREGISTRO_FORNECEDOR --nrpessoa
             );

          insere_hash('FN',
                      L_INTEGRA_CLIFOR.NRSEQUENCIAL_ORIGEM,
                      L_INTEGRA_CLIFOR.CDIDENTIFICADOR);

          IF SQL%ROWCOUNT = 0 THEN
            P_TI_VALIDA_ENDERECO(L_INTEGRA_CLIFOR.NRSEQUENCIAL_ORIGEM,
                                 L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                                 'TI_FORNECEDOR',
                                 PCDSITUACAO);
            IF PCDSITUACAO = 'RC' THEN
              P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                            'TI_FORNECEDOR',
                            'A VIEW V_TI_FORNECEDOR NO ENCONTROU FORNECEDOR PARA O PROCESSO ==>' ||
                            L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO ||
                            'Pessoa ==>' ||
                            L_INTEGRA_CLIFOR.NRSEQUENCIAL_ORIGEM ||
                            'Fornecedor ==> ' ||
                            L_INTEGRA_CLIFOR.CDIDENTIFICADOR,
                            NULL,
                            PCDSITUACAO,
                            NULL);
            END IF;
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                        'TI_FORNECEDOR',
                        'O Fornecedor j foi enviado para a TI_FORNECEDOR',
                        NULL,
                        PCDSITUACAO,
                        -1);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        'TI_FORNECEDOR',
                        'Falha:  ' || SQLERRM,
                        ' Processo ==> ' ||
                        L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO ||
                        '  Pessoa ==> ' ||
                        L_INTEGRA_CLIFOR.NRSEQUENCIAL_ORIGEM ||
                        '  Fornecedor ==> ' ||
                        L_INTEGRA_CLIFOR.CDIDENTIFICADOR,
                        PCDSITUACAO,
                        NULL);

      END;

      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  --===============================--
  -- Grava Titulo - TI_TIT_ACR --
  -----------------------------------
  PROCEDURE P_TI_TIT_ACR_ESTORNO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PNRDOCUMENTO               VARCHAR2,
                                 PCDSITUACAO                IN OUT VARCHAR2,
                                 PNRSESSAO                  NUMBER) IS
    CURSOR C_FATURA IS
      SELECT CI.*, FT.DTCANCELAMENTO
        FROM TI_CONTROLE_INTEGRACAO CI, FATURAMENTO FT
       WHERE CI.TPINTEGRACAO = 'FT'
         AND FT.NRFATURA = CI.CDIDENTIFICADOR
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND CDSITUACAO = 'VD'
         AND CI.NRSESSAO = PNRSESSAO;
    CURSOR C_EMS(PNRDOCUMENTO VARCHAR2) IS
      SELECT EMS.NUM_ID_TIT_ACR, EMS.NRDOCUMENTO
        FROM EMS_MOVIMENTO_TITULO_ACR EMS, TITULO_A_RECEBER TR, TIT_ACR TA
       WHERE TA.U##COD_ESTAB = EMS.COD_ESTAB
         AND TA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
         AND TR.NRDOCUMENTO = PNRDOCUMENTO
         AND TR.NRDOCUMENTO = EMS.NRDOCUMENTO
         AND EMS.NRREGISTRO_TITULO = TR.NRREGISTRO_TITULO
         AND EMS.IND_TRANS_ACR_ABREV = 'IMPL'
         AND TA.LOG_TIT_ACR_ESTORDO = 0;
    VCDINTEGRACAO    VARCHAR2(100);
    VCOD_ESPEC_DOCTO TI_TIPO_MOVIMENTO_TIT_ACR.COD_ESPEC_DOCTO%TYPE;
    VAOACHOU         BOOLEAN;
  BEGIN
    VCDINTEGRACAO := 'TI_TIT_ACR_ESTORNO';
    PCDSITUACAO   := 'ER';
    FOR L_FATURA IN C_FATURA LOOP
      VAOACHOU := FALSE;
      FOR L_EMS IN C_EMS(L_FATURA.CDIDENTIFICADOR) LOOP
        PCDSITUACAO := 'RC';
        VAOACHOU    := TRUE;
        BEGIN
          INSERT INTO TI_TIT_ACR_ESTORNO
            (NRSEQ_CONTROLE_INTEGRACAO,
             CDSITUACAO,
             NRDOCUMENTO,
             COD_ESTAB,
             COD_ESPEC_DOCTO,
             COD_SER_DOCTO,
             COD_TIT_ACR,
             COD_PARCELA,
             COD_TIT_ACR_BCO,
             COD_REFER,
             NUM_ID_MOVTO_TIT_ACR,
             NUM_ID_TIT_ACR,
             COD_PORTADOR,
             DAT_TRANSACAO,
             DAT_ENVIO,
             CDN_CLIENTE,
             DAT_PROCESSAMENTO,
             IND_NIV_OPERAC_ACR,
             IND_TIP_OPERAC_ACR)
            SELECT L_FATURA.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
                   CDSITUACAO,
                   L_FATURA.CDIDENTIFICADOR NRDOCUMENTO,
                   COD_ESTAB,
                   COD_ESPEC_DOCTO,
                   COD_SER_DOCTO,
                   COD_TIT_ACR,
                   COD_PARCELA,
                   COD_TIT_ACR_BCO,
                   'E' || LPAD(L_FATURA.NRSEQUENCIAL, 9, '0'),
                   NUM_ID_MOVTO_TIT_ACR,
                   NUM_ID_TIT_ACR,
                   COD_PORTADOR,
                   L_FATURA.DTCANCELAMENTO DAT_TRANSACAO,
                   DAT_ENVIO,
                   CDN_CLIENTE,
                   DAT_PROCESSAMENTO,
                   IND_NIV_OPERAC_ACR,
                   IND_TIP_OPERAC_ACR
              FROM V_TI_TIT_ACR_ESTORNO TA
             WHERE TA.NUM_ID_TIT_ACR = L_EMS.NUM_ID_TIT_ACR;
          IF SQL%ROWCOUNT = 0 THEN
            P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Dados no encontrados na V_ti_tit_acr_estorno PARA O PROCESSO ' ||
                          L_FATURA.NRSEQUENCIAL || ' Especie: ' ||
                          VCOD_ESPEC_DOCTO || ' Srie: ' ||
                          SUBSTR(L_FATURA.CDIDENTIFICADOR, 1, 2) ||
                          'Titulo :' ||
                          SUBSTR(L_FATURA.CDIDENTIFICADOR,
                                 INSTR(L_FATURA.CDIDENTIFICADOR, '-') + 1,
                                 12),
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        EXCEPTION
          WHEN DUP_VAL_ON_INDEX THEN
            P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'A fatura j foi enviada para estorno. Processo ==>' ||
                          L_FATURA.NRSEQUENCIAL,
                          NULL,
                          PCDSITUACAO,
                          -1);
          WHEN OTHERS THEN
            P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Erro ao enviar fatura para cancelamento. Processo ==>' ||
                          L_FATURA.NRSEQUENCIAL || ' ' || SQLERRM,
                          NULL,
                          PCDSITUACAO,
                          NULL);
        END;
        --====================================--
        -- Atualizar o situao da integrao --
        ----------------------------------------
        P_UPDATE_CONTROLE_INTEGRACAO(L_FATURA.NRSEQUENCIAL,
                                     PCDSITUACAO,
                                     NULL);
      END LOOP;
      IF NOT VAOACHOU THEN
        P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                      VCDINTEGRACAO,
                      'O titulo no EMS5==> ' || L_FATURA.CDIDENTIFICADOR || ' ' ||
                      L_FATURA.NRSEQUENCIAL || ' ' || SQLERRM,
                      NULL,
                      PCDSITUACAO,
                      NULL);
      END IF;
      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_FATURA.NRSEQUENCIAL,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
    -- Alessandro 19/03/2012
    FOR XX IN (SELECT T.NRDOCUMENTO,
                      T.NUM_ID_TIT_ACR,
                      MT.LOG_APROP_CTBL_CTBZDA,
                      T.NRSEQ_CONTROLE_INTEGRACAO
                 FROM TI_TIT_ACR_ESTORNO T, TIT_ACR TA, MOVTO_TIT_ACR MT
                WHERE MT.U##COD_ESTAB = TA.U##COD_ESTAB
                  AND MT.NUM_ID_TIT_ACR = TA.NUM_ID_TIT_ACR
                  AND MT.IND_TRANS_ACR_ABREV = 'IMPL'
                  AND TA.NUM_ID_TIT_ACR = T.NUM_ID_TIT_ACR
                  AND T.CDSITUACAO IN ('ER', 'RC')
               --and mt.LOG_APROP_CTBL_CTBZDA = 1
               ) LOOP
      IF XX.LOG_APROP_CTBL_CTBZDA = 1 THEN
        UPDATE TI_TIT_ACR_ESTORNO Q
           SET Q.CDSITUACAO = 'RC'
         WHERE Q.NRSEQ_CONTROLE_INTEGRACAO = XX.NRSEQ_CONTROLE_INTEGRACAO;
        P_UPDATE_CONTROLE_INTEGRACAO(XX.NRSEQ_CONTROLE_INTEGRACAO,
                                     'RC',
                                     '');
      ELSE
        UPDATE TI_TIT_ACR_ESTORNO Q
           SET Q.CDSITUACAO = 'ER'
         WHERE Q.NRSEQ_CONTROLE_INTEGRACAO = XX.NRSEQ_CONTROLE_INTEGRACAO;
        P_UPDATE_CONTROLE_INTEGRACAO(XX.NRSEQ_CONTROLE_INTEGRACAO,
                                     'ER',
                                     'Titulo nao CTBL EMS5');
        P_GRAVA_FALHA(XX.NRSEQ_CONTROLE_INTEGRACAO,
                      'FAT_CANCEL',
                      'Fatura Cancelada no Unicoo, e n?o CTBLZ no EMS5',
                      'Contabilize o ACR no EMS5',
                      PCDSITUACAO,
                      NULL);
      END IF;
    END LOOP;
    -- Alessandro 19/03/2012
  END;

  --===============================--
  -- Grava Titulo - TI_TIT_ACR --
  -----------------------------------
  PROCEDURE P_TI_TIT_ACR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2) IS

  t1 NUMBER;
  t2 VARCHAR2(100);
  t3 VARCHAR2(100);
  t4 VARCHAR2(100);
  t5 VARCHAR2(100);



    CURSOR C_TRATA_FALHA IS
      SELECT DISTINCT UCL.CDCLIENTE,
                      nvl(ecl.cdn_cliente,0) cdn_cliente, --TIP.CDN_CLIENTE,
                      tip.cdn_cliente tipcdn_cliente,
                      UCL.NRREGISTRO_CLIENTE,
                      CI.CDEMPRESA,
                      CI.CDMODULO,
                      CI.CDMOVIMENTO,
                      ECL.COD_GRP_CLIEN,
                      TR.NRDOCUMENTO,
                      TR.NRREGISTRO_TITULO,
                      (SELECT COUNT(*)
                         FROM ENDERECO ED
                        WHERE ED.NRREGISTRO = UCL.NRREGISTRO_CLIENTE) QTENDERECO,
                      F_TI_TIP_MOVTO_TIT_ACR(CI.CDEMPRESA,
                                             CI.CDMODULO,
                                             CI.CDMOVIMENTO,
                                             ECL.COD_GRP_CLIEN) NUM_TIP_MOVTO_TIT_ACR
        FROM TITULO_A_RECEBER                 TR,
             TI_CONTROLE_INTEGRACAO           CI,
             PRODUCAO.CLIENTE@UNICOO_HOMOLOGA UCL,
             ems5.CLIENTE                     ECL,
             TI_PESSOA                        TIP,
             TI_EMPRESA                       EMP
       WHERE ECL.CDN_CLIENTE(+) = TIP.CDN_CLIENTE
         AND CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO
         AND TR.NRREGISTRO_TITULO = CI.NRSEQUENCIAL_ORIGEM
         AND TIP.NRREGISTRO(+) = UCL.NRREGISTRO_CLIENTE
         AND TR.CDCLIENTE = UCL.CDCLIENTE
         AND CI.CDEMPRESA = EMP.CDEMPRESA
         AND NVL(ECL.COD_EMPRESA, EMP.COD_EMPRESA) = EMP.COD_EMPRESA;

    CURSOR C_TITULOS IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TR'
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
            --and cdsituacao = 'VD'
         AND CI.NRSESSAO = PNRSESSAO;
    VCDINTEGRACAO  VARCHAR2(100);
    VAO_ACHOU_ERRO BOOLEAN;
  BEGIN

    dbms_output.enable(null);

    FOR L_TITULOS IN C_TITULOS LOOP
        PCDSITUACAO   := 'RC';
        VCDINTEGRACAO := 'TI_TIT_ACR';

        dbms_output.put_line('P1. L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL);
        begin
          INSERT INTO TI_TIT_ACR
            (COD_ESTAB,
             COD_TITULO_ACR,
             VAL_IR,
             DAT_DESCONTO,
             VAL_LIQ_TITULO,
             DES_TEXT_HISTOR,
             IND_OCORRENCIA,
             NRSEQ_CONTROLE_INTEGRACAO,
             IND_TIPO_PESSOA,
             COD_ID_FEDER_JURID,
             COD_ID_FEDER,
             COD_ESPEC_DOCTO,
             COD_PARCELA,
             DAT_EMISSAO,
             DAT_VENCTO,
             DAT_PREVISAO_LIQUIDAC,
             VAL_TITULO,
             COD_CART_BCIA,
             DAT_PROCESSAMENTO,
             COD_EMPRESA,
             COD_TIP_FLUXO_FINANC,
             COD_PAIS,
             COD_CTA_CTBL,
             COD_CCUSTO,
             VAL_DESCONTO,
             COD_TIT_ACR_BCO,
             COD_PORTADOR,
             COD_SER_DOCTO,
             IND_TIP_ESPEC_DOCTO,
             CDSITUACAO,
             COD_CLIENTE,
             NRPESSOA,
             COD_PLANO_CCUSTO,
             COD_PLANO_CTA_CTBL,
             VAL_PERC_JUROS_DIA_ATRASO,
             VAL_PERC_MULTA_ATRASO)
            SELECT COD_ESTAB,
                   COD_TITULO_ACR,
                   VAL_IR,
                   DAT_DESCONTO,
                   VAL_LIQ_TITULO,
                   DES_TEXT_HISTOR,
                   IND_OCORRENCIA,
                   NRSEQ_CONTROLE_INTEGRACAO,
                   IND_TIPO_PESSOA,
                   COD_ID_FEDER_JURID,
                   COD_ID_FEDER,
                   COD_ESPEC_DOCTO,
                   COD_PARCELA,
                   DAT_EMISSAO,
                   DAT_VENCTO,
                   DAT_PREVISAO_LIQUIDAC,
                   VAL_TITULO,
                   COD_CART_BCIA,
                   DAT_PROCESSAMENTO,
                   COD_EMPRESA,
                   COD_TIP_FLUXO_FINANC,
                   COD_PAIS,
                   COD_CTA_CTBL,
                   COD_CCUSTO,
                   VAL_DESCONTO,
                   COD_TIT_ACR_BCO,
                   COD_PORTADOR,
                   COD_SER_DOCTO,
                   IND_TIP_ESPEC_DOCTO,
                   CDSITUACAO,
                   COD_CLIENTE,
                   NRPESSOA,
                   COD_PLANO_CCUSTO,
                   COD_PLANO_CTA_CTBL,
                   0                         VAL_PERC_JUROS_DIA_ATRASO,
                   0                         VAL_PERC_MULTA_ATRASO
              FROM V_TI_TIT_ACR TIT
             WHERE TIT.NRSEQ_CONTROLE_INTEGRACAO = L_TITULOS.NRSEQUENCIAL;
        EXCEPTION
          WHEN DUP_VAL_ON_INDEX THEN
            dbms_output.put_line('P8. L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL);
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Titulo ja enviado. Processo ==>' ||
                          L_TITULOS.NRSEQUENCIAL,
                          NULL,
                          PCDSITUACAO,
                          -1);
          when others then
            dbms_output.put_line('P9. L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL);
            p_grava_falha(l_titulos.nrsequencial,
                            vCDIntegracao,
                            'Erro ao tentar criar TI_TIT_ACR. Verifique campos nulos(ex. NRDOCUMENTO). ' || sqlerrm,
                            null,
                            pcdsituacao,
                            null);

            P_COMMIT;

        END;
        IF SQL%ROWCOUNT = 0 THEN
          VAO_ACHOU_ERRO := FALSE;

--          dbms_output.put_line('L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL);

          /* p_grava_falha(l_titulos.nrsequencial,
          vCDIntegracao,
          'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
          l_titulos.nrsequencial,
          'A view V_TI_TIT_ACR nao encontrou registro',
          pCDSituacao,
          null);*/
          FOR L_TRATA_FALHA IN C_TRATA_FALHA LOOP

            dbms_output.put_line('P2. L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL);

            dbms_output.put_line('L_TRATA_FALHA.NUM_TIP_MOVTO_TIT_ACR: ' || L_TRATA_FALHA.NUM_TIP_MOVTO_TIT_ACR ||
                                 ' NRDOCUMENTO: ' || L_TRATA_FALHA.NRDOCUMENTO ||
                                 ' NRREGISTRO_TITULO: ' || L_TRATA_FALHA.NRREGISTRO_TITULO ||
                                 ' CDN_CLIENTE: ' || L_TRATA_FALHA.CDN_CLIENTE ||
                                 ' QTENDERECO: ' || L_TRATA_FALHA.QTENDERECO ||
                                 ' NUM_TIP_MOVTO_TIT_ACR: ' || L_TRATA_FALHA.NUM_TIP_MOVTO_TIT_ACR


                                 );

            VAO_ACHOU_ERRO := TRUE;
            IF L_TRATA_FALHA.CDN_CLIENTE IS NULL or L_TRATA_FALHA.CDN_CLIENTE = 0 THEN
              -- Fazer a geração do Cliente para poder reprocessar o titulo depois
              ------------------------------------------------------------------------
              --P_INSERE_CLIENTE(L_TITULOS.NRSEQUENCIAL_ORIGEM);
              ------------------------------------------------------------------------
              dbms_output.put_line('P3. L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL ||
                                   ' L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL ||
                                   ' VCDINTEGRACAO: ' || VCDINTEGRACAO ||
                                   ' L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL ||
                                   ' L_TRATA_FALHA.CDCLIENTE: ' || L_TRATA_FALHA.CDCLIENTE ||
                                   ' l_trata_falha.tipcdn_cliente: ' || l_trata_falha.tipcdn_cliente ||
                                   ' PCDSITUACAO: ' || PCDSITUACAO
              );
              t1 := L_TITULOS.NRSEQUENCIAL;
              t2 := VCDINTEGRACAO;
              t3 := '(1)A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' || L_TITULOS.NRSEQUENCIAL;
              t4 := 'Falta integrar o cliente ' || nvl(to_char(L_TRATA_FALHA.CDCLIENTE),'nulo') || ' do UNICOO no EMS5(' ||
                            nvl(to_char(l_trata_falha.tipcdn_cliente),'nulo') || ')';
              t5 := PCDSITUACAO;

              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            '(1)A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            'Falta integrar o cliente ' ||
                            nvl(to_char(L_TRATA_FALHA.CDCLIENTE),'nulo') || ' do UNICOO no EMS5(' ||
                            nvl(to_char(l_trata_falha.tipcdn_cliente),'nulo') || ')',
                            PCDSITUACAO,
                            NULL);
            ELSIF L_TRATA_FALHA.QTENDERECO IS NULL THEN
              dbms_output.put_line('P4. L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL);
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            '(2)A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            'O Cliente ' || L_TRATA_FALHA.CDCLIENTE ||
                            ' nao foi integrado para o EMS5, o cliente no possui endereco no Unicoo.',
                            PCDSITUACAO,
                            NULL);
            ELSIF L_TRATA_FALHA.NUM_TIP_MOVTO_TIT_ACR = '-1' THEN
              dbms_output.put_line('P5. L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL);
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            '(3)A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            ' Tipo de movimento no cadastrado em TI_TIPO_MOVIMENTO_TIT_ACR, parametros informados: ' ||
                            ' Cdigo da Empresa: ' ||
                            L_TRATA_FALHA.CDEMPRESA || ' Cdigo do mdulo: ' ||
                            L_TRATA_FALHA.CDMODULO ||
                            ' Cdigo do movimento: ' ||
                            L_TRATA_FALHA.CDMOVIMENTO ||
                            ' Grupo de cliente no EMS5: ' ||
                            L_TRATA_FALHA.COD_GRP_CLIEN ||
                            ' Cdigo de cliente no EMS5: ' ||
                            L_TRATA_FALHA.CDN_CLIENTE,
                            PCDSITUACAO,
                            NULL);
            ELSE
              dbms_output.put_line('P6. L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL);
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            '(4)A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,

                            --null,--'Codigo da falha: ' || nvl(L_TRATA_FALHA.NUM_TIP_MOVTO_TIT_ACR,'NULO'),

                            ' HISTORICO: ' || L_TRATA_FALHA.CDMOVIMENTO,
--                      F_TI_TIP_MOVTO_TIT_ACR(CI.CDEMPRESA,
--                                             CI.CDMODULO,
--                                             CI.CDMOVIMENTO,
--                                             ECL.COD_GRP_CLIEN) NUM_TIP_MOVTO_TIT_ACR


                            PCDSITUACAO,
                            NULL);
            END IF;
          END LOOP;
          IF VAO_ACHOU_ERRO = FALSE THEN
            dbms_output.put_line('P7. L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL);
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          '(5)A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                          L_TITULOS.NRSEQUENCIAL ||
                          '. Titulo ou cliente no existe no Unicoo',
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        ELSE
          begin
            VCDINTEGRACAO := 'TI_TIT_ACR_CTBL';
            INSERT INTO TI_TIT_ACR_CTBL CTB
              (VAL_APROP_CTBL,
               COD_ESTAB,
               COD_CTA_CTBL,
               COD_UNID_FEDERAC,
               COD_TIP_FLUXO_FINANC,
               NRSEQ_CONTROLE_INTEGRACAO,
               CDSITUACAO,
               COD_CCUSTO,
               DAT_PROCESSAMENTO)
              (SELECT VAL_APROP_CTBL,
                      COD_ESTAB,
                      COD_CTA_CTBL,
                      COD_UNID_FEDERAC,
                      COD_TIP_FLUXO_FINANC,
                      NRSEQ_CONTROLE_INTEGRACAO,
                      CDSITUACAO,
                      COD_CCUSTO,
                      DAT_PROCESSAMENTO
                 FROM V_TI_TIT_ACR_CTBL CTB
                WHERE CTB.NRSEQ_CONTROLE_INTEGRACAO = L_TITULOS.NRSEQUENCIAL);
          EXCEPTION
            WHEN DUP_VAL_ON_INDEX THEN
              dbms_output.put_line('P18. L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL);
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'TI_TIT_ACR_CTBL ja enviado. Processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            NULL,
                            PCDSITUACAO,
                            -1);
            when others then
              dbms_output.put_line('P19. L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL);
              p_grava_falha(l_titulos.nrsequencial,
                              vCDIntegracao,
                              'Erro ao tentar criar TI_TIT_ACR_CTBL. Verifique campos nulos(ex. NRDOCUMENTO). ' || sqlerrm,
                              null,
                              pcdsituacao,
                              null);

              P_COMMIT;
          END;

          IF SQL%ROWCOUNT = 0 THEN
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          '(6)A view V_ti_TIT_ACR_ctbl no encontrou registro para o processo ==>' ||
                          L_TITULOS.NRSEQUENCIAL,
                          NULL,
                          PCDSITUACAO,
                          NULL);
          ELSE
            BEGIN
              VCDINTEGRACAO := 'TI_TIT_ACR_CTBL_IMPOSTO';
              INSERT INTO TI_TIT_ACR_IMPOSTO
                (COD_SER_DOCTO,
                 IND_CLAS_IMPTO,
                 VAL_RENDTO_TRIBUT,
                 VAL_ALIQ_IMPTO,
                 COD_ESTAB,
                 COD_ESPEC_DOCTO,
                 COD_PARCELA,
                 COD_UNID_FEDERAC,
                 COD_IMPOSTO,
                 COD_CLASSIF_IMPTO,
                 VAL_IMPOSTO,
                 DAT_PROCESSAMENTO,
                 CDSITUACAO,
                 NRSEQ_CONTROLE_INTEGRACAO,
                 IND_OCORRENCIA)
                (SELECT COD_SER_DOCTO,
                        IND_CLAS_IMPTO,
                        VAL_RENDTO_TRIBUT,
                        VAL_ALIQ_IMPTO,
                        COD_ESTAB,
                        COD_ESPEC_DOCTO,
                        COD_PARCELA,
                        COD_UNID_FEDERAC,
                        COD_IMPOSTO,
                        COD_CLASSIF_IMPTO,
                        VAL_IMPOSTO,
                        DAT_PROCESSAMENTO,
                        CDSITUACAO,
                        NRSEQ_CONTROLE_INTEGRACAO,
                        IND_OCORRENCIA
                   FROM V_TI_TIT_ACR_IMPOSTO IP
                  WHERE IP.NRSEQ_CONTROLE_INTEGRACAO =
                        PNRSEQ_CONTROLE_INTEGRACAO);
            EXCEPTION
              WHEN DUP_VAL_ON_INDEX THEN
                dbms_output.put_line('P28. L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL);
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'TI_TIT_ACR_IMPOSTO ja enviado. Processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              NULL,
                              PCDSITUACAO,
                              -1);
              when others then
                dbms_output.put_line('P29. L_TITULOS.NRSEQUENCIAL: ' || L_TITULOS.NRSEQUENCIAL);
                p_grava_falha(l_titulos.nrsequencial,
                                vCDIntegracao,
                                'Erro ao tentar criar TI_TIT_ACR_IMPOSTO. Verifique campos nulos(ex. NRDOCUMENTO). ' || sqlerrm,
                                null,
                                pcdsituacao,
                                null);

                P_COMMIT;
            END;
          END IF;
        END IF;

      P_COMMIT;

      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_TITULOS.NRSEQUENCIAL,
                                   PCDSITUACAO,
                                   NULL);
      --=====================================--
      -- Titulo de Cooperados n?o trata falha,
      -- apenas cancela...
      -----------------------------------------
      IF SUBSTR(L_TITULOS.CDIDENTIFICADOR, 1, 3) = '9956-' THEN
        --braz
        P_UPDATE_CONTROLE_INTEGRACAO(L_TITULOS.NRSEQUENCIAL, --comentado emmaio de 2013 para tratar via arquivo gerado para baixa em lote pelo ems5
                                     'CA',
                                     NULL);
      END IF;
    END LOOP;
  END;

  --============================================--
  -- Grava Titulo a pagar - TI_TIT_APB      --
  --                        TI_TIT_APB_CTBL --
  ------------------------------------------------
  PROCEDURE P_TI_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_TRATA_FALHA IS
      SELECT DISTINCT EFN.CDN_FORNECEDOR CDFORNECEDOR,
                      TIP.CDN_FORNECEDOR CDFORNECEDOR_EMS5,
                      UFN.NRREGISTRO_FORNECEDOR,
                      CI.CDIDENTIFICADOR,
                      CI.CDEMPRESA,
                      CI.CDMODULO,
                      CI.CDMOVIMENTO,
                      EFN.CDN_FORNECEDOR,
                      EFN.COD_GRP_FORNEC,
                      CI.CDDIVISAO,
                      CI.CDCENTRO_CUSTO,
                      (SELECT COUNT(*)
                         FROM ENDERECO ED
                        WHERE ED.NRREGISTRO = UFN.NRREGISTRO_FORNECEDOR) QTENDERECO,
                      F_TI_TIP_MOVTO_TIT_APB(CI.CDEMPRESA,
                                             CI.CDMODULO,
                                             CI.CDMOVIMENTO,
                                             EFN.COD_GRP_FORNEC,
                                             CI.CDDIVISAO,
                                             CI.CDCENTRO_CUSTO) NUM_TIP_MOVTO_TIT_APB,
                      PE.NOPESSOA NOFORNECEDORUNICOO
        FROM TITULO_A_PAGAR                      TP,
             TI_CONTROLE_INTEGRACAO              CI,
             PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA UFN,
             PESSOA                              PE,
             FORNECEDOR                          EFN,
             TI_PESSOA                           TIP,
             TI_EMPRESA                          EMP
       WHERE CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO
         AND TP.NRREGISTRO_TITULO = CI.NRSEQUENCIAL_ORIGEM
         AND TP.CDFORNECEDOR = UFN.CDFORNECEDOR
         AND UFN.NRREGISTRO_FORNECEDOR = PE.NRREGISTRO
         AND TIP.NRREGISTRO = UFN.NRREGISTRO_FORNECEDOR
         AND EFN.CDN_FORNECEDOR = TIP.CDN_FORNECEDOR
         AND EFN.COD_EMPRESA = EMP.COD_EMPRESA
         AND EMP.CDEMPRESA =
             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');

    CURSOR C_TITULOS IS
      SELECT CI.*
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TP'
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND CI.NRSESSAO = PNRSESSAO;
    VCDINTEGRACAO           VARCHAR2(100);
    VAO_ACHOU_ERRO          BOOLEAN;
    RTI_TIT_APB_CTBL        TI_TIT_APB_CTBL%ROWTYPE;
    RTI_CONTROLE_INTEGRACAO TI_CONTROLE_INTEGRACAO%ROWTYPE;
    RFORNECEDOR             EMS506UNICOO.TI_PESSOA%ROWTYPE;
    RFORNECEDOR_EMS         FORNECEDOR%ROWTYPE;
    VCOD_ESTAB              TI_TIPO_MOVIMENTO_TIT_APB.CDDIVISAO%TYPE;
    HAFALHA                 BOOLEAN;
    aonaom                  varchar2(1);
    cd_grupo_aux            number;
  BEGIN

    DBMS_OUTPUT.ENABLE(9999999999);
    DBMS_OUTPUT.PUT_LINE( 'P1. SITUACAO: ' || PCDSITUACAO);

    FOR L_TITULOS IN C_TITULOS LOOP
      BEGIN
        HAFALHA       := FALSE;
        VCDINTEGRACAO := 'TI_TIT_APB';
        -- tratativas de erro
        BEGIN
          SELECT *
            INTO RTI_CONTROLE_INTEGRACAO
            FROM TI_CONTROLE_INTEGRACAO
           WHERE NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            HAFALHA := TRUE;
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Controle integracão não encontrado',
                          NULL,
                          PCDSITUACAO,
                          NULL);
        END;
        BEGIN
          SELECT B.*
            INTO RFORNECEDOR
            FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA A,
                 EMS506UNICOO.TI_PESSOA              B
           WHERE A.NRREGISTRO_FORNECEDOR = B.NRREGISTRO
             AND CDFORNECEDOR =
                 (SELECT FO.CDFORNECEDOR
                    FROM TITULO_A_PAGAR                      TP,
                         PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FO
                   WHERE FO.CDFORNECEDOR = TP.CDFORNECEDOR
                     AND TP.NRREGISTRO_TITULO =
                         RTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM);
          IF RFORNECEDOR.CDN_FORNECEDOR IS NULL THEN
            -- Fazer a geração do fornecedor para poder reprocessar o titulo depois
            ------------------------------------------------------------------------
            P_INSERE_FORNECEDOR(RTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM);
            ------------------------------------------------------------------------
          END IF;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            -- Fazer a geração do fornecedor para poder reprocessar o titulo depois
            ------------------------------------------------------------------------
            P_INSERE_FORNECEDOR(RTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM);
            ------------------------------------------------------------------------
            HAFALHA := TRUE;
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Fornecedor não integrado com TOTVS11, aguardar a integração do fornecedor !! ',
                          NULL,
                          PCDSITUACAO,
                          NULL);
        END;
        IF L_TITULOS.CDDIVISAO IS NOT NULL THEN
          BEGIN
            SELECT ET.COD_ESTAB
              INTO VCOD_ESTAB
              FROM TI_ESTABELECIMENTO ET
             WHERE ET.CDDIVISAO = L_TITULOS.CDDIVISAO;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              HAFALHA := TRUE;
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'Falta o De-Para do unicoo para a Divisão [' ||
                            L_TITULOS.CDDIVISAO ||
                            ' ] na tabela TI_ESTABELECIMENTO ',
                            'Empresa[' || L_TITULOS.CDEMPRESA || '] ' ||
                            'Modulo[' || L_TITULOS.CDMODULO || '] ' ||
                            'Movimento[' ||
                            RPAD(L_TITULOS.CDMOVIMENTO, 5, ' ') || '] ' ||
                            'Divisão [' || L_TITULOS.CDDIVISAO || '] ' ||
                            'Verifique na tabela de vinculo , qual é o estabelecimento para a divisão ' ||
                            L_TITULOS.CDDIVISAO,
                            PCDSITUACAO,
                            NULL);
          END;
        END IF;
        BEGIN
          SELECT EFN.*
            INTO RFORNECEDOR_EMS
            FROM FORNECEDOR EFN, TI_EMPRESA EMP
           WHERE CDN_FORNECEDOR = RFORNECEDOR.CDN_FORNECEDOR
             AND EFN.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            HAFALHA := TRUE;

            --CHECAR SE O MOTIVO DE NAO ENCONTRAR O FORNECEDOR DO EMS5 EH DEVIDO A DEPARA DE GRUPO DE FORNECEDOR NAOM
            aonaom := 'N';
            begin

              SELECT a.cdgrupo_fornecedor
                INTO cd_grupo_aux
                FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA A
               WHERE CDFORNECEDOR =
                     (SELECT FO.CDFORNECEDOR
                        FROM TITULO_A_PAGAR                      TP,
                             PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FO
                       WHERE FO.CDFORNECEDOR = TP.CDFORNECEDOR
                         AND TP.NRREGISTRO_TITULO =
                             RTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM);

              select 'S' into aonaom from ti_grupo_de_fornecedor tgf
                   where tgf.cdgrupo_fornecedor = cd_grupo_aux
                     and tgf.cod_grp_fornecedor = 'NAOM';
            exception
              when others then aonaom := 'N';
            end;

            if aonaom = 'S' then
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'Grupo do Fornecedor parametrizado como NAOM. Verifique TI_GRUPO_FORNECEDOR',
                            'Registro do Fornecedor no unicoo: ' ||
                            RFORNECEDOR.NRREGISTRO,
                            PCDSITUACAO,
                            NULL);
            else
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'Fornecedor do EMS5 não encontrado.',
                            'Registro do Fornecedor no unicoo: ' ||
                            RFORNECEDOR.NRREGISTRO,
                            PCDSITUACAO,
                            NULL);
            end if;
        END;

        /* se titulo ja existir no EMS5, sair sem apresentar erro */
        /*
                 and not exists(SELECT 1
                                  FROM TIT_AP A, TI_EMPRESA EMP
                                 WHERE A.CDN_FORNECEDOR = RFORNECEDOR.CDN_FORNECEDOR
                                   AND A.COD_TIT_AP = tit.COD_TITULO_AP
                                   AND A.COD_ESPEC_DOCTO = tit.COD_ESPEC_DOCTO
                                   AND A.COD_SER_DOCTO = tit.COD_SER_DOCTO
                                   AND A.COD_EMPRESA = EMP.COD_EMPRESA
                                   AND A.COD_PARCELA = tit.COD_PARCELA
                                   AND EMP.CDEMPRESA =
                                       F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO'))
        */

    DBMS_OUTPUT.PUT_LINE( 'P2. SITUACAO: ' || PCDSITUACAO);

        IF NOT HAFALHA THEN
          PCDSITUACAO   := 'RC';

    DBMS_OUTPUT.PUT_LINE( 'P21. SITUACAO: ' || PCDSITUACAO);

          VCDINTEGRACAO := 'TI_TIT_APB';
          BEGIN
            INSERT INTO TI_TIT_APB
              (COD_TITULO_AP,
               VAL_PER_DESC,
               COD_CART_BCIA,
               DAT_PROCESSAMENTO,
               COD_TIP_FLUXO_FINANC,
               CDN_FORNECEDOR,
               QTD_PARCELA,
               IND_TIPO_PESSOA,
               COD_SER_DOCTO,
               COD_PARCELA,
               VAL_DESCONTO,
               DES_TEXT_HISTOR,
               CDSITUACAO,
               COD_CCUSTO,
               COD_ID_FEDER_JURID,
               COD_ESPEC_DOCTO,
               DAT_EMISSAO,
               DAT_VENCTO,
               DAT_PREVISAO_PAGTO,
               DAT_DESCONTO,
               VAL_TITULO,
               NUM_DIAS_ATRASO,
               VAL_JUROS,
               VAL_PERC_JUROS_DIA_ATRASO,
               VAL_PERC_MULTA_ATRASO,
               COD_PORTADOR,
               COD_FORMA_PAGTO,
               COD_EMPRESA,
               COD_ESTAB,
               NRSEQ_CONTROLE_INTEGRACAO,
               COD_ID_FEDER,
               IND_OCORRENCIA,
               NRREGISTRO_TITULO,
               NRPESSOA,
               COD_PLANO_CCUSTO,
               COD_PLANO_CTA_CTBL)
              SELECT COD_TITULO_AP,
                     VAL_PER_DESC,
                     COD_CART_BCIA,
                     DAT_PROCESSAMENTO,
                     COD_TIP_FLUXO_FINANC,
                     CDFORNECEDOR_EMS5,
                     QTD_PARCELA,
                     IND_TIPO_PESSOA,
                     COD_SER_DOCTO,
                     COD_PARCELA,
                     VAL_DESCONTO,
                     DES_TEXT_HISTOR,
                     CDSITUACAO,
                     COD_CCUSTO,
                     COD_ID_FEDER COD_ID_FEDER_JURID,
                     COD_ESPEC_DOCTO,
                     DAT_EMISSAO,
                     DAT_VENCTO,
                     DAT_PREVISAO_PAGTO,
                     DAT_DESCONTO,
                     VAL_BRUTO,
                     NUM_DIAS_ATRASO,
                     VAL_JUROS,
                     VAL_PERC_JUROS_DIA_ATRASO,
                     VAL_PERC_MULTA_ATRASO,
                     COD_PORTADOR,
                     COD_FORMA_PAGTO,
                     COD_EMPRESA,
                     COD_ESTAB,
                     NRSEQ_CONTROLE_INTEGRACAO,
                     COD_ID_FEDER,
                     IND_OCORRENCIA,
                     NRREGISTRO_TITULO,
                     NRPESSOA,
                     COD_PLANO_CCUSTO,
                     COD_PLANO_CTA_CTBL
                FROM V_TI_TIT_APB TIT
               WHERE TIT.NRSEQ_CONTROLE_INTEGRACAO =
                     PNRSEQ_CONTROLE_INTEGRACAO;
    DBMS_OUTPUT.PUT_LINE( 'P22. SITUACAO: ' || PCDSITUACAO);
          EXCEPTION
--            WHEN DUP_VAL_ON_INDEX THEN
--    DBMS_OUTPUT.PUT_LINE( 'P23. SITUACAO: ' || PCDSITUACAO);
--              null; -- título já tratado
            WHEN OTHERS THEN
              RAISE_APPLICATION_ERROR(-20199, 'Erro -> ' || SQLERRM);
          END;
    DBMS_OUTPUT.PUT_LINE( 'P24. SITUACAO: ' || PCDSITUACAO);

          IF SQL%ROWCOUNT = 0 THEN

    DBMS_OUTPUT.PUT_LINE( 'P25. SITUACAO: ' || PCDSITUACAO);

            VAO_ACHOU_ERRO := FALSE;
            FOR L_TRATA_FALHA IN C_TRATA_FALHA LOOP

    DBMS_OUTPUT.PUT_LINE( 'P26. SITUACAO: ' || PCDSITUACAO);

              VAO_ACHOU_ERRO := TRUE;
              IF L_TRATA_FALHA.CDFORNECEDOR_EMS5 IS NULL THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              '(1) A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              'O Fornecedor [' ||
                              L_TRATA_FALHA.CDFORNECEDOR || '] ' ||
                              L_TRATA_FALHA.NOFORNECEDORUNICOO ||
                              ' no foi integrado para o EMS5',
                              PCDSITUACAO,
                              NULL);
              ELSIF L_TRATA_FALHA.CDEMPRESA IS NULL THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              '(2) A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              'A empresa do unicoo no foi informada para o titulo: ' ||
                              L_TRATA_FALHA.CDIDENTIFICADOR,
                              PCDSITUACAO,
                              NULL);
              ELSIF L_TRATA_FALHA.QTENDERECO IS NULL THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              '(3) A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              'O Fornecedor [' ||
                              L_TRATA_FALHA.CDFORNECEDOR || '] ' ||
                              L_TRATA_FALHA.NOFORNECEDORUNICOO ||
                              ' no foi integrado para o EMS5, o Fornecedor no possui endereo no Unicoo.',
                              PCDSITUACAO,
                              NULL);
              ELSIF L_TRATA_FALHA.NUM_TIP_MOVTO_TIT_APB = -1 THEN

                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'Verifique o De-Para do unicoo para o ems5 para o processo [' ||
                              L_TITULOS.NRSEQUENCIAL || ']',
                              --' Tipo de movimento no cadastrado em TI_TIPO_MOVIMENTO_TIT_ACR, parametros informados: '||
                              'Empresa [' || L_TRATA_FALHA.CDEMPRESA || ']' ||
                              ' Modulo [' || L_TRATA_FALHA.CDMODULO || ']' ||
                              ' Movimento [' ||
                              --RPAD(L_TRATA_FALHA.CDMOVIMENTO, 5, ' ') || ']' ||
                              L_TRATA_FALHA.CDMOVIMENTO || ']' ||
                              ' Grupo de Fornecedor EMS [' ||
                              L_TRATA_FALHA.COD_GRP_FORNEC || ']' ||
                              ' Divisao [' || l_trata_falha.cddivisao || ']' ||
                              ' Centro Custo [' || l_trata_falha.cdcentro_custo || ']' ||
                              ' Codigo do Fornecedor EMS [' ||
                              L_TRATA_FALHA.CDN_FORNECEDOR || ']' ||
                              ' Documento Unicoo [' ||
                              L_TITULOS.CDIDENTIFICADOR || ']' ||
                              ' Fornecedor Unicoo [' ||
                              L_TRATA_FALHA.CDFORNECEDOR || '] ' ||
                              L_TRATA_FALHA.NOFORNECEDORUNICOO,
                              PCDSITUACAO,
                              NULL);
              ELSE
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              '(4) A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              NULL,
                              PCDSITUACAO,
                              NULL);
              END IF;
            END LOOP;
            IF VAO_ACHOU_ERRO = FALSE THEN
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            '(5) A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL ||
                            '. Titulo ou Fornecedor no existe no Unicoo',
                            NULL,
                            PCDSITUACAO,
                            NULL);
            END IF;
    DBMS_OUTPUT.PUT_LINE( 'P27. SITUACAO: ' || PCDSITUACAO);

          ELSE
    DBMS_OUTPUT.PUT_LINE( 'P3. SITUACAO: ' || PCDSITUACAO);

            VALIDA_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO,
                           RFORNECEDOR.CDN_FORNECEDOR);
            VCDINTEGRACAO := 'TI_TIT_APB_CTBL';

    DBMS_OUTPUT.PUT_LINE( 'P4. SITUACAO: ' || PCDSITUACAO);

            -------------------------------------------------------------
            --- implementação Josias em 28-05-2014 em João Pessoa
            --- Processo para pegar a distribuição do titulo no unicoo.
            -------------------------------------------------------------
            BEGIN
              INSERT INTO TI_TIT_APB_CTBL CTB
                (COD_CTA_CTBL,
                 DAT_PROCESSAMENTO,
                 COD_ESTAB,
                 COD_TIP_FLUXO_FINANC,
                 COD_UNID_FEDERAC,
                 VAL_APROP_CTBL,
                 NRSEQ_CONTROLE_INTEGRACAO,
                 COD_CCUSTO,
                 CDSITUACAO)
              -- josias 30-06-2014
              -- falta tratar o problema do centro de custo nao esta
              -- cadastrado no plano de contas informado
                (SELECT --distinct
                        Y.COD_CTA_CTBL,
                        Y.DAT_PROCESSAMENTO,
                        Y.COD_ESTAB,
                        Y.COD_TIP_FLUXO_FINANC,
                        Y.COD_UNID_FEDERAC,
                        SUM(Y.VLDISTRIBUICAO),
                        Y.NRSEQ_CONTROLE_INTEGRACAO,
                        NVL((SELECT TO_CHAR(TCC.CD_CCUSTO_TOTVS)
                              FROM TI_CENTRO_CUSTO_CTBL_DEPARA TCC
                             WHERE TO_CHAR(TCC.CDCONTA) =
                                   (DECODE(Y.CDCENTRO_CUSTO,
                                           NULL,
                                           ' ',
                                           Y.CDCENTRO_CUSTO))),
                            DECODE(Y.CDCENTRO_CUSTO,
                                   NULL,
                                   ' ',
                                   Y.CDCENTRO_CUSTO)) CDCENTRO_CUSTO,
                        Y.CDSITUACAO
                   FROM (SELECT DISTINCT X.COD_CTA_CTBL,
                                         X.DAT_PROCESSAMENTO,
                                         X.COD_ESTAB,
                                         X.COD_TIP_FLUXO_FINANC,
                                         X.COD_UNID_FEDERAC,
                                         X.VLDISTRIBUICAO,
                                         X.NRSEQ_CONTROLE_INTEGRACAO,
                                         CASE
                                           WHEN X.TIPO_CCUSTO = '$T' THEN
                                            CASE
                                              WHEN F_TI_PARAMETRO_INTEGRACAO('AOUTILIZA_CODIGO_REDUZIDO') = 'N' THEN
                                               CC.CDCONTA
                                              ELSE
                                               TO_CHAR(X.CDCENTRO_CUSTO)
                                            END
                                           ELSE
                                            ' '
                                         END CDCENTRO_CUSTO,
                                         X.CDSITUACAO
                           FROM CONTA_CONTABIL CC,
                                (SELECT DISTINCT COD_CTA_CTBL,
                                                 DAT_PROCESSAMENTO,
                                                 COD_ESTAB,
                                                 COD_TIP_FLUXO_FINANC,
                                                 COD_UNID_FEDERAC,
                                                 --sum(nvl(decode(b.tipo_distrib,'V',b.vldistribuicao,(-1 * b.vldistribuicao)),ctb.val_aprop_ctbl)) vldistribuicao,     -- Alessandro 22/10/2014
                                                 --sum(b.vldistribuicao) vldistribuicao,      -- Alessandro 22/10/2014
                                                 -- alterado vinicius 31/12/2014
                                                 case
                                                   when f_ti_parametro_integracao('INTEGRA_VALOR_LIQUIDO_TIT_APB') = 'S' then
                                                     sum(ctb.val_aprop_ctbl)
                                                   else
                                                     CASE
                                                       WHEN B.CDHISTORICO IN
                                                            (F_TI_PARAMETRO_INTEGRACAO('HISTORICO_COM_VALOR_LIQUIDO_APB')) THEN
                                                        (SELECT SUM(VLDISTRIBUICAO)
                                                           FROM DISTRIBUICAO_TITULO_PAGAR DTP
                                                          WHERE DTP.NRREGISTRO_TITULO =
                                                                B.NRREGISTRO_TITULO
                                                            AND DTP.TIPO_DISTRIB = 'V') -
                                                        NVL((SELECT SUM(VLDISTRIBUICAO)
                                                              FROM DISTRIBUICAO_TITULO_PAGAR DTP
                                                             WHERE DTP.NRREGISTRO_TITULO =
                                                                   B.NRREGISTRO_TITULO
                                                               AND DTP.TIPO_DISTRIB = 'D'),
                                                            0)
                                                       ELSE
                                                        SUM(B.VLDISTRIBUICAO)
                                                    end
                                                 END VLDISTRIBUICAO,
                                                 NRSEQ_CONTROLE_INTEGRACAO,
                                                 CTB.CDSITUACAO,
                                                 CASE
                                                   WHEN B.CDCENTRO_CUSTO IS NULL THEN
                                                    CTB.COD_CCUSTO
                                                   ELSE
                                                    TO_CHAR(B.CDCENTRO_CUSTO)
                                                 END CDCENTRO_CUSTO,
                                                 CTB.COD_CCUSTO,
                                                 CTB.TIPO_CCUSTO
                                   FROM V_TI_TIT_APB_CTBL         CTB,
                                        DISTRIBUICAO_TITULO_PAGAR B
                                  WHERE CTB.NRREGISTRO_TITULO =
                                        B.NRREGISTRO_TITULO(+)
                                    AND NRSEQ_CONTROLE_INTEGRACAO =
                                        PNRSEQ_CONTROLE_INTEGRACAO
                                    AND B.TIPO_DISTRIB = 'V' -- ALessandro 22/10/2014
                                 /*group by cod_cta_ctbl,
                                 dat_processamento,
                                 cod_estab,
                                 cod_tip_fluxo_financ,
                                 cod_unid_federac,
                                 nrseq_controle_integracao,
                                 b.cdcentro_custo,
                                 ctb.cod_ccusto,
                                 ctb.tipo_ccusto,
                                 ctb.cdsituacao*/
                                  GROUP BY COD_CTA_CTBL,
                                           DAT_PROCESSAMENTO,
                                           CDHISTORICO,
                                           B.NRREGISTRO_TITULO,
                                           COD_ESTAB,
                                           COD_TIP_FLUXO_FINANC,
                                           COD_UNID_FEDERAC,
                                           NRSEQ_CONTROLE_INTEGRACAO,
                                           B.CDCENTRO_CUSTO,
                                           CTB.COD_CCUSTO,
                                           CTB.TIPO_CCUSTO,
                                           CTB.CDSITUACAO) X
                          WHERE X.CDCENTRO_CUSTO = CC.NRCONTA_REDUZIDA(+)
                            AND CC.NRPLANO_CONTAS(+) =
                                F_TI_PARAMETRO_INTEGRACAO('NRPLANO_CENTRO_CUSTO_UNICOO')
                            and rownum = 1) Y
                  GROUP BY Y.COD_CTA_CTBL,
                           Y.DAT_PROCESSAMENTO,
                           Y.COD_ESTAB,
                           Y.COD_TIP_FLUXO_FINANC,
                           Y.COD_UNID_FEDERAC,
                           Y.NRSEQ_CONTROLE_INTEGRACAO,
                           Y.CDCENTRO_CUSTO,
                           Y.CDSITUACAO);
            EXCEPTION
              WHEN DUP_VAL_ON_INDEX THEN
                NULL;
              --WHEN OTHERS THEN
                -- Josias 26-06-2014 - colocado essa exceção para acompanhar erro
                --RAISE_APPLICATION_ERROR(-20100, ' Erro -> ' || SQLERRM);
                --NULL;
            END;
            IF SQL%ROWCOUNT = 0 THEN
              P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                            VCDINTEGRACAO,
                            'A view v_TI_TIT_APB_CTBL não encontrou registro para o processo ==>' ||
                            PNRSEQ_CONTROLE_INTEGRACAO,
                            NULL,
                            PCDSITUACAO,
                            NULL);
            ELSE
              vcdintegracao := 'TI_TIT_APB_IMPOSTO';
              insert into ti_tit_apb_imposto
                (cod_ser_docto,
                 ind_clas_impto,
                 val_impto_ja_recolhid,
                 val_outras_deduc_impto,
                 cod_titulo_ap,
                 val_rendto_tribut,
                 val_aliq_impto,
                 val_deduc_faixa_imto,
                 cod_estab,
                 cod_espec_docto,
                 cod_parcela,
                 cod_unid_federac,
                 cod_imposto,
                 cod_classif_impto,
                 val_deduc_inss,
                 val_deduc_depend,
                 val_deduc_pensao,
                 val_deduc_outras_deduc,
                 val_base_liq_impto,
                 val_imposto,
                 dat_vencto,
                 des_text_histor,
                 dat_processamento,
                 cdsituacao,
                 val_deduc_faixa_impto,
                 cod_cta_ctbl,
                 nrseq_controle_integracao,
                 cod_plano_ctb_cbtl,
                 ind_ocorrencia,
                 cod_tip_fluxo_financ)

                select cod_ser_docto,
                       ind_clas_impto,
                       val_impto_ja_recolhid,
                       val_outras_deduc_impto,
                       substr(cod_titulo_ap, 0, 10),
                       val_rendto_tribut,
                       val_aliq_impto,
                       val_deduc_faixa_imto,
                       cod_estab,
                       cod_espec_docto,
                       cod_parcela,
                       cod_unid_federac,
                       cod_imposto,
                       cod_classif_impto,
                       val_deduc_inss,
                       val_deduc_depend,
                       val_deduc_pensao,
                       val_deduc_outras_deduc,
                       val_base_liq_impto,
                       val_imposto,
                       dat_vencto,
                       des_text_histor,
                       dat_processamento,
                       cdsituacao,
                       val_deduc_faixa_impto,
                       cod_cta_ctbl,
                       nrseq_controle_integracao,
                       cod_plano_ctb_cbtl,
                       ind_ocorrencia,
                       cod_tip_fluxo_financ
                  from v_ti_tit_apb_imposto ip
                 where ip.nrseq_controle_integracao =
                       pnrseq_controle_integracao;
            END IF;
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN

    DBMS_OUTPUT.PUT_LINE( 'P5. SITUACAO: ' || PCDSITUACAO);

          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        SQLERRM,
                        NULL,
                        PCDSITUACAO,
                        NULL);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        SQLERRM,
                        NULL,
                        PCDSITUACAO,
                        NULL);
      END;

    DBMS_OUTPUT.PUT_LINE( 'P6. SITUACAO: ' || PCDSITUACAO);

      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_TITULOS.NRSEQUENCIAL,
                                   PCDSITUACAO,
                                   NULL);
      begin
        update ti_tit_apb tp set tp.cdsituacao = PCDSITUACAO
         where tp.nrseq_controle_integracao = l_titulos.nrsequencial;
      exception
        when others then
          null;
      end;

    DBMS_OUTPUT.PUT_LINE( 'P7. SITUACAO: ' || PCDSITUACAO);

    END LOOP;

    DBMS_OUTPUT.PUT_LINE( 'P8. SITUACAO: ' || PCDSITUACAO);

  END P_TI_TIT_APB;

  --===================================================================--
  -- P_MIGRA_VENDEDORES -> Migracao dos Vendedores como Representantes --
  -----------------------------------------------------------------------
  /*FUNCTION F_MIGRA_VENDEDORES RETURN VARCHAR2 IS
    vretorno varchar2(10);
  begin
    p_migra_vendedores(vretorno);
    return 'OK';
  END F_MIGRA_VENDEDORES;
  */
  procedure resetar_sequence( p_seq_name in varchar2 )
  is
      l_val number;
  begin
      execute immediate
      'select ' || p_seq_name || '.nextval from dual' INTO l_val;

      execute immediate
      'alter sequence ' || p_seq_name || ' increment by -' || l_val ||
                                                            ' minvalue 0';

      execute immediate
      'select ' || p_seq_name || '.nextval from dual' INTO l_val;

      execute immediate
      'alter sequence ' || p_seq_name || ' increment by 1 minvalue 0';
  end resetar_sequence;

  procedure P_MIGRA_VENDEDORES is
    vnum_pessoa number := 0;
  begin

--    pretorno := 'OK';
    /*limpar registros pre-existentes no TOTVS antes do processamento*/
    for x in (select r.u##cod_empresa, r.cdn_repres, r.num_pessoa from ems5.representante r) loop
      /* manter pessoas para nao gerar nova sequencia em NUM_PESSOA
      delete from ems5.pessoa_fisic pf where pf.num_pessoa_fisic = x.num_pessoa
                                         and not exists(select 1 from ems5.cliente c where c.num_pessoa = x.num_pessoa)
                                         and not exists(select 1 from ems5.fornecedor f where f.num_pessoa = x.num_pessoa);

      delete from ems5.pessoa_jurid pj where pj.num_pessoa_jurid = x.num_pessoa
                                         and not exists(select 1 from ems5.cliente c where c.num_pessoa = x.num_pessoa)
                                         and not exists(select 1 from ems5.fornecedor f where f.num_pessoa = x.num_pessoa)
                                         and not exists(select 1 from ems5.estabelecimento e where e.num_pessoa_jurid = x.num_pessoa);
      */
      delete from ems5.repres_financ rf where rf.u##cod_empresa = x.u##cod_empresa and rf.cdn_repres = x.cdn_repres;

      delete from ems5.representante r where r.u##cod_empresa = x.u##cod_empresa and r.cdn_repres = x.cdn_repres;

    end loop;

    resetar_sequence('ems5.representante_seq');
    resetar_sequence('ems5.repres_financ_seq');

    for vend in (select p.NRREGISTRO,
                        p.NOPESSOA,
                        p.TPPESSOA,
                        p.NRCGC_CPF,
                        p.NRINSCEST_RG,
                        p.CDRAMOATIV,
                        p.DTNASCIMENTO,
                        p.CDSEXO,
                        p.CDESTADOCIVIL,
                        p.NOMAE,
                        p.NRREG_NASCTO,
                        p.NOCARTORIO_REG,
                        p.TXOBSERVACOES,
                        p.NOOPERADOR,
                        p.NONATURALIDADE,
                        p.CDNACIONALIDADE,
                        p.NOORGAO_EMISSOR_RG,
                        p.NRINSCMUN,
                        p.NRCEI,
                        p.NRCARTAO_CONVENIO,
                        p.NOABREVIADO,
                        p.CDPAIS_EMISSOR_ID,
                        p.DTEXPEDICAO_RG,
                        p.CDESTADO_EMISSOR_RG,
                        p.CDCIDADE_NATURALIDADE,
                        e.TPENDERECO,
                        e.NOLOGRADOURO,
                        e.NRIMOVEL,
                        e.TXCOMPLEMENTO,
                        e.NOBAIRRO,
                        e.CDCIDADE,
                        e.CDESTADO,
                        e.NRCEP,
                        e.NRTELEFONE,
                        e.NRFAX,
                        e.CDEMAIL,
                        e.NRDDD,
                        e.CDEMAIL_ADICIONAL,
                        c.nocidade,
                        v.*
                   from vendedor                        v,
                        pessoa                          p,
                        endereco                        e,
                        producao.cidade@unicoo_homologa c
                  where p.nrregistro = v.nrregistro_pessoa
                    and e.nrregistro(+) = p.nrregistro
                    and c.cdcidade(+) = e.cdcidade
                  order by 1) loop
      if vend.tppessoa = 'F' then

        /* verificar se a pessoa ja existe */
        vnum_pessoa := 0;
        begin
          select nvl(pf.num_pessoa_fisic,'0') into vnum_pessoa
            from ems5.pessoa_fisic pf
           where pf.u##nom_pessoa = upper(vend.nopessoa)
             and pf.U##COD_ID_ESTAD_FISIC = ' '
             and pf.U##CODUNIDFEDERACEMISESTAD = ' '
             and pf.DAT_NASC_PESSOA_FISIC = vend.dtnascimento
             and pf.U##NOM_MAE_PESSOA = upper(vend.nomae)
             and pf.u##cod_id_feder = vend.nrcgc_cpf
             and rownum = 1;
        exception
          when others then
            vnum_pessoa := 0;
        end;

        if vnum_pessoa = 0 then
          select ems5.seq_pessoa_fisica.nextval into vnum_pessoa from dual;

          begin
            insert into pessoa_fisic
              (NUM_PESSOA_FISIC,
               U##NOM_PESSOA,
               NOM_PESSOA,
               U##COD_ID_FEDER,
               COD_ID_FEDER,
               U##COD_ID_ESTAD_FISIC,
               COD_ID_ESTAD_FISIC,
               CODORGAOEMISIDESTAD,
               U##CODUNIDFEDERACEMISESTAD,
               CODUNIDFEDERACEMISESTAD,
               NOM_ENDERECO,
               NOM_ENDER_COMPL,
               NOM_BAIRRO,
               NOM_CIDADE,
               NOM_CONDADO,
               U##COD_PAIS,
               COD_PAIS,
               U##COD_UNID_FEDERAC,
               COD_UNID_FEDERAC,
               COD_CEP,
               COD_CX_POST,
               COD_TELEFONE,
               COD_RAMAL,
               COD_FAX,
               COD_RAMAL_FAX,
               COD_TELEX,
               COD_MODEM,
               COD_RAMAL_MODEM,
               COD_E_MAIL,
               DAT_NASC_PESSOA_FISIC,
               COD_PAIS_NASC,
               COD_UNID_FEDERAC_NASC,
               DES_ANOT_TAB,
               COD_USUAR_ULT_ATUALIZ,
               DAT_ULT_ATUALIZ,
               HRA_ULT_ATUALIZ,
               U##NOM_MAE_PESSOA,
               NOM_MAE_PESSOA,
               COD_IMAGEM,
               LOG_EMS_20_ATLZDO,
               COD_LIVRE_1,
               LOG_LIVRE_1,
               NUM_LIVRE_1,
               VAL_LIVRE_1,
               DAT_LIVRE_1,
               IND_TIP_PESSOA_FISIC,
               NOMNACIONPESSOAFISIC,
               NOMPROFISPESSOAFISIC,
               INDESTADOCIVILPESSOA,
               NOM_HOME_PAGE,
               NOM_ENDER_TEXT,
               LOG_ENVIO_BCO_HISTOR,
               COD_LIVRE_2,
               DAT_LIVRE_2,
               LOG_LIVRE_2,
               NUM_LIVRE_2,
               VAL_LIVRE_2,
               COD_E_MAIL_COBR,
               NUM_PESSOA_FISIC_COBR,
               NOM_ENDER_COBR,
               NOM_ENDER_COMPL_COBR,
               NOM_BAIRRO_COBR,
               COD_UNID_FEDERAC_COBR,
               NOM_CIDAD_COBR,
               NOM_CONDAD_COBR,
               COD_PAIS_COBR,
               COD_CEP_COBR,
               COD_CX_POST_COBR,
               NOM_ENDER_COBR_TEXT,
               COD_SUB_REGIAO_VENDAS,
               CDD_VERSION,
               LOG_REPLIC_PESSOA_HCM,
               LOG_REPLIC_PESSOA_CRM,
               LOG_REPLIC_PESSOA_GPS,
               NUMPESSOAFISICMATRIZ,
               COD_FAX_2,
               COD_RAMAL_FAX_2,
               COD_TELEF_2,
               COD_RAMAL_2,
               IND_TIP_ID_ESTAD,
               IND_TIP_MATRIZ,
               PROGRESS_RECID)
            values
              (vnum_pessoa,
               upper(vend.nopessoa), --U##NOM_PESSOA,
               vend.nopessoa, --NOM_PESSOA,
               vend.nrcgc_cpf, --U##COD_ID_FEDER,
               vend.nrcgc_cpf, --COD_ID_FEDER,
               ' ', --U##COD_ID_ESTAD_FISIC,
               ' ', --COD_ID_ESTAD_FISIC,
               ' ', --CODORGAOEMISIDESTAD,
               ' ', --U##CODUNIDFEDERACEMISESTAD,
               ' ', --CODUNIDFEDERACEMISESTAD,
               nvl(trim(vend.nologradouro) ||
                   decode(vend.nrimovel, null, '', ' ' || vend.nrimovel),
                   'NAO INFORMADO'), --NOM_ENDERECO,
               nvl(case when length(vend.txcomplemento) <= 10 then
                   vend.txcomplemento when
                   length(vend.txcomplemento) > 10 and
                   length(f_reduz_compl(vend.txcomplemento, 0)) <= 10 then
                   f_reduz_compl(vend.txcomplemento, 0) else
                   substr(f_reduz_compl(vend.txcomplemento, 0), 1, 10) end,
                   ' '), --NOM_ENDER_COMPL,
               nvl(case when length(vend.nobairro) <= 20 then vend.nobairro when
                   length(vend.nobairro) > 20 and
                   length(f_reduz_bairro(vend.nobairro, 0)) <= 20 then
                   f_reduz_bairro(vend.nobairro, 0) else
                   substr(f_reduz_bairro(vend.nobairro, 0), 1, 20) end,
                   'NAO INFORMADO'), --NOM_BAIRRO,
               nvl(vend.nocidade, 'NAO INFORMADO'), --NOM_CIDADE,
               ' ', --NOM_CONDADO,
               'BRA', --U##COD_PAIS,
               'BRA', --COD_PAIS,
               nvl(vend.cdestado, 'RJ'), --U##COD_UNID_FEDERAC,
               nvl(vend.cdestado, 'RJ'), --COD_UNID_FEDERAC,
               nvl(vend.nrcep,
                   f_ti_parametro_integracao('NRCEP_DEFAULT_INCLUSAO')), --COD_CEP,
               ' ', --COD_CX_POST,
               nvl(vend.nrtelefone, ' '), --COD_TELEFONE,
               ' ', --COD_RAMAL,
               vend.nrfax, --COD_FAX,
               ' ', --COD_RAMAL_FAX,
               ' ', --COD_TELEX,
               ' ', --COD_MODEM,
               ' ', --COD_RAMAL_MODEM,
               nvl(vend.cdemail, vend.cdemail_adicional), --COD_E_MAIL,
               vend.dtnascimento, --DAT_NASC_PESSOA_FISIC,
               ' ', --COD_PAIS_NASC,
               ' ', --COD_UNID_FEDERAC_NASC,
               ' ', --DES_ANOT_TAB,
               'migracao', --COD_USUAR_ULT_ATUALIZ,
               sysdate, --DAT_ULT_ATUALIZ,
               ' ', --HRA_ULT_ATUALIZ,
               upper(vend.nomae), --U##NOM_MAE_PESSOA,
               vend.nomae, --NOM_MAE_PESSOA,
               ' ', --COD_IMAGEM,
               0, --LOG_EMS_20_ATLZDO,
               ' ', --COD_LIVRE_1,
               0, --LOG_LIVRE_1,
               0, --NUM_LIVRE_1,
               0, --VAL_LIVRE_1,
               sysdate, --DAT_LIVRE_1,
               ' ', --IND_TIP_PESSOA_FISIC,
               ' ', --NOMNACIONPESSOAFISIC,
               ' ', --NOMPROFISPESSOAFISIC,
               decode(vend.cdestadocivil,
                      'C',
                      'CASADO',
                      'S',
                      'SOLTEIRO',
                      'V',
                      'VIUVO',
                      'D',
                      'DIVORCIADO',
                      'Q',
                      'DIVORCIADO',
                      'OUTROS'), --INDESTADOCIVILPESSOA,
               ' ', --NOM_HOME_PAGE,
               ' ', --NOM_ENDER_TEXT,
               0, --LOG_ENVIO_BCO_HISTOR,
               ' ', --COD_LIVRE_2,
               null, --DAT_LIVRE_2,
               0, --LOG_LIVRE_2,
               0, --NUM_LIVRE_2,
               0, --VAL_LIVRE_2,
               ' ', --COD_E_MAIL_COBR,
               0, --NUM_PESSOA_FISIC_COBR,
               trim(vend.nologradouro) ||
               decode(vend.nrimovel, null, '', ' ' || vend.nrimovel), --NOM_ENDER_COBR,
               case when length(vend.txcomplemento) <= 10 then
               vend.txcomplemento when
               length(vend.txcomplemento) > 10 and
               length(f_reduz_compl(vend.txcomplemento, 0)) <= 10 then
               f_reduz_compl(vend.txcomplemento, 0) else
               substr(f_reduz_compl(vend.txcomplemento, 0), 1, 10) end, --NOM_ENDER_COMPL_COBR,
               case when length(vend.nobairro) <= 20 then vend.nobairro when
               length(vend.nobairro) > 20 and
               length(f_reduz_bairro(vend.nobairro, 0)) <= 20 then
               f_reduz_bairro(vend.nobairro, 0) else
               substr(f_reduz_bairro(vend.nobairro, 0), 1, 20) end, --NOM_BAIRRO_COBR,
               nvl(vend.cdestado, 'RJ'), --COD_UNID_FEDERAC_COBR,
               nvl(vend.nocidade, 'NAO INFORMADO'), --NOM_CIDAD_COBR,
               ' ', --NOM_CONDADO_COBR,
               'BRA', --COD_PAIS_COBR,
               nvl(vend.nrcep,
                   f_ti_parametro_integracao('NRCEP_DEFAULT_INCLUSAO')), --COD_CEP_COBR,
               ' ', --COD_CX_POST_COBR,
               ' ', --NOM_ENDER_COBR_TEXT,
               ' ', --COD_SUB_REGIAO_VENDAS,
               0, --CDD_VERSION,
               '1', --LOG_REPLIC_PESSOA_HCM,
               '1', --LOG_REPLIC_PESSOA_CRM,
               '1', --LOG_REPLIC_PESSOA_GPS,
               vnum_pessoa, --NUMPESSOAFISICMATRIZ,
               ' ', --COD_FAX_2,
               ' ', --COD_RAMAL_FAX_2,
               ' ', --COD_TELEF_2,
               ' ', --COD_RAMAL_2,
               'Inscrição Estadual', --IND_TIP_ID_ESTAD,
               'Física', --IND_TIP_MATRIZ,
               ems5.pessoa_fisic_seq.nextval --PROGRESS_RECID
               );

          exception
            when DUP_VAL_ON_INDEX then null;
          end;
        end if;
      else
        /* verificar se a pessoa ja existe */
        vnum_pessoa := 0;
        begin
          select nvl(pj.num_pessoa_jurid,'0') into vnum_pessoa
            from ems5.pessoa_jurid pj
           where pj.u##cod_id_feder = vend.nrcgc_cpf
             and pj.u##nom_pessoa = upper(vend.nopessoa)
             and rownum = 1;
        exception
          when others then
            vnum_pessoa := 0;
        end;

        if vnum_pessoa = 0 then
          select ems5.seq_pessoa_juridica.nextval into vnum_pessoa from dual;

          begin
              insert into pessoa_jurid
                (NUM_PESSOA_JURID,
                 U##NOM_PESSOA,
                 NOM_PESSOA,
                 U##COD_ID_FEDER,
                 COD_ID_FEDER,
                 COD_ID_ESTAD_JURID,
                 COD_ID_MUNIC_JURID,
                 U##COD_ID_PREVID_SOCIAL,
                 COD_ID_PREVID_SOCIAL,
                 LOG_FINS_LUCRAT,
                 NUMPESSOAJURIDMATRIZ,
                 NOM_ENDERECO,
                 NOM_ENDER_COMPL,
                 NOM_BAIRRO,
                 NOM_CIDADE,
                 NOM_CONDADO,
                 U##COD_PAIS,
                 COD_PAIS,
                 U##COD_UNID_FEDERAC,
                 COD_UNID_FEDERAC,
                 COD_CEP,
                 COD_CX_POST,
                 COD_TELEFONE,
                 COD_FAX,
                 COD_RAMAL_FAX,
                 COD_TELEX,
                 COD_MODEM,
                 COD_RAMAL_MODEM,
                 COD_E_MAIL,
                 COD_E_MAIL_COBR,
                 NUM_PESSOA_JURID_COBR,
                 NOM_ENDER_COBR,
                 NOM_ENDER_COMPL_COBR,
                 NOM_BAIRRO_COBR,
                 NOM_CIDAD_COBR,
                 NOM_CONDAD_COBR,
                 U##COD_UNID_FEDERAC_COBR,
                 COD_UNID_FEDERAC_COBR,
                 U##COD_PAIS_COBR,
                 COD_PAIS_COBR,
                 COD_CEP_COBR,
                 COD_CX_POST_COBR,
                 NUM_PESSOA_JURID_PAGTO,
                 NOM_ENDER_PAGTO,
                 NOM_ENDER_COMPL_PAGTO,
                 NOM_BAIRRO_PAGTO,
                 NOM_CIDAD_PAGTO,
                 NOM_CONDAD_PAGTO,
                 U##COD_PAIS_PAGTO,
                 COD_PAIS_PAGTO,
                 U##COD_UNID_FEDERAC_PAGTO,
                 COD_UNID_FEDERAC_PAGTO,
                 COD_CEP_PAGTO,
                 COD_CX_POST_PAGTO,
                 DES_ANOT_TAB,
                 IND_TIP_PESSOA_JURID,
                 INDTIPCAPITPESSOAJURID,
                 COD_USUAR_ULT_ATUALIZ,
                 DAT_ULT_ATUALIZ,
                 HRA_ULT_ATUALIZ,
                 COD_IMAGEM,
                 LOG_EMS_20_ATLZDO,
                 COD_LIVRE_1,
                 LOG_LIVRE_1,
                 NUM_LIVRE_1,
                 VAL_LIVRE_1,
                 DAT_LIVRE_1,
                 NOM_HOME_PAGE,
                 NOM_ENDER_TEXT,
                 NOM_ENDER_COBR_TEXT,
                 NOM_ENDER_PAGTO_TEXT,
                 LOG_ENVIO_BCO_HISTOR,
                 COD_LIVRE_2,
                 DAT_LIVRE_2,
                 LOG_LIVRE_2,
                 NUM_LIVRE_2,
                 VAL_LIVRE_2,
                 IND_NATUR_PESSOA_JURID,
                 NOM_FANTASIA,
                 COD_SUB_REGIAO_VENDAS,
                 CDD_VERSION,
                 LOG_REPLIC_PESSOA_HCM,
                 LOG_REPLIC_PESSOA_CRM,
                 LOG_REPLIC_PESSOA_GPS,
                 COD_FAX_2,
                 COD_RAMAL_FAX_2,
                 COD_TELEF_2,
                 COD_RAMAL_2,
                 IND_TIP_MATRIZ,
                 PROGRESS_RECID)
              values
                (vnum_pessoa, --NUM_PESSOA_JURID
                 upper(vend.nopessoa), --U##NOM_PESSOA,
                 vend.nopessoa, --NOM_PESSOA,
                 vend.nrcgc_cpf, --U##COD_ID_FEDER,
                 vend.nrcgc_cpf, --COD_ID_FEDER,
                 ' ', --U##COD_ID_ESTAD_FISIC,
                 ' ', --COD_ID_ESTAD_FISIC,
                 ' ', --U##COD_ID_PREVID_SOCIAL,
                 ' ', --COD_ID_PREVID_SOCIAL,
                 0, --LOG_FINS_LUCRAT,
                 0, --NUMPESSOAJURIDMATRIZ
                 nvl(trim(vend.nologradouro) ||
                     decode(vend.nrimovel, null, '', ' ' || vend.nrimovel),
                     'NAO INFORMADO'), --NOM_ENDERECO,
                 nvl(case when length(vend.txcomplemento) <= 10 then
                     vend.txcomplemento when
                     length(vend.txcomplemento) > 10 and
                     length(f_reduz_compl(vend.txcomplemento, 0)) <= 10 then
                     f_reduz_compl(vend.txcomplemento, 0) else
                     substr(f_reduz_compl(vend.txcomplemento, 0), 1, 10) end,
                     ' '), --NOM_ENDER_COMPL,
                 nvl(case when length(vend.nobairro) <= 20 then vend.nobairro when
                     length(vend.nobairro) > 20 and
                     length(f_reduz_bairro(vend.nobairro, 0)) <= 20 then
                     f_reduz_bairro(vend.nobairro, 0) else
                     substr(f_reduz_bairro(vend.nobairro, 0), 1, 20) end,
                     'NAO INFORMADO'), --NOM_BAIRRO,
                 nvl(vend.nocidade, 'NAO INFORMADO'), --NOM_CIDADE,
                 ' ', --NOM_CONDADO,
                 'BRA', --U##COD_PAIS,
                 'BRA', --COD_PAIS,
                 nvl(vend.cdestado, 'RJ'), --U##COD_UNID_FEDERAC,
                 nvl(vend.cdestado, 'RJ'), --COD_UNID_FEDERAC,
                 nvl(vend.nrcep,
                     f_ti_parametro_integracao('NRCEP_DEFAULT_INCLUSAO')), --COD_CEP,
                 ' ', --COD_CX_POST,
                 nvl(vend.nrtelefone, ' '), --COD_TELEFONE,
                 nvl(vend.nrfax, 0), --COD_FAX,
                 ' ', --COD_RAMAL_FAX,
                 ' ', --COD_TELEX,
                 ' ', --COD_MODEM,
                 ' ', --COD_RAMAL_MODEM,
                 nvl(nvl(vend.cdemail, vend.cdemail_adicional), ' '), --COD_E_MAIL,
                 ' ', --COD_E_MAIL_COBR,
                 0, --NUMPESSOA_COBR
                 nvl(trim(vend.nologradouro) ||
                     decode(vend.nrimovel, null, '', ' ' || vend.nrimovel),
                     'NAO INFORMADO'), --NOM_ENDERECO_COBR,
                 nvl(case when length(vend.txcomplemento) <= 10 then
                     vend.txcomplemento when
                     length(vend.txcomplemento) > 10 and
                     length(f_reduz_compl(vend.txcomplemento, 0)) <= 10 then
                     f_reduz_compl(vend.txcomplemento, 0) else
                     substr(f_reduz_compl(vend.txcomplemento, 0), 1, 10) end,
                     ' '), --NOM_ENDER_COMPL_COBR,
                 nvl(case when length(vend.nobairro) <= 20 then vend.nobairro when
                     length(vend.nobairro) > 20 and
                     length(f_reduz_bairro(vend.nobairro, 0)) <= 20 then
                     f_reduz_bairro(vend.nobairro, 0) else
                     substr(f_reduz_bairro(vend.nobairro, 0), 1, 20) end,
                     'NAO INFORMADO'), --NOM_BAIRRO_COBR,
                 nvl(vend.nocidade, 'NAO INFORMADO'), --NOM_CIDADE_COBR,
                 ' ', --NOM_CONDADO_COBR,
                 nvl(vend.cdestado, 'RJ'), --U##COD_UNID_FEDERAC_COBR,
                 nvl(vend.cdestado, 'RJ'), --COD_UNID_FEDERAC_COBR,
                 'BRA', --U##COD_PAIS_COBR,
                 'BRA', --COD_PAIS_COBR,
                 nvl(vend.nrcep,
                     f_ti_parametro_integracao('NRCEP_DEFAULT_INCLUSAO')), --COD_CEP_COBR,
                 ' ', --COD_CX_POST_COBR,
                 0, --NUMPESSOA_PAGTO
                 nvl(trim(vend.nologradouro) ||
                     decode(vend.nrimovel, null, '', ' ' || vend.nrimovel),
                     'NAO INFORMADO'), --NOM_ENDERECO_PAGTO,
                 nvl(case when length(vend.txcomplemento) <= 10 then
                     vend.txcomplemento when
                     length(vend.txcomplemento) > 10 and
                     length(f_reduz_compl(vend.txcomplemento, 0)) <= 10 then
                     f_reduz_compl(vend.txcomplemento, 0) else
                     substr(f_reduz_compl(vend.txcomplemento, 0), 1, 10) end,
                     ' '), --NOM_ENDER_COMPL_PAGTO,
                 nvl(case when length(vend.nobairro) <= 20 then vend.nobairro when
                     length(vend.nobairro) > 20 and
                     length(f_reduz_bairro(vend.nobairro, 0)) <= 20 then
                     f_reduz_bairro(vend.nobairro, 0) else
                     substr(f_reduz_bairro(vend.nobairro, 0), 1, 20) end,
                     'NAO INFORMADO'), --NOM_BAIRRO_PAGTO,
                 nvl(vend.nocidade, 'NAO INFORMADO'), --NOM_CIDADE_PAGTO,
                 ' ', --NOM_CONDADO_PAGTO,
                 'BRA', --U##COD_PAIS_PAGTO,
                 'BRA', --COD_PAIS_PAGTO,
                 nvl(vend.cdestado, 'RJ'), --U##COD_UNID_FEDERAC_PAGTO,
                 nvl(vend.cdestado, 'RJ'), --COD_UNID_FEDERAC_PAGTO,
                 nvl(vend.nrcep,
                     f_ti_parametro_integracao('NRCEP_DEFAULT_INCLUSAO')), --COD_CEP_PAGTO,
                 ' ', --COD_CX_POST_PAGTO,
                 ' ', --DES_ANOT_TAB,
                 ' ', --IND_TIP_PESSOA_FISIC,
                 0, --INDTIPCAPITPESSOAJURID
                 'migracao', --COD_USUAR_ULT_ATUALIZ,
                 sysdate, --DAT_ULT_ATUALIZ,
                 ' ', --HRA_ULT_ATUALIZ,
                 ' ', --COD_IMAGEM
                 0, --LOG_EMS_20_ATLZDO
                 NULL, --COD_LIVRE_1
                 0, --LOG_LIVRE_1
                 0, --NUM_LIVRE_1
                 0, --VAL_LIVRE_1
                 SYSDATE, --DAT_LIVRE_1
                 ' ', --NOM_HOME_PAGE
                 ' ', --NOM_ENDER_TEXT
                 ' ', --NOM_ENDER_COBR_TEXT
                 ' ', --NOM_ENDER_PAGTO_TEXT
                 0, --LOG_ENVIO_BCO_HISTOR
                 ' ', --COD_LIVRE_2
                 NULL, --DAT_LIVRE_2
                 0, --LOG_LIVRE_2
                 0, --NUM_LIVRE_2
                 0, --VAL_LIVRE_2
                 'Nacional', --IND_NATUR_PESSOA_JURID
                 ' ', --NOM_FANTASIA
                 ' ', --COD_SUB_REGIAO_VENDAS
                 0, --CDD_VERSION
                 '1', --LOG_REPLIC_PESSOA_HCM
                 '1', --LOG_REPLIC_PESSOA_CRM
                 '1', --LOG_REPLIC_PESSOA_GPS
                 ' ', --COD_FAX_2
                 ' ', --COD_RAMAL_FAX_2
                 ' ', --COD_TELEF_2
                 ' ', --COD_RAMAL_2
                 'Jurídica', --IND_TIP_MATRIZ
                 ems5.pessoa_jurid_seq.nextval --PROGRESS_RECID
                 );
          exception
            when DUP_VAL_ON_INDEX then null;
          end;
        end if;
      end if;

      begin    
        insert into REPRESENTANTE
        values
          (1,
           1,
           vend.cdvendedor,
           vnum_pessoa,
           vend.nopessoa,
           upper(f_abrevia_nome(vend.nopessoa, 23, 'PEA')) || vend.nrregistro,
           f_abrevia_nome(vend.nopessoa, 23, 'PEA') || vend.nrregistro,
           'BRA',
           vend.nrcgc_cpf,
           999,
           999,
           sysdate,
           ' ',
           ' ',
           ' ',
           0,
           0,
           0,
           null,
           'Ativo',
           null,
           ' ',
           null,
           0,
           0,
           0,
           0,
           ems5.representante_seq.nextval);
      exception
        when DUP_VAL_ON_INDEX then null;
      end;

      begin                      
          insert into REPRES_FINANC
          values
            (1,
             1,
             vend.cdvendedor,
             0,
             0,
             0,
             0,
             0,
             0,
             0,
             0,
             0,
             999,
             999,
             ' ',
             ' ',
             ' ',
             'Pagamento',
             0,
             ' ',
             0,
             0,
             0,
             sysdate,
             'UN',
             0,
             0,
             ' ',
             0,
             'Nenhum',
             ' ',
             null,
             0,
             0,
             0,
             0,
             'PADRAO',
             0,
             ems5.repres_financ_seq.nextval);
        exception
          when DUP_VAL_ON_INDEX then null;
        end;

    end loop;

--    open pretorno for select count(*) from ems5.representante;
  end p_migra_vendedores;

  -- Rogério - 07/12/2016

  PROCEDURE P_GERA_SERIE_NOTA AS

    /*
    ***************************************************************************************************************
    Criac?o          : -
    Data             : -
    Modulo Principal : Integrac?o EMS5
    Modulos          : -
    Objetivo         : Migrar série Unicoo x Totvs 12
    Alteracoes
    +------------------------------------------------------------------------------------------------------------------------------------------+
    | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 17/06/2016 | VINICIUS      |               |           | Criação da procedure   |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    */

    VAOEXISTE CHAR;

    CURSOR C_SERIES IS

      SELECT DISTINCT T.CDMOVIMENTO u##cod_ser_fisc_nota,
                      T.CDMOVIMENTO cod_ser_fisc_nota,
                      T.NOMOVIMENTO des_ser_fisc_nota,
                      ' ' cod_livre_1,
                      0 log_livre_1,
                      0 num_livre_1,
                      0 val_livre_1,
                      TRUNC(SYSDATE) dat_livre_1,
                      0 log_envio_bco_histor,
                      ' ' cod_livre_2,
                      NULL dat_livre_2,
                      0 log_livre_2,
                      0 num_livre_2,
                      0 val_livre_2,
                      0 cdd_version
        FROM TI_TIPO_MOVIMENTO_TIT_ACR T
       WHERE CDMODULO = 'FT';

  BEGIN

    FOR CS IN C_SERIES LOOP

      BEGIN
        SELECT 'S'
          INTO VAOEXISTE
          FROM EMS5.SER_FISC_NOTA S
         WHERE S.U##COD_SER_FISC_NOTA = CS.COD_SER_FISC_NOTA;
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          VAOEXISTE := 'N';
      END;

      IF VAOEXISTE = 'N' THEN

        INSERT INTO EMS5.SER_FISC_NOTA
        VALUES
          (CS.u##cod_ser_fisc_nota,
           CS.cod_ser_fisc_nota,
           CS.des_ser_fisc_nota,
           CS.cod_livre_1,
           CS.log_livre_1,
           CS.num_livre_1,
           CS.val_livre_1,
           CS.dat_livre_1,
           CS.log_envio_bco_histor,
           CS.cod_livre_2,
           CS.dat_livre_2,
           CS.log_livre_2,
           CS.num_livre_2,
           CS.val_livre_2,
           CS.cdd_version,
           EMS5.SER_FISC_NOTA_SEQ.NEXTVAL);
      END IF;
    END LOOP;
    COMMIT;
  END;

  -- Rogério - 07/12/2016

  --===============================================--
  -- TI_Cliente --> Enviar Cliente para integracao --
  ---------------------------------------------------
  PROCEDURE P_TI_CLIENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2) IS
    nrregistro_aux number;

    CURSOR C_INTEGRA_CLIFOR IS
      SELECT CI.NRSEQUENCIAL        NRSEQ_CONTROLE_INTEGRACAO,
             CI.CDSITUACAO,
             CI.NRSEQUENCIAL_ORIGEM NRPESSOA,
             CI.CDIDENTIFICADOR
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'CL'
         AND CI.CDSITUACAO = PCDSITUACAO
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0);

    --VARIAVEIS PARA TRATAR E REDUZ O ENDERECO
    VQTLOGRA             NUMBER;
    VQTCOMPL             NUMBER;
    VQTLOGRA_REDUZ       NUMBER;
    VQTCOMPL_REDUZ       NUMBER;
    VQTLOGRA_REDUZ_ABREV NUMBER;
    VQTNRIMOVEL          NUMBER;
    VLOGRA               VARCHAR2(50);
    VCOMPL               VARCHAR2(15);
    VLOGRA_REDUZ         VARCHAR2(50);
    VCOMPL_REDUZ         VARCHAR2(15);
    VLOGRA_REDUZ_ABREV   VARCHAR2(50);

    --VLOGRADOURO E VCOMPLEMENTO RECEBERAO OS CONTEUDOS DO ENDERECO E COMPLEMENTO APOS ANALISE DE TAMANHOS
    VLOGRADOURO       VARCHAR2(40);
    VCOMPLEMENTO      VARCHAR2(10);
    VBAIRRO           VARCHAR2(25);
    VLOGRADOURO_COBR  VARCHAR2(40);
    VCOMPLEMENTO_COBR VARCHAR2(10);
    VBAIRRO_COBR      VARCHAR2(25);

    --VARIAVIES QUE CONTROLAM O NUMERO MAXIMO DE REGISTROS NOS CAMPOS DE ENDERECO
    VQTLOGRADOURO  NUMBER := 40;
    VQTCOMPLEMENTO NUMBER := 10;
    pSEPARADOR_ENDERECO_NUMERO varchar2(5);
  BEGIN

--  dbms_output.enable(null);
  dbms_output.disable;

    pSEPARADOR_ENDERECO_NUMERO := f_ti_parametro_integracao('SEPARADOR_ENDERECO_NUMERO');

dbms_output.put_line('p1');

    FOR L_INTEGRA_CLIFOR IN C_INTEGRA_CLIFOR LOOP
dbms_output.put_line('p2');
      BEGIN
        PCDSITUACAO := 'RC';

        FOR TC IN (SELECT COD_ORG_EMIS_ID_ESTAD,
                          DAT_NASCIMENTO,
                          COD_ID_FEDER_NASC,
                          NOM_NACIONALIDADE,
                          IND_ESTADO_CIVIL,
                          COD_CX_POST,
                          NOM_HOME_PAGE,
                          DAT_IMPL_CLIEN,
                          COD_DIGITO_CTA_CORREN,
                          COD_TIP_FLUXO_FINANC,
                          NUM_DIAS_ATRASO_AVDEB,
                          DAT_PROCESSAMENTO,
                          CDSITUACAO,
                          --          nm_arq_retorno,
                          COD_EMPRESA,
                          COD_ID_FEDER_JURID,
                          RPAD(NVL(TRIM(COD_CEP_COBR),
                                   F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')),
                               8,
                               '0') COD_CEP_COBR,
                          DEST_ANOT_TABELA,
                          COD_CART_BCIA_PREFER,
                          IND_TIPO_PESSOA,
                          COD_ID_FEDER_MATRIZ,
                          COD_PAIS_NASC,
                          -- Josias 29-06-2014
                          -- estava estourando o nome da mae com mais de 40 posições
                          NOM_MAE,
                          NOM_PROFISSAO,
                          NOM_CIDADE,
                          -- josias 29-06-2014
                          RPAD(NVL(TRIM(COD_CEP),
                                   F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')),
                               8,
                               '0') COD_CEP,
                          COD_TELEFONE_1,
                          COD_TELEFONE_3,
                          COD_FAX,
                          NOM_BAIRRO_COBR,
                          COD_UNID_FEDER_COBR,
                          COD_GRP_CLIEN,
                          COD_PORTAD_PREFER,
                          COD_CTA_CORREN_BCO,
                          COD_BANCO,
                          LOG_CALC_MULTA,
                          IND_OCORRENCIA,
                          NRSEQ_CONTROLE_INTEGRACAO,
                          COD_CLIENTE,
                          NOM_CLIENTE,
                          NOM_ABREV,
                          COD_ID_FEDER_ESTAD_JURID,
                          COD_ID_PREVID_SOCIAL,
                          LOG_FINS_LUCRAT,
                          COD_ID_ESTAD_FISIC,
                          COD_ID_FEDER_EMIS_ESTAD,
                          NOM_BAIRRO,
                          COD_UNID_FEDER,
                          COD_TELEFONE_2,
                          COD_RAMAL_FAX,
                          NOM_ENDER_COMPL_COBR,
                          NOM_CIDADE_COBR,
                          COD_CX_POST_COBR,
                          COD_TIP_CLIEN,
                          COD_ID_FEDER,
                          NOM_ENDER_COMPL,
                          COD_DIGITO_AGENC_BCIA,
                          COD_ACAO,
                          NOM_ENDERECO,
                          NRIMOVEL, -- PASSEI A TRAZER O NUMERO DO IMOVEL SEPARADO DO NOM_ENDERECO
                          NOM_ENDERECO_COBR,
                          NRIMOVEL_COBR,
                          COD_AGENC_BCIA,
                          COD_E_MAIL,
                          COD_ID_MUNIC_JURID,
                          NRSEQ_FAVORECIDO,
                          NRPESSOA
                     FROM V_TI_CLIENTE
                    WHERE NRSEQ_CONTROLE_INTEGRACAO =
                          L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO) LOOP

dbms_output.put_line('p3' || ';' || L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO);
dbms_output.put_line(
tc.COD_ORG_EMIS_ID_ESTAD||
tc.DAT_NASCIMENTO||
tc.COD_ID_FEDER_NASC||
tc.NOM_NACIONALIDADE||
tc.IND_ESTADO_CIVIL||
tc.COD_CX_POST||
tc.NOM_HOME_PAGE||
tc.DAT_IMPL_CLIEN||
tc.COD_DIGITO_CTA_CORREN||
tc.COD_TIP_FLUXO_FINANC||
tc.NUM_DIAS_ATRASO_AVDEB||
tc.DAT_PROCESSAMENTO||
tc.CDSITUACAO||
tc.COD_EMPRESA||
tc.COD_ID_FEDER_JURID||
tc.COD_CEP_COBR||
--tc.DEST_ANOT_TABELA||
tc.COD_CART_BCIA_PREFER||
tc.IND_TIPO_PESSOA||
tc.COD_ID_FEDER_MATRIZ||
tc.COD_PAIS_NASC||
tc.NOM_MAE||
tc.NOM_PROFISSAO||
tc.NOM_CIDADE||
tc.COD_CEP||
tc.COD_TELEFONE_1||
tc.COD_TELEFONE_3||
tc.COD_FAX||
tc.NOM_BAIRRO_COBR||
tc.COD_UNID_FEDER_COBR||
tc.COD_GRP_CLIEN||
tc.COD_PORTAD_PREFER||
tc.COD_CTA_CORREN_BCO||
tc.COD_BANCO||
tc.LOG_CALC_MULTA||
tc.IND_OCORRENCIA||
tc.NRSEQ_CONTROLE_INTEGRACAO||
tc.COD_CLIENTE||
tc.NOM_CLIENTE||
tc.NOM_ABREV||
tc.COD_ID_FEDER_ESTAD_JURID||
tc.COD_ID_PREVID_SOCIAL||
tc.LOG_FINS_LUCRAT||
tc.COD_ID_ESTAD_FISIC||
tc.COD_ID_FEDER_EMIS_ESTAD||
tc.NOM_BAIRRO||
tc.COD_UNID_FEDER||
tc.COD_TELEFONE_2||
tc.COD_RAMAL_FAX||
tc.NOM_ENDER_COMPL_COBR||
tc.NOM_CIDADE_COBR||
tc.COD_CX_POST_COBR||
tc.COD_TIP_CLIEN||
tc.COD_ID_FEDER||
tc.NOM_ENDER_COMPL||
tc.COD_DIGITO_AGENC_BCIA||
tc.COD_ACAO||
tc.NOM_ENDERECO||
tc.NOM_ENDERECO_COBR||
tc.NRIMOVEL||
tc.NRIMOVEL_COBR||
tc.COD_AGENC_BCIA||
tc.COD_E_MAIL||
tc.COD_ID_MUNIC_JURID||
tc.NRSEQ_FAVORECIDO||
tc.NRPESSOA
);

          --QTDE E CONTEUDOS DO ENDERECO
          VQTLOGRA             := LENGTH(TRIM(TC.NOM_ENDERECO));
          VQTCOMPL             := LENGTH(TRIM(TC.NOM_ENDER_COMPL));
          VQTLOGRA_REDUZ       := LENGTH(TRIM(F_REDUZ_END(TC.NOM_ENDERECO,
                                                          0)));
          VQTCOMPL_REDUZ       := LENGTH(TRIM(F_REDUZ_COMPL(TC.NOM_ENDER_COMPL,
                                                            0)));
          VQTLOGRA_REDUZ_ABREV := LENGTH(TRIM(F_REDUZ_END_ABREV(F_REDUZ_END(TC.NOM_ENDERECO,
                                                                            0),
                                                                0)));
          VQTNRIMOVEL          := LENGTH(TC.NRIMOVEL) + length(nvl(pSEPARADOR_ENDERECO_NUMERO,', ')); /*tamanho do separador, que pode ser (,) (, ) etc*/
          VLOGRA               := TRIM(TC.NOM_ENDERECO);
          VCOMPL               := NVL(TRIM(TC.NOM_ENDER_COMPL), ' ');
          VLOGRA_REDUZ         := TRIM(F_REDUZ_END(TC.NOM_ENDERECO, 0));
          VCOMPL_REDUZ         := TRIM(F_REDUZ_COMPL(TC.NOM_ENDER_COMPL, 0));
          VLOGRA_REDUZ_ABREV   := TRIM(F_REDUZ_END_ABREV(F_REDUZ_END(TC.NOM_ENDERECO,0),0));

          --TRATATIVA DOS ENDEÇOES E LOGRADOUROS (21/10/2016)
          --COMPLEMENTO NULO OU ATÉ 10 E O LOGRADOURO + NRIMOVEL ATÉ 40
          --LINHAS 1 E 2 DA PLANILHA
          IF ((VCOMPL IS NULL OR LENGTH(VCOMPL) <= VQTCOMPLEMENTO) AND
             VQTLOGRA + NVL((VQTNRIMOVEL), 0) <= VQTLOGRADOURO) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA;
            ELSE
              VLOGRADOURO := VLOGRA || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL;
            END IF;

            VCOMPLEMENTO := VCOMPL;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '1', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DAS LINHAS 1 E 2
            --LOGRADOURO+NRIMOVEL ACIMA DE 40, PORÉM LOGRAD+IMOVEL REDUZ ATÉ 40 E O COMPLEMENTO ATÉ 10
            --LINHA 3 DA PLANILHA
          ELSIF (((VQTCOMPL <= VQTCOMPLEMENTO) OR (VQTCOMPL IS NULL)) AND
                VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) <=
                VQTLOGRADOURO) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA_REDUZ;
            ELSE
              VLOGRADOURO := VLOGRA_REDUZ || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL;
            END IF;

            VCOMPLEMENTO := VCOMPL;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '3', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 3
            --COMPLEMENTO ACIMA DE 10, PORÉM COMPL REDUZ ATÉ 10 E O LOGRADOURO + NRIMOVEL ATÉ 40
            --LINHA 4 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
                VQTLOGRA + NVL((VQTNRIMOVEL), 0) <= VQTLOGRADOURO) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA;
            ELSE
              VLOGRADOURO := VLOGRA || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL;
            END IF;

            VCOMPLEMENTO := VCOMPL_REDUZ;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '4', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 4
            --COMPLEMENTO ACIMA DE 10, PORÉM COMPL REDUZ ATÉ 10 E O LOGRADOURO + NRIMOVEL ACIMA DE 40, PORÉM LOGR+IMOVEL REDUZ ATÉ 40
            --LINHA 5 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL), 0) > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA_REDUZ;
            ELSE
              VLOGRADOURO := VLOGRA_REDUZ || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL;
            END IF;

            VCOMPLEMENTO := VCOMPL_REDUZ;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '5', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 5

            --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO + NRIMOVEL ATE 40
            --LINHA 6 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL), 0) + 1 + VQTCOMPL_REDUZ <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA || '-' || VCOMPL_REDUZ;
            ELSE
              VLOGRADOURO := VLOGRA || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL || '-' ||
                             VCOMPL_REDUZ;
            END IF;

            VCOMPLEMENTO := ' ';

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '6', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 6
            --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO REDUZ + NRIMOVEL ATE 40
            --LINHA 7 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL), 0) + 1 + VQTCOMPL_REDUZ >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) + 1 +
                VQTCOMPL_REDUZ <= VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA_REDUZ || '-' || VCOMPL_REDUZ;
            ELSE
              VLOGRADOURO := VLOGRA_REDUZ || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL || '-' ||
                             VCOMPL_REDUZ;
            END IF;

            VCOMPLEMENTO := ' ';

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '7', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 7
            --COMPLEMENTO NULO OU ATÉ 10, LOGR REDUZ + NR ACIMA DE 40, PORÉM LOGRADOURO REDUZ E ABREV + NRIMOVEL ATE 40
            --LINHA 8 DA PLANILHA
          ELSIF ((VQTCOMPL <= VQTCOMPLEMENTO OR VCOMPL IS NULL) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL), 0) > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL), 0) <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA_REDUZ_ABREV;
            ELSE
              VLOGRADOURO := VLOGRA_REDUZ_ABREV || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL;
            END IF;

            VCOMPLEMENTO := VCOMPL;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 8

            --COMPLEMENTO ACIMA DE 10, PORÉM REDUZ ATÉ 10 E LOGR REDUZ + NR ACIMA DE 40, PORÉM LOGRADOURO REDUZ E ABREV + NRIMOVEL ATE 40
            --LINHA 9 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL), 0) > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL), 0) <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA_REDUZ_ABREV;
            ELSE
              VLOGRADOURO := VLOGRA_REDUZ_ABREV || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL;
            END IF;

            VCOMPLEMENTO := VCOMPL_REDUZ;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 9

            --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO REDUZ E ABREVIADO (ÚLTIMO RECURSO) + NRIMOVEL ATE 40
            --LINHA 10 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL), 0) + 1 + VQTCOMPL_REDUZ >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) + 1 +
                VQTCOMPL_REDUZ > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL), 0) + 1 +
                VQTCOMPL_REDUZ <= VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA_REDUZ_ABREV || '-' || VCOMPL_REDUZ;
            ELSE
              VLOGRADOURO := VLOGRA_REDUZ_ABREV || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL || '-' ||
                             VCOMPL_REDUZ;
            END IF;

            VCOMPLEMENTO := ' ';

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 10
          else
            --*****ver se ficará
            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '0', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --SE NAO CONSEGUIU ABREVIAR, TRUNCA 1AS 40 POSICOES DO LOGRADOURO ABREVIADO E 1AS 10 DO COMPLEMENTO

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := SUBSTR(VLOGRA_REDUZ_ABREV,1,40);
            else
              --concatena numero no inicio pois a parte final do logradouro sera truncada
              vlogradouro := substr(tc.nrimovel || ' ' || VLOGRA_REDUZ_ABREV,1,40);
            end if;

            VCOMPLEMENTO := substr(VCOMPL_REDUZ,1,10);


            /*   -- ERRO - NAO ENTROU EM NENHUM DOS IFS ACIMA
                ELSIF ((LENGTH(TENDERECO.TXCOMPLEMENTO) > VQTCOMPLEMENTO AND LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0))> VQTCOMPLEMENTO) AND
                     ((LENGTH(TRIM(TENDERECO.NOLOGRADOURO)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
                     ((LENGTH(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
                     ((LENGTH(F_REDUZ_END_ABREV(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO)
                     ) THEN

                  -- VER COM O VINI PARA GRAVAR FALHA NO PROCESSO
                  VLOGRADOURO  := NULL;
                  VCOMPLEMENTO := NULL;

                  INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '9', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);
            */
          END IF;

          --VALIDACAO DO TAMANHO DO BAIRRO
          --SE NAO ENVIAR O BAIRRO COMPLETO, TENTA O REDUZIDO E POR ÚLTIMO TRUNCA
          VBAIRRO := '';

          IF LENGTH(TC.NOM_BAIRRO) > 20 THEN
            IF LENGTH(f_reduz_bairro(TC.NOM_BAIRRO, 0)) > 20 THEN
              VBAIRRO := SUBSTR(F_REDUZ_BAIRRO(TC.NOM_BAIRRO, 0), 1, 20); --20 POSICOES DO REDUZIDO
            ELSE
              VBAIRRO := f_reduz_bairro(TC.NOM_BAIRRO, 0); -- BAIRRO REDUZIDO
            END IF;
          ELSE
            VBAIRRO := TC.NOM_BAIRRO; -- BAIRRO INTEIRO
          END IF;

          --INSERT INTO END_MIGRA VALUES (VBAIRRO,NULL,TENDERECO.NOBAIRRO,NULL,NULL,NULL,TENDERECO.NRREGISTRO);

          --FINAL DA VERIFICACAO E TRATAMENTO DO ENDERECO

          --TRATAMENTO DO ENDERECO DE COBRANÇA
          --QTDE E CONTEUDOS DO ENDERECO
          VQTLOGRA             := LENGTH(TRIM(TC.NOM_ENDERECO_COBR));
          VQTCOMPL             := LENGTH(TRIM(TC.NOM_ENDER_COMPL_COBR));
          VQTLOGRA_REDUZ       := LENGTH(TRIM(F_REDUZ_END(TC.NOM_ENDERECO_COBR,
                                                          0)));
          VQTCOMPL_REDUZ       := LENGTH(TRIM(F_REDUZ_COMPL(TC.NOM_ENDER_COMPL_COBR,
                                                            0)));
          VQTLOGRA_REDUZ_ABREV := LENGTH(TRIM(F_REDUZ_END_ABREV(F_REDUZ_END(TC.NOM_ENDERECO_COBR,
                                                                            0),
                                                                0)));
          VQTNRIMOVEL          := LENGTH(TC.NRIMOVEL_COBR) + length(nvl(pSEPARADOR_ENDERECO_NUMERO,', '));
          VLOGRA               := TRIM(TC.NOM_ENDERECO_COBR);
          VCOMPL               := NVL(TRIM(TC.NOM_ENDER_COMPL_COBR), ' ');
          VLOGRA_REDUZ         := TRIM(F_REDUZ_END(TC.NOM_ENDERECO_COBR, 0));
          VCOMPL_REDUZ         := TRIM(F_REDUZ_COMPL(TC.NOM_ENDER_COMPL_COBR,
                                                     0));
          VLOGRA_REDUZ_ABREV   := TRIM(F_REDUZ_END_ABREV(F_REDUZ_END(TC.NOM_ENDERECO_COBR,
                                                                     0),
                                                         0));

          --TRATATIVA DOS ENDEÇOES E LOGRADOUROS (21/10/2016)
          --COMPLEMENTO NULO OU ATÉ 10 E O LOGRADOURO + NRIMOVEL ATÉ 40
          --LINHAS 1 E 2 DA PLANILHA
          IF ((VCOMPL IS NULL OR LENGTH(VCOMPL) <= VQTCOMPLEMENTO) AND
             VQTLOGRA + NVL((VQTNRIMOVEL), 0) <= VQTLOGRADOURO) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA;
            ELSE
              VLOGRADOURO_COBR := VLOGRA || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL_COBR;
            END IF;

            VCOMPLEMENTO_COBR := VCOMPL;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '1', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DAS LINHAS 1 E 2
            --LOGRADOURO+NRIMOVEL ACIMA DE 40, PORÉM LOGRAD+IMOVEL REDUZ ATÉ 40 E O COMPLEMENTO ATÉ 10
            --LINHA 3 DA PLANILHA
          ELSIF (((VQTCOMPL <= VQTCOMPLEMENTO) OR (VQTCOMPL IS NULL)) AND
                VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) <=
                VQTLOGRADOURO) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA_REDUZ;
            ELSE
              VLOGRADOURO_COBR := VLOGRA_REDUZ || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL_COBR;
            END IF;

            VCOMPLEMENTO_COBR := VCOMPL;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '3', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 3
            --COMPLEMENTO ACIMA DE 10, PORÉM COMPL REDUZ ATÉ 10 E O LOGRADOURO + NRIMOVEL ATÉ 40
            --LINHA 4 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
                VQTLOGRA + NVL((VQTNRIMOVEL), 0) <= VQTLOGRADOURO) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA;
            ELSE
              VLOGRADOURO_COBR := VLOGRA || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL_COBR;
            END IF;

            VCOMPLEMENTO_COBR := VCOMPL_REDUZ;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '4', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 4
            --COMPLEMENTO ACIMA DE 10, PORÉM COMPL REDUZ ATÉ 10 E O LOGRADOURO + NRIMOVEL ACIMA DE 40, PORÉM LOGR+IMOVEL REDUZ ATÉ 40
            --LINHA 5 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL), 0) > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA_REDUZ;
            ELSE
              VLOGRADOURO_COBR := VLOGRA_REDUZ || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL_COBR;
            END IF;

            VCOMPLEMENTO_COBR := VCOMPL_REDUZ;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '5', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 5

            --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO + NRIMOVEL ATE 40
            --LINHA 6 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL), 0) + 1 + VQTCOMPL_REDUZ <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA || '-' || VCOMPL_REDUZ;
            ELSE
              VLOGRADOURO_COBR := VLOGRA || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL_COBR || '-' ||
                                  VCOMPL_REDUZ;
            END IF;

            VCOMPLEMENTO_COBR := ' ';

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '6', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 6
            --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO REDUZ + NRIMOVEL ATE 40
            --LINHA 7 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL), 0) + 1 + VQTCOMPL_REDUZ >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) + 1 +
                VQTCOMPL_REDUZ <= VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA_REDUZ || '-' || VCOMPL_REDUZ;
            ELSE
              VLOGRADOURO_COBR := VLOGRA_REDUZ || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') || TC.NRIMOVEL_COBR || '-' ||
                                  VCOMPL_REDUZ;
            END IF;

            VCOMPLEMENTO_COBR := ' ';

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '7', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 7
            --COMPLEMENTO NULO OU ATÉ 10, LOGR REDUZ + NR ACIMA DE 40, PORÉM LOGRADOURO REDUZ E ABREV + NRIMOVEL ATE 40
            --LINHA 8 DA PLANILHA
          ELSIF ((VQTCOMPL <= VQTCOMPLEMENTO OR VCOMPL IS NULL) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL), 0) > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL), 0) <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA_REDUZ_ABREV;
            ELSE
              VLOGRADOURO_COBR := VLOGRA_REDUZ_ABREV || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') ||
                                  TC.NRIMOVEL_COBR;
            END IF;

            VCOMPLEMENTO_COBR := VCOMPL;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 8

            --COMPLEMENTO ACIMA DE 10, PORÉM REDUZ ATÉ 10 E LOGR REDUZ + NR ACIMA DE 40, PORÉM LOGRADOURO REDUZ E ABREV + NRIMOVEL ATE 40
            --LINHA 9 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL), 0) > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL), 0) <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA_REDUZ_ABREV;
            ELSE
              VLOGRADOURO_COBR := VLOGRA_REDUZ_ABREV || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') ||
                                  TC.NRIMOVEL_COBR;
            END IF;

            VCOMPLEMENTO_COBR := VCOMPL_REDUZ;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 9
            --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO REDUZ E ABREVIADO (ÚLTIMO RECURSO) + NRIMOVEL ATE 40
            --LINHA 10 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL), 0) + 1 + VQTCOMPL_REDUZ >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL), 0) + 1 +
                VQTCOMPL_REDUZ > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL), 0) + 1 +
                VQTCOMPL_REDUZ <= VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA_REDUZ_ABREV || '-' || VCOMPL_REDUZ;
            ELSE
              VLOGRADOURO_COBR := VLOGRA_REDUZ_ABREV || nvl(pSEPARADOR_ENDERECO_NUMERO,', ') ||
                                  TC.NRIMOVEL_COBR || '-' || VCOMPL_REDUZ;
            END IF;

            VCOMPLEMENTO_COBR := ' ';

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 10
          else
            --*****ver se ficará
            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '0', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --se nao conseguiu abreviar, vai truncar 1as 40 posicoes do logradouro e 1as 10 do complemento
            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := SUBSTR(VLOGRA_REDUZ_ABREV,1,40);
            else
              --concatena numero no inicio pois a parte final do logradouro sera truncada
              VLOGRADOURO_COBR := substr(tc.nrimovel_COBR || ' ' || VLOGRA_REDUZ_ABREV,1,40);
            end if;

            VCOMPLEMENTO_COBR := substr(VCOMPL_REDUZ,1,10);

            /*   -- ERRO - NAO ENTROU EM NENHUM DOS IFS ACIMA
                ELSIF ((LENGTH(TENDERECO.TXCOMPLEMENTO) > VQTCOMPLEMENTO AND LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0))> VQTCOMPLEMENTO) AND
                     ((LENGTH(TRIM(TENDERECO.NOLOGRADOURO)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
                     ((LENGTH(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
                     ((LENGTH(F_REDUZ_END_ABREV(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO)
                     ) THEN

                  -- VER COM O VINI PARA GRAVAR FALHA NO PROCESSO
                  VLOGRADOURO  := NULL;
                  VCOMPLEMENTO := NULL;

                  INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '9', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);
            */
          END IF;

          --VALIDACAO DO TAMANHO DO BAIRRO
          --SE NAO ENVIAR O BAIRRO COMPLETO, TENTA O REDUZIDO E POR ÚLTIMO TRUNCA
          VBAIRRO_COBR := '';

          IF LENGTH(TC.NOM_BAIRRO_COBR) > 20 THEN
            IF LENGTH(f_reduz_bairro(TC.NOM_BAIRRO_COBR, 0)) > 20 THEN
              VBAIRRO_COBR := SUBSTR(F_REDUZ_BAIRRO(TC.NOM_BAIRRO_COBR, 0),
                                     1,
                                     20); --20 POSICOES DO REDUZIDO
            ELSE
              VBAIRRO_COBR := f_reduz_bairro(TC.NOM_BAIRRO_COBR, 0); -- BAIRRO REDUZIDO
            END IF;
          ELSE
            VBAIRRO_COBR := TC.NOM_BAIRRO_COBR; -- BAIRRO INTEIRO
          END IF;

          --INSERT INTO END_MIGRA VALUES (VBAIRRO,NULL,TENDERECO.NOBAIRRO,NULL,NULL,NULL,TENDERECO.NRREGISTRO);

          --FINAL DA VERIFICACAO E TRATAMENTO DO ENDERECO

          nrregistro_aux := tc.nrpessoa;

dbms_output.put_line(TC.NRSEQ_CONTROLE_INTEGRACAO || ';' ||
                     TC.COD_CLIENTE || ';' ||
                     TC.NOM_CLIENTE || ';' ||
                     tc.nrpessoa);

          INSERT INTO TI_CLIENTE
            (COD_ORG_EMIS_ID_ESTAD, --1
             DAT_NASCIMENTO, --2
             COD_ID_FEDER_NASC,
             NOM_NACIONALIDADE,
             IND_ESTADO_CIVIL,
             COD_CX_POST,
             NOM_HOME_PAGE,
             DAT_IMPL_CLIEN,
             COD_TIP_FLUXO_FINANC,
             NUM_DIAS_ATRASO_AVDEB,--10
             DAT_PROCESSAMENTO,
             CDSITUACAO,
             COD_EMPRESA,
             COD_ID_FEDER_JURID,
             COD_CEP_COBR, --15
             DEST_ANOT_TABELA,
             COD_CART_BCIA_PREFER,
             IND_TIPO_PESSOA, --18
             COD_ID_FEDER_MATRIZ,
             COD_PAIS_NASC,
             NOM_MAE,
             NOM_PROFISSAO,
             NOM_CIDADE, --23
             COD_CEP, --24
             COD_TELEFONE_1,
             COD_TELEFONE_3,
             COD_FAX,
             NOM_BAIRRO_COBR, --28
             COD_UNID_FEDER_COBR, --29
             COD_GRP_CLIEN,
             COD_PORTAD_PREFER,
             LOG_CALC_MULTA,
             IND_OCORRENCIA,
             NRSEQ_CONTROLE_INTEGRACAO,
             COD_CLIENTE,
             NOM_CLIENTE, --36
             NOM_ABREV,
             COD_ID_FEDER_ESTAD_JURID,
             COD_ID_PREVID_SOCIAL,
             LOG_FINS_LUCRAT,--40
             COD_ID_ESTAD_FISIC,
             COD_ID_FEDER_EMIS_ESTAD,
             NOM_BAIRRO, --43
             COD_UNID_FEDER, --44
             COD_TELEFONE_2,
             COD_RAMAL_FAX, --46
             NOM_ENDER_COMPL_COBR, --47
             NOM_CIDADE_COBR, --48
             COD_CX_POST_COBR,
             COD_TIP_CLIEN,--50
             COD_ID_FEDER,
             NOM_ENDER_COMPL, --52
             COD_ACAO,
             NOM_ENDERECO, --54
             NOM_ENDERECO_COBR, --55
             COD_E_MAIL,
             COD_ID_MUNIC_JURID,
             NRSEQ_FAVORECIDO,
             NRPESSOA,
             COD_BANCO,--60
             COD_AGENC_BCIA,
             COD_DIGITO_AGENC_BCIA,
             COD_CTA_CORREN_BCO,
             COD_DIGITO_CTA_CORREN --64

             )
          VALUES
            (

             TC.COD_ORG_EMIS_ID_ESTAD, --1
             TC.DAT_NASCIMENTO,
             TC.COD_ID_FEDER_NASC,
             TC.NOM_NACIONALIDADE,
             TC.IND_ESTADO_CIVIL,
             TC.COD_CX_POST,
             TC.NOM_HOME_PAGE,
             TC.DAT_IMPL_CLIEN,
             TC.COD_TIP_FLUXO_FINANC, --9
             TC.NUM_DIAS_ATRASO_AVDEB,--10
             TC.DAT_PROCESSAMENTO,
             TC.CDSITUACAO,--12
             --          nm_arq_retorno,
             TC.COD_EMPRESA,
             TC.COD_ID_FEDER_JURID,
             RPAD(NVL(TRIM(TC.COD_CEP_COBR),
                      F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')),
                  8,
                  '0'),--15
             TC.DEST_ANOT_TABELA,
             TC.COD_CART_BCIA_PREFER,
             TC.IND_TIPO_PESSOA,
             TC.COD_ID_FEDER_MATRIZ,
             TC.COD_PAIS_NASC, --20
             -- Josias 29-06-2014
             -- estava estourando o nome da mae com mais de 40 posições
             TC.NOM_MAE,
             TC.NOM_PROFISSAO,
             NVL(TC.NOM_CIDADE, ' '),
             -- josias 29-06-2014
             RPAD(NVL(TRIM(TC.COD_CEP),
                      F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')),
                  8,
                  '0'),--24
             TC.COD_TELEFONE_1,
             TC.COD_TELEFONE_3,
             TC.COD_FAX,
             NVL(VBAIRRO_COBR, ' '), --TC.NOM_BAIRRO_COBR,
             TC.COD_UNID_FEDER_COBR,
             TC.COD_GRP_CLIEN,--30
             TC.COD_PORTAD_PREFER,
             TC.LOG_CALC_MULTA,
             TC.IND_OCORRENCIA,
             TC.NRSEQ_CONTROLE_INTEGRACAO,
             TC.COD_CLIENTE,
             TC.NOM_CLIENTE,
             TC.NOM_ABREV,
             TC.COD_ID_FEDER_ESTAD_JURID,
             TC.COD_ID_PREVID_SOCIAL,
             TC.LOG_FINS_LUCRAT,--40
             TC.COD_ID_ESTAD_FISIC,
             TC.COD_ID_FEDER_EMIS_ESTAD,
             NVL(VBAIRRO, ' '), --TC.NOM_BAIRRO,
             TC.COD_UNID_FEDER,
             TC.COD_TELEFONE_2,
             TC.COD_RAMAL_FAX,
             NVL(VCOMPLEMENTO_COBR, ' '), --TC.NOM_ENDER_COMPL_COBR,
             NVL(TC.NOM_CIDADE_COBR, ' '),
             TC.COD_CX_POST_COBR,
             TC.COD_TIP_CLIEN,--50
             TC.COD_ID_FEDER,
             NVL(VCOMPLEMENTO, ' '), --TC.NOM_ENDER_COMPL,
             TC.COD_ACAO,
             NVL(VLOGRADOURO, ' '), --54    TC.NOM_ENDERECO,
             NVL(VLOGRADOURO_COBR, ' '), --TC.NOM_ENDERECO_COBR,
             TC.COD_E_MAIL,
             TC.COD_ID_MUNIC_JURID,
             TC.NRSEQ_FAVORECIDO,
             TC.NRPESSOA,
             TC.COD_BANCO,--60
             CASE WHEN TC.COD_BANCO = ' ' THEN ' ' WHEN
             INSTR(TC.COD_AGENC_BCIA, '-') > 0 THEN
             SUBSTR(LPAD(F_DEFINIR_NUMERICO(SUBSTR(TC.COD_AGENC_BCIA,
                                                   1,
                                                   INSTR(TC.COD_AGENC_BCIA,
                                                         '-') - 1)),
                         F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'A'),
                         '0'),
                    1,
                    F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'A')) ELSE
             SUBSTR(LPAD(F_DEFINIR_NUMERICO(TC.COD_AGENC_BCIA),
                         F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'A'),
                         '0'),
                    1,
                    F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'A')) END, --61    COD_AGENC_BCIA

             CASE WHEN TC.COD_BANCO = ' ' THEN ' '
                  WHEN INSTR(TC.COD_AGENC_BCIA, '-') > 0 THEN
                       to_char(F_DEFINIR_NUMERICO(decode(upper(SUBSTR(TC.COD_AGENC_BCIA, INSTR(TC.COD_AGENC_BCIA, '-') + 1, 1)),'X','0',
                       SUBSTR(TC.COD_AGENC_BCIA, INSTR(TC.COD_AGENC_BCIA, '-') + 1, 1))))
                  ELSE ' '
             END, --62    COD_DIGITO_AGENC_BCIA

             CASE WHEN TC.COD_BANCO = ' ' THEN ' ' WHEN
              INSTR(TC.COD_CTA_CORREN_BCO, '-') > 0 THEN
              SUBSTR(LPAD(F_DEFINIR_NUMERICO(SUBSTR(TC.COD_CTA_CORREN_BCO,
                                                    1,
                                                    INSTR(TC.COD_CTA_CORREN_BCO,
                                                          '-') - 1)),
                          F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'C'),
                          '0'),
                     1,
                     F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'C')) ELSE
             --                                        substr(t.nrconta_bancaria,1, f_ret_masc_banco(lpad(t.nrbanco,3,'0'),'C'))
              SUBSTR(LPAD(F_DEFINIR_NUMERICO(TC.COD_CTA_CORREN_BCO),
                          F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'C'),
                          '0'),
                     1,
                     F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'C')) END, -- 63    COD_CTA_CORREN_BCO
             CASE WHEN TC.COD_BANCO = ' ' THEN ' '
                  WHEN INSTR(TC.COD_CTA_CORREN_BCO, '-') > 0
                       THEN to_char(F_DEFINIR_NUMERICO(decode(upper(SUBSTR(TC.COD_CTA_CORREN_BCO, INSTR(TC.COD_CTA_CORREN_BCO, '-') + 1,1)),'X','0',
                            SUBSTR(TC.COD_CTA_CORREN_BCO, INSTR(TC.COD_CTA_CORREN_BCO, '-') + 1,1))))
                  ELSE ' ' END --64   COD_DIGITO_CTA_CORREN
             );

          insere_hash('CL',
                      L_INTEGRA_CLIFOR.NRPESSOA,
                      L_INTEGRA_CLIFOR.CDIDENTIFICADOR);

        END LOOP;

        IF SQL%ROWCOUNT = 0 THEN
          P_TI_VALIDA_ENDERECO(L_INTEGRA_CLIFOR.NRPESSOA,
                               L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                               'TI_CLIENTE',
                               PCDSITUACAO);
          IF PCDSITUACAO = 'RC' THEN
            P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                          'TI_CLIENTE',
                          'Dados no encontrados na V_ti_cliente PARA O PROCESSO',
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        END IF;

        P_COMMIT;

      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
/*
    14/01/19 - Alex Boeira - comentado pois causava a falha quando um cliente possui mais de um endereco
          P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                        'TI_CLIENTE',
                        'O cliente relacionado à pessoa ' || nrregistro_aux || ' ja foi enviado para a TI_CLIENTE',
                        SQLERRM,
                        PCDSITUACAO,
                        -1);
*/                        NULL;
        WHEN OTHERS THEN
          BEGIN
            P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                          'TI_CLIENTE',
                          SQLERRM,
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END;
      END;
      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  PROCEDURE P_GERAR_DADOS_BANC_FORNEC IS
    /*
    ***************************************************************************************************************
    Criacão          : Josias Rodrigues
    Data             : -
    Modulo Principal : Integracão EMS5
    Modulos          : -
    Objetivo         : Gerar os dados bancários do Fornecedor Unicoo para o EMS5
    Alteracoes
    +------------------------------------------------------------------------------------------------------------------------------------------+
    | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 25/09/2014 | JOSIAS        |               |           | Criação do Objeto                                                                  |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    */
  BEGIN
    DECLARE
      VCDFORNEC_ANTERIOR number := 0;

      CURSOR C_ATU IS
        SELECT PCOD_EMPRESA_UNICOO COD_EMPRESA,
               P.CDN_FORNECEDOR,
               LPAD(T.NRBANCO, 3, '0') COD_BANCO,
               /*REGRAS PARA MIGRACAO DE AGENCIA E CONTA BANCARIA:
                * SE O FORNECEDOR FOR TAMBEM PRESTADOR, BUSCA OS DADOS DO PRESTADOR,
                  POIS CONTA E DIGITO ESTAO SEPARADOS, ENQUANTO NO FORNECEDOR Eh APENAS 1 CAMPO.
                  CASO CONTRARIO, CONSIDERA OS DADOS DO FORNECEDOR.
                * SE TIVER '-' NO CAMPO DO UNICOO, USA ISSO COMO SEPARADOR DE AGENCIA-DIGITO / CONTA-DIGITO.
                  CASO CONTRARIO PREENCHE NA AGENCIA / CONTA E DEIXA DIGITO ZERADO.
                * SITUACOES DIVERGENTES DISSO DEVEM SER CORRIGIDAS NO UNICOO ANTES DE MIGRAR (COLOCAR O '-'
                  COMO SEPARADOR).
                */
               case--COD_AGENC_BCIA
                 when pr.nragencia is not null then
                   case
                     --SE TIVER '-' (SEPARADOR), utiliza como criterio para separar digito verificador
                     when instr(pr.nragencia,'-') > 0 then
                      SUBSTR(LPAD(F_DEFINIR_NUMERICO(nvl(SUBSTR(pr.NRAGENCIA,
                                                            1,
                                                            INSTR(pr.NRAGENCIA,
                                                                  '-') - 1),0)),
                                  F_RET_MASC_BANCO(LPAD(pr.NRBANCO, 3, '0'), 'A'),
                                  '0'),
                             1,
                             F_RET_MASC_BANCO(LPAD(pr.NRBANCO, 3, '0'), 'A'))
                     else
                      SUBSTR(LPAD(F_DEFINIR_NUMERICO(nvl(pr.NRAGENCIA,0)),
                                       F_RET_MASC_BANCO(LPAD(pr.NRBANCO, 3, '0'), 'A'),
                                       '0'),
                                  1,
                                  F_RET_MASC_BANCO(LPAD(pr.NRBANCO, 3, '0'), 'A'))
                   end
                 else
                   CASE
                     --SE TIVER '-' (SEPARADOR), utiliza como criterio para separar digito verificador
                     WHEN INSTR(T.NRAGENCIA, '-') > 0 THEN
                       SUBSTR(LPAD(F_DEFINIR_NUMERICO(nvl(SUBSTR(T.NRAGENCIA,
                                                        1,
                                                        INSTR(T.NRAGENCIA,
                                                              '-') - 1),0)),
                              F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'),
                              '0'),
                         1,
                         F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'))
                     ELSE
                       SUBSTR(LPAD(nvl(F_DEFINIR_NUMERICO(nvl(T.NRAGENCIA,0)),0),
                                   F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'),
                                   '0'),
                                  1,
                                  F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'))
                   end
               END COD_AGENC_BCIA,

               CASE--COD_DIGITO_AGENC_BCIA
                 when pr.nragencia is not null then
                   case
                     --SE TIVER '-' (SEPARADOR), utiliza como criterio para separar digito verificador
                     when instr(pr.nragencia,'-') > 0 then
                       to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(SUBSTR(pr.NRAGENCIA, INSTR(pr.NRAGENCIA, '-') + 1, 1)),'X','0',
                       SUBSTR(pr.NRAGENCIA, INSTR(pr.NRAGENCIA, '-') + 1, 1)),0)))
                     else ' '
                   end
                 else
                   case
                     WHEN INSTR(T.NRAGENCIA, '-') > 0 THEN
                       to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(SUBSTR(T.NRAGENCIA, INSTR(T.NRAGENCIA, '-') + 1, 1)),'X','0',
                       SUBSTR(T.NRAGENCIA, INSTR(T.NRAGENCIA, '-') + 1, 1)),0)))
                     ELSE ' '
                   end
               END COD_DIGITO_AGENC_BCIA,

               CASE--COD_CTA_CORREN_BCO
                 when pr.nrconta is not null then
                      SUBSTR(LPAD(F_DEFINIR_NUMERICO(nvl(pr.NRCONTA,0)),
                                  F_RET_MASC_BANCO(LPAD(pr.NRBANCO, 3, '0'), 'C'),
                                  '0'),
                             1,
                             F_RET_MASC_BANCO(LPAD(pr.NRBANCO, 3, '0'), 'C'))
                 else
                   case
                     --SE TIVER '-' (SEPARADOR), utiliza como criterio para separar digito verificador
                     WHEN INSTR(T.NRCONTA_BANCARIA, '-') > 0 THEN
                       SUBSTR(LPAD(F_DEFINIR_NUMERICO(nvl(SUBSTR(T.NRCONTA_BANCARIA,
                                                        1,
                                                        INSTR(T.NRCONTA_BANCARIA,
                                                              '-') - 1),0)),
                              F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'),
                              '0'),
                         1,
                         F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'))
                     ELSE
                        SUBSTR(LPAD(F_DEFINIR_NUMERICO(nvl(T.NRCONTA_BANCARIA,0)),
                                    F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'),
                                    '0'),
                               1,
                               F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'))
                   end
               END COD_CTA_CORREN_BCO,

               CASE--COD_DIGITO_CTA_CORREN
                 when pr.nrconta is not null then
                   to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(pr.nrdigito),'X','0',pr.nrdigito),0)))
                 else
                   case
                     --SE TIVER '-' (SEPARADOR), utiliza como criterio para separar digito verificador
                     WHEN INSTR(T.NRCONTA_BANCARIA, '-') > 0 THEN
                       to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(SUBSTR(T.NRCONTA_BANCARIA,INSTR(T.NRCONTA_BANCARIA, '-') + 1,1)),'X','0',
                       SUBSTR(T.NRCONTA_BANCARIA,INSTR(T.NRCONTA_BANCARIA, '-') + 1,1)),0)))
                     ELSE ' '
                   end
               END COD_DIGITO_CTA_CORREN,

               DECODE(T.TPCONTA,
                      'CC',
                      'CONTA CORRENTE',
                      'CA',
                      'CONTA APLICACAO',
                      'CP',
                      'CONTA POUPANCA',
                      'CX',
                      'CONTA CAIXA',
                      'TIPO DE CONTA NAO IDENTIFICADO') TPCONTA
          FROM FORNECEDOR_AGENCIA_BANCARIA         T,
               PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA F,
               TI_PESSOA                           P,
               FORNEC_FINANC                       FF,
               producao.prestador@unicoo_homologa  PR
         WHERE T.CDFORNECEDOR = F.CDFORNECEDOR
           AND F.NRREGISTRO_FORNECEDOR = P.NRREGISTRO
           AND FF.U##COD_EMPRESA = PCOD_EMPRESA
           AND P.CDN_FORNECEDOR = FF.CDN_FORNECEDOR
           AND P.CDN_FORNECEDOR IS NOT NULL
           and pr.nrregistro_prest(+) = f.nrregistro_fornecedor
         order by t.CDFORNECEDOR,
                  DECODE(T.AOENVIO_BANCO, 'S', 'A', T.AOENVIO_BANCO), --passar antes pela conta principal
                  DECODE(T.AOCONTA_PRESTADOR, 'S', 'A', T.AOCONTA_PRESTADOR), --passar antes pelas contas de prestador
                  decode(T.tpconta, 'CC', 'AA', T.TPCONTA); --passar antes por conta corrente
    BEGIN

    dbms_output.enable(null);
    dbms_output.put_line('ponto 1 BEGIN');

    -- Delete realizado para automatizar o processo do Jenkins
      DELETE FROM cta_corren_fornec;

          dbms_output.put_line('delete');

--      dbms_output.enable(null);

--      delete from cta_corren_fornec_falha; linha retirada pois estava causando lock

      FOR X IN C_ATU LOOP
        dbms_output.put_line('apos o for');

--      dbms_output.put_line(x.cod_banco || ';' || x.cod_agenc_bcia || ';' || x.cod_digito_agenc_bcia || ';' || X.COD_CTA_CORREN_BCO || ';' || X.COD_DIGITO_CTA_CORREN);

dbms_output.put_line('X.CDN_FORNECEDOR: ' || X.CDN_FORNECEDOR);
dbms_output.put_line('VCDFORNEC_ANTERIOR: ' || VCDFORNEC_ANTERIOR);

        IF X.CDN_FORNECEDOR <> VCDFORNEC_ANTERIOR THEN

/*        dbms_output.put_line('banco: ' || nvl(X.COD_BANCO, ' '));
          dbms_output.put_line('agencia: ' || nvl(X.COD_AGENC_BCIA, ' '));
          dbms_output.put_line('dig.agencia: ' || to_char(F_DEFINIR_NUMERICO(upper(X.COD_DIGITO_AGENC_BCIA))));
          dbms_output.put_line('conta: ' || nvl(X.COD_CTA_CORREN_BCO, ' '));
          dbms_output.put_line('dig.conta: ' || to_char(F_DEFINIR_NUMERICO(upper(X.COD_DIGITO_CTA_CORREN))));
          dbms_output.put_line('empresa: ' || X.COD_EMPRESA);
          dbms_output.put_line('fornec: ' || X.CDN_FORNECEDOR);
*/

          UPDATE FORNEC_FINANC V
             SET V.COD_BANCO             = nvl(X.COD_BANCO, ' '),
                 V.COD_AGENC_BCIA        = nvl(X.COD_AGENC_BCIA, ' '),
                 V.COD_DIGITO_AGENC_BCIA = to_char(F_DEFINIR_NUMERICO(decode(upper(X.COD_DIGITO_AGENC_BCIA),'X','0',null,' ',X.COD_DIGITO_AGENC_BCIA))),
                 V.COD_CTA_CORREN_BCO    = nvl(X.COD_CTA_CORREN_BCO, ' '),
                 V.COD_DIGITO_CTA_CORREN = to_char(F_DEFINIR_NUMERICO(decode(upper(X.COD_DIGITO_CTA_CORREN),'X','0',null,' ',X.COD_DIGITO_CTA_CORREN)))
           WHERE V.U##COD_EMPRESA = X.COD_EMPRESA
             AND V.CDN_FORNECEDOR = X.CDN_FORNECEDOR;

          VCDFORNEC_ANTERIOR := X.CDN_FORNECEDOR;

          BEGIN
            INSERT INTO cta_corren_fornec
              (u##cod_empresa,
               cod_empresa,
               cdn_fornecedor,
               u##cod_banco,
               cod_banco,
               u##cod_agenc_bcia,
               cod_agenc_bcia,
               u##cod_digito_agenc_bcia,
               cod_digito_agenc_bcia,
               U##cod_cta_corren_bco,
               cod_cta_corren_bco,
               u##cod_digito_cta_corren,
               cod_digito_cta_corren,
               des_cta_corren,
               log_cta_corren_prefer,
               progress_recid)
            VALUES
              (x.cod_empresa,
               x.cod_empresa,
               x.cdn_fornecedor,
               nvl(X.COD_BANCO, ' '),
               nvl(X.COD_BANCO, ' '),
               nvl(X.COD_AGENC_BCIA, ' '),
               nvl(X.COD_AGENC_BCIA, ' '),
               to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_AGENC_BCIA),'X','0',null,' ',X.COD_DIGITO_AGENC_BCIA),0))),
               to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_AGENC_BCIA),'X','0',null,' ',X.COD_DIGITO_AGENC_BCIA),0))),
               nvl(X.COD_CTA_CORREN_BCO, ' '),
               nvl(X.COD_CTA_CORREN_BCO, ' '),
               to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_CTA_CORREN),'X','0',null,' ',X.COD_DIGITO_CTA_CORREN),0))),
               to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_CTA_CORREN),'X','0',null,' ',X.COD_DIGITO_CTA_CORREN),0))),
               X.TPCONTA,
               '1',
               EMS5.CTA_CORREN_FORNEC_SEQ.NEXTVAL);
          EXCEPTION
            WHEN DUP_VAL_ON_INDEX THEN
              INSERT INTO cta_corren_fornec_falha
                (u##cod_empresa,
                 cod_empresa,
                 cdn_fornecedor,
                 u##cod_banco,
                 cod_banco,
                 u##cod_agenc_bcia,
                 cod_agenc_bcia,
                 u##cod_digito_agenc_bcia,
                 cod_digito_agenc_bcia,
                 U##cod_cta_corren_bco,
                 cod_cta_corren_bco,
                 u##cod_digito_cta_corren,
                 cod_digito_cta_corren,
                 des_cta_corren,
                 log_cta_corren_prefer,
                 progress_recid,
                 txfalha)
              VALUES
                (x.cod_empresa,
                 x.cod_empresa,
                 x.cdn_fornecedor,
                 nvl(X.COD_BANCO, ' '),
                 nvl(X.COD_BANCO, ' '),
                 nvl(X.COD_AGENC_BCIA, ' '),
                 nvl(X.COD_AGENC_BCIA, ' '),
                 to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_AGENC_BCIA),'X','0',null,' ',X.COD_DIGITO_AGENC_BCIA),0))),
                 to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_AGENC_BCIA),'X','0',null,' ',X.COD_DIGITO_AGENC_BCIA),0))),
                 nvl(X.COD_CTA_CORREN_BCO, ' '),
                 nvl(X.COD_CTA_CORREN_BCO, ' '),
                 to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_CTA_CORREN),'X','0',null,' ',X.COD_DIGITO_CTA_CORREN),0))),
                 to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_CTA_CORREN),'X','0',null,' ',X.COD_DIGITO_CTA_CORREN),0))),
                 X.TPCONTA,
                 '0',
                 EMS5.CTA_CORREN_FORNEC_SEQ.CURRVAL,
                 'PESSOA COM CONTA CORRENTE DUPLICADA. TALVEZ ESTA PESSOA POSSUA DOIS CODIGOS DE FORNECEDOR COM AS MESMAS CONTAS. VERIFICAR TAMBEM SE AS MESMAS NAO ESTAO COM O SINALIZADOR DE ENVIA BANCO DIFERENTES');

          END;
        ELSE
          BEGIN
            INSERT INTO cta_corren_fornec
              (u##cod_empresa,
               cod_empresa,
               cdn_fornecedor,
               u##cod_banco,
               cod_banco,
               u##cod_agenc_bcia,
               cod_agenc_bcia,
               u##cod_digito_agenc_bcia,
               cod_digito_agenc_bcia,
               U##cod_cta_corren_bco,
               cod_cta_corren_bco,
               u##cod_digito_cta_corren,
               cod_digito_cta_corren,
               des_cta_corren,
               log_cta_corren_prefer,
               progress_recid)
            VALUES
              (x.cod_empresa,
               x.cod_empresa,
               x.cdn_fornecedor,
               nvl(X.COD_BANCO, ' '),
               nvl(X.COD_BANCO, ' '),
               nvl(X.COD_AGENC_BCIA, ' '),
               nvl(X.COD_AGENC_BCIA, ' '),
               to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_AGENC_BCIA),'X','0',null,' ',X.COD_DIGITO_AGENC_BCIA),0))),
               to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_AGENC_BCIA),'X','0',null,' ',X.COD_DIGITO_AGENC_BCIA),0))),
               nvl(X.COD_CTA_CORREN_BCO, ' '),
               nvl(X.COD_CTA_CORREN_BCO, ' '),
               to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_CTA_CORREN),'X','0',null,' ',X.COD_DIGITO_CTA_CORREN),0))),
               to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_CTA_CORREN),'X','0',null,' ',X.COD_DIGITO_CTA_CORREN),0))),
               X.TPCONTA,
               '0',
               EMS5.CTA_CORREN_FORNEC_SEQ.NEXTVAL);

          EXCEPTION
            WHEN DUP_VAL_ON_INDEX THEN
              INSERT INTO cta_corren_fornec_falha
                (u##cod_empresa,
                 cod_empresa,
                 cdn_fornecedor,
                 u##cod_banco,
                 cod_banco,
                 u##cod_agenc_bcia,
                 cod_agenc_bcia,
                 u##cod_digito_agenc_bcia,
                 cod_digito_agenc_bcia,
                 U##cod_cta_corren_bco,
                 cod_cta_corren_bco,
                 u##cod_digito_cta_corren,
                 cod_digito_cta_corren,
                 des_cta_corren,
                 log_cta_corren_prefer,
                 progress_recid,
                 txfalha)
              VALUES
                (x.cod_empresa,
                 x.cod_empresa,
                 x.cdn_fornecedor,
                 nvl(X.COD_BANCO, ' '),
                 nvl(X.COD_BANCO, ' '),
                 nvl(X.COD_AGENC_BCIA, ' '),
                 nvl(X.COD_AGENC_BCIA, ' '),
                 to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_AGENC_BCIA),'X','0',null,' ',X.COD_DIGITO_AGENC_BCIA),0))),
                 to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_AGENC_BCIA),'X','0',null,' ',X.COD_DIGITO_AGENC_BCIA),0))),
                 nvl(X.COD_CTA_CORREN_BCO, ' '),
                 nvl(X.COD_CTA_CORREN_BCO, ' '),
                 to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_CTA_CORREN),'X','0',null,' ',X.COD_DIGITO_CTA_CORREN),0))),
                 to_char(F_DEFINIR_NUMERICO(nvl(decode(upper(X.COD_DIGITO_CTA_CORREN),'X','0',null,' ',X.COD_DIGITO_CTA_CORREN),0))),
                 X.TPCONTA,
                 '0',
                 EMS5.CTA_CORREN_FORNEC_SEQ.CURRVAL,
                 'PESSOA COM CONTA CORRENTE DUPLICADA. TALVEZ ESTA PESSOA POSSUA DOIS CODIGOS DE FORNECEDOR COM AS MESMAS CONTAS. VERIFICAR TAMBEM SE AS MESMAS NAO ESTAO COM O SINALIZADOR DE ENVIA BANCO DIFERENTES');
          END;
        END IF;

      END LOOP;
      dbms_output.put_line('apos end loop');
    END;
    P_COMMIT_NEW;
    commit;
  END P_GERAR_DADOS_BANC_FORNEC;

  FUNCTION F_RET_MASC_BANCO(VPCOD_BANCO IN VARCHAR2, VPTIPO IN VARCHAR2)
    RETURN NUMBER IS
    -- tipo "A" agencia , "C" conta
    VRESULT NUMBER;
  BEGIN
    -- verificar se o tipo de consulta é da agencia
    IF VPTIPO = 'A' THEN
      BEGIN
        SELECT LENGTH(B.COD_FORMAT_AGENC_BCIA)
          INTO VRESULT
          FROM BANCO B
         WHERE B.COD_BANCO = VPCOD_BANCO;
      EXCEPTION
        WHEN OTHERS THEN
          RETURN 10;
      END;
      RETURN VRESULT;
    ELSIF VPTIPO = 'C' THEN
      BEGIN
        SELECT LENGTH(B.COD_FORMAT_CTA_CORREN)
          INTO VRESULT
          FROM BANCO B
         WHERE B.COD_BANCO = VPCOD_BANCO;
      EXCEPTION
        WHEN OTHERS THEN
          RETURN 10;
      END;
    END IF;
    RETURN VRESULT;
  END;

  FUNCTION F_DEFINIR_NUMERICO(VP_CODIGO VARCHAR2) RETURN NUMBER IS
    VAUX VARCHAR2(20);
  BEGIN
--    dbms_output.enable(null);
    VAUX := '';

--    dbms_output.put_line('VP_CODIGO RECEBIDO EM F_DEFINIR_NUMERICO: ' || vp_codigo);

    FOR X IN 1 .. LENGTH(VP_CODIGO) LOOP
      IF SUBSTR(VP_CODIGO, X, 1) IN
         ('0', '1', '2', '3', '4', '5', '6', '7', '8', '9') THEN
        VAUX := VAUX || SUBSTR(VP_CODIGO, X, 1);
      END IF;
    END LOOP;
    RETURN TO_NUMBER(NVL(VAUX, 0));
  END;

  procedure p_vincula_imposto_cliente is

    temp_impto_vincul_clien ems5.impto_vincul_clien%rowtype;

    cursor c_impto_clien is
      select distinct ttx.ind_clas_impto_unicoo,
                      ttx.cod_imposto_t11,
                      ttx.cod_classif_impto_t11,
                      tp.cdn_cliente
        from titulo_a_receber                 tr,
             taxa_titulo_a_receber            t,
             ti_taxa_a_receber                ttx,
             producao.cliente@unicoo_homologa cl,
             ti_pessoa                        tp
       where tr.nrregistro_titulo = t.nrregistro_titulo
         and ttx.cod_taxa_unicoo = t.cdtaxa
         and cl.cdcliente = tr.cdcliente
         and cl.nrregistro_cliente = tp.nrregistro;

  begin
    delete from ems5.impto_vincul_clien;

    update ems5.clien_financ cf
    set cf.log_retenc_impto = 0;


    for ci in c_impto_clien loop

      temp_impto_vincul_clien.u##cod_empresa       := F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA');
      temp_impto_vincul_clien.cod_empresa          := F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA');
      temp_impto_vincul_clien.cdn_cliente          := ci.cdn_cliente;
      temp_impto_vincul_clien.u##cod_pais          := F_TI_PARAMETRO_INTEGRACAO('COD_PAIS');
      temp_impto_vincul_clien.cod_pais             := F_TI_PARAMETRO_INTEGRACAO('COD_PAIS');
      temp_impto_vincul_clien.u##cod_unid_federac  := ' '; --indo espaço como está no imposto fornecedor
      temp_impto_vincul_clien.cod_unid_federac     := ' '; --indo espaço como está no imposto fornecedor
      temp_impto_vincul_clien.u##cod_imposto       := ci.cod_imposto_t11;
      temp_impto_vincul_clien.cod_imposto          := ci.cod_imposto_t11;
      temp_impto_vincul_clien.u##cod_classif_impto := ci.cod_classif_impto_t11;
      temp_impto_vincul_clien.cod_classif_impto    := ci.cod_classif_impto_t11;
      temp_impto_vincul_clien.log_impto_opcnal     := 0;
      temp_impto_vincul_clien.cod_livre_1          := ' ';
      temp_impto_vincul_clien.log_livre_1          := 0;
      temp_impto_vincul_clien.num_livre_1          := 0;
      temp_impto_vincul_clien.val_livre_1          := 0;
      temp_impto_vincul_clien.dat_livre_1          := '';
      temp_impto_vincul_clien.cod_livre_2          := ' ';
      temp_impto_vincul_clien.dat_livre_2          := '';
      temp_impto_vincul_clien.log_livre_2          := 0;
      temp_impto_vincul_clien.num_livre_2          := 0;
      temp_impto_vincul_clien.val_livre_2          := 0;
      temp_impto_vincul_clien.cdd_version          := '0';

      select ems5.impto_vincul_clien_seq.nextval
        into temp_impto_vincul_clien.progress_recid
        from dual;

      insert into ems5.impto_vincul_clien values temp_impto_vincul_clien;

      update ems5.clien_financ cf
         set cf.log_retenc_impto = 1
       where cf.cdn_cliente = ci.cdn_cliente
         and cf.log_retenc_impto = 0;

    end loop;

  end p_vincula_imposto_cliente;

--AJUSTAR CODIGO DE BLOQUEIO CONFORME CAMPO DO UNICOO CLIENTE.CDBLOQUEIO
procedure P_ATUALIZA_BLOQUEIO_CLIENTE IS
begin
  for x in (select substr(lpad(nvl(c.cdbloqueio,'000'),3,'0'),1,3) cdbloqueio, cf.progress_recid
              from producao.cliente@unicoo_homologa c,
                   ems5.clien_financ                cf,
                   ti_pessoa                        tp
             where tp.nrregistro = c.nrregistro_cliente
               and tp.cdn_cliente = cf.cdn_cliente) loop

    update ems5.clien_financ cf
       set cf.u##cod_classif_msg_cobr = x.cdbloqueio,
           cf.cod_classif_msg_cobr    = x.cdbloqueio
     where cf.progress_recid = x.progress_recid;
  end loop;
end P_ATUALIZA_BLOQUEIO_CLIENTE;

--select distinct cod_classif_msg_cobr, count(*) from clien_financ group by cod_classif_msg_cobr

  PROCEDURE P_VINCULA_IMPOSTO_FORNEC IS
    /*
    ***************************************************************************************************************
    Criac?o          : -
    Data             : -
    Modulo Principal : Integrac?o EMS5
    Modulos          : -
    Objetivo         : vincular os impostos do fornecedor no EMS5
    Alteracoes
    +------------------------------------------------------------------------------------------------------------------------------------------+
    | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 01/07/2014 | JOSIAS        |               |           | Atualizações necessárias   |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    */



  VIMPTO_VINCULADO CHAR;
  CDIMPOSTO_UNICOO VARCHAR2(100);
  CDCLAS_IMPTO_UNICOO VARCHAR2(100);

  BEGIN

 -- DBMS_OUTPUT.ENABLE(NULL);
    DELETE FROM IMPTO_VINCUL_FORNEC;
    UPDATE FORNEC_FINANC F
    	SET F.LOG_RETENC_IMPTO = 0;

    BEGIN
      INSERT INTO IMPTO_VINCUL_FORNEC
        SELECT F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') U##COD_EMPRESA,
               F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') COD_EMPRESA,
               CDN_FORNECEDOR,
               F_TI_PARAMETRO_INTEGRACAO('COD_PAIS') U##COD_PAIS,
               F_TI_PARAMETRO_INTEGRACAO('COD_PAIS') COD_PAIS,
               ' ' /*COD_UNID_FEDERAC*/ U##COD_UNID_FEDERAC,
               ' ' /*COD_UNID_FEDERAC*/ COD_UNID_FEDERAC,
               CDTAXA U##COD_IMPOSTO,
               CDTAXA COD_IMPOSTO,
               CDCLASS U##COD_CLASSIF_IMPTO,
               CDCLASS COD_CLASSIF_IMPTO,
               0 LOG_IMPTO_OPCNAL,
               ' ' COD_LIVRE_1,
               0 LOG_LIVRE_1,
               0 NUM_LIVRE_1,
               0 VAL_LIVRE_1,
               TRUNC(SYSDATE) DAT_LIVRE_1,
               0 NUMREDUZRENDTOTRIBUT,
               ' ' COD_LIVRE_2,
               NULL DAT_LIVRE_2,
               0 LOG_LIVRE_2,
               0 NUM_LIVRE_2,
               0 VAL_LIVRE_2,
               0 CDD_VERSION,
               EMS5.IMPTO_VINCUL_FORNEC_SEQ.NEXTVAL PROGRESS_RECID
          FROM (SELECT DISTINCT F_TI_IMPOSTO_AGRUPADO(XX.COD_IMPOSTO,
                                                      TTP.NRREGISTRO_TITULO) CDTAXA,
                                F_TI_IMPOSTO_AGRUPADO(XX.COD_CLASSIF_IMPTO,
                                                      TTP.NRREGISTRO_TITULO) CDCLASS,
                                TIP.CDN_FORNECEDOR,
                                XX.COD_UNID_FEDERAC
                  FROM TAXA_TITULO_A_PAGAR                 TTP,
                       TITULO_A_PAGAR                      TP,
                       PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FN,
                       TI_TAXA_A_PAGAR                     XX,
                       TI_PESSOA                           TIP,
                       TI_FORNECEDOR                       TIF
                 WHERE XX.COD_TAXA = TTP.CDTAXA
                   AND TIP.NRREGISTRO = FN.NRREGISTRO_FORNECEDOR
                   AND FN.CDFORNECEDOR = TP.CDFORNECEDOR
                   AND TP.NRREGISTRO_TITULO = TTP.NRREGISTRO_TITULO
                   AND TIF.NRPESSOA = TIP.NRREGISTRO
                   AND TIP.CDN_FORNECEDOR IS NOT NULL
                   AND NOT EXISTS
                 (SELECT 1
                          FROM IMPTO_VINCUL_FORNEC IVF
                         WHERE IVF.CDN_FORNECEDOR    = TIP.CDN_FORNECEDOR
                           AND IVF.COD_CLASSIF_IMPTO =
                               F_TI_IMPOSTO_AGRUPADO(XX.COD_CLASSIF_IMPTO,
                                                     TTP.NRREGISTRO_TITULO)
                           AND IVF.U##COD_EMPRESA     = F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --'1' --FN.COD_EMPRESA
                           AND IVF.U##COD_PAIS        = F_TI_PARAMETRO_INTEGRACAO('COD_PAIS') --'BRA' --FN.COD_PAIS
                           AND IVF.U##COD_UNID_FEDERAC = ' '
                           AND IVF.U##COD_UNID_FEDERAC = COD_UNID_FEDERAC
                           AND IVF.U##COD_IMPOSTO      = XX.COD_IMPOSTO));
    exception
      when others then
        raise_application_error(-20100,
                                ' erro inserindo impostos ' || sqlerrm);
    end;
   -- P_COMMIT_NEW;

    /* Alex Boeira - 20/02/2017 - garantir vinculacao de INSSPF e IRPF para Fornecedores PF.
     *               Motivo: conforme Luiz Henrique (Unimed NI), caso o prestador não recolha
     *                       pela Unimed (tem outra fonte), não é gerada movimentação de recolhimento,
     *                       o que faz com que a lógica acima deixe de gerar a vinculação do INSSPF.
     *                       Além disso, há prestadores com produção inferior ao valor mínimo para
     *                       retenção de IR, dessa forma também não cria TAXA_TITULO_A_PAGAR.
     */
/*
    BEGIN
      INSERT INTO IMPTO_VINCUL_FORNEC
        SELECT
               trim(upper(F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA'))) U##COD_EMPRESA,
               trim(F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')) COD_EMPRESA,
               trim(tip.CDN_FORNECEDOR),
               trim(upper(F_TI_PARAMETRO_INTEGRACAO('COD_PAIS'))) U##COD_PAIS,
               trim(F_TI_PARAMETRO_INTEGRACAO('COD_PAIS')) COD_PAIS,
               upper(t.COD_UNID_FEDERAC) U##COD_UNID_FEDERAC,
               t.COD_UNID_FEDERAC COD_UNID_FEDERAC,
               trim(upper(i.cod_imposto)) U##COD_IMPOSTO,
               trim(i.cod_imposto) COD_IMPOSTO,
               trim(upper(t.cod_classif_impto)) U##COD_CLASSIF_IMPTO,
               trim(t.cod_classif_impto) COD_CLASSIF_IMPTO,
               0 LOG_IMPTO_OPCNAL,
               ' ' COD_LIVRE_1,
               0 LOG_LIVRE_1,
               0 NUM_LIVRE_1,
               0 VAL_LIVRE_1,
               TRUNC(SYSDATE) DAT_LIVRE_1,
               0 NUMREDUZRENDTOTRIBUT,
               ' ' COD_LIVRE_2,
               NULL DAT_LIVRE_2,
               0 LOG_LIVRE_2,
               0 NUM_LIVRE_2,
               0 VAL_LIVRE_2,
               0 CDD_VERSION,
               EMS5.IMPTO_VINCUL_FORNEC_SEQ.NEXTVAL PROGRESS_RECID
          from ems5.imposto i,
               ti_taxa_a_pagar t,
               TI_PESSOA                           TIP,
               TI_FORNECEDOR                       TIF
          where t.cod_imposto = i.cod_imposto
            AND (   (UPPER(I.DES_IMPOSTO) LIKE '%' || 'INSS' || '%' || 'PF'  || '%')
                 OR (UPPER(I.DES_IMPOSTO) LIKE '%' || 'INSS' || '%' || 'FIS' || '%')
                 OR (UPPER(I.DES_IMPOSTO) LIKE '%' || 'IR'   || '%' || 'PF'  || '%')
                 OR (UPPER(I.DES_IMPOSTO) LIKE '%' || 'IR'   || '%' || 'FIS' || '%')
                )
            and tif.cod_fornecedor = tip.cdn_fornecedor
            and tif.ind_tipo_pessoa = 'F'
            and tif.cod_acao = 'I'
            AND NOT EXISTS
           (SELECT 1
              FROM IMPTO_VINCUL_FORNEC IVF
             where IVF.U##COD_EMPRESA       = trim(upper(F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA'))) --'1' --FN.COD_EMPRESA
               and IVF.CDN_FORNECEDOR       = trim(TIP.CDN_FORNECEDOR)
               AND IVF.U##COD_PAIS          = trim(upper(F_TI_PARAMETRO_INTEGRACAO('COD_PAIS'))) --'BRA' --FN.COD_PAIS
               AND IVF.U##COD_UNID_FEDERAC  = upper(t.COD_UNID_FEDERAC) -- ' '
               AND IVF.U##COD_IMPOSTO       = trim(upper(i.cod_imposto))
               AND IVF.U##COD_CLASSIF_IMPTO = trim(upper(t.cod_classif_impto)));
    exception
      when others then
        raise_application_error(-20100,
                                ' erro inserindo impostos ' || sqlerrm);
    end;
    */

    CDIMPOSTO_UNICOO    := unicoogps.F_TM_PARAMETRO('CDIMPOSTO_UNICOO');
    CDCLAS_IMPTO_UNICOO := unicoogps.F_TM_PARAMETRO('CDCLAS_IMPTO_UNICOO');

    FOR X IN (SELECT tp.cdn_fornecedor CDFORNECEDOR, p.tppessoa
              FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA F,
                   PRODUCAO.PRESTADOR@UNICOO_HOMOLOGA  PR,
                   PRODUCAO.pessoa@UNICOO_HOMOLOGA     P,
                   ti_pessoa                           tp
             WHERE F.CDFORNECEDOR = PR.CDPRESTADOR
               and p.nrregistro  = pr.nrregistro_prest
               and p.nrregistro = tp.nrregistro) LOOP


          --se o prestador possui os 3 impostos abaixo, significa que utiliza IMPOSTO UNICO
          if unicoogps.pck_migracao_txt_gp.FN_BUSCA_IMPOSTO('COFINS',
                                                            x.TPPESSOA,
                                                            x.CDFORNECEDOR) is not null and
             unicoogps.pck_migracao_txt_gp.FN_BUSCA_IMPOSTO('CSLL',
                                                            x.TPPESSOA,
                                                            x.CDFORNECEDOR) is not null and
             unicoogps.pck_migracao_txt_gp.FN_BUSCA_IMPOSTO('PIS',
                                                            x.TPPESSOA,
                                                            x.CDFORNECEDOR) is not null then

            BEGIN
             --VERIFICA SE IMPOSTO UNICOO E´STA VINCULADO AO FORNECEDOR
              SELECT 'S'
                INTO VIMPTO_VINCULADO
                FROM EMS5.IMPTO_VINCUL_FORNEC IVF
               WHERE IVF.CDN_FORNECEDOR = X.CDFORNECEDOR
                 AND IVF.U##COD_IMPOSTO = CDIMPOSTO_UNICOO
                 AND IVF.U##COD_CLASSIF_IMPTO = CDCLAS_IMPTO_UNICOO;
            EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  --SE NAO ESTIVER VINCULADO, FAZ O VINCULO
                  BEGIN
                    INSERT INTO EMS5.IMPTO_VINCUL_FORNEC

                    VALUES
                    ('1', --u##cod_empresa,
                     '1', --cod_empresa,
                     X.CDFORNECEDOR, --cdn_fornecedor,
                     'BRA', --u##cod_pais,
                     'BRA', --cod_pais,
                     ' ', --u##cod_unid_federac,
                     ' ', --cod_unid_federac,
                     CDIMPOSTO_UNICOO, --u##cod_imposto,
                     CDIMPOSTO_UNICOO, --cod_imposto,
                     CDCLAS_IMPTO_UNICOO, --u##cod_classif_impto,
                     CDCLAS_IMPTO_UNICOO, --cod_classif_impto,
                     0, --log_impto_opcnal,
                     ' ', --cod_livre_1,
                     0, --log_livre_1,
                     0, --num_livre_1,
                     0, --val_livre_1,
                     NULL, --dat_livre_1,
                     0, --numreduzrendtotribut,
                     ' ', --cod_livre_2,
                     NULL, --dat_livre_2,
                     0, --log_livre_2,
                     0, --num_livre_2,
                     0, --val_livre_2,
                     0, --cdd_version,
                     EMS5.IMPTO_VINCUL_FORNEC_SEQ.NEXTVAL --progress_recid
                     );
                  EXCEPTION
                    WHEN DUP_VAL_ON_INDEX THEN
                      NULL;
                  END;
            END;
          END IF;
    END LOOP;

    -------------------
    UPDATE FORNEC_FINANC F
       SET F.LOG_RETENC_IMPTO = 1
     WHERE EXISTS (SELECT 1
              FROM IMPTO_VINCUL_FORNEC I
             WHERE I.U##COD_EMPRESA = F.U##COD_EMPRESA
               AND I.CDN_FORNECEDOR = F.CDN_FORNECEDOR);

    COMMIT;

  END P_VINCULA_IMPOSTO_FORNEC;

  PROCEDURE P_CONTABILIZACAO(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                             PNRPERIODO                 IN NUMBER,
                             PCDLOTE_INTEGRACAO         IN VARCHAR2,
                             PTXDESCRICAO_LOTE          IN VARCHAR2,
                             PDTLOTE                    IN DATE,
                             PCDEMPRESA                 IN VARCHAR2,
                             PTPPERIODO                 IN VARCHAR2,
                             PI_NRLOTE                  IN NUMBER,
                             PI_CDFUNCIONARIO           IN VARCHAR2) IS
    /*
    ***************************************************************************************************************
    Criac?o          : -
    Data             : -
    Modulo Principal : Integrac?o EMS5
    Modulos          : -
    Telas            : CR05FC7
    Objetivo         : Enviar os titulos do Unicoo para o EMS5

    Alteracoes
    +------------------------------------------------------------------------------------------------------------------------------------------+
    | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 04/11/2009 | ALECSANDRO    |               |           | A tabela TI_LANCAMENTO_CONTABIL foi alterada para TI_ITEM_LANCAMENTO_CONTABIL   |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 06/07/2009 | ERIC ARANTES  |               |           | Criado os cursores para trazer o centro custo no lancamento contabil            |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 01/07/2014 | JOSIAS        |               |           | Atualizações necessárias   |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|

    */
    CURSOR C_LANCTO_DEB IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             LC.CDCONTA_MEMO_DEB,
             LC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_DEB CDCONTA_CONTABIL,
             'DB' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO
        FROM LANCAMENTO_CONTABIL LC
       WHERE LC.CDCONTA_DEB IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND (LC.CDLANCTO_PADRAO =
             'L' ||
             SUBSTR(TO_NUMBER(SUBSTR(PCDLOTE_INTEGRACAO, 2, 10)), 1, 5) --pcdlote_integracao
             OR PCDLOTE_INTEGRACAO IS NULL);
    CURSOR C_LANCTO_CRED IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             LC.CDCONTA_MEMO_DEB,
             LC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_CRED CDCONTA_CONTABIL,
             'CR' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO
        FROM LANCAMENTO_CONTABIL LC
       WHERE LC.CDCONTA_CRED IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND (LC.CDLANCTO_PADRAO =
             'L' ||
             SUBSTR(TO_NUMBER(SUBSTR(PCDLOTE_INTEGRACAO, 2, 10)), 1, 5) --pcdlote_integracao
             OR PCDLOTE_INTEGRACAO IS NULL);
    /*
    TODO: owner="Eric" created="08/07/2010"
    text="Não sei se as outras integrações também recebem obrigatóriamente um numero de lote, por isso fiz esse tratamento em cursor separado para não afetar o que já funciona em "
    */
    ----> cursor para o fechamento de estoque
    CURSOR C_LANCTO_DEB_2 IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             IC.CDCONTA_MEMO_DEB,
             IC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_DEB CDCONTA_CONTABIL,
             'DB' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO,
             IC.CDORIGEM
        FROM LANCAMENTO_CONTABIL LC, INTEGRACAO_CONTABIL IC
       WHERE LC.NRLANCAMENTO = IC.NRLANCAMENTO
         AND LC.NRSEQ_LANCTO = IC.NRSEQ_LANCTO
         AND LC.CDCONTA_DEB IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND IC.NRLOTE_INTEGRACAO = PI_NRLOTE
         AND (LC.CDLANCTO_PADRAO = PCDLOTE_INTEGRACAO OR
             PCDLOTE_INTEGRACAO IS NULL);
    CURSOR C_LANCTO_CRED_2 IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             IC.CDCONTA_MEMO_DEB,
             IC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_CRED CDCONTA_CONTABIL,
             'CR' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO,
             IC.CDORIGEM
        FROM LANCAMENTO_CONTABIL LC, INTEGRACAO_CONTABIL IC
       WHERE LC.NRLANCAMENTO = IC.NRLANCAMENTO
         AND LC.NRSEQ_LANCTO = IC.NRSEQ_LANCTO
         AND LC.CDCONTA_CRED IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND IC.NRLOTE_INTEGRACAO = PI_NRLOTE
         AND (LC.CDLANCTO_PADRAO = PCDLOTE_INTEGRACAO OR
             PCDLOTE_INTEGRACAO IS NULL);
    VCOD_CCUSTO TI_CENTRO_CUSTO_CTBL.COD_CCUSTO%TYPE;
    VCOD_ESTAB  TI_CENTRO_CUSTO_CTBL.COD_ESTAB%TYPE;
    VA_CODESTAB VARCHAR2(2) := '01';
    VCDSITUACAO VARCHAR2(2);
  BEGIN
    INSERT INTO TI_LOTE_CTBL
      (NRSEQ_CONTROLE_INTEGRACAO,
       CDSITUACAO,
       NRPERIODO,
       COD_PLANO_CTA_CTBL,
       COD_PLANO_CCUSTO,
       DAT_LOTE_CTBL,
       DAT_PROCESSAMENTO,
       DAT_GERACAO,
       DES_LOTE_CTBL,
       AOLOTE_INTEGRACAO)
      SELECT PNRSEQ_CONTROLE_INTEGRACAO,
             'RC' CDSITUACAO,
             PNRPERIODO,
             F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CTA_CTBL') COD_PLANO_CTA_CTBL,
             F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') COD_PLANO_CCUSTO,
             PDTLOTE,
             SYSDATE DAT_PROCESSAMENTO,
             SYSDATE DAT_GERACAO,
             CASE
               WHEN PTXDESCRICAO_LOTE LIKE 'APROPRIACAO PROD.PREST%' THEN
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || 'APROP. PAGPREST' ||
                       SUBSTR(PTXDESCRICAO_LOTE, 24, 21),
                       1,
                       40)
               WHEN PTXDESCRICAO_LOTE LIKE
                    'APROPRIACAO DAS FATURAS EMITIDAS%' THEN
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || 'APROP. FAT EMITIDAS' ||
                       SUBSTR(PTXDESCRICAO_LOTE, 24, 21),
                       1,
                       40)
               WHEN PTXDESCRICAO_LOTE LIKE
                    'APROPRIACAO DAS FATURAS VENCIDAS%' THEN
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || 'APROP. FAT VENCIDAS' ||
                       SUBSTR(PTXDESCRICAO_LOTE, 24, 21),
                       1,
                       40)
               ELSE
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || PTXDESCRICAO_LOTE, 1, 40)
             END DES_LOTE_CTBL,
             DECODE(PCDLOTE_INTEGRACAO, NULL, 'N', 'S')
        FROM DUAL;
    --=========
    IF PI_CDFUNCIONARIO != 'SISMV' THEN
      FOR L_LANCTO_CRED IN C_LANCTO_CRED LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
            INTO VCOD_CCUSTO, VCOD_ESTAB
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and  cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_CRED.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            VCOD_CCUSTO := ' ';
            VCOD_ESTAB  := '01';
        END;
        IF L_LANCTO_CRED.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
        END IF;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_CRED.CDCONTA_CONTABIL,
           L_LANCTO_CRED.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_CRED.TXHISTORICO, 1, 2000),
           L_LANCTO_CRED.DTLANCAMENTO,
           L_LANCTO_CRED.VLLANCAMENTO,
           VCOD_CCUSTO,
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VCOD_ESTAB --, '01' --va_codestab
          ,
           L_LANCTO_CRED.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --, '1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --, 'UNI'
          ,
           L_LANCTO_CRED.NRLANCAMENTO,
           L_LANCTO_CRED.NRSEQ_LANCTO);
      END LOOP;
      --=========
      FOR L_LANCTO_DEB IN C_LANCTO_DEB LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
            INTO VCOD_CCUSTO, VCOD_ESTAB
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_DEB.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            VCOD_CCUSTO := ' ';
            VCOD_ESTAB  := '01';
        END;
        IF L_LANCTO_DEB.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
        END IF;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_DEB.CDCONTA_CONTABIL,
           L_LANCTO_DEB.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_DEB.TXHISTORICO, 1, 2000),
           L_LANCTO_DEB.DTLANCAMENTO,
           L_LANCTO_DEB.VLLANCAMENTO,
           VCOD_CCUSTO,
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VCOD_ESTAB --, '01'--va_codestab
          ,
           L_LANCTO_DEB.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --'1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --'UNI'
          ,
           L_LANCTO_DEB.NRLANCAMENTO,
           L_LANCTO_DEB.NRSEQ_LANCTO);
      END LOOP;
      ------------------ no caso de fechamento do estoque entra nesse loop ----------------------------------
    ELSE
      FOR L_LANCTO_CRED2 IN C_LANCTO_CRED_2 LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
            INTO VCOD_CCUSTO, VCOD_ESTAB
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and  cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_CRED2.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            IF SUBSTR(L_LANCTO_CRED2.CDCONTA_CONTABIL, 1, 1) IN ('7', '4') THEN
              VCOD_CCUSTO := NVL(L_LANCTO_CRED2.CDCONTA_MEMO_CRED,
                                 L_LANCTO_CRED2.CDCONTA_MEMO_DEB);
            ELSE
              VCOD_CCUSTO := ' ';
              VCOD_ESTAB  := '01';
            END IF;
        END;
        IF L_LANCTO_CRED2.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
        END IF;
        --vcod_ccusto := null; --l_lancto_cred2.cdconta_memo_cred;
        VA_CODESTAB := L_LANCTO_CRED2.CDORIGEM;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_CRED2.CDCONTA_CONTABIL,
           L_LANCTO_CRED2.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_CRED2.TXHISTORICO, 1, 2000),
           L_LANCTO_CRED2.DTLANCAMENTO,
           L_LANCTO_CRED2.VLLANCAMENTO,
           NVL(VCOD_CCUSTO, ' '),
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VA_CODESTAB,
           L_LANCTO_CRED2.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --'1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --'UNI'
          ,
           L_LANCTO_CRED2.NRLANCAMENTO,
           L_LANCTO_CRED2.NRSEQ_LANCTO);
      END LOOP;
      FOR L_LANCTO_DEB2 IN C_LANCTO_DEB_2 LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO
            INTO VCOD_CCUSTO
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_DEB2.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            IF SUBSTR(L_LANCTO_DEB2.CDCONTA_CONTABIL, 1, 1) IN ('7', '4') THEN
              VCOD_CCUSTO := NVL(L_LANCTO_DEB2.CDCONTA_MEMO_DEB,
                                 L_LANCTO_DEB2.CDCONTA_MEMO_CRED);
            ELSE
              VCOD_CCUSTO := ' ';
              VCOD_ESTAB  := '01';
            END IF;
        END;
        IF L_LANCTO_DEB2.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
          VCOD_ESTAB  := '01';
        END IF;
        --            vcod_ccusto := l_lancto_deb2.cdconta_memo_deb;
        VA_CODESTAB := L_LANCTO_DEB2.CDORIGEM;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_DEB2.CDCONTA_CONTABIL,
           L_LANCTO_DEB2.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_DEB2.TXHISTORICO, 1, 2000),
           L_LANCTO_DEB2.DTLANCAMENTO,
           L_LANCTO_DEB2.VLLANCAMENTO,
           NVL(VCOD_CCUSTO, ' '),
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VA_CODESTAB,
           L_LANCTO_DEB2.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --'1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --'UNI'
          ,
           L_LANCTO_DEB2.NRLANCAMENTO,
           L_LANCTO_DEB2.NRSEQ_LANCTO);
      END LOOP;
    END IF;
    --=====================================--
    -- Aplica depara da matriz de tradução --
    -----------------------------------------
    FOR L_MT IN (SELECT ILC.ROWID LINHA,
                        MT.DESTINO_COD_CCUSTO,
                        MT.DESTINO_COD_ESTAB
                   FROM TI_LOTE_CTBL_MATRIZ_TRADUCAO MT,
                        TI_ITEM_LANCAMENTO_CTBL      ILC
                  WHERE ILC.NRSEQ_CONTROLE_INTEGRACAO =
                        PNRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.COD_ESTAB = MT.COD_ESTAB
                    AND (ILC.COD_CTA_CTBL = MT.COD_CTA_CTBL OR
                        MT.COD_CTA_CTBL = '*')
                    AND (MT.COD_CCUSTO = ILC.COD_CCUSTO OR
                        MT.COD_CCUSTO = '*')
                    AND MT.COD_PLANO_CCUSTO =
                        F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                    AND (MT.DES_HISTOR_LANCTO_CTBL = '*' OR
                        MT.DES_HISTOR_LANCTO_CTBL =
                        ILC.DES_HISTOR_LANCTO_CTBL)) LOOP
      UPDATE TI_ITEM_LANCAMENTO_CTBL I
         SET I.COD_ESTAB  = L_MT.DESTINO_COD_ESTAB,
             I.COD_CCUSTO = L_MT.DESTINO_COD_CCUSTO
       WHERE I.ROWID = L_MT.LINHA;
    END LOOP;
    --============================--
    -- Validação centro de custos --
    --------------------------------
    VCDSITUACAO := 'OK';
    FOR L_CCUSTO_NAO_INFORMADO IN (SELECT COD_CTA_CTBL,
                                          COD_CCUSTO,
                                          I.COD_ESTAB,
                                          I.COD_EMPRESA,
                                          I.IND_NATUR_LANCTO_CTBL
                                     FROM TI_ITEM_LANCAMENTO_CTBL I
                                    WHERE I.NRSEQ_CONTROLE_INTEGRACAO =
                                          PNRSEQ_CONTROLE_INTEGRACAO
                                      AND I.COD_CCUSTO = ' '
                                      AND EXISTS
                                    (SELECT 1
                                             FROM CRITERDISTRIBCTACTBL A,
                                                  MAPA_DISTRIB_CCUSTO  M
                                            WHERE M.CODMAPADISTRIBCCUSTO =
                                                  A.CODMAPADISTRIBCCUSTO
                                              AND A.COD_CTA_CTBL =
                                                  I.COD_CTA_CTBL
                                              AND I.DAT_LANCTO BETWEEN
                                                  A.DAT_INIC_VALID AND
                                                  A.DAT_FIM_VALID)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_LOTE_CTBL',
           'NÃO FOI INFORMADO CENTRO DE CUSTO P/ A CONTA CONTABIL ' ||
           L_CCUSTO_NAO_INFORMADO.COD_CTA_CTBL,
           'Verifique o criterio de distribuição do EMS e os esquemas contábeis do Unicoo',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    -- Período não habilitado
    FOR L_PERIODO IN (SELECT MAX(P.COD_EXERC_CTBL ||
                                 LPAD(P.NUM_PERIOD_CTBL, 2, '0')) NRPERIODO,
                             COUNT(*) QTPERIODO,
                             MAX(COD_CENAR_CTBL) NOCENARIO
                        FROM SIT_PERIOD_CTBL P, TI_LOTE_CTBL LT
                       WHERE LT.NRSEQ_CONTROLE_INTEGRACAO =
                             PNRSEQ_CONTROLE_INTEGRACAO
                         AND P.COD_EXERC_CTBL ||
                             LPAD(P.NUM_PERIOD_CTBL, 2, '0') =
                             TO_CHAR(LT.DAT_LOTE_CTBL, 'YYYYMM')
                         AND P.IND_SIT_PERIOD_CTBL <> 'Habilitado'
                         AND P.COD_MODUL_DTSUL = 'FGL'
                         AND P.COD_EMPRESA =
                             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')) LOOP
      BEGIN
        IF L_PERIODO.QTPERIODO > 0 THEN
          INSERT INTO TI_FALHA_DE_PROCESSO
            (NRSEQUENCIAL,
             NRSEQ_CONTROLE_INTEGRACAO,
             CDINTEGRACAO,
             TXFALHA,
             TXAJUDA,
             DTFALHA,
             NRMENSAGEM)
          VALUES
            (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
             PNRSEQ_CONTROLE_INTEGRACAO,
             'TI_LOTE_CTBL',
             'O módulo FGL não esta habilitado para o cenário' ||
             L_PERIODO.NOCENARIO || ', período ' || PNRPERIODO,
             'Utilize a manutenção de período contábil, opção ajuste de período para habilitar o período',
             SYSDATE,
             NULL);
          VCDSITUACAO := 'PE';
        ELSE
          VCDSITUACAO := 'OK';
        END IF;
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
    END LOOP;
    FOR L_CE IN (SELECT ILC.*
                   FROM TI_ITEM_LANCAMENTO_CTBL ILC, TI_LOTE_CTBL LC
                  WHERE LC.NRSEQ_CONTROLE_INTEGRACAO =
                        ILC.NRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.NRSEQ_CONTROLE_INTEGRACAO =
                        PNRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.COD_CCUSTO <> ' '
                    AND EXISTS
                  (SELECT 1
                           FROM CCUSTO P
                          WHERE P.COD_CCUSTO = ILC.COD_CCUSTO
                            AND LC.DAT_LOTE_CTBL NOT BETWEEN P.DAT_INIC_VALID AND
                                P.DAT_FIM_VALID)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_LOTE_CTBL',
           'O Lançamento contábil esta com um centro de custo fora da validade. ' ||
           L_CE.COD_CTA_CTBL || ' C/C ' || L_CE.COD_CCUSTO,
           'Verifique o cadastro do plano de centro de custos',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --- Cenário exclusivo
    FOR L_CE IN (SELECT ILC.*
                   FROM TI_ITEM_LANCAMENTO_CTBL ILC, TI_LOTE_CTBL LC
                  WHERE LC.NRSEQ_CONTROLE_INTEGRACAO =
                        ILC.NRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.NRSEQ_CONTROLE_INTEGRACAO =
                        PNRSEQ_CONTROLE_INTEGRACAO
                    AND EXISTS
                  (SELECT 1
                           FROM CTA_CTBL CC
                          WHERE CC.COD_CENAR_CTBL_EXCLUS <> ' '
                            AND CC.COD_PLANO_CTA_CTBL = LC.COD_PLANO_CTA_CTBL
                            AND CC.COD_CTA_CTBL = ILC.COD_CTA_CTBL)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_LOTE_CTBL',
           'CENÁRIO EXCLUSIVO INFORMADO PARA A CONTA CONTÁBIL ' ||
           L_CE.COD_CTA_CTBL,
           'No cadastro de manutenção da conta contábil não pode ser informado o cenário',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --============================--
    -- Cta necessário cCusto      --
    -- Alessandro 18/08/2014      --
    --------------------------------
    FOR C_CTA IN (SELECT DISTINCT A.COD_CTA_CTBL, A.COD_ESTAB, A.COD_CCUSTO
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL A
                   WHERE A.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND SUBSTR(A.COD_CTA_CTBL, 1, 1) NOT IN ('1', '2')
                     AND EXISTS
                   (SELECT 1
                            FROM CRITERDISTRIBCTACTBL CD
                           WHERE CD.U##COD_CTA_CTBL = A.COD_CTA_CTBL
                             AND CD.U##COD_ESTAB = A.COD_ESTAB)
                     AND NOT EXISTS
                   (SELECT 1
                            FROM EMS506UNICOO.TI_CENTRO_CUSTO_CTBL CCC
                           WHERE CCC.COD_CTA_CTBL = A.COD_CTA_CTBL
                             AND CCC.COD_ESTAB = A.COD_ESTAB
                             AND CCC.COD_CCUSTO = A.COD_CCUSTO)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_CENTRO_CUSTO_CTBL',
           'Falta DePara de Conta Para Centro Custo',
           'Consta no TOTVS11 centro de custo para Conta ' ||
           C_CTA.COD_CTA_CTBL || ' Estab. ' || C_CTA.COD_ESTAB ||
           ' na tabela TI_CENTRO_CUSTO_CTBL',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- Restrição centro de custo por estabelecimento   --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL CCC
                   WHERE CCC.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND EXISTS
                   (SELECT 1
                            FROM RESTRIC_CCUSTO RC
                           WHERE RC.U##COD_CCUSTO = CCC.COD_CCUSTO
                             AND RC.U##COD_ESTAB = CCC.COD_ESTAB)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Restrição CCusto',
           'Há restrição de Estabelecimento para Centro de Custo',
           'Consta no TOTVS11 restrição do Estabelecimento :' ||
           C_CTA.COD_ESTAB || ' p/ CCusto ' || C_CTA.COD_CCUSTO,
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- Cta Unicoo x TOTVS11                            --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT DISTINCT A.COD_CTA_CTBL,
                                  XX.NOCONTA,
                                  EMS506UNICOO.F_TI_PARAMETRO_INTEGRACAO('NRPLANO_CONTA_UNICOO') PL_UNICOO
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL A,
                         CONTA_CONTABIL                       XX
                   WHERE A.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND XX.NRPLANO_CONTAS =
                         EMS506UNICOO.F_TI_PARAMETRO_INTEGRACAO('NRPLANO_CONTA_UNICOO')
                     AND XX.CDCONTA = A.COD_CTA_CTBL
                     AND NOT EXISTS
                   (SELECT 1
                            FROM CTA_CTBL CC
                           WHERE CC.U##COD_CTA_CTBL = A.COD_CTA_CTBL
                             AND F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CTA_CTBL') =
                                 CC.U##COD_PLANO_CTA_CTBL)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Falta Conta',
           'Há Conta Contábil no Unicoo e não cadastrada no TOTVS11',
           'Consta no Unicoo a Conta Contábil :' || C_CTA.COD_CTA_CTBL ||
           ' Desc.:  ' || C_CTA.NOCONTA || ' Plano no Unicoo.:  ' ||
           C_CTA.PL_UNICOO,
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- CCusto existe TOTVS11                           --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT CCC.COD_CCUSTO
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL CCC
                   WHERE CCC.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND CCC.COD_CCUSTO <> ' '
                     AND NOT EXISTS
                   (SELECT 1
                            FROM CCUSTO CC
                           WHERE CC.U##COD_PLANO_CCUSTO =
                                 EMS506UNICOO.F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO')
                             AND CC.U##COD_CCUSTO = CCC.COD_CCUSTO)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Falta CCusto',
           'Há Centro de Custo no Unicoo e não cadastrada no TOTVS11',
           'Consta no Unicoo o Centro de Custo: ' || C_CTA.COD_CCUSTO,
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- Centro Custo sem Unidade                        --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT COD_CCUSTO
                    FROM (SELECT A.U##COD_CCUSTO COD_CCUSTO,
                                 (SELECT B.U##COD_UNID_NEGOC
                                    FROM CCUSTO_UNID_NEGOC B
                                   WHERE B.U##COD_CCUSTO = A.U##COD_CCUSTO) CDUNID
                            FROM CCUSTO                               A,
                                 EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL CCC
                           WHERE A.U##COD_CCUSTO = CCC.COD_CCUSTO
                             AND CCC.NRSEQ_CONTROLE_INTEGRACAO =
                                 PNRSEQ_CONTROLE_INTEGRACAO) XX
                   WHERE XX.CDUNID IS NULL) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Falta CCusto sem Unidade',
           'Centro de Custo está sem Unidade de Negocio no TOTVS11',
           'Centro de Custo: ' || C_CTA.COD_CCUSTO ||
           ' está sem Unidade de Negocio.',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    IF VCDSITUACAO <> 'OK' THEN
      UPDATE TI_LOTE_CTBL LC
         SET LC.CDSITUACAO = 'PE'
       WHERE LC.NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
    END IF;
    /*select
        cod_cta_ctbl,
        cod_ccusto,
        i.cod_estab,
        i.cod_empresa,
        i.ind_natur_lancto_ctbl
    from
         ti_item_lancamento_ctbl i where i.nrseq_controle_integracao = 7192465
         and
         I.COD_CCUSTO <>' '
         AND
         not exists (
                select 1
                from
                    criterdistribctactbl a,
                    mapa_distrib_ccusto m,
                    item_lista_ccusto ic
                where
                     ic.cod_ccusto=i.cod_ccusto
                     and
                     ic.codmapadistribccusto=m.codmapadistribccusto
                     and
                     m.codmapadistribccusto=a.codmapadistribccusto
                     and
                     a.cod_cta_ctbl=i.cod_cta_ctbl
                     and
                     i.dat_lancto between a.dat_inic_valid and a.dat_fim_valid)
    */
  END;

  PROCEDURE P_TI_MOVIMENTO_CTA_CORRENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                        PNRSESSAO                  NUMBER,
                                        PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_INTEGRA_CMG IS
      SELECT CI.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
             CI.CDSITUACAO,
             CI.CDIDENTIFICADOR,
             CI.NRSEQUENCIAL_ORIGEM
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'CX'
         AND CI.CDSITUACAO = PCDSITUACAO
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0);
    VCDINTEGRACAO VARCHAR2(100);
  BEGIN
    FOR L_INTEGRA_CMG IN C_INTEGRA_CMG LOOP
      BEGIN
        PCDSITUACAO   := 'RC';
        VCDINTEGRACAO := 'TI_MOV_CTA_CORREN';
        INSERT INTO TI_MOVIMENTO_CTA_CORRENTE
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CORREN,
           DAT_MOVTO_CTA_CORREN,
           IND_TIP_MOVTO_CTA_CORREN,
           COD_TIP_TRANS_CX,
           IND_FLUXO_MOVTO_CTA_CORREN,
           COD_CENAR_CTBL,
           COD_HISTOR_PADR,
           VAL_MOVTO_CTA_CORREN,
           COD_DOCTO_MOVTO_CTA_BCO,
           COD_MODUL_DTSUL,
           IND_ERRO_VALID,
           DES_HISTOR_PADR,
           NUM_ID_MOVTO_CTA_CORREN)
          SELECT MCT.NRSEQ_CONTROLE_INTEGRACAO,
                 MCT.CDSITUACAO,
                 MCT.COD_CTA_CORREN,
                 MCT.DAT_MOVTO_CTA_CORREN,
                 MCT.IND_TIP_MOVTO_CTA_CORREN,
                 MCT.COD_TIP_TRANS_CX,
                 MCT.IND_FLUXO_MOVTO_CTA_CORREN,
                 MCT.COD_CENAR_CTBL,
                 MCT.COD_HISTOR_PADR,
                 MCT.VAL_MVTO_CTA_CORREN,
                 MCT.COD_DOCTO_MOVTO_CTA_BCO,
                 MCT.COD_MODUL_DTSUL,
                 MCT.IND_ERRO_VALID,
                 MCT.DES_HISTOR_PADR,
                 MCT.NUM_ID_MOVTO_CTA_CORREN
            FROM V_TI_MOVIMENTO_CTA_CORRENTE MCT
           WHERE NRSEQ_CONTROLE_INTEGRACAO =
                 L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO;
        IF SQL%ROWCOUNT = 0 THEN
          IF PCDSITUACAO = 'RC' THEN
            P_GRAVA_FALHA(L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO,
                          VCDINTEGRACAO,
                          'A VIEW V_TI_MOVIMENTO_CTA_CORRENTE N?O ENCONTROU MOVIMENTO CAIXA PARA O PROCESSO ==> ' ||
                          L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO ||
                          'NRMOVIMENTO ==> ' ||
                          L_INTEGRA_CMG.NRSEQUENCIAL_ORIGEM,
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        'O MOVIMENTO JA FOI ENVIADO PARA A TI_MOVIMENTO_CTA_CORRENTE ',
                        NULL,
                        PCDSITUACAO,
                        -1);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        'ERRO AO INCLUIR MOVIMENTO CAIXA NA TABELA TI_MOVIMENTO_CTA_CORRENTE ==> ' ||
                        SQLERRM || ' PROCESSO ==> ' ||
                        L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO ||
                        'NRMOVIMENTO ==> ' ||
                        L_INTEGRA_CMG.NRSEQUENCIAL_ORIGEM,
                        NULL,
                        PCDSITUACAO,
                        NULL);
      END;
      --====================================--
      -- Atualizar o situac?o da integrac?o --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  PROCEDURE P_INSERE_FORNECEDOR(PNRREGISTRO_TITULO IN NUMBER) IS
    CURSOR C_PES IS
      SELECT 'FN' PTPINTEGRACAO,
             'I' PCDACAO,
             P.NRCGC_CPF PNRCGC_CPF,
             P.NOPESSOA PNOPESSOA,
             P.NOABREVIADO,
             P.DTNASCIMENTO PDTNASCIMENTO,
             P.TPPESSOA PTPPESSOA,
             P.NRREGISTRO PNRREGISTRO,
             'FORNECEDOR' PTPORIGEM,
             F.CDFORNECEDOR PCDIDENTIFICADOR,
             F.NRREGISTRO_FORNECEDOR PNRSEQUENCIAL_ORIGEM,
             '' PCDMODULO,
             TP.CDEMPRESA PCDEMPRESA,
             '' PNRSEQ_CONTROLE_INTEGRACAO_ORG,
             '' PNOABREVIADO_FORNECEDOR,
             '' PCDN_FORNECEDOR,
             '' PNOABREVIADO_CLIENTE,
             '' PCDN_CLIENTE,
             'S' PAODEFINEPESSOA
        FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA F,
             PESSOA                              P,
             TITULO_A_PAGAR                      TP
       WHERE TP.CDFORNECEDOR = F.CDFORNECEDOR
         AND F.NRREGISTRO_FORNECEDOR = P.NRREGISTRO
         AND TP.NRREGISTRO_TITULO = PNRREGISTRO_TITULO;
  BEGIN
    FOR X IN C_PES LOOP
      PCK_EMS506UNICOO.P_DEFINE_TI_PESSOA(X.PNRCGC_CPF,
                                          X.PNOPESSOA,
                                          X.NOABREVIADO,
                                          X.PDTNASCIMENTO,
                                          X.PTPPESSOA,
                                          X.PNRREGISTRO,
                                          X.PTPORIGEM,
                                          X.PNOABREVIADO_FORNECEDOR,
                                          X.PCDN_FORNECEDOR,
                                          X.PNOABREVIADO_CLIENTE,
                                          X.PCDN_CLIENTE,
                                          X.PAODEFINEPESSOA);
      EMS506UNICOO.PCK_EMS506UNICOO.P_INS_TI_CONTROLE_INTEGRACAO(X.PTPINTEGRACAO,
                                                                 X.PCDACAO,
                                                                 X.PCDIDENTIFICADOR,
                                                                 X.PNRSEQUENCIAL_ORIGEM,
                                                                 X.PCDMODULO,
                                                                 X.PCDEMPRESA,
                                                                 X.PNRSEQ_CONTROLE_INTEGRACAO_ORG);
    END LOOP;
  END;

  PROCEDURE P_INSERE_CLIENTE(PNRREGISTRO_TITULO IN NUMBER) IS
    CURSOR C_CLI IS
      SELECT 'CL' PTPINTEGRACAO,
             'I' PCDACAO,
             P.NRCGC_CPF VNRCGC_CPF,
             P.NOPESSOA VNOPESSOA,
             P.NOABREVIADO,
             P.DTNASCIMENTO VDTNASCIMENTO,
             P.TPPESSOA VTPPESSOA,
             C.NRREGISTRO_CLIENTE PNRSEQUENCIAL_ORIGEM,
             C.CDCLIENTE PCDIDENTIFICADOR,
             'CLIENTE',
             '' VNOM_ABREV_FORNECEDOR,
             '' VCDN_FORNECEDOR,
             '' VNOM_ABREV_CLIENTE,
             '' VCDN_CLIENTE,
             TR.CDEMPRESA PCDEMPRESA,
             '' PNRSEQ_CONTROLE_INTEGRACAO_ORG,
             '' PCDMODULO
        FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA C,
             PESSOA                           P,
             TITULO_A_RECEBER                 TR
       WHERE C.NRREGISTRO_CLIENTE = P.NRREGISTRO
         AND TR.CDCLIENTE = C.CDCLIENTE
         AND TR.NRREGISTRO_TITULO = PNRREGISTRO_TITULO;
  BEGIN
    FOR X IN C_CLI LOOP
      P_DEFINE_TI_PESSOA(X.VNRCGC_CPF,
                         X.VNOPESSOA,
                         X.NOABREVIADO,
                         X.VDTNASCIMENTO,
                         X.VTPPESSOA,
                         X.PNRSEQUENCIAL_ORIGEM,
                         'CLIENTE',
                         X.VNOM_ABREV_FORNECEDOR,
                         X.VCDN_FORNECEDOR,
                         X.VNOM_ABREV_CLIENTE,
                         X.VCDN_CLIENTE,
                         'S');
      EMS506UNICOO.PCK_EMS506UNICOO.P_INS_TI_CONTROLE_INTEGRACAO(X.PTPINTEGRACAO,
                                                                 X.PCDACAO,
                                                                 X.PCDIDENTIFICADOR,
                                                                 X.PNRSEQUENCIAL_ORIGEM,
                                                                 X.PCDMODULO,
                                                                 X.PCDEMPRESA,
                                                                 X.PNRSEQ_CONTROLE_INTEGRACAO_ORG);
    END LOOP;
  END;

  procedure P_CARGA_PESSOA_UNIMED IS
    --------------------------------------
    -- gerar carga de pessoa do unimeds
    --------------------------------------
    cursor c_pes is
      select distinct 'FN' ptpintegracao,
                      'I' pcdacao,
                      nvl(p.nrcgc_cpf, '00000000000000') pnrcgc_cpf,
                      p.nopessoa pnopessoa,
                      p.noabreviado,
                      p.dtnascimento pdtnascimento,
                      p.tppessoa ptppessoa,
                      p.nrregistro pnrregistro,
                      'UNIMED' ptporigem,
                      f.cdfornecedor pcdidentificador,
                      p.nrregistro pnrsequencial_origem,
                      '' pcdmodulo,
                      '' pcdempresa,
                      '' pnrseq_controle_integracao_org,
                      '' pnoabreviado_fornecedor,
                      '' pcdn_fornecedor,
                      '' pnoabreviado_cliente,
                      '' pcdn_cliente,
                      'S' paodefinepessoa
        from producao.fornecedor@unicoo_homologa f,
             pessoa                              p,
             area_de_acao                        aa
       where f.nrregistro_fornecedor = p.nrregistro
            --and f.nrregistro_fornecedor not in (1976,1075,1628)
            --and f.cdsituacao_fornecedor = 'A'
            --and aa.nrregistro_pessoa   = f.nrregistro_fornecedor
         and aa.cdprestador = f.cdfornecedor
         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = aa.cdprestador
                 and ci.tpintegracao = 'FN');
    vcommit number;
  begin
    vcommit := 1;

    for x in c_pes loop
      begin
        pck_ems506unicoo.p_define_ti_pessoa(x.pnrcgc_cpf,
                                            x.pnopessoa,
                                            x.noabreviado,
                                            x.pdtnascimento,
                                            x.ptppessoa,
                                            x.pnrregistro,
                                            x.ptporigem,
                                            x.pnoabreviado_fornecedor,
                                            x.pcdn_fornecedor,
                                            x.pnoabreviado_cliente,
                                            x.pcdn_cliente,
                                            x.paodefinepessoa);

      exception
        when others then
          raise_application_error(-20100,
                                  ' Pessoa :' || x.pnrsequencial_origem || ' ' ||
                                  sqlerrm);
          null;
      end;

      ems506unicoo.pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                                 x.pcdacao,
                                                                 x.pcdidentificador,
                                                                 x.pnrsequencial_origem,
                                                                 x.pcdmodulo,
                                                                 x.pcdempresa,
                                                                 x.pnrseq_controle_integracao_org);

      if vcommit >= 500 then
        --Commit;
        vcommit := 1;
      else
        vcommit := vcommit + 1;
      end if;
    end loop;
    --commit;

    P_JOB;

    --COMMIT;

    P_COD_UNIMED_FORNECEDOR;

    --COMMIT;

  end P_CARGA_PESSOA_UNIMED;

  procedure P_COD_UNIMED_FORNECEDOR is
    cursor c_for is
      select distinct f.nrpessoa, a.cdareaacao
        from ti_fornecedor                       f,
             area_de_acao                        a,
             producao.fornecedor@unicoo_homologa xx
       where f.nrpessoa = xx.nrregistro_fornecedor
         and xx.cdfornecedor = a.cdprestador
         and f.cdsituacao = 'RC';

  begin
    for x in c_for loop

      update ti_pessoa p
         set p.cdn_fornecedor = x.cdareaacao, P.CDN_CLIENTE = X.cdareaacao
       where p.nrregistro = x.nrpessoa;

      update ti_fornecedor f
         set f.cod_fornecedor = x.cdareaacao
       where f.nrpessoa = x.nrpessoa;

    end loop;
    --commit;
  end P_COD_UNIMED_FORNECEDOR;

  PROCEDURE P_CARGA_INICIAL_FORNECEDOR IS
    hash_atual varchar2(100);
    hash_anterior varchar2(100);
    --------------------------------------
    -- gerar carga de pessoa do fornecedor
    --------------------------------------

    cursor c_pes is
      --1a parte: relaciona os FORNECEDORES que estao em TI_MATRIZ_PAGAR (possuem titulo)
      select distinct 'FN' ptpintegracao,
                      'I' pcdacao,
                      nvl(trim(replace(replace(replace(p.nrcgc_cpf,
                                                       '-',
                                                       null),
                                               ',',
                                               null),
                                       '.',
                                       null)),
                          '00000000000000') pnrcgc_cpf,
                      p.nopessoa pnopessoa,
                      p.noabreviado,
                      p.dtnascimento pdtnascimento,
                      p.tppessoa ptppessoa,
                      p.nrregistro pnrregistro,
                      'FORNECEDOR' ptporigem,
                      f.cdfornecedor pcdidentificador,
                      f.nrregistro_fornecedor pnrsequencial_origem,
                      '' pcdmodulo,
                      '' pcdempresa,
                      '' pnrseq_controle_integracao_org,
                      '' pnoabreviado_fornecedor,
                      '' pcdn_fornecedor,
                      '' pnoabreviado_cliente,
                      '' pcdn_cliente,
                      'S' paodefinepessoa
        from producao.fornecedor@unicoo_homologa f,
             pessoa                              p,
             ti_matriz_pagar                     tm
       where f.nrregistro_fornecedor = p.nrregistro
         and p.nrregistro = tm.nrregistro
         and tm.cdfornecedor = f.cdfornecedor
         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = f.cdfornecedor
                 and ci.tpintegracao = 'FN')
      union all
      --2a parte: relaciona FORNECEDORES que nao possuem titulos, desde que nao estejam
      --          associados ao grupo NAOM no DEPARA TI_GRUPO_DE_FORNECEDOR
      select distinct 'FN' ptpintegracao,
                      'I' pcdacao,
                      nvl(trim(replace(replace(replace(p.nrcgc_cpf,
                                                       '-',
                                                       null),
                                               ',',
                                               null),
                                       '.',
                                       null)),
                          '00000000000000') pnrcgc_cpf,
                      p.nopessoa pnopessoa,
                      p.noabreviado,
                      p.dtnascimento pdtnascimento,
                      p.tppessoa ptppessoa,
                      p.nrregistro pnrregistro,
                      'FORNECEDOR' ptporigem,
                      f.cdfornecedor pcdidentificador,
                      f.nrregistro_fornecedor pnrsequencial_origem,
                      '' pcdmodulo,
                      '' pcdempresa,
                      '' pnrseq_controle_integracao_org,
                      '' pnoabreviado_fornecedor,
                      '' pcdn_fornecedor,
                      '' pnoabreviado_cliente,
                      '' pcdn_cliente,
                      'S' paodefinepessoa
        from producao.fornecedor@unicoo_homologa f,
             pessoa                              p,
             ti_grupo_de_fornecedor              tif
       where f.nrregistro_fornecedor = p.nrregistro
         and tif.cdgrupo_fornecedor = f.cdgrupo_fornecedor
         and tif.cod_grp_fornecedor <> 'NAOM'
         -- descarta os casos que estao em TI_MATRIZ_PAGAR, pois ja foram relacionados no select anterior
         and not exists
       (select 1
                from ti_matriz_pagar tm
               where tm.nrregistro = f.nrregistro_fornecedor)

         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = f.cdfornecedor
                 and ci.tpintegracao = 'FN')
       order by pnrregistro desc;

    vcommit number;
  begin
    dbms_output.enable(null);
    --dbms_output.disable;

    --apagar TI_FORNECEDOR com erro para reprocessamento
    delete from ti_falha_de_processo tf
     where exists (select 1
              from ti_controle_integracao tc
             where tf.nrseq_controle_integracao = tc.nrsequencial
               and tc.tpintegracao = 'FN'
               and tc.cdsituacao in ('PE', 'ER'));
    delete from ti_fornecedor c where c.cdsituacao IN ('PE', 'ER');
    update ti_controle_integracao tc set tc.cdsituacao = 'GE' where tc.tpintegracao = 'FN' and tc.cdsituacao in ('PE','ER');

    --apagar TI_FORNECEDOR caso o hash do registro original do Unicoo tenha mudado.
    --isso fara com que o registro seja atualizado no TOTVS na proxima execucao da api progress.
    for x in (select c.cdidentificador, c.nrsequencial_origem, f.nrseq_controle_integracao,
                     f.cod_fornecedor, f.nrpessoa, c.nrsequencial
                from ti_fornecedor f, ti_controle_integracao c
               where f.nrseq_controle_integracao = c.nrsequencial
                 and f.cdsituacao = 'IT') loop
        hash_atual := gerar_hash_fornecedor_unicoo(x.cdidentificador, x.nrsequencial_origem);
        hash_anterior := get_hash('FN',x.cdidentificador, x.nrsequencial_origem);

        if hash_atual <> hash_anterior then
          dbms_output.put_line('DIFERENTE. APAGAR! ' || x.nrseq_controle_integracao || ';' || x.cod_fornecedor || ';' || x.nrpessoa || ';' || hash_atual || ';' || hash_anterior);

          delete from ti_fornecedor tf where tf.nrseq_controle_integracao = x.nrseq_controle_integracao;
          update ti_controle_integracao tc set tc.cdsituacao = 'GE' where tc.nrsequencial = x.nrsequencial;
        else
          dbms_output.put_line('IGUAL. MANTER. ' || x.nrseq_controle_integracao || ';' || x.cod_fornecedor || ';' || x.nrpessoa || ';' || hash_atual || ';' || hash_anterior);
        end if;
    end loop;

    --recriar a matriz de titulos, pois a situacao pode ter mudado no Unicoo
    p_gera_carga_matriz_apb;

    --atualizar com dados dos fornecedores que sao UNIMED
    P_CARGA_PESSOA_UNIMED;

    vcommit := 1;
    for x in c_pes loop
      begin
        pck_ems506unicoo.p_define_ti_pessoa(x.pnrcgc_cpf,
                                            x.pnopessoa,
                                            x.noabreviado,
                                            x.pdtnascimento,
                                            x.ptppessoa,
                                            x.pnrregistro,
                                            x.ptporigem,
                                            x.pnoabreviado_fornecedor,
                                            x.pcdn_fornecedor,
                                            x.pnoabreviado_cliente,
                                            x.pcdn_cliente,
                                            x.paodefinepessoa);

      exception
        when others then
          --raise_application_error(-20100,' Pessoa :'||x.pnrsequencial_origem||' '||sqlerrm);
          null;
      end;

      ems506unicoo.pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                                 x.pcdacao,
                                                                 x.pcdidentificador,
                                                                 x.pnrsequencial_origem,
                                                                 x.pcdmodulo,
                                                                 x.pcdempresa,
                                                                 x.pnrseq_controle_integracao_org);

      if vcommit >= 500 then
        --Commit;
        vcommit := 1;
      else
        vcommit := vcommit + 1;
      end if;
    end loop;
    --commit;

    p_job;

    --COMMIT;

  end P_CARGA_INICIAL_FORNECEDOR;

  PROCEDURE P_CARGA_INICIAL_CLIENTE IS
    hash_atual varchar2(100);
    hash_anterior varchar2(100);
    ----------------------------------
    -- Gerar pessoa cliente integração
    ----------------------------------

    cursor c_cli is
      select nvl(trim(replace(replace(replace(p.nrcgc_cpf, '-', null),
                                      ',',
                                      null),
                              '.',
                              null)),
                 '00000000000000') nrcgc_cpf,
             p.nopessoa nopessoa,
             p.noabreviado,
             p.dtnascimento,
             p.tppessoa,
             c.nrregistro_cliente,
             'CLIENTE' tipo,
             '' vnom_abrev_fornecedor,
             '' vcdn_fornecedor,
             '' vnom_abrev_cliente,
             '' vcdn_cliente,
             'S' incluir,
             c.cdcliente
        from producao.cliente@unicoo_homologa c,
             pessoa                           p,
             ti_grupo_de_cliente              t
       where p.nrregistro = c.nrregistro_cliente
         and t.cdgrupo_cliente = c.cdgrupo_cliente
         and t.cdgrupo_cliente_ems_pj <> 'NAOM'
         -- teste Alex 26/02/17
         --and not exists (select 1
         --       from ti_matriz_receber tm
         --      where tm.nrregistro = p.nrregistro) fim teste Alex 26/02/17
         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = c.cdcliente
                 and ci.tpintegracao = 'CL')
      --         and P.NRREGISTRO=2021
      /*teste Alex 27/02/17*/
      union all
      select nvl(trim(replace(replace(replace(p.nrcgc_cpf, '-', null),
                                      ',',
                                      null),
                              '.',
                              null)),
                 '00000000000000') nrcgc_cpf,
             p.nopessoa nopessoa,
             p.noabreviado,
             p.dtnascimento,
             p.tppessoa,
             c.nrregistro_cliente,
             'CLIENTE' tipo,
             '' vnom_abrev_fornecedor,
             '' vcdn_fornecedor,
             '' vnom_abrev_cliente,
             '' vcdn_cliente,
             'S' incluir,
             c.cdcliente
        from producao.cliente@unicoo_homologa c,
             pessoa                           p,
             ti_matriz_receber                tm
       where p.nrregistro = c.nrregistro_cliente
         and p.nrregistro = tm.nrregistro

         and tm.cdcliente = c.cdcliente

         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = c.cdcliente
                 and ci.tpintegracao = 'CL') /*fim teste alex 27/02/17*/
    ;

    cursor c_carga_clientes is

    --Selecionar a pessoa do contratante que não é cliente
      select nrpessoa_paga, tppessoa
        from (select p.nrregistro nrpessoa_paga
                from contrato_da_pessoa p
               where not exists
               (select 1
                        from producao.cliente@unicoo_homologa c
                       where c.nrregistro_cliente = p.nrregistro)
              union

              --selecionar pessoa que paga da familia (aposentado/demitido) que não é cliente
              select nvl(f.nrpessoa_paga, f.nrpessoa_titular) nrregistro
                from familia f
               where f.dtinicio_contrato is not null
                 and not exists
               (select 1
                        from producao.cliente@unicoo_homologa c
                       where c.nrregistro_cliente =
                             nvl(f.nrpessoa_paga, f.nrpessoa_titular))
              union

              --selecionar pessoa que paga que não é cliente
              select p2.nrpessoa_paga
                from contrato_da_pessoa p2
               where p2.nrpessoa_paga <> p2.nrregistro
                 and not exists
               (select 1
                        from producao.cliente@unicoo_homologa c2
                       where c2.nrregistro_cliente = p2.nrpessoa_paga)
              union

              --selecionar pessoa que paga que não é cliente e faturamento por familia (adesao)
              select nvl(f.nrpessoa_paga, f.nrpessoa_titular) nrregistro
                from contrato_da_pessoa p2, familia f, usuario u
               where p2.nrregistro = u.nrregistro
                 and p2.nrcontrato = u.nrcontrato
                 and f.nrregistro = u.nrregistro
                 and f.nrcontrato = u.nrcontrato
                 and f.nrfamilia = u.nrfamilia
                 and u.nrfamilia <> 0
                 and u.tpusuario = 00
                 and p2.tpfatura = 'U'
                 and not exists
               (select 1
                        from producao.cliente@unicoo_homologa c
                       where c.nrregistro_cliente =
                             nvl(f.nrpessoa_paga, f.nrpessoa_titular))

              union

              --excecao para PLAMEC - eh contrato NORMAL no UNICOO mas tera CONTRATANTE ORIGEM no TOTVS
              select nvl(f.nrpessoa_paga, f.nrpessoa_titular) nrregistro
                from contrato_da_pessoa p2, 
                familia f, 
                usuario u, 
                unicoogps.temp_depara_agrupado tda
               where p2.nrregistro = u.nrregistro
                 and p2.nrcontrato = u.nrcontrato
                 and f.nrregistro = u.nrregistro
                 and f.nrcontrato = u.nrcontrato
                 and f.nrfamilia = u.nrfamilia
                 and u.nrfamilia <> 0
                 and u.tpusuario = 00
                 and tda.cdcontrato = p2.cdcontrato_padrao
                 and tda.ao_contr_orig_resp_financ = 'CONTR_ORIG'
                 and not exists
               (select 1
                        from producao.cliente@unicoo_homologa c
                       where c.nrregistro_cliente =
                             nvl(f.nrpessoa_paga, f.nrpessoa_titular))

              union

              --selecionar titulares da empresa do parj para virar clientes
              select nrregistro_usuario nrpessoa_paga
                from usuario us
               where nrfamilia <> 0
                 and tpusuario = 00
                 and unicoogps.f_tm_parametro('CONTRATO_PEA') like
                     '%' || us.nrcontrato || '%'
                 and not exists
               (select 1
                        from producao.cliente@unicoo_homologa cl
                       where cl.nrregistro_cliente = us.nrregistro_usuario)
              union

              --selecionar lotacoes para virarem clientes
              select a.nrpessoa_paga
                from (select nvl(l.nrpessoa_paga, l.nrregistro_lotacao) nrpessoa_paga,
                             l.nrcontrato,
                             p.nopessoa,
                             l.cdlotacao,
                             l.txdescricao,
                             cl.cdcliente cdcliente
                        from pessoa                           p,
                             lotacao                          l,
                             producao.cliente@unicoo_homologa cl,
                             contrato_da_pessoa               cdp
                       where p.nrregistro =
                             nvl(l.nrpessoa_paga, l.nrregistro_lotacao)
                         and cl.nrregistro_cliente(+) =
                             nvl(l.nrpessoa_paga, l.nrregistro_lotacao)
                         and cdp.nrregistro = l.nrregistro
                         and cdp.nrcontrato = l.nrcontrato
                         and cdp.tpfatura in ('L', 'I')) a
               where cdcliente is null) b,
             pessoa p
       where b.nrpessoa_paga = p.nrregistro;
    vcommit number;

  begin
    --dbms_output.enable(null);
    dbms_output.disable;

    --apagar TI_CLIENTE com erro para reprocessamento
    delete from ti_falha_de_processo tf
     where exists (select 1
              from ti_controle_integracao tc
             where tf.nrseq_controle_integracao = tc.nrsequencial
               and tc.tpintegracao = 'CL'
               and tc.cdsituacao in ('PE', 'ER'));
    delete from ti_cliente c where c.cdsituacao IN ('PE', 'ER');
    update ti_controle_integracao tc set tc.cdsituacao = 'GE' where tc.tpintegracao = 'CL' and tc.cdsituacao in ('PE','ER');

    --apagar TI_CLIENTE caso o hash do registro original do Unicoo tenha mudado.
    --isso fara com que o registro seja atualizado no TOTVS na proxima execucao da api progress.
    for x in (select i.cdidentificador, i.nrsequencial_origem, c.nrseq_controle_integracao,
                     c.cod_cliente, c.nrpessoa, i.nrsequencial
                from ti_cliente c, ti_controle_integracao i
               where c.nrseq_controle_integracao = i.nrsequencial
                 and c.cdsituacao = 'IT') loop
        hash_atual := gerar_hash_cliente_unicoo(x.cdidentificador, x.nrsequencial_origem);
        hash_anterior := get_hash('CL',x.cdidentificador, x.nrsequencial_origem);

        if hash_atual <> hash_anterior then
          dbms_output.put_line('DIFERENTE. APAGAR!' || x.nrseq_controle_integracao || ';' || x.cod_cliente || ';' || x.nrpessoa || ';' || hash_atual || ';' || hash_anterior);

          delete from ti_cliente tc where tc.nrseq_controle_integracao = x.nrseq_controle_integracao;
          update ti_controle_integracao tc set tc.cdsituacao = 'GE' where tc.nrsequencial = x.nrsequencial;
        else
          dbms_output.put_line('IGUAL. MANTER.' || x.nrseq_controle_integracao || ';' || x.cod_cliente || ';' || x.nrpessoa || ';' || hash_atual || ';' || hash_anterior);
        end if;
    end loop;

    --recriar a matriz de titulos, pois a situacao pode ter mudado no Unicoo
    p_gera_carga_matriz_acr;

    vcommit := 1;

    --Gera clientes no UNICOO para as pessoas que não são clientes
    --Ex: Titulares do PARJ, Lotacoes, etc
    FOR Y IN c_carga_clientes LOOP

      BEGIN
        PRODUCAO.p_gera_cliente@UNICOO_HOMOLOGA('M' || Y.NRPESSOA_PAGA,
                                                Y.NRPESSOA_PAGA,
                                                'M' || Y.NRPESSOA_PAGA,
                                                NULL,
                                                CASE
                                                  WHEN Y.TPPESSOA = 'F' THEN
                                                   'P'
                                                  ELSE
                                                   'E'
                                                END,
                                                NULL,
                                                'N');
      END;

    END LOOP;

    for x in c_cli loop
      begin
        ems506unicoo.pck_ems506unicoo.p_define_ti_pessoa(x.nrcgc_cpf,
                                                         x.nopessoa,
                                                         x.noabreviado,
                                                         x.dtnascimento,
                                                         x.tppessoa,
                                                         x.nrregistro_cliente,
                                                         x.tipo,
                                                         x.vnom_abrev_fornecedor,
                                                         x.vcdn_fornecedor,
                                                         x.vnom_abrev_cliente,
                                                         x.vcdn_cliente,
                                                         x.incluir);

      exception
        when others then
          raise_application_error(-20100,
                                  ' Pessoa : ' || x.nrregistro_cliente ||
                                  ' - ' || sqlerrm);
          null;
      end;

      ems506unicoo.PCK_EMS506UNICOO.P_INS_TI_CONTROLE_INTEGRACAO('CL',
                                                                 'I',
                                                                 x.cdcliente,
                                                                 x.NRREGISTRO_cliente,
                                                                 null,
                                                                 NULL,
                                                                 NULL);

      if vcommit >= 500 then
        --Commit;
        vcommit := 1;
      else
        vcommit := vcommit + 1;
      end if;
    end loop;
    --commit;

    P_JOB;

    --COMMIT;

  end P_CARGA_INICIAL_CLIENTE;

  procedure p_carga_tit_acr_fechado IS
    cursor c_tit is
      select 'TR' ptpintegracao,
             'F' pcdacao, --indentificacao que o titulo eh fechado
             t.nrdocumento pcdidentificador,
             t.nrregistro_titulo pnrsequencial_origem,
             '' pcdmodulo,
             t.cdempresa cdempresa,
             '' pnrseq_controle_integracao_org
        from titulo_a_receber t
       where not exists (select 1
                from ti_matriz_receber b
               where b.nrregistro_titulo = t.nrregistro_titulo)
         and not exists
       (select 1
                from ti_controle_integracao x
               where x.tpintegracao = 'TR'
                 and x.nrsequencial_origem = t.nrregistro_titulo)
        and t.cdsituacao not in (0,6,8) --titulos abertos/desmembrados/cancelados não serão integrados
         --desconsiderar titulos da propria operadora e de 1a mensalidades pois causava duplicidade de codificacao.
         --ver detalhes na descricao dos parametros
        and (   t.cdcliente <> f_ti_parametro_integracao('CDCLIENTE_1A_MENS')
             or t.cdhistorico <> f_ti_parametro_integracao('CDHISTORICO_1A_MENS'))
        and t.dttitulo >= PDT_INI_TITULOS_ACR_FECHADOS;

    vConta number;
  begin
    vConta := 0;
    for x in c_tit loop
      pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                    x.pcdacao,
                                                    x.pcdidentificador,
                                                    x.pnrsequencial_origem,
                                                    x.pcdmodulo,
                                                    x.cdempresa,
                                                    x.pnrseq_controle_integracao_org);
      if vConta > 500 then
        commit;
        vConta := 0;
      end if;

      vConta := vConta + 1;

    end loop;
    commit;

    p_job;

    COMMIT;

  END p_carga_tit_acr_fechado;


  procedure p_carga_tit_acr IS
    aojaexiste varchar2(1);

    cursor c_tit is
      select 'TR' ptpintegracao,
             'I' pcdacao,
             t.nrdocumento pcdidentificador,
             t.nrregistro_titulo pnrsequencial_origem,
             '' pcdmodulo,
             t.cdempresa cdempresa,
             '' pnrseq_controle_integracao_org
        from producao.cliente@unicoo_homologa c,
             titulo_a_receber                 t,
             pessoa                           p
       where c.cdcliente = t.cdcliente
         and p.nrregistro = c.nrregistro_cliente
         and t.cdsituacao not in (6,8) --Titulos desmembrados/cancelados nao serao migrados
         and exists (select 1
                from ti_matriz_receber b
               where b.nrregistro_titulo = t.nrregistro_titulo)
         and not exists
       (select 1
                from ti_controle_integracao x
               where x.tpintegracao = 'TR'
                 and x.nrsequencial_origem = t.nrregistro_titulo)
         --desconsiderar titulos da propria operadora e de 1a mensalidades pois causava duplicidade de codificacao.
         --ver detalhes na descricao dos parametros
         and (   t.cdcliente <> f_ti_parametro_integracao('CDCLIENTE_1A_MENS')
              or t.cdhistorico <> f_ti_parametro_integracao('CDHISTORICO_1A_MENS'));

    vConta number;
  begin
    --apagar TI_TIT_ACR e TI_CX_BX_ACR com erro para reprocessamento
    for x in (select ci.nrsequencial from ti_controle_integracao ci
               where ci.cdsituacao in ('PE','ER')
                 and ci.tpintegracao = 'TR') loop
        delete from ti_tit_acr tr where tr.nrseq_controle_integracao = x.nrsequencial;
        delete from ti_tit_acr_ctbl c where c.nrseq_controle_integracao = x.nrsequencial;
        delete from ti_tit_acr_imposto i where i.nrseq_controle_integracao = x.nrsequencial;
        delete from ti_falha_de_processo tf where tf.nrseq_controle_integracao = x.nrsequencial;
        update ti_controle_integracao tc set tc.cdsituacao = 'GE' where tc.nrsequencial = x.nrsequencial;
    end loop;
    for x in (select ci.nrsequencial from ti_controle_integracao ci
               where ci.cdsituacao in ('PE','ER')
                 and ci.tpintegracao = 'BR') loop
        delete from ti_cx_bx_acr br where br.nrseq_controle_integracao = x.nrsequencial;
        delete from ti_falha_de_processo tf where tf.nrseq_controle_integracao = x.nrsequencial;
        update ti_controle_integracao tc set tc.cdsituacao = 'GE' where tc.nrsequencial = x.nrsequencial;
    end loop;

    --apagar TI_TIT_ACR caso seja titulo em aberto e possua historico de alteracao no unicoo mais
    --recente que a ultima atualizacao no TOTVS
    --isso fara com que o registro seja atualizado no TOTVS na proxima execucao da api progress.
    for x in (select ci.nrsequencial from ti_controle_integracao ci
               where ci.cdsituacao in ('IT')
                 and ci.tpintegracao = 'TR'
                 and exists (select 1
                        from ti_matriz_receber b
                       where b.nrregistro_titulo = ci.nrsequencial_origem)
                 and exists(select 1 from LG$_TITULO_A_receber l
                                    where l.dtatualizacao$$ > ci.dtintegracao
                                      and l.NRREGISTRO_TITULO = ci.nrsequencial_origem)) loop
        delete from ti_tit_acr tr where tr.nrseq_controle_integracao = x.nrsequencial;
        delete from ti_tit_acr_ctbl c where c.nrseq_controle_integracao = x.nrsequencial;
        delete from ti_tit_acr_imposto i where i.nrseq_controle_integracao = x.nrsequencial;
        delete from ti_falha_de_processo tf where tf.nrseq_controle_integracao = x.nrsequencial;
        update ti_controle_integracao tc set tc.cdsituacao = 'GE' where tc.nrsequencial = x.nrsequencial;
    end loop;

    --na primeira vez que um titulo eh criado no EMS5, o processo cria esse registro.
    --esta sendo antecipado aqui, para evitar falha de chave durante a carga de titulos em varias filas
    --simultaneas pela api progress utb765zl.

    --PK: U##COD_MODUL_DTSUL, U##COD_PROG_DTSUL, U##COD_VERS_PROG, DAT_GERAC_MOVTO, U##HRA_GERAC_MOVTO
    begin
      select 'S' into aojaexiste
        from ems5.histor_exec_especial h
       where h.u##cod_modul_dtsul = 'ACR'
         and h.u##cod_prog_dtsul  = 'SPP_ACERTO_TIT_COMIS_REPRES'
         and rownum = 1;
    exception
      when others then
        aojaexiste := 'N';
    end;

    if aojaexiste = 'N' then
      begin
        insert into ems5.histor_exec_especial h(U##COD_MODUL_DTSUL,
                                                COD_MODUL_DTSUL,
                                                U##COD_PROG_DTSUL,
                                                COD_PROG_DTSUL,
                                                U##COD_VERS_PROG,
                                                COD_VERS_PROG,
                                                DAT_GERAC_MOVTO,
                                                U##HRA_GERAC_MOVTO,
                                                HRA_GERAC_MOVTO,
                                                COD_USUAR_GERAC_MOVTO,
                                                PROGRESS_RECID)
        values('ACR',
               'ACR',
               'SPP_ACERTO_TIT_COMIS_REPRES',
               'SPP_ACERTO_TIT_COMIS_REPRES',
               ' ',
               ' ',
               SYSDATE,
               ' ',
               ' ',
               'MIGRACAO',
               ems5.histor_exec_especial_seq.nextval);

      exception
          when others then
           null;
      end;
    end if;

    vConta := 0;
    for x in c_tit loop
      pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                    x.pcdacao,
                                                    x.pcdidentificador,
                                                    x.pnrsequencial_origem,
                                                    x.pcdmodulo,
                                                    x.cdempresa,
                                                    x.pnrseq_controle_integracao_org);
      if vConta > 500 then
        --commit;
        vConta := 0;
      end if;

      vConta := vConta + 1;

    end loop;
    --commit;

    p_job;

    --COMMIT;

    if PMIGRAR_TITULOS_ACR_FECHADOS = 'S' then
      p_carga_tit_acr_fechado;
      P_CARGA_BAIXA_TIT_ACR;
    end if;
    commit;
  END p_carga_tit_acr;


procedure p_carga_baixa_tit_acr is

  temp_ti_cx_bx_acr           ti_cx_bx_acr%rowtype;
  vnrseq_controle             ti_controle_integracao.nrsequencial%type;
  pCD_PORTADOR_MOVIMENTOS     ti_parametro_integracao.cdparametro%type := f_ti_parametro_integracao('CD_PORTADOR_MOVIMENTOS');
  pCD_CTA_CORREN_MOVIMENTOS   ti_parametro_integracao.cdparametro%type := f_ti_parametro_integracao('CD_CTA_CORREN_MOVIMENTOS');
  temp_ti_controle_integracao ti_controle_integracao%rowtype;
  vcdsituacao                 ti_controle_integracao.cdsituacao%type;
  verro                       ti_falha_de_processo.txfalha%type;
  temp_ti_falha_de_processo   ti_falha_de_processo%rowtype;
  vexiste                     char;

  cursor c_titulos is

    select ttr.*, tr.nrregistro_titulo
      from ti_controle_integracao tc, titulo_a_receber tr, ti_tit_acr ttr
     where tc.nrsequencial_origem = tr.nrregistro_titulo
       and tc.cdidentificador = tr.nrdocumento
       and ttr.nrseq_controle_integracao = tc.nrsequencial
       --and ttr.cdsituacao = 'IT'
       and tr.cdsituacao <> 0;

  --Movimento 70 - Baixa normal de títulos
  cursor c_baixa_titulo(cnrregistro_titulo titulo_a_receber.nrregistro_titulo%type) is
    select h.dtmovimento       dt_baixa,
           decode(h.vlrecebido,null,h.vltitulo,0,h.vltitulo,h.vlrecebido) vl_recebido,
           h.vljuros,
           h.vlmulta,
           h.vldesconto,
           h.vlabatimento,
           h.vlir_fonte,
           h.nrregistro_titulo,
           tc.cdidentificador,
           h.nrmovimento
      from historico_do_titulo h, ti_controle_integracao tc
     where h.nrregistro_titulo = tc.nrsequencial_origem
       and h.nrregistro_titulo = cnrregistro_titulo
       and h.cdmovimento in (30, 70, 72, 76)
       and not exists
     (select 1
              from ti_cx_bx_acr tcr
             where tcr.nrmovimento_baixa = h.nrmovimento)
     order by tc.cdidentificador, h.dtmovimento;

begin

  for ct in c_titulos loop

    for cbaixa in c_baixa_titulo(ct.nrregistro_titulo) loop

      begin
        select 'S'
          into vexiste
          from ti_cx_bx_acr tcx
         where tcx.nrmovimento_baixa = cbaixa.nrmovimento;

      exception
        when no_data_found then
          select sq_ti_controle_integracao.nextval
            into vnrseq_controle
            from dual;

          vcdsituacao := 'RC';

          begin

            temp_ti_cx_bx_acr.nrseq_controle_integracao := vnrseq_controle;
            temp_ti_cx_bx_acr.cdsituacao                := vcdsituacao;
            temp_ti_cx_bx_acr.cod_cart_bcia             := ' ';
            temp_ti_cx_bx_acr.cod_cliente               := ct.cod_cliente;
            temp_ti_cx_bx_acr.cod_empresa               := ct.cod_empresa;
            temp_ti_cx_bx_acr.cod_espec_docto           := ct.cod_espec_docto;
            temp_ti_cx_bx_acr.cod_estab                 := ct.cod_estab;
            temp_ti_cx_bx_acr.cod_parcela               := ct.cod_parcela;
            temp_ti_cx_bx_acr.cod_portador              := pCD_PORTADOR_MOVIMENTOS;
            temp_ti_cx_bx_acr.cod_ser_docto             := ct.cod_ser_docto;
            temp_ti_cx_bx_acr.cod_tit_acr_bco           := ct.cod_tit_acr_bco;
            temp_ti_cx_bx_acr.cod_titulo_acr            := ct.cod_titulo_acr;
            temp_ti_cx_bx_acr.dat_baixa                 := cbaixa.dt_baixa;
            temp_ti_cx_bx_acr.dat_envio                 := cbaixa.dt_baixa;
            temp_ti_cx_bx_acr.dat_processamento         := sysdate;
            temp_ti_cx_bx_acr.des_text_histor           := ' ';
            temp_ti_cx_bx_acr.val_desconto              := nvl(cbaixa.vldesconto,0);
            temp_ti_cx_bx_acr.val_abatimento            := nvl(cbaixa.vlabatimento,0);
            temp_ti_cx_bx_acr.val_ir                    := nvl(cbaixa.vlir_fonte,0);
            temp_ti_cx_bx_acr.val_juros                 := nvl(cbaixa.vljuros,0);
            temp_ti_cx_bx_acr.val_multa                 := nvl(cbaixa.vlmulta,0);
            temp_ti_cx_bx_acr.val_liq_titulo            := cbaixa.vl_recebido;
            temp_ti_cx_bx_acr.val_titulo                := 0;
            temp_ti_cx_bx_acr.nrpessoa                  := 0;
            temp_ti_cx_bx_acr.nrregistro_titulo         := null;
            temp_ti_cx_bx_acr.nrmovimento_baixa         := cbaixa.nrmovimento;
            temp_ti_cx_bx_acr.nrdocumento               := cbaixa.cdidentificador;
            temp_ti_cx_bx_acr.nrnossonumero             := ct.cod_tit_acr_bco;
            temp_ti_cx_bx_acr.txhistorico               := null;
            temp_ti_cx_bx_acr.nrbanco                   := 0;
            temp_ti_cx_bx_acr.nragencia                 := 0;
            temp_ti_cx_bx_acr.nrconta_corrente          := pCD_CTA_CORREN_MOVIMENTOS;

            insert into TI_CX_BX_ACR values temp_TI_CX_BX_ACR;

          exception
            when others then
              vcdsituacao := 'ER';
              verro       := sqlerrm;

              select SQ_TI_FALHA_DE_PROCESSO.NEXTVAL
                into temp_ti_falha_de_processo.nrsequencial
                from dual;

              temp_ti_falha_de_processo.nrseq_controle_integracao := vnrseq_controle;
              temp_ti_falha_de_processo.cdintegracao              := 'BR';
              temp_ti_falha_de_processo.txfalha                   := verro;
              temp_ti_falha_de_processo.dtfalha                   := sysdate;
              temp_ti_falha_de_processo.txajuda                   := ' ';
              temp_ti_falha_de_processo.nrmensagem                := null;

              insert into ti_falha_de_processo
              values temp_ti_falha_de_processo;

          end;

          temp_ti_controle_integracao.nrsequencial                  := vnrseq_controle;
          temp_ti_controle_integracao.tpintegracao                  := 'BR';
          temp_ti_controle_integracao.dtgeracao                     := sysdate;
          temp_ti_controle_integracao.nrsequencial_origem           := ct.nrregistro_titulo;
          temp_ti_controle_integracao.dtprocessamento               := sysdate;
          temp_ti_controle_integracao.dtintegracao                  := null;
          temp_ti_controle_integracao.cdacao                        := 'I';
          temp_ti_controle_integracao.cdidentificador               := cbaixa.cdidentificador;
          temp_ti_controle_integracao.txobservacao                  := ' ';
          temp_ti_controle_integracao.cdsituacao                    := vcdsituacao;
          temp_ti_controle_integracao.nrseq_controle_integracao_org := null;
          temp_ti_controle_integracao.cdempresa                     := null;
          temp_ti_controle_integracao.cdmodulo                      := null;
          temp_ti_controle_integracao.cdmovimento                   := null;
          temp_ti_controle_integracao.nrsessao                      := null;
          temp_ti_controle_integracao.cddivisao                     := null;
          temp_ti_controle_integracao.cdcentro_custo                := null;
          temp_ti_controle_integracao.tpdocumento                   := null;

          insert into ti_controle_integracao
          values temp_ti_controle_integracao;

        p_commit;

      end;
    end loop;

  end loop;

  commit;

end p_carga_baixa_tit_acr;


  PROCEDURE p_carga_tit_apb IS
    --===================================================================================================
    ----------------------------------------
    -- gerar carga do titulos a pagar
    ----------------------------------------
    cursor c_tit is
      select 'TP' ptpintegracao,
             'I' pcdacao,
             t.nrdocumento pcdidentificador,
             t.nrregistro_titulo pnrsequencial_origem,
             '' pcdmodulo,
             t.cdempresa cdempresa,
             '' pnrseq_controle_integracao_org
        from producao.fornecedor@unicoo_homologa f,
             titulo_a_pagar                      t,
             pessoa                              p
       where t.cdfornecedor = f.cdfornecedor
         and f.nrregistro_fornecedor = p.nrregistro
         and t.cdsituacao <> 1 -- 10/05/18 - ALEX - TRATADO PARA IGNORAR 'TOTALMENTE PAGO' CONFORME ACORDADO COM UNIMED NI E THEALTH
         and exists (select 1
                from ti_matriz_pagar b
               where b.nrregistro_titulo = t.nrregistro_titulo)
         and not exists
       (select 1
                from ti_controle_integracao u
               where u.tpintegracao = 'TP'
                 and u.nrsequencial_origem = t.nrregistro_titulo)
         --RELACAO DOS HISTORICOS QUE NAO DEVE MIGRAR POIS SAO DE IMPOSTOS,
         --QUE SERAO DIGITADOS MANUALMENTE NO EMS5 PELO USUARIO (TX)
         and not exists(select 1 from DEPARA_HIST_APB_NAO_MIGRAR d
                               where d.cdhistorico = t.cdhistorico);
  begin

    dbms_output.enable(null);

    dbms_output.put_line('inicio do carga_ti_tit_apb');

    --DESTACAR EM TEMPORARIA OS TITULOS DE IMPOSTOS QUE NAO VAI MIGRAR
    delete from temp_titulos_apb_nao_migrar;
    for x in (select * from titulo_a_pagar t
                   where exists(select 1 from ti_matriz_pagar b
                                  where b.nrregistro_titulo = t.nrregistro_titulo
                                    and exists(select 1 from depara_hist_APB_nao_migrar d
                                                  where d.cdhistorico = t.cdhistorico))) loop

                insert into TEMP_TITULOS_APB_NAO_MIGRAR
                  (CDFORNECEDOR,
                   NRREGISTRO_TITULO,
                   CDEMPRESA,
                   NRREGISTRO_FORNECEDOR,
                   CDSITUACAO,
                   IDCONTRATO,
                   CDHISTORICO,
                   NRDOCUMENTO,
                   TPDOCUMENTO,
                   CDPORTADOR,
                   CDOPERACAO,
                   NRNOSSONUMERO,
                   NRVENDEDOR,
                   DTTITULO,
                   DTVENCIMENTO,
                   DTEXCLUSAO,
                   DTREFERENCIA,
                   VLTITULO,
                   VLABATIMENTO,
                   VLABATIMENTO_2,
                   DTULTIMO_RECEBIMENTO,
                   VLPAGO,
                   VLMULTA,
                   VLJUROS,
                   VLDESCONTO,
                   DTENVIO_BANCO,
                   DTCONFIRMA_BANCO,
                   TXREFERENCIA_BANCO,
                   TXHISTORICO,
                   DTPROTESTO,
                   NOCARTORIO_PROTESTO,
                   TXOBSERVACOES,
                   CDCENTRO_CUSTO,
                   NRREGISTRO_TIT_AGRUP,
                   NRREGISTRO_TIT_DESM,
                   NRBANCO,
                   NRAGENCIA,
                   NRCONTA_BANCARIA,
                   DTCONTABILIZADO,
                   AOLIBERADO,
                   CDFUNCIONARIO,
                   DTLIBERACAO,
                   AOENVIA,
                   NRSEQUENCIANOTAFISCALENT,
                   NRNOTA_FISCAL_DEV,
                   VLTITULO_VENDOR,
                   NRREGISTRO_DESPESA,
                   NRMOTIVO_EXCLUSAO,
                   DTDIGITACAO,
                   NRREGISTRO_AGRUP,
                   DTULTIMO_RETORNO,
                   NRULTIMO_RETORNO,
                   CDCOMANDO_ENVIO,
                   CDCOMANDO_RETORNO,
                   CDCOMANDO_ATUAL,
                   CDBARRA,
                   LINHA_DIGITAVEL_CB,
                   VLTAXA_BANCARIA,
                   CDTAXA,
                   NRULTIMO_ENVIO,
                   NRDOCUMENTO_BANCO,
                   VLIR_FONTE,
                   CDORIGEM,
                   NRORIGEM,
                   DTENCERRAMENTO,
                   CDDIVISAO,
                   VLBRUTO,
                   DTEMISSAO_NF,
                   DTREFERENCIA_BAIXA,
                   CDMOVIMENTO_INCLUSAO,
                   TPIMPOSTOS_DESMEMBRAMENTO,
                   TPIMPOSTOS_AGRUPAMENTO,
                   CDCENTRO_RESPONSABILIDADE,
                   NRDOC_INTERCAMBIO)
                values
                  (x.CDFORNECEDOR,
                   x.NRREGISTRO_TITULO,
                   x.CDEMPRESA,
                   x.NRREGISTRO_FORNECEDOR,
                   x.CDSITUACAO,
                   x.IDCONTRATO,
                   x.CDHISTORICO,
                   x.NRDOCUMENTO,
                   x.TPDOCUMENTO,
                   x.CDPORTADOR,
                   x.CDOPERACAO,
                   x.NRNOSSONUMERO,
                   x.NRVENDEDOR,
                   x.DTTITULO,
                   x.DTVENCIMENTO,
                   x.DTEXCLUSAO,
                   x.DTREFERENCIA,
                   x.VLTITULO,
                   x.VLABATIMENTO,
                   x.VLABATIMENTO_2,
                   x.DTULTIMO_RECEBIMENTO,
                   x.VLPAGO,
                   x.VLMULTA,
                   x.VLJUROS,
                   x.VLDESCONTO,
                   x.DTENVIO_BANCO,
                   x.DTCONFIRMA_BANCO,
                   x.TXREFERENCIA_BANCO,
                   x.TXHISTORICO,
                   x.DTPROTESTO,
                   x.NOCARTORIO_PROTESTO,
                   x.TXOBSERVACOES,
                   x.CDCENTRO_CUSTO,
                   x.NRREGISTRO_TIT_AGRUP,
                   x.NRREGISTRO_TIT_DESM,
                   x.NRBANCO,
                   x.NRAGENCIA,
                   x.NRCONTA_BANCARIA,
                   x.DTCONTABILIZADO,
                   x.AOLIBERADO,
                   x.CDFUNCIONARIO,
                   x.DTLIBERACAO,
                   x.AOENVIA,
                   x.NRSEQUENCIANOTAFISCALENT,
                   x.NRNOTA_FISCAL_DEV,
                   x.VLTITULO_VENDOR,
                   x.NRREGISTRO_DESPESA,
                   x.NRMOTIVO_EXCLUSAO,
                   x.DTDIGITACAO,
                   x.NRREGISTRO_AGRUP,
                   x.DTULTIMO_RETORNO,
                   x.NRULTIMO_RETORNO,
                   x.CDCOMANDO_ENVIO,
                   x.CDCOMANDO_RETORNO,
                   x.CDCOMANDO_ATUAL,
                   x.CDBARRA,
                   x.LINHA_DIGITAVEL_CB,
                   x.VLTAXA_BANCARIA,
                   x.CDTAXA,
                   x.NRULTIMO_ENVIO,
                   x.NRDOCUMENTO_BANCO,
                   x.VLIR_FONTE,
                   x.CDORIGEM,
                   x.NRORIGEM,
                   x.DTENCERRAMENTO,
                   x.CDDIVISAO,
                   x.VLBRUTO,
                   x.DTEMISSAO_NF,
                   x.DTREFERENCIA_BAIXA,
                   x.CDMOVIMENTO_INCLUSAO,
                   x.TPIMPOSTOS_DESMEMBRAMENTO,
                   x.TPIMPOSTOS_AGRUPAMENTO,
                   x.CDCENTRO_RESPONSABILIDADE,
                   x.NRDOC_INTERCAMBIO);

    end loop;

    --apagar TI_TIT_APB com erro para reprocessamento
    for x in (select ci.nrsequencial from ti_controle_integracao ci
               where ci.cdsituacao in ('PE','ER')
                 and ci.tpintegracao = 'TP') loop

    dbms_output.put_line('vai apagar ERROS ti_tit_apb nrsequencial: ' || x.nrsequencial);

        delete from ti_tit_apb tp where tp.nrseq_controle_integracao = x.nrsequencial;
        delete from ti_tit_apb_ctbl p where p.nrseq_controle_integracao = x.nrsequencial;
        delete from ti_tit_apb_imposto i where i.nrseq_controle_integracao = x.nrsequencial;
        delete from ti_falha_de_processo tf where tf.nrseq_controle_integracao = x.nrsequencial;
        update ti_controle_integracao tc set tc.cdsituacao = 'GE' where tc.nrsequencial = x.nrsequencial;
    end loop;

    --apagar TI_TIT_APB caso seja titulo em aberto e possua historico de alteracao no unicoo mais
    --recente que a ultima atualizacao no TOTVS
    --isso fara com que o registro seja atualizado no TOTVS na proxima execucao da api progress.
    for x in (select ci.nrsequencial from ti_controle_integracao ci
               where ci.cdsituacao in ('IT')
                 and ci.tpintegracao = 'TP'
                 and exists (select 1
                        from ti_matriz_pagar b
                       where b.nrregistro_titulo = ci.nrsequencial_origem)
                 and exists(select 1 from LG$_TITULO_A_PAGAR l
                                    where l.dtatualizacao$$ > ci.dtintegracao
                                      and l.NRREGISTRO_TITULO = ci.nrsequencial_origem)) loop

    dbms_output.put_line('vai apagar ALTERADOS DO UNICOO ti_tit_apb nrsequencial: ' || x.nrsequencial);

        delete from ti_tit_apb tp where tp.nrseq_controle_integracao = x.nrsequencial;
        delete from ti_tit_apb_ctbl p where p.nrseq_controle_integracao = x.nrsequencial;
        delete from ti_tit_apb_imposto i where i.nrseq_controle_integracao = x.nrsequencial;
        delete from ti_falha_de_processo tf where tf.nrseq_controle_integracao = x.nrsequencial;
        update ti_controle_integracao tc set tc.cdsituacao = 'GE' where tc.nrsequencial = x.nrsequencial;
    end loop;

    for x in c_tit loop

      dbms_output.put_line('entrou no loop nrsequencial: ' || x.pnrsequencial_origem);

      pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                    x.pcdacao,
                                                    x.pcdidentificador,
                                                    x.pnrsequencial_origem,
                                                    x.pcdmodulo,
                                                    x.cdempresa,
                                                    x.pnrseq_controle_integracao_org);
      --commit;
    end loop;

    p_job;

    --commit;

  end p_carga_tit_apb;

  procedure p_atualiza_status_cliente(p_qtsessoes number) IS

    vqtregistros number;
    w            number := 0;

  begin

    loop

        w := 0;

        select count(*) / p_qtsessoes
          into vqtregistros
          from ti_cliente
         where cdsituacao = 'RC';

        while w <= p_qtsessoes loop

          update ti_cliente t
             set cdsituacao = 'R' || w
           where cdsituacao = 'RC'
             and rownum <= vqtregistros;

          commit;
          w := w + 1;

        end loop;
    end loop;
  end p_atualiza_status_cliente;

  procedure p_atualiza_status_cliente_JK(p_qtsessoes number) IS

    vqtregistros number;
    w            number := 0;

  begin
        w := 0;

        select round(count(*) / p_qtsessoes) + 2
          into vqtregistros
          from ti_cliente
         where cdsituacao = 'RC';

        while w < p_qtsessoes loop

          update ti_cliente t
             set cdsituacao = w
           where cdsituacao = 'RC'
             and rownum <= vqtregistros;

          commit;
          w := w + 1;

        end loop;
  end p_atualiza_status_cliente_JK;

  -- somente coloca a baixa em fila de processamento caso o titulo baixado ja tenha sido
  -- importado corretamente no EMS5
  procedure p_atualiza_status_baixa_acr(p_qtsessoes number) IS

    vqtregistros number;
    w            number := 0;

  begin

    loop

        w := 0;

        select count(*) / p_qtsessoes
          into vqtregistros
          from ti_cx_bx_acr b, ti_controle_integracao ci
         where b.cdsituacao = 'RC'
           and ci.nrsequencial = b.nrseq_controle_integracao
           and exists --garantir que baixa ja foi importada OK
         (select 1
                  from ti_tit_acr t, ti_controle_integracao ci2
                 where t.nrseq_controle_integracao = ci2.nrsequencial
                   and ci2.nrsequencial_origem = ci.nrsequencial_origem
                   and t.cdsituacao = 'IT');

        while w <= p_qtsessoes loop

          update ti_cx_bx_acr b
             set cdsituacao = w
           where cdsituacao = 'RC'
             and exists
           (select 1
                    from ti_controle_integracao ci
                   where ci.nrsequencial = b.nrseq_controle_integracao
                     and exists
                   (select 1
                            from ti_tit_acr t, ti_controle_integracao ci2
                           where t.nrseq_controle_integracao =
                                 ci2.nrsequencial
                             and ci2.nrsequencial_origem =
                                 ci.nrsequencial_origem
                             and t.cdsituacao = 'IT'))

             and rownum <= vqtregistros;

          commit;
          w := w + 1;

        end loop;

    end loop;
  end p_atualiza_status_baixa_acr;

  procedure p_atualiza_status_fornecedor(p_qtsessoes number) IS

    vqtregistros number;
    w            number := 0;

  begin

    loop

        w := 0;

        select count(*) / p_qtsessoes
          into vqtregistros
          from ti_fornecedor
         where cdsituacao = 'RC';

        while w <= p_qtsessoes loop

          update ti_fornecedor t
             set cdsituacao = 'R' || w
           where cdsituacao = 'RC'
             and rownum <= vqtregistros;

          commit;
          w := w + 1;

        end loop;

    end loop;
  end p_atualiza_status_fornecedor;

  procedure p_atualiza_status_fornec_JK(p_qtsessoes number) IS

    vqtregistros number;
    w            number := 0;

  begin

        w := 0;
        select round(count(*) / p_qtsessoes) + 2
--        select count(*) / p_qtsessoes
          into vqtregistros
          from ti_fornecedor
         where cdsituacao = 'RC';

        while w < p_qtsessoes loop

          update ti_fornecedor t
             set cdsituacao = w
           where cdsituacao = 'RC'
             and rownum <= vqtregistros;

          commit;
          w := w + 1;

        end loop;

  end p_atualiza_status_fornec_JK;

  procedure p_atualiza_status_tit_apb(p_qtsessoes number) IS

    vqtregistros number;
    w            number := 0;

  begin

    loop

      w := 0;

      select round(count(*) / p_qtsessoes, 0)
        into vqtregistros
        from ti_tit_apb
       where cdsituacao = 'RC';

      while w <= p_qtsessoes loop

        update ti_tit_apb t
           set cdsituacao = /*'R' ||*/ w
         where cdsituacao = 'RC'
           and rownum <= vqtregistros;

        commit;
        w := w + 1;

      end loop;

    end loop;
  end p_atualiza_status_tit_apb;

  procedure p_atualiza_status_tit_apb_JK(p_qtsessoes number) IS

    vqtregistros number;
    w            number := 0;

  begin

      select round(count(*) / p_qtsessoes, 0) + 2
        into vqtregistros
        from ti_tit_apb
       where cdsituacao = 'RC';

      while w <= p_qtsessoes loop

        update ti_tit_apb t
           set cdsituacao = w
         where cdsituacao = 'RC'
           and rownum < vqtregistros;

        commit;
        w := w + 1;

      end loop;

  end p_atualiza_status_tit_apb_JK;

  procedure p_atualiza_status_tit_acr_JK(p_qtsessoes number) IS
    vqtregistros number;
    w            number := 0;
  begin
    w := 0;
    select round(count(*) / p_qtsessoes, 0) + 2
      into vqtregistros
      from ti_tit_acr t, ti_controle_integracao ci
     where t.cdsituacao = 'RC'
       and ci.nrsequencial = t.nrseq_controle_integracao
       and exists --isso indica que eh ABERTO
     (select 1
              from ti_matriz_receber b
             where b.nrregistro_titulo = ci.nrsequencial_origem);

    while w < p_qtsessoes loop

      update ti_tit_acr t
         set cdsituacao = w
       where t.cdsituacao = 'RC'
         and exists
       (select 1
                from ti_controle_integracao ci
               where ci.nrsequencial = t.nrseq_controle_integracao
                 and exists --isso indica que eh ABERTO
               (select 1
                        from ti_matriz_receber b
                       where b.nrregistro_titulo = ci.nrsequencial_origem))
         and rownum <= vqtregistros;

      commit;
      w := w + 1;

    end loop;

    --distribuir os titulos ACR FECHADOS em filas de processamento
    --importante: os titulos baixados no Unicoo so poderao ser colocados nas filas
    --            caso a sua baixa ja esteja preparada na temporaria TI_CX_BX_ACR.

    w := 0;
    select round(count(*) / p_qtsessoes, 0) + 2
      into vqtregistros
      from ti_tit_acr t, ti_controle_integracao ci
     where t.cdsituacao = 'RC'
       and ci.nrsequencial = t.nrseq_controle_integracao
       and not exists --isso indica que eh FECHADO
     (select 1
              from ti_matriz_receber b
             where b.nrregistro_titulo = ci.nrsequencial_origem)
       and exists --isso indica que sua baixa ja esta agendada
     (select 1
              from ti_cx_bx_acr bx, ti_controle_integracao ci2
             where bx.nrseq_controle_integracao = ci2.nrsequencial
               and ci2.nrsequencial_origem = ci.nrsequencial_origem);

    while w < p_qtsessoes loop

      update ti_tit_acr t
         set cdsituacao = w
       where t.cdsituacao = 'RC'
         and exists
       (select 1
                from ti_controle_integracao ci
               where ci.nrsequencial = t.nrseq_controle_integracao
                 and not exists --isso indica que eh FECHADO
               (select 1
                        from ti_matriz_receber b
                       where b.nrregistro_titulo = ci.nrsequencial_origem)
                 and exists --isso indica que sua baixa ja esta agendada
               (select 1
                        from ti_cx_bx_acr bx, ti_controle_integracao ci2
                       where bx.nrseq_controle_integracao = ci2.nrsequencial
                         and ci2.nrsequencial_origem = ci.nrsequencial_origem))
         and rownum <= vqtregistros;

      commit;
      w := w + 1;

    end loop;

  end p_atualiza_status_tit_acr_JK;

  --distribuir os titulos ACR ABERTOS em filas de processamento
  procedure p_atualiza_status_tit_acr_aber(p_qtsessoes number) IS

    vqtregistros number;
    w            number := 0;

  begin

    loop

      w := 0;

      select round(count(*) / p_qtsessoes, 0)
        into vqtregistros
        from ti_tit_acr t, ti_controle_integracao ci
       where t.cdsituacao = 'RC'
         and ci.nrsequencial = t.nrseq_controle_integracao
         and exists --isso indica que eh ABERTO
       (select 1
                from ti_matriz_receber b
               where b.nrregistro_titulo = ci.nrsequencial_origem);

      while w <= p_qtsessoes loop

        update ti_tit_acr t
           set cdsituacao = w
         where t.cdsituacao = 'RC'
           and exists
         (select 1
                  from ti_controle_integracao ci
                 where ci.nrsequencial = t.nrseq_controle_integracao and
                  exists --isso indica que eh ABERTO
                  (select 1
                           from ti_matriz_receber b
                          where b.nrregistro_titulo = ci.nrsequencial_origem))
           and rownum <= vqtregistros;

        commit;
        w := w + 1;

      end loop;

    end loop;
  end p_atualiza_status_tit_acr_aber;

  --distribuir os titulos ACR FECHADOS em filas de processamento
  --importante: os titulos baixados no Unicoo so poderao ser colocados nas filas
  --            caso a sua baixa ja esteja preparada na temporaria TI_CX_BX_ACR.
  procedure p_atualiza_status_tit_acr_fech(p_qtsessoes number) IS

    vqtregistros number;
    w            number := 0;

  begin
    loop
      w := 0;

      select round(count(*) / p_qtsessoes, 0)
        into vqtregistros
        from ti_tit_acr t, ti_controle_integracao ci
       where t.cdsituacao = 'RC'
         and ci.nrsequencial = t.nrseq_controle_integracao
         and not exists --isso indica que eh FECHADO
       (select 1
                from ti_matriz_receber b
               where b.nrregistro_titulo = ci.nrsequencial_origem)
         and exists --isso indica que sua baixa ja esta agendada
       (select 1
                from ti_cx_bx_acr bx, ti_controle_integracao ci2
               where bx.nrseq_controle_integracao = ci2.nrsequencial
                 and ci2.nrsequencial_origem = ci.nrsequencial_origem);

      while w <= p_qtsessoes loop

        update ti_tit_acr t
           set cdsituacao = w
         where t.cdsituacao = 'RC'
           and exists
         (select 1
                  from ti_controle_integracao ci
                 where ci.nrsequencial = t.nrseq_controle_integracao
                   and not exists --isso indica que eh FECHADO
                 (select 1
                          from ti_matriz_receber b
                         where b.nrregistro_titulo = ci.nrsequencial_origem)
                   and exists --isso indica que sua baixa ja esta agendada
                 (select 1
                          from ti_cx_bx_acr bx, ti_controle_integracao ci2
                         where bx.nrseq_controle_integracao =
                               ci2.nrsequencial
                           and ci2.nrsequencial_origem =
                               ci.nrsequencial_origem))
           and rownum <= vqtregistros;

        commit;
        w := w + 1;

      end loop;

    end loop;
  end p_atualiza_status_tit_acr_fech;

  --carregar matriz com os titulos ACR em aberto
  procedure p_gera_carga_matriz_acr is
    vpcdempresa  varchar2(5);
    vpdtvenc_ini date;
    vpdtvenc_fin date;
    qt_registros number;
    vpdtcontabil date;
  begin
    --inicializar parametros
    vpcdempresa := pcdempresa_tit_acr;
    vPdtvenc_ini := pdtini_tit_acr;
    vPdtvenc_fin := pdtfim_tit_acr;

    begin
      vpdtcontabil := PDT_CONTABIL_ACR;
    exception
      when others then
        vpdtcontabil := sysdate;
    end;

    --dbms_output.enable(null);
    --dbms_output.put_line('PARAMETROS: ' || vpcdempresa || ';' || vPdtvenc_ini || ';' || vPdtvenc_fin || ';' || vpdtcontabil);

    --somente permitir executar o processo caso a tabela esteja vazia.
    --Motivo: rotina configurada no Jenkins. os demais processos são dependentes desse.
    --        a carga deve ser realizada apenas 1x com base em uma data contabil pre determinada.
    /*begin
      select nvl(count(*),'0') into qt_registros
        from ti_matriz_receber;
    exception
      when others then
        qt_registros := 0;
    end;

    if qt_registros is not null and qt_registros > 0 then
      return;
    end if;*/

    p_apagar_matriz_acr(true);

    --commit;
    -- inserir novamente os titulos em aberto na tabela.
    insert into ti_matriz_receber
      select ttr.cdcliente,
             ttr.nrregistro_titulo,
             pes.nrregistro,
             ttr.nrdocumento,
             ttr.cdsituacao,
             case
               when ttr.cdsituacao = 0 then
                'Aberto'
               when ttr.cdsituacao = 1 then
                'Totalmente Pago'
               when ttr.cdsituacao = 2 then
                'Parcialmente Pago'
               when ttr.cdsituacao = 3 then
                'Encerrado em Prejuizo'
               when ttr.cdsituacao = 4 then
                'Substituído'
               when ttr.cdsituacao = 5 then
                'Substituído Encerrado'
               when ttr.cdsituacao = 6 then
                'Desmembrado'
               when ttr.cdsituacao = 7 then
                'Agrupado'
               when ttr.cdsituacao = 8 then
                'Cancelado'
             end descsituacao,
             ttr.dttitulo,
             max(decode(cdmovimento,
                        1,
                        hst.dtvencimento,
                        2,
                        hst.dtvencimento,
                        3,
                        hst.dtvencimento,
                        10,
                        hst.dtvencimento,
                        to_date('31/12/1889'))) dtvencimento,
             decode(nvl(min(ttr.vlfaturado), 0),
                    0,
                    sum(decode(hst.nrmovimento,
                               h2.nrmovimento,
                               nvl(hst.vltitulo, 0),
                               0)),
                    nvl(min(ttr.vlfaturado), 0)) vlfaturado,
             sum(decode(hst.nrmovimento,
                        h2.nrmovimento,
                        nvl(hst.vltitulo, 0),
                        0)) vltitulo,
             max(hst.dtrecebimento) dtultimo_recebimento,
             sum(nvl(decode(hst.cdmovimento,
                            77,
                            hst.vlmulta,
                            85,
                            -hst.vlmulta,
                            86,
                            -hst.vlmulta,
                            87,
                            -hst.vlmulta,
                            89,
                            -hst.vlmulta,
                            hst.vlmulta),
                     0)) vlmulta,
             sum(nvl(decode(hst.cdmovimento,
                            77,
                            hst.vljuros,
                            85,
                            -hst.vljuros,
                            86,
                            -hst.vljuros,
                            87,
                            -hst.vljuros,
                            89,
                            -hst.vljuros,
                            hst.vljuros),
                     0)) vljuros,
             sum(nvl(decode(hst.cdmovimento,
                            77,
                            hst.vlabatimento,
                            85,
                            -hst.vlabatimento,
                            86,
                            -hst.vlabatimento,
                            87,
                            -hst.vlabatimento,
                            89,
                            -hst.vlabatimento,
                            hst.vlabatimento),
                     0)) vlabatimento,
             sum(nvl(decode(hst.cdmovimento,
                            77,
                            hst.vlabatimento_2,
                            85,
                            -hst.vlabatimento_2,
                            86,
                            -hst.vlabatimento_2,
                            87,
                            -hst.vlabatimento_2,
                            89,
                            -hst.vlabatimento_2,
                            hst.vlabatimento_2),
                     0)) vlabatimento_2,
             sum(nvl(decode(hst.cdmovimento,
                            77,
                            hst.vlrecebido,
                            85,
                            -hst.vlrecebido,
                            86,
                            -hst.vlrecebido,
                            87,
                            -hst.vlrecebido,
                            89,
                            -hst.vlrecebido,
                            hst.vlrecebido),
                     0)) vlrecebido,
             (sum(nvl(decode(hst.cdmovimento,
                             77,
                             hst.vldesconto,
                             85,
                             -hst.vldesconto,
                             86,
                             -hst.vldesconto,
                             87,
                             -hst.vldesconto,
                             89,
                             -hst.vldesconto,
                             hst.vldesconto),
                      0)) + sum(nvl(decode(hst.cdmovimento,
                                            77,
                                            hst.vlabatimento_imposto,
                                            85,
                                            -hst.vlabatimento_imposto,
                                            86,
                                            -hst.vlabatimento_imposto,
                                            87,
                                            -hst.vlabatimento_imposto,
                                            89,
                                            -hst.vlabatimento_imposto,
                                            hst.vlabatimento_imposto),
                                     0))) vldesconto,
             (sum(decode(hst.nrmovimento,
                         h2.nrmovimento,
                         nvl(hst.vltitulo, 0),
                         0)) +
             sum((nvl(decode(hst.cdmovimento,
                              77,
                              hst.vlmulta,
                              85,
                              -hst.vlmulta,
                              86,
                              -hst.vlmulta,
                              87,
                              -hst.vlmulta,
                              89,
                              -hst.vlmulta,
                              hst.vlmulta),
                       0)) + (nvl(decode(hst.cdmovimento,
                                         77,
                                         hst.vljuros,
                                         85,
                                         -hst.vljuros,
                                         86,
                                         -hst.vljuros,
                                         87,
                                         -hst.vljuros,
                                         89,
                                         -hst.vljuros,
                                         hst.vljuros),
                                  0)) + nvl(fn_criteriotaxabancaria(hst.nrregistro_titulo,
                                                                    hst.dtrecebimento,
                                                                    ttr.aotrata_taxa),
                                            0) -
                  (nvl(decode(hst.cdmovimento,
                              77,
                              hst.vldesconto,
                              85,
                              -hst.vldesconto,
                              86,
                              -hst.vldesconto,
                              87,
                              -hst.vldesconto,
                              89,
                              -hst.vldesconto,
                              hst.vldesconto),
                       0)) - (nvl(decode(hst.cdmovimento,
                                         77,
                                         hst.vlabatimento,
                                         85,
                                         -hst.vlabatimento,
                                         86,
                                         -hst.vlabatimento,
                                         87,
                                         -hst.vlabatimento,
                                         89,
                                         -hst.vlabatimento,
                                         hst.vlabatimento),
                                  0)) - (nvl(decode(hst.cdmovimento,
                                                    77,
                                                    hst.vlabatimento_2,
                                                    85,
                                                    -hst.vlabatimento_2,
                                                    86,
                                                    -hst.vlabatimento_2,
                                                    87,
                                                    -hst.vlabatimento_2,
                                                    89,
                                                    -hst.vlabatimento_2,
                                                    hst.vlabatimento_2),
                                             0)) -
                  (nvl(decode(hst.cdmovimento,
                              77,
                              hst.vlir_fonte,
                              85,
                              -hst.vlir_fonte,
                              86,
                              -hst.vlir_fonte,
                              87,
                              -hst.vlir_fonte,
                              89,
                              -hst.vlir_fonte,
                              hst.vlir_fonte),
                       0)) - (nvl(decode(hst.cdmovimento,
                                         77,
                                         hst.vlabatimento_imposto,
                                         85,
                                         -hst.vlabatimento_imposto,
                                         86,
                                         -hst.vlabatimento_imposto,
                                         87,
                                         -hst.vlabatimento_imposto,
                                         89,
                                         -hst.vlabatimento_imposto,
                                         hst.vlabatimento_imposto),
                                  0)) - (nvl(decode(hst.cdmovimento,
                                                    77,
                                                    hst.vlrecebido,
                                                    85,
                                                    -hst.vlrecebido,
                                                    86,
                                                    -hst.vlrecebido,
                                                    87,
                                                    -hst.vlrecebido,
                                                    89,
                                                    -hst.vlrecebido,
                                                    hst.vlrecebido),
                                             0)))) vlaberto
        from producao.titulo_a_receber@unicoo_homologa ttr,
             producao.cliente@unicoo_homologa cli,
             producao.grupo_de_cliente@unicoo_homologa gcl,
             producao.pessoa@unicoo_homologa pes,
             producao.endereco@unicoo_homologa enr,
             producao.historico_do_titulo@unicoo_homologa hst,
             producao.cidade@unicoo_homologa cid,
             (select *
                from producao.v_codigo_de_historico_rec@unicoo_homologa
               where cdempresa = vpcdempresa) cdh,

             -- busca o valor do título na data contabil informada
             (select max(nrmovimento) nrmovimento, nrregistro_titulo
                from producao.historico_do_titulo@unicoo_homologa
               where cdempresa = vpcdempresa
                 and dtmovimento <= vpdtcontabil
                 and cdmovimento in (1, 2, 3, 11)
               group by nrregistro_titulo) h2
       where ttr.cdempresa = vpcdempresa
         and ttr.nrregistro_titulo = hst.nrregistro_titulo
         and ttr.nrregistro_titulo = h2.nrregistro_titulo
         and ttr.cdcliente = cli.cdcliente
         and cli.cdgrupo_cliente = gcl.cdgrupo_cliente
         and ttr.cdhistorico = cdh.cdhistorico
         and cli.nrregistro_cliente = pes.nrregistro
         and pes.nrregistro = enr.nrregistro(+)
         and enr.tpendereco(+) = 'COBR'
         and enr.cdcidade = cid.cdcidade(+)
         and ttr.dttitulo <= vpdtcontabil
         and ttr.dtencerramento > vpdtcontabil
         and ttr.cdsituacao <> 1 --DESCONSIDERAR ABERTOS - ALEX BOEIRA - 28/02/2018
         and hst.cdmovimento in (1,
                                 2,
                                 3,
                                 7,
                                 10,
                                 11,
                                 12,
                                 13,
                                 14,
                                 20,
                                 30,
                                 70,
                                 71,
                                 72,
                                 74,
                                 76,
                                 77,
                                 78,
                                 80,
                                 85,
                                 86,
                                 87,
                                 89)
         and hst.dtmovimento <= vpdtcontabil
         and not exists
       (select *
                from producao.historico_do_titulo@unicoo_homologa ht
               where ht.nrdocumento = ttr.nrdocumento
                 and ht.cdempresa = vpcdempresa
                 and vpdtcontabil >=
                     (select max(h.dtexclusao)
                        from historico_do_titulo h
                       where h.nrdocumento = ttr.nrdocumento
                         and h.cdempresa = vpcdempresa
                         and (vpdtcontabil >= h.dtexclusao)
                         and h.cdmovimento = '80')
                 and vpdtcontabil <
                     (select min(t.dtmovimento)
                        from historico_do_titulo t
                       where t.dtmovimento >=
                             (select max(h.dtexclusao)
                                from historico_do_titulo h
                               where h.nrdocumento = ttr.nrdocumento
                                 and h.cdempresa = vpcdempresa
                                 and (vpdtcontabil >= h.dtexclusao)
                                 and h.cdmovimento = '80')
                         and t.nrdocumento = ttr.nrdocumento
                         and t.cdempresa = vpcdempresa
                         and t.cdmovimento = '99'))
         and not exists
       (select null
                from producao.titulo_gerado_encontro@unicoo_homologa tg
               where tg.nrregistro_titulo_receber = ttr.nrregistro_titulo)
         and not exists
       (select null
                from producao.historico_do_titulo@unicoo_homologa h,
                     producao.historico_do_titulo@unicoo_homologa h3
               where producao.h.nrregistro_titulo = ttr.nrregistro_titulo
                 and h3.nrregistro_titulo = ttr.nrregistro_titulo
                 and h.cdmovimento in ('70', '72', '74', '76', '78')
                 and h3.cdmovimento = 86
                 and h3.dtreferencia <> h3.dtrecebimento
                 and h.dtrecebimento = vpdtcontabil)
         and ttr.dtvencimento between vpdtvenc_ini and vpdtvenc_fin
       group by ttr.cdcliente,
                ttr.nrdocumento,
                ttr.tpdocumento,
                ttr.cdportador,
                ttr.dttitulo,
                ttr.dtultimo_recebimento,
                pes.nopessoa,
                cid.nocidade,
                enr.nrtelefone,
                enr.nrfax,
                cdh.nohistorico,
                cli.cdconta_contabil,
                ttr.nrregistro_titulo,
                pes.nrregistro,
                ttr.cdsituacao;
    --commit;
  end p_gera_carga_matriz_acr;

  procedure p_apagar_matriz_acr(papagar boolean) is
  begin
    --o parametro foi recebido em tela no Jenkins. Somente prosseguir se o usuario informou TRUE.
    if papagar then
      delete from ti_matriz_receber;
    end if;
  end;

  procedure p_apagar_matriz_apb(papagar boolean) is
  begin
    --o parametro foi recebido em tela no Jenkins. Somente prosseguir se o usuario informou TRUE.
    if papagar then
      delete from ti_matriz_pagar;
    end if;
  end;

  procedure p_gera_carga_matriz_apb is

    vpcdempresa  varchar2(5);
    vpdtvenc_ini date;
    vpdtvenc_fin date;
    qt_registros number;
    vpdtcontabil date;

  begin
    --inicializar parametros
    vpcdempresa := pcdempresa_tit_apb;
    vpdtvenc_ini := pdtini_tit_apb;
    vpdtvenc_fin := pdtfim_tit_apb;

    begin
      vpdtcontabil := PDT_CONTABIL_APB;
    exception
      when others then
        vpdtcontabil := sysdate;
    end;

    --somente permitir executar o processo caso a tabela esteja vazia.
    --Motivo: rotina configurada no Jenkins. os demais processos são dependentes desse.
    --        a carga deve ser realizada apenas 1x com base em uma data contabil pre determinada.
    /*begin
      select nvl(count(*),'0') into qt_registros
        from ti_matriz_pagar;
    exception
      when others then
        qt_registros := 0;
    end;

    if qt_registros is not null and qt_registros > 0 then
      return;
    end if;*/

    p_apagar_matriz_apb(true);

    -- inserir novamente os titulos na tabela.
    insert into ti_matriz_pagar
      select t.nrregistro_titulo,
             p.nrregistro,
             t.cdempresa,
             t.nrdocumento,
             t.cdportador,
             t.tpdocumento,
             t.cdsituacao,
             case
               when t.cdsituacao = 0 then
                'Aberto'
               when t.cdsituacao = 1 then
                'Totalmente pago'
               when t.cdsituacao = 2 then
                'Parcialmente pago'
               when t.cdsituacao = 3 then
                'Encerrado em prejuizo'
               when t.cdsituacao = 4 then
                'Substituido aberto'
               when t.cdsituacao = 5 then
                'Substituido encerrado'
               else
                'Verificar Descrição'
             end descsituacao,
             t.dtvencimento,
             t.dttitulo,
             t.cdfornecedor,
             f.cdgrupo_fornecedor,
             g.nogrupo_fornecedor,
             p.nrcgc_cpf,
             nvl(min(t.vltitulo), 0) vltitulo,
             max(h.dtrecebimento) dtultimo_recebimento,
             sum(decode(h.cdmovimento, 11, 0, nvl(h.vlpago, 0))) vlpago,
             nvl(t.vltitulo, 0) +
             sum(-decode(h.cdmovimento, 11, 0, nvl(h.vlabatimento, 0)) -
                 decode(h.cdmovimento, 11, 0, nvl(h.vlabatimento_2, 0)) -
                 decode(h.cdmovimento, 11, 0, nvl(h.vldesconto, 0)) -
                 decode(h.cdmovimento, 11, 0, nvl(h.vlpago, 0)) +
                 decode(h.cdmovimento, 11, 0, nvl(h.vljuros, 0)) +
                 decode(h.cdmovimento, 11, 0, nvl(h.vlmulta, 0)) +
                 decode(h.cdmovimento, 11, 0, nvl(h.vltaxa_bancaria, 0))) vldevido,
             sum(decode(h.cdmovimento, 11, 0, nvl(h.vldesconto, 0))) vldesconto,
             sum(decode(h.cdmovimento, 11, 0, nvl(h.vlabatimento, 0))) vlabatimento,
             sum(decode(h.cdmovimento, 11, 0, nvl(h.vlabatimento_2, 0))) vlabatimento_2,
             sum(decode(h.cdmovimento, 11, 0, nvl(h.vljuros, 0))) vljuros,
             sum(decode(h.cdmovimento, 11, 0, nvl(h.vlmulta, 0))) vlmulta,
             sum(decode(h.cdmovimento, 11, 0, nvl(h.vltaxa_bancaria, 0))) vltaxa_bancaria
        from producao.pessoa@unicoo_homologa p,
             producao.fornecedor@unicoo_homologa f,
             producao.grupo_de_fornecedor@unicoo_homologa g,
             producao.empresa@unicoo_homologa e,
             producao.titulo_a_pagar@unicoo_homologa t,
             producao.documento_de_cobranca@unicoo_homologa d,
             producao.portador_de_cobranca@unicoo_homologa pc,
             (select nvl(decode(cdmovimento,
                                13,
                                0,
                                11,
                                0,
                                20,
                                0,
                                30,
                                0,
                                85,
                                -vlabatimento,
                                86,
                                -vlabatimento,
                                87,
                                -vlabatimento,
                                vlabatimento),
                         0) vlabatimento,
                     nvl(decode(cdmovimento,
                                13,
                                0,
                                11,
                                0,
                                20,
                                0,
                                30,
                                0,
                                85,
                                -vlabatimento_2,
                                86,
                                -vlabatimento_2,
                                87,
                                -vlabatimento_2,
                                vlabatimento_2),
                         0) vlabatimento_2,

                     nvl(decode(cdmovimento,
                                13,
                                0,
                                11,
                                0,
                                20,
                                0,
                                30,
                                0,
                                85,
                                -vldesconto,
                                86,
                                -vldesconto,
                                87,
                                -vldesconto,
                                vldesconto),
                         0) vldesconto,

                     nvl(decode(cdmovimento,
                                13,
                                vljuros,
                                25,
                                vljuros,
                                70,
                                vljuros,
                                72,
                                vljuros,
                                74,
                                vljuros,
                                76,
                                vljuros,
                                77,
                                vljuros,
                                85,
                                -vljuros,
                                86,
                                -vljuros,
                                87,
                                -vljuros,
                                0),
                         0) vljuros,

                     nvl(decode(cdmovimento,
                                7,
                                0,
                                11,
                                0,
                                12,
                                0,
                                13,
                                0,
                                14,
                                0,
                                20,
                                0,
                                30,
                                0,
                                80,
                                0,
                                85,
                                -vltaxa_bancaria,
                                86,
                                -vltaxa_bancaria,
                                87,
                                -vltaxa_bancaria,
                                vltaxa_bancaria),
                         0) vltaxa_bancaria,

                     nvl(decode(cdmovimento,
                                13,
                                vlmulta,
                                25,
                                vlmulta,
                                70,
                                vlmulta,
                                72,
                                vlmulta,
                                74,
                                vlmulta,
                                76,
                                vlmulta,
                                77,
                                vlmulta,
                                85,
                                -vlmulta,
                                86,
                                -vlmulta,
                                87,
                                -vlmulta,
                                0),
                         0) vlmulta,

                     nvl(decode(cdmovimento,
                                70,
                                vlpago,
                                72,
                                vlpago,
                                74,
                                vlpago,
                                76,
                                vlpago,
                                77,
                                vlpago,
                                85,
                                -vlpago,
                                86,
                                -vlpago,
                                87,
                                -vlpago,
                                0),
                         0) vlpago,
                     dtmovimento,
                     cdmovimento,
                     nrregistro_titulo,
                     dtrecebimento

                from producao.historico_do_titulo_pagar@unicoo_homologa
               where cdempresa = vpcdempresa
                 and cdmovimento in (1,
                                     2,
                                     3,
                                     4,
                                     7,
                                     9,
                                     11,
                                     12,
                                     13,
                                     14,
                                     20,
                                     25,
                                     30,
                                     70,
                                     72,
                                     74,
                                     76,
                                     77,
                                     80,
                                     85,
                                     86,
                                     87)
                 and (decode(cdmovimento,
                             1,
                             to_date(dttitulo), -- incl normal
                             --  2 , to_date(dtmovimento)   ,-- incl agrup
                             --  3 , to_date(dtmovimento)   ,-- incl desmp
                             7,
                             to_date(dtmovimento),
                             9,
                             to_date(dtmovimento),
                             11,
                             to_date(dtmovimento),
                             12,
                             to_date(dtmovimento),
                             13,
                             to_date(dtmovimento),
                             25,
                             to_date(dtmovimento),
                             70,
                             to_date(dtrecebimento), -- baixa normal
                             72,
                             to_date(dtrecebimento), -- baixa arq mag
                             74,
                             to_date(dtrecebimento), -- baixa deb auto
                             75,
                             to_date(dtrecebimento), -- baixa composicao
                             76,
                             to_date(dtrecebimento), -- baixa enc ctas
                             77,
                             to_date(dtrecebimento), -- baixa por adiantamento
                             85,
                             to_date(dtmovimento),
                             86,
                             to_date(dtmovimento),
                             87,
                             to_date(dtmovimento),
                             80,
                             to_date(dttitulo)) <=
                     to_date(vpdtcontabil, 'dd/mm/yyyy') -- titulo cancelado  --
                     or (cdmovimento = 20) or (cdmovimento = 30))
                 and (dtexclusao is null or
                     cdmovimento = 80 and
                     dtexclusao > to_date(vpdtcontabil, 'dd/mm/yyyy'))) h,
             (select d.nrregistro_titulo,
                     --        d.cddivisao,
                     --        d.cdcentro_custo,
                     --        d.cdhistorico,
                     sum(decode(d.tipo_distrib, 'V', d.vldistribuicao, 0)) vltitulo,
                     sum(decode(d.tipo_distrib, 'D', d.vldistribuicao, 0)) vldesconto,
                     sum(decode(d.tipo_distrib, 'A', d.vldistribuicao, 0)) vlabatimento,
                     sum(decode(d.tipo_distrib, 'B', d.vldistribuicao, 0)) vlabatimento_2
                from producao.distribuicao_titulo_pagar@unicoo_homologa d
               where d.nrmovimento in
                     (select max(a.nrmovimento) nrmovimento
                        from producao.historico_do_titulo_pagar@unicoo_homologa a,
                             producao.distribuicao_titulo_pagar@unicoo_homologa b
                       where a.nrregistro_titulo = d.nrregistro_titulo
                         and b.nrregistro_titulo = d.nrregistro_titulo
                         and a.dtmovimento <=
                             to_date(vpdtcontabil, 'dd/mm/yyyy')
                         and a.nrmovimento = b.nrmovimento
                       group by b.tipo_distrib)
               group by d.nrregistro_titulo) k
       where t.cdempresa = e.cdempresa
         and t.nrregistro_titulo = h.nrregistro_titulo(+)
         and t.nrregistro_titulo = k.nrregistro_titulo(+)
         and t.tpdocumento = d.tpdocumento
         and t.cdportador = pc.cdportador
         and t.cdfornecedor = f.cdfornecedor
         and f.nrregistro_fornecedor = p.nrregistro
         and f.cdgrupo_fornecedor = g.cdgrupo_fornecedor
         and t.dttitulo <= to_date(vpdtcontabil, 'dd/mm/yyyy')
         and t.cdempresa = vpcdempresa
         and ((t.cdsituacao in ('0', '2', '4', '6', '7')) or
             (t.cdsituacao in ('1', '5') and t.dtultimo_recebimento > to_date(vpdtcontabil, 'dd/mm/yyyy')) or
             (t.cdsituacao in ('1', '5') and
             fn_saldo_titulo_pag_data(t.nrregistro_titulo,
                                        to_date(to_date(vpdtcontabil,
                                                        'dd/mm/yyyy')) + 1,
                                        0) > 0) or
             (t.cdsituacao = '8' and
             t.dtexclusao > to_date(vpdtcontabil, 'dd/mm/yyyy')))
         and not exists
       (select null
                from titulo_gerado_encontro tg
               where tg.nrregistro_titulo_pagar = t.nrregistro_titulo)
         and not exists
       (select null
                from historico_do_titulo_pagar h
               where h.nrregistro_titulo = t.nrregistro_titulo
                 and h.cdmovimento = 5)
         and t.dtvencimento between vpdtvenc_ini and vpdtvenc_fin
         and t.tpdocumento <> 'ADT'
       group by t.nrregistro_titulo,
                t.cdfornecedor,
                p.nrregistro,
                t.cdempresa,
                t.idcontrato,
                t.cdhistorico,
                t.nrdocumento,
                t.cdportador,
                t.tpdocumento,
                t.cdsituacao,
                t.cdoperacao,
                t.dtvencimento,
                t.dttitulo,
                t.cddivisao,
                t.txhistorico,
                f.cdgrupo_fornecedor,
                g.nogrupo_fornecedor,
                p.nopessoa,
                p.nrcgc_cpf,
                p.tppessoa,
                e.noempresa,
                d.nodocumento,
                pc.noportador,
                f.cdconta_contabil,
                t.vltitulo
      having nvl(decode(t.cdsituacao, '6', max(decode(h.cdmovimento, 20, h.dtmovimento, null)), null), to_date('01/01/3000', 'dd/mm/yyyy')) > to_date(vpdtcontabil, 'dd/mm/yyyy') and nvl(decode(t.cdsituacao, '7', max(decode(h.cdmovimento, 30, h.dtmovimento, null)), null), to_date('01/01/3000', 'dd/mm/yyyy')) > to_date(vpdtcontabil, 'dd/mm/yyyy');

    commit;
  end p_gera_carga_matriz_apb;

  procedure p_gera_dados_comparativo_acr is
  begin
    delete from ti_tit_acr_comparativo;
    --commit;

    insert into ti_tit_acr_comparativo
      select distinct ta.cod_refer,
                      min(a.nrsequencial) nrsequencial,
                      a.nrsequencial_origem,
                      a.tpintegracao,
                      nvl(b.val_titulo, 0) val_titulo,
                      --nvl(imp.val_imposto,0) val_imposto,
                      a.cdsituacao sit_ti_controle,
                      nvl(b.cdsituacao, 'NI') sit_ti_tit_apb,
                      nvl(ta.val_origin_tit_acr, 0) vloriginal,
                      nvl(ta.val_sdo_tit_acr, 0) val_sdo_tit_ap
        from ti_controle_integracao a, ti_tit_acr b, tit_acr ta
       where a.nrsequencial = b.nrseq_controle_integracao(+)
         and nvl(a.tpintegracao, 'TR') = 'TR'
         and nvl(a.cdsituacao, 'RE') <> 'RE'
         and 'TR' || lpad(b.nrseq_controle_integracao, 8, '0') =
             ta.cod_refer(+)
         and nvl(ta.u##ind_tip_espec_docto, 'NORMAL') = 'NORMAL'
       group by ta.cod_refer,
                a.nrsequencial_origem,
                a.tpintegracao,
                b.val_titulo,
                a.cdsituacao,
                b.cdsituacao,
                ta.val_origin_tit_acr,
                ta.val_sdo_tit_acr;
    --commit;

  end p_gera_dados_comparativo_acr;

  procedure p_gera_dados_comparativo_apb is
  begin
    delete from ti_tit_apb_comparativo;
    --commit;

    insert into ti_tit_apb_comparativo
      select distinct tp.cod_refer,
                      min(a.nrsequencial) nrsequencial,
                      a.nrsequencial_origem,
                      a.tpintegracao,
                      nvl(b.val_titulo, 0) val_titulo,
                      nvl(imp.val_imposto, 0) val_imposto,
                      a.cdsituacao sit_ti_controle,
                      nvl(b.cdsituacao, 'NI') sit_ti_tit_apb,
                      nvl(tp.val_origin_tit_ap, 0) vloriginal,
                      nvl(tp.val_sdo_tit_ap, 0) val_sdo_tit_ap
        from ti_controle_integracao a,
             ti_tit_apb b,
             tit_ap tp,
             (select i.nrseq_controle_integracao,
                     sum(i.val_imposto) val_imposto
                from ti_tit_apb_imposto i
               group by i.nrseq_controle_integracao) imp

       where a.nrsequencial = b.nrseq_controle_integracao(+)
         and nvl(a.tpintegracao, 'TP') = 'TP'
         and nvl(a.cdsituacao, 'RE') <> 'RE'
         and imp.nrseq_controle_integracao(+) = a.nrsequencial
         and 'I' || lpad(b.nrseq_controle_integracao, 9, '0') =
             tp.cod_refer(+)
         and nvl(tp.u##ind_tip_espec_docto, 'NORMAL') = 'NORMAL'
       group by tp.cod_refer,
                a.nrsequencial_origem,
                a.tpintegracao,
                b.val_titulo,
                imp.val_imposto,
                a.cdsituacao,
                b.cdsituacao,
                tp.val_origin_tit_ap,
                tp.val_sdo_tit_ap;
    --commit;

  end p_gera_dados_comparativo_apb;

  procedure p_apaga_pessoa_juridica is

    cursor c_pessoa_jurid is
      select progress_recid
        from ems5.pessoa_jurid pj
       where not exists
       (select 1
                from v_pessoa_juridica v
               where pj.num_pessoa_jurid = v.NUM_PESSOA_JURID);

  begin

    for pj in c_pessoa_jurid loop

      delete from ems5.pessoa_jurid p
       where p.progress_recid = pj.progress_recid;

      p_commit;

    end loop;

    --commit;

  end p_apaga_pessoa_juridica;

  procedure p_reprocessa_status_pe(pnrseq_controle_integracao ti_controle_integracao.nrsequencial%type,
                                   ptpintegracao              ti_controle_integracao.tpintegracao%type)

   is

  begin

    if ptpintegracao = 'CL' then

      delete from ti_cliente tc
       where (tc.nrseq_controle_integracao = pnrseq_controle_integracao or
             pnrseq_controle_integracao is null)
         and tc.cdsituacao = 'PE';

      commit;

      pck_ems506unicoo.p_job;

    elsif ptpintegracao = 'FN' then

      delete from ti_fornecedor tc
       where (tc.nrseq_controle_integracao = pnrseq_controle_integracao or
             pnrseq_controle_integracao is null)
         and tc.cdsituacao = 'PE';

      commit;

      pck_ems506unicoo.p_job;

    elsif ptpintegracao = 'TP' then

      delete from ti_tit_apb tc
       where (tc.nrseq_controle_integracao = pnrseq_controle_integracao or
             pnrseq_controle_integracao is null)
         and tc.cdsituacao = 'PE';

      commit;

      pck_ems506unicoo.p_job;

    elsif ptpintegracao = 'TR' then

      delete from ti_tit_acr tc
       where (tc.nrseq_controle_integracao = pnrseq_controle_integracao or
             pnrseq_controle_integracao is null)
         and tc.cdsituacao = 'PE';

      commit;

      pck_ems506unicoo.p_job;

    end if;

  end p_reprocessa_status_pe;

Procedure p_atualiza_fluxo_financ_fornec

is

  v integer;
  registro number;

  Cursor c is
  select
      distinct f.nrregistro_fornecedor
  from
      producao.historico_do_titulo_pagar@unicoo_homologa h,
      producao.fornecedor@unicoo_homologa f,
      ems5.fornecedor ef,
      ti_pessoa p
  where h.cdhistorico          is not null
  and   h.cdfornecedor         is not null
  and   h.cdfornecedor         = f.cdfornecedor
  and   f.nrregistro_fornecedor = p.nrregistro
  and   p.cdn_fornecedor        = ef.cdn_fornecedor
  order by 1;

  Cursor D is
  select
      tip.cdn_fornecedor,
      t.cdhistorico
  from
     (select
         f1.nrregistro_fornecedor,
         h1.cdhistorico,
         tp.dttitulo,
         count(*) maior
      from
         producao.historico_do_titulo_pagar@unicoo_homologa h1,
         producao.fornecedor@unicoo_homologa f1,
         producao.titulo_a_pagar@unicoo_homologa tp
      where h1.cdhistorico          is not null
      and   h1.cdfornecedor         is not null
      and   h1.cdfornecedor         = f1.cdfornecedor
      and   h1.nrregistro_titulo    = tp.nrregistro_titulo
      group by (f1.nrregistro_fornecedor,h1.cdhistorico, tp.dttitulo)
      order by 1,2,4 desc, 3 desc) t,
      ti_pessoa tip,
      ems5.fornecedor ef5
  where t.nrregistro_fornecedor = tip.nrregistro
      and   tip.cdn_fornecedor      = ef5.cdn_fornecedor
      and   tip.nrregistro          = registro
      and   rownum =1;

  begin

    for v in c loop

       registro:=v.nrregistro_fornecedor;

       for w in d loop

           update ems5.fornec_financ ffe
               set ffe.cod_tip_fluxo_financ = decode((select tia.cod_tip_fluxo_financ from ems506unicoo.ti_tipo_movimento_tit_apb tia
                                                      where tia.cdmovimento = w.cdhistorico),null,
                                                     decode((select ps.tppessoa from pessoa ps where ps.nrregistro = v.nrregistro_fornecedor),
                                                             'J',
                                                             (select pi.vlparametro from ti_parametro_integracao pi where pi.cdparametro = 'COD_TIP_FLUXO_FINANC_PREFER_FOR_J'),
                                                             (select pi.vlparametro from ti_parametro_integracao pi where pi.cdparametro = 'COD_TIP_FLUXO_FINANC_PREFER_FOR_F')),
                                                             (select tia.cod_tip_fluxo_financ from ems506unicoo.ti_tipo_movimento_tit_apb tia
                                                              where tia.cdmovimento = w.cdhistorico))
           where ffe.cdn_fornecedor = w.cdn_fornecedor;

       end loop;

    commit;

   end loop;

end p_atualiza_fluxo_financ_fornec;

procedure insere_hash(ptpintegracao varchar2,
                      pnrsequencial_origem number,
                      pcdidentificador varchar2) is
  hash_atual varchar2(100);
begin
  case ptpintegracao
    when 'FN' then hash_atual := gerar_hash_fornecedor_unicoo(pcdidentificador,pnrsequencial_origem);
    when 'CL' then hash_atual := gerar_hash_cliente_unicoo(pcdidentificador,pnrsequencial_origem);
    --when 'TP' then hash_atual := gerar_hash_fornecedor_unicoo(pcdidentificador); --LG$_TITULO_A_PAGAR
    --when 'TR' then hash_atual := gerar_hash_fornecedor_unicoo(pcdidentificador); --LG$_TITULO_A_RECEBER
  end case;

  --apagar hash anterior da mesma chave
  delete from ti_hash h
     where h.tpintegracao = ptpintegracao
       and h.nrsequencial_origem = pnrsequencial_origem
       and h.cdidentificador = pcdidentificador;

  insert into ti_hash(nrsequencial        ,
                      tpintegracao        ,
                      dtgeracao           ,
                      nrsequencial_origem ,
                      cdidentificador     ,
                      txhash              )
                values(ti_hash_seq.nextval,
                       ptpintegracao,
                       sysdate,
                       pnrsequencial_origem,
                       pcdidentificador,
                       hash_atual);
end insere_hash;

begin
  -- Alessandro 20/03/2012

  Pcpf_dtnascimento  := f_ti_parametro_integracao('CPF_DTNASCIMENTO');
  pcdempresa_tit_acr := f_ti_parametro_integracao('CDEMPRESA_TIT_ACR');
  pdtini_tit_acr     := f_ti_parametro_integracao('DTINI_TIT_ACR');
  pdtfim_tit_acr     := f_ti_parametro_integracao('DTFIM_TIT_ACR');
  pcdempresa_tit_apb := f_ti_parametro_integracao('CDEMPRESA_TIT_APB');
  pdtini_tit_apb     := f_ti_parametro_integracao('DTINI_TIT_APB');
  pdtfim_tit_apb     := f_ti_parametro_integracao('DTFIM_TIT_APB');

  PMIGRAR_TITULOS_ACR_FECHADOS := f_ti_parametro_integracao('MIGRAR_TITULOS_ACR_FECHADOS');
  PDT_INI_TITULOS_ACR_FECHADOS := f_ti_parametro_integracao('DT_INICIO_TITULOS_ACR_FECHADOS');
  PDT_CONTABIL_APB := f_ti_parametro_integracao('DT_CONTABIL_APB');
  PDT_CONTABIL_ACR := f_ti_parametro_integracao('DT_CONTABIL_ACR');
  PCOD_EMPRESA     := f_ti_parametro_integracao('COD_EMPRESA');
  PCOD_EMPRESA_UNICOO := f_ti_parametro_integracao('COD_EMPRESA_UNICOO');

  NULL;
END PCK_EMS506UNICOO;
/

prompt
prompt Creating package body PCK_EMS506UNICOO_A
prompt ========================================
prompt
CREATE OR REPLACE PACKAGE BODY EMS506UNICOO."PCK_EMS506UNICOO_A" IS

  /*  -- Private type declarations
  type <TypeName> is <Datatype>;
  -- Private constant declarations
  <ConstantName> constant <Datatype> := <Value>;
  -- Private variable declarations
  <VariableName> <Datatype>;
  -- Function and procedure implementations
  function <FunctionName>(<Parameter> <Datatype>) return <Datatype> is
    <LocalVariable> <Datatype>;
  begin
    <Statement>;
    return(<Result>);
  end;*/
  /*
  ************************************************************************************************************************************************
  Criac?o          : Alecsandro Ferreira dos Santos
  Data             : 02/07/2009
  Modulo Principal : Integrac?o Unicoo X EMS5
  Modulos          : Integrac?o Unicoo X EMS5
  Objetivo         : Realizar a integrac?o do Unicoo com o EMS5
  Alteracoes
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
  |----------------------------------------------------------------------------------------------------------------------------------------------|
  | 09/03/2012 | Alessandro      |                 |           | - Implementada controle de cancelamento de faturas, para permitir cancelar      |
  |            |                 |                 |           |   faturas no modulo faturamento que est?o contabilizadas no EMS5, foi criado o  |
  |            |                 |                 |           |   parametro CANCELFTCTBL com o valor "S" utiliza o controle, valor "N" n?o      |
  |            |                 |                 |           |   utiliza o controle.                                                           |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 21/03/2012 | Alessandro      |                 |           | - Foi realizado correc?o para controla a integrac?o das Faturas Cancelas com o  |
  |            |                 |                 |           |   EMS5, o parametro CANCELFTCTBL foi alterado, com o valor "S" n?o mudou, para  |
  |            |                 |                 |           |   o valor "N" a integrac?o n?o barra o cancelamento no modulo de Faturamento,   |
  |            |                 |                 |           |   mas so envia o estorno para o EMS5 quando o titulo esta contabilizado,        |
  |            |                 |                 |           |   enquanto isso o cancelamento fica pendente na integrac?o com a situac?o ER,   |
  |            |                 |                 |           |   quando o titulo e contabilizado a integrac?o libera o cancelamento            |
  |            |                 |                 |           |   para integrar.                                                                |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 31/05/2012 | Edmilson Braz Fo|                 |           | - O processo de integracao do ACR estava usando o historico do movimento 1 do   |
  |            |                 |                 |           |   titulo a receber para titulos sem fatura, porem, para o ajius n?o esta sendo  |
  |            |                 |                 |           |   o historico nesse movto, o processo foi alterado para pegar o titulo caso     |
  |            |                 |                 |           |   nulo no movimento.                                                            |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  ************************************************************************************************************************************************
  */
  -- parametros genericos
  VVERSAOFINANCEIRO VARCHAR2(10);

  WNAOREPROCESSA    TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;
  PCPF_DTNASCIMENTO TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;

  TTIT_AP TIT_AP%ROWTYPE;

  PROCEDURE VALIDA_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                           PCDFORNECEDOR_EMS5         IN NUMBER) IS
    TTI_TIT_APB TI_TIT_APB%ROWTYPE;
    JAEXISTE    NUMBER;
  BEGIN
    SELECT *
      INTO TTI_TIT_APB
      FROM TI_TIT_APB A
     WHERE NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
    BEGIN
      SELECT COUNT(1)
        INTO JAEXISTE
        FROM TIT_AP A, TI_EMPRESA EMP
       WHERE 1 = 1
         AND A.CDN_FORNECEDOR = PCDFORNECEDOR_EMS5
         AND A.COD_TIT_AP = TTI_TIT_APB.COD_TITULO_AP
         AND A.COD_ESPEC_DOCTO = TTI_TIT_APB.COD_ESPEC_DOCTO
         AND A.COD_SER_DOCTO = TTI_TIT_APB.COD_SER_DOCTO
         AND A.COD_EMPRESA = EMP.COD_EMPRESA
         AND A.COD_PARCELA = TTI_TIT_APB.COD_PARCELA
         AND EMP.CDEMPRESA =
             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
      -- fabiano, nao foi encontrado necessidade de manter a delecao deste registro.
      --          delete ti_tit_apb where nrseq_controle_integracao = pnrseq_controle_integracao;
      -- fabiano,  caso encontre mais que 1 titulo, entao gera falha
      IF JAEXISTE > 0 THEN
        RAISE_APPLICATION_ERROR(-20010, 'Titulo ja existe no EMS');
      END IF;
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        NULL;
    END;
  END;

  PROCEDURE CANCELA_CONTROLE_TIT_IMPOSTOS(PNRSESSAO IN NUMBER) IS
    WTPDOC VARCHAR2(40);
  BEGIN
    /*
       Cancela os controles de titulos do contas a pagar unicoo referentes
       a impostos ( TX ), pois esses titulos n?o s?o integrados para o EMS
    */
    WTPDOC := F_PARAMETRO('TPDOCPRE');
    IF WTPDOC IS NULL THEN
      RAISE_APPLICATION_ERROR(-20001, 'Parametro TPDOCPRE n?o encontrado');
    END IF;
    FOR X IN (SELECT A.ROWID
                FROM TI_CONTROLE_INTEGRACAO A, TITULO_A_PAGAR B
               WHERE A.NRSEQUENCIAL_ORIGEM = B.NRREGISTRO_TITULO
                 AND A.CDSITUACAO IN ('GE', 'ER', 'PE', 'RC') --ADICIONADO OUTRAS SITUACOES ALEM DE GE --BRAZ 11/11/10
                 AND A.TPINTEGRACAO = 'TP'
                 AND A.NRSESSAO = PNRSESSAO
                 AND B.TPDOCUMENTO = WTPDOC
                 AND NOT EXISTS
               (SELECT 1
                        FROM TAXA_TITULO_INTEGRACAO T
                       WHERE T.NRREGISTRO_TITULO_TAXA = B.NRREGISTRO_TITULO)) LOOP
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'A integracao do unicoo com o ems5 nao integra titulos de previsao'
       WHERE ROWID = X.ROWID;
    END LOOP;
  END;

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_ACR(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
    VCTBZDA NUMBER; -- Alessandro 29/09/2011
    QTD_MOV NUMBER;
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TR'
         AND CI.NRSEQUENCIAL_ORIGEM = PNRRREGISTRO_TITULO
         AND CI.CDIDENTIFICADOR = PNRDOCUMENTO
         AND CI.CDIDENTIFICADOR NOT IN ('CA', 'RE');
    VACHOU BOOLEAN;
  BEGIN
    VACHOU := FALSE;
    FOR L_TITULO IN C_TITULO LOOP
      IF L_TITULO.CDSITUACAO = 'IT' THEN
        VACHOU := TRUE;
      ELSIF L_TITULO.CDSITUACAO IN ('GE', 'ER') THEN
        UPDATE TI_CONTROLE_INTEGRACAO TA
           SET TA.CDSITUACAO = 'CA', TA.TXOBSERVACAO = 'LINHA 152'
         WHERE TA.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
      ELSE
        BEGIN
          UPDATE TI_TIT_ACR TA
             SET TA.CDSITUACAO = 'CA'
           WHERE TA.NRSEQ_CONTROLE_INTEGRACAO = L_TITULO.NRSEQUENCIAL;
          -----
          UPDATE TI_CONTROLE_INTEGRACAO TA
             SET TA.CDSITUACAO = 'CA', TA.TXOBSERVACAO = 'LINHA 166'
           WHERE TA.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
        EXCEPTION
          WHEN OTHERS THEN
            VACHOU := TRUE;
            RAISE_APPLICATION_ERROR(-20101,
                                    'Erro ao cancelar a integrao da fatura ' ||
                                    PNRDOCUMENTO || ' ' || SQLERRM);
        END;
      END IF;
    END LOOP;
    IF VACHOU THEN
      SELECT COUNT(*)
        INTO QTD_MOV
        FROM EMS_MOVIMENTO_TITULO_ACR EMS, MOVTO_TIT_ACR MOV --BRAZ 10/12
       WHERE EMS.NUM_ID_MOVTO_TIT_ACR = MOV.NUM_ID_MOVTO_TIT_ACR
         AND MOV.U##COD_ESTAB = EMS.COD_ESTAB
         AND EMS.NRREGISTRO_TITULO = PNRRREGISTRO_TITULO;
      IF QTD_MOV > 1 THEN
        VRESULT := 'N';
      ELSE
        IF F_TI_PARAMETRO_INTEGRACAO('CANCELFTCTBL') = 'S' THEN
          -- ALESSANDRO 09/03/2012
          -- vResult:='S'; -- Alessandro 07/03/2012
          -- Inicio Alessandro 29/09/2011
          VCTBZDA := 0;
          SELECT MOV.LOG_APROP_CTBL_CTBZDA
            INTO VCTBZDA
            FROM EMS_MOVIMENTO_TITULO_ACR EMS, MOVTO_TIT_ACR MOV --BRAZ 10/12
           WHERE EMS.NUM_ID_MOVTO_TIT_ACR = MOV.NUM_ID_MOVTO_TIT_ACR
             AND MOV.U##COD_ESTAB = EMS.COD_ESTAB
             AND EMS.NRREGISTRO_TITULO = PNRRREGISTRO_TITULO;
          IF VCTBZDA = 0 THEN
            VRESULT := 'N';
            RAISE_APPLICATION_ERROR(-20101,
                                    'Titulo no EMS5 n?o esta contabilizado. Contabilize antes de Cancelar.');
          ELSE
            VRESULT := 'S';
          END IF;
          -- Final Alessandro 29/09/2011
        ELSE
          VRESULT := 'S';
        END IF; -- ALESSANDRO 09/03/2012
      END IF;
    ELSE
      VRESULT := 'S';
    END IF;
    RETURN VRESULT;
  END;

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_APB(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TP'
         AND CI.NRSEQUENCIAL_ORIGEM = PNRRREGISTRO_TITULO
         AND CI.CDIDENTIFICADOR = PNRDOCUMENTO
         AND CI.CDIDENTIFICADOR NOT IN ('CA', 'RE');
    VACHOU BOOLEAN;
  BEGIN
    VACHOU := FALSE;
    FOR L_TITULO IN C_TITULO LOOP
      IF L_TITULO.CDSITUACAO = 'IT' THEN
        VACHOU := TRUE;
      ELSIF L_TITULO.CDSITUACAO IN ('GE', 'ER') THEN
        UPDATE TI_CONTROLE_INTEGRACAO TA
           SET TA.CDSITUACAO = 'CA', TA.TXOBSERVACAO = 'LINHA 250'
         WHERE TA.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
      ELSE
        BEGIN
          UPDATE TI_TIT_APB TA
             SET TA.CDSITUACAO = 'CA'
           WHERE TA.NRSEQ_CONTROLE_INTEGRACAO = L_TITULO.NRSEQUENCIAL;
        EXCEPTION
          WHEN OTHERS THEN
            VACHOU := TRUE;
            RAISE_APPLICATION_ERROR(-20101,
                                    'Erro ao cancelar a integrao da fatura ' ||
                                    PNRDOCUMENTO || ' ' || SQLERRM);
        END;
      END IF;
    END LOOP;
    IF VACHOU THEN
      VRESULT := 'N';
    ELSE
      VRESULT := 'S';
    END IF;
    RETURN VRESULT;
  END;

  FUNCTION F_PERMITE_ALTERAR_TIT_ACR(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
  BEGIN
    -- select DECODE(count(*),0,'S','N')
    SELECT CASE
             WHEN COUNT(*) < 1 THEN
              'S'
             ELSE
              'N'
           END
      INTO VRESULT
      FROM EMS_MOVIMENTO_TITULO_ACR EMS, EMS506UNICOO.TIT_ACR TTA --BRAZ 10/12
     WHERE EMS.NRDOCUMENTO = PNRDOCUMENTO
       AND EMS.NRREGISTRO_TITULO = PNRREGISTRO_TITULO
       AND EMS.NUM_ID_TIT_ACR = TTA.NUM_ID_TIT_ACR
       AND EMS.COD_ESTAB = TTA.U##COD_ESTAB
       AND EMS.IND_TRANS_ACR_ABREV = 'IMPL';
    -----------------------------
    RETURN VRESULT;
  END;

  FUNCTION F_PERMITE_ALTERAR_TIT_APB(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
  BEGIN
    SELECT DECODE(COUNT(*), 0, 'S', 'N')
      INTO VRESULT
      FROM TI_MOVTO_TIT_AP EMS, TIT_AP TTA
     WHERE EMS.NRDOCUMENTO = PNRDOCUMENTO
       AND EMS.NRREGISTRO_TITULO = PNRREGISTRO_TITULO
       AND EMS.NUM_ID_TIT_AP = TTA.NUM_ID_TIT_AP
       AND EMS.COD_ESTAB = TTA.U##COD_ESTAB
       AND EMS.IND_TRANS_AP_ABREV = 'IMPL';
    -----------------------------
    RETURN VRESULT;
  END;

  PROCEDURE P_INS_TI_CONTROLE_INTEGRACAO(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER) IS
    VSEQUENCIAL TI_CONTROLE_INTEGRACAO.NRSEQUENCIAL%TYPE;
  BEGIN
    IF NOT F_TI_PARAMETRO_INTEGRACAO('TP_INTEGRACAO_ONLINE_UNICOO_EMS5') LIKE
        '%' || PTPINTEGRACAO || '%' THEN
      RETURN;
    END IF;
    SELECT SQ_TI_CONTROLE_INTEGRACAO.NEXTVAL INTO VSEQUENCIAL FROM DUAL;
    INSERT INTO TI_CONTROLE_INTEGRACAO
      (NRSEQUENCIAL,
       TPINTEGRACAO,
       DTGERACAO,
       NRSEQUENCIAL_ORIGEM,
       DTPROCESSAMENTO,
       DTINTEGRACAO,
       CDACAO,
       CDIDENTIFICADOR,
       CDSITUACAO,
       CDEMPRESA,
       CDMODULO,
       NRSEQ_CONTROLE_INTEGRACAO_ORG)
    VALUES
      (VSEQUENCIAL,
       PTPINTEGRACAO,
       SYSDATE,
       PNRSEQUENCIAL_ORIGEM,
       NULL,
       NULL,
       PCDACAO,
       PCDIDENTIFICADOR,
       'GE',
       PCDEMPRESA,
       PCDMODULO,
       PNRSEQ_CONTROLE_INTEGRACAO_ORG);
  END;

  PROCEDURE P_INS_TI_CONTROLE_INTEGR_CAN(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER) IS
    VSEQUENCIAL TI_CONTROLE_INTEGRACAO.NRSEQUENCIAL%TYPE;
  BEGIN
    IF NOT F_TI_PARAMETRO_INTEGRACAO('TP_INTEGRACAO_ONLINE_UNICOO_EMS5') LIKE
        '%' || PTPINTEGRACAO || '%' THEN
      RETURN;
    END IF;
    SELECT SQ_TI_CONTROLE_INTEGRACAO.NEXTVAL INTO VSEQUENCIAL FROM DUAL;
    INSERT INTO TI_CONTROLE_INTEGRACAO
      (NRSEQUENCIAL,
       TPINTEGRACAO,
       DTGERACAO,
       NRSEQUENCIAL_ORIGEM,
       DTPROCESSAMENTO,
       DTINTEGRACAO,
       CDACAO,
       CDIDENTIFICADOR,
       CDSITUACAO,
       CDEMPRESA,
       CDMODULO,
       NRSEQ_CONTROLE_INTEGRACAO_ORG)
    VALUES
      (VSEQUENCIAL,
       PTPINTEGRACAO,
       SYSDATE,
       PNRSEQUENCIAL_ORIGEM,
       NULL,
       NULL,
       PCDACAO,
       PCDIDENTIFICADOR,
       'CA',
       PCDEMPRESA,
       PCDMODULO,
       PNRSEQ_CONTROLE_INTEGRACAO_ORG);
  END;

  /*PROCEDURE P_DEFINE_TI_PESSOA(PNRCGC_CPF              VARCHAR2,
                                 PNOPESSOA               VARCHAR2,
                                 PDTNASCIMENTO           DATE,
                                 PTPPESSOA               VARCHAR2,
                                 PNRREGISTRO             NUMBER,
                                 PTPORIGEM               VARCHAR2,
                                 PNOABREVIADO_FORNECEDOR IN OUT VARCHAR2,
                                 PCDN_FORNECEDOR         IN OUT VARCHAR2,
                                 PNOABREVIADO_CLIENTE    IN OUT VARCHAR2,
                                 PCDN_CLIENTE            IN OUT VARCHAR2,
                                 PAODEFINEPESSOA         VARCHAR2 -- < S/N>
                                 ) IS
      VNOM_ABREV_CLIENTE      TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
      VNOM_ABREV_FORNECEDOR   TI_PESSOA.NOABREVIADO_FORNECEDOR%TYPE;
      VNOABREVIADO_CLIENTE    TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
      VNOABREVIADO_FORNECEDOR TI_PESSOA.NOABREVIADO_FORNECEDOR%TYPE;
      VCDN_CLIENTE            TI_PESSOA.CDN_CLIENTE%TYPE;
      VCDN_FORNECEDOR         TI_PESSOA.CDN_FORNECEDOR%TYPE;
      VTI_PESSOA              TI_PESSOA%ROWTYPE;
      VTI_PESSOA_PAI          TI_PESSOA%ROWTYPE;
      VNOM_ABREVIADO          TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
      VCOUNT                  NUMBER;
      CNOM_ABREVIADO          TI_PESSOA.NOABREVIADO_CLIENTE%TYPE := 'p' ||
                                                                    PNRREGISTRO;
      --======================--
      -- Definir a Pessoa Pai --
      --------------------------
      PROCEDURE P_DEFINE_PESSOA_PAI IS
      BEGIN

      --============================================--
      --IMPLENTAÇÃO NOVA IGUAÇU DE/PARA REGISTRO PAI--
      --============================================--
        BEGIN
          SELECT TI.*
            INTO VTI_PESSOA
            FROM TI_PESSOA TI, TI_REGISTRO_PAI TRP
           WHERE TI.NRREGISTRO = TRP.NRREGISTRO_PAI
             AND TRP.NRREGISTRO_FILHO = PNRREGISTRO;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN

            IF PTPPESSOA = 'F' THEN
              BEGIN

                --============--
                -- CPF / NOME --
                ----------------
                SELECT TI.*
                  INTO VTI_PESSOA
                  FROM PESSOA PS, TI_PESSOA TI
                 WHERE TI.NRREGISTRO = PS.NRREGISTRO
                   AND PS.NRCGC_CPF = PNRCGC_CPF
                   AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
                   AND PS.TPPESSOA = PTPPESSOA
                   AND TI.NRREGISTRO_PAI IS NULL
                   AND ROWNUM = 1;
                VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CPF_PESSOA';
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  BEGIN
                    --==========================--
                    -- CPF / DATA DE NASCIMENTO --
                    ------------------------------
                    SELECT TI.*
                      INTO VTI_PESSOA
                      FROM PESSOA PS, TI_PESSOA TI
                     WHERE TI.NRREGISTRO = PS.NRREGISTRO
                       AND PS.NRCGC_CPF = PNRCGC_CPF
                       AND PS.DTNASCIMENTO = PDTNASCIMENTO
                       AND PS.TPPESSOA = PTPPESSOA
                       AND PS.DTNASCIMENTO IS NOT NULL
                       AND ROWNUM = 1;
                    VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CPF_DTNASCIMENTO';
                  EXCEPTION
                    WHEN NO_DATA_FOUND THEN
                      VTI_PESSOA := NULL;
                  END;
              END;
            ELSE
              BEGIN
                --======--
                -- CNPJ --
                ----------
                SELECT TI.*
                  INTO VTI_PESSOA
                  FROM PESSOA PS, TI_PESSOA TI
                 WHERE TI.NRREGISTRO = PS.NRREGISTRO
                   AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
                   AND PS.NRCGC_CPF = PNRCGC_CPF
                   AND PS.TPPESSOA = PTPPESSOA
                   AND TI.NRREGISTRO_PAI IS NULL
                   AND ROWNUM = 1;
                VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CNPJ';
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VTI_PESSOA := NULL;
              END;
            END IF;
        END;
      END; -- p_define_pessoa_pai
      --=======================--
      -- Busca Cliente no EMS5 --
      ---------------------------
      PROCEDURE P_BUSCA_CLIENTE_EMS IS
      BEGIN
        IF PTPPESSOA = 'F' THEN
          --=====================================--
          -- Verifica se o cliente pessoa fisica --
          -- existe no EMS5                      --
          -----------------------------------------
          BEGIN
            SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
              INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
              FROM CLIENTE CL, PESSOA_FISIC PF, TI_EMPRESA EMP
             WHERE PF.U##COD_ID_FEDER = PNRCGC_CPF
               AND PF.DAT_NASC_PESSOA_FISIC = PDTNASCIMENTO
               AND PF.NUM_PESSOA_FISIC = CL.NUM_PESSOA
               AND CL.COD_EMPRESA = EMP.COD_EMPRESA
               AND EMP.CDEMPRESA =
                   F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                SELECT DISTINCT CL.NOM_ABREV, CL.CDN_CLIENTE
                  INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
                  FROM CLIENTE CL, TI_EMPRESA EMP
                 WHERE CL.NOM_ABREV = VNOM_ABREVIADO
                   AND CL.COD_EMPRESA = EMP.COD_EMPRESA
                   AND EMP.CDEMPRESA =
                       F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VNOM_ABREV_CLIENTE := NULL;
                  VCDN_CLIENTE       := NULL;
              END;
          END;
        ELSE
          --======================================--
          -- Verifica se o cliente pessoa juridica --
          -- existe no EMS5                       --
          ------------------------------------------
          BEGIN
            SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
              INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
              FROM CLIENTE CL, PESSOA_JURID PJ, TI_EMPRESA EMP
             WHERE PJ.U##COD_ID_FEDER = PNRCGC_CPF
               AND PJ.NUM_PESSOA_JURID = CL.NUM_PESSOA
               AND CL.COD_EMPRESA = EMP.COD_EMPRESA
               AND EMP.CDEMPRESA =
                   F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
                  INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
                  FROM CLIENTE CL, TI_EMPRESA EMP
                 WHERE CL.NOM_ABREV = VNOM_ABREVIADO
                   AND CL.COD_EMPRESA = EMP.COD_EMPRESA
                   AND EMP.CDEMPRESA =
                       F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VNOM_ABREV_CLIENTE := NULL;
                  VCDN_CLIENTE       := NULL;
              END;
          END;
        END IF;
      END; -- Busca cliente ems5
      --=======================--
      -- Busca fornecedor no EMS5 --
      ---------------------------
      PROCEDURE P_BUSCA_FORNECEDOR_EMS IS
      BEGIN
        IF PTPPESSOA = 'F' THEN
          --=====================================--
          -- Verifica se o fornecedor pessoa fisica --
          -- existe no EMS5                      --
          -----------------------------------------
          BEGIN
            SELECT DISTINCT FN.NOM_ABREV, FN.CDN_FORNECEDOR
              INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
              FROM FORNECEDOR FN, PESSOA_FISIC PF, TI_EMPRESA EMP
             WHERE PF.U##COD_ID_FEDER = PNRCGC_CPF
               AND PF.DAT_NASC_PESSOA_FISIC = PDTNASCIMENTO
               AND PF.NUM_PESSOA_FISIC = FN.NUM_PESSOA
               AND FN.COD_EMPRESA = EMP.COD_EMPRESA
               AND EMP.CDEMPRESA =
                   F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                SELECT DISTINCT FN.NOM_ABREV, FN.CDN_FORNECEDOR
                  INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
                  FROM FORNECEDOR FN, TI_EMPRESA EMP
                 WHERE FN.NOM_ABREV = VNOM_ABREVIADO
                   AND FN.COD_EMPRESA = EMP.COD_EMPRESA
                   AND EMP.CDEMPRESA =
                       F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
                VNOM_ABREVIADO := CNOM_ABREVIADO;
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VNOM_ABREV_FORNECEDOR := NULL;
                  VCDN_FORNECEDOR       := NULL;
              END;
          END;
        ELSE
          --======================================--
          -- Verifica se o fornecedor pessoa juridica --
          -- existe no EMS5                       --
          ------------------------------------------
          BEGIN
            SELECT FN.NOM_ABREV, FN.CDN_FORNECEDOR
              INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
              FROM FORNECEDOR FN, PESSOA_JURID PJ, TI_EMPRESA EMP
             WHERE PJ.U##COD_ID_FEDER = PNRCGC_CPF
               AND PJ.NUM_PESSOA_JURID = FN.NUM_PESSOA
               AND FN.COD_EMPRESA = EMP.COD_EMPRESA
               AND EMP.CDEMPRESA =
                   F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                SELECT FN.NOM_ABREV, FN.CDN_FORNECEDOR
                  INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
                  FROM FORNECEDOR FN
                 WHERE FN.COD_EMPRESA =
                       F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')
                   AND FN.NOM_ABREV = VNOM_ABREVIADO;
                VNOM_ABREVIADO := CNOM_ABREVIADO;
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VNOM_ABREV_FORNECEDOR := NULL;
                  VCDN_FORNECEDOR       := NULL;
              END;
          END;
        END IF;
      END; -- Busca fornecedor ems5
      --==================--
      -- Define o cliente --
      ----------------------
      PROCEDURE P_DEFINE_CLIENTE IS
      BEGIN
        IF F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
           '%' || PNRCGC_CPF || '%' AND PNRCGC_CPF IS NOT NULL THEN
          --------------------------
          -- Definir a pessoa PAI --
          --------------------------
          P_DEFINE_PESSOA_PAI;
          IF VTI_PESSOA.NRREGISTRO IS NULL THEN
            BEGIN
              SELECT TI.*
                INTO VTI_PESSOA
                FROM TI_PESSOA TI
               WHERE TI.NOABREVIADO_CLIENTE = PNRCGC_CPF
                 AND TI.NRREGISTRO_PAI IS NULL
                 AND ROWNUM = 1;
              VNOM_ABREVIADO := CNOM_ABREVIADO;
              VTI_PESSOA     := NULL;
            EXCEPTION
              --======================================--
              -- Caso o CPF/CPNPJ no existir o nome  --
              -- abreviado ser o CPF/CNPJ            --
              ------------------------------------------
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA     := NULL;
                VNOM_ABREVIADO := PNRCGC_CPF;
            END;
          ELSE
            VNOM_ABREVIADO := PNRCGC_CPF;
  --          VTI_PESSOA     := NULL;
          END IF;
        ELSE
          VNOM_ABREVIADO := CNOM_ABREVIADO;
          VTI_PESSOA     := NULL;
        END IF;
        IF VTI_PESSOA_PAI.NRREGISTRO IS NULL THEN
          ----------------------------
          P_BUSCA_CLIENTE_EMS;
          ----------------------------
          IF VNOM_ABREV_CLIENTE IS NOT NULL THEN
            VNOM_ABREVIADO := VNOM_ABREV_CLIENTE;
          END IF;
          VTI_PESSOA_PAI := NULL;
          BEGIN
            SELECT PS.*
              INTO VTI_PESSOA_PAI
              FROM TI_PESSOA PS
             WHERE PS.NOABREVIADO_CLIENTE = SUBSTR(VNOM_ABREVIADO,0,12)
               AND NOT EXISTS (SELECT 1
                      FROM TI_PESSOA PST
                     WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA_PAI := NULL;
          END;
        ELSIF VTI_PESSOA.NRREGISTRO IS NOT NULL THEN
          SELECT PS.*
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_CLIENTE = SUBSTR(VNOM_ABREVIADO,0,12)
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        END IF;
      END; -- fim p_define_cliente
      --==================--
      -- Define o fornecedor --
      ----------------------
      PROCEDURE P_DEFINE_FORNECEDOR IS
      BEGIN
        IF F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
           '%' || PNRCGC_CPF || '%' AND PNRCGC_CPF IS NOT NULL THEN
          --------------------------
          -- Definir a pessoa PAI --
          --------------------------
          P_DEFINE_PESSOA_PAI;
          IF VTI_PESSOA.NRREGISTRO IS NULL THEN
            BEGIN
              SELECT TI.*
                INTO VTI_PESSOA
                FROM TI_PESSOA TI
               WHERE TI.NOABREVIADO_FORNECEDOR = PNRCGC_CPF
                 AND TI.NRREGISTRO_PAI IS NULL
                 AND ROWNUM = 1;
              VNOM_ABREVIADO := CNOM_ABREVIADO;
              VTI_PESSOA     := NULL;
            EXCEPTION
              --======================================--
              -- Caso o CPF/CPNPJ no existir o nome  --
              -- abreviado ser o CPF/CNPJ            --
              ------------------------------------------
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA     := NULL;
                VNOM_ABREVIADO := PNRCGC_CPF;
            END;
          ELSE
            VNOM_ABREVIADO := PNRCGC_CPF;
            VTI_PESSOA     := NULL;
          END IF;
        ELSE
          VNOM_ABREVIADO := CNOM_ABREVIADO;
          VTI_PESSOA     := NULL;
        END IF;
        IF VTI_PESSOA_PAI.NRREGISTRO IS NULL THEN
          -----------------------
          P_BUSCA_FORNECEDOR_EMS;
          -----------------------
          IF VNOM_ABREV_FORNECEDOR IS NOT NULL THEN
            VNOM_ABREVIADO := VNOM_ABREV_FORNECEDOR;
          END IF;
          VTI_PESSOA_PAI := NULL;
          BEGIN
            SELECT PS.*
              INTO VTI_PESSOA_PAI
              FROM TI_PESSOA PS
             WHERE PS.NOABREVIADO_FORNECEDOR = VNOM_ABREVIADO
               AND NOT EXISTS (SELECT 1
                      FROM TI_PESSOA PST
                     WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA_PAI := NULL;
          END;
        ELSIF VTI_PESSOA.NRREGISTRO IS NOT NULL THEN
          SELECT PS.*
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_FORNECEDOR = VNOM_ABREVIADO
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        END IF;
      END; -- fim p_define_fornecedor
      --inicia aqui
    BEGIN
      VTI_PESSOA     := NULL;
      VTI_PESSOA_PAI := NULL;
      SELECT COUNT(*)
        INTO VCOUNT
        FROM TI_PESSOA P
       WHERE P.NRREGISTRO = PNRREGISTRO;
      IF VCOUNT = 0 THEN
        IF PAODEFINEPESSOA = 'S' THEN
          IF NOT F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
              '%' || PNRCGC_CPF || '%' THEN
            VNOABREVIADO_CLIENTE    := CNOM_ABREVIADO;
            VNOABREVIADO_FORNECEDOR := CNOM_ABREVIADO;
            VCDN_FORNECEDOR         := NULL;
            VCDN_CLIENTE            := NULL;
          ELSE
            IF PTPORIGEM = 'CLIENTE' THEN
              ---------------------------
              P_DEFINE_CLIENTE;
              ---------------------------
              --========================--
              -- Se for uma pessoa nova --
              ----------------------------
              IF VTI_PESSOA.NRREGISTRO IS NULL THEN
                ----------------------------
                -- Nome abreviado cliente --
                ----------------------------
                IF VCDN_CLIENTE IS NOT NULL THEN
                  VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                  VNOABREVIADO_CLIENTE   := VNOM_ABREV_CLIENTE;
                ELSE
                  VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                  VNOABREVIADO_CLIENTE   := VNOM_ABREVIADO;
                END IF;
                ------------------------------
                -- Verifica se  fornecedor --
                ------------------------------
                P_BUSCA_FORNECEDOR_EMS;
                -------------------------------
                -- Nome abreviado fornecedor --
                -------------------------------
                IF VCDN_FORNECEDOR IS NOT NULL THEN
                  VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                  VNOABREVIADO_FORNECEDOR   := VNOM_ABREV_FORNECEDOR;
                ELSE
                  VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                  VNOABREVIADO_FORNECEDOR   := VNOM_ABREVIADO;
                END IF;
              END IF;
            ELSE
              -------------------------------
              P_DEFINE_FORNECEDOR;
              -------------------------------
              --========================--
              -- Se for uma pessoa nova --
              ----------------------------
              IF VTI_PESSOA.NRREGISTRO IS NULL THEN
                -------------------------------
                -- Nome abreviado fornecedor --
                -------------------------------
                IF VCDN_FORNECEDOR IS NOT NULL THEN
                  VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                  VNOABREVIADO_FORNECEDOR   := VNOM_ABREV_FORNECEDOR;
                ELSE
                  VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                  VNOABREVIADO_FORNECEDOR   := VNOM_ABREVIADO;
                END IF;
                ------------------------------
                -- verifica se  cliente --
                ------------------------------
                P_BUSCA_CLIENTE_EMS;
                ----------------------------
                -- nome abreviado cliente --
                ----------------------------
                IF VCDN_CLIENTE IS NOT NULL THEN
                  VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                  VNOABREVIADO_CLIENTE   := VNOM_ABREV_CLIENTE;
                ELSE
                  VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                  VNOABREVIADO_CLIENTE   := VNOM_ABREVIADO;
                END IF;
              END IF;
            END IF;
          END IF;
        ELSE
          BEGIN
            SELECT *
              INTO VTI_PESSOA_PAI
              FROM TI_PESSOA PS
             WHERE PS.NOABREVIADO_CLIENTE = PNOABREVIADO_CLIENTE
               AND NOT EXISTS (SELECT 1
                      FROM TI_PESSOA PST
                     WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
               AND ROWNUM = 1;
          EXCEPTION
            WHEN OTHERS THEN
              BEGIN
                SELECT *
                  INTO VTI_PESSOA_PAI
                  FROM TI_PESSOA PS
                 WHERE PS.NOABREVIADO_FORNECEDOR = PNOABREVIADO_FORNECEDOR
                   AND NOT EXISTS
                 (SELECT 1
                          FROM TI_PESSOA PST
                         WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
                   AND ROWNUM = 1;
              EXCEPTION
                WHEN OTHERS THEN
                  VTI_PESSOA_PAI := NULL;
              END;
          END;
        END IF;
        IF VTI_PESSOA.NRREGISTRO IS NULL THEN
          VTI_PESSOA.NRREGISTRO             := PNRREGISTRO;
          VTI_PESSOA.NOABREVIADO_CLIENTE    := VNOABREVIADO_CLIENTE;
          VTI_PESSOA.NOABREVIADO_FORNECEDOR := VNOABREVIADO_FORNECEDOR;
          VTI_PESSOA.CDN_FORNECEDOR         := VCDN_FORNECEDOR;
          VTI_PESSOA.CDN_CLIENTE            := VCDN_CLIENTE;
          VTI_PESSOA.NRREGISTRO_PAI         := NULL;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO    := NULL;
          VTI_PESSOA.NOPESSOA               := PNOPESSOA;
          VTI_PESSOA.DTNASCIMENTO           := PDTNASCIMENTO;
          VTI_PESSOA.NRCGC_CPF              := PNRCGC_CPF;
          VTI_PESSOA.NRREGISTRO_PAI         := VTI_PESSOA_PAI.NRREGISTRO;
        ELSE
          VTI_PESSOA.NRREGISTRO_PAI := VTI_PESSOA_PAI.NRREGISTRO;
          VTI_PESSOA.NRREGISTRO     := PNRREGISTRO;
          VTI_PESSOA.NOPESSOA       := PNOPESSOA;
          VTI_PESSOA.DTNASCIMENTO   := PDTNASCIMENTO;
          VTI_PESSOA.NRCGC_CPF      := PNRCGC_CPF;
        END IF;

        IF F_TI_PARAMETRO_INTEGRACAO('INTR_EMS2') = 'S' THEN
          VTI_PESSOA.NOABREVIADO_CLIENTE    := SUBSTR(VTI_PESSOA.NOABREVIADO_CLIENTE,
                                                      0,
                                                      12);
          VTI_PESSOA.NOABREVIADO_FORNECEDOR := SUBSTR(VTI_PESSOA.NOABREVIADO_FORNECEDOR,
                                                      0,
                                                      12);
        END IF;

  BEGIN

        BEGIN
          SELECT NRREGISTRO INTO VTI_PESSOA.NRREGISTRO_PAI  FROM TI_PESSOA TP WHERE
          TP.NOABREVIADO_CLIENTE = VTI_PESSOA.NOABREVIADO_CLIENTE
          AND TP.NOABREVIADO_FORNECEDOR    = VTI_PESSOA.NOABREVIADO_FORNECEDOR
          AND ROWNUM =1;

          EXCEPTION WHEN NO_DATA_FOUND THEN
          VTI_PESSOA.NRREGISTRO_PAI:= NULL;
  END;
        INSERT INTO TI_PESSOA
          (NRREGISTRO,
           NOABREVIADO_CLIENTE,
           NOABREVIADO_FORNECEDOR,
           CDN_FORNECEDOR,
           CDN_CLIENTE,
           NRREGISTRO_PAI,
           TXREGRA_AGRUPAMENTO,
           NOPESSOA,
           DTNASCIMENTO,
           NRCGC_CPF,
           DTGERACAO,
           DTULTIMA_ATUALIZACAO)
        VALUES
          (VTI_PESSOA.NRREGISTRO,
           VTI_PESSOA.NOABREVIADO_CLIENTE,
           VTI_PESSOA.NOABREVIADO_FORNECEDOR,
           VTI_PESSOA.CDN_FORNECEDOR,
           VTI_PESSOA.CDN_CLIENTE,
           VTI_PESSOA.NRREGISTRO_PAI,
           VTI_PESSOA.TXREGRA_AGRUPAMENTO,
           VTI_PESSOA.NOPESSOA,
           VTI_PESSOA.DTNASCIMENTO,
           VTI_PESSOA.NRCGC_CPF,
           SYSDATE,
           SYSDATE);


        PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
        PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
        PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
        PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;

  EXCEPTION WHEN DUP_VAL_ON_INDEX THEN
    INSERT INTO TI_PESSOA
          (NRREGISTRO,
           NOABREVIADO_CLIENTE,
           NOABREVIADO_FORNECEDOR,
           CDN_FORNECEDOR,
           CDN_CLIENTE,
           NRREGISTRO_PAI,
           TXREGRA_AGRUPAMENTO,
           NOPESSOA,
           DTNASCIMENTO,
           NRCGC_CPF,
           DTGERACAO,
           DTULTIMA_ATUALIZACAO)
        VALUES
          (VTI_PESSOA.NRREGISTRO,
           'p'||VTI_PESSOA.NRREGISTRO,
           'p'||VTI_PESSOA.NRREGISTRO,
           VTI_PESSOA.CDN_FORNECEDOR,
           VTI_PESSOA.CDN_CLIENTE,
           VTI_PESSOA.NRREGISTRO_PAI,
           VTI_PESSOA.TXREGRA_AGRUPAMENTO,
           VTI_PESSOA.NOPESSOA,
           VTI_PESSOA.DTNASCIMENTO,
           VTI_PESSOA.NRCGC_CPF,
           SYSDATE,
           SYSDATE);

    END;



      ELSE
        SELECT *
          INTO VTI_PESSOA
          FROM TI_PESSOA
         WHERE NRREGISTRO = PNRREGISTRO;
        PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
        PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
        PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
        PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;
      END IF;
    END;*/

  PROCEDURE P_DEFINE_TI_PESSOA(PNRCGC_CPF              VARCHAR2,
                               PNOPESSOA               VARCHAR2,
                               PDTNASCIMENTO           DATE,
                               PTPPESSOA               VARCHAR2,
                               PNRREGISTRO             NUMBER,
                               PTPORIGEM               VARCHAR2,
                               PNOABREVIADO_FORNECEDOR IN OUT VARCHAR2,
                               PCDN_FORNECEDOR         IN OUT VARCHAR2,
                               PNOABREVIADO_CLIENTE    IN OUT VARCHAR2,
                               PCDN_CLIENTE            IN OUT VARCHAR2,
                               PAODEFINEPESSOA         VARCHAR2 -- < S/N>
                               ) IS
    VTI_PESSOA       TI_PESSOA%ROWTYPE;
    VTI_PESSOA_PAI   TI_PESSOA%ROWTYPE;
    VCOUNT           NUMBER;
    VEXISTE_PESSOA   CHAR;
    VEXISTE_REGISTRO CHAR;
    CNOM_ABREVIADO   TI_PESSOA.NOABREVIADO_CLIENTE%TYPE := 'p' ||
                                                           PNRREGISTRO;
    VCOD_EMS         NUMBER := 1000;
    VCOD_EMS_AUX     NUMBER := 0;
    VEXISTE_COD      CHAR;
    vaoexiste_nome   char;
    vnom_abrev       varchar2(12);
    qttamanho        number;
    vnum_aux         number := 0;
    vcount           number;

    FUNCTION F_TESTA_NOME(PNOME_ABREV TI_PESSOA.NOABREVIADO_CLIENTE%TYPE)
      RETURN CHAR IS

      VEXISTE_NOME CHAR;

    BEGIN
      BEGIN
        SELECT 'S'
          INTO VEXISTE_NOME
          FROM TI_PESSOA P
         WHERE P.NOABREVIADO_CLIENTE = PNOME_ABREV
           AND ROWNUM = 1;
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          VEXISTE_NOME := 'N';
      END;

      RETURN VEXISTE_NOME;

    END;
    --======================--
    -- Definir a Pessoa Pai --
    --------------------------
    PROCEDURE P_DEFINE_PESSOA_PAI IS
    BEGIN
      IF PTPPESSOA = 'F' THEN
        BEGIN
          --============--
          -- CPF / NOME --
          ----------------
          SELECT TI.*
            INTO VTI_PESSOA_PAI
            FROM PESSOA PS, TI_PESSOA TI
           WHERE TI.NRREGISTRO = PS.NRREGISTRO
             AND PS.NRCGC_CPF = PNRCGC_CPF
             AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
             AND PS.TPPESSOA = PTPPESSOA
             AND TI.NRREGISTRO_PAI IS NULL
             AND ROWNUM = 1
           ORDER BY TI.NRREGISTRO DESC;
          VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO := 'CPF_PESSOA';
        EXCEPTION
          WHEN NO_DATA_FOUND THEN

            IF PCPF_DTNASCIMENTO = 'S' THEN
              BEGIN
                --==========================--
                -- CPF / DATA DE NASCIMENTO --
                ------------------------------
                SELECT TI.*
                  INTO VTI_PESSOA_PAI
                  FROM PESSOA PS, TI_PESSOA TI
                 WHERE TI.NRREGISTRO = PS.NRREGISTRO
                   AND PS.NRCGC_CPF = PNRCGC_CPF
                   AND PS.DTNASCIMENTO = PDTNASCIMENTO
                   AND PS.TPPESSOA = PTPPESSOA
                   AND PS.DTNASCIMENTO IS NOT NULL
                   AND ROWNUM = 1
                 ORDER BY TI.NRREGISTRO DESC;
                VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO := 'CPF_DTNASCIMENTO';
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VTI_PESSOA_PAI := NULL;
              END;
            ELSE
              VTI_PESSOA_PAI := NULL;
            END IF;
        END;
      ELSE
        BEGIN
          --======--
          -- CNPJ --
          ----------
          SELECT TI.*
            INTO VTI_PESSOA_PAI
            FROM PESSOA PS, TI_PESSOA TI
           WHERE TI.NRREGISTRO = PS.NRREGISTRO
             AND PS.NRCGC_CPF = PNRCGC_CPF
             AND PS.TPPESSOA = PTPPESSOA
             AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
             AND TI.NRREGISTRO_PAI IS NULL
             AND ROWNUM = 1
           ORDER BY TI.NRREGISTRO DESC;
          VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO := 'CNPJ';
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            VTI_PESSOA_PAI := NULL;
        END;
      END IF;
    END P_DEFINE_PESSOA_PAI; -- p_define_pessoa_pai

  BEGIN

    VTI_PESSOA_PAI := NULL;
    VEXISTE_COD    := 'N';

    BEGIN
      SELECT 'S'
        INTO VEXISTE_REGISTRO
        FROM TI_PESSOA T
       WHERE T.NRREGISTRO = PNRREGISTRO;
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        VEXISTE_REGISTRO := 'N';
    END;

    IF VEXISTE_REGISTRO = 'N' THEN

      BEGIN
        SELECT 'S'
          INTO VEXISTE_PESSOA
          FROM TI_PESSOA TP
         WHERE TP.NRCGC_CPF = PNRCGC_CPF
           AND ROWNUM = 1
           and f_ti_parametro_integracao('UNIFICA_PESSOA') = 'S';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          VEXISTE_PESSOA := 'N';
      END;

      --SE NAO EXISTE NINGUEM COM ESTE CPF/CNPJ INSERE NA TABELA TI_PESSOA
      IF VEXISTE_PESSOA = 'N' THEN

        VTI_PESSOA.NRREGISTRO          := PNRREGISTRO;
        VTI_PESSOA.NRREGISTRO_PAI      := NULL;
        VTI_PESSOA.TXREGRA_AGRUPAMENTO := NULL;
        VTI_PESSOA.NOPESSOA            := PNOPESSOA;
        VTI_PESSOA.DTNASCIMENTO        := PDTNASCIMENTO;
        VTI_PESSOA.NRCGC_CPF           := PNRCGC_CPF;

        --VINICIUS 30/08 NOVA DEFINICAO PARA NOME ABREVIADO NO EMS5
        vnom_abrev := trim(F_ABREVIA_NOME(VTI_PESSOA.NOPESSOA, 12, 'PEA'));

        vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

        WHILE vaoexiste_nome = 'S' LOOP

          vnum_aux := vnum_aux + 1;

          qttamanho := length(vnum_aux);

          vnom_abrev := substr(vnom_abrev, 0, (12 - qttamanho)) || vnum_aux;

          vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

        END LOOP;

        VTI_PESSOA.NOABREVIADO_CLIENTE := vnom_abrev;

        VTI_PESSOA.NOABREVIADO_FORNECEDOR := vnom_abrev;

        /* VTI_PESSOA.NOABREVIADO_CLIENTE := CASE
                                              WHEN f_ti_parametro_integracao('INTR_EMS2') = 'S' THEN
                                               SUBSTR(PNRCGC_CPF, 0, 12)
                                              ELSE
                                               PNRCGC_CPF
                                            END;

          VTI_PESSOA.NOABREVIADO_FORNECEDOR := CASE
                                                 WHEN f_ti_parametro_integracao('INTR_EMS2') = 'S' THEN
                                                  SUBSTR(PNRCGC_CPF, 0, 12)
                                                 ELSE
                                                  PNRCGC_CPF
                                               END;
        */

        --SE A ORIGEM FOR "UNIMED" NAO PREENCHE O CODIGO CLIENTE / FORNECEDOR
        IF PTPORIGEM = 'UNIMED' THEN
          VTI_PESSOA.CDN_FORNECEDOR := NULL;
          VTI_PESSOA.CDN_CLIENTE    := NULL;
        ELSE

          --SE A ORIGEM FOR FOR "UNIMED" PREENCHE O CODIGO CLIENTE / FORNECEDOR
          BEGIN
            SELECT 'S'
              INTO VEXISTE_COD
              FROM TI_PESSOA TP
             WHERE NVL(TP.CDN_CLIENTE, 0) >= VCOD_EMS
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS;
              VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS;
          END;

          IF VEXISTE_COD = 'S' THEN
            BEGIN
              SELECT MAX(CDN_CLIENTE) + 1 INTO VCOD_EMS_AUX FROM TI_PESSOA;
            END;
            VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS_AUX;
            VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS_AUX;

          END IF;

        END IF;

        INSERT INTO TI_PESSOA
          (NRREGISTRO,
           NOABREVIADO_CLIENTE,
           NOABREVIADO_FORNECEDOR,
           CDN_FORNECEDOR,
           CDN_CLIENTE,
           NRREGISTRO_PAI,
           TXREGRA_AGRUPAMENTO,
           NOPESSOA,
           DTNASCIMENTO,
           NRCGC_CPF,
           DTGERACAO,
           DTULTIMA_ATUALIZACAO)
        VALUES
          (VTI_PESSOA.NRREGISTRO,
           VTI_PESSOA.NOABREVIADO_CLIENTE,
           VTI_PESSOA.NOABREVIADO_FORNECEDOR,
           VTI_PESSOA.CDN_FORNECEDOR,
           VTI_PESSOA.CDN_CLIENTE,
           VTI_PESSOA.NRREGISTRO_PAI,
           VTI_PESSOA.TXREGRA_AGRUPAMENTO,
           VTI_PESSOA.NOPESSOA,
           VTI_PESSOA.DTNASCIMENTO,
           VTI_PESSOA.NRCGC_CPF,
           SYSDATE,
           SYSDATE);
        PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
        PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
        PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
        PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;

      ELSE

        --SE ACHOU UM CPF/CPNJ PROCURA O REGISTRO PAI
        P_DEFINE_PESSOA_PAI;

        --SE ENCONTROU FAZ OS VINCULOS
        IF VTI_PESSOA_PAI.NRREGISTRO IS NOT NULL THEN

          VTI_PESSOA.NRREGISTRO             := PNRREGISTRO;
          VTI_PESSOA.NOABREVIADO_CLIENTE    := VTI_PESSOA_PAI.NOABREVIADO_CLIENTE;
          VTI_PESSOA.NOABREVIADO_FORNECEDOR := VTI_PESSOA_PAI.NOABREVIADO_FORNECEDOR;
          VTI_PESSOA.CDN_FORNECEDOR         := VTI_PESSOA_PAI.CDN_FORNECEDOR;
          VTI_PESSOA.CDN_CLIENTE            := VTI_PESSOA_PAI.CDN_CLIENTE;
          VTI_PESSOA.NRREGISTRO_PAI         := VTI_PESSOA_PAI.NRREGISTRO;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO    := VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO;
          VTI_PESSOA.NOPESSOA               := PNOPESSOA;
          VTI_PESSOA.DTNASCIMENTO           := PDTNASCIMENTO;
          VTI_PESSOA.NRCGC_CPF              := PNRCGC_CPF;

          INSERT INTO TI_PESSOA
            (NRREGISTRO,
             NOABREVIADO_CLIENTE,
             NOABREVIADO_FORNECEDOR,
             CDN_FORNECEDOR,
             CDN_CLIENTE,
             NRREGISTRO_PAI,
             TXREGRA_AGRUPAMENTO,
             NOPESSOA,
             DTNASCIMENTO,
             NRCGC_CPF,
             DTGERACAO,
             DTULTIMA_ATUALIZACAO)
          VALUES
            (VTI_PESSOA.NRREGISTRO,
             VTI_PESSOA.NOABREVIADO_CLIENTE,
             VTI_PESSOA.NOABREVIADO_FORNECEDOR,
             VTI_PESSOA.CDN_FORNECEDOR,
             VTI_PESSOA.CDN_CLIENTE,
             VTI_PESSOA.NRREGISTRO_PAI,
             VTI_PESSOA.TXREGRA_AGRUPAMENTO,
             VTI_PESSOA.NOPESSOA,
             VTI_PESSOA.DTNASCIMENTO,
             VTI_PESSOA.NRCGC_CPF,
             SYSDATE,
             SYSDATE);
          PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
          PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
          PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
          PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;

          --SE NAO ENCONTROU INSERE PESSOA COM CPF/CNPJ REPETIDO, MAS ALTERANDO O NOME ABREVIADO
        ELSE

          VTI_PESSOA.NRREGISTRO          := PNRREGISTRO;
          VTI_PESSOA.NRREGISTRO_PAI      := NULL;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO := NULL;
          VTI_PESSOA.NOPESSOA            := PNOPESSOA;
          VTI_PESSOA.DTNASCIMENTO        := PDTNASCIMENTO;
          VTI_PESSOA.NRCGC_CPF           := PNRCGC_CPF;

          --VINICIUS 30/08 NOVA DEFINICAO PARA NOME ABREVIADO NO EMS5
          vnom_abrev := trim(F_ABREVIA_NOME(VTI_PESSOA.NOPESSOA, 12, 'PEA'));

          vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

          WHILE vaoexiste_nome = 'S' LOOP

            vnum_aux := vnum_aux + 1;

            qttamanho := length(vnum_aux);

            vnom_abrev := substr(vnom_abrev, 0, (12 - qttamanho)) ||
                          vnum_aux;

            vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

          END LOOP;

          VTI_PESSOA.NOABREVIADO_CLIENTE := vnom_abrev;

          VTI_PESSOA.NOABREVIADO_FORNECEDOR := vnom_abrev;

          IF PTPORIGEM = 'UNIMED' THEN
            VTI_PESSOA.CDN_FORNECEDOR := NULL;
            VTI_PESSOA.CDN_CLIENTE    := NULL;
          ELSE

            BEGIN
              SELECT 'S'
                INTO VEXISTE_COD
                FROM TI_PESSOA TP
               WHERE NVL(TP.CDN_CLIENTE, 0) >= VCOD_EMS
                 AND ROWNUM = 1;
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS;
                VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS;
            END;

            IF VEXISTE_COD = 'S' THEN
              BEGIN
                SELECT MAX(CDN_CLIENTE) + 1
                  INTO VCOD_EMS_AUX
                  FROM TI_PESSOA;
              END;
              VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS_AUX;
              VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS_AUX;

            END IF;

          END IF;

          INSERT INTO TI_PESSOA
            (NRREGISTRO,
             NOABREVIADO_CLIENTE,
             NOABREVIADO_FORNECEDOR,
             CDN_FORNECEDOR,
             CDN_CLIENTE,
             NRREGISTRO_PAI,
             TXREGRA_AGRUPAMENTO,
             NOPESSOA,
             DTNASCIMENTO,
             NRCGC_CPF,
             DTGERACAO,
             DTULTIMA_ATUALIZACAO)
          VALUES
            (VTI_PESSOA.NRREGISTRO,
             VTI_PESSOA.NOABREVIADO_CLIENTE,
             VTI_PESSOA.NOABREVIADO_FORNECEDOR,
             VTI_PESSOA.CDN_FORNECEDOR,
             VTI_PESSOA.CDN_CLIENTE,
             VTI_PESSOA.NRREGISTRO_PAI,
             VTI_PESSOA.TXREGRA_AGRUPAMENTO,
             VTI_PESSOA.NOPESSOA,
             VTI_PESSOA.DTNASCIMENTO,
             VTI_PESSOA.NRCGC_CPF,
             SYSDATE,
             SYSDATE);
          PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
          PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
          PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
          PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;

        END IF;

      END IF;
    ELSE
      --NAO FAZ NADA

      NULL;

    END IF;

  END P_DEFINE_TI_PESSOA;

  PROCEDURE P_DEFINE_TI_PESSOA_OLD(PNRCGC_CPF              VARCHAR2,
                                   PNOPESSOA               VARCHAR2,
                                   PDTNASCIMENTO           DATE,
                                   PTPPESSOA               VARCHAR2,
                                   PNRREGISTRO             NUMBER,
                                   PTPORIGEM               VARCHAR2,
                                   PNOABREVIADO_FORNECEDOR IN OUT VARCHAR2,
                                   PCDN_FORNECEDOR         IN OUT VARCHAR2,
                                   PNOABREVIADO_CLIENTE    IN OUT VARCHAR2,
                                   PCDN_CLIENTE            IN OUT VARCHAR2,
                                   PAODEFINEPESSOA         VARCHAR2 -- < S/N>
                                   ) IS
    VNOM_ABREV_CLIENTE      TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
    VNOM_ABREV_FORNECEDOR   TI_PESSOA.NOABREVIADO_FORNECEDOR%TYPE;
    VNOABREVIADO_CLIENTE    TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
    VNOABREVIADO_FORNECEDOR TI_PESSOA.NOABREVIADO_FORNECEDOR%TYPE;
    VCDN_CLIENTE            TI_PESSOA.CDN_CLIENTE%TYPE;
    VCDN_FORNECEDOR         TI_PESSOA.CDN_FORNECEDOR%TYPE;
    VTI_PESSOA              TI_PESSOA%ROWTYPE;
    VTI_PESSOA_PAI          TI_PESSOA%ROWTYPE;
    VNOM_ABREVIADO          TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
    VCOUNT                  NUMBER;
    CNOM_ABREVIADO          TI_PESSOA.NOABREVIADO_CLIENTE%TYPE := 'p' ||
                                                                  PNRREGISTRO;
    --======================--
    -- Definir a Pessoa Pai --
    --------------------------
    PROCEDURE P_DEFINE_PESSOA_PAI IS
    BEGIN
      IF PTPPESSOA = 'F' THEN
        BEGIN
          --============--
          -- CPF / NOME --
          ----------------
          SELECT TI.*
            INTO VTI_PESSOA
            FROM PESSOA PS, TI_PESSOA TI
           WHERE TI.NRREGISTRO = PS.NRREGISTRO
             AND PS.NRCGC_CPF = PNRCGC_CPF
             AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
             AND PS.TPPESSOA = PTPPESSOA
             AND TI.NRREGISTRO_PAI IS NULL
             AND ROWNUM = 1
           ORDER BY TI.ROWID DESC;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CPF_PESSOA';
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              --==========================--
              -- CPF / DATA DE NASCIMENTO --
              ------------------------------
              SELECT TI.*
                INTO VTI_PESSOA
                FROM PESSOA PS, TI_PESSOA TI
               WHERE TI.NRREGISTRO = PS.NRREGISTRO
                 AND PS.NRCGC_CPF = PNRCGC_CPF
                 AND PS.DTNASCIMENTO = PDTNASCIMENTO
                 AND PS.TPPESSOA = PTPPESSOA
                 AND PS.DTNASCIMENTO IS NOT NULL
                 AND ROWNUM = 1
               ORDER BY TI.ROWID DESC;
              VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CPF_DTNASCIMENTO';
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA := NULL;
            END;
        END;
      ELSE
        BEGIN
          --======--
          -- CNPJ --
          ----------
          SELECT TI.*
            INTO VTI_PESSOA
            FROM PESSOA PS, TI_PESSOA TI
           WHERE TI.NRREGISTRO = PS.NRREGISTRO
             AND PS.NRCGC_CPF = PNRCGC_CPF
             AND PS.TPPESSOA = PTPPESSOA
             AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
             AND TI.NRREGISTRO_PAI IS NULL
             AND ROWNUM = 1
           ORDER BY TI.ROWID DESC;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CNPJ';
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            VTI_PESSOA := NULL;
        END;
      END IF;
    END; -- p_define_pessoa_pai
    --=======================--
    -- Busca Cliente no EMS5 --
    ---------------------------
    PROCEDURE P_BUSCA_CLIENTE_EMS IS
    BEGIN
      IF PTPPESSOA = 'F' THEN
        --=====================================--
        -- Verifica se o cliente pessoa fisica --
        -- existe no EMS5                      --
        -----------------------------------------
        BEGIN
          SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
            INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
            FROM CLIENTE CL, PESSOA_FISIC PF, TI_EMPRESA EMP
           WHERE PF.U##COD_ID_FEDER = PNRCGC_CPF
             AND PF.DAT_NASC_PESSOA_FISIC = PDTNASCIMENTO
             AND PF.NUM_PESSOA_FISIC = CL.NUM_PESSOA
             AND CL.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              SELECT DISTINCT CL.NOM_ABREV, CL.CDN_CLIENTE
                INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
                FROM CLIENTE CL, TI_EMPRESA EMP
               WHERE CL.NOM_ABREV = VNOM_ABREVIADO
                 AND CL.COD_EMPRESA = EMP.COD_EMPRESA
                 AND EMP.CDEMPRESA =
                     F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VNOM_ABREV_CLIENTE := NULL;
                VCDN_CLIENTE       := NULL;
            END;
        END;
      ELSE
        --======================================--
        -- Verifica se o cliente pessoa juridica --
        -- existe no EMS5                       --
        ------------------------------------------
        BEGIN
          SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
            INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
            FROM CLIENTE CL, PESSOA_JURID PJ, TI_EMPRESA EMP
           WHERE PJ.U##COD_ID_FEDER = PNRCGC_CPF
             AND PJ.NUM_PESSOA_JURID = CL.NUM_PESSOA
             AND CL.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
                INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
                FROM CLIENTE CL, TI_EMPRESA EMP
               WHERE CL.NOM_ABREV = VNOM_ABREVIADO
                 AND CL.COD_EMPRESA = EMP.COD_EMPRESA
                 AND EMP.CDEMPRESA =
                     F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VNOM_ABREV_CLIENTE := NULL;
                VCDN_CLIENTE       := NULL;
            END;
        END;
      END IF;
    END; -- Busca cliente ems5
    --=======================--
    -- Busca fornecedor no EMS5 --
    ---------------------------
    PROCEDURE P_BUSCA_FORNECEDOR_EMS IS
    BEGIN
      IF PTPPESSOA = 'F' THEN
        --=====================================--
        -- Verifica se o fornecedor pessoa fisica --
        -- existe no EMS5                      --
        -----------------------------------------
        BEGIN
          SELECT DISTINCT FN.NOM_ABREV, FN.CDN_FORNECEDOR
            INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
            FROM FORNECEDOR FN, PESSOA_FISIC PF, TI_EMPRESA EMP
           WHERE PF.U##COD_ID_FEDER = PNRCGC_CPF
             AND PF.DAT_NASC_PESSOA_FISIC = PDTNASCIMENTO
             AND PF.NUM_PESSOA_FISIC = FN.NUM_PESSOA
             AND FN.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              SELECT DISTINCT FN.NOM_ABREV, FN.CDN_FORNECEDOR
                INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
                FROM FORNECEDOR FN, TI_EMPRESA EMP
               WHERE FN.NOM_ABREV = VNOM_ABREVIADO
                 AND FN.COD_EMPRESA = EMP.COD_EMPRESA
                 AND EMP.CDEMPRESA =
                     F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
              VNOM_ABREVIADO := CNOM_ABREVIADO;
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VNOM_ABREV_FORNECEDOR := NULL;
                VCDN_FORNECEDOR       := NULL;
            END;
        END;
      ELSE
        --======================================--
        -- Verifica se o fornecedor pessoa juridica --
        -- existe no EMS5                       --
        ------------------------------------------
        BEGIN
          SELECT FN.NOM_ABREV, FN.CDN_FORNECEDOR
            INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
            FROM FORNECEDOR FN, PESSOA_JURID PJ, TI_EMPRESA EMP
           WHERE PJ.U##COD_ID_FEDER = PNRCGC_CPF
             AND PJ.NUM_PESSOA_JURID = FN.NUM_PESSOA
             AND FN.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              SELECT FN.NOM_ABREV, FN.CDN_FORNECEDOR
                INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
                FROM FORNECEDOR FN
               WHERE FN.COD_EMPRESA =
                     F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')
                 AND FN.NOM_ABREV = VNOM_ABREVIADO;
              VNOM_ABREVIADO := CNOM_ABREVIADO;
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VNOM_ABREV_FORNECEDOR := NULL;
                VCDN_FORNECEDOR       := NULL;
            END;
        END;
      END IF;
    END; -- Busca fornecedor ems5
    --==================--
    -- Define o cliente --
    ----------------------
    PROCEDURE P_DEFINE_CLIENTE IS
    BEGIN
      IF F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
         '%' || PNRCGC_CPF || '%' AND PNRCGC_CPF IS NOT NULL THEN
        --------------------------
        -- Definir a pessoa PAI --
        --------------------------
        P_DEFINE_PESSOA_PAI;

        IF VTI_PESSOA.NRREGISTRO IS NULL THEN
          BEGIN
            SELECT TI.*
              INTO VTI_PESSOA
              FROM TI_PESSOA TI
             WHERE TI.NOABREVIADO_CLIENTE = PNRCGC_CPF
               AND TI.NRREGISTRO_PAI IS NULL
               AND ROWNUM = 1;
            VNOM_ABREVIADO := CNOM_ABREVIADO;
            VTI_PESSOA     := NULL;
          EXCEPTION
            --======================================--
            -- Caso o CPF/CPNPJ no existir o nome  --
            -- abreviado ser o CPF/CNPJ            --
            ------------------------------------------
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA     := NULL;
              VNOM_ABREVIADO := PNRCGC_CPF;
          END;
        ELSE
          VNOM_ABREVIADO := PNRCGC_CPF;
          VTI_PESSOA     := NULL;
        END IF;
      ELSE
        VNOM_ABREVIADO := CNOM_ABREVIADO;
        VTI_PESSOA     := NULL;
      END IF;
      IF VTI_PESSOA_PAI.NRREGISTRO IS NULL THEN
        ----------------------------
        P_BUSCA_CLIENTE_EMS;
        ----------------------------
        IF VNOM_ABREV_CLIENTE IS NOT NULL THEN
          VNOM_ABREVIADO := VNOM_ABREV_CLIENTE;
        END IF;
        VTI_PESSOA_PAI := NULL;
        BEGIN
          SELECT PS.*
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_CLIENTE = VNOM_ABREVIADO
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            VTI_PESSOA_PAI := NULL;
        END;
      ELSIF VTI_PESSOA.NRREGISTRO IS NOT NULL THEN
        SELECT PS.*
          INTO VTI_PESSOA_PAI
          FROM TI_PESSOA PS
         WHERE PS.NOABREVIADO_CLIENTE = VNOM_ABREVIADO
           AND NOT EXISTS (SELECT 1
                  FROM TI_PESSOA PST
                 WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
           AND ROWNUM = 1;
      END IF;
    END; -- fim p_define_cliente
    --==================--
    -- Define o fornecedor --
    ----------------------
    PROCEDURE P_DEFINE_FORNECEDOR IS
    BEGIN
      IF F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
         '%' || PNRCGC_CPF || '%' AND PNRCGC_CPF IS NOT NULL THEN
        --------------------------
        -- Definir a pessoa PAI --
        --------------------------
        P_DEFINE_PESSOA_PAI;
        IF VTI_PESSOA.NRREGISTRO IS NULL THEN
          BEGIN
            SELECT TI.*
              INTO VTI_PESSOA
              FROM TI_PESSOA TI
             WHERE TI.NOABREVIADO_FORNECEDOR = PNRCGC_CPF
               AND TI.NRREGISTRO_PAI IS NULL
               AND ROWNUM = 1;
            VNOM_ABREVIADO := CNOM_ABREVIADO;
            VTI_PESSOA     := NULL;
          EXCEPTION
            --======================================--
            -- Caso o CPF/CPNPJ no existir o nome  --
            -- abreviado ser o CPF/CNPJ            --
            ------------------------------------------
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA     := NULL;
              VNOM_ABREVIADO := PNRCGC_CPF;
          END;
        ELSE
          VNOM_ABREVIADO := PNRCGC_CPF;
          VTI_PESSOA     := NULL;
        END IF;
      ELSE
        VNOM_ABREVIADO := CNOM_ABREVIADO;
        VTI_PESSOA     := NULL;
      END IF;
      IF VTI_PESSOA_PAI.NRREGISTRO IS NULL THEN
        -----------------------
        P_BUSCA_FORNECEDOR_EMS;
        -----------------------
        IF VNOM_ABREV_FORNECEDOR IS NOT NULL THEN
          VNOM_ABREVIADO := VNOM_ABREV_FORNECEDOR;
        END IF;
        VTI_PESSOA_PAI := NULL;
        BEGIN
          SELECT PS.*
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_FORNECEDOR = VNOM_ABREVIADO
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            VTI_PESSOA_PAI := NULL;
        END;
      ELSIF VTI_PESSOA.NRREGISTRO IS NOT NULL THEN
        SELECT PS.*
          INTO VTI_PESSOA_PAI
          FROM TI_PESSOA PS
         WHERE PS.NOABREVIADO_FORNECEDOR = VNOM_ABREVIADO
           AND NOT EXISTS (SELECT 1
                  FROM TI_PESSOA PST
                 WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
           AND ROWNUM = 1;
      END IF;
    END; -- fim p_define_fornecedor
    --inicia aqui
  BEGIN
    VTI_PESSOA     := NULL;
    VTI_PESSOA_PAI := NULL;
    SELECT COUNT(*)
      INTO VCOUNT
      FROM TI_PESSOA P
     WHERE P.NRREGISTRO = PNRREGISTRO;
    IF VCOUNT = 0 THEN
      IF PAODEFINEPESSOA = 'S' THEN
        IF NOT F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
            '%' || PNRCGC_CPF || '%' THEN
          VNOABREVIADO_CLIENTE    := CNOM_ABREVIADO;
          VNOABREVIADO_FORNECEDOR := CNOM_ABREVIADO;
          VCDN_FORNECEDOR         := NULL;
          VCDN_CLIENTE            := NULL;
        ELSE
          IF PTPORIGEM = 'CLIENTE' THEN
            ---------------------------
            P_DEFINE_CLIENTE;
            ---------------------------
            --========================--
            -- Se for uma pessoa nova --
            ----------------------------
            IF VTI_PESSOA.NRREGISTRO IS NULL THEN
              ----------------------------
              -- Nome abreviado cliente --
              ----------------------------
              IF VCDN_CLIENTE IS NOT NULL THEN
                VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                VNOABREVIADO_CLIENTE   := VNOM_ABREV_CLIENTE;
              ELSE
                VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                VNOABREVIADO_CLIENTE   := VNOM_ABREVIADO;
              END IF;
              ------------------------------
              -- Verifica se  fornecedor --
              ------------------------------
              P_BUSCA_FORNECEDOR_EMS;
              -------------------------------
              -- Nome abreviado fornecedor --
              -------------------------------
              IF VCDN_FORNECEDOR IS NOT NULL THEN
                VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                VNOABREVIADO_FORNECEDOR   := VNOM_ABREV_FORNECEDOR;
              ELSE
                VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                VNOABREVIADO_FORNECEDOR   := VNOM_ABREVIADO;
              END IF;
            END IF;
          ELSE
            -------------------------------
            P_DEFINE_FORNECEDOR;
            -------------------------------
            --========================--
            -- Se for uma pessoa nova --
            ----------------------------
            IF VTI_PESSOA.NRREGISTRO IS NULL THEN
              -------------------------------
              -- Nome abreviado fornecedor --
              -------------------------------
              IF VCDN_FORNECEDOR IS NOT NULL THEN
                VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                VNOABREVIADO_FORNECEDOR   := VNOM_ABREV_FORNECEDOR;
              ELSE
                VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                VNOABREVIADO_FORNECEDOR   := VNOM_ABREVIADO;
              END IF;
              ------------------------------
              -- verifica se  cliente --
              ------------------------------
              P_BUSCA_CLIENTE_EMS;
              ----------------------------
              -- nome abreviado cliente --
              ----------------------------
              IF VCDN_CLIENTE IS NOT NULL THEN
                VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                VNOABREVIADO_CLIENTE   := VNOM_ABREV_CLIENTE;
              ELSE
                VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                VNOABREVIADO_CLIENTE   := VNOM_ABREVIADO;
              END IF;
            END IF;
          END IF;
        END IF;
      ELSE
        BEGIN
          SELECT *
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_CLIENTE = PNOABREVIADO_CLIENTE
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        EXCEPTION
          WHEN OTHERS THEN
            BEGIN
              SELECT *
                INTO VTI_PESSOA_PAI
                FROM TI_PESSOA PS
               WHERE PS.NOABREVIADO_FORNECEDOR = PNOABREVIADO_FORNECEDOR
                 AND NOT EXISTS
               (SELECT 1
                        FROM TI_PESSOA PST
                       WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
                 AND ROWNUM = 1;
            EXCEPTION
              WHEN OTHERS THEN
                VTI_PESSOA_PAI := NULL;
            END;
        END;
      END IF;
      IF VTI_PESSOA.NRREGISTRO IS NULL THEN
        VTI_PESSOA.NRREGISTRO             := PNRREGISTRO;
        VTI_PESSOA.NOABREVIADO_CLIENTE    := VNOABREVIADO_CLIENTE;
        VTI_PESSOA.NOABREVIADO_FORNECEDOR := VNOABREVIADO_FORNECEDOR;
        VTI_PESSOA.CDN_FORNECEDOR         := VCDN_FORNECEDOR;
        VTI_PESSOA.CDN_CLIENTE            := VCDN_CLIENTE;
        VTI_PESSOA.NRREGISTRO_PAI         := NULL;
        VTI_PESSOA.TXREGRA_AGRUPAMENTO    := NULL;
        VTI_PESSOA.NOPESSOA               := PNOPESSOA;
        VTI_PESSOA.DTNASCIMENTO           := PDTNASCIMENTO;
        VTI_PESSOA.NRCGC_CPF              := PNRCGC_CPF;
        VTI_PESSOA.NRREGISTRO_PAI         := VTI_PESSOA_PAI.NRREGISTRO;
      ELSE
        VTI_PESSOA.NRREGISTRO_PAI := VTI_PESSOA_PAI.NRREGISTRO;
        VTI_PESSOA.NRREGISTRO     := PNRREGISTRO;
        VTI_PESSOA.NOPESSOA       := PNOPESSOA;
        VTI_PESSOA.DTNASCIMENTO   := PDTNASCIMENTO;
        VTI_PESSOA.NRCGC_CPF      := PNRCGC_CPF;
      END IF;

      /* IF f_ti_parametro_integracao('INTR_EMS2') = 'S' THEN
              VTI_PESSOA.NOABREVIADO_CLIENTE    := SUBSTR(VTI_PESSOA.NOABREVIADO_CLIENTE,
                                                          0,
                                                          12);
              VTI_PESSOA.NOABREVIADO_FORNECEDOR := SUBSTR(VTI_PESSOA.NOABREVIADO_FORNECEDOR,
                                                          0,
                                                          12);
            END IF;
      */
      INSERT INTO TI_PESSOA
        (NRREGISTRO,
         NOABREVIADO_CLIENTE,
         NOABREVIADO_FORNECEDOR,
         CDN_FORNECEDOR,
         CDN_CLIENTE,
         NRREGISTRO_PAI,
         TXREGRA_AGRUPAMENTO,
         NOPESSOA,
         DTNASCIMENTO,
         NRCGC_CPF,
         DTGERACAO,
         DTULTIMA_ATUALIZACAO)
      VALUES
        (VTI_PESSOA.NRREGISTRO,
         VTI_PESSOA.NOABREVIADO_CLIENTE,
         VTI_PESSOA.NOABREVIADO_FORNECEDOR,
         VTI_PESSOA.CDN_FORNECEDOR,
         VTI_PESSOA.CDN_CLIENTE,
         VTI_PESSOA.NRREGISTRO_PAI,
         VTI_PESSOA.TXREGRA_AGRUPAMENTO,
         VTI_PESSOA.NOPESSOA,
         VTI_PESSOA.DTNASCIMENTO,
         VTI_PESSOA.NRCGC_CPF,
         SYSDATE,
         SYSDATE);
      PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
      PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
      PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
      PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;
    ELSE
      SELECT *
        INTO VTI_PESSOA
        FROM TI_PESSOA
       WHERE NRREGISTRO = PNRREGISTRO;
      PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
      PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
      PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
      PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;
    END IF;
  END;

  PROCEDURE P_JOB_FALHA IS
    CURSOR C_FALHA IS
      SELECT MP.CDACAO, FP.*
        FROM TI_MENSAGEM_PROCESSO MP, TI_FALHA_DE_PROCESSO FP
       WHERE FP.CDINTEGRACAO = MP.CDINTEGRACAO
         AND FP.NRMENSAGEM = MP.NRMENSAGEM;
    VSQL LONG;
  BEGIN
    FOR L_FALHA IN C_FALHA LOOP
      IF L_FALHA.CDACAO = 'CA' THEN
        VSQL := 'update ' || L_FALHA.CDINTEGRACAO || ' set ' ||
                ' cdsituacao=' || '''' || 'CA' || '''' ||
                ' where nrseq_controle_integracao=' ||
                L_FALHA.NRSEQ_CONTROLE_INTEGRACAO;
        EXECUTE IMMEDIATE VSQL;
      ELSIF L_FALHA.CDACAO = 'AT' THEN
        VSQL := 'begin pck_ems506unicoo.p_update_controle_integracao(' ||
                L_FALHA.NRSEQ_CONTROLE_INTEGRACAO ||
                ',f_ti_situacao_integracao(' ||
                L_FALHA.NRSEQ_CONTROLE_INTEGRACAO || ',' || '''' ||
                L_FALHA.CDINTEGRACAO || '''' || '),null ); end;';
        --            dbms_output.put_line(vsql);
        EXECUTE IMMEDIATE VSQL;
        BEGIN
          -- nao apagar falhas
          --pck_ems506unicoo.p_apaga_falha(l_falha.nrseq_controle_integracao);
          NULL;
        END;
      END IF;
      PCK_EMS506UNICOO.P_JOB();
    END LOOP;
  END;

  FUNCTION F_PERMITE_CANC_INT_FI_TIT_APB(PCDUNIMED VARCHAR2,
                                         PNRFATURA VARCHAR2) RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
    CURSOR C_TITULO IS
      SELECT *
        FROM AREA_DE_ACAO AA, TITULO_A_PAGAR TP
       WHERE AA.CDPRESTADOR = TP.CDFORNECEDOR
         AND AA.CDAREAACAO = PCDUNIMED
         AND TP.NRDOCUMENTO = PNRFATURA;
    VAOALTERAR VARCHAR2(1);
    VAOCANCELA VARCHAR2(1);
  BEGIN
    VRESULT := 'S';
    FOR L_TITULO IN C_TITULO LOOP
      VAOALTERAR := F_PERMITE_ALTERAR_TIT_APB(L_TITULO.NRDOCUMENTO,
                                              L_TITULO.NRREGISTRO_TITULO);
      IF VAOALTERAR = 'N' THEN
        VRESULT := 'N';
      ELSE
        VAOCANCELA := F_PERMITE_CANCELAR_TI_TIT_APB(L_TITULO.NRDOCUMENTO,
                                                    L_TITULO.NRREGISTRO_TITULO);
        IF VAOCANCELA = 'N' THEN
          VRESULT := 'N';
        END IF;
      END IF;
    END LOOP;
    RETURN VRESULT;
  END;

  PROCEDURE P_UPDATE_CONTROLE_INTEGRACAO(PNRSEQUENCIAL NUMBER,
                                         PCDSITUACAO   VARCHAR2,
                                         PTXOBSERVACAO VARCHAR2) IS
  BEGIN
    UPDATE TI_CONTROLE_INTEGRACAO TI
       SET TI.CDSITUACAO      = PCDSITUACAO,
           TI.TXOBSERVACAO    = PTXOBSERVACAO,
           TI.DTINTEGRACAO    = DECODE(PCDSITUACAO, 'IT', SYSDATE, NULL),
           TI.DTPROCESSAMENTO = SYSDATE
     WHERE TI.NRSEQUENCIAL = PNRSEQUENCIAL;
  END;

  PROCEDURE P_AJUSTES IS
    PROCEDURE P_ATUALIZA_NOSSONUMERO IS
      CURSOR C_TITULO IS
        SELECT TI.COD_PARCELA, TA.ROWID, TI.COD_TIT_ACR_BCO
          FROM EMS506UNICOO.TI_TIT_ACR TI, TIT_ACR TA
         WHERE TI.COD_TITULO_ACR = TA.COD_TIT_ACR
           AND TI.COD_SER_DOCTO = TA.COD_SER_DOCTO
           AND TI.COD_ESPEC_DOCTO = TA.COD_ESPEC_DOCTO
           AND TI.COD_PARCELA = TA.COD_PARCELA
           AND TA.COD_TIT_ACR_BCO <> TI.COD_TIT_ACR_BCO
           AND 1 = 2;
    BEGIN
      FOR L_TITULO IN C_TITULO LOOP
        UPDATE TIT_ACR Z
           SET Z.COD_TIT_ACR_BCO    = L_TITULO.COD_TIT_ACR_BCO,
               Z.U##COD_TIT_ACR_BCO = L_TITULO.COD_TIT_ACR_BCO
         WHERE Z.ROWID = L_TITULO.ROWID;
      END LOOP;
    END;

  BEGIN
    P_ATUALIZA_NOSSONUMERO;
    --          p_atualiza_cliente;
  END;

  --=========================--
  -- Grava falha de processo --
  -----------------------------
  PROCEDURE P_APAGA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER) IS
  BEGIN
    DELETE FROM TI_FALHA_DE_PROCESSO
     WHERE NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
  END;

  PROCEDURE P_JOB IS
    VTPINTEGRACAO TI_PARAMETRO_INTEGRACAO.VLPARAMETRO%TYPE;
  BEGIN
    VTPINTEGRACAO := F_TI_PARAMETRO_INTEGRACAO('TP_INTEGRACAO_ONLINE_UNICOO_EMS5');
    IF VTPINTEGRACAO LIKE '%' || 'CL' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'CL');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'FN' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'FN');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'TR' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'TR');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'TP' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'TP');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'FT' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'FT');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'CX' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'CX');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'BP' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'BP');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'BR' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'BR');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'CP' || '%' THEN
      -- cancelamento titulo pagar no ems
      P_MONITOR_INTEGRACAO(0, 'CP');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'BC' || '%' THEN
      -- cdhistorico 78
      P_MONITOR_INTEGRACAO(0, 'BC');
    END IF;
    COMMIT;
  END;

  PROCEDURE P_JOB_ERRO IS
  BEGIN
    UPDATE TI_CONTROLE_INTEGRACAO CI
       SET CI.CDSITUACAO = 'GE'
     WHERE CI.CDSITUACAO = 'ER'
       AND WNAOREPROCESSA NOT LIKE '%' || CI.TPINTEGRACAO || '%';
    P_COMMIT_NEW;
    PCK_EMS506UNICOO.P_JOB();
  END;

  PROCEDURE P_COMMIT IS
  BEGIN
    IF GCOMMIT >= GCOUNTOFRECORDS THEN
      COMMIT;
      GCOMMIT := 0;
    END IF;
    GCOMMIT := GCOMMIT + 1;
  END;

  PROCEDURE P_COMMIT_NEW IS
  BEGIN
    IF GCOMMIT >= GCOUNTOFRECORDS THEN
      --COMMIT;
      GCOMMIT := 0;
    END IF;
    GCOMMIT := GCOMMIT + 1;
  END;

  PROCEDURE P_REENVIA_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER) IS
  BEGIN
    UPDATE TI_CLIENTE C
       SET CDSITUACAO = 'RC'
     WHERE C.NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
    --       p_apaga_falha(pNRSeq_Controle_integracao);
  END;

  PROCEDURE P_REPROCESSA_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                    P_TPINTEGRACAO             VARCHAR2) IS
    CURSOR C_REPROCESSA IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND CI.CDSITUACAO IN ('PE')
         AND ((CI.TPINTEGRACAO = P_TPINTEGRACAO) OR (P_TPINTEGRACAO = '*'))
         AND WNAOREPROCESSA NOT LIKE '%' || CI.TPINTEGRACAO || '%'
       ORDER BY CI.NRSEQUENCIAL;
    V_SEQ_CONTROLE_INTEGRACAO NUMBER(10);
  BEGIN
    SELECT VLPARAMETRO
      INTO WNAOREPROCESSA
      FROM TI_PARAMETRO_INTEGRACAO
     WHERE CDPARAMETRO = 'TPINTEGRACAONAOREPROCESSA';
    FOR L_REPROCESSA IN C_REPROCESSA LOOP
      SELECT SQ_TI_CONTROLE_INTEGRACAO.NEXTVAL
        INTO V_SEQ_CONTROLE_INTEGRACAO
        FROM DUAL;
      INSERT INTO TI_CONTROLE_INTEGRACAO
        (NRSEQUENCIAL,
         TPINTEGRACAO,
         DTGERACAO,
         NRSEQUENCIAL_ORIGEM,
         DTPROCESSAMENTO,
         DTINTEGRACAO,
         CDACAO,
         CDIDENTIFICADOR,
         CDSITUACAO,
         NRSEQ_CONTROLE_INTEGRACAO_ORG,
         CDEMPRESA,
         CDMODULO,
         CDMOVIMENTO,
         CDDIVISAO)
        SELECT V_SEQ_CONTROLE_INTEGRACAO,
               TPINTEGRACAO,
               SYSDATE DTGERACAO,
               NRSEQUENCIAL_ORIGEM,
               NULL,
               DTINTEGRACAO,
               L_REPROCESSA.CDACAO,
               CDIDENTIFICADOR,
               'GE',
               L_REPROCESSA.NRSEQUENCIAL,
               L_REPROCESSA.CDEMPRESA,
               L_REPROCESSA.CDMODULO,
               L_REPROCESSA.CDMOVIMENTO,
               L_REPROCESSA.CDDIVISAO
          FROM TI_CONTROLE_INTEGRACAO CI
         WHERE CI.NRSEQUENCIAL = L_REPROCESSA.NRSEQUENCIAL;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.DTPROCESSAMENTO = SYSDATE, CI.CDSITUACAO = 'RE'
       WHERE CI.NRSEQUENCIAL = L_REPROCESSA.NRSEQUENCIAL;
      IF L_REPROCESSA.TPINTEGRACAO = 'CL' THEN
        UPDATE TI_CLIENTE CL
           SET CL.CDSITUACAO = 'RE' -- REPROCESSA
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'FN' THEN
        UPDATE TI_FORNECEDOR FN
           SET FN.CDSITUACAO = 'RE' -- REPROCESSA
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'TR' THEN
        UPDATE TI_TIT_ACR CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'TP' THEN
        UPDATE TI_TIT_APB CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'CT' THEN
        UPDATE TI_LOTE_CTBL CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'CX' THEN
        UPDATE TI_LOTE_CTBL CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO IN ('FT', 'EM') THEN
        UPDATE TI_TIT_ACR_ESTORNO CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'BP' THEN
        UPDATE TI_CX_BX_APB BP
           SET BP.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'BR' THEN
        UPDATE TI_CX_BX_ACR BR
           SET BR.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      END IF;
    END LOOP;
    P_COMMIT_NEW;
    PCK_EMS506UNICOO.P_JOB();
  END;

  --======================================================--
  -- Define o mdulo origem dos titulos do contas a pagar --
  ----------------------------------------------------------
  PROCEDURE P_DEFINE_MODULO_TIT_APB(PNRSESSAO TI_CONTROLE_INTEGRACAO.NRSESSAO%TYPE) IS
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TP'
         AND CI.CDMODULO IS NULL
         AND CI.NRSESSAO = PNRSESSAO;
    VCDMOVIMENTO  TI_CONTROLE_INTEGRACAO.CDMOVIMENTO%TYPE;
    VCDDIVISAO    TI_CONTROLE_INTEGRACAO.CDDIVISAO%TYPE;
    VCDMODULO     TI_CONTROLE_INTEGRACAO.CDMODULO%TYPE;
    VCDSITUACAO   TI_CONTROLE_INTEGRACAO.CDSITUACAO%TYPE;
    VTXOBSERVACAO TI_CONTROLE_INTEGRACAO.TXOBSERVACAO%TYPE;
    VQTDESPECIE   NUMBER;
  BEGIN
    FOR L_TITULO IN C_TITULO LOOP
      BEGIN
        --===================================--
        -- Titulos de prestadores e Unimeds --
        ---------------------------------------
        -- Alessandro 18/07/2012
        /*select pr.tpprestador
         into vcdmovimento
         from titulo_a_pagar tp,
              prestador pr
        where
              f_ti_parametro_integracao('CLASSIFICA_INTEGRACAO_PAGPREST') = 'PR'
          and pr.cdprestador                                             = tp.cdfornecedor
          and tp.nrregistro_titulo                                       = l_titulo.nrsequencial_origem
          and tp.cdfuncionario                                          <> 'MVINTEGRA';*/
        SELECT PR.TPPRESTADOR
          INTO VCDMOVIMENTO
          FROM TITULO_A_PAGAR TP, PRESTADOR PR
         WHERE F_TI_PARAMETRO_INTEGRACAO('CLASSIFICA_INTEGRACAO_PAGPREST') = 'PR'
           AND PR.CDPRESTADOR = TP.CDFORNECEDOR
           AND TP.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
           AND TP.CDFUNCIONARIO <> 'MVINTEGRA'
              --
              --and tp.tpdocumento <> wtpdoc
           AND TP.NRDOCUMENTO NOT LIKE 'TX%'
              --
           AND NOT EXISTS
         (SELECT 1
                  FROM REM_IMP_CONTROLE_A550 XX
                 WHERE XX.TP_ARQUIVO IN ('4', '6', '8') -- tp_arquivo = 5 -- Receber  -- tp_arquivo = 6 -- Pagar;-- Alessandro 13/05/2014
                   AND XX.NRREGISTRO_TITULO = TP.NRREGISTRO_TITULO)
           AND PR.TPPRESTADOR <>
               F_TI_PARAMETRO_INTEGRACAO('TIPO_PRESTADOR_NAO_INTEGRA_PAGPREST'); -- Alecsandro 05/08
        -- Alessandro 18/07/2012
        VCDDIVISAO  := NULL;
        VCDMODULO   := 'PR';
        VCDSITUACAO := 'GE';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          --=========================--
          -- Titulos de fornecedores --
          -----------------------------

          IF VVERSAOFINANCEIRO = '1' THEN
            BEGIN
              SELECT CDHISTORICO, HT.CDCENTRO_CUSTO
                INTO VCDMOVIMENTO, VCDDIVISAO
                FROM HISTORICO_DO_TITULO_PAGAR HT
               WHERE HT.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
                 AND HT.CDMOVIMENTO IN ('1', '3');
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VCDMOVIMENTO  := NULL;
                VCDMODULO     := NULL;
                VCDDIVISAO    := NULL;
                VCDSITUACAO   := 'CA';
                VTXOBSERVACAO := 'Nao encontrado movimento 1 ou 3 na tabela historico_do_titulo_pagar ';
            END;
          ELSE
            ----------------------------------------------------
            -- Verificar se o titulo tem somente uma especie.
            -- Josias 05-06-2014 - -João Pessoa
            ----------------------------------------------------
            BEGIN
              SELECT COUNT(*)
                INTO VQTDESPECIE
                FROM (SELECT DISTINCT C.COD_ESPEC_DOCTO
                        FROM TITULO_A_PAGAR            TP,
                             DISTRIBUICAO_TITULO_PAGAR DTP,
                             TI_TIPO_MOVIMENTO_TIT_APB C
                       WHERE TP.NRREGISTRO_TITULO = DTP.NRREGISTRO_TITULO
                         AND C.CDEMPRESA = TP.CDEMPRESA
                         AND C.CDMOVIMENTO =
                             TO_CHAR(NVL(DTP.CDHISTORICO, TP.CDHISTORICO))
                         AND TP.NRREGISTRO_TITULO =
                             L_TITULO.NRSEQUENCIAL_ORIGEM);
              --Quando houver mais de uma especie deverá localizar a distribuicao de maior valor,
              --caso o parametro DEFINE_HISTORICO_PADRAO_APB seja igual a GF, o valor do historico sera
              --substituido pelo exitente no cadastro de grupo de fornecedor (ti_grupo_fornecedor)...
              --Inicio trata espécie duplkicada...
              IF VQTDESPECIE > 1 THEN
                BEGIN
                  VTXOBSERVACAO := 'Titulo rateado pelo critério do maior valor';
                  SELECT CDHISTORICO, CDDIVISAO
                    INTO VCDMOVIMENTO, VCDDIVISAO
                    FROM (SELECT NVL(B.CDHISTORICO, HT.CDHISTORICO) CDHISTORICO,
                                 NVL(B.CDDIVISAO, HT.CDDIVISAO) CDDIVISAO,
                                 NVL(SUM(DECODE(B.TIPO_DISTRIB,
                                                'V',
                                                B.VLDISTRIBUICAO,
                                                -1 * B.VLDISTRIBUICAO)),
                                     0) VALOR
                            FROM TITULO_A_PAGAR            HT,
                                 DISTRIBUICAO_TITULO_PAGAR B
                           WHERE HT.NRREGISTRO_TITULO =
                                 B.NRREGISTRO_TITULO(+)
                             AND HT.NRREGISTRO_TITULO =
                                 L_TITULO.NRSEQUENCIAL_ORIGEM
                           GROUP BY NVL(B.CDHISTORICO, HT.CDHISTORICO),
                                    NVL(B.CDDIVISAO, HT.CDDIVISAO)
                           ORDER BY 3 DESC)
                   WHERE ROWNUM = 1;
                  IF F_TI_PARAMETRO_INTEGRACAO('DEFINE_HISTORICO_PADRAO_APB') = 'GF' THEN
                    BEGIN
                      VTXOBSERVACAO := 'Titulo rateado pelo critério do Grupo do Fornecedor';
                      SELECT GF.CD_HISTORICO_PADRAO
                        INTO VCDMOVIMENTO
                        FROM TITULO_A_PAGAR                      TP,
                             PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FN,
                             TI_GRUPO_DE_FORNECEDOR              GF
                       WHERE GF.CDGRUPO_FORNECEDOR = FN.CDGRUPO_FORNECEDOR
                         AND TP.CDFORNECEDOR = TP.CDFORNECEDOR
                         AND TP.NRREGISTRO_TITULO =
                             L_TITULO.NRSEQUENCIAL_ORIGEM
                         AND GF.CD_HISTORICO_PADRAO IS NOT NULL;
                    EXCEPTION
                      WHEN NO_DATA_FOUND THEN
                        VCDMOVIMENTO  := NULL;
                        VCDMODULO     := NULL;
                        VCDDIVISAO    := NULL;
                        VCDSITUACAO   := 'ER';
                        VTXOBSERVACAO := 'Histórico não cadastrado no Grupo de Fornecedor';
                        P_GRAVA_FALHA(L_TITULO.NRSEQUENCIAL,
                                      'TP',
                                      VTXOBSERVACAO,
                                      NULL,
                                      VCDSITUACAO,
                                      NULL);
                    END;
                  END IF;
                EXCEPTION
                  WHEN NO_DATA_FOUND THEN
                    VCDMOVIMENTO  := NULL;
                    VCDMODULO     := NULL;
                    VCDDIVISAO    := NULL;
                    VCDSITUACAO   := 'ER';
                    VTXOBSERVACAO := 'Não encontrado titulo de origem ';
                    P_GRAVA_FALHA(L_TITULO.NRSEQUENCIAL,
                                  'TP',
                                  VTXOBSERVACAO,
                                  NULL,
                                  VCDSITUACAO,
                                  NULL);
                END;
                --Fim trata espécie duplkicada...
              ELSE
                BEGIN
                  SELECT MIN(CDHISTORICO), MIN(CDDIVISAO)
                    INTO VCDMOVIMENTO, VCDDIVISAO
                    FROM (SELECT DISTINCT NVL(B.CDHISTORICO, HT.CDHISTORICO) CDHISTORICO,
                                          NVL(B.CDDIVISAO, HT.CDDIVISAO) CDDIVISAO
                            FROM TITULO_A_PAGAR            HT,
                                 DISTRIBUICAO_TITULO_PAGAR B
                           WHERE HT.NRREGISTRO_TITULO =
                                 B.NRREGISTRO_TITULO(+)
                             AND HT.NRREGISTRO_TITULO =
                                 L_TITULO.NRSEQUENCIAL_ORIGEM);
                EXCEPTION
                  WHEN NO_DATA_FOUND THEN
                    VCDMOVIMENTO  := NULL;
                    VCDMODULO     := NULL;
                    VCDDIVISAO    := NULL;
                    VCDSITUACAO   := 'ER';
                    VTXOBSERVACAO := 'Não encontrado titulo de origem ';
                    P_GRAVA_FALHA(L_TITULO.NRSEQUENCIAL,
                                  'TP',
                                  VTXOBSERVACAO,
                                  NULL,
                                  VCDSITUACAO,
                                  NULL);
                END;
              END IF;
            END;
          END IF;
          IF NVL(VCDSITUACAO, 'x') <> 'ER' THEN
            VCDMODULO   := 'CP';
            VCDSITUACAO := 'GE';
            --====================--
            -- Classifica imposto --
            ------------------------
            BEGIN
              SELECT PR.TPPRESTADOR
                INTO VCDMOVIMENTO
                FROM TAXA_TITULO_INTEGRACAO TTI,
                     TITULO_A_PAGAR         TP,
                     PRESTADOR              PR
               WHERE PR.CDPRESTADOR = TTI.CDFORNECEDOR
                 AND TP.NRREGISTRO_TITULO = TTI.NRREGISTRO_TITULO_TAXA
                 AND TP.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
                    --
                 AND NOT EXISTS
               (SELECT 1
                        FROM TAXA_TITULO_INTEGRACAO T
                       WHERE T.NRREGISTRO_TITULO_TAXA = TP.NRREGISTRO_TITULO);
              VCDMODULO  := F_TI_PARAMETRO_INTEGRACAO('CLASSIFICA_IMPOSTO_INTEGRACAO_PAGPREST');
              VCDDIVISAO := NULL;
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                NULL;
            END;
          END IF;
      END;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDMODULO     = VCDMODULO,
             CI.CDMOVIMENTO  = VCDMOVIMENTO,
             CI.CDSITUACAO   = VCDSITUACAO,
             CI.CDDIVISAO    = VCDDIVISAO,
             CI.TXOBSERVACAO = VTXOBSERVACAO
       WHERE CI.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
      P_COMMIT_NEW;
    END LOOP;
  END;

  --========================================================--
  -- Define o mdulo origem dos titulos do contas a receber --
  ------------------------------------------------------------
  PROCEDURE P_DEFINE_MODULO_TIT_ACR(PNRSESSAO TI_CONTROLE_INTEGRACAO.NRSESSAO%TYPE) IS
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TR'
         AND CI.CDMODULO IS NULL
         AND CI.NRSESSAO = PNRSESSAO;
    VCDMOVIMENTO TI_CONTROLE_INTEGRACAO.CDMOVIMENTO%TYPE;
    VCDMODULO    TI_CONTROLE_INTEGRACAO.CDMODULO%TYPE;
    VCDSITUACAO  TI_CONTROLE_INTEGRACAO.CDSITUACAO%TYPE;
  BEGIN
    FOR L_TITULO IN C_TITULO LOOP
      BEGIN
        --====================--
        -- Titulos de faturas --
        ------------------------
        SELECT SUBSTR(FT.NRFATURA, 1, INSTR(FT.NRFATURA, '-') - 1)
          INTO VCDMOVIMENTO
          FROM FATURAMENTO FT
         WHERE FT.NRFATURA = L_TITULO.CDIDENTIFICADOR;
        VCDMODULO   := 'FT';
        VCDSITUACAO := 'GE';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          BEGIN
            --===============================--
            -- Titulos de faturas parceladas --
            -----------------------------------
            SELECT SUBSTR(DF.NRFATURA, 1, INSTR(DF.NRFATURA, '-') - 1)
              INTO VCDMOVIMENTO
              FROM DUPLICATA_FATURAMENTO DF
             WHERE DF.NRDUPLICATA = L_TITULO.CDIDENTIFICADOR;
            VCDMODULO   := 'FT';
            VCDSITUACAO := 'GE';
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                --===============================================--
                -- Titulos que no possuem origem no faturamento --
                ---------------------------------------------------
                SELECT NVL(HT.CDHISTORICO, TR.CDHISTORICO)
                  INTO VCDMOVIMENTO
                  FROM HISTORICO_DO_TITULO HT, TITULO_A_RECEBER TR
                 WHERE HT.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
                   AND HT.NRREGISTRO_TITULO = TR.NRREGISTRO_TITULO
                   AND
                      --ht.cdmovimento='1';-- Alessandro 21/10/2014
                       HT.CDMOVIMENTO IN ('1', '3'); -- Alessandro 21/10/2014
                VCDMODULO   := 'CR';
                VCDSITUACAO := 'GE';
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VCDMOVIMENTO := NULL;
                  VCDMODULO    := NULL;
                  VCDSITUACAO  := 'CA';
                  -- gravar falha
                WHEN OTHERS THEN
                  VCDMOVIMENTO := NULL;
                  VCDMODULO    := NULL;
                  VCDSITUACAO  := 'CA';
                  -- gravar falha
              END;
          END;
      END;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDMODULO    = VCDMODULO,
             CI.CDMOVIMENTO = VCDMOVIMENTO,
             CI.CDSITUACAO  = VCDSITUACAO
       WHERE CI.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
    END LOOP;
  END;

  PROCEDURE P_MONITOR_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PTPINTEGRACAO              VARCHAR DEFAULT '*') IS
    CURSOR C_PROCESSA(PNRSESSAO NUMBER, PTPINTEGRACAO VARCHAR2) IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.CDSITUACAO = 'VD'
         AND CI.TPINTEGRACAO NOT IN ('MV', 'FE')
         AND CI.TPINTEGRACAO = PTPINTEGRACAO
       ORDER BY CI.NRSEQUENCIAL;
    VCDSITUACAO VARCHAR2(2);
    /*-------------------------------
    GE --> PI --> PR  // Prepara
    PR --> VI --> VD  // Valida
    VD --> OK         // Processa
    Gerao --> Preparao Inicio --> Preparado
    Preparado --> Validao Inicial --> Validado
    Validado --> OK
    -------------------------------*/
    VNRSESSAO     NUMBER(10);
    VTPINTEGRACAO VARCHAR2(2);
  BEGIN
    WHILE TRUE LOOP
      SELECT SQ_TI_SESSAO.NEXTVAL INTO VNRSESSAO FROM DUAL;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.NRSESSAO = VNRSESSAO
       WHERE (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = CI.TPINTEGRACAO)
         AND CI.CDSITUACAO = 'GE'
         AND ROWNUM <= GSESSAO_MOVIMENTO;
      IF SQL%ROWCOUNT = 0 THEN
        EXIT;
      ELSE
        ----------------------------------------------------------
        P_VALIDA_CONTROLE_INTEGRACAO(PTPINTEGRACAO, VNRSESSAO);
        ----------------------------------------------------------
        IF PTPINTEGRACAO = 'TP' THEN
          P_DEFINE_MODULO_TIT_APB(VNRSESSAO);
        ELSIF PTPINTEGRACAO = 'TR' THEN
          P_DEFINE_MODULO_TIT_ACR(VNRSESSAO);
        END IF;
        --====================--
        -- Prepara Integrao --
        ------------------------
        VCDSITUACAO := 'VD';
        UPDATE TI_CONTROLE_INTEGRACAO CI
           SET CI.CDSITUACAO = VCDSITUACAO
         WHERE CI.NRSESSAO = VNRSESSAO
           AND CI.CDSITUACAO = 'GE'
           AND CI.TPINTEGRACAO NOT IN ('MV', 'FE');
        --=====================--
        -- Processa Integrao --
        -------------------------
        VTPINTEGRACAO := PTPINTEGRACAO;
        FOR L_PROCESSA IN C_PROCESSA(VNRSESSAO, VTPINTEGRACAO) LOOP
          VCDSITUACAO := 'VD';

          P_TI_PROCESSA_INTEGRACAO(L_PROCESSA.TPINTEGRACAO,
                                   L_PROCESSA.NRSEQUENCIAL,
                                   VNRSESSAO,
                                   L_PROCESSA.CDIDENTIFICADOR,
                                   VCDSITUACAO);
        END LOOP;
        P_COMMIT_NEW;
      END IF;
    END LOOP;
    --COMMIT;
  END;

  PROCEDURE P_VALIDA_CONTROLE_INTEGRACAO(PTPINTEGRACAO VARCHAR2,
                                         PNRSESSAO     NUMBER) IS
  BEGIN
    P_AJUSTES;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'FT') THEN
      --=============================================--
      -- Cancela integrao de fornecedores diversos --
      -------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'FATURA REATIVADA NO UNICOO'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND EXISTS (SELECT 1
                FROM FATURAMENTO FT
               WHERE FT.NRFATURA = CI.CDIDENTIFICADOR
                 AND FT.DTCANCELAMENTO IS NULL);
      --=============================================--
      -- Cancela integrao de fornecedores diversos --
      -------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'FATURA JA CANCELADA NO EMS5'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND EXISTS (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS, TIT_ACR TTA
               WHERE TTA.U##COD_ESTAB = EMS.COD_ESTAB
                 AND TTA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
                 AND TTA.LOG_TIT_ACR_ESTORDO = 1
                 AND EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR)
         AND NOT EXISTS
       (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS, TIT_ACR TTA
               WHERE TTA.U##COD_ESTAB = EMS.COD_ESTAB
                 AND TTA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
                 AND TTA.LOG_TIT_ACR_ESTORDO = 0
                 AND EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR);
      --=============================================--
      -- Cancela integrao de fornecedores diversos CASO NAO ENCONTRE TITULO NO EMS--
      -------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'FATURA JA CANCELADA OU NAO INTEGRADA NO EMS5'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND NOT EXISTS
       (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS, TIT_ACR TTA
               WHERE TTA.U##COD_ESTAB = EMS.COD_ESTAB
                 AND TTA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
                 AND TTA.LOG_TIT_ACR_ESTORDO = 0
                 AND EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR);
      -- Alessandro 19/03/2012
      --=============================================--
      -- Fatura Integrada com EMS5 e nao Contabilizada
      ------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'ER',
             CI.TXOBSERVACAO = 'FATURA INTEGRADA EMS5 e Nao Contabilizada'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO --386511633--
         AND EXISTS
       (SELECT 1
                FROM TI_CONTROLE_INTEGRACAO CI1,
                     TI_TIT_ACR_ESTORNO     T,
                     TIT_ACR                TA,
                     MOVTO_TIT_ACR          MT
               WHERE MT.U##COD_ESTAB = TA.U##COD_ESTAB
                 AND MT.NUM_ID_TIT_ACR = TA.NUM_ID_TIT_ACR
                 AND MT.IND_TRANS_ACR_ABREV = 'IMPL'
                 AND TA.NUM_ID_TIT_ACR = T.NUM_ID_TIT_ACR
                 AND CI1.NRSEQUENCIAL = T.NRSEQ_CONTROLE_INTEGRACAO
                 AND MT.LOG_APROP_CTBL_CTBZDA = 0
                 AND CI1.NRSEQUENCIAL = CI.NRSEQUENCIAL);
      -- Alessandro 19/03/2012
    END IF;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'TP') THEN
      -- cancela os titulos do contas a pagar que sao de impostos, pois nao devem ser integrados
      -----------------------------------------------
      CANCELA_CONTROLE_TIT_IMPOSTOS(PNRSESSAO);
      -----------------------------------------------
      IF F_TI_PARAMETRO_INTEGRACAO('INTEGRA_SOMENTE_TITULOS_PRESTADORES') = 'S' THEN
        --=============================================--
        -- Cancela integrao de fornecedores diversos --
        -------------------------------------------------
        UPDATE TI_CONTROLE_INTEGRACAO CI
           SET CI.CDSITUACAO   = 'CA',
               CI.TXOBSERVACAO = 'A integração do unicoo com o ems5 integra apenas titulos de prestadores'
         WHERE CI.TPINTEGRACAO = 'TP'
           AND CI.CDSITUACAO = 'GE'
           AND CI.NRSESSAO = PNRSESSAO
           AND NOT EXISTS
         (SELECT 1
                  FROM TITULO_A_PAGAR                      TP,
                       PRESTADOR                           PR,
                       PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FN
                 WHERE FN.CDFORNECEDOR = PR.CDPRESTADOR
                   AND FN.CDFORNECEDOR = TP.CDFORNECEDOR
                   AND CI.NRSEQUENCIAL_ORIGEM = TP.NRREGISTRO_TITULO)
              -- Titulo no  de imposto de prestador com saldo negativo
           AND NOT EXISTS
         (SELECT 1
                  FROM TITULO_A_PAGAR TP --taxa_titulo_integracao tti,
                 WHERE CI.NRSEQUENCIAL_ORIGEM = TP.NRREGISTRO_TITULO);
      END IF;
    END IF;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'TR') THEN
      IF F_TI_PARAMETRO_INTEGRACAO('INTEGRA_SOMENTE_TITULOS_FATURAMENTO') = 'S' THEN
        --=====================================--
        -- Cancela a integrao de titulos que --
        -- no possuem origem no faturamento   --
        -----------------------------------------
        UPDATE TI_CONTROLE_INTEGRACAO CI
           SET CI.CDSITUACAO   = 'CA',
               CI.TXOBSERVACAO = 'TITULO NO POSSUI ORIGEM NO FATURAMENTO'
         WHERE CI.TPINTEGRACAO = 'TR'
           AND CI.CDSITUACAO = 'GE'
           AND CI.NRSESSAO = PNRSESSAO
           AND NOT EXISTS (SELECT 1
                  FROM FATURAMENTO FT
                 WHERE FT.NRFATURA = CI.CDIDENTIFICADOR)
           AND NOT EXISTS
         (SELECT 1
                  FROM DUPLICATA_FATURAMENTO DF
                 WHERE DF.NRDUPLICATA = CI.CDIDENTIFICADOR);
      END IF;
    END IF;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'FT') THEN
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'TITULO CANC NO FATURAMENTO E NAO EXISTE NO EMS/RECEBER UNICOO'
       WHERE CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'FT'
         AND NOT EXISTS
       (SELECT 1
                FROM TI_TIT_ACR_ESTORNO TAC
               WHERE TAC.NRSEQ_CONTROLE_INTEGRACAO = CI.NRSEQUENCIAL)
         AND NOT EXISTS (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS
               WHERE EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR)
         AND NOT EXISTS
       (SELECT 1
                FROM TITULO_A_RECEBER TR
               WHERE TR.NRDOCUMENTO = CI.CDIDENTIFICADOR);
    END IF;
  END;

  --=========================--
  -- Grava falha de processo --
  -----------------------------
  PROCEDURE P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                          PCDINTEGRACAO              VARCHAR2,
                          PTXFALHA                   VARCHAR2,
                          PTXAJUDA                   VARCHAR2,
                          PCDSITUACAO                IN OUT VARCHAR2,
                          PNRMENSAGEM                NUMBER DEFAULT NULL) IS
  BEGIN
    PCDSITUACAO := 'ER';
    BEGIN
      INSERT INTO TI_FALHA_DE_PROCESSO
        (NRSEQUENCIAL,
         NRSEQ_CONTROLE_INTEGRACAO,
         CDINTEGRACAO,
         TXFALHA,
         TXAJUDA,
         DTFALHA,
         NRMENSAGEM)
      VALUES
        (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
         PNRSEQ_CONTROLE_INTEGRACAO,
         PCDINTEGRACAO,
         PTXFALHA,
         PTXAJUDA,
         SYSDATE,
         PNRMENSAGEM);
    EXCEPTION
      WHEN OTHERS THEN
        RAISE_APPLICATION_ERROR(-20001,
                                PNRSEQ_CONTROLE_INTEGRACAO || PCDINTEGRACAO ||
                                PTXFALHA || PTXAJUDA);
    END;
    P_UPDATE_CONTROLE_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO,
                                 PCDSITUACAO,
                                 NULL);
  END;

  PROCEDURE P_TIT_PAGAR_CANCELADO_EMS(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER) IS
    TTI_TIT_APB             TI_TIT_APB%ROWTYPE;
    TTI_CONTROLE_INTEGRACAO TI_CONTROLE_INTEGRACAO%ROWTYPE;
    TTIT_AP                 TIT_AP%ROWTYPE;
    TFORNECEDOR_EMS         FORNECEDOR%ROWTYPE;
    TTIT_CANCDO_APB         TIT_CANCDO_APB%ROWTYPE;
    VSIT                    VARCHAR2(2);
    -- procedure para inserir historico de cancelamento no unicoo
    PROCEDURE INSERE_HISTORICO_80(PNRREGISTRO_TITULO IN NUMBER) IS
      THISTORICO_DO_TITULO_PAGAR HISTORICO_DO_TITULO_PAGAR%ROWTYPE;
    BEGIN
      SELECT *
        INTO THISTORICO_DO_TITULO_PAGAR
        FROM HISTORICO_DO_TITULO_PAGAR
       WHERE NRREGISTRO_TITULO = PNRREGISTRO_TITULO;
      SELECT PRODUCAO.SEQ_NRMOVHIST_PAGAR.NEXTVAL@UNICOO_HOMOLOGA
        INTO THISTORICO_DO_TITULO_PAGAR.NRMOVIMENTO
        FROM DUAL;
      THISTORICO_DO_TITULO_PAGAR.CDMOVIMENTO   := '80';
      THISTORICO_DO_TITULO_PAGAR.CDFUNCIONARIO := 'CANCEMS';
      THISTORICO_DO_TITULO_PAGAR.DTMOVIMENTO   := SYSDATE;
      INSERT INTO HISTORICO_DO_TITULO_PAGAR
      VALUES THISTORICO_DO_TITULO_PAGAR;
    END;

  BEGIN
    -- busca o controle
    SELECT *
      INTO TTI_CONTROLE_INTEGRACAO
      FROM TI_CONTROLE_INTEGRACAO
     WHERE TPINTEGRACAO = 'CP'
       AND NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO;
    -- busca o cancelamento do titulo
    SELECT *
      INTO TTIT_CANCDO_APB
      FROM TIT_CANCDO_APB
     WHERE NUM_ID_TIT_AP = TTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM;
    -- busca o fornecedor do ems
    SELECT EFN.*
      INTO TFORNECEDOR_EMS
      FROM FORNECEDOR EFN, TI_EMPRESA EMP
     WHERE EFN.CDN_FORNECEDOR = TTIT_CANCDO_APB.CDN_FORNECEDOR
       AND EFN.COD_EMPRESA = EMP.COD_EMPRESA
       AND EMP.CDEMPRESA = F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
    SELECT *
      INTO TTI_TIT_APB
      FROM TI_TIT_APB M
     WHERE M.COD_TITULO_AP = TTIT_CANCDO_APB.COD_TIT_AP
       AND M.COD_ID_FEDER = TFORNECEDOR_EMS.COD_ID_FEDER
       AND M.CDSITUACAO = 'IT';
    INSERE_HISTORICO_80(TTI_TIT_APB.NRREGISTRO_TITULO);
    UPDATE TI_CONTROLE_INTEGRACAO
       SET CDSITUACAO = 'IT'
     WHERE NRSEQUENCIAL = TTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL;
  EXCEPTION
    WHEN OTHERS THEN
      P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                    'CP',
                    'Erro ao cancelar o titulo no unicoo',
                    SQLERRM,
                    VSIT);
  END;

  --========================--
  -- Controle de integrao --
  ----------------------------
  PROCEDURE P_TI_PROCESSA_INTEGRACAO(PTPINTEGRACAO    VARCHAR2,
                                     PNRSEQUENCIAL    NUMBER,
                                     PNRSESSAO        NUMBER,
                                     PCDIDENTIFICADOR VARCHAR2,
                                     PCDSITUACAO      IN OUT VARCHAR2) IS
  BEGIN
    IF PTPINTEGRACAO = 'TP' THEN
      --================--
      -- Titulo a pagar --
      --------------------
      P_TI_TIT_APB(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'CL' THEN
      --============--
      -- Cliente --
      ----------------
      P_TI_CLIENTE(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'FN' THEN
      --============--
      -- Fornecedor --
      ----------------
      P_TI_FORNECEDOR(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'TR' THEN
      --==================--
      -- Titulo a receber --
      ----------------------
      P_TI_TIT_ACR(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'FT' THEN
      --=============================--
      -- Cancelamento do faturamento --
      ---------------------------------
      P_TI_TIT_ACR_ESTORNO(PNRSEQUENCIAL,
                           PCDIDENTIFICADOR,
                           PCDSITUACAO,
                           PNRSESSAO);
    ELSIF PTPINTEGRACAO = 'CX' THEN
      --=============================--
      -- Caixa e Bancos              --
      ---------------------------------
      P_TI_MOVIMENTO_CTA_CORRENTE(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'CP' THEN
      --=============================--
      -- Titulo Cancelado no EMS     --
      ---------------------------------
      P_TIT_PAGAR_CANCELADO_EMS(PNRSEQUENCIAL);
    ELSIF PTPINTEGRACAO = 'BP' THEN
      EMS506UNICOO.PCK_BX_TIT_EMS.P_PROCESSA_APB(PNRSEQUENCIAL,
                                                 PNRSESSAO,
                                                 PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'BR' THEN
      EMS506UNICOO.PCK_BX_TIT_EMS.P_PROCESSA_ACR(PNRSEQUENCIAL,
                                                 PNRSESSAO,
                                                 PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'BC' THEN
      EMS506UNICOO.PCK_BX78_TIT_EMS.P_PROCESSA_ACR78(PNRSEQUENCIAL,
                                                     PNRSESSAO,
                                                     PCDSITUACAO);
    END IF;
  END;

  PROCEDURE P_TI_VALIDA_ENDERECO(PNRREGISTRO                IN NUMBER,
                                 PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                                 PCDINTEGRACAO              IN VARCHAR2,
                                 PCDSITUACAO                IN OUT VARCHAR2) IS
    VCDCIDADE ENDERECO.CDCIDADE%TYPE;
  BEGIN
    BEGIN
      ---------------------
      -- Verifica Endereco --
      ---------------------
      BEGIN
        SELECT CDCIDADE
          INTO VCDCIDADE
          FROM ENDERECO ED
         WHERE ED.NRREGISTRO = PNRREGISTRO
           AND ED.TPENDERECO = F_TI_TIP_ENDERECO(PNRREGISTRO);
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          -- Josias 03-07-2014
          --- pegar como default a cidade do endereço defaul
          SELECT CDCIDADE
            INTO VCDCIDADE
            FROM ENDERECO ED
           WHERE ED.NRREGISTRO = 10405
                --    F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO') VINICIUS NOVA IGUAÇU
             AND TPENDERECO = 'COBR';
          --  F_TI_TIP_ENDERECO(F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO'));
      END;
      BEGIN
        ---------------------
        -- Verifica Cidade --
        ---------------------
        SELECT CDCIDADE
          INTO VCDCIDADE
          FROM ENDERECO ED
         WHERE ED.NRREGISTRO = 10405
              -- F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO') VINICIUS NOVA IGUAÇU
           AND TPENDERECO = 'COBR';
        --  F_TI_TIP_ENDERECO(F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO'));
        SELECT CDCIDADE
          INTO VCDCIDADE
          FROM PRODUCAO.CIDADE@UNICOO_HOMOLOGA
         WHERE CDCIDADE = VCDCIDADE;
        PCDSITUACAO := 'RC';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        PCDINTEGRACAO,
                        'Cidade não cadastrada',
                        'Pessoa ==> ' || PNRREGISTRO || ' A Cidade ==> ' ||
                        VCDCIDADE || ' Não existe',
                        PCDSITUACAO,
                        NULL);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        PCDINTEGRACAO,
                        'Cidade no cadastrada',
                        'Pessoa ==> ' || PNRREGISTRO ||
                        ' Erro ao pesquisar cidade ' || SQLERRM,
                        PCDSITUACAO,
                        NULL);
      END;
    EXCEPTION
      /*
      when no_data_found then


                    p_grava_falha(pnrseq_controle_integracao,
                                  pCDIntegracao,
                                  'Endereo no cadastrado',
                                  'Pessoa ==> '||pnrregistro,
                                  pCDSituacao,
                                  null);
       */
      WHEN OTHERS THEN
        P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                      PCDINTEGRACAO,
                      'Erro ao validar o endereo',
                      'Erro ao pesquisar endereco ' || SQLERRM,
                      PCDSITUACAO,
                      NULL);
    END;
  END;

  --==================================--
  -- Grava Fornecedor - TI_FORNECEDOR --
  --------------------------------------
  PROCEDURE P_TI_FORNECEDOR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                            PNRSESSAO                  NUMBER,
                            PCDSITUACAO                IN OUT VARCHAR2) IS

    --VARIAVEIS PARA TRATAR E REDUZ O ENDERECO
    VQTLOGRA             NUMBER;
    VQTCOMPL             NUMBER;
    VQTLOGRA_REDUZ       NUMBER;
    VQTCOMPL_REDUZ       NUMBER;
    VQTLOGRA_REDUZ_ABREV NUMBER;
    VQTNRIMOVEL          NUMBER;
    VLOGRA               VARCHAR2(50);
    VCOMPL               VARCHAR2(15);
    VLOGRA_REDUZ         VARCHAR2(50);
    VCOMPL_REDUZ         VARCHAR2(15);
    VLOGRA_REDUZ_ABREV   VARCHAR2(50);

    --VLOGRADOURO E VCOMPLEMENTO RECEBERAO OS CONTEUDOS DO ENDERECO E COMPLEMENTO APOS ANALISE DE TAMANHOS
    VLOGRADOURO  VARCHAR2(40);
    VCOMPLEMENTO VARCHAR2(10);
    VBAIRRO      VARCHAR2(25);

    --VARIAVIES QUE CONTROLAM O NUMERO MAXIMO DE REGISTROS NOS CAMPOS DE ENDERECO
    VQTLOGRADOURO  NUMBER := 40;
    VQTCOMPLEMENTO NUMBER := 10;

    CURSOR C_INTEGRA_CLIFOR IS
      SELECT CI.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
             CI.CDSITUACAO,
             CI.CDIDENTIFICADOR,
             CI.CDACAO,
             CI.NRSEQUENCIAL_ORIGEM
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'FN'
         AND CI.CDSITUACAO = PCDSITUACAO
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0);
    TTI_CONTROLE_INTEGRACAO TI_CONTROLE_INTEGRACAO%ROWTYPE;
    TFORNECEDOR             PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA%ROWTYPE;
    TGRUPO_DE_FORNECEDOR    GRUPO_DE_FORNECEDOR%ROWTYPE;
    TPESSOA                 PESSOA%ROWTYPE;
    TESTADO_CIVIL           ESTADO_CIVIL%ROWTYPE;
    TENDERECO               ENDERECO%ROWTYPE;
    TCIDADE                 PRODUCAO.CIDADE@UNICOO_HOMOLOGA%ROWTYPE;
    TTI_PESSOA              TI_PESSOA%ROWTYPE;
    TTI_GRUPO_DE_FORNECEDOR TI_GRUPO_DE_FORNECEDOR%ROWTYPE;
    TCDN_FORNECEDOR         TI_PESSOA.CDN_FORNECEDOR%TYPE;
  BEGIN
    FOR L_INTEGRA_CLIFOR IN C_INTEGRA_CLIFOR LOOP
      BEGIN
        PCDSITUACAO := 'RC';
        BEGIN
          SELECT *
            INTO TFORNECEDOR
            FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA
           WHERE CDFORNECEDOR = L_INTEGRA_CLIFOR.CDIDENTIFICADOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20100,
                                    'Forn. no unicoo nao encontrado: ' ||
                                    L_INTEGRA_CLIFOR.CDIDENTIFICADOR);
        END;
        BEGIN
          -----------------------------------------------------------------------
          -- Josias 01-07-2014 - Alteração para pegar o codigo do fornecedor do EMS
          -- que esta gravado na ti_pessoa e nao mais no fornecedor
          -----------------------------------------------------------------------
          SELECT P.CDN_FORNECEDOR
            INTO TCDN_FORNECEDOR
            FROM TI_PESSOA P
           WHERE P.NRREGISTRO = TFORNECEDOR.NRREGISTRO_FORNECEDOR;
        EXCEPTION
          WHEN OTHERS THEN
            RAISE_APPLICATION_ERROR(-20100,
                                    'Erro -> pessoa nao cadastrada para fornecedor na TI_PESSOA ' ||
                                    TFORNECEDOR.CDFORNECEDOR);
        END;
        BEGIN
          SELECT *
            INTO TGRUPO_DE_FORNECEDOR
            FROM GRUPO_DE_FORNECEDOR
           WHERE CDGRUPO_FORNECEDOR = TFORNECEDOR.CDGRUPO_FORNECEDOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20101,
                                    'Grupo do Forn. no unicoo nao encontrado: ' ||
                                    TFORNECEDOR.CDGRUPO_FORNECEDOR);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TPESSOA
            FROM PESSOA
           WHERE NRREGISTRO = TFORNECEDOR.NRREGISTRO_FORNECEDOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20102,
                                    'Cadastro de Pessoa do fornecor nao encontrado: ' ||
                                    L_INTEGRA_CLIFOR.CDIDENTIFICADOR);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TESTADO_CIVIL
            FROM ESTADO_CIVIL
           WHERE CDESTADOCIVIL = TPESSOA.CDESTADOCIVIL;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TENDERECO
            FROM ENDERECO
           WHERE NRREGISTRO = TPESSOA.NRREGISTRO
             AND TPENDERECO = F_TI_TIP_ENDERECO(TPESSOA.NRREGISTRO);
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            -- josias 29-06-2014
            -- coloquei para pegar o endereço da unimed como default
            --SELECT *
            --  INTO TENDERECO
            --  FROM ENDERECO
            -- WHERE NRREGISTRO = 9999999999
            --      F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO') VINICIUS NOVA IGUAÇU
            --  AND TPENDERECO = 'COBR';
            --     F_TI_TIP_ENDERECO(F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO'));
            --          raise_application_error(-20103,'Fornecedor sem endereco: '||l_integra_clifor.cdidentificador);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TCIDADE
            FROM PRODUCAO.CIDADE@UNICOO_HOMOLOGA
           WHERE CDCIDADE = TENDERECO.CDCIDADE;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            -- Josias 01-07-2014 - retirado esse erro, pois foi criado parametro para
            -- preenher o nome da cidades.
            --raise_application_error(-20104,'Cidade do fornecedor invalido: '||l_integra_clifor.cdidentificador);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TTI_GRUPO_DE_FORNECEDOR
            FROM TI_GRUPO_DE_FORNECEDOR
           WHERE CDGRUPO_FORNECEDOR =
                 TGRUPO_DE_FORNECEDOR.CDGRUPO_FORNECEDOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20104,
                                    'Grupo de fornecedor invalido: ' ||
                                    TGRUPO_DE_FORNECEDOR.CDGRUPO_FORNECEDOR);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TTI_PESSOA
            FROM TI_PESSOA
           WHERE NRREGISTRO = TPESSOA.NRREGISTRO;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20104,
                                    'Pessoa de integracao nao encontrado: ' ||
                                    TPESSOA.NRREGISTRO);
            NULL;
        END;
        begin
          select distinct 1
            into vlmatriz
            from ti_matriz_pagar v
           where v.nrregistro = tfornecedor.nrregistro_fornecedor;
        exception
          when no_data_found then
            vlmatriz := 0;
        end;

        --QTDE E CONTEUDOS DO ENDERECO
        VQTLOGRA             := LENGTH(TRIM(tendereco.nologradouro));
        VQTCOMPL             := LENGTH(TRIM(tendereco.txcomplemento));
        VQTLOGRA_REDUZ       := LENGTH(TRIM(F_REDUZ_END(tendereco.nologradouro,
                                                        0)));
        VQTCOMPL_REDUZ       := LENGTH(TRIM(F_REDUZ_COMPL(tendereco.txcomplemento,
                                                          0)));
        VQTLOGRA_REDUZ_ABREV := LENGTH(TRIM(F_REDUZ_END_ABREV(F_REDUZ_END(tendereco.nologradouro,
                                                                          0),
                                                              0)));
        VQTNRIMOVEL          := LENGTH(tendereco.nrimovel);
        VLOGRA               := TRIM(tendereco.nologradouro);
        VCOMPL               := NVL(TRIM(tendereco.txcomplemento), ' ');
        VLOGRA_REDUZ         := TRIM(F_REDUZ_END(tendereco.nologradouro, 0));
        VCOMPL_REDUZ         := TRIM(F_REDUZ_COMPL(tendereco.txcomplemento,
                                                   0));
        VLOGRA_REDUZ_ABREV   := TRIM(F_REDUZ_END_ABREV(F_REDUZ_END(tendereco.nologradouro,
                                                                   0),
                                                       0));

        --TRATATIVA DOS ENDEÇOES E LOGRADOUROS (21/10/2016)
        --COMPLEMENTO NULO OU ATÉ 10 E O LOGRADOURO + NRIMOVEL ATÉ 40
        --LINHAS 1 E 2 DA PLANILHA
        IF ((VCOMPL IS NULL OR LENGTH(VCOMPL) <= VQTCOMPLEMENTO) AND
           VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) <= VQTLOGRADOURO) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA;
          ELSE
            VLOGRADOURO := VLOGRA || ' ' || TENDERECO.NRIMOVEL;
          END IF;

          VCOMPLEMENTO := VCOMPL;

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '1', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DAS LINHAS 1 E 2
          --LOGRADOURO+NRIMOVEL ACIMA DE 40, PORÉM LOGRAD+IMOVEL REDUZ ATÉ 40 E O COMPLEMENTO ATÉ 10
          --LINHA 3 DA PLANILHA
        ELSIF (((VQTCOMPL <= VQTCOMPLEMENTO) OR (VQTCOMPL IS NULL)) AND
              VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) <= VQTLOGRADOURO) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA_REDUZ;
          ELSE
            VLOGRADOURO := VLOGRA_REDUZ || ' ' || TENDERECO.NRIMOVEL;
          END IF;

          VCOMPLEMENTO := VCOMPL;

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '3', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 3
          --COMPLEMENTO ACIMA DE 10, PORÉM COMPL REDUZ ATÉ 10 E O LOGRADOURO + NRIMOVEL ATÉ 40
          --LINHA 4 DA PLANILHA
        ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
              VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
              VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) <= VQTLOGRADOURO) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA;
          ELSE
            VLOGRADOURO := VLOGRA || ' ' || TENDERECO.NRIMOVEL;
          END IF;

          VCOMPLEMENTO := VCOMPL_REDUZ;

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '4', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 4
          --COMPLEMENTO ACIMA DE 10, PORÉM COMPL REDUZ ATÉ 10 E O LOGRADOURO + NRIMOVEL ACIMA DE 40, PORÉM LOGR+IMOVEL REDUZ ATÉ 40
          --LINHA 5 DA PLANILHA
        ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
              VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
              (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) > VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) <= VQTLOGRADOURO)) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA_REDUZ;
          ELSE
            VLOGRADOURO := VLOGRA_REDUZ || ' ' || TENDERECO.NRIMOVEL;
          END IF;

          VCOMPLEMENTO := VCOMPL_REDUZ;

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '5', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 5

          --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO + NRIMOVEL ATE 40
          --LINHA 6 DA PLANILHA
        ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
              VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
              (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) + 1 + VQTCOMPL_REDUZ <=
              VQTLOGRADOURO)) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA || '-' || VCOMPL_REDUZ;
          ELSE
            VLOGRADOURO := VLOGRA || ' ' || TENDERECO.NRIMOVEL || '-' ||
                           VCOMPL_REDUZ;
          END IF;

          VCOMPLEMENTO := ' ';

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '6', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 6
          --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO REDUZ + NRIMOVEL ATE 40
          --LINHA 7 DA PLANILHA
        ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
              VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
              (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) + 1 + VQTCOMPL_REDUZ >
              VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) + 1 +
              VQTCOMPL_REDUZ <= VQTLOGRADOURO)) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA_REDUZ || '-' || VCOMPL_REDUZ;
          ELSE
            VLOGRADOURO := VLOGRA_REDUZ || ' ' || TENDERECO.NRIMOVEL || '-' ||
                           VCOMPL_REDUZ;
          END IF;

          VCOMPLEMENTO := ' ';

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '7', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 7
          --COMPLEMENTO NULO OU ATÉ 10, LOGR REDUZ + NR ACIMA DE 40, PORÉM LOGRADOURO REDUZ E ABREV + NRIMOVEL ATE 40
          --LINHA 8 DA PLANILHA
        ELSIF ((VQTCOMPL <= VQTCOMPLEMENTO OR VCOMPL IS NULL) AND
              (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) > VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) > VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL + 1), 0) <=
              VQTLOGRADOURO)) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA_REDUZ_ABREV;
          ELSE
            VLOGRADOURO := VLOGRA_REDUZ_ABREV || ' ' || TENDERECO.NRIMOVEL;
          END IF;

          VCOMPLEMENTO := VCOMPL;

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 8

          --COMPLEMENTO ACIMA DE 10, PORÉM REDUZ ATÉ 10 E LOGR REDUZ + NR ACIMA DE 40, PORÉM LOGRADOURO REDUZ E ABREV + NRIMOVEL ATE 40
          --LINHA 9 DA PLANILHA
        ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
              VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
              (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) > VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) > VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL + 1), 0) <=
              VQTLOGRADOURO)) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA_REDUZ_ABREV;
          ELSE
            VLOGRADOURO := VLOGRA_REDUZ_ABREV || ' ' || TENDERECO.NRIMOVEL;
          END IF;

          VCOMPLEMENTO := VCOMPL_REDUZ;

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 9
          --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO REDUZ E ABREVIADO (ÚLTIMO RECURSO) + NRIMOVEL ATE 40
          --LINHA 10 DA PLANILHA
        ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
              VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
              (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) + 1 + VQTCOMPL_REDUZ >
              VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) + 1 +
              VQTCOMPL_REDUZ > VQTLOGRADOURO) AND
              (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL + 1), 0) + 1 +
              VQTCOMPL_REDUZ <= VQTLOGRADOURO)) THEN

          IF TENDERECO.NRIMOVEL IS NULL THEN
            VLOGRADOURO := VLOGRA_REDUZ_ABREV || '-' || VCOMPL_REDUZ;
          ELSE
            VLOGRADOURO := VLOGRA_REDUZ_ABREV || ' ' || TENDERECO.NRIMOVEL || '-' ||
                           VCOMPL_REDUZ;
          END IF;

          VCOMPLEMENTO := ' ';

          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          --FIM DA TRATATIVA DA LINHA 10
        else
          --*****ver se ficará
          --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '0', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

          VLOGRADOURO  := NULL;
          VCOMPLEMENTO := ' ';

          /*   -- ERRO - NAO ENTROU EM NENHUM DOS IFS ACIMA
              ELSIF ((LENGTH(TENDERECO.TXCOMPLEMENTO) > VQTCOMPLEMENTO AND LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0))> VQTCOMPLEMENTO) AND
                   ((LENGTH(TRIM(TENDERECO.NOLOGRADOURO)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
                   ((LENGTH(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
                   ((LENGTH(F_REDUZ_END_ABREV(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO)
                   ) THEN

                -- VER COM O VINI PARA GRAVAR FALHA NO PROCESSO
                VLOGRADOURO  := NULL;
                VCOMPLEMENTO := NULL;

                INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '9', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);
          */
        END IF;

        --VALIDACAO DO TAMANHO DO BAIRRO
        --SE NAO ENVIAR O BAIRRO COMPLETO, TENTA O REDUZIDO E POR ÚLTIMO TRUNCA
        VBAIRRO := '';

        IF LENGTH(TENDERECO.NOBAIRRO) > 20 THEN
          IF LENGTH(f_reduz_bairro(TENDERECO.NOBAIRRO, 0)) > 20 THEN
            VBAIRRO := SUBSTR(F_REDUZ_BAIRRO(TENDERECO.NOBAIRRO, 0), 1, 20); --20 POSICOES DO REDUZIDO
          ELSE
            VBAIRRO := f_reduz_bairro(TENDERECO.NOBAIRRO, 0); -- BAIRRO REDUZIDO
          END IF;
        ELSE
          VBAIRRO := TENDERECO.NOBAIRRO; -- BAIRRO INTEIRO
        END IF;

        --INSERT INTO END_MIGRA VALUES (VBAIRRO,NULL,TENDERECO.NOBAIRRO,NULL,NULL,NULL,TENDERECO.NRREGISTRO);

        --FINAL DA VERIFICACAO E TRATAMENTO DO ENDERECO

        if ((tti_grupo_de_fornecedor.cod_grp_fornecedor = 'NAOM') and
           (vlmatriz = 0)) then

          null;

        else

          INSERT INTO TI_FORNECEDOR
            (NRSEQ_CONTROLE_INTEGRACAO,
             NRSEQ_FAVORECIDO,
             CDSITUACAO,
             COD_ACAO,
             COD_AGENC_BCIA,
             COD_BANCO,
             COD_CEP,
             COD_CEP_PAGTO,
             COD_CTA_CORREN_BCO,
             COD_CX_POST,
             COD_CX_POST_PAGTO,
             COD_DIGITO_AGENC_BCIA,
             COD_DIGITO_CTA_CORREN,
             COD_E_MAIL,
             COD_EMPRESA,
             COD_FAX,
             COD_FORMA_PAGTO,
             COD_FORNECEDOR,
             COD_GRP_FORNECEDOR,
             COD_ID_ESTAD_FISIC,
             COD_ID_FEDER,
             COD_ID_FEDER_ESTAD_JURID,
             COD_ID_FEDER_JURID,
             COD_ID_FEDER_MATRIZ,
             COD_ID_FEDER_NASC,
             COD_ID_MUNIC_JURID,
             COD_ID_PREVID_SOCIAL,
             COD_ORG_EMIS_ID_ESTAD,
             COD_PAIS_NASC,
             COD_PORTAD_PREFER,
             COD_RAMAL_FAX,
             COD_TELEFONE_1,
             COD_TELEFONE_2,
             COD_TELEFONE_3,
             COD_TIP_FLUXO_FINANC,
             COD_TIP_FORNECEDOR,
             COD_UNID_FEDER,
             COD_UNID_FEDER_EMIS_ESTAD,
             COD_UNID_FEDER_PAGTO,
             DAT_ENVIO,
             DAT_IMPL_FORNECEDOR,
             DAT_NASCIMENTO,
             DAT_PROCESSAMENTO,
             DEST_ANOT_TABELA,
             IND_ESTADO_CIVIL,
             IND_OCORRENCIA,
             IND_TIPO_PESSOA,
             LOG_FINS_LUCRAT,
             NOM_ABREV,
             NOM_BAIRRO,
             NOM_BAIRRO_PAGTO,
             NOM_CIDADE,
             NOM_CIDADE_PAGTO,
             NOM_ENDER_COMPL,
             NOM_ENDER_COMPL_PAGTO,
             NOM_ENDERECO,
             NOM_ENDERECO_PAGTO,
             NOM_FORNECEDOR,
             NOM_HOME_PAGE,
             NOM_MAE,
             NOM_NACIONALIDADE,
             NOM_PROFISSAO,
             NRPESSOA)

          VALUES

            (L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO, -- nrseq_controle_integracao,
             0, --nrseq_favorecido,
             'RC', --cdsituacao,
             L_INTEGRA_CLIFOR.CDACAO, --cd cod_acao,
             ' ', --cod_agenc_bcia,
             ' ', --cod_banco,
             -- josias 29-06-2014
             -- coloquei o cep padrão de americana para evitar os erros.
             NVL(TENDERECO.NRCEP,
                 F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')), --cod_cep,
             NVL(TENDERECO.NRCEP,
                 F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')), --cod_cep_pagto,
             ' ', --cod_cta_corren_bco,
             ' ', --cod_cx_post,
             ' ', --cod_cx_post_pagto,
             ' ', --cod_digito_agenc_bcia,
             ' ', --cod_digito_cta_corren,
             nvl(substr(tendereco.cdemail, 1, 40), ' '), --cod_e_mail,
             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA'), --cod_empresa,
             ' ', --cod_fax,
             F_TI_PARAMETRO_INTEGRACAO('COD_FORMA_PAGTO'), --cod_forma_pagto,
             TCDN_FORNECEDOR, --cod_fornecedor,
             TTI_GRUPO_DE_FORNECEDOR.COD_GRP_FORNECEDOR, -- cod_grp_fornecedor,

             --F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_estad_fisic,
             NVL(TENDERECO.CDESTADO,
                 F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER')), --cod_id_estad_fisic,

             CASE WHEN TPESSOA.NRCGC_CPF IS NOT NULL THEN TPESSOA.NRCGC_CPF WHEN
             TPESSOA.TPPESSOA = 'F' THEN
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_PESSOA_FISICA') ELSE
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_PESSOA_JURIDICA') END, --cod_id_feder,
             --F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_feder_estad_jurid,
             CASE WHEN TPESSOA.TPPESSOA = 'J' THEN
             NVL(TPESSOA.NRINSCEST_RG, 'ISENTO') ELSE ' ' END, --cod_id_feder_estad_jurid
             NVL(TPESSOA.NRCGC_CPF, ' '), --cod_id_feder_jurid,
             ' ', --F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_feder_matriz,
             ' ', --F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_feder_nasc,
             ' ', --cod_id_munic_jurid,
             ' ', --cod_id_previd_social,
             NVL(TPESSOA.NOORGAO_EMISSOR_RG, ' '), --cod_org_emis_id_estad,
             F_TI_PARAMETRO_INTEGRACAO('COD_PAIS'), --cod_pais_nasc,
             DECODE(TPESSOA.TPPESSOA,
                    'F',
                    F_TI_PARAMETRO_INTEGRACAO('COD_PORTAD_PREFER_PESSOA_FISICA'),
                    F_TI_PARAMETRO_INTEGRACAO('COD_PORTAD_PREFER_PESSOA_JURIDICA')), --cod_portad_prefer,
             ' ', --cod_ramal_fax,
             ' ', --cod_telefone_1,
             ' ', --cod_telefone_2,
             ' ', --cod_telefone_3,

             --           F_TI_PARAMETRO_INTEGRACAO('COD_TIP_FLUXO_FINANC_PREFER_FOR'), --cod_tip_fluxo_financ,
             DECODE(TPESSOA.TPPESSOA,
                    'F',
                    F_TI_PARAMETRO_INTEGRACAO('COD_TIP_FLUXO_FINANC_PREFER_FOR_F'),
                    F_TI_PARAMETRO_INTEGRACAO('COD_TIP_FLUXO_FINANC_PREFER_FOR_J')), --cod_tip_fluxo_financ,

             999, --cod_tip_fornecedor,
             --F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_unid_feder,
             --F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_unid_feder_emis_estad,
             NVL(TENDERECO.CDESTADO,
                 F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER')), --COD_UNID_FEDER
             NVL(TENDERECO.CDESTADO,
                 F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER')), --COD_UNID_FEDER_EMIS_ESTAD

             ' ', --cod_unid_feder_pagto,
             SYSDATE, --dat_envio,
             F_TI_PARAMETRO_INTEGRACAO('DAT_IMPL_FORNECEDOR'), --dat_impl_fornecedor,
             TPESSOA.DTNASCIMENTO, --dat_nascimento,
             SYSDATE, --dat_processamento,

             -- O CAMPO DEST_ANOT_TABELA RECEBERÁ O ENDEREÇO COMPLETO (LOGRAD + NR + COMPL + BAIRRO
             -- PARA DEPOIS ENVIÁ-LO PARA O CAMPO NOM_ENDER_TEXT QUE NÃO EXISTE NA TI_FORNECEDOR
             -- O TI_FORNECEDOR.P (PROGRESS) FARÁ ESTA TRANSFERÊNCIA DE CONTEÚDO ENTRE ESTES CAMPOS
             -- NA A CHAMADA DA API
             'ENDERECO ORIGINAL: ' || CHR(13) ||
             TRIM(TENDERECO.NOLOGRADOURO) ||
             DECODE(TENDERECO.NRIMOVEL, NULL, '', ', ') ||
             DECODE(TENDERECO.NRIMOVEL, NULL, '', TENDERECO.NRIMOVEL) ||
             DECODE(TENDERECO.TXCOMPLEMENTO, NULL, '', ' - ') ||
             DECODE(TENDERECO.TXCOMPLEMENTO,
                    NULL,
                    '',
                    TRIM(TENDERECO.TXCOMPLEMENTO)) ||
             DECODE(TENDERECO.NOBAIRRO, NULL, '', ' - ') ||
             TENDERECO.NOBAIRRO ||
             DECODE(TENDERECO.CDEMAIL_ADICIONAL,
                    NULL,
                    '',
                    CHR(10) || CHR(13) || 'E-MAIL ADICIONAL:' || CHR(13) ||
                    TENDERECO.CDEMAIL_ADICIONAL), --dest_anot_tabela,

             ' ', --ind_estado_civil,
             0, --ind_ocorrencia,
             TPESSOA.TPPESSOA, --ind_tipo_pessoa,
             'S', --log_fins_lucrat,
             TTI_PESSOA.NOABREVIADO_FORNECEDOR, --nom_abrev,
             -- josias 29-06-2014

             /*
             SUBSTR(NVL(TENDERECO.NOBAIRRO,
                        ' '),--F_TI_PARAMETRO_INTEGRACAO('NOBAIRRO_DEFAULT_INCLUSAO')),
                    1,
                    20), --nom_bairro,
             SUBSTR(NVL(TENDERECO.NOBAIRRO,
                        ' '),--F_TI_PARAMETRO_INTEGRACAO('NOBAIRRO_DEFAULT_INCLUSAO')),
                    1,
                    20), --nom_bairro_pagto,
             */
             NVL(VBAIRRO,
                 F_TI_PARAMETRO_INTEGRACAO('NOBAIRRO_DEFAULT_INCLUSAO')), --NOM_BAIRRO
             NVL(VBAIRRO,
                 F_TI_PARAMETRO_INTEGRACAO('NOBAIRRO_DEFAULT_INCLUSAO')), --NOM_BAIRRO_PAGTO

             NVL(TRIM(TCIDADE.NOCIDADE),
                 F_TI_PARAMETRO_INTEGRACAO('NOCIDADE_DEFAULT_INCLUSAO')), --nom_cidade,
             NVL(TRIM(TCIDADE.NOCIDADE),
                 F_TI_PARAMETRO_INTEGRACAO('NOCIDADE_DEFAULT_INCLUSAO')), --nom_cidade_pagto,
             --NVL(SUBSTR(TENDERECO.TXCOMPLEMENTO, 1,10), ' '), --nom_ender_compl,
             --NVL(SUBSTR(TENDERECO.TXCOMPLEMENTO, 1,10), ' '), --nom_ender_compl_pagto,
             NVL(VCOMPLEMENTO, ' '), --NOM_ENDER_COMPL
             NVL(VCOMPLEMENTO, ' '), --NOM_ENDER_COMPL_PAGTO
             /*
             nvl2(replace(replace(replace(tendereco.nologradouro, ' ',''),',',''),'.',''),
             f_abrevia_nome(trim(tendereco.nologradouro)||decode(tendereco.nrimovel,null,null,','||
                            tendereco.nrimovel),40,'PEA')
                   ,'Sem Endereco'),                         --nom_endereco,
             NVL(TRIM(F_ABREVIA_NOME(TRANSLATE(TENDERECO.NOLOGRADOURO,
                                               '0123456789,.;:]',
                                               '              ') ||
                                     DECODE(TENDERECO.NRIMOVEL,
                                            NULL,
                                            NULL,
                                            ',' || TENDERECO.NRIMOVEL),
                                     40,
                                     'PEA')),
                 'Sem Endereco'), --nom_endereco,
             */

             /*
             decode(TRIM(TENDERECO.NOLOGRADOURO),NULL,NULL,
                                                 decode(TENDERECO.NRIMOVEL,NULL,TENDERECO.NOLOGRADOURO,
                                                                           TENDERECO.NOLOGRADOURO || ', ' || TENDERECO.NRIMOVEL)), --NOM_ENDERECO


             decode(TRIM(TENDERECO.NOLOGRADOURO),NULL,NULL,
                                                 decode(TENDERECO.NRIMOVEL,NULL,TENDERECO.NOLOGRADOURO,
                                                                           TENDERECO.NOLOGRADOURO || ', ' || TENDERECO.NRIMOVEL)), --NOM_ENDERECO_PAGTO

             */
             NVL(VLOGRADOURO,
                 F_TI_PARAMETRO_INTEGRACAO('NOLOGRADOURO_DEFAULT_INCLUSAO')), --NOM_ENDERECO
             NVL(VLOGRADOURO,
                 F_TI_PARAMETRO_INTEGRACAO('NOLOGRADOURO_DEFAULT_INCLUSAO')), --NOM_ENDERECO_PAGTO

             --             NVL(TRIM(TENDERECO.NOLOGRADOURO), 'Sem endereço'), --nom_endereco_pagto,

             TPESSOA.NOPESSOA, --nom_fornecedor,
             ' ', --nom_home_page,
             -- Josias - 29-06-2014
             -- coloquei o truncamento pois estava estourando mais de 40 posições.
             F_ABREVIA_NOME(TPESSOA.NOMAE, 40, ''), --nom_mae,
             ' ', --F_TI_PARAMETRO_INTEGRACAO('NOM_NACIONALIDADE'), --nom_nacionalidade,
             NULL, --nom_profissao,
             TFORNECEDOR.NRREGISTRO_FORNECEDOR --nrpessoa
             );

          IF SQL%ROWCOUNT = 0 THEN
            P_TI_VALIDA_ENDERECO(L_INTEGRA_CLIFOR.NRSEQUENCIAL_ORIGEM,
                                 L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                                 'TI_FORNECEDOR',
                                 PCDSITUACAO);
            IF PCDSITUACAO = 'RC' THEN
              P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                            'TI_FORNECEDOR',
                            'A VIEW V_TI_FORNECEDOR NO ENCONTROU FORNECEDOR PARA O PROCESSO ==>' ||
                            L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO ||
                            'Pessoa ==>' ||
                            L_INTEGRA_CLIFOR.NRSEQUENCIAL_ORIGEM ||
                            'Fornecedor ==> ' ||
                            L_INTEGRA_CLIFOR.CDIDENTIFICADOR,
                            NULL,
                            PCDSITUACAO,
                            NULL);
            END IF;
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                        'TI_FORNECEDOR',
                        'O Fornecedor j foi enviado para a TI_FORNECEDOR',
                        NULL,
                        PCDSITUACAO,
                        -1);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        'TI_FORNECEDOR',
                        'Falha:  ' || SQLERRM,
                        ' Processo ==> ' ||
                        L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO ||
                        '  Pessoa ==> ' ||
                        L_INTEGRA_CLIFOR.NRSEQUENCIAL_ORIGEM ||
                        '  Fornecedor ==> ' ||
                        L_INTEGRA_CLIFOR.CDIDENTIFICADOR,
                        PCDSITUACAO,
                        NULL);

      END;

      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  --===============================--
  -- Grava Titulo - TI_TIT_ACR --
  -----------------------------------
  PROCEDURE P_TI_TIT_ACR_ESTORNO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PNRDOCUMENTO               VARCHAR2,
                                 PCDSITUACAO                IN OUT VARCHAR2,
                                 PNRSESSAO                  NUMBER) IS
    CURSOR C_FATURA IS
      SELECT CI.*, FT.DTCANCELAMENTO
        FROM TI_CONTROLE_INTEGRACAO CI, FATURAMENTO FT
       WHERE CI.TPINTEGRACAO = 'FT'
         AND FT.NRFATURA = CI.CDIDENTIFICADOR
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND CDSITUACAO = 'VD'
         AND CI.NRSESSAO = PNRSESSAO;
    CURSOR C_EMS(PNRDOCUMENTO VARCHAR2) IS
      SELECT EMS.NUM_ID_TIT_ACR, EMS.NRDOCUMENTO
        FROM EMS_MOVIMENTO_TITULO_ACR EMS, TITULO_A_RECEBER TR, TIT_ACR TA
       WHERE TA.U##COD_ESTAB = EMS.COD_ESTAB
         AND TA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
         AND TR.NRDOCUMENTO = PNRDOCUMENTO
         AND TR.NRDOCUMENTO = EMS.NRDOCUMENTO
         AND EMS.NRREGISTRO_TITULO = TR.NRREGISTRO_TITULO
         AND EMS.IND_TRANS_ACR_ABREV = 'IMPL'
         AND TA.LOG_TIT_ACR_ESTORDO = 0;
    VCDINTEGRACAO    VARCHAR2(100);
    VCOD_ESPEC_DOCTO TI_TIPO_MOVIMENTO_TIT_ACR.COD_ESPEC_DOCTO%TYPE;
    VAOACHOU         BOOLEAN;
  BEGIN
    VCDINTEGRACAO := 'TI_TIT_ACR_ESTORNO';
    PCDSITUACAO   := 'ER';
    FOR L_FATURA IN C_FATURA LOOP
      VAOACHOU := FALSE;
      FOR L_EMS IN C_EMS(L_FATURA.CDIDENTIFICADOR) LOOP
        PCDSITUACAO := 'RC';
        VAOACHOU    := TRUE;
        BEGIN
          INSERT INTO TI_TIT_ACR_ESTORNO
            (NRSEQ_CONTROLE_INTEGRACAO,
             CDSITUACAO,
             NRDOCUMENTO,
             COD_ESTAB,
             COD_ESPEC_DOCTO,
             COD_SER_DOCTO,
             COD_TIT_ACR,
             COD_PARCELA,
             COD_TIT_ACR_BCO,
             COD_REFER,
             NUM_ID_MOVTO_TIT_ACR,
             NUM_ID_TIT_ACR,
             COD_PORTADOR,
             DAT_TRANSACAO,
             DAT_ENVIO,
             CDN_CLIENTE,
             DAT_PROCESSAMENTO,
             IND_NIV_OPERAC_ACR,
             IND_TIP_OPERAC_ACR)
            SELECT L_FATURA.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
                   CDSITUACAO,
                   L_FATURA.CDIDENTIFICADOR NRDOCUMENTO,
                   COD_ESTAB,
                   COD_ESPEC_DOCTO,
                   COD_SER_DOCTO,
                   COD_TIT_ACR,
                   COD_PARCELA,
                   COD_TIT_ACR_BCO,
                   'E' || LPAD(L_FATURA.NRSEQUENCIAL, 9, '0'),
                   NUM_ID_MOVTO_TIT_ACR,
                   NUM_ID_TIT_ACR,
                   COD_PORTADOR,
                   L_FATURA.DTCANCELAMENTO DAT_TRANSACAO,
                   DAT_ENVIO,
                   CDN_CLIENTE,
                   DAT_PROCESSAMENTO,
                   IND_NIV_OPERAC_ACR,
                   IND_TIP_OPERAC_ACR
              FROM V_TI_TIT_ACR_ESTORNO TA
             WHERE TA.NUM_ID_TIT_ACR = L_EMS.NUM_ID_TIT_ACR;
          IF SQL%ROWCOUNT = 0 THEN
            P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Dados no encontrados na V_ti_tit_acr_estorno PARA O PROCESSO ' ||
                          L_FATURA.NRSEQUENCIAL || ' Especie: ' ||
                          VCOD_ESPEC_DOCTO || ' Srie: ' ||
                          SUBSTR(L_FATURA.CDIDENTIFICADOR, 1, 2) ||
                          'Titulo :' ||
                          SUBSTR(L_FATURA.CDIDENTIFICADOR,
                                 INSTR(L_FATURA.CDIDENTIFICADOR, '-') + 1,
                                 12),
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        EXCEPTION
          WHEN DUP_VAL_ON_INDEX THEN
            P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'A fatura j foi enviada para estorno. Processo ==>' ||
                          L_FATURA.NRSEQUENCIAL,
                          NULL,
                          PCDSITUACAO,
                          -1);
          WHEN OTHERS THEN
            P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Erro ao enviar fatura para cancelamento. Processo ==>' ||
                          L_FATURA.NRSEQUENCIAL || ' ' || SQLERRM,
                          NULL,
                          PCDSITUACAO,
                          NULL);
        END;
        --====================================--
        -- Atualizar o situao da integrao --
        ----------------------------------------
        P_UPDATE_CONTROLE_INTEGRACAO(L_FATURA.NRSEQUENCIAL,
                                     PCDSITUACAO,
                                     NULL);
      END LOOP;
      IF NOT VAOACHOU THEN
        P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                      VCDINTEGRACAO,
                      'O titulo no EMS5==> ' || L_FATURA.CDIDENTIFICADOR || ' ' ||
                      L_FATURA.NRSEQUENCIAL || ' ' || SQLERRM,
                      NULL,
                      PCDSITUACAO,
                      NULL);
      END IF;
      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_FATURA.NRSEQUENCIAL,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
    -- Alessandro 19/03/2012
    FOR XX IN (SELECT T.NRDOCUMENTO,
                      T.NUM_ID_TIT_ACR,
                      MT.LOG_APROP_CTBL_CTBZDA,
                      T.NRSEQ_CONTROLE_INTEGRACAO
                 FROM TI_TIT_ACR_ESTORNO T, TIT_ACR TA, MOVTO_TIT_ACR MT
                WHERE MT.U##COD_ESTAB = TA.U##COD_ESTAB
                  AND MT.NUM_ID_TIT_ACR = TA.NUM_ID_TIT_ACR
                  AND MT.IND_TRANS_ACR_ABREV = 'IMPL'
                  AND TA.NUM_ID_TIT_ACR = T.NUM_ID_TIT_ACR
                  AND T.CDSITUACAO IN ('ER', 'RC')
               --and mt.LOG_APROP_CTBL_CTBZDA = 1
               ) LOOP
      IF XX.LOG_APROP_CTBL_CTBZDA = 1 THEN
        UPDATE TI_TIT_ACR_ESTORNO Q
           SET Q.CDSITUACAO = 'RC'
         WHERE Q.NRSEQ_CONTROLE_INTEGRACAO = XX.NRSEQ_CONTROLE_INTEGRACAO;
        P_UPDATE_CONTROLE_INTEGRACAO(XX.NRSEQ_CONTROLE_INTEGRACAO,
                                     'RC',
                                     '');
      ELSE
        UPDATE TI_TIT_ACR_ESTORNO Q
           SET Q.CDSITUACAO = 'ER'
         WHERE Q.NRSEQ_CONTROLE_INTEGRACAO = XX.NRSEQ_CONTROLE_INTEGRACAO;
        P_UPDATE_CONTROLE_INTEGRACAO(XX.NRSEQ_CONTROLE_INTEGRACAO,
                                     'ER',
                                     'Titulo nao CTBL EMS5');
        P_GRAVA_FALHA(XX.NRSEQ_CONTROLE_INTEGRACAO,
                      'FAT_CANCEL',
                      'Fatura Cancelada no Unicoo, e n?o CTBLZ no EMS5',
                      'Contabilize o ACR no EMS5',
                      PCDSITUACAO,
                      NULL);
      END IF;
    END LOOP;
    -- Alessandro 19/03/2012
  END;

  --===============================--
  -- Grava Titulo - TI_TIT_ACR --
  -----------------------------------
  PROCEDURE P_TI_TIT_ACR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_TRATA_FALHA IS
      SELECT DISTINCT UCL.CDCLIENTE,
                      TIP.CDN_CLIENTE,
                      UCL.NRREGISTRO_CLIENTE,
                      CI.CDEMPRESA,
                      CI.CDMODULO,
                      CI.CDMOVIMENTO,
                      ECL.COD_GRP_CLIEN,
                      (SELECT COUNT(*)
                         FROM ENDERECO ED
                        WHERE ED.NRREGISTRO = UCL.NRREGISTRO_CLIENTE) QTENDERECO,
                      F_TI_TIP_MOVTO_TIT_ACR(CI.CDEMPRESA,
                                             CI.CDMODULO,
                                             CI.CDMOVIMENTO,
                                             ECL.COD_GRP_CLIEN) NUM_TIP_MOVTO_TIT_ACR
        FROM TITULO_A_RECEBER                 TR,
             TI_CONTROLE_INTEGRACAO           CI,
             PRODUCAO.CLIENTE@UNICOO_HOMOLOGA UCL,
             CLIENTE                          ECL,
             TI_PESSOA                        TIP,
             TI_EMPRESA                       EMP
       WHERE ECL.CDN_CLIENTE(+) = TIP.CDN_CLIENTE
         AND CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO
         AND TR.NRREGISTRO_TITULO = CI.NRSEQUENCIAL_ORIGEM
         AND TIP.NRREGISTRO(+) = UCL.NRREGISTRO_CLIENTE
         AND TR.CDCLIENTE = UCL.CDCLIENTE
         AND CI.CDEMPRESA = EMP.CDEMPRESA
         AND NVL(ECL.COD_EMPRESA, EMP.COD_EMPRESA) = EMP.COD_EMPRESA;
    CURSOR C_TITULOS IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TR'
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
            --and cdsituacao = 'VD'
         AND CI.NRSESSAO = PNRSESSAO;
    VCDINTEGRACAO  VARCHAR2(100);
    VAO_ACHOU_ERRO BOOLEAN;
  BEGIN
    FOR L_TITULOS IN C_TITULOS LOOP
      BEGIN
        PCDSITUACAO   := 'RC';
        VCDINTEGRACAO := 'TI_TIT_ACR';
        INSERT INTO TI_TIT_ACR
          (COD_ESTAB,
           COD_TITULO_ACR,
           VAL_IR,
           DAT_DESCONTO,
           VAL_LIQ_TITULO,
           DES_TEXT_HISTOR,
           IND_OCORRENCIA,
           NRSEQ_CONTROLE_INTEGRACAO,
           IND_TIPO_PESSOA,
           COD_ID_FEDER_JURID,
           COD_ID_FEDER,
           COD_ESPEC_DOCTO,
           COD_PARCELA,
           DAT_EMISSAO,
           DAT_VENCTO,
           DAT_PREVISAO_LIQUIDAC,
           VAL_TITULO,
           COD_CART_BCIA,
           DAT_PROCESSAMENTO,
           COD_EMPRESA,
           COD_TIP_FLUXO_FINANC,
           COD_PAIS,
           COD_CTA_CTBL,
           COD_CCUSTO,
           VAL_DESCONTO,
           COD_TIT_ACR_BCO,
           COD_PORTADOR,
           COD_SER_DOCTO,
           IND_TIP_ESPEC_DOCTO,
           CDSITUACAO,
           COD_CLIENTE,
           NRPESSOA,
           COD_PLANO_CCUSTO,
           COD_PLANO_CTA_CTBL,
           VAL_PERC_JUROS_DIA_ATRASO,
           VAL_PERC_MULTA_ATRASO)
          SELECT COD_ESTAB,
                 COD_TITULO_ACR,
                 VAL_IR,
                 DAT_DESCONTO,
                 VAL_LIQ_TITULO,
                 DES_TEXT_HISTOR,
                 IND_OCORRENCIA,
                 NRSEQ_CONTROLE_INTEGRACAO,
                 IND_TIPO_PESSOA,
                 COD_ID_FEDER_JURID,
                 COD_ID_FEDER,
                 COD_ESPEC_DOCTO,
                 COD_PARCELA,
                 DAT_EMISSAO,
                 DAT_VENCTO,
                 DAT_PREVISAO_LIQUIDAC,
                 VAL_TITULO,
                 COD_CART_BCIA,
                 DAT_PROCESSAMENTO,
                 COD_EMPRESA,
                 COD_TIP_FLUXO_FINANC,
                 COD_PAIS,
                 COD_CTA_CTBL,
                 COD_CCUSTO,
                 VAL_DESCONTO,
                 COD_TIT_ACR_BCO,
                 COD_PORTADOR,
                 COD_SER_DOCTO,
                 IND_TIP_ESPEC_DOCTO,
                 CDSITUACAO,
                 COD_CLIENTE,
                 NRPESSOA,
                 COD_PLANO_CCUSTO,
                 COD_PLANO_CTA_CTBL,
                 0                         VAL_PERC_JUROS_DIA_ATRASO,
                 0                         VAL_PERC_MULTA_ATRASO
            FROM V_TI_TIT_ACR TIT
           WHERE TIT.NRSEQ_CONTROLE_INTEGRACAO = L_TITULOS.NRSEQUENCIAL;
        IF SQL%ROWCOUNT = 0 THEN
          VAO_ACHOU_ERRO := FALSE;
          /* p_grava_falha(l_titulos.nrsequencial,
          vCDIntegracao,
          'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
          l_titulos.nrsequencial,
          'A view V_TI_TIT_ACR nao encontrou registro',
          pCDSituacao,
          null);*/
          FOR L_TRATA_FALHA IN C_TRATA_FALHA LOOP
            VAO_ACHOU_ERRO := TRUE;
            IF L_TRATA_FALHA.CDN_CLIENTE IS NULL THEN
              -- Fazer a geração do Cliente para poder reprocessar o titulo depois
              ------------------------------------------------------------------------
              P_INSERE_CLIENTE(L_TITULOS.NRSEQUENCIAL_ORIGEM);
              ------------------------------------------------------------------------
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            'Falta integrar o cliente ' ||
                            L_TRATA_FALHA.CDN_CLIENTE || ' para o ',
                            PCDSITUACAO,
                            NULL);
            ELSIF L_TRATA_FALHA.QTENDERECO IS NULL THEN
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            'O Cliente ' || L_TRATA_FALHA.CDCLIENTE ||
                            ' nao foi integrado para o EMS5, o cliente no possui endereco no Unicoo.',
                            PCDSITUACAO,
                            NULL);
            ELSIF L_TRATA_FALHA.NUM_TIP_MOVTO_TIT_ACR = '-1' THEN
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            ' Tipo de movimento no cadastrado em TI_TIPO_MOVIMENTO_TIT_ACR, parametros informados: ' ||
                            ' Cdigo da Empresa: ' ||
                            L_TRATA_FALHA.CDEMPRESA || ' Cdigo do mdulo: ' ||
                            L_TRATA_FALHA.CDMODULO ||
                            ' Cdigo do movimento: ' ||
                            L_TRATA_FALHA.CDMOVIMENTO ||
                            ' Grupo de cliente no EMS5: ' ||
                            L_TRATA_FALHA.COD_GRP_CLIEN ||
                            ' Cdigo de cliente no EMS5: ' ||
                            L_TRATA_FALHA.CDN_CLIENTE,
                            PCDSITUACAO,
                            NULL);
            ELSE
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            NULL,
                            PCDSITUACAO,
                            NULL);
            END IF;
          END LOOP;
          IF VAO_ACHOU_ERRO = FALSE THEN
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                          L_TITULOS.NRSEQUENCIAL ||
                          '. Titulo ou cliente no existe no Unicoo',
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        ELSE
          VCDINTEGRACAO := 'TI_TIT_ACR_CTBL';
          INSERT INTO TI_TIT_ACR_CTBL CTB
            (VAL_APROP_CTBL,
             COD_ESTAB,
             COD_CTA_CTBL,
             COD_UNID_FEDERAC,
             COD_TIP_FLUXO_FINANC,
             NRSEQ_CONTROLE_INTEGRACAO,
             CDSITUACAO,
             COD_CCUSTO,
             DAT_PROCESSAMENTO)
            (SELECT VAL_APROP_CTBL,
                    COD_ESTAB,
                    COD_CTA_CTBL,
                    COD_UNID_FEDERAC,
                    COD_TIP_FLUXO_FINANC,
                    NRSEQ_CONTROLE_INTEGRACAO,
                    CDSITUACAO,
                    COD_CCUSTO,
                    DAT_PROCESSAMENTO
               FROM V_TI_TIT_ACR_CTBL CTB
              WHERE CTB.NRSEQ_CONTROLE_INTEGRACAO = L_TITULOS.NRSEQUENCIAL);
          IF SQL%ROWCOUNT = 0 THEN
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'A view V_ti_TIT_ACR_ctbl no encontrou registro para o processo ==>' ||
                          L_TITULOS.NRSEQUENCIAL,
                          NULL,
                          PCDSITUACAO,
                          NULL);
          ELSE
            VCDINTEGRACAO := 'TI_TIT_ACR_CTBL_IMPOSTO';
            INSERT INTO TI_TIT_ACR_IMPOSTO
              (COD_SER_DOCTO,
               IND_CLAS_IMPTO,
               VAL_RENDTO_TRIBUT,
               VAL_ALIQ_IMPTO,
               COD_ESTAB,
               COD_ESPEC_DOCTO,
               COD_PARCELA,
               COD_UNID_FEDERAC,
               COD_IMPOSTO,
               COD_CLASSIF_IMPTO,
               VAL_IMPOSTO,
               DAT_PROCESSAMENTO,
               CDSITUACAO,
               NRSEQ_CONTROLE_INTEGRACAO,
               IND_OCORRENCIA)
              (SELECT COD_SER_DOCTO,
                      IND_CLAS_IMPTO,
                      VAL_RENDTO_TRIBUT,
                      VAL_ALIQ_IMPTO,
                      COD_ESTAB,
                      COD_ESPEC_DOCTO,
                      COD_PARCELA,
                      COD_UNID_FEDERAC,
                      COD_IMPOSTO,
                      COD_CLASSIF_IMPTO,
                      VAL_IMPOSTO,
                      DAT_PROCESSAMENTO,
                      CDSITUACAO,
                      NRSEQ_CONTROLE_INTEGRACAO,
                      IND_OCORRENCIA
                 FROM V_TI_TIT_ACR_IMPOSTO IP
                WHERE IP.NRSEQ_CONTROLE_INTEGRACAO =
                      PNRSEQ_CONTROLE_INTEGRACAO);
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                        VCDINTEGRACAO,
                        'Titulo ja enviado. Processo ==>' ||
                        L_TITULOS.NRSEQUENCIAL,
                        NULL,
                        PCDSITUACAO,
                        -1);
          /*   when others then
          p_grava_falha(l_titulos.nrsequencial,
                          vCDIntegracao,
                          sqlerrm,
                          null,
                          pcdsituacao,
                          null);*/

          P_COMMIT;

      END;

      P_COMMIT;

      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_TITULOS.NRSEQUENCIAL,
                                   PCDSITUACAO,
                                   NULL);
      --=====================================--
      -- Titulo de Cooperados n?o trata falha,
      -- apenas cancela...
      -----------------------------------------
      IF SUBSTR(L_TITULOS.CDIDENTIFICADOR, 1, 3) = '9956-' THEN
        --braz
        P_UPDATE_CONTROLE_INTEGRACAO(L_TITULOS.NRSEQUENCIAL, --comentado emmaio de 2013 para tratar via arquivo gerado para baixa em lote pelo ems5
                                     'CA',
                                     NULL);
      END IF;
    END LOOP;
  END;

  --============================================--
  -- Grava Titulo a pagar - TI_TIT_APB      --
  --                        TI_TIT_APB_CTBL --
  ------------------------------------------------
  PROCEDURE P_TI_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_TRATA_FALHA IS
      SELECT DISTINCT EFN.CDN_FORNECEDOR CDFORNECEDOR,
                      TIP.CDN_FORNECEDOR CDFORNECEDOR_EMS5,
                      UFN.NRREGISTRO_FORNECEDOR,
                      CI.CDIDENTIFICADOR,
                      CI.CDEMPRESA,
                      CI.CDMODULO,
                      CI.CDMOVIMENTO,
                      EFN.CDN_FORNECEDOR,
                      EFN.COD_GRP_FORNEC,
                      CI.CDDIVISAO,
                      (SELECT COUNT(*)
                         FROM ENDERECO ED
                        WHERE ED.NRREGISTRO = UFN.NRREGISTRO_FORNECEDOR) QTENDERECO,
                      F_TI_TIP_MOVTO_TIT_APB(CI.CDEMPRESA,
                                             CI.CDMODULO,
                                             CI.CDMOVIMENTO,
                                             EFN.COD_GRP_FORNEC,
                                             CI.CDDIVISAO,
                                             CI.CDCENTRO_CUSTO) NUM_TIP_MOVTO_TIT_APB,
                      PE.NOPESSOA NOFORNECEDORUNICOO
        FROM TITULO_A_PAGAR                      TP,
             TI_CONTROLE_INTEGRACAO              CI,
             PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA UFN,
             PESSOA                              PE,
             FORNECEDOR                          EFN,
             TI_PESSOA                           TIP,
             TI_EMPRESA                          EMP
       WHERE CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO
         AND TP.NRREGISTRO_TITULO = CI.NRSEQUENCIAL_ORIGEM
         AND TP.CDFORNECEDOR = UFN.CDFORNECEDOR
         AND UFN.NRREGISTRO_FORNECEDOR = PE.NRREGISTRO
         AND TIP.NRREGISTRO = UFN.NRREGISTRO_FORNECEDOR
         AND EFN.CDN_FORNECEDOR = TIP.CDN_FORNECEDOR
         AND EFN.COD_EMPRESA = EMP.COD_EMPRESA
         AND EMP.CDEMPRESA =
             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
    CURSOR C_TITULOS IS
      SELECT CI.*
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TP'
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND CI.NRSESSAO = PNRSESSAO;
    VCDINTEGRACAO           VARCHAR2(100);
    VAO_ACHOU_ERRO          BOOLEAN;
    RTI_TIT_APB_CTBL        TI_TIT_APB_CTBL%ROWTYPE;
    RTI_CONTROLE_INTEGRACAO TI_CONTROLE_INTEGRACAO%ROWTYPE;
    RFORNECEDOR             EMS506UNICOO.TI_PESSOA%ROWTYPE;
    RFORNECEDOR_EMS         FORNECEDOR%ROWTYPE;
    VCOD_ESTAB              TI_TIPO_MOVIMENTO_TIT_APB.CDDIVISAO%TYPE;
    HAFALHA                 BOOLEAN;
  BEGIN
    FOR L_TITULOS IN C_TITULOS LOOP
      BEGIN
        HAFALHA       := FALSE;
        VCDINTEGRACAO := 'TI_TIT_APB';
        -- tratativas de erro
        BEGIN
          SELECT *
            INTO RTI_CONTROLE_INTEGRACAO
            FROM TI_CONTROLE_INTEGRACAO
           WHERE NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            HAFALHA := TRUE;
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Controle integracão não encontrado',
                          NULL,
                          PCDSITUACAO,
                          NULL);
        END;
        BEGIN
          SELECT B.*
            INTO RFORNECEDOR
            FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA A,
                 EMS506UNICOO.TI_PESSOA              B
           WHERE A.NRREGISTRO_FORNECEDOR = B.NRREGISTRO
             AND CDFORNECEDOR =
                 (SELECT FO.CDFORNECEDOR
                    FROM TITULO_A_PAGAR                      TP,
                         PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FO
                   WHERE FO.CDFORNECEDOR = TP.CDFORNECEDOR
                     AND TP.NRREGISTRO_TITULO =
                         RTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM);
          IF RFORNECEDOR.CDN_FORNECEDOR IS NULL THEN
            -- Fazer a geração do fornecedor para poder reprocessar o titulo depois
            ------------------------------------------------------------------------
            P_INSERE_FORNECEDOR(RTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM);
            ------------------------------------------------------------------------
          END IF;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            -- Fazer a geração do fornecedor para poder reprocessar o titulo depois
            ------------------------------------------------------------------------
            P_INSERE_FORNECEDOR(RTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM);
            ------------------------------------------------------------------------
            HAFALHA := TRUE;
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Fornecedor não integrado com TOTVS11, aguardar a integração do fornecedor !! ',
                          NULL,
                          PCDSITUACAO,
                          NULL);
        END;
        IF L_TITULOS.CDDIVISAO IS NOT NULL THEN
          BEGIN
            SELECT ET.COD_ESTAB
              INTO VCOD_ESTAB
              FROM TI_ESTABELECIMENTO ET
             WHERE ET.CDDIVISAO = L_TITULOS.CDDIVISAO;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              HAFALHA := TRUE;
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'Falta o De-Para do unicoo para a Divisão [' ||
                            L_TITULOS.CDDIVISAO ||
                            ' ] na tabela TI_ESTABELECIMENTO ',
                            'Empresa[' || L_TITULOS.CDEMPRESA || '] ' ||
                            'Modulo[' || L_TITULOS.CDMODULO || '] ' ||
                            'Movimento[' ||
                            RPAD(L_TITULOS.CDMOVIMENTO, 5, ' ') || '] ' ||
                            'Divisão [' || L_TITULOS.CDDIVISAO || '] ' ||
                            'Verifique na tabela de vinculo , qual é o estabelecimento para a divisão ' ||
                            L_TITULOS.CDDIVISAO,
                            PCDSITUACAO,
                            NULL);
          END;
        END IF;
        BEGIN
          SELECT EFN.*
            INTO RFORNECEDOR_EMS
            FROM FORNECEDOR EFN, TI_EMPRESA EMP
           WHERE CDN_FORNECEDOR = RFORNECEDOR.CDN_FORNECEDOR
             AND EFN.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            HAFALHA := TRUE;
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Fornecedor do ems não encontrado. _ ',
                          'Registro do Fornecedor no uicoo: ' ||
                          RFORNECEDOR.NRREGISTRO,
                          PCDSITUACAO,
                          NULL);
        END;
        -- colocado por fabiano
        IF NOT HAFALHA THEN
          PCDSITUACAO   := 'RC';
          VCDINTEGRACAO := 'TI_TIT_APB';
          BEGIN
            INSERT INTO TI_TIT_APB
              (COD_TITULO_AP,
               VAL_PER_DESC,
               COD_CART_BCIA,
               DAT_PROCESSAMENTO,
               COD_TIP_FLUXO_FINANC,
               CDN_FORNECEDOR,
               QTD_PARCELA,
               IND_TIPO_PESSOA,
               COD_SER_DOCTO,
               COD_PARCELA,
               VAL_DESCONTO,
               DES_TEXT_HISTOR,
               CDSITUACAO,
               COD_CCUSTO,
               COD_ID_FEDER_JURID,
               COD_ESPEC_DOCTO,
               DAT_EMISSAO,
               DAT_VENCTO,
               DAT_PREVISAO_PAGTO,
               DAT_DESCONTO,
               VAL_TITULO,
               NUM_DIAS_ATRASO,
               VAL_JUROS,
               VAL_PERC_JUROS_DIA_ATRASO,
               VAL_PERC_MULTA_ATRASO,
               COD_PORTADOR,
               COD_FORMA_PAGTO,
               COD_EMPRESA,
               COD_ESTAB,
               NRSEQ_CONTROLE_INTEGRACAO,
               COD_ID_FEDER,
               IND_OCORRENCIA,
               NRREGISTRO_TITULO,
               NRPESSOA,
               COD_PLANO_CCUSTO,
               COD_PLANO_CTA_CTBL)
              SELECT COD_TITULO_AP,
                     VAL_PER_DESC,
                     COD_CART_BCIA,
                     DAT_PROCESSAMENTO,
                     COD_TIP_FLUXO_FINANC,
                     CDFORNECEDOR_EMS5,
                     QTD_PARCELA,
                     IND_TIPO_PESSOA,
                     COD_SER_DOCTO,
                     COD_PARCELA,
                     VAL_DESCONTO,
                     DES_TEXT_HISTOR,
                     CDSITUACAO,
                     COD_CCUSTO,
                     COD_ID_FEDER COD_ID_FEDER_JURID,
                     COD_ESPEC_DOCTO,
                     DAT_EMISSAO,
                     DAT_VENCTO,
                     DAT_PREVISAO_PAGTO,
                     DAT_DESCONTO,
                     VAL_BRUTO,
                     NUM_DIAS_ATRASO,
                     VAL_JUROS,
                     VAL_PERC_JUROS_DIA_ATRASO,
                     VAL_PERC_MULTA_ATRASO,
                     COD_PORTADOR,
                     COD_FORMA_PAGTO,
                     COD_EMPRESA,
                     COD_ESTAB,
                     NRSEQ_CONTROLE_INTEGRACAO,
                     COD_ID_FEDER,
                     IND_OCORRENCIA,
                     NRREGISTRO_TITULO,
                     NRPESSOA,
                     COD_PLANO_CCUSTO,
                     COD_PLANO_CTA_CTBL
                FROM V_TI_TIT_APB TIT
               WHERE TIT.NRSEQ_CONTROLE_INTEGRACAO =
                     PNRSEQ_CONTROLE_INTEGRACAO;
          EXCEPTION
            WHEN OTHERS THEN
              RAISE_APPLICATION_ERROR(-20100, 'Erro -> ' || SQLERRM);
          END;
          IF SQL%ROWCOUNT = 0 THEN
            VAO_ACHOU_ERRO := FALSE;
            FOR L_TRATA_FALHA IN C_TRATA_FALHA LOOP
              VAO_ACHOU_ERRO := TRUE;
              IF L_TRATA_FALHA.CDFORNECEDOR_EMS5 IS NULL THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              'O Fornecedor [' ||
                              L_TRATA_FALHA.CDFORNECEDOR || '] ' ||
                              L_TRATA_FALHA.NOFORNECEDORUNICOO ||
                              ' no foi integrado para o EMS5',
                              PCDSITUACAO,
                              NULL);
              ELSIF L_TRATA_FALHA.CDEMPRESA IS NULL THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              'A empresa do unicoo no foi informada para o titulo: ' ||
                              L_TRATA_FALHA.CDIDENTIFICADOR,
                              PCDSITUACAO,
                              NULL);
              ELSIF L_TRATA_FALHA.QTENDERECO IS NULL THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              'O Fornecedor [' ||
                              L_TRATA_FALHA.CDFORNECEDOR || '] ' ||
                              L_TRATA_FALHA.NOFORNECEDORUNICOO ||
                              ' no foi integrado para o EMS5, o Fornecedor no possui endereo no Unicoo.',
                              PCDSITUACAO,
                              NULL);
              ELSIF L_TRATA_FALHA.NUM_TIP_MOVTO_TIT_APB = -1 THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'Verifique o De-Para do unicoo para o ems5 para o processo [' ||
                              L_TITULOS.NRSEQUENCIAL || ']',
                              --' Tipo de movimento no cadastrado em TI_TIPO_MOVIMENTO_TIT_ACR, parametros informados: '||
                              'Empresa[' || L_TRATA_FALHA.CDEMPRESA || '] ' ||
                              'Modulo[' || L_TRATA_FALHA.CDMODULO || '] ' ||
                              'Movimento[' ||
                              RPAD(L_TRATA_FALHA.CDMOVIMENTO, 5, ' ') || '] ' ||
                              'Grupo de Fornecedor EMS [' ||
                              L_TRATA_FALHA.COD_GRP_FORNEC || '] ' ||
                              'Codigo do Fornecedor EMS [' ||
                              L_TRATA_FALHA.CDN_FORNECEDOR || '] ' ||
                              'Documento Unicoo [' ||
                              L_TITULOS.CDIDENTIFICADOR || '] ' ||
                              'Fornecedor Unicoo [' ||
                              L_TRATA_FALHA.CDFORNECEDOR || '] ' ||
                              L_TRATA_FALHA.NOFORNECEDORUNICOO,
                              PCDSITUACAO,
                              NULL);
              ELSE
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              NULL,
                              PCDSITUACAO,
                              NULL);
              END IF;
            END LOOP;
            IF VAO_ACHOU_ERRO = FALSE THEN
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL ||
                            '. Titulo ou Fornecedor no existe no Unicoo',
                            NULL,
                            PCDSITUACAO,
                            NULL);
            END IF;
          ELSE
            VALIDA_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO,
                           RFORNECEDOR.CDN_FORNECEDOR);
            VCDINTEGRACAO := 'TI_TIT_APB_CTBL';
            -------------------------------------------------------------
            --- implementação Josias em 28-05-2014 em João Pessoa
            --- Processo para pegar a distribuição do titulo no unicoo.
            -------------------------------------------------------------
            BEGIN
              INSERT INTO TI_TIT_APB_CTBL CTB
                (COD_CTA_CTBL,
                 DAT_PROCESSAMENTO,
                 COD_ESTAB,
                 COD_TIP_FLUXO_FINANC,
                 COD_UNID_FEDERAC,
                 VAL_APROP_CTBL,
                 NRSEQ_CONTROLE_INTEGRACAO,
                 COD_CCUSTO,
                 CDSITUACAO)
              -- josias 30-06-2014
              -- falta tratar o problema do centro de custo nao esta
              -- cadastrado no plano de contas informado
                (SELECT Y.COD_CTA_CTBL,
                        Y.DAT_PROCESSAMENTO,
                        Y.COD_ESTAB,
                        Y.COD_TIP_FLUXO_FINANC,
                        Y.COD_UNID_FEDERAC,
                        SUM(Y.VLDISTRIBUICAO),
                        Y.NRSEQ_CONTROLE_INTEGRACAO,
                        NVL((SELECT TO_CHAR(TCC.CD_CCUSTO_TOTVS)
                              FROM TI_CENTRO_CUSTO_CTBL_DEPARA TCC
                             WHERE TO_CHAR(TCC.CDCONTA) =
                                   (DECODE(Y.CDCENTRO_CUSTO,
                                           NULL,
                                           ' ',
                                           Y.CDCENTRO_CUSTO))),
                            DECODE(Y.CDCENTRO_CUSTO,
                                   NULL,
                                   ' ',
                                   Y.CDCENTRO_CUSTO)) CDCENTRO_CUSTO,
                        Y.CDSITUACAO
                   FROM (SELECT DISTINCT X.COD_CTA_CTBL,
                                         X.DAT_PROCESSAMENTO,
                                         X.COD_ESTAB,
                                         X.COD_TIP_FLUXO_FINANC,
                                         X.COD_UNID_FEDERAC,
                                         X.VLDISTRIBUICAO,
                                         X.NRSEQ_CONTROLE_INTEGRACAO,
                                         CASE
                                           WHEN X.TIPO_CCUSTO = '$T' THEN
                                            CASE
                                              WHEN F_TI_PARAMETRO_INTEGRACAO('AOUTILIZA_CODIGO_REDUZIDO') = 'N' THEN
                                               CC.CDCONTA
                                              ELSE
                                               TO_CHAR(X.CDCENTRO_CUSTO)
                                            END
                                           ELSE
                                            ' '
                                         END CDCENTRO_CUSTO,
                                         X.CDSITUACAO
                           FROM CONTA_CONTABIL CC,
                                (SELECT DISTINCT COD_CTA_CTBL,
                                                 DAT_PROCESSAMENTO,
                                                 COD_ESTAB,
                                                 COD_TIP_FLUXO_FINANC,
                                                 COD_UNID_FEDERAC,
                                                 --sum(nvl(decode(b.tipo_distrib,'V',b.vldistribuicao,(-1 * b.vldistribuicao)),ctb.val_aprop_ctbl)) vldistribuicao,     -- Alessandro 22/10/2014
                                                 --sum(b.vldistribuicao) vldistribuicao,      -- Alessandro 22/10/2014
                                                 -- alterado vinicius 31/12/2014
                                                 CASE
                                                   WHEN B.CDHISTORICO IN
                                                        (F_TI_PARAMETRO_INTEGRACAO('HISTORICO_COM_VALOR_LIQUIDO_APB')) THEN
                                                    (SELECT SUM(VLDISTRIBUICAO)
                                                       FROM DISTRIBUICAO_TITULO_PAGAR DTP
                                                      WHERE DTP.NRREGISTRO_TITULO =
                                                            B.NRREGISTRO_TITULO
                                                        AND DTP.TIPO_DISTRIB = 'V') -
                                                    NVL((SELECT SUM(VLDISTRIBUICAO)
                                                          FROM DISTRIBUICAO_TITULO_PAGAR DTP
                                                         WHERE DTP.NRREGISTRO_TITULO =
                                                               B.NRREGISTRO_TITULO
                                                           AND DTP.TIPO_DISTRIB = 'D'),
                                                        0)
                                                   ELSE
                                                    SUM(B.VLDISTRIBUICAO)
                                                 END VLDISTRIBUICAO,
                                                 NRSEQ_CONTROLE_INTEGRACAO,
                                                 CTB.CDSITUACAO,
                                                 CASE
                                                   WHEN B.CDCENTRO_CUSTO IS NULL THEN
                                                    CTB.COD_CCUSTO
                                                   ELSE
                                                    TO_CHAR(B.CDCENTRO_CUSTO)
                                                 END CDCENTRO_CUSTO,
                                                 CTB.COD_CCUSTO,
                                                 CTB.TIPO_CCUSTO
                                   FROM V_TI_TIT_APB_CTBL         CTB,
                                        DISTRIBUICAO_TITULO_PAGAR B
                                  WHERE CTB.NRREGISTRO_TITULO =
                                        B.NRREGISTRO_TITULO(+)
                                    AND NRSEQ_CONTROLE_INTEGRACAO =
                                        PNRSEQ_CONTROLE_INTEGRACAO
                                    AND B.TIPO_DISTRIB = 'V' -- ALessandro 22/10/2014
                                 /*group by cod_cta_ctbl,
                                 dat_processamento,
                                 cod_estab,
                                 cod_tip_fluxo_financ,
                                 cod_unid_federac,
                                 nrseq_controle_integracao,
                                 b.cdcentro_custo,
                                 ctb.cod_ccusto,
                                 ctb.tipo_ccusto,
                                 ctb.cdsituacao*/
                                  GROUP BY COD_CTA_CTBL,
                                           DAT_PROCESSAMENTO,
                                           CDHISTORICO,
                                           B.NRREGISTRO_TITULO,
                                           COD_ESTAB,
                                           COD_TIP_FLUXO_FINANC,
                                           COD_UNID_FEDERAC,
                                           NRSEQ_CONTROLE_INTEGRACAO,
                                           B.CDCENTRO_CUSTO,
                                           CTB.COD_CCUSTO,
                                           CTB.TIPO_CCUSTO,
                                           CTB.CDSITUACAO) X
                          WHERE X.CDCENTRO_CUSTO = CC.NRCONTA_REDUZIDA(+)
                            AND CC.NRPLANO_CONTAS(+) =
                                F_TI_PARAMETRO_INTEGRACAO('NRPLANO_CENTRO_CUSTO_UNICOO')) Y
                  GROUP BY Y.COD_CTA_CTBL,
                           Y.DAT_PROCESSAMENTO,
                           Y.COD_ESTAB,
                           Y.COD_TIP_FLUXO_FINANC,
                           Y.COD_UNID_FEDERAC,
                           Y.NRSEQ_CONTROLE_INTEGRACAO,
                           Y.CDCENTRO_CUSTO,
                           Y.CDSITUACAO);
            EXCEPTION
              WHEN OTHERS THEN
                -- Josias 26-06-2014 - colocado essa exceção para acompanhar erro
                RAISE_APPLICATION_ERROR(-20100, ' Erro -> ' || SQLERRM);
                NULL;
            END;
            IF SQL%ROWCOUNT = 0 THEN
              P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                            VCDINTEGRACAO,
                            'A view v_TI_TIT_APB_CTBL não encontrou registro para o processo ==>' ||
                            PNRSEQ_CONTROLE_INTEGRACAO,
                            NULL,
                            PCDSITUACAO,
                            NULL);
            ELSE
              vcdintegracao := 'TI_TIT_APB_IMPOSTO';
              insert into ti_tit_apb_imposto
                (cod_ser_docto,
                 ind_clas_impto,
                 val_impto_ja_recolhid,
                 val_outras_deduc_impto,
                 cod_titulo_ap,
                 val_rendto_tribut,
                 val_aliq_impto,
                 val_deduc_faixa_imto,
                 cod_estab,
                 cod_espec_docto,
                 cod_parcela,
                 cod_unid_federac,
                 cod_imposto,
                 cod_classif_impto,
                 val_deduc_inss,
                 val_deduc_depend,
                 val_deduc_pensao,
                 val_deduc_outras_deduc,
                 val_base_liq_impto,
                 val_imposto,
                 dat_vencto,
                 des_text_histor,
                 dat_processamento,
                 cdsituacao,
                 val_deduc_faixa_impto,
                 cod_cta_ctbl,
                 nrseq_controle_integracao,
                 cod_plano_ctb_cbtl,
                 ind_ocorrencia,
                 cod_tip_fluxo_financ)

                select cod_ser_docto,
                       ind_clas_impto,
                       val_impto_ja_recolhid,
                       val_outras_deduc_impto,
                       substr(cod_titulo_ap, 0, 10),
                       val_rendto_tribut,
                       val_aliq_impto,
                       val_deduc_faixa_imto,
                       cod_estab,
                       cod_espec_docto,
                       cod_parcela,
                       cod_unid_federac,
                       cod_imposto,
                       cod_classif_impto,
                       val_deduc_inss,
                       val_deduc_depend,
                       val_deduc_pensao,
                       val_deduc_outras_deduc,
                       val_base_liq_impto,
                       val_imposto,
                       dat_vencto,
                       des_text_histor,
                       dat_processamento,
                       cdsituacao,
                       val_deduc_faixa_impto,
                       cod_cta_ctbl,
                       nrseq_controle_integracao,
                       cod_plano_ctb_cbtl,
                       ind_ocorrencia,
                       cod_tip_fluxo_financ
                  from v_ti_tit_apb_imposto ip
                 where ip.nrseq_controle_integracao =
                       pnrseq_controle_integracao;
            END IF;
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        SQLERRM,
                        NULL,
                        PCDSITUACAO,
                        NULL);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        SQLERRM,
                        NULL,
                        PCDSITUACAO,
                        NULL);
      END;
      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_TITULOS.NRSEQUENCIAL,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  --===================================================================--
  -- P_MIGRA_VENDEDORES -> Migracao dos Vendedores como Representantes --
  -----------------------------------------------------------------------
  procedure P_MIGRA_VENDEDORES is
    vnum_pessoa number := 0;
  begin
    for vend in (select p.NRREGISTRO,
                        p.NOPESSOA,
                        p.TPPESSOA,
                        p.NRCGC_CPF,
                        p.NRINSCEST_RG,
                        p.CDRAMOATIV,
                        p.DTNASCIMENTO,
                        p.CDSEXO,
                        p.CDESTADOCIVIL,
                        p.NOMAE,
                        p.NRREG_NASCTO,
                        p.NOCARTORIO_REG,
                        p.TXOBSERVACOES,
                        p.NOOPERADOR,
                        p.NONATURALIDADE,
                        p.CDNACIONALIDADE,
                        p.NOORGAO_EMISSOR_RG,
                        p.NRINSCMUN,
                        p.NRCEI,
                        p.NRCARTAO_CONVENIO,
                        p.NOABREVIADO,
                        p.CDPAIS_EMISSOR_ID,
                        p.DTEXPEDICAO_RG,
                        p.CDESTADO_EMISSOR_RG,
                        p.CDCIDADE_NATURALIDADE,
                        e.TPENDERECO,
                        e.NOLOGRADOURO,
                        e.NRIMOVEL,
                        e.TXCOMPLEMENTO,
                        e.NOBAIRRO,
                        e.CDCIDADE,
                        e.CDESTADO,
                        e.NRCEP,
                        e.NRTELEFONE,
                        e.NRFAX,
                        e.CDEMAIL,
                        e.NRDDD,
                        e.CDEMAIL_ADICIONAL,
                        c.nocidade,
                        v.*
                   from vendedor                        v,
                        pessoa                          p,
                        endereco                        e,
                        producao.cidade@unicoo_homologa c
                  where p.nrregistro = v.nrregistro_pessoa
                    and e.nrregistro(+) = p.nrregistro
                    and c.cdcidade(+) = e.cdcidade
                  order by 1) loop
      if vend.tppessoa = 'F' then

        select ems5.seq_pessoa_fisica.nextval into vnum_pessoa from dual;

        insert into pessoa_fisic
          (NUM_PESSOA_FISIC,
           U##NOM_PESSOA,
           NOM_PESSOA,
           U##COD_ID_FEDER,
           COD_ID_FEDER,
           U##COD_ID_ESTAD_FISIC,
           COD_ID_ESTAD_FISIC,
           CODORGAOEMISIDESTAD,
           U##CODUNIDFEDERACEMISESTAD,
           CODUNIDFEDERACEMISESTAD,
           NOM_ENDERECO,
           NOM_ENDER_COMPL,
           NOM_BAIRRO,
           NOM_CIDADE,
           NOM_CONDADO,
           U##COD_PAIS,
           COD_PAIS,
           U##COD_UNID_FEDERAC,
           COD_UNID_FEDERAC,
           COD_CEP,
           COD_CX_POST,
           COD_TELEFONE,
           COD_RAMAL,
           COD_FAX,
           COD_RAMAL_FAX,
           COD_TELEX,
           COD_MODEM,
           COD_RAMAL_MODEM,
           COD_E_MAIL,
           DAT_NASC_PESSOA_FISIC,
           COD_PAIS_NASC,
           COD_UNID_FEDERAC_NASC,
           DES_ANOT_TAB,
           COD_USUAR_ULT_ATUALIZ,
           DAT_ULT_ATUALIZ,
           HRA_ULT_ATUALIZ,
           U##NOM_MAE_PESSOA,
           NOM_MAE_PESSOA,
           COD_IMAGEM,
           LOG_EMS_20_ATLZDO,
           COD_LIVRE_1,
           LOG_LIVRE_1,
           NUM_LIVRE_1,
           VAL_LIVRE_1,
           DAT_LIVRE_1,
           IND_TIP_PESSOA_FISIC,
           NOMNACIONPESSOAFISIC,
           NOMPROFISPESSOAFISIC,
           INDESTADOCIVILPESSOA,
           NOM_HOME_PAGE,
           NOM_ENDER_TEXT,
           LOG_ENVIO_BCO_HISTOR,
           COD_LIVRE_2,
           DAT_LIVRE_2,
           LOG_LIVRE_2,
           NUM_LIVRE_2,
           VAL_LIVRE_2,
           COD_E_MAIL_COBR,
           NUM_PESSOA_FISIC_COBR,
           NOM_ENDER_COBR,
           NOM_ENDER_COMPL_COBR,
           NOM_BAIRRO_COBR,
           COD_UNID_FEDERAC_COBR,
           NOM_CIDAD_COBR,
           NOM_CONDAD_COBR,
           COD_PAIS_COBR,
           COD_CEP_COBR,
           COD_CX_POST_COBR,
           NOM_ENDER_COBR_TEXT,
           COD_SUB_REGIAO_VENDAS,
           CDD_VERSION,
           LOG_REPLIC_PESSOA_HCM,
           LOG_REPLIC_PESSOA_CRM,
           LOG_REPLIC_PESSOA_GPS,
           NUMPESSOAFISICMATRIZ,
           COD_FAX_2,
           COD_RAMAL_FAX_2,
           COD_TELEF_2,
           COD_RAMAL_2,
           IND_TIP_ID_ESTAD,
           IND_TIP_MATRIZ,
           PROGRESS_RECID)
        values
          (vnum_pessoa,
           upper(vend.nopessoa), --U##NOM_PESSOA,
           vend.nopessoa, --NOM_PESSOA,
           vend.nrcgc_cpf, --U##COD_ID_FEDER,
           vend.nrcgc_cpf, --COD_ID_FEDER,
           ' ', --U##COD_ID_ESTAD_FISIC,
           ' ', --COD_ID_ESTAD_FISIC,
           ' ', --CODORGAOEMISIDESTAD,
           ' ', --U##CODUNIDFEDERACEMISESTAD,
           ' ', --CODUNIDFEDERACEMISESTAD,
           nvl(trim(vend.nologradouro) ||
               decode(vend.nrimovel, null, '', ' ' || vend.nrimovel),
               'NAO INFORMADO'), --NOM_ENDERECO,
           nvl(case when length(vend.txcomplemento) <= 10 then
               vend.txcomplemento when
               length(vend.txcomplemento) > 10 and
               length(f_reduz_compl(vend.txcomplemento, 0)) <= 10 then
               f_reduz_compl(vend.txcomplemento, 0) else
               substr(f_reduz_compl(vend.txcomplemento, 0), 1, 10) end,
               ' '), --NOM_ENDER_COMPL,
           nvl(case when length(vend.nobairro) <= 20 then vend.nobairro when
               length(vend.nobairro) > 20 and
               length(f_reduz_bairro(vend.nobairro, 0)) <= 20 then
               f_reduz_bairro(vend.nobairro, 0) else
               substr(f_reduz_bairro(vend.nobairro, 0), 1, 20) end,
               'NAO INFORMADO'), --NOM_BAIRRO,
           nvl(vend.nocidade, 'NAO INFORMADO'), --NOM_CIDADE,
           ' ', --NOM_CONDADO,
           'BRA', --U##COD_PAIS,
           'BRA', --COD_PAIS,
           nvl(vend.cdestado, 'RJ'), --U##COD_UNID_FEDERAC,
           nvl(vend.cdestado, 'RJ'), --COD_UNID_FEDERAC,
           nvl(vend.nrcep,
               f_ti_parametro_integracao('NRCEP_DEFAULT_INCLUSAO')), --COD_CEP,
           ' ', --COD_CX_POST,
           nvl(vend.nrtelefone, ' '), --COD_TELEFONE,
           ' ', --COD_RAMAL,
           vend.nrfax, --COD_FAX,
           ' ', --COD_RAMAL_FAX,
           ' ', --COD_TELEX,
           ' ', --COD_MODEM,
           ' ', --COD_RAMAL_MODEM,
           nvl(vend.cdemail, vend.cdemail_adicional), --COD_E_MAIL,
           vend.dtnascimento, --DAT_NASC_PESSOA_FISIC,
           ' ', --COD_PAIS_NASC,
           ' ', --COD_UNID_FEDERAC_NASC,
           ' ', --DES_ANOT_TAB,
           'migracao', --COD_USUAR_ULT_ATUALIZ,
           sysdate, --DAT_ULT_ATUALIZ,
           ' ', --HRA_ULT_ATUALIZ,
           upper(vend.nomae), --U##NOM_MAE_PESSOA,
           vend.nomae, --NOM_MAE_PESSOA,
           ' ', --COD_IMAGEM,
           0, --LOG_EMS_20_ATLZDO,
           ' ', --COD_LIVRE_1,
           0, --LOG_LIVRE_1,
           0, --NUM_LIVRE_1,
           0, --VAL_LIVRE_1,
           sysdate, --DAT_LIVRE_1,
           ' ', --IND_TIP_PESSOA_FISIC,
           ' ', --NOMNACIONPESSOAFISIC,
           ' ', --NOMPROFISPESSOAFISIC,
           decode(vend.cdestadocivil,
                  'C',
                  'CASADO',
                  'S',
                  'SOLTEIRO',
                  'V',
                  'VIUVO',
                  'D',
                  'DIVORCIADO',
                  'Q',
                  'DIVORCIADO',
                  'OUTROS'), --INDESTADOCIVILPESSOA,
           ' ', --NOM_HOME_PAGE,
           ' ', --NOM_ENDER_TEXT,
           0, --LOG_ENVIO_BCO_HISTOR,
           ' ', --COD_LIVRE_2,
           null, --DAT_LIVRE_2,
           0, --LOG_LIVRE_2,
           0, --NUM_LIVRE_2,
           0, --VAL_LIVRE_2,
           ' ', --COD_E_MAIL_COBR,
           0, --NUM_PESSOA_FISIC_COBR,
           trim(vend.nologradouro) ||
           decode(vend.nrimovel, null, '', ' ' || vend.nrimovel), --NOM_ENDER_COBR,
           case when length(vend.txcomplemento) <= 10 then
           vend.txcomplemento when
           length(vend.txcomplemento) > 10 and
           length(f_reduz_compl(vend.txcomplemento, 0)) <= 10 then
           f_reduz_compl(vend.txcomplemento, 0) else
           substr(f_reduz_compl(vend.txcomplemento, 0), 1, 10) end, --NOM_ENDER_COMPL_COBR,
           case when length(vend.nobairro) <= 20 then vend.nobairro when
           length(vend.nobairro) > 20 and
           length(f_reduz_bairro(vend.nobairro, 0)) <= 20 then
           f_reduz_bairro(vend.nobairro, 0) else
           substr(f_reduz_bairro(vend.nobairro, 0), 1, 20) end, --NOM_BAIRRO_COBR,
           nvl(vend.cdestado, 'RJ'), --COD_UNID_FEDERAC_COBR,
           nvl(vend.nocidade, 'NAO INFORMADO'), --NOM_CIDAD_COBR,
           ' ', --NOM_CONDADO_COBR,
           'BRA', --COD_PAIS_COBR,
           nvl(vend.nrcep,
               f_ti_parametro_integracao('NRCEP_DEFAULT_INCLUSAO')), --COD_CEP_COBR,
           ' ', --COD_CX_POST_COBR,
           ' ', --NOM_ENDER_COBR_TEXT,
           ' ', --COD_SUB_REGIAO_VENDAS,
           0, --CDD_VERSION,
           '1', --LOG_REPLIC_PESSOA_HCM,
           '1', --LOG_REPLIC_PESSOA_CRM,
           '1', --LOG_REPLIC_PESSOA_GPS,
           vnum_pessoa, --NUMPESSOAFISICMATRIZ,
           ' ', --COD_FAX_2,
           ' ', --COD_RAMAL_FAX_2,
           ' ', --COD_TELEF_2,
           ' ', --COD_RAMAL_2,
           'Inscrição Estadual', --IND_TIP_ID_ESTAD,
           'Física', --IND_TIP_MATRIZ,
           ems5.pessoa_fisic_seq.nextval --PROGRESS_RECID
           );
      else

        select ems5.seq_pessoa_juridica.nextval into vnum_pessoa from dual;

        insert into pessoa_jurid
          (NUM_PESSOA_JURID,
           U##NOM_PESSOA,
           NOM_PESSOA,
           U##COD_ID_FEDER,
           COD_ID_FEDER,
           COD_ID_ESTAD_JURID,
           COD_ID_MUNIC_JURID,
           U##COD_ID_PREVID_SOCIAL,
           COD_ID_PREVID_SOCIAL,
           LOG_FINS_LUCRAT,
           NUMPESSOAJURIDMATRIZ,
           NOM_ENDERECO,
           NOM_ENDER_COMPL,
           NOM_BAIRRO,
           NOM_CIDADE,
           NOM_CONDADO,
           U##COD_PAIS,
           COD_PAIS,
           U##COD_UNID_FEDERAC,
           COD_UNID_FEDERAC,
           COD_CEP,
           COD_CX_POST,
           COD_TELEFONE,
           COD_FAX,
           COD_RAMAL_FAX,
           COD_TELEX,
           COD_MODEM,
           COD_RAMAL_MODEM,
           COD_E_MAIL,
           COD_E_MAIL_COBR,
           NUM_PESSOA_JURID_COBR,
           NOM_ENDER_COBR,
           NOM_ENDER_COMPL_COBR,
           NOM_BAIRRO_COBR,
           NOM_CIDAD_COBR,
           NOM_CONDAD_COBR,
           U##COD_UNID_FEDERAC_COBR,
           COD_UNID_FEDERAC_COBR,
           U##COD_PAIS_COBR,
           COD_PAIS_COBR,
           COD_CEP_COBR,
           COD_CX_POST_COBR,
           NUM_PESSOA_JURID_PAGTO,
           NOM_ENDER_PAGTO,
           NOM_ENDER_COMPL_PAGTO,
           NOM_BAIRRO_PAGTO,
           NOM_CIDAD_PAGTO,
           NOM_CONDAD_PAGTO,
           U##COD_PAIS_PAGTO,
           COD_PAIS_PAGTO,
           U##COD_UNID_FEDERAC_PAGTO,
           COD_UNID_FEDERAC_PAGTO,
           COD_CEP_PAGTO,
           COD_CX_POST_PAGTO,
           DES_ANOT_TAB,
           IND_TIP_PESSOA_JURID,
           INDTIPCAPITPESSOAJURID,
           COD_USUAR_ULT_ATUALIZ,
           DAT_ULT_ATUALIZ,
           HRA_ULT_ATUALIZ,
           COD_IMAGEM,
           LOG_EMS_20_ATLZDO,
           COD_LIVRE_1,
           LOG_LIVRE_1,
           NUM_LIVRE_1,
           VAL_LIVRE_1,
           DAT_LIVRE_1,
           NOM_HOME_PAGE,
           NOM_ENDER_TEXT,
           NOM_ENDER_COBR_TEXT,
           NOM_ENDER_PAGTO_TEXT,
           LOG_ENVIO_BCO_HISTOR,
           COD_LIVRE_2,
           DAT_LIVRE_2,
           LOG_LIVRE_2,
           NUM_LIVRE_2,
           VAL_LIVRE_2,
           IND_NATUR_PESSOA_JURID,
           NOM_FANTASIA,
           COD_SUB_REGIAO_VENDAS,
           CDD_VERSION,
           LOG_REPLIC_PESSOA_HCM,
           LOG_REPLIC_PESSOA_CRM,
           LOG_REPLIC_PESSOA_GPS,
           COD_FAX_2,
           COD_RAMAL_FAX_2,
           COD_TELEF_2,
           COD_RAMAL_2,
           IND_TIP_MATRIZ,
           PROGRESS_RECID)
        values
          (vnum_pessoa, --NUM_PESSOA_JURID
           upper(vend.nopessoa), --U##NOM_PESSOA,
           vend.nopessoa, --NOM_PESSOA,
           vend.nrcgc_cpf, --U##COD_ID_FEDER,
           vend.nrcgc_cpf, --COD_ID_FEDER,
           ' ', --U##COD_ID_ESTAD_FISIC,
           ' ', --COD_ID_ESTAD_FISIC,
           ' ', --U##COD_ID_PREVID_SOCIAL,
           ' ', --COD_ID_PREVID_SOCIAL,
           0, --LOG_FINS_LUCRAT,
           0, --NUMPESSOAJURIDMATRIZ
           nvl(trim(vend.nologradouro) ||
               decode(vend.nrimovel, null, '', ' ' || vend.nrimovel),
               'NAO INFORMADO'), --NOM_ENDERECO,
           nvl(case when length(vend.txcomplemento) <= 10 then
               vend.txcomplemento when
               length(vend.txcomplemento) > 10 and
               length(f_reduz_compl(vend.txcomplemento, 0)) <= 10 then
               f_reduz_compl(vend.txcomplemento, 0) else
               substr(f_reduz_compl(vend.txcomplemento, 0), 1, 10) end,
               ' '), --NOM_ENDER_COMPL,
           nvl(case when length(vend.nobairro) <= 20 then vend.nobairro when
               length(vend.nobairro) > 20 and
               length(f_reduz_bairro(vend.nobairro, 0)) <= 20 then
               f_reduz_bairro(vend.nobairro, 0) else
               substr(f_reduz_bairro(vend.nobairro, 0), 1, 20) end,
               'NAO INFORMADO'), --NOM_BAIRRO,
           nvl(vend.nocidade, 'NAO INFORMADO'), --NOM_CIDADE,
           ' ', --NOM_CONDADO,
           'BRA', --U##COD_PAIS,
           'BRA', --COD_PAIS,
           nvl(vend.cdestado, 'RJ'), --U##COD_UNID_FEDERAC,
           nvl(vend.cdestado, 'RJ'), --COD_UNID_FEDERAC,
           nvl(vend.nrcep,
               f_ti_parametro_integracao('NRCEP_DEFAULT_INCLUSAO')), --COD_CEP,
           ' ', --COD_CX_POST,
           nvl(vend.nrtelefone, ' '), --COD_TELEFONE,
           nvl(vend.nrfax, 0), --COD_FAX,
           ' ', --COD_RAMAL_FAX,
           ' ', --COD_TELEX,
           ' ', --COD_MODEM,
           ' ', --COD_RAMAL_MODEM,
           nvl(nvl(vend.cdemail, vend.cdemail_adicional), ' '), --COD_E_MAIL,
           ' ', --COD_E_MAIL_COBR,
           0, --NUMPESSOA_COBR
           nvl(trim(vend.nologradouro) ||
               decode(vend.nrimovel, null, '', ' ' || vend.nrimovel),
               'NAO INFORMADO'), --NOM_ENDERECO_COBR,
           nvl(case when length(vend.txcomplemento) <= 10 then
               vend.txcomplemento when
               length(vend.txcomplemento) > 10 and
               length(f_reduz_compl(vend.txcomplemento, 0)) <= 10 then
               f_reduz_compl(vend.txcomplemento, 0) else
               substr(f_reduz_compl(vend.txcomplemento, 0), 1, 10) end,
               ' '), --NOM_ENDER_COMPL_COBR,
           nvl(case when length(vend.nobairro) <= 20 then vend.nobairro when
               length(vend.nobairro) > 20 and
               length(f_reduz_bairro(vend.nobairro, 0)) <= 20 then
               f_reduz_bairro(vend.nobairro, 0) else
               substr(f_reduz_bairro(vend.nobairro, 0), 1, 20) end,
               'NAO INFORMADO'), --NOM_BAIRRO_COBR,
           nvl(vend.nocidade, 'NAO INFORMADO'), --NOM_CIDADE_COBR,
           ' ', --NOM_CONDADO_COBR,
           nvl(vend.cdestado, 'RJ'), --U##COD_UNID_FEDERAC_COBR,
           nvl(vend.cdestado, 'RJ'), --COD_UNID_FEDERAC_COBR,
           'BRA', --U##COD_PAIS_COBR,
           'BRA', --COD_PAIS_COBR,
           nvl(vend.nrcep,
               f_ti_parametro_integracao('NRCEP_DEFAULT_INCLUSAO')), --COD_CEP_COBR,
           ' ', --COD_CX_POST_COBR,
           0, --NUMPESSOA_PAGTO
           nvl(trim(vend.nologradouro) ||
               decode(vend.nrimovel, null, '', ' ' || vend.nrimovel),
               'NAO INFORMADO'), --NOM_ENDERECO_PAGTO,
           nvl(case when length(vend.txcomplemento) <= 10 then
               vend.txcomplemento when
               length(vend.txcomplemento) > 10 and
               length(f_reduz_compl(vend.txcomplemento, 0)) <= 10 then
               f_reduz_compl(vend.txcomplemento, 0) else
               substr(f_reduz_compl(vend.txcomplemento, 0), 1, 10) end,
               ' '), --NOM_ENDER_COMPL_PAGTO,
           nvl(case when length(vend.nobairro) <= 20 then vend.nobairro when
               length(vend.nobairro) > 20 and
               length(f_reduz_bairro(vend.nobairro, 0)) <= 20 then
               f_reduz_bairro(vend.nobairro, 0) else
               substr(f_reduz_bairro(vend.nobairro, 0), 1, 20) end,
               'NAO INFORMADO'), --NOM_BAIRRO_PAGTO,
           nvl(vend.nocidade, 'NAO INFORMADO'), --NOM_CIDADE_PAGTO,
           ' ', --NOM_CONDADO_PAGTO,
           'BRA', --U##COD_PAIS_PAGTO,
           'BRA', --COD_PAIS_PAGTO,
           nvl(vend.cdestado, 'RJ'), --U##COD_UNID_FEDERAC_PAGTO,
           nvl(vend.cdestado, 'RJ'), --COD_UNID_FEDERAC_PAGTO,
           nvl(vend.nrcep,
               f_ti_parametro_integracao('NRCEP_DEFAULT_INCLUSAO')), --COD_CEP_PAGTO,
           ' ', --COD_CX_POST_PAGTO,
           ' ', --DES_ANOT_TAB,
           ' ', --IND_TIP_PESSOA_FISIC,
           0, --INDTIPCAPITPESSOAJURID
           'migracao', --COD_USUAR_ULT_ATUALIZ,
           sysdate, --DAT_ULT_ATUALIZ,
           ' ', --HRA_ULT_ATUALIZ,
           ' ', --COD_IMAGEM
           0, --LOG_EMS_20_ATLZDO
           NULL, --COD_LIVRE_1
           0, --LOG_LIVRE_1
           0, --NUM_LIVRE_1
           0, --VAL_LIVRE_1
           SYSDATE, --DAT_LIVRE_1
           ' ', --NOM_HOME_PAGE
           ' ', --NOM_ENDER_TEXT
           ' ', --NOM_ENDER_COBR_TEXT
           ' ', --NOM_ENDER_PAGTO_TEXT
           0, --LOG_ENVIO_BCO_HISTOR
           ' ', --COD_LIVRE_2
           NULL, --DAT_LIVRE_2
           0, --LOG_LIVRE_2
           0, --NUM_LIVRE_2
           0, --VAL_LIVRE_2
           'Nacional', --IND_NATUR_PESSOA_JURID
           ' ', --NOM_FANTASIA
           ' ', --COD_SUB_REGIAO_VENDAS
           0, --CDD_VERSION
           '1', --LOG_REPLIC_PESSOA_HCM
           '1', --LOG_REPLIC_PESSOA_CRM
           '1', --LOG_REPLIC_PESSOA_GPS
           ' ', --COD_FAX_2
           ' ', --COD_RAMAL_FAX_2
           ' ', --COD_TELEF_2
           ' ', --COD_RAMAL_2
           'Jurídica', --IND_TIP_MATRIZ
           ems5.pessoa_jurid_seq.nextval --PROGRESS_RECID
           );

      end if;

      insert into REPRESENTANTE
      values
        (1,
         1,
         vend.cdvendedor,
         vnum_pessoa,
         vend.nopessoa,
         upper(f_abrevia_nome(vend.nopessoa, 23, 'PEA')) || vend.nrregistro,
         f_abrevia_nome(vend.nopessoa, 23, 'PEA') || vend.nrregistro,
         'BRA',
         vend.nrcgc_cpf,
         999,
         999,
         sysdate,
         ' ',
         ' ',
         ' ',
         0,
         0,
         0,
         null,
         'Ativo',
         null,
         ' ',
         null,
         0,
         0,
         0,
         0,
         ems5.representante_seq.nextval);

      insert into REPRES_FINANC
      values
        (1,
         1,
         vend.cdvendedor,
         0,
         0,
         0,
         0,
         0,
         0,
         0,
         0,
         0,
         999,
         999,
         ' ',
         ' ',
         ' ',
         'Pagamento',
         0,
         ' ',
         0,
         0,
         0,
         sysdate,
         'UN',
         0,
         0,
         ' ',
         0,
         'Nenhum',
         ' ',
         null,
         0,
         0,
         0,
         0,
         'PADRAO',
         0,
         ems5.repres_financ_seq.nextval);

    end loop;
  end p_migra_vendedores;

  -- Rogério - 07/12/2016

  PROCEDURE P_GERA_SERIE_NOTA AS

    /*
    ***************************************************************************************************************
    Criac?o          : -
    Data             : -
    Modulo Principal : Integrac?o EMS5
    Modulos          : -
    Objetivo         : Migrar série Unicoo x Totvs 12
    Alteracoes
    +------------------------------------------------------------------------------------------------------------------------------------------+
    | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 17/06/2016 | VINICIUS      |               |           | Criação da procedure   |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    */

    VAOEXISTE CHAR;

    CURSOR C_SERIES IS

      SELECT DISTINCT T.CDMOVIMENTO u##cod_ser_fisc_nota,
                      T.CDMOVIMENTO cod_ser_fisc_nota,
                      T.NOMOVIMENTO des_ser_fisc_nota,
                      ' ' cod_livre_1,
                      0 log_livre_1,
                      0 num_livre_1,
                      0 val_livre_1,
                      TRUNC(SYSDATE) dat_livre_1,
                      0 log_envio_bco_histor,
                      ' ' cod_livre_2,
                      NULL dat_livre_2,
                      0 log_livre_2,
                      0 num_livre_2,
                      0 val_livre_2,
                      0 cdd_version
        FROM TI_TIPO_MOVIMENTO_TIT_ACR T
       WHERE CDMODULO = 'FT';

  BEGIN

    FOR CS IN C_SERIES LOOP

      BEGIN
        SELECT 'S'
          INTO VAOEXISTE
          FROM EMS5.SER_FISC_NOTA S
         WHERE S.U##COD_SER_FISC_NOTA = CS.COD_SER_FISC_NOTA;
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          VAOEXISTE := 'N';
      END;

      IF VAOEXISTE = 'N' THEN

        INSERT INTO EMS5.SER_FISC_NOTA
        VALUES
          (CS.u##cod_ser_fisc_nota,
           CS.cod_ser_fisc_nota,
           CS.des_ser_fisc_nota,
           CS.cod_livre_1,
           CS.log_livre_1,
           CS.num_livre_1,
           CS.val_livre_1,
           CS.dat_livre_1,
           CS.log_envio_bco_histor,
           CS.cod_livre_2,
           CS.dat_livre_2,
           CS.log_livre_2,
           CS.num_livre_2,
           CS.val_livre_2,
           CS.cdd_version,
           EMS5.SER_FISC_NOTA_SEQ.NEXTVAL);
      END IF;
    END LOOP;
    COMMIT;
  END;

  -- Rogério - 07/12/2016

  --===============================================--
  -- TI_Cliente --> Enviar Cliente para integracao --
  ---------------------------------------------------
  PROCEDURE P_TI_CLIENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_INTEGRA_CLIFOR IS
      SELECT CI.NRSEQUENCIAL        NRSEQ_CONTROLE_INTEGRACAO,
             CI.CDSITUACAO,
             CI.NRSEQUENCIAL_ORIGEM NRPESSOA
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'CL'
         AND CI.CDSITUACAO = PCDSITUACAO
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0);

    --VARIAVEIS PARA TRATAR E REDUZ O ENDERECO
    VQTLOGRA             NUMBER;
    VQTCOMPL             NUMBER;
    VQTLOGRA_REDUZ       NUMBER;
    VQTCOMPL_REDUZ       NUMBER;
    VQTLOGRA_REDUZ_ABREV NUMBER;
    VQTNRIMOVEL          NUMBER;
    VLOGRA               VARCHAR2(50);
    VCOMPL               VARCHAR2(15);
    VLOGRA_REDUZ         VARCHAR2(50);
    VCOMPL_REDUZ         VARCHAR2(15);
    VLOGRA_REDUZ_ABREV   VARCHAR2(50);

    --VLOGRADOURO E VCOMPLEMENTO RECEBERAO OS CONTEUDOS DO ENDERECO E COMPLEMENTO APOS ANALISE DE TAMANHOS
    VLOGRADOURO       VARCHAR2(40);
    VCOMPLEMENTO      VARCHAR2(10);
    VBAIRRO           VARCHAR2(25);
    VLOGRADOURO_COBR  VARCHAR2(40);
    VCOMPLEMENTO_COBR VARCHAR2(10);
    VBAIRRO_COBR      VARCHAR2(25);

    --VARIAVIES QUE CONTROLAM O NUMERO MAXIMO DE REGISTROS NOS CAMPOS DE ENDERECO
    VQTLOGRADOURO  NUMBER := 40;
    VQTCOMPLEMENTO NUMBER := 10;

  BEGIN

    FOR L_INTEGRA_CLIFOR IN C_INTEGRA_CLIFOR LOOP
      BEGIN
        PCDSITUACAO := 'RC';

        FOR TC IN (SELECT COD_ORG_EMIS_ID_ESTAD,
                          DAT_NASCIMENTO,
                          COD_ID_FEDER_NASC,
                          NOM_NACIONALIDADE,
                          IND_ESTADO_CIVIL,
                          COD_CX_POST,
                          NOM_HOME_PAGE,
                          DAT_IMPL_CLIEN,
                          COD_DIGITO_CTA_CORREN,
                          COD_TIP_FLUXO_FINANC,
                          NUM_DIAS_ATRASO_AVDEB,
                          DAT_PROCESSAMENTO,
                          CDSITUACAO,
                          --          nm_arq_retorno,
                          COD_EMPRESA,
                          COD_ID_FEDER_JURID,
                          RPAD(NVL(TRIM(COD_CEP_COBR),
                                   F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')),
                               8,
                               '0') COD_CEP_COBR,
                          DEST_ANOT_TABELA,
                          COD_CART_BCIA_PREFER,
                          IND_TIPO_PESSOA,
                          COD_ID_FEDER_MATRIZ,
                          COD_PAIS_NASC,
                          -- Josias 29-06-2014
                          -- estava estourando o nome da mae com mais de 40 posições
                          NOM_MAE,
                          NOM_PROFISSAO,
                          NOM_CIDADE,
                          -- josias 29-06-2014
                          RPAD(NVL(TRIM(COD_CEP),
                                   F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')),
                               8,
                               '0') COD_CEP,
                          COD_TELEFONE_1,
                          COD_TELEFONE_3,
                          COD_FAX,
                          NOM_BAIRRO_COBR,
                          COD_UNID_FEDER_COBR,
                          COD_GRP_CLIEN,
                          COD_PORTAD_PREFER,
                          COD_CTA_CORREN_BCO,
                          COD_BANCO,
                          LOG_CALC_MULTA,
                          IND_OCORRENCIA,
                          NRSEQ_CONTROLE_INTEGRACAO,
                          COD_CLIENTE,
                          NOM_CLIENTE,
                          NOM_ABREV,
                          COD_ID_FEDER_ESTAD_JURID,
                          COD_ID_PREVID_SOCIAL,
                          LOG_FINS_LUCRAT,
                          COD_ID_ESTAD_FISIC,
                          COD_ID_FEDER_EMIS_ESTAD,
                          NOM_BAIRRO,
                          COD_UNID_FEDER,
                          COD_TELEFONE_2,
                          COD_RAMAL_FAX,
                          NOM_ENDER_COMPL_COBR,
                          NOM_CIDADE_COBR,
                          COD_CX_POST_COBR,
                          COD_TIP_CLIEN,
                          COD_ID_FEDER,
                          NOM_ENDER_COMPL,
                          COD_DIGITO_AGENC_BCIA,
                          COD_ACAO,
                          NOM_ENDERECO,
                          NRIMOVEL, -- PASSEI A TRAZER O NUMERO DO IMOVEL SEPARADO DO NOM_ENDERECO
                          NOM_ENDERECO_COBR,
                          NRIMOVEL_COBR,
                          COD_AGENC_BCIA,
                          COD_E_MAIL,
                          COD_ID_MUNIC_JURID,
                          NRSEQ_FAVORECIDO,
                          NRPESSOA
                     FROM V_TI_CLIENTE
                    WHERE NRSEQ_CONTROLE_INTEGRACAO =
                          L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO) LOOP

          --QTDE E CONTEUDOS DO ENDERECO
          VQTLOGRA             := LENGTH(TRIM(TC.NOM_ENDERECO));
          VQTCOMPL             := LENGTH(TRIM(TC.NOM_ENDER_COMPL));
          VQTLOGRA_REDUZ       := LENGTH(TRIM(F_REDUZ_END(TC.NOM_ENDERECO,
                                                          0)));
          VQTCOMPL_REDUZ       := LENGTH(TRIM(F_REDUZ_COMPL(TC.NOM_ENDER_COMPL,
                                                            0)));
          VQTLOGRA_REDUZ_ABREV := LENGTH(TRIM(F_REDUZ_END_ABREV(F_REDUZ_END(TC.NOM_ENDERECO,
                                                                            0),
                                                                0)));
          VQTNRIMOVEL          := LENGTH(TC.NRIMOVEL);
          VLOGRA               := TRIM(TC.NOM_ENDERECO);
          VCOMPL               := NVL(TRIM(TC.NOM_ENDER_COMPL), ' ');
          VLOGRA_REDUZ         := TRIM(F_REDUZ_END(TC.NOM_ENDERECO, 0));
          VCOMPL_REDUZ         := TRIM(F_REDUZ_COMPL(TC.NOM_ENDER_COMPL, 0));
          VLOGRA_REDUZ_ABREV   := TRIM(F_REDUZ_END_ABREV(F_REDUZ_END(TC.NOM_ENDERECO,
                                                                     0),
                                                         0));

          --TRATATIVA DOS ENDEÇOES E LOGRADOUROS (21/10/2016)
          --COMPLEMENTO NULO OU ATÉ 10 E O LOGRADOURO + NRIMOVEL ATÉ 40
          --LINHAS 1 E 2 DA PLANILHA
          IF ((VCOMPL IS NULL OR LENGTH(VCOMPL) <= VQTCOMPLEMENTO) AND
             VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) <= VQTLOGRADOURO) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA;
            ELSE
              VLOGRADOURO := VLOGRA || ' ' || TC.NRIMOVEL;
            END IF;

            VCOMPLEMENTO := VCOMPL;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '1', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DAS LINHAS 1 E 2
            --LOGRADOURO+NRIMOVEL ACIMA DE 40, PORÉM LOGRAD+IMOVEL REDUZ ATÉ 40 E O COMPLEMENTO ATÉ 10
            --LINHA 3 DA PLANILHA
          ELSIF (((VQTCOMPL <= VQTCOMPLEMENTO) OR (VQTCOMPL IS NULL)) AND
                VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) <=
                VQTLOGRADOURO) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA_REDUZ;
            ELSE
              VLOGRADOURO := VLOGRA_REDUZ || ' ' || TC.NRIMOVEL;
            END IF;

            VCOMPLEMENTO := VCOMPL;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '3', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 3
            --COMPLEMENTO ACIMA DE 10, PORÉM COMPL REDUZ ATÉ 10 E O LOGRADOURO + NRIMOVEL ATÉ 40
            --LINHA 4 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
                VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) <= VQTLOGRADOURO) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA;
            ELSE
              VLOGRADOURO := VLOGRA || ' ' || TC.NRIMOVEL;
            END IF;

            VCOMPLEMENTO := VCOMPL_REDUZ;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '4', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 4
            --COMPLEMENTO ACIMA DE 10, PORÉM COMPL REDUZ ATÉ 10 E O LOGRADOURO + NRIMOVEL ACIMA DE 40, PORÉM LOGR+IMOVEL REDUZ ATÉ 40
            --LINHA 5 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA_REDUZ;
            ELSE
              VLOGRADOURO := VLOGRA_REDUZ || ' ' || TC.NRIMOVEL;
            END IF;

            VCOMPLEMENTO := VCOMPL_REDUZ;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '5', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 5

            --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO + NRIMOVEL ATE 40
            --LINHA 6 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) + 1 + VQTCOMPL_REDUZ <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA || '-' || VCOMPL_REDUZ;
            ELSE
              VLOGRADOURO := VLOGRA || ' ' || TC.NRIMOVEL || '-' ||
                             VCOMPL_REDUZ;
            END IF;

            VCOMPLEMENTO := ' ';

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '6', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 6
            --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO REDUZ + NRIMOVEL ATE 40
            --LINHA 7 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) + 1 + VQTCOMPL_REDUZ >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) + 1 +
                VQTCOMPL_REDUZ <= VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA_REDUZ || '-' || VCOMPL_REDUZ;
            ELSE
              VLOGRADOURO := VLOGRA_REDUZ || ' ' || TC.NRIMOVEL || '-' ||
                             VCOMPL_REDUZ;
            END IF;

            VCOMPLEMENTO := ' ';

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '7', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 7
            --COMPLEMENTO NULO OU ATÉ 10, LOGR REDUZ + NR ACIMA DE 40, PORÉM LOGRADOURO REDUZ E ABREV + NRIMOVEL ATE 40
            --LINHA 8 DA PLANILHA
          ELSIF ((VQTCOMPL <= VQTCOMPLEMENTO OR VCOMPL IS NULL) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL + 1), 0) <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA_REDUZ_ABREV;
            ELSE
              VLOGRADOURO := VLOGRA_REDUZ_ABREV || ' ' || TC.NRIMOVEL;
            END IF;

            VCOMPLEMENTO := VCOMPL;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 8

            --COMPLEMENTO ACIMA DE 10, PORÉM REDUZ ATÉ 10 E LOGR REDUZ + NR ACIMA DE 40, PORÉM LOGRADOURO REDUZ E ABREV + NRIMOVEL ATE 40
            --LINHA 9 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL + 1), 0) <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA_REDUZ_ABREV;
            ELSE
              VLOGRADOURO := VLOGRA_REDUZ_ABREV || ' ' || TC.NRIMOVEL;
            END IF;

            VCOMPLEMENTO := VCOMPL_REDUZ;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 9

            --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO REDUZ E ABREVIADO (ÚLTIMO RECURSO) + NRIMOVEL ATE 40
            --LINHA 10 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) + 1 + VQTCOMPL_REDUZ >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) + 1 +
                VQTCOMPL_REDUZ > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL + 1), 0) + 1 +
                VQTCOMPL_REDUZ <= VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL IS NULL THEN
              VLOGRADOURO := VLOGRA_REDUZ_ABREV || '-' || VCOMPL_REDUZ;
            ELSE
              VLOGRADOURO := VLOGRA_REDUZ_ABREV || ' ' || TC.NRIMOVEL || '-' ||
                             VCOMPL_REDUZ;
            END IF;

            VCOMPLEMENTO := ' ';

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 10
          else
            --*****ver se ficará
            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '0', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            VLOGRADOURO  := NULL;
            VCOMPLEMENTO := ' ';

            /*   -- ERRO - NAO ENTROU EM NENHUM DOS IFS ACIMA
                ELSIF ((LENGTH(TENDERECO.TXCOMPLEMENTO) > VQTCOMPLEMENTO AND LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0))> VQTCOMPLEMENTO) AND
                     ((LENGTH(TRIM(TENDERECO.NOLOGRADOURO)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
                     ((LENGTH(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
                     ((LENGTH(F_REDUZ_END_ABREV(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO)
                     ) THEN

                  -- VER COM O VINI PARA GRAVAR FALHA NO PROCESSO
                  VLOGRADOURO  := NULL;
                  VCOMPLEMENTO := NULL;

                  INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '9', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);
            */
          END IF;

          --VALIDACAO DO TAMANHO DO BAIRRO
          --SE NAO ENVIAR O BAIRRO COMPLETO, TENTA O REDUZIDO E POR ÚLTIMO TRUNCA
          VBAIRRO := '';

          IF LENGTH(TC.NOM_BAIRRO) > 20 THEN
            IF LENGTH(f_reduz_bairro(TC.NOM_BAIRRO, 0)) > 20 THEN
              VBAIRRO := SUBSTR(F_REDUZ_BAIRRO(TC.NOM_BAIRRO, 0), 1, 20); --20 POSICOES DO REDUZIDO
            ELSE
              VBAIRRO := f_reduz_bairro(TC.NOM_BAIRRO, 0); -- BAIRRO REDUZIDO
            END IF;
          ELSE
            VBAIRRO := TC.NOM_BAIRRO; -- BAIRRO INTEIRO
          END IF;

          --INSERT INTO END_MIGRA VALUES (VBAIRRO,NULL,TENDERECO.NOBAIRRO,NULL,NULL,NULL,TENDERECO.NRREGISTRO);

          --FINAL DA VERIFICACAO E TRATAMENTO DO ENDERECO

          --TRATAMENTO DO ENDERECO DE COBRANÇA
          --QTDE E CONTEUDOS DO ENDERECO
          VQTLOGRA             := LENGTH(TRIM(TC.NOM_ENDERECO_COBR));
          VQTCOMPL             := LENGTH(TRIM(TC.NOM_ENDER_COMPL_COBR));
          VQTLOGRA_REDUZ       := LENGTH(TRIM(F_REDUZ_END(TC.NOM_ENDERECO_COBR,
                                                          0)));
          VQTCOMPL_REDUZ       := LENGTH(TRIM(F_REDUZ_COMPL(TC.NOM_ENDER_COMPL_COBR,
                                                            0)));
          VQTLOGRA_REDUZ_ABREV := LENGTH(TRIM(F_REDUZ_END_ABREV(F_REDUZ_END(TC.NOM_ENDERECO_COBR,
                                                                            0),
                                                                0)));
          VQTNRIMOVEL          := LENGTH(TC.NRIMOVEL_COBR);
          VLOGRA               := TRIM(TC.NOM_ENDERECO_COBR);
          VCOMPL               := NVL(TRIM(TC.NOM_ENDER_COMPL_COBR), ' ');
          VLOGRA_REDUZ         := TRIM(F_REDUZ_END(TC.NOM_ENDERECO_COBR, 0));
          VCOMPL_REDUZ         := TRIM(F_REDUZ_COMPL(TC.NOM_ENDER_COMPL_COBR,
                                                     0));
          VLOGRA_REDUZ_ABREV   := TRIM(F_REDUZ_END_ABREV(F_REDUZ_END(TC.NOM_ENDERECO_COBR,
                                                                     0),
                                                         0));

          --TRATATIVA DOS ENDEÇOES E LOGRADOUROS (21/10/2016)
          --COMPLEMENTO NULO OU ATÉ 10 E O LOGRADOURO + NRIMOVEL ATÉ 40
          --LINHAS 1 E 2 DA PLANILHA
          IF ((VCOMPL IS NULL OR LENGTH(VCOMPL) <= VQTCOMPLEMENTO) AND
             VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) <= VQTLOGRADOURO) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA;
            ELSE
              VLOGRADOURO_COBR := VLOGRA || ' ' || TC.NRIMOVEL_COBR;
            END IF;

            VCOMPLEMENTO_COBR := VCOMPL;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '1', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DAS LINHAS 1 E 2
            --LOGRADOURO+NRIMOVEL ACIMA DE 40, PORÉM LOGRAD+IMOVEL REDUZ ATÉ 40 E O COMPLEMENTO ATÉ 10
            --LINHA 3 DA PLANILHA
          ELSIF (((VQTCOMPL <= VQTCOMPLEMENTO) OR (VQTCOMPL IS NULL)) AND
                VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) <=
                VQTLOGRADOURO) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA_REDUZ;
            ELSE
              VLOGRADOURO_COBR := VLOGRA_REDUZ || ' ' || TC.NRIMOVEL_COBR;
            END IF;

            VCOMPLEMENTO_COBR := VCOMPL;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '3', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 3
            --COMPLEMENTO ACIMA DE 10, PORÉM COMPL REDUZ ATÉ 10 E O LOGRADOURO + NRIMOVEL ATÉ 40
            --LINHA 4 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
                VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) <= VQTLOGRADOURO) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA;
            ELSE
              VLOGRADOURO_COBR := VLOGRA || ' ' || TC.NRIMOVEL_COBR;
            END IF;

            VCOMPLEMENTO_COBR := VCOMPL_REDUZ;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '4', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 4
            --COMPLEMENTO ACIMA DE 10, PORÉM COMPL REDUZ ATÉ 10 E O LOGRADOURO + NRIMOVEL ACIMA DE 40, PORÉM LOGR+IMOVEL REDUZ ATÉ 40
            --LINHA 5 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA_REDUZ;
            ELSE
              VLOGRADOURO_COBR := VLOGRA_REDUZ || ' ' || TC.NRIMOVEL_COBR;
            END IF;

            VCOMPLEMENTO_COBR := VCOMPL_REDUZ;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '5', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 5

            --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO + NRIMOVEL ATE 40
            --LINHA 6 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) + 1 + VQTCOMPL_REDUZ <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA || '-' || VCOMPL_REDUZ;
            ELSE
              VLOGRADOURO_COBR := VLOGRA || ' ' || TC.NRIMOVEL_COBR || '-' ||
                                  VCOMPL_REDUZ;
            END IF;

            VCOMPLEMENTO_COBR := ' ';

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '6', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 6
            --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO REDUZ + NRIMOVEL ATE 40
            --LINHA 7 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) + 1 + VQTCOMPL_REDUZ >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) + 1 +
                VQTCOMPL_REDUZ <= VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA_REDUZ || '-' || VCOMPL_REDUZ;
            ELSE
              VLOGRADOURO_COBR := VLOGRA_REDUZ || ' ' || TC.NRIMOVEL_COBR || '-' ||
                                  VCOMPL_REDUZ;
            END IF;

            VCOMPLEMENTO_COBR := ' ';

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '7', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 7
            --COMPLEMENTO NULO OU ATÉ 10, LOGR REDUZ + NR ACIMA DE 40, PORÉM LOGRADOURO REDUZ E ABREV + NRIMOVEL ATE 40
            --LINHA 8 DA PLANILHA
          ELSIF ((VQTCOMPL <= VQTCOMPLEMENTO OR VCOMPL IS NULL) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL + 1), 0) <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA_REDUZ_ABREV;
            ELSE
              VLOGRADOURO_COBR := VLOGRA_REDUZ_ABREV || ' ' ||
                                  TC.NRIMOVEL_COBR;
            END IF;

            VCOMPLEMENTO_COBR := VCOMPL;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 8

            --COMPLEMENTO ACIMA DE 10, PORÉM REDUZ ATÉ 10 E LOGR REDUZ + NR ACIMA DE 40, PORÉM LOGRADOURO REDUZ E ABREV + NRIMOVEL ATE 40
            --LINHA 9 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ <= VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL + 1), 0) <=
                VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA_REDUZ_ABREV;
            ELSE
              VLOGRADOURO_COBR := VLOGRA_REDUZ_ABREV || ' ' ||
                                  TC.NRIMOVEL_COBR;
            END IF;

            VCOMPLEMENTO_COBR := VCOMPL_REDUZ;

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 9
            --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO REDUZ E ABREVIADO (ÚLTIMO RECURSO) + NRIMOVEL ATE 40
            --LINHA 10 DA PLANILHA
          ELSIF ((VQTCOMPL > VQTCOMPLEMENTO AND
                VQTCOMPL_REDUZ > VQTCOMPLEMENTO) AND
                (VQTLOGRA + NVL((VQTNRIMOVEL + 1), 0) + 1 + VQTCOMPL_REDUZ >
                VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ + NVL((VQTNRIMOVEL + 1), 0) + 1 +
                VQTCOMPL_REDUZ > VQTLOGRADOURO) AND
                (VQTLOGRA_REDUZ_ABREV + NVL((VQTNRIMOVEL + 1), 0) + 1 +
                VQTCOMPL_REDUZ <= VQTLOGRADOURO)) THEN

            IF TC.NRIMOVEL_COBR IS NULL THEN
              VLOGRADOURO_COBR := VLOGRA_REDUZ_ABREV || '-' || VCOMPL_REDUZ;
            ELSE
              VLOGRADOURO_COBR := VLOGRA_REDUZ_ABREV || ' ' ||
                                  TC.NRIMOVEL_COBR || '-' || VCOMPL_REDUZ;
            END IF;

            VCOMPLEMENTO_COBR := ' ';

            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            --FIM DA TRATATIVA DA LINHA 10
          else
            --*****ver se ficará
            --INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '0', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

            VLOGRADOURO_COBR  := NULL;
            VCOMPLEMENTO_COBR := NULL;

            /*   -- ERRO - NAO ENTROU EM NENHUM DOS IFS ACIMA
                ELSIF ((LENGTH(TENDERECO.TXCOMPLEMENTO) > VQTCOMPLEMENTO AND LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0))> VQTCOMPLEMENTO) AND
                     ((LENGTH(TRIM(TENDERECO.NOLOGRADOURO)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
                     ((LENGTH(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
                     ((LENGTH(F_REDUZ_END_ABREV(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO)
                     ) THEN

                  -- VER COM O VINI PARA GRAVAR FALHA NO PROCESSO
                  VLOGRADOURO  := NULL;
                  VCOMPLEMENTO := NULL;

                  INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '9', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);
            */
          END IF;

          --VALIDACAO DO TAMANHO DO BAIRRO
          --SE NAO ENVIAR O BAIRRO COMPLETO, TENTA O REDUZIDO E POR ÚLTIMO TRUNCA
          VBAIRRO_COBR := '';

          IF LENGTH(TC.NOM_BAIRRO_COBR) > 20 THEN
            IF LENGTH(f_reduz_bairro(TC.NOM_BAIRRO_COBR, 0)) > 20 THEN
              VBAIRRO_COBR := SUBSTR(F_REDUZ_BAIRRO(TC.NOM_BAIRRO_COBR, 0),
                                     1,
                                     20); --20 POSICOES DO REDUZIDO
            ELSE
              VBAIRRO_COBR := f_reduz_bairro(TC.NOM_BAIRRO_COBR, 0); -- BAIRRO REDUZIDO
            END IF;
          ELSE
            VBAIRRO_COBR := TC.NOM_BAIRRO_COBR; -- BAIRRO INTEIRO
          END IF;

          --INSERT INTO END_MIGRA VALUES (VBAIRRO,NULL,TENDERECO.NOBAIRRO,NULL,NULL,NULL,TENDERECO.NRREGISTRO);

          --FINAL DA VERIFICACAO E TRATAMENTO DO ENDERECO

          INSERT INTO TI_CLIENTE
            (COD_ORG_EMIS_ID_ESTAD, --1
             DAT_NASCIMENTO, --2
             COD_ID_FEDER_NASC,
             NOM_NACIONALIDADE,
             IND_ESTADO_CIVIL,
             COD_CX_POST,
             NOM_HOME_PAGE,
             DAT_IMPL_CLIEN,
             COD_TIP_FLUXO_FINANC,
             NUM_DIAS_ATRASO_AVDEB,
             DAT_PROCESSAMENTO,
             CDSITUACAO,
             COD_EMPRESA,
             COD_ID_FEDER_JURID,
             COD_CEP_COBR, --16
             DEST_ANOT_TABELA,
             COD_CART_BCIA_PREFER,
             IND_TIPO_PESSOA, --19
             COD_ID_FEDER_MATRIZ,
             COD_PAIS_NASC,
             NOM_MAE,
             NOM_PROFISSAO,
             NOM_CIDADE, --24
             COD_CEP, --25
             COD_TELEFONE_1,
             COD_TELEFONE_3,
             COD_FAX,
             NOM_BAIRRO_COBR, --29
             COD_UNID_FEDER_COBR, --30
             COD_GRP_CLIEN,
             COD_PORTAD_PREFER,
             LOG_CALC_MULTA,
             IND_OCORRENCIA,
             NRSEQ_CONTROLE_INTEGRACAO,
             COD_CLIENTE,
             NOM_CLIENTE, --39
             NOM_ABREV,
             COD_ID_FEDER_ESTAD_JURID,
             COD_ID_PREVID_SOCIAL,
             LOG_FINS_LUCRAT,
             COD_ID_ESTAD_FISIC,
             COD_ID_FEDER_EMIS_ESTAD,
             NOM_BAIRRO, --46
             COD_UNID_FEDER, --47
             COD_TELEFONE_2,
             COD_RAMAL_FAX, --49
             NOM_ENDER_COMPL_COBR, --50
             NOM_CIDADE_COBR, --51
             COD_CX_POST_COBR,
             COD_TIP_CLIEN,
             COD_ID_FEDER,
             NOM_ENDER_COMPL, --55
             COD_ACAO,
             NOM_ENDERECO, --58
             NOM_ENDERECO_COBR, --59
             COD_E_MAIL,
             COD_ID_MUNIC_JURID,
             NRSEQ_FAVORECIDO,
             NRPESSOA,
             COD_BANCO,
             COD_AGENC_BCIA,
             COD_DIGITO_AGENC_BCIA,
             COD_CTA_CORREN_BCO,
             COD_DIGITO_CTA_CORREN --9

             )
          VALUES
            (

             TC.COD_ORG_EMIS_ID_ESTAD, --1
             TC.DAT_NASCIMENTO,
             TC.COD_ID_FEDER_NASC,
             TC.NOM_NACIONALIDADE,
             TC.IND_ESTADO_CIVIL,
             TC.COD_CX_POST,
             TC.NOM_HOME_PAGE,
             TC.DAT_IMPL_CLIEN,
             TC.COD_TIP_FLUXO_FINANC, --10
             TC.NUM_DIAS_ATRASO_AVDEB,
             TC.DAT_PROCESSAMENTO,
             TC.CDSITUACAO,
             --          nm_arq_retorno,
             TC.COD_EMPRESA,
             TC.COD_ID_FEDER_JURID,
             RPAD(NVL(TRIM(TC.COD_CEP_COBR),
                      F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')),
                  8,
                  '0'),
             TC.DEST_ANOT_TABELA,
             TC.COD_CART_BCIA_PREFER,
             TC.IND_TIPO_PESSOA,
             TC.COD_ID_FEDER_MATRIZ,
             TC.COD_PAIS_NASC, --20
             -- Josias 29-06-2014
             -- estava estourando o nome da mae com mais de 40 posições
             TC.NOM_MAE,
             TC.NOM_PROFISSAO,
             NVL(TC.NOM_CIDADE, ' '),
             -- josias 29-06-2014
             RPAD(NVL(TRIM(TC.COD_CEP),
                      F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')),
                  8,
                  '0'),
             TC.COD_TELEFONE_1,
             TC.COD_TELEFONE_3,
             TC.COD_FAX,
             NVL(VBAIRRO_COBR, ' '), --TC.NOM_BAIRRO_COBR,
             TC.COD_UNID_FEDER_COBR,
             TC.COD_GRP_CLIEN,
             TC.COD_PORTAD_PREFER, --30
             TC.LOG_CALC_MULTA,
             TC.IND_OCORRENCIA,
             TC.NRSEQ_CONTROLE_INTEGRACAO,
             TC.COD_CLIENTE,
             TC.NOM_CLIENTE,
             TC.NOM_ABREV,
             TC.COD_ID_FEDER_ESTAD_JURID,
             TC.COD_ID_PREVID_SOCIAL, --40
             TC.LOG_FINS_LUCRAT,
             TC.COD_ID_ESTAD_FISIC,
             TC.COD_ID_FEDER_EMIS_ESTAD,
             NVL(VBAIRRO, ' '), --TC.NOM_BAIRRO,
             TC.COD_UNID_FEDER,
             TC.COD_TELEFONE_2,
             TC.COD_RAMAL_FAX,
             NVL(VCOMPLEMENTO_COBR, ' '), --TC.NOM_ENDER_COMPL_COBR,
             NVL(TC.NOM_CIDADE_COBR, ' '),
             TC.COD_CX_POST_COBR, --50
             TC.COD_TIP_CLIEN,
             TC.COD_ID_FEDER,
             NVL(VCOMPLEMENTO, ' '), --TC.NOM_ENDER_COMPL,
             TC.COD_ACAO,
             NVL(VLOGRADOURO, ' '), --TC.NOM_ENDERECO,
             NVL(VLOGRADOURO_COBR, ' '), --TC.NOM_ENDERECO_COBR,
             TC.COD_E_MAIL,
             TC.COD_ID_MUNIC_JURID, --60
             TC.NRSEQ_FAVORECIDO,
             TC.NRPESSOA,
             TC.COD_BANCO,
             CASE WHEN TC.COD_BANCO = ' ' THEN ' ' WHEN
             INSTR(TC.COD_AGENC_BCIA, '-') > 0 THEN
             SUBSTR(LPAD(F_DEFINIR_NUMERICO(SUBSTR(TC.COD_AGENC_BCIA,
                                                   1,
                                                   INSTR(TC.COD_AGENC_BCIA,
                                                         '-') - 1)),
                         F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'A'),
                         '0'),
                    1,
                    F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'A')) ELSE
             SUBSTR(LPAD(F_DEFINIR_NUMERICO(TC.COD_AGENC_BCIA),
                         F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'A'),
                         '0'),
                    1,
                    F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'A')) END, --COD_AGENC_BCIA
             CASE WHEN TC.COD_BANCO = ' ' THEN ' ' WHEN
             INSTR(TC.COD_AGENC_BCIA, '-') > 0 THEN
             SUBSTR(TC.COD_AGENC_BCIA, INSTR(TC.COD_AGENC_BCIA, '-') + 1, 1) ELSE ' ' END, --COD_DIGITO_AGENC_BCIA
             CASE WHEN TC.COD_BANCO = ' ' THEN ' ' WHEN
              INSTR(TC.COD_CTA_CORREN_BCO, '-') > 0 THEN
              SUBSTR(LPAD(F_DEFINIR_NUMERICO(SUBSTR(TC.COD_CTA_CORREN_BCO,
                                                    1,
                                                    INSTR(TC.COD_CTA_CORREN_BCO,
                                                          '-') - 1)),
                          F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'C'),
                          '0'),
                     1,
                     F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'C')) ELSE
             --                                        substr(t.nrconta_bancaria,1, f_ret_masc_banco(lpad(t.nrbanco,3,'0'),'C'))
              SUBSTR(LPAD(F_DEFINIR_NUMERICO(TC.COD_CTA_CORREN_BCO),
                          F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'C'),
                          '0'),
                     1,
                     F_RET_MASC_BANCO(LPAD(TC.COD_BANCO, 3, '0'), 'C')) END, -- COD_CTA_CORREN_BCO
             CASE WHEN TC.COD_BANCO = ' ' THEN ' ' WHEN
             INSTR(TC.COD_CTA_CORREN_BCO, '-') > 0 THEN
             SUBSTR(TC.COD_CTA_CORREN_BCO,
                    INSTR(TC.COD_CTA_CORREN_BCO, '-') + 1,
                    1) ELSE ' ' END --COD_DIGITO_CTA_CORREN
             );
        END LOOP;

        IF SQL%ROWCOUNT = 0 THEN
          P_TI_VALIDA_ENDERECO(L_INTEGRA_CLIFOR.NRPESSOA,
                               L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                               'TI_CLIENTE',
                               PCDSITUACAO);
          IF PCDSITUACAO = 'RC' THEN
            P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                          'TI_CLIENTE',
                          'Dados no encontrados na V_ti_cliente PARA O PROCESSO',
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        END IF;

        P_COMMIT;

      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                        'TI_CLIENTE',
                        'O cliente j foi enviado para a TI_CLIENTE',
                        NULL,
                        PCDSITUACAO,
                        -1);
        WHEN OTHERS THEN
          BEGIN
            P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                          'TI_CLIENTE',
                          SQLERRM,
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END;
      END;
      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  PROCEDURE P_GERAR_DADOS_BANC_FORNEC(VP_COD_EMPRESA IN NUMBER) IS
    /*
    ***************************************************************************************************************
    Criacão          : Josias Rodrigues
    Data             : -
    Modulo Principal : Integracão EMS5
    Modulos          : -
    Objetivo         : Gerar os dados bancários do Fornecedor Unicoo para o EMS5
    Alteracoes
    +------------------------------------------------------------------------------------------------------------------------------------------+
    | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 25/09/2014 | JOSIAS        |               |           | Criação do Objeto                                                                  |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    */
  BEGIN
    DECLARE
      VCDFORNEC_ANTERIOR number := 0;

      CURSOR C_ATU IS
        SELECT VP_COD_EMPRESA COD_EMPRESA,
               P.CDN_FORNECEDOR,
               LPAD(T.NRBANCO, 3, '0') COD_BANCO,
               CASE
                 WHEN INSTR(T.NRAGENCIA, '-') > 0 THEN
                  SUBSTR(LPAD(F_DEFINIR_NUMERICO(SUBSTR(T.NRAGENCIA,
                                                        1,
                                                        INSTR(T.NRAGENCIA,
                                                              '-') - 1)),
                              F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'),
                              '0'),
                         1,
                         F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'))
                 ELSE
                  SUBSTR(LPAD(F_DEFINIR_NUMERICO(T.NRAGENCIA),
                              F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'),
                              '0'),
                         1,
                         F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'))
               END COD_AGENC_BCIA,
               CASE
                 WHEN INSTR(T.NRAGENCIA, '-') > 0 THEN
                  SUBSTR(T.NRAGENCIA, INSTR(T.NRAGENCIA, '-') + 1, 1)
                 ELSE
                  ' '
               END COD_DIGITO_AGENC_BCIA,
               CASE
                 WHEN INSTR(T.NRCONTA_BANCARIA, '-') > 0 THEN
                  SUBSTR(LPAD(F_DEFINIR_NUMERICO(SUBSTR(T.NRCONTA_BANCARIA,
                                                        1,
                                                        INSTR(T.NRCONTA_BANCARIA,
                                                              '-') - 1)),
                              F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'),
                              '0'),
                         1,
                         F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'))
                 ELSE
                 --                                        substr(t.nrconta_bancaria,1, f_ret_masc_banco(lpad(t.nrbanco,3,'0'),'C'))
                  SUBSTR(LPAD(F_DEFINIR_NUMERICO(T.NRCONTA_BANCARIA),
                              F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'),
                              '0'),
                         1,
                         F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'))
               END COD_CTA_CORREN_BCO,
               CASE
                 WHEN INSTR(T.NRCONTA_BANCARIA, '-') > 0 THEN
                  SUBSTR(T.NRCONTA_BANCARIA,
                         INSTR(T.NRCONTA_BANCARIA, '-') + 1,
                         1)
                 ELSE
                  ' '
               END COD_DIGITO_CTA_CORREN,
               DECODE(T.TPCONTA,
                      'CC',
                      'CONTA CORRENTE',
                      'CA',
                      'CONTA APLICACAO',
                      'CP',
                      'CONTA POUPANCA',
                      'CX',
                      'CONTA CAIXA',
                      'TIPO DE CONTA NAO IDENTIFICADO') TPCONTA
          FROM FORNECEDOR_AGENCIA_BANCARIA         T,
               PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA F,
               TI_PESSOA                           P,
               FORNEC_FINANC                       FF
         WHERE T.CDFORNECEDOR = F.CDFORNECEDOR
           AND F.NRREGISTRO_FORNECEDOR = P.NRREGISTRO
           AND FF.U##COD_EMPRESA = VP_COD_EMPRESA
           AND P.CDN_FORNECEDOR = FF.CDN_FORNECEDOR
           AND P.CDN_FORNECEDOR IS NOT NULL
        --AND T.TPCONTA = 'CC'
         order by t.CDFORNECEDOR,
                  DECODE(T.AOENVIO_BANCO, 'S', 'A', T.AOENVIO_BANCO),
                  DECODE(T.AOCONTA_PRESTADOR, 'S', 'A', T.AOCONTA_PRESTADOR),
                  decode(T.tpconta, 'CC', 'AA', T.TPCONTA);
    BEGIN

      FOR X IN C_ATU LOOP

        IF X.CDN_FORNECEDOR <> VCDFORNEC_ANTERIOR THEN
          UPDATE FORNEC_FINANC V
             SET V.COD_BANCO             = nvl(X.COD_BANCO, ' '),
                 V.COD_AGENC_BCIA        = nvl(X.COD_AGENC_BCIA, ' '),
                 V.COD_DIGITO_AGENC_BCIA = nvl(X.COD_DIGITO_AGENC_BCIA, ' '),
                 V.COD_CTA_CORREN_BCO    = nvl(X.COD_CTA_CORREN_BCO, ' '),
                 V.COD_DIGITO_CTA_CORREN = nvl(X.COD_DIGITO_CTA_CORREN, ' ')
           WHERE V.U##COD_EMPRESA = X.COD_EMPRESA
             AND V.CDN_FORNECEDOR = X.CDN_FORNECEDOR;

          VCDFORNEC_ANTERIOR := X.CDN_FORNECEDOR;

          BEGIN
            INSERT INTO cta_corren_fornec
              (u##cod_empresa,
               cod_empresa,
               cdn_fornecedor,
               u##cod_banco,
               cod_banco,
               u##cod_agenc_bcia,
               cod_agenc_bcia,
               u##cod_digito_agenc_bcia,
               cod_digito_agenc_bcia,
               U##cod_cta_corren_bco,
               cod_cta_corren_bco,
               u##cod_digito_cta_corren,
               cod_digito_cta_corren,
               des_cta_corren,
               log_cta_corren_prefer,
               progress_recid)
            VALUES
              (x.cod_empresa,
               x.cod_empresa,
               x.cdn_fornecedor,
               nvl(X.COD_BANCO, ' '),
               nvl(X.COD_BANCO, ' '),
               nvl(X.COD_AGENC_BCIA, ' '),
               nvl(X.COD_AGENC_BCIA, ' '),
               nvl(X.COD_DIGITO_AGENC_BCIA, ' '),
               nvl(X.COD_DIGITO_AGENC_BCIA, ' '),
               nvl(X.COD_CTA_CORREN_BCO, ' '),
               nvl(X.COD_CTA_CORREN_BCO, ' '),
               nvl(X.COD_DIGITO_CTA_CORREN, ' '),
               nvl(X.COD_DIGITO_CTA_CORREN, ' '),
               X.TPCONTA,
               '1',
               EMS5.CTA_CORREN_FORNEC_SEQ.NEXTVAL);
          EXCEPTION
            WHEN DUP_VAL_ON_INDEX THEN
              INSERT INTO cta_corren_fornec_falha
                (u##cod_empresa,
                 cod_empresa,
                 cdn_fornecedor,
                 u##cod_banco,
                 cod_banco,
                 u##cod_agenc_bcia,
                 cod_agenc_bcia,
                 u##cod_digito_agenc_bcia,
                 cod_digito_agenc_bcia,
                 U##cod_cta_corren_bco,
                 cod_cta_corren_bco,
                 u##cod_digito_cta_corren,
                 cod_digito_cta_corren,
                 des_cta_corren,
                 log_cta_corren_prefer,
                 progress_recid,
                 txfalha)
              VALUES
                (x.cod_empresa,
                 x.cod_empresa,
                 x.cdn_fornecedor,
                 nvl(X.COD_BANCO, ' '),
                 nvl(X.COD_BANCO, ' '),
                 nvl(X.COD_AGENC_BCIA, ' '),
                 nvl(X.COD_AGENC_BCIA, ' '),
                 nvl(X.COD_DIGITO_AGENC_BCIA, ' '),
                 nvl(X.COD_DIGITO_AGENC_BCIA, ' '),
                 nvl(X.COD_CTA_CORREN_BCO, ' '),
                 nvl(X.COD_CTA_CORREN_BCO, ' '),
                 nvl(X.COD_DIGITO_CTA_CORREN, ' '),
                 nvl(X.COD_DIGITO_CTA_CORREN, ' '),
                 X.TPCONTA,
                 '0',
                 EMS5.CTA_CORREN_FORNEC_SEQ.CURRVAL,
                 'PESSOA COM CONTA CORRENTE DUPLICADA. TALVEZ ESTA PESSOA POSSUA DOIS CODIGOS DE FORNECEDOR COM AS MESMAS CONTAS. VERIFICAR TAMBEM SE AS MESMAS NAO ESTAO COM O SINALIZADOR DE ENVIA BANCO DIFERENTES');

          END;
        ELSE
          BEGIN
            INSERT INTO cta_corren_fornec
              (u##cod_empresa,
               cod_empresa,
               cdn_fornecedor,
               u##cod_banco,
               cod_banco,
               u##cod_agenc_bcia,
               cod_agenc_bcia,
               u##cod_digito_agenc_bcia,
               cod_digito_agenc_bcia,
               U##cod_cta_corren_bco,
               cod_cta_corren_bco,
               u##cod_digito_cta_corren,
               cod_digito_cta_corren,
               des_cta_corren,
               log_cta_corren_prefer,
               progress_recid)
            VALUES
              (x.cod_empresa,
               x.cod_empresa,
               x.cdn_fornecedor,
               nvl(X.COD_BANCO, ' '),
               nvl(X.COD_BANCO, ' '),
               nvl(X.COD_AGENC_BCIA, ' '),
               nvl(X.COD_AGENC_BCIA, ' '),
               nvl(X.COD_DIGITO_AGENC_BCIA, ' '),
               nvl(X.COD_DIGITO_AGENC_BCIA, ' '),
               nvl(X.COD_CTA_CORREN_BCO, ' '),
               nvl(X.COD_CTA_CORREN_BCO, ' '),
               nvl(X.COD_DIGITO_CTA_CORREN, ' '),
               nvl(X.COD_DIGITO_CTA_CORREN, ' '),
               X.TPCONTA,
               '0',
               EMS5.CTA_CORREN_FORNEC_SEQ.NEXTVAL);

          EXCEPTION
            WHEN DUP_VAL_ON_INDEX THEN
              INSERT INTO cta_corren_fornec_falha
                (u##cod_empresa,
                 cod_empresa,
                 cdn_fornecedor,
                 u##cod_banco,
                 cod_banco,
                 u##cod_agenc_bcia,
                 cod_agenc_bcia,
                 u##cod_digito_agenc_bcia,
                 cod_digito_agenc_bcia,
                 U##cod_cta_corren_bco,
                 cod_cta_corren_bco,
                 u##cod_digito_cta_corren,
                 cod_digito_cta_corren,
                 des_cta_corren,
                 log_cta_corren_prefer,
                 progress_recid,
                 txfalha)
              VALUES
                (x.cod_empresa,
                 x.cod_empresa,
                 x.cdn_fornecedor,
                 nvl(X.COD_BANCO, ' '),
                 nvl(X.COD_BANCO, ' '),
                 nvl(X.COD_AGENC_BCIA, ' '),
                 nvl(X.COD_AGENC_BCIA, ' '),
                 nvl(X.COD_DIGITO_AGENC_BCIA, ' '),
                 nvl(X.COD_DIGITO_AGENC_BCIA, ' '),
                 nvl(X.COD_CTA_CORREN_BCO, ' '),
                 nvl(X.COD_CTA_CORREN_BCO, ' '),
                 nvl(X.COD_DIGITO_CTA_CORREN, ' '),
                 nvl(X.COD_DIGITO_CTA_CORREN, ' '),
                 X.TPCONTA,
                 '0',
                 EMS5.CTA_CORREN_FORNEC_SEQ.CURRVAL,
                 'PESSOA COM CONTA CORRENTE DUPLICADA. TALVEZ ESTA PESSOA POSSUA DOIS CODIGOS DE FORNECEDOR COM AS MESMAS CONTAS. VERIFICAR TAMBEM SE AS MESMAS NAO ESTAO COM O SINALIZADOR DE ENVIA BANCO DIFERENTES');
          END;
        END IF;

      END LOOP;
    END;
    P_COMMIT_NEW;
    --commit;
  END;

  FUNCTION F_RET_MASC_BANCO(VPCOD_BANCO IN VARCHAR2, VPTIPO IN VARCHAR2)
    RETURN NUMBER IS
    -- tipo "A" agencia , "C" conta
    VRESULT NUMBER;
  BEGIN
    -- verificar se o tipo de consulta é da agencia
    IF VPTIPO = 'A' THEN
      BEGIN
        SELECT LENGTH(B.COD_FORMAT_AGENC_BCIA)
          INTO VRESULT
          FROM BANCO B
         WHERE B.COD_BANCO = VPCOD_BANCO;
      EXCEPTION
        WHEN OTHERS THEN
          RETURN 10;
      END;
      RETURN VRESULT;
    ELSIF VPTIPO = 'C' THEN
      BEGIN
        SELECT LENGTH(B.COD_FORMAT_CTA_CORREN)
          INTO VRESULT
          FROM BANCO B
         WHERE B.COD_BANCO = VPCOD_BANCO;
      EXCEPTION
        WHEN OTHERS THEN
          RETURN 10;
      END;
    END IF;
    RETURN VRESULT;
  END;

  FUNCTION F_DEFINIR_NUMERICO(VP_CODIGO VARCHAR2) RETURN NUMBER IS
    VAUX VARCHAR2(20);
  BEGIN
    VAUX := '';
    FOR X IN 1 .. LENGTH(VP_CODIGO) LOOP
      IF SUBSTR(VP_CODIGO, X, 1) IN
         ('0', '1', '2', '3', '4', '5', '6', '7', '8', '9') THEN
        VAUX := VAUX || SUBSTR(VP_CODIGO, X, 1);
      END IF;
    END LOOP;
    RETURN TO_NUMBER(NVL(VAUX, 0));
  END;

  procedure p_vincula_imposto_cliente is

    temp_impto_vincul_clien ems5.impto_vincul_clien%rowtype;

    cursor c_impto_clien is
      select distinct ttx.ind_clas_impto_unicoo,
                      ttx.cod_imposto_t11,
                      ttx.cod_classif_impto_t11,
                      tp.cdn_cliente
        from titulo_a_receber                 tr,
             taxa_titulo_a_receber            t,
             ti_taxa_a_receber                ttx,
             producao.cliente@unicoo_homologa cl,
             ti_pessoa                        tp
       where tr.nrregistro_titulo = t.nrregistro_titulo
         and ttx.cod_taxa_unicoo = t.cdtaxa
         and cl.cdcliente = tr.cdcliente
         and cl.nrregistro_cliente = tp.nrregistro;

  begin
    for ci in c_impto_clien loop

      temp_impto_vincul_clien.u##cod_empresa       := F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA');
      temp_impto_vincul_clien.cod_empresa          := F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA');
      temp_impto_vincul_clien.cdn_cliente          := ci.cdn_cliente;
      temp_impto_vincul_clien.u##cod_pais          := F_TI_PARAMETRO_INTEGRACAO('COD_PAIS');
      temp_impto_vincul_clien.cod_pais             := F_TI_PARAMETRO_INTEGRACAO('COD_PAIS');
      temp_impto_vincul_clien.u##cod_unid_federac  := ' '; --indo espaço como está no imposto fornecedor
      temp_impto_vincul_clien.cod_unid_federac     := ' '; --indo espaço como está no imposto fornecedor
      temp_impto_vincul_clien.u##cod_imposto       := ci.cod_imposto_t11;
      temp_impto_vincul_clien.cod_imposto          := ci.cod_imposto_t11;
      temp_impto_vincul_clien.u##cod_classif_impto := ci.cod_classif_impto_t11;
      temp_impto_vincul_clien.cod_classif_impto    := ci.cod_classif_impto_t11;
      temp_impto_vincul_clien.log_impto_opcnal     := 0;
      temp_impto_vincul_clien.cod_livre_1          := ' ';
      temp_impto_vincul_clien.log_livre_1          := 0;
      temp_impto_vincul_clien.num_livre_1          := 0;
      temp_impto_vincul_clien.val_livre_1          := 0;
      temp_impto_vincul_clien.dat_livre_1          := '';
      temp_impto_vincul_clien.cod_livre_2          := ' ';
      temp_impto_vincul_clien.dat_livre_2          := '';
      temp_impto_vincul_clien.log_livre_2          := 0;
      temp_impto_vincul_clien.num_livre_2          := 0;
      temp_impto_vincul_clien.val_livre_2          := 0;
      temp_impto_vincul_clien.cdd_version          := '0';

      select ems5.impto_vincul_clien_seq.nextval
        into temp_impto_vincul_clien.progress_recid
        from dual;

      insert into ems5.impto_vincul_clien values temp_impto_vincul_clien;

      update ems5.clien_financ cf
         set cf.log_retenc_impto = 1
       where cf.cdn_cliente = ci.cdn_cliente;

    end loop;

  end p_vincula_imposto_cliente;

  PROCEDURE P_VINCULA_IMPOSTO_FORNEC IS
    /*
    ***************************************************************************************************************
    Criac?o          : -
    Data             : -
    Modulo Principal : Integrac?o EMS5
    Modulos          : -
    Objetivo         : vincular os impostos do fornecedor no EMS5
    Alteracoes
    +------------------------------------------------------------------------------------------------------------------------------------------+
    | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 01/07/2014 | JOSIAS        |               |           | Atualizações necessárias   |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    */
  BEGIN
    BEGIN
      INSERT INTO IMPTO_VINCUL_FORNEC
        SELECT F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') U##COD_EMPRESA,
               F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') COD_EMPRESA,
               CDN_FORNECEDOR,
               F_TI_PARAMETRO_INTEGRACAO('COD_PAIS') U##COD_PAIS,
               F_TI_PARAMETRO_INTEGRACAO('COD_PAIS') COD_PAIS,
               COD_UNID_FEDERAC U##COD_UNID_FEDERAC,
               COD_UNID_FEDERAC COD_UNID_FEDERAC,
               CDTAXA U##COD_IMPOSTO,
               CDTAXA COD_IMPOSTO,
               CDCLASS U##COD_CLASSIF_IMPTO,
               CDCLASS COD_CLASSIF_IMPTO,
               0 LOG_IMPTO_OPCNAL,
               ' ' COD_LIVRE_1,
               0 LOG_LIVRE_1,
               0 NUM_LIVRE_1,
               0 VAL_LIVRE_1,
               TRUNC(SYSDATE) DAT_LIVRE_1,
               0 NUMREDUZRENDTOTRIBUT,
               ' ' COD_LIVRE_2,
               NULL DAT_LIVRE_2,
               0 LOG_LIVRE_2,
               0 NUM_LIVRE_2,
               0 VAL_LIVRE_2,
               0 CDD_VERSION,
               EMS5.IMPTO_VINCUL_FORNEC_SEQ.NEXTVAL PROGRESS_RECID
          FROM (SELECT DISTINCT F_TI_IMPOSTO_AGRUPADO(XX.COD_IMPOSTO,
                                                      TTP.NRREGISTRO_TITULO) CDTAXA,
                                F_TI_IMPOSTO_AGRUPADO(XX.COD_CLASSIF_IMPTO,
                                                      TTP.NRREGISTRO_TITULO) CDCLASS,
                                TIP.CDN_FORNECEDOR,
                                XX.COD_UNID_FEDERAC
                  FROM TAXA_TITULO_A_PAGAR                 TTP,
                       TITULO_A_PAGAR                      TP,
                       PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FN,
                       TI_TAXA_A_PAGAR                     XX,
                       TI_PESSOA                           TIP,
                       TI_FORNECEDOR                       TIF
                 WHERE XX.COD_TAXA = TTP.CDTAXA
                   AND TIP.NRREGISTRO = FN.NRREGISTRO_FORNECEDOR
                   AND FN.CDFORNECEDOR = TP.CDFORNECEDOR
                   AND TP.NRREGISTRO_TITULO = TTP.NRREGISTRO_TITULO
                   AND TIF.NRPESSOA = TIP.NRREGISTRO
                   AND TIP.CDN_FORNECEDOR IS NOT NULL
                   AND NOT EXISTS
                 (SELECT 1
                          FROM IMPTO_VINCUL_FORNEC IVF
                         WHERE IVF.CDN_FORNECEDOR    = TIP.CDN_FORNECEDOR
                           AND IVF.COD_CLASSIF_IMPTO =
                               F_TI_IMPOSTO_AGRUPADO(XX.COD_CLASSIF_IMPTO,
                                                     TTP.NRREGISTRO_TITULO)
                           AND IVF.U##COD_EMPRESA     = F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --'1' --FN.COD_EMPRESA
                           AND IVF.U##COD_PAIS        = F_TI_PARAMETRO_INTEGRACAO('COD_PAIS') --'BRA' --FN.COD_PAIS
                           --AND IVF.U##COD_UNID_FEDERAC = ' '
                           AND IVF.U##COD_UNID_FEDERAC = COD_UNID_FEDERAC
                           AND IVF.U##COD_IMPOSTO      = XX.COD_IMPOSTO));
    exception
      when others then
        raise_application_error(-20100,
                                ' erro inserindo impostos ' || sqlerrm);
    end;
    P_COMMIT_NEW;

    /* Alex Boeira - 20/02/2017 - garantir vinculacao de INSSPF e IRPF para Fornecedores PF.
     *               Motivo: conforme Luiz Henrique (Unimed NI), caso o prestador não recolha
     *                       pela Unimed (tem outra fonte), não é gerada movimentação de recolhimento,
     *                       o que faz com que a lógica acima deixe de gerar a vinculação do INSSPF.
     *                       Além disso, há prestadores com produção inferior ao valor mínimo para
     *                       retenção de IR, dessa forma também não cria TAXA_TITULO_A_PAGAR.
     */

    BEGIN
      INSERT INTO IMPTO_VINCUL_FORNEC
        SELECT
               trim(upper(F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA'))) U##COD_EMPRESA,
               trim(F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')) COD_EMPRESA,
               trim(tip.CDN_FORNECEDOR),
               trim(upper(F_TI_PARAMETRO_INTEGRACAO('COD_PAIS'))) U##COD_PAIS,
               trim(F_TI_PARAMETRO_INTEGRACAO('COD_PAIS')) COD_PAIS,
               upper(t.COD_UNID_FEDERAC) U##COD_UNID_FEDERAC,
               t.COD_UNID_FEDERAC COD_UNID_FEDERAC,
               trim(upper(i.cod_imposto)) U##COD_IMPOSTO,
               trim(i.cod_imposto) COD_IMPOSTO,
               trim(upper(t.cod_classif_impto)) U##COD_CLASSIF_IMPTO,
               trim(t.cod_classif_impto) COD_CLASSIF_IMPTO,
               0 LOG_IMPTO_OPCNAL,
               ' ' COD_LIVRE_1,
               0 LOG_LIVRE_1,
               0 NUM_LIVRE_1,
               0 VAL_LIVRE_1,
               TRUNC(SYSDATE) DAT_LIVRE_1,
               0 NUMREDUZRENDTOTRIBUT,
               ' ' COD_LIVRE_2,
               NULL DAT_LIVRE_2,
               0 LOG_LIVRE_2,
               0 NUM_LIVRE_2,
               0 VAL_LIVRE_2,
               0 CDD_VERSION,
               EMS5.IMPTO_VINCUL_FORNEC_SEQ.NEXTVAL PROGRESS_RECID
          from ems5.imposto i,
               ti_taxa_a_pagar t,
               TI_PESSOA                           TIP,
               TI_FORNECEDOR                       TIF
          where t.cod_imposto = i.cod_imposto
            AND (   (UPPER(I.DES_IMPOSTO) LIKE '%' || 'INSS' || '%' || 'PF'  || '%')
                 OR (UPPER(I.DES_IMPOSTO) LIKE '%' || 'INSS' || '%' || 'FIS' || '%')
                 OR (UPPER(I.DES_IMPOSTO) LIKE '%' || 'IR'   || '%' || 'PF'  || '%')
                 OR (UPPER(I.DES_IMPOSTO) LIKE '%' || 'IR'   || '%' || 'FIS' || '%')
                )
            and tif.cod_fornecedor = tip.cdn_fornecedor
            and tif.ind_tipo_pessoa = 'F'
            and tif.cod_acao = 'I'
            AND NOT EXISTS
           (SELECT 1
              FROM IMPTO_VINCUL_FORNEC IVF
             where IVF.U##COD_EMPRESA       = trim(upper(F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA'))) --'1' --FN.COD_EMPRESA
               and IVF.CDN_FORNECEDOR       = trim(TIP.CDN_FORNECEDOR)
               AND IVF.U##COD_PAIS          = trim(upper(F_TI_PARAMETRO_INTEGRACAO('COD_PAIS'))) --'BRA' --FN.COD_PAIS
               AND IVF.U##COD_UNID_FEDERAC  = upper(t.COD_UNID_FEDERAC) -- ' '
               AND IVF.U##COD_IMPOSTO       = trim(upper(i.cod_imposto))
               AND IVF.U##COD_CLASSIF_IMPTO = trim(upper(t.cod_classif_impto)));
    exception
      when others then
        raise_application_error(-20100,
                                ' erro inserindo impostos ' || sqlerrm);
    end;
    P_COMMIT_NEW;

    -------------------
    UPDATE FORNEC_FINANC F
       SET F.LOG_RETENC_IMPTO = 1
     WHERE EXISTS (SELECT 1
              FROM IMPTO_VINCUL_FORNEC I
             WHERE I.U##COD_EMPRESA = F.U##COD_EMPRESA
               AND I.CDN_FORNECEDOR = F.CDN_FORNECEDOR);
    --COMMIT;
  END P_VINCULA_IMPOSTO_FORNEC;

  PROCEDURE P_CONTABILIZACAO(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                             PNRPERIODO                 IN NUMBER,
                             PCDLOTE_INTEGRACAO         IN VARCHAR2,
                             PTXDESCRICAO_LOTE          IN VARCHAR2,
                             PDTLOTE                    IN DATE,
                             PCDEMPRESA                 IN VARCHAR2,
                             PTPPERIODO                 IN VARCHAR2,
                             PI_NRLOTE                  IN NUMBER,
                             PI_CDFUNCIONARIO           IN VARCHAR2) IS
    /*
    ***************************************************************************************************************
    Criac?o          : -
    Data             : -
    Modulo Principal : Integrac?o EMS5
    Modulos          : -
    Telas            : CR05FC7
    Objetivo         : Enviar os titulos do Unicoo para o EMS5

    Alteracoes
    +------------------------------------------------------------------------------------------------------------------------------------------+
    | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 04/11/2009 | ALECSANDRO    |               |           | A tabela TI_LANCAMENTO_CONTABIL foi alterada para TI_ITEM_LANCAMENTO_CONTABIL   |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 06/07/2009 | ERIC ARANTES  |               |           | Criado os cursores para trazer o centro custo no lancamento contabil            |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 01/07/2014 | JOSIAS        |               |           | Atualizações necessárias   |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|

    */
    CURSOR C_LANCTO_DEB IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             LC.CDCONTA_MEMO_DEB,
             LC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_DEB CDCONTA_CONTABIL,
             'DB' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO
        FROM LANCAMENTO_CONTABIL LC
       WHERE LC.CDCONTA_DEB IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND (LC.CDLANCTO_PADRAO =
             'L' ||
             SUBSTR(TO_NUMBER(SUBSTR(PCDLOTE_INTEGRACAO, 2, 10)), 1, 5) --pcdlote_integracao
             OR PCDLOTE_INTEGRACAO IS NULL);
    CURSOR C_LANCTO_CRED IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             LC.CDCONTA_MEMO_DEB,
             LC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_CRED CDCONTA_CONTABIL,
             'CR' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO
        FROM LANCAMENTO_CONTABIL LC
       WHERE LC.CDCONTA_CRED IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND (LC.CDLANCTO_PADRAO =
             'L' ||
             SUBSTR(TO_NUMBER(SUBSTR(PCDLOTE_INTEGRACAO, 2, 10)), 1, 5) --pcdlote_integracao
             OR PCDLOTE_INTEGRACAO IS NULL);
    /*
    TODO: owner="Eric" created="08/07/2010"
    text="Não sei se as outras integrações também recebem obrigatóriamente um numero de lote, por isso fiz esse tratamento em cursor separado para não afetar o que já funciona em "
    */
    ----> cursor para o fechamento de estoque
    CURSOR C_LANCTO_DEB_2 IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             IC.CDCONTA_MEMO_DEB,
             IC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_DEB CDCONTA_CONTABIL,
             'DB' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO,
             IC.CDORIGEM
        FROM LANCAMENTO_CONTABIL LC, INTEGRACAO_CONTABIL IC
       WHERE LC.NRLANCAMENTO = IC.NRLANCAMENTO
         AND LC.NRSEQ_LANCTO = IC.NRSEQ_LANCTO
         AND LC.CDCONTA_DEB IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND IC.NRLOTE_INTEGRACAO = PI_NRLOTE
         AND (LC.CDLANCTO_PADRAO = PCDLOTE_INTEGRACAO OR
             PCDLOTE_INTEGRACAO IS NULL);
    CURSOR C_LANCTO_CRED_2 IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             IC.CDCONTA_MEMO_DEB,
             IC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_CRED CDCONTA_CONTABIL,
             'CR' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO,
             IC.CDORIGEM
        FROM LANCAMENTO_CONTABIL LC, INTEGRACAO_CONTABIL IC
       WHERE LC.NRLANCAMENTO = IC.NRLANCAMENTO
         AND LC.NRSEQ_LANCTO = IC.NRSEQ_LANCTO
         AND LC.CDCONTA_CRED IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND IC.NRLOTE_INTEGRACAO = PI_NRLOTE
         AND (LC.CDLANCTO_PADRAO = PCDLOTE_INTEGRACAO OR
             PCDLOTE_INTEGRACAO IS NULL);
    VCOD_CCUSTO TI_CENTRO_CUSTO_CTBL.COD_CCUSTO%TYPE;
    VCOD_ESTAB  TI_CENTRO_CUSTO_CTBL.COD_ESTAB%TYPE;
    VA_CODESTAB VARCHAR2(2) := '01';
    VCDSITUACAO VARCHAR2(2);
  BEGIN
    INSERT INTO TI_LOTE_CTBL
      (NRSEQ_CONTROLE_INTEGRACAO,
       CDSITUACAO,
       NRPERIODO,
       COD_PLANO_CTA_CTBL,
       COD_PLANO_CCUSTO,
       DAT_LOTE_CTBL,
       DAT_PROCESSAMENTO,
       DAT_GERACAO,
       DES_LOTE_CTBL,
       AOLOTE_INTEGRACAO)
      SELECT PNRSEQ_CONTROLE_INTEGRACAO,
             'RC' CDSITUACAO,
             PNRPERIODO,
             F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CTA_CTBL') COD_PLANO_CTA_CTBL,
             F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') COD_PLANO_CCUSTO,
             PDTLOTE,
             SYSDATE DAT_PROCESSAMENTO,
             SYSDATE DAT_GERACAO,
             CASE
               WHEN PTXDESCRICAO_LOTE LIKE 'APROPRIACAO PROD.PREST%' THEN
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || 'APROP. PAGPREST' ||
                       SUBSTR(PTXDESCRICAO_LOTE, 24, 21),
                       1,
                       40)
               WHEN PTXDESCRICAO_LOTE LIKE
                    'APROPRIACAO DAS FATURAS EMITIDAS%' THEN
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || 'APROP. FAT EMITIDAS' ||
                       SUBSTR(PTXDESCRICAO_LOTE, 24, 21),
                       1,
                       40)
               WHEN PTXDESCRICAO_LOTE LIKE
                    'APROPRIACAO DAS FATURAS VENCIDAS%' THEN
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || 'APROP. FAT VENCIDAS' ||
                       SUBSTR(PTXDESCRICAO_LOTE, 24, 21),
                       1,
                       40)
               ELSE
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || PTXDESCRICAO_LOTE, 1, 40)
             END DES_LOTE_CTBL,
             DECODE(PCDLOTE_INTEGRACAO, NULL, 'N', 'S')
        FROM DUAL;
    --=========
    IF PI_CDFUNCIONARIO != 'SISMV' THEN
      FOR L_LANCTO_CRED IN C_LANCTO_CRED LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
            INTO VCOD_CCUSTO, VCOD_ESTAB
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and  cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_CRED.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            VCOD_CCUSTO := ' ';
            VCOD_ESTAB  := '01';
        END;
        IF L_LANCTO_CRED.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
        END IF;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_CRED.CDCONTA_CONTABIL,
           L_LANCTO_CRED.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_CRED.TXHISTORICO, 1, 2000),
           L_LANCTO_CRED.DTLANCAMENTO,
           L_LANCTO_CRED.VLLANCAMENTO,
           VCOD_CCUSTO,
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VCOD_ESTAB --, '01' --va_codestab
          ,
           L_LANCTO_CRED.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --, '1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --, 'UNI'
          ,
           L_LANCTO_CRED.NRLANCAMENTO,
           L_LANCTO_CRED.NRSEQ_LANCTO);
      END LOOP;
      --=========
      FOR L_LANCTO_DEB IN C_LANCTO_DEB LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
            INTO VCOD_CCUSTO, VCOD_ESTAB
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_DEB.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            VCOD_CCUSTO := ' ';
            VCOD_ESTAB  := '01';
        END;
        IF L_LANCTO_DEB.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
        END IF;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_DEB.CDCONTA_CONTABIL,
           L_LANCTO_DEB.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_DEB.TXHISTORICO, 1, 2000),
           L_LANCTO_DEB.DTLANCAMENTO,
           L_LANCTO_DEB.VLLANCAMENTO,
           VCOD_CCUSTO,
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VCOD_ESTAB --, '01'--va_codestab
          ,
           L_LANCTO_DEB.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --'1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --'UNI'
          ,
           L_LANCTO_DEB.NRLANCAMENTO,
           L_LANCTO_DEB.NRSEQ_LANCTO);
      END LOOP;
      ------------------ no caso de fechamento do estoque entra nesse loop ----------------------------------
    ELSE
      FOR L_LANCTO_CRED2 IN C_LANCTO_CRED_2 LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
            INTO VCOD_CCUSTO, VCOD_ESTAB
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and  cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_CRED2.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            IF SUBSTR(L_LANCTO_CRED2.CDCONTA_CONTABIL, 1, 1) IN ('7', '4') THEN
              VCOD_CCUSTO := NVL(L_LANCTO_CRED2.CDCONTA_MEMO_CRED,
                                 L_LANCTO_CRED2.CDCONTA_MEMO_DEB);
            ELSE
              VCOD_CCUSTO := ' ';
              VCOD_ESTAB  := '01';
            END IF;
        END;
        IF L_LANCTO_CRED2.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
        END IF;
        --vcod_ccusto := null; --l_lancto_cred2.cdconta_memo_cred;
        VA_CODESTAB := L_LANCTO_CRED2.CDORIGEM;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_CRED2.CDCONTA_CONTABIL,
           L_LANCTO_CRED2.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_CRED2.TXHISTORICO, 1, 2000),
           L_LANCTO_CRED2.DTLANCAMENTO,
           L_LANCTO_CRED2.VLLANCAMENTO,
           NVL(VCOD_CCUSTO, ' '),
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VA_CODESTAB,
           L_LANCTO_CRED2.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --'1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --'UNI'
          ,
           L_LANCTO_CRED2.NRLANCAMENTO,
           L_LANCTO_CRED2.NRSEQ_LANCTO);
      END LOOP;
      FOR L_LANCTO_DEB2 IN C_LANCTO_DEB_2 LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO
            INTO VCOD_CCUSTO
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_DEB2.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            IF SUBSTR(L_LANCTO_DEB2.CDCONTA_CONTABIL, 1, 1) IN ('7', '4') THEN
              VCOD_CCUSTO := NVL(L_LANCTO_DEB2.CDCONTA_MEMO_DEB,
                                 L_LANCTO_DEB2.CDCONTA_MEMO_CRED);
            ELSE
              VCOD_CCUSTO := ' ';
              VCOD_ESTAB  := '01';
            END IF;
        END;
        IF L_LANCTO_DEB2.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
          VCOD_ESTAB  := '01';
        END IF;
        --            vcod_ccusto := l_lancto_deb2.cdconta_memo_deb;
        VA_CODESTAB := L_LANCTO_DEB2.CDORIGEM;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_DEB2.CDCONTA_CONTABIL,
           L_LANCTO_DEB2.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_DEB2.TXHISTORICO, 1, 2000),
           L_LANCTO_DEB2.DTLANCAMENTO,
           L_LANCTO_DEB2.VLLANCAMENTO,
           NVL(VCOD_CCUSTO, ' '),
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VA_CODESTAB,
           L_LANCTO_DEB2.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --'1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --'UNI'
          ,
           L_LANCTO_DEB2.NRLANCAMENTO,
           L_LANCTO_DEB2.NRSEQ_LANCTO);
      END LOOP;
    END IF;
    --=====================================--
    -- Aplica depara da matriz de tradução --
    -----------------------------------------
    FOR L_MT IN (SELECT ILC.ROWID LINHA,
                        MT.DESTINO_COD_CCUSTO,
                        MT.DESTINO_COD_ESTAB
                   FROM TI_LOTE_CTBL_MATRIZ_TRADUCAO MT,
                        TI_ITEM_LANCAMENTO_CTBL      ILC
                  WHERE ILC.NRSEQ_CONTROLE_INTEGRACAO =
                        PNRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.COD_ESTAB = MT.COD_ESTAB
                    AND (ILC.COD_CTA_CTBL = MT.COD_CTA_CTBL OR
                        MT.COD_CTA_CTBL = '*')
                    AND (MT.COD_CCUSTO = ILC.COD_CCUSTO OR
                        MT.COD_CCUSTO = '*')
                    AND MT.COD_PLANO_CCUSTO =
                        F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                    AND (MT.DES_HISTOR_LANCTO_CTBL = '*' OR
                        MT.DES_HISTOR_LANCTO_CTBL =
                        ILC.DES_HISTOR_LANCTO_CTBL)) LOOP
      UPDATE TI_ITEM_LANCAMENTO_CTBL I
         SET I.COD_ESTAB  = L_MT.DESTINO_COD_ESTAB,
             I.COD_CCUSTO = L_MT.DESTINO_COD_CCUSTO
       WHERE I.ROWID = L_MT.LINHA;
    END LOOP;
    --============================--
    -- Validação centro de custos --
    --------------------------------
    VCDSITUACAO := 'OK';
    FOR L_CCUSTO_NAO_INFORMADO IN (SELECT COD_CTA_CTBL,
                                          COD_CCUSTO,
                                          I.COD_ESTAB,
                                          I.COD_EMPRESA,
                                          I.IND_NATUR_LANCTO_CTBL
                                     FROM TI_ITEM_LANCAMENTO_CTBL I
                                    WHERE I.NRSEQ_CONTROLE_INTEGRACAO =
                                          PNRSEQ_CONTROLE_INTEGRACAO
                                      AND I.COD_CCUSTO = ' '
                                      AND EXISTS
                                    (SELECT 1
                                             FROM CRITERDISTRIBCTACTBL A,
                                                  MAPA_DISTRIB_CCUSTO  M
                                            WHERE M.CODMAPADISTRIBCCUSTO =
                                                  A.CODMAPADISTRIBCCUSTO
                                              AND A.COD_CTA_CTBL =
                                                  I.COD_CTA_CTBL
                                              AND I.DAT_LANCTO BETWEEN
                                                  A.DAT_INIC_VALID AND
                                                  A.DAT_FIM_VALID)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_LOTE_CTBL',
           'NÃO FOI INFORMADO CENTRO DE CUSTO P/ A CONTA CONTABIL ' ||
           L_CCUSTO_NAO_INFORMADO.COD_CTA_CTBL,
           'Verifique o criterio de distribuição do EMS e os esquemas contábeis do Unicoo',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    -- Período não habilitado
    FOR L_PERIODO IN (SELECT MAX(P.COD_EXERC_CTBL ||
                                 LPAD(P.NUM_PERIOD_CTBL, 2, '0')) NRPERIODO,
                             COUNT(*) QTPERIODO,
                             MAX(COD_CENAR_CTBL) NOCENARIO
                        FROM SIT_PERIOD_CTBL P, TI_LOTE_CTBL LT
                       WHERE LT.NRSEQ_CONTROLE_INTEGRACAO =
                             PNRSEQ_CONTROLE_INTEGRACAO
                         AND P.COD_EXERC_CTBL ||
                             LPAD(P.NUM_PERIOD_CTBL, 2, '0') =
                             TO_CHAR(LT.DAT_LOTE_CTBL, 'YYYYMM')
                         AND P.IND_SIT_PERIOD_CTBL <> 'Habilitado'
                         AND P.COD_MODUL_DTSUL = 'FGL'
                         AND P.COD_EMPRESA =
                             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')) LOOP
      BEGIN
        IF L_PERIODO.QTPERIODO > 0 THEN
          INSERT INTO TI_FALHA_DE_PROCESSO
            (NRSEQUENCIAL,
             NRSEQ_CONTROLE_INTEGRACAO,
             CDINTEGRACAO,
             TXFALHA,
             TXAJUDA,
             DTFALHA,
             NRMENSAGEM)
          VALUES
            (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
             PNRSEQ_CONTROLE_INTEGRACAO,
             'TI_LOTE_CTBL',
             'O módulo FGL não esta habilitado para o cenário' ||
             L_PERIODO.NOCENARIO || ', período ' || PNRPERIODO,
             'Utilize a manutenção de período contábil, opção ajuste de período para habilitar o período',
             SYSDATE,
             NULL);
          VCDSITUACAO := 'PE';
        ELSE
          VCDSITUACAO := 'OK';
        END IF;
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
    END LOOP;
    FOR L_CE IN (SELECT ILC.*
                   FROM TI_ITEM_LANCAMENTO_CTBL ILC, TI_LOTE_CTBL LC
                  WHERE LC.NRSEQ_CONTROLE_INTEGRACAO =
                        ILC.NRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.NRSEQ_CONTROLE_INTEGRACAO =
                        PNRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.COD_CCUSTO <> ' '
                    AND EXISTS
                  (SELECT 1
                           FROM CCUSTO P
                          WHERE P.COD_CCUSTO = ILC.COD_CCUSTO
                            AND LC.DAT_LOTE_CTBL NOT BETWEEN P.DAT_INIC_VALID AND
                                P.DAT_FIM_VALID)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_LOTE_CTBL',
           'O Lançamento contábil esta com um centro de custo fora da validade. ' ||
           L_CE.COD_CTA_CTBL || ' C/C ' || L_CE.COD_CCUSTO,
           'Verifique o cadastro do plano de centro de custos',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --- Cenário exclusivo
    FOR L_CE IN (SELECT ILC.*
                   FROM TI_ITEM_LANCAMENTO_CTBL ILC, TI_LOTE_CTBL LC
                  WHERE LC.NRSEQ_CONTROLE_INTEGRACAO =
                        ILC.NRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.NRSEQ_CONTROLE_INTEGRACAO =
                        PNRSEQ_CONTROLE_INTEGRACAO
                    AND EXISTS
                  (SELECT 1
                           FROM CTA_CTBL CC
                          WHERE CC.COD_CENAR_CTBL_EXCLUS <> ' '
                            AND CC.COD_PLANO_CTA_CTBL = LC.COD_PLANO_CTA_CTBL
                            AND CC.COD_CTA_CTBL = ILC.COD_CTA_CTBL)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_LOTE_CTBL',
           'CENÁRIO EXCLUSIVO INFORMADO PARA A CONTA CONTÁBIL ' ||
           L_CE.COD_CTA_CTBL,
           'No cadastro de manutenção da conta contábil não pode ser informado o cenário',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --============================--
    -- Cta necessário cCusto      --
    -- Alessandro 18/08/2014      --
    --------------------------------
    FOR C_CTA IN (SELECT DISTINCT A.COD_CTA_CTBL, A.COD_ESTAB, A.COD_CCUSTO
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL A
                   WHERE A.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND SUBSTR(A.COD_CTA_CTBL, 1, 1) NOT IN ('1', '2')
                     AND EXISTS
                   (SELECT 1
                            FROM CRITERDISTRIBCTACTBL CD
                           WHERE CD.U##COD_CTA_CTBL = A.COD_CTA_CTBL
                             AND CD.U##COD_ESTAB = A.COD_ESTAB)
                     AND NOT EXISTS
                   (SELECT 1
                            FROM EMS506UNICOO.TI_CENTRO_CUSTO_CTBL CCC
                           WHERE CCC.COD_CTA_CTBL = A.COD_CTA_CTBL
                             AND CCC.COD_ESTAB = A.COD_ESTAB
                             AND CCC.COD_CCUSTO = A.COD_CCUSTO)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_CENTRO_CUSTO_CTBL',
           'Falta DePara de Conta Para Centro Custo',
           'Consta no TOTVS11 centro de custo para Conta ' ||
           C_CTA.COD_CTA_CTBL || ' Estab. ' || C_CTA.COD_ESTAB ||
           ' na tabela TI_CENTRO_CUSTO_CTBL',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- Restrição centro de custo por estabelecimento   --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL CCC
                   WHERE CCC.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND EXISTS
                   (SELECT 1
                            FROM RESTRIC_CCUSTO RC
                           WHERE RC.U##COD_CCUSTO = CCC.COD_CCUSTO
                             AND RC.U##COD_ESTAB = CCC.COD_ESTAB)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Restrição CCusto',
           'Há restrição de Estabelecimento para Centro de Custo',
           'Consta no TOTVS11 restrição do Estabelecimento :' ||
           C_CTA.COD_ESTAB || ' p/ CCusto ' || C_CTA.COD_CCUSTO,
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- Cta Unicoo x TOTVS11                            --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT DISTINCT A.COD_CTA_CTBL,
                                  XX.NOCONTA,
                                  EMS506UNICOO.F_TI_PARAMETRO_INTEGRACAO('NRPLANO_CONTA_UNICOO') PL_UNICOO
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL A,
                         CONTA_CONTABIL                       XX
                   WHERE A.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND XX.NRPLANO_CONTAS =
                         EMS506UNICOO.F_TI_PARAMETRO_INTEGRACAO('NRPLANO_CONTA_UNICOO')
                     AND XX.CDCONTA = A.COD_CTA_CTBL
                     AND NOT EXISTS
                   (SELECT 1
                            FROM CTA_CTBL CC
                           WHERE CC.U##COD_CTA_CTBL = A.COD_CTA_CTBL
                             AND F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CTA_CTBL') =
                                 CC.U##COD_PLANO_CTA_CTBL)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Falta Conta',
           'Há Conta Contábil no Unicoo e não cadastrada no TOTVS11',
           'Consta no Unicoo a Conta Contábil :' || C_CTA.COD_CTA_CTBL ||
           ' Desc.:  ' || C_CTA.NOCONTA || ' Plano no Unicoo.:  ' ||
           C_CTA.PL_UNICOO,
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- CCusto existe TOTVS11                           --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT CCC.COD_CCUSTO
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL CCC
                   WHERE CCC.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND CCC.COD_CCUSTO <> ' '
                     AND NOT EXISTS
                   (SELECT 1
                            FROM CCUSTO CC
                           WHERE CC.U##COD_PLANO_CCUSTO =
                                 EMS506UNICOO.F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO')
                             AND CC.U##COD_CCUSTO = CCC.COD_CCUSTO)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Falta CCusto',
           'Há Centro de Custo no Unicoo e não cadastrada no TOTVS11',
           'Consta no Unicoo o Centro de Custo: ' || C_CTA.COD_CCUSTO,
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- Centro Custo sem Unidade                        --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT COD_CCUSTO
                    FROM (SELECT A.U##COD_CCUSTO COD_CCUSTO,
                                 (SELECT B.U##COD_UNID_NEGOC
                                    FROM CCUSTO_UNID_NEGOC B
                                   WHERE B.U##COD_CCUSTO = A.U##COD_CCUSTO) CDUNID
                            FROM CCUSTO                               A,
                                 EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL CCC
                           WHERE A.U##COD_CCUSTO = CCC.COD_CCUSTO
                             AND CCC.NRSEQ_CONTROLE_INTEGRACAO =
                                 PNRSEQ_CONTROLE_INTEGRACAO) XX
                   WHERE XX.CDUNID IS NULL) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Falta CCusto sem Unidade',
           'Centro de Custo está sem Unidade de Negocio no TOTVS11',
           'Centro de Custo: ' || C_CTA.COD_CCUSTO ||
           ' está sem Unidade de Negocio.',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    IF VCDSITUACAO <> 'OK' THEN
      UPDATE TI_LOTE_CTBL LC
         SET LC.CDSITUACAO = 'PE'
       WHERE LC.NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
    END IF;
    /*select
        cod_cta_ctbl,
        cod_ccusto,
        i.cod_estab,
        i.cod_empresa,
        i.ind_natur_lancto_ctbl
    from
         ti_item_lancamento_ctbl i where i.nrseq_controle_integracao = 7192465
         and
         I.COD_CCUSTO <>' '
         AND
         not exists (
                select 1
                from
                    criterdistribctactbl a,
                    mapa_distrib_ccusto m,
                    item_lista_ccusto ic
                where
                     ic.cod_ccusto=i.cod_ccusto
                     and
                     ic.codmapadistribccusto=m.codmapadistribccusto
                     and
                     m.codmapadistribccusto=a.codmapadistribccusto
                     and
                     a.cod_cta_ctbl=i.cod_cta_ctbl
                     and
                     i.dat_lancto between a.dat_inic_valid and a.dat_fim_valid)
    */
  END;

  PROCEDURE P_TI_MOVIMENTO_CTA_CORRENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                        PNRSESSAO                  NUMBER,
                                        PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_INTEGRA_CMG IS
      SELECT CI.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
             CI.CDSITUACAO,
             CI.CDIDENTIFICADOR,
             CI.NRSEQUENCIAL_ORIGEM
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'CX'
         AND CI.CDSITUACAO = PCDSITUACAO
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0);
    VCDINTEGRACAO VARCHAR2(100);
  BEGIN
    FOR L_INTEGRA_CMG IN C_INTEGRA_CMG LOOP
      BEGIN
        PCDSITUACAO   := 'RC';
        VCDINTEGRACAO := 'TI_MOV_CTA_CORREN';
        INSERT INTO TI_MOVIMENTO_CTA_CORRENTE
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CORREN,
           DAT_MOVTO_CTA_CORREN,
           IND_TIP_MOVTO_CTA_CORREN,
           COD_TIP_TRANS_CX,
           IND_FLUXO_MOVTO_CTA_CORREN,
           COD_CENAR_CTBL,
           COD_HISTOR_PADR,
           VAL_MOVTO_CTA_CORREN,
           COD_DOCTO_MOVTO_CTA_BCO,
           COD_MODUL_DTSUL,
           IND_ERRO_VALID,
           DES_HISTOR_PADR,
           NUM_ID_MOVTO_CTA_CORREN)
          SELECT MCT.NRSEQ_CONTROLE_INTEGRACAO,
                 MCT.CDSITUACAO,
                 MCT.COD_CTA_CORREN,
                 MCT.DAT_MOVTO_CTA_CORREN,
                 MCT.IND_TIP_MOVTO_CTA_CORREN,
                 MCT.COD_TIP_TRANS_CX,
                 MCT.IND_FLUXO_MOVTO_CTA_CORREN,
                 MCT.COD_CENAR_CTBL,
                 MCT.COD_HISTOR_PADR,
                 MCT.VAL_MVTO_CTA_CORREN,
                 MCT.COD_DOCTO_MOVTO_CTA_BCO,
                 MCT.COD_MODUL_DTSUL,
                 MCT.IND_ERRO_VALID,
                 MCT.DES_HISTOR_PADR,
                 MCT.NUM_ID_MOVTO_CTA_CORREN
            FROM V_TI_MOVIMENTO_CTA_CORRENTE MCT
           WHERE NRSEQ_CONTROLE_INTEGRACAO =
                 L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO;
        IF SQL%ROWCOUNT = 0 THEN
          IF PCDSITUACAO = 'RC' THEN
            P_GRAVA_FALHA(L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO,
                          VCDINTEGRACAO,
                          'A VIEW V_TI_MOVIMENTO_CTA_CORRENTE N?O ENCONTROU MOVIMENTO CAIXA PARA O PROCESSO ==> ' ||
                          L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO ||
                          'NRMOVIMENTO ==> ' ||
                          L_INTEGRA_CMG.NRSEQUENCIAL_ORIGEM,
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        'O MOVIMENTO JA FOI ENVIADO PARA A TI_MOVIMENTO_CTA_CORRENTE ',
                        NULL,
                        PCDSITUACAO,
                        -1);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        'ERRO AO INCLUIR MOVIMENTO CAIXA NA TABELA TI_MOVIMENTO_CTA_CORRENTE ==> ' ||
                        SQLERRM || ' PROCESSO ==> ' ||
                        L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO ||
                        'NRMOVIMENTO ==> ' ||
                        L_INTEGRA_CMG.NRSEQUENCIAL_ORIGEM,
                        NULL,
                        PCDSITUACAO,
                        NULL);
      END;
      --====================================--
      -- Atualizar o situac?o da integrac?o --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  PROCEDURE P_INSERE_FORNECEDOR(PNRREGISTRO_TITULO IN NUMBER) IS
    CURSOR C_PES IS
      SELECT 'FN' PTPINTEGRACAO,
             'I' PCDACAO,
             P.NRCGC_CPF PNRCGC_CPF,
             P.NOPESSOA PNOPESSOA,
             P.DTNASCIMENTO PDTNASCIMENTO,
             P.TPPESSOA PTPPESSOA,
             P.NRREGISTRO PNRREGISTRO,
             'FORNECEDOR' PTPORIGEM,
             F.CDFORNECEDOR PCDIDENTIFICADOR,
             F.NRREGISTRO_FORNECEDOR PNRSEQUENCIAL_ORIGEM,
             '' PCDMODULO,
             TP.CDEMPRESA PCDEMPRESA,
             '' PNRSEQ_CONTROLE_INTEGRACAO_ORG,
             '' PNOABREVIADO_FORNECEDOR,
             '' PCDN_FORNECEDOR,
             '' PNOABREVIADO_CLIENTE,
             '' PCDN_CLIENTE,
             'S' PAODEFINEPESSOA
        FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA F,
             PESSOA                              P,
             TITULO_A_PAGAR                      TP
       WHERE TP.CDFORNECEDOR = F.CDFORNECEDOR
         AND F.NRREGISTRO_FORNECEDOR = P.NRREGISTRO
         AND TP.NRREGISTRO_TITULO = PNRREGISTRO_TITULO;
  BEGIN
    FOR X IN C_PES LOOP
      PCK_EMS506UNICOO.P_DEFINE_TI_PESSOA(X.PNRCGC_CPF,
                                          X.PNOPESSOA,
                                          X.PDTNASCIMENTO,
                                          X.PTPPESSOA,
                                          X.PNRREGISTRO,
                                          X.PTPORIGEM,
                                          X.PNOABREVIADO_FORNECEDOR,
                                          X.PCDN_FORNECEDOR,
                                          X.PNOABREVIADO_CLIENTE,
                                          X.PCDN_CLIENTE,
                                          X.PAODEFINEPESSOA);
      EMS506UNICOO.PCK_EMS506UNICOO.P_INS_TI_CONTROLE_INTEGRACAO(X.PTPINTEGRACAO,
                                                                 X.PCDACAO,
                                                                 X.PCDIDENTIFICADOR,
                                                                 X.PNRSEQUENCIAL_ORIGEM,
                                                                 X.PCDMODULO,
                                                                 X.PCDEMPRESA,
                                                                 X.PNRSEQ_CONTROLE_INTEGRACAO_ORG);
    END LOOP;
  END;

  PROCEDURE P_INSERE_CLIENTE(PNRREGISTRO_TITULO IN NUMBER) IS
    CURSOR C_CLI IS
      SELECT 'CL' PTPINTEGRACAO,
             'I' PCDACAO,
             P.NRCGC_CPF VNRCGC_CPF,
             P.NOPESSOA VNOPESSOA,
             P.DTNASCIMENTO VDTNASCIMENTO,
             P.TPPESSOA VTPPESSOA,
             C.NRREGISTRO_CLIENTE PNRSEQUENCIAL_ORIGEM,
             C.CDCLIENTE PCDIDENTIFICADOR,
             'CLIENTE',
             '' VNOM_ABREV_FORNECEDOR,
             '' VCDN_FORNECEDOR,
             '' VNOM_ABREV_CLIENTE,
             '' VCDN_CLIENTE,
             TR.CDEMPRESA PCDEMPRESA,
             '' PNRSEQ_CONTROLE_INTEGRACAO_ORG,
             '' PCDMODULO
        FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA C,
             PESSOA                           P,
             TITULO_A_RECEBER                 TR
       WHERE C.NRREGISTRO_CLIENTE = P.NRREGISTRO
         AND TR.CDCLIENTE = C.CDCLIENTE
         AND TR.NRREGISTRO_TITULO = PNRREGISTRO_TITULO;
  BEGIN
    FOR X IN C_CLI LOOP
      P_DEFINE_TI_PESSOA(X.VNRCGC_CPF,
                         X.VNOPESSOA,
                         X.VDTNASCIMENTO,
                         X.VTPPESSOA,
                         X.PNRSEQUENCIAL_ORIGEM,
                         'CLIENTE',
                         X.VNOM_ABREV_FORNECEDOR,
                         X.VCDN_FORNECEDOR,
                         X.VNOM_ABREV_CLIENTE,
                         X.VCDN_CLIENTE,
                         'S');
      EMS506UNICOO.PCK_EMS506UNICOO.P_INS_TI_CONTROLE_INTEGRACAO(X.PTPINTEGRACAO,
                                                                 X.PCDACAO,
                                                                 X.PCDIDENTIFICADOR,
                                                                 X.PNRSEQUENCIAL_ORIGEM,
                                                                 X.PCDMODULO,
                                                                 X.PCDEMPRESA,
                                                                 X.PNRSEQ_CONTROLE_INTEGRACAO_ORG);
    END LOOP;
  END;

  procedure P_CARGA_PESSOA_UNIMED IS
    --------------------------------------
    -- gerar carga de pessoa do unimeds
    --------------------------------------
    cursor c_pes is
      select distinct 'FN' ptpintegracao,
                      'I' pcdacao,
                      nvl(p.nrcgc_cpf, '00000000000000') pnrcgc_cpf,
                      p.nopessoa pnopessoa,
                      p.dtnascimento pdtnascimento,
                      p.tppessoa ptppessoa,
                      p.nrregistro pnrregistro,
                      'UNIMED' ptporigem,
                      f.cdfornecedor pcdidentificador,
                      p.nrregistro pnrsequencial_origem,
                      '' pcdmodulo,
                      '' pcdempresa,
                      '' pnrseq_controle_integracao_org,
                      '' pnoabreviado_fornecedor,
                      '' pcdn_fornecedor,
                      '' pnoabreviado_cliente,
                      '' pcdn_cliente,
                      'S' paodefinepessoa
        from producao.fornecedor@unicoo_homologa f,
             pessoa                              p,
             area_de_acao                        aa
       where f.nrregistro_fornecedor = p.nrregistro
            --and f.nrregistro_fornecedor not in (1976,1075,1628)
            --and f.cdsituacao_fornecedor = 'A'
            --and aa.nrregistro_pessoa   = f.nrregistro_fornecedor
         and aa.cdprestador = f.cdfornecedor
         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = aa.cdprestador
                 and ci.tpintegracao = 'FN');
    vcommit number;
  begin
    vcommit := 1;

    for x in c_pes loop
      begin
        pck_ems506unicoo.p_define_ti_pessoa(x.pnrcgc_cpf,
                                            x.pnopessoa,
                                            x.pdtnascimento,
                                            x.ptppessoa,
                                            x.pnrregistro,
                                            x.ptporigem,
                                            x.pnoabreviado_fornecedor,
                                            x.pcdn_fornecedor,
                                            x.pnoabreviado_cliente,
                                            x.pcdn_cliente,
                                            x.paodefinepessoa);

      exception
        when others then
          raise_application_error(-20100,
                                  ' Pessoa :' || x.pnrsequencial_origem || ' ' ||
                                  sqlerrm);
          null;
      end;

      ems506unicoo.pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                                 x.pcdacao,
                                                                 x.pcdidentificador,
                                                                 x.pnrsequencial_origem,
                                                                 x.pcdmodulo,
                                                                 x.pcdempresa,
                                                                 x.pnrseq_controle_integracao_org);

      if vcommit >= 500 then
        --Commit;
        vcommit := 1;
      else
        vcommit := vcommit + 1;
      end if;
    end loop;
    --commit;

    P_JOB;

    --COMMIT;

    P_COD_UNIMED_FORNECEDOR;

    --COMMIT;

  end P_CARGA_PESSOA_UNIMED;

  procedure P_COD_UNIMED_FORNECEDOR is
    cursor c_for is
      select distinct f.nrpessoa, a.cdareaacao
        from ti_fornecedor                       f,
             area_de_acao                        a,
             producao.fornecedor@unicoo_homologa xx
       where f.nrpessoa = xx.nrregistro_fornecedor
         and xx.cdfornecedor = a.cdprestador
         and f.cdsituacao = 'RC';

  begin
    for x in c_for loop

      update ti_pessoa p
         set p.cdn_fornecedor = x.cdareaacao, P.CDN_CLIENTE = X.cdareaacao
       where p.nrregistro = x.nrpessoa;

      update ti_fornecedor f
         set f.cod_fornecedor = x.cdareaacao
       where f.nrpessoa = x.nrpessoa;

    end loop;
    --commit;
  end P_COD_UNIMED_FORNECEDOR;

  PROCEDURE P_CARGA_INICIAL_FORNECEDOR IS
    --------------------------------------
    -- gerar carga de pessoa do fornecedor
    --------------------------------------

    cursor c_pes is
      /*select distinct 'FN' ptpintegracao,
                      'I' pcdacao,
                      nvl(trim(replace(replace(replace(p.nrcgc_cpf,
                                                       '-',
                                                       null),
                                               ',',
                                               null),
                                       '.',
                                       null)),
                          '00000000000000') pnrcgc_cpf,
                      p.nopessoa pnopessoa,
                      p.dtnascimento pdtnascimento,
                      p.tppessoa ptppessoa,
                      p.nrregistro pnrregistro,
                      'FORNECEDOR' ptporigem,
                      f.cdfornecedor pcdidentificador,
                      f.nrregistro_fornecedor pnrsequencial_origem,
                      '' pcdmodulo,
                      '' pcdempresa,
                      '' pnrseq_controle_integracao_org,
                      '' pnoabreviado_fornecedor,
                      '' pcdn_fornecedor,
                      '' pnoabreviado_cliente,
                      '' pcdn_cliente,
                      'S' paodefinepessoa
        from producao.fornecedor@unicoo_homologa f,
             pessoa                              p,
             ti_matriz_pagar                     tm
       where f.nrregistro_fornecedor = p.nrregistro
         and p.nrregistro = tm.nrregistro
         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = f.cdfornecedor
                 and ci.tpintegracao = 'FN')
      union all
      */select distinct 'FN' ptpintegracao,
                      'I' pcdacao,
                      nvl(trim(replace(replace(replace(p.nrcgc_cpf,
                                                       '-',
                                                       null),
                                               ',',
                                               null),
                                       '.',
                                       null)),
                          '00000000000000') pnrcgc_cpf,
                      p.nopessoa pnopessoa,
                      p.dtnascimento pdtnascimento,
                      p.tppessoa ptppessoa,
                      p.nrregistro pnrregistro,
                      'FORNECEDOR' ptporigem,
                      f.cdfornecedor pcdidentificador,
                      f.nrregistro_fornecedor pnrsequencial_origem,
                      '' pcdmodulo,
                      '' pcdempresa,
                      '' pnrseq_controle_integracao_org,
                      '' pnoabreviado_fornecedor,
                      '' pcdn_fornecedor,
                      '' pnoabreviado_cliente,
                      '' pcdn_cliente,
                      'S' paodefinepessoa
        from producao.fornecedor@unicoo_homologa f,
             pessoa                              p,
             ti_grupo_de_fornecedor              tif
       where f.nrregistro_fornecedor = p.nrregistro
         and tif.cdgrupo_fornecedor = f.cdgrupo_fornecedor
         and exists (select 1 from ti_controle_integracao tic, titulo_a_pagar tp
         where tic.nrsequencial_origem  = tp.nrregistro_titulo
         and tic.tpintegracao = 'TP'
         and tic.cdsituacao = 'ER'
         and f.cdfornecedor = tp.cdfornecedor)
       --  and tif.cod_grp_fornecedor <> 'NAOM'
       /*  and not exists
       (select 1
                from ti_matriz_pagar tm
               where tm.nrregistro = f.nrregistro_fornecedor)*/
         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = f.cdfornecedor
                 and ci.tpintegracao = 'FN')
       order by pnrregistro desc;

    vcommit number;
  begin
    vcommit := 1;

    for x in c_pes loop
      begin
        pck_ems506unicoo.p_define_ti_pessoa(x.pnrcgc_cpf,
                                            x.pnopessoa,
                                            x.pdtnascimento,
                                            x.ptppessoa,
                                            x.pnrregistro,
                                            x.ptporigem,
                                            x.pnoabreviado_fornecedor,
                                            x.pcdn_fornecedor,
                                            x.pnoabreviado_cliente,
                                            x.pcdn_cliente,
                                            x.paodefinepessoa);

      exception
        when others then
          --raise_application_error(-20100,' Pessoa :'||x.pnrsequencial_origem||' '||sqlerrm);
          null;
      end;

      ems506unicoo.pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                                 x.pcdacao,
                                                                 x.pcdidentificador,
                                                                 x.pnrsequencial_origem,
                                                                 x.pcdmodulo,
                                                                 x.pcdempresa,
                                                                 x.pnrseq_controle_integracao_org);

      if vcommit >= 500 then
        --Commit;
        vcommit := 1;
      else
        vcommit := vcommit + 1;
      end if;
    end loop;
    --commit;

    p_job;

    --COMMIT;

  end P_CARGA_INICIAL_FORNECEDOR;

  PROCEDURE P_CARGA_INICIAL_CLIENTE IS
    ----------------------------------
    -- Gerar pessoa cliente integração
    ----------------------------------

    cursor c_cli is
      select nvl(trim(replace(replace(replace(p.nrcgc_cpf, '-', null),
                                      ',',
                                      null),
                              '.',
                              null)),
                 '00000000000000') nrcgc_cpf,
             p.nopessoa nopessoa,
             p.dtnascimento,
             p.tppessoa,
             c.nrregistro_cliente,
             'CLIENTE' tipo,
             '' vnom_abrev_fornecedor,
             '' vcdn_fornecedor,
             '' vnom_abrev_cliente,
             '' vcdn_cliente,
             'S' incluir,
             c.cdcliente
        from producao.cliente@unicoo_homologa c,
             pessoa                           p,
             ti_grupo_de_cliente              t
       where p.nrregistro = c.nrregistro_cliente
         and t.cdgrupo_cliente = c.cdgrupo_cliente
         and t.cdgrupo_cliente_ems_pj <> 'NAOM'
         and not exists (select 1
                from ti_matriz_receber tm
               where tm.nrregistro = p.nrregistro)
         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = c.cdcliente
                 and ci.tpintegracao = 'CL')
      --         and P.NRREGISTRO=2021
      union all
      select nvl(trim(replace(replace(replace(p.nrcgc_cpf, '-', null),
                                      ',',
                                      null),
                              '.',
                              null)),
                 '00000000000000') nrcgc_cpf,
             p.nopessoa nopessoa,
             p.dtnascimento,
             p.tppessoa,
             c.nrregistro_cliente,
             'CLIENTE' tipo,
             '' vnom_abrev_fornecedor,
             '' vcdn_fornecedor,
             '' vnom_abrev_cliente,
             '' vcdn_cliente,
             'S' incluir,
             c.cdcliente
        from producao.cliente@unicoo_homologa c,
             pessoa                           p,
             ti_matriz_receber                tm
       where p.nrregistro = c.nrregistro_cliente
         and p.nrregistro = tm.nrregistro
         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = c.cdcliente
                 and ci.tpintegracao = 'CL');

    cursor c_carga_clientes is

    --Selecionar a pessoa do contratante que não é cliente
      select nrpessoa_paga, tppessoa
        from (select p.nrregistro nrpessoa_paga
                from contrato_da_pessoa p
               where not exists
               (select 1
                        from producao.cliente@unicoo_homologa c
                       where c.nrregistro_cliente = p.nrregistro)
              union

              --selecionar pessoa que paga da familia (aposentado/demitido) que não é cliente
              select nvl(f.nrpessoa_paga, f.nrpessoa_titular) nrregistro
                from familia f
               where f.dtinicio_contrato is not null
                 and not exists
               (select 1
                        from producao.cliente@unicoo_homologa c
                       where c.nrregistro_cliente =
                             nvl(f.nrpessoa_paga, f.nrpessoa_titular))
              union

              --selecionar pessoa que paga que não é cliente
              select p2.nrpessoa_paga
                from contrato_da_pessoa p2
               where p2.nrpessoa_paga <> p2.nrregistro
                 and not exists
               (select 1
                        from producao.cliente@unicoo_homologa c2
                       where c2.nrregistro_cliente = p2.nrpessoa_paga)
              union

              --selecionar pessoa que paga que não é cliente e faturamento por familia (adesao)
              select nvl(f.nrpessoa_paga, f.nrpessoa_titular) nrregistro
                from contrato_da_pessoa p2, familia f, usuario u
               where p2.nrregistro = u.nrregistro
                 and p2.nrcontrato = u.nrcontrato
                 and f.nrregistro = u.nrregistro
                 and f.nrcontrato = u.nrcontrato
                 and f.nrfamilia = u.nrfamilia
                 and u.nrfamilia <> 0
                 and u.tpusuario = 00
                 and p2.tpfatura = 'U'
                 and not exists
               (select 1
                        from producao.cliente@unicoo_homologa c
                       where c.nrregistro_cliente =
                             nvl(f.nrpessoa_paga, f.nrpessoa_titular))
              union

              --selecionar titulares da empresa do parj para virar clientes
              select nrregistro_usuario nrpessoa_paga
                from usuario us
               where nrfamilia <> 0
                 and tpusuario = 00
                 and unicoogps.f_tm_parametro('CONTRATO_PEA') like
                     '%' || us.nrcontrato || '%'
                 and not exists
               (select 1
                        from producao.cliente@unicoo_homologa cl
                       where cl.nrregistro_cliente = us.nrregistro_usuario)
              union

              --selecionar lotacoes para virarem clientes
              select a.nrpessoa_paga
                from (select nvl(l.nrpessoa_paga, l.nrregistro_lotacao) nrpessoa_paga,
                             l.nrcontrato,
                             p.nopessoa,
                             l.cdlotacao,
                             l.txdescricao,
                             cl.cdcliente cdcliente
                        from pessoa                           p,
                             lotacao                          l,
                             producao.cliente@unicoo_homologa cl,
                             contrato_da_pessoa               cdp
                       where p.nrregistro =
                             nvl(l.nrpessoa_paga, l.nrregistro_lotacao)
                         and cl.nrregistro_cliente(+) =
                             nvl(l.nrpessoa_paga, l.nrregistro_lotacao)
                         and cdp.nrregistro = l.nrregistro
                         and cdp.nrcontrato = l.nrcontrato
                         and cdp.tpfatura in ('L', 'I')) a
               where cdcliente is null) b,
             pessoa p
       where b.nrpessoa_paga = p.nrregistro;
    vcommit number;

  begin

    vcommit := 1;

    --Gera clientes no UNICOO para as pessoas que não são clientes
    --Ex: Titulares do PARJ, Lotacoes, etc
    FOR Y IN c_carga_clientes LOOP

      BEGIN
        PRODUCAO.p_gera_cliente@UNICOO_HOMOLOGA('M' || Y.NRPESSOA_PAGA,
                                                Y.NRPESSOA_PAGA,
                                                'M' || Y.NRPESSOA_PAGA,
                                                NULL,
                                                CASE
                                                  WHEN Y.TPPESSOA = 'F' THEN
                                                   'P'
                                                  ELSE
                                                   'E'
                                                END,
                                                NULL,
                                                'N');
      END;

    END LOOP;

    for x in c_cli loop
      begin
        ems506unicoo.pck_ems506unicoo.p_define_ti_pessoa(x.nrcgc_cpf,
                                                         x.nopessoa,
                                                         x.dtnascimento,
                                                         x.tppessoa,
                                                         x.nrregistro_cliente,
                                                         x.tipo,
                                                         x.vnom_abrev_fornecedor,
                                                         x.vcdn_fornecedor,
                                                         x.vnom_abrev_cliente,
                                                         x.vcdn_cliente,
                                                         x.incluir);

      exception
        when others then
          raise_application_error(-20100,
                                  ' Pessoa : ' || x.nrregistro_cliente ||
                                  ' - ' || sqlerrm);
          null;
      end;

      ems506unicoo.PCK_EMS506UNICOO.P_INS_TI_CONTROLE_INTEGRACAO('CL',
                                                                 'I',
                                                                 x.cdcliente,
                                                                 x.NRREGISTRO_cliente,
                                                                 null,
                                                                 NULL,
                                                                 NULL);

      if vcommit >= 500 then
        --Commit;
        vcommit := 1;
      else
        vcommit := vcommit + 1;
      end if;
    end loop;
    --commit;

    P_JOB;

    --COMMIT;

  end P_CARGA_INICIAL_CLIENTE;

  procedure p_carga_tit_acr_fechado IS
    cursor c_tit is
      select 'TR' ptpintegracao,
             'I' pcdacao,
             t.nrdocumento pcdidentificador,
             t.nrregistro_titulo pnrsequencial_origem,
             '' pcdmodulo,
             t.cdempresa cdempresa,
             '' pnrseq_controle_integracao_org
        from producao.cliente@unicoo_homologa c,
             titulo_a_receber                 t,
             pessoa                           p
       where c.cdcliente = t.cdcliente
         and p.nrregistro = c.nrregistro_cliente
        and not exists (select 1
                from ti_matriz_receber b
               where b.nrregistro_titulo = t.nrregistro_titulo)
         and not exists
       (select 1
                from ti_controle_integracao x
               where x.tpintegracao = 'TR'
                 and x.nrsequencial_origem = t.nrregistro_titulo)
        and t.cdsituacao not in (6,8) --TIutlos desmembrados/cancelados não serão integrados
        and t.dttitulo >= '01/01/2016';

    vConta number;
  begin
    vConta := 0;
    for x in c_tit loop
      pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                    x.pcdacao,
                                                    x.pcdidentificador,
                                                    x.pnrsequencial_origem,
                                                    x.pcdmodulo,
                                                    x.cdempresa,
                                                    x.pnrseq_controle_integracao_org);
      if vConta > 500 then
        --commit;
        vConta := 0;
      end if;

      vConta := vConta + 1;

    end loop;
    --commit;

    p_job;

    --COMMIT;

  END p_carga_tit_acr_fechado;


  procedure p_carga_tit_acr IS
    cursor c_tit is
      select 'TR' ptpintegracao,
             'I' pcdacao,
             t.nrdocumento pcdidentificador,
             t.nrregistro_titulo pnrsequencial_origem,
             '' pcdmodulo,
             t.cdempresa cdempresa,
             '' pnrseq_controle_integracao_org
        from producao.cliente@unicoo_homologa c,
             titulo_a_receber                 t,
             pessoa                           p
       where c.cdcliente = t.cdcliente
         and p.nrregistro = c.nrregistro_cliente
         and t.cdsituacao not in (6,8) --Titulos desmembrados/cancelados nao serao migrados
         and exists (select 1
                from ti_matriz_receber b
               where b.nrregistro_titulo = t.nrregistro_titulo)
         and not exists
       (select 1
                from ti_controle_integracao x
               where x.tpintegracao = 'TR'
                 and x.nrsequencial_origem = t.nrregistro_titulo);

    vConta number;
  begin
    vConta := 0;
    for x in c_tit loop
      pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                    x.pcdacao,
                                                    x.pcdidentificador,
                                                    x.pnrsequencial_origem,
                                                    x.pcdmodulo,
                                                    x.cdempresa,
                                                    x.pnrseq_controle_integracao_org);
      if vConta > 500 then
        --commit;
        vConta := 0;
      end if;

      vConta := vConta + 1;

    end loop;
    --commit;

    p_job;

    --COMMIT;

  END p_carga_tit_acr;


procedure p_carga_baixa_tit_acr is

  temp_ti_cx_bx_acr           ti_cx_bx_acr%rowtype;
  vnrseq_controle             ti_controle_integracao.nrsequencial%type;
  pCD_PORTADOR_MOVIMENTOS     ti_parametro_integracao.cdparametro%type := f_ti_parametro_integracao('CD_PORTADOR_MOVIMENTOS');
  pCD_CTA_CORREN_MOVIMENTOS   ti_parametro_integracao.cdparametro%type := f_ti_parametro_integracao('CD_CTA_CORREN_MOVIMENTOS');
  temp_ti_controle_integracao ti_controle_integracao%rowtype;
  vcdsituacao                 ti_controle_integracao.cdsituacao%type;
  verro                       ti_falha_de_processo.txfalha%type;
  temp_ti_falha_de_processo   ti_falha_de_processo%rowtype;
  vexiste                     char;

  cursor c_titulos is

    select ttr.*, tr.nrregistro_titulo
      from ti_controle_integracao tc, titulo_a_receber tr, ti_tit_acr ttr
     where tc.nrsequencial_origem = tr.nrregistro_titulo
       and tc.cdidentificador = tr.nrdocumento
       and ttr.nrseq_controle_integracao = tc.nrsequencial
       --and ttr.cdsituacao = 'IT'
       and tr.cdsituacao <> 0;

  --Movimento 70 - Baixa normal de títulos
  cursor c_baixa_titulo(cnrregistro_titulo titulo_a_receber.nrregistro_titulo%type) is
    select h.dtmovimento       dt_baixa,
           h.vlrecebido        vl_recebido,
           h.vljuros,
           h.vlmulta,
           h.vldesconto,
           h.vlabatimento,
           h.vlir_fonte,
           h.nrregistro_titulo,
           tc.cdidentificador,
           h.nrmovimento
      from historico_do_titulo h, ti_controle_integracao tc
     where h.nrregistro_titulo = tc.nrsequencial_origem
       and h.nrregistro_titulo = cnrregistro_titulo
       and h.cdmovimento in (30, 70, 72, 76)
       and not exists
     (select 1
              from ti_cx_bx_acr tcr
             where tcr.nrmovimento_baixa = h.nrmovimento)
     order by tc.cdidentificador, h.dtmovimento;

begin

  for ct in c_titulos loop

    for cbaixa in c_baixa_titulo(ct.nrregistro_titulo) loop

      begin
        select 'S'
          into vexiste
          from ti_cx_bx_acr tcx
         where tcx.nrmovimento_baixa = cbaixa.nrmovimento;

      exception
        when no_data_found then
          select sq_ti_controle_integracao.nextval
            into vnrseq_controle
            from dual;

          vcdsituacao := 'RC';

          begin

            temp_ti_cx_bx_acr.nrseq_controle_integracao := vnrseq_controle;
            temp_ti_cx_bx_acr.cdsituacao                := vcdsituacao;
            temp_ti_cx_bx_acr.cod_cart_bcia             := ' ';
            temp_ti_cx_bx_acr.cod_cliente               := ct.cod_cliente;
            temp_ti_cx_bx_acr.cod_empresa               := ct.cod_empresa;
            temp_ti_cx_bx_acr.cod_espec_docto           := ct.cod_espec_docto;
            temp_ti_cx_bx_acr.cod_estab                 := ct.cod_estab;
            temp_ti_cx_bx_acr.cod_parcela               := ct.cod_parcela;
            temp_ti_cx_bx_acr.cod_portador              := pCD_PORTADOR_MOVIMENTOS;
            temp_ti_cx_bx_acr.cod_ser_docto             := ct.cod_ser_docto;
            temp_ti_cx_bx_acr.cod_tit_acr_bco           := ct.cod_tit_acr_bco;
            temp_ti_cx_bx_acr.cod_titulo_acr            := ct.cod_titulo_acr;
            temp_ti_cx_bx_acr.dat_baixa                 := cbaixa.dt_baixa;
            temp_ti_cx_bx_acr.dat_envio                 := cbaixa.dt_baixa;
            temp_ti_cx_bx_acr.dat_processamento         := sysdate;
            temp_ti_cx_bx_acr.des_text_histor           := ' ';
            temp_ti_cx_bx_acr.val_desconto              := nvl(cbaixa.vldesconto,0);
            temp_ti_cx_bx_acr.val_abatimento            := nvl(cbaixa.vlabatimento,0);
            temp_ti_cx_bx_acr.val_ir                    := nvl(cbaixa.vlir_fonte,0);
            temp_ti_cx_bx_acr.val_juros                 := nvl(cbaixa.vljuros,0);
            temp_ti_cx_bx_acr.val_multa                 := nvl(cbaixa.vlmulta,0);
            temp_ti_cx_bx_acr.val_liq_titulo            := cbaixa.vl_recebido;
            temp_ti_cx_bx_acr.val_titulo                := 0;
            temp_ti_cx_bx_acr.nrpessoa                  := 0;
            temp_ti_cx_bx_acr.nrregistro_titulo         := null;
            temp_ti_cx_bx_acr.nrmovimento_baixa         := cbaixa.nrmovimento;
            temp_ti_cx_bx_acr.nrdocumento               := cbaixa.cdidentificador;
            temp_ti_cx_bx_acr.nrnossonumero             := ct.cod_tit_acr_bco;
            temp_ti_cx_bx_acr.txhistorico               := null;
            temp_ti_cx_bx_acr.nrbanco                   := 0;
            temp_ti_cx_bx_acr.nragencia                 := 0;
            temp_ti_cx_bx_acr.nrconta_corrente          := pCD_CTA_CORREN_MOVIMENTOS;

            insert into TI_CX_BX_ACR values temp_TI_CX_BX_ACR;

          exception
            when others then
              vcdsituacao := 'ER';
              verro       := sqlerrm;

              select SQ_TI_FALHA_DE_PROCESSO.NEXTVAL
                into temp_ti_falha_de_processo.nrsequencial
                from dual;

              temp_ti_falha_de_processo.nrseq_controle_integracao := vnrseq_controle;
              temp_ti_falha_de_processo.cdintegracao              := 'BR';
              temp_ti_falha_de_processo.txfalha                   := verro;
              temp_ti_falha_de_processo.dtfalha                   := sysdate;
              temp_ti_falha_de_processo.txajuda                   := ' ';
              temp_ti_falha_de_processo.nrmensagem                := null;

              insert into ti_falha_de_processo
              values temp_ti_falha_de_processo;

          end;

          temp_ti_controle_integracao.nrsequencial                  := vnrseq_controle;
          temp_ti_controle_integracao.tpintegracao                  := 'BR';
          temp_ti_controle_integracao.dtgeracao                     := sysdate;
          temp_ti_controle_integracao.nrsequencial_origem           := ct.nrregistro_titulo;
          temp_ti_controle_integracao.dtprocessamento               := sysdate;
          temp_ti_controle_integracao.dtintegracao                  := null;
          temp_ti_controle_integracao.cdacao                        := 'I';
          temp_ti_controle_integracao.cdidentificador               := cbaixa.cdidentificador;
          temp_ti_controle_integracao.txobservacao                  := ' ';
          temp_ti_controle_integracao.cdsituacao                    := vcdsituacao;
          temp_ti_controle_integracao.nrseq_controle_integracao_org := null;
          temp_ti_controle_integracao.cdempresa                     := null;
          temp_ti_controle_integracao.cdmodulo                      := null;
          temp_ti_controle_integracao.cdmovimento                   := null;
          temp_ti_controle_integracao.nrsessao                      := null;
          temp_ti_controle_integracao.cddivisao                     := null;
          temp_ti_controle_integracao.cdcentro_custo                := null;
          temp_ti_controle_integracao.tpdocumento                   := null;

          insert into ti_controle_integracao
          values temp_ti_controle_integracao;

        p_commit;

      end;
    end loop;

  end loop;

  commit;

end p_carga_baixa_tit_acr;


  PROCEDURE p_carga_tit_apb IS
    --===================================================================================================
    ----------------------------------------
    -- gerar carga do titulos a pagar
    ----------------------------------------
    cursor c_tit is
      select 'TP' ptpintegracao,
             'I' pcdacao,
             t.nrdocumento pcdidentificador,
             t.nrregistro_titulo pnrsequencial_origem,
             '' pcdmodulo,
             t.cdempresa cdempresa,
             '' pnrseq_controle_integracao_org
        from producao.fornecedor@unicoo_homologa f,
             titulo_a_pagar                      t,
             pessoa                              p
       where t.cdfornecedor = f.cdfornecedor
         and f.nrregistro_fornecedor = p.nrregistro
         and exists (select 1
                from ti_matriz_pagar b
               where b.nrregistro_titulo = t.nrregistro_titulo)
         and not exists
       (select 1
                from ti_controle_integracao u
               where u.tpintegracao = 'TP'
                 and u.nrsequencial_origem = t.nrregistro_titulo);
  begin

    for x in c_tit loop
      pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                    x.pcdacao,
                                                    x.pcdidentificador,
                                                    x.pnrsequencial_origem,
                                                    x.pcdmodulo,
                                                    x.cdempresa,
                                                    x.pnrseq_controle_integracao_org);
      --commit;
    end loop;

    p_job;

    --commit;

  end p_carga_tit_apb;



  procedure p_atualiza_status_cliente(p_qtsessoes number) IS

    vqtregistros number;
    w            number := 0;

  begin

    --  loop

    w := 0;

    select count(*) / p_qtsessoes
      into vqtregistros
      from ti_cliente
     where cdsituacao = 'RC';

    while w <= p_qtsessoes loop

      update ti_cliente t
         set cdsituacao = 'R' || w
       where cdsituacao = 'RC'
         and rownum <= vqtregistros;

      --commit;
      w := w + 1;

    end loop;

    --  end loop;
  end p_atualiza_status_cliente;

  procedure p_atualiza_status_baixa_acr(p_qtsessoes number) IS

    vqtregistros number;
    w            number := 0;

  begin

    --  loop

    w := 0;

    select count(*) / p_qtsessoes
      into vqtregistros
      from ti_cx_bx_acr
     where cdsituacao = 'RC';

    while w <= p_qtsessoes loop

      update ti_cx_bx_acr b
         set cdsituacao = 'R' || w
       where cdsituacao = 'RC'
         and rownum <= vqtregistros;

      commit;
      w := w + 1;

    end loop;

    --  end loop;
  end p_atualiza_status_baixa_acr;

  procedure p_atualiza_status_fornecedor(p_qtsessoes number) IS

    vqtregistros number;
    w            number := 0;

  begin

    --  loop

    w := 0;

    select count(*) / p_qtsessoes
      into vqtregistros
      from ti_fornecedor
     where cdsituacao = 'RC';

    while w <= p_qtsessoes loop

      update ti_fornecedor t
         set cdsituacao = 'R' || w
       where cdsituacao = 'RC'
         and rownum <= vqtregistros;

      --commit;
      w := w + 1;

    end loop;

    --  end loop;
  end p_atualiza_status_fornecedor;

  procedure p_atualiza_status_tit_apb(p_qtsessoes number) IS

    vqtregistros number;
    w            number := 0;

  begin

    loop

      w := 0;

      select round(count(*) / p_qtsessoes, 0)
        into vqtregistros
        from ti_tit_apb
       where cdsituacao = 'RC';

      while w <= p_qtsessoes loop

        update ti_tit_apb t
           set cdsituacao = 'R' || w
         where cdsituacao = 'RC'
           and rownum <= vqtregistros;

        commit;
        w := w + 1;

      end loop;

    end loop;
  end p_atualiza_status_tit_apb;

  procedure p_atualiza_status_tit_acr(p_qtsessoes number) IS

    vqtregistros number;
    w            number := 0;

  begin

    loop

      w := 0;

      select round(count(*) / p_qtsessoes, 0)
        into vqtregistros
        from ti_tit_acr
       where cdsituacao = 'RC';

      while w <= p_qtsessoes loop

        update ti_tit_acr t
           set cdsituacao = 'R' || w
         where cdsituacao = 'RC'
           and rownum <= vqtregistros;

        commit;
        w := w + 1;

      end loop;

    end loop;
  end p_atualiza_status_tit_acr;

  procedure p_gera_carga_matriz_acr(vpcdempresa  varchar2,
                                    vpdtcontabil date,
                                    vpdtvenc_ini date,
                                    vpdtvenc_fin date) is
  begin
    -- eliminar os registros da tabela.
    delete from ti_matriz_receber;
    --commit;
    -- inserir novamente os titulos na tabela.
    insert into ti_matriz_receber
      select ttr.cdcliente,
             ttr.nrregistro_titulo,
             pes.nrregistro,
             ttr.nrdocumento,
             ttr.cdsituacao,
             case
               when ttr.cdsituacao = 0 then
                'Aberto'
               when ttr.cdsituacao = 1 then
                'Totalmente Pago'
               when ttr.cdsituacao = 2 then
                'Parcialmente Pago'
               when ttr.cdsituacao = 3 then
                'Encerrado em Prejuizo'
               when ttr.cdsituacao = 4 then
                'Substituído'
               when ttr.cdsituacao = 5 then
                'Substituído Encerrado'
               when ttr.cdsituacao = 6 then
                'Desmembrado'
               when ttr.cdsituacao = 7 then
                'Agrupado'
               when ttr.cdsituacao = 8 then
                'Cancelado'
             end descsituacao,
             ttr.dttitulo,
             max(decode(cdmovimento,
                        1,
                        hst.dtvencimento,
                        2,
                        hst.dtvencimento,
                        3,
                        hst.dtvencimento,
                        10,
                        hst.dtvencimento,
                        to_date('31/12/1889'))) dtvencimento,
             decode(nvl(min(ttr.vlfaturado), 0),
                    0,
                    sum(decode(hst.nrmovimento,
                               h2.nrmovimento,
                               nvl(hst.vltitulo, 0),
                               0)),
                    nvl(min(ttr.vlfaturado), 0)) vlfaturado,
             sum(decode(hst.nrmovimento,
                        h2.nrmovimento,
                        nvl(hst.vltitulo, 0),
                        0)) vltitulo,
             max(hst.dtrecebimento) dtultimo_recebimento,
             sum(nvl(decode(hst.cdmovimento,
                            77,
                            hst.vlmulta,
                            85,
                            -hst.vlmulta,
                            86,
                            -hst.vlmulta,
                            87,
                            -hst.vlmulta,
                            89,
                            -hst.vlmulta,
                            hst.vlmulta),
                     0)) vlmulta,
             sum(nvl(decode(hst.cdmovimento,
                            77,
                            hst.vljuros,
                            85,
                            -hst.vljuros,
                            86,
                            -hst.vljuros,
                            87,
                            -hst.vljuros,
                            89,
                            -hst.vljuros,
                            hst.vljuros),
                     0)) vljuros,
             sum(nvl(decode(hst.cdmovimento,
                            77,
                            hst.vlabatimento,
                            85,
                            -hst.vlabatimento,
                            86,
                            -hst.vlabatimento,
                            87,
                            -hst.vlabatimento,
                            89,
                            -hst.vlabatimento,
                            hst.vlabatimento),
                     0)) vlabatimento,
             sum(nvl(decode(hst.cdmovimento,
                            77,
                            hst.vlabatimento_2,
                            85,
                            -hst.vlabatimento_2,
                            86,
                            -hst.vlabatimento_2,
                            87,
                            -hst.vlabatimento_2,
                            89,
                            -hst.vlabatimento_2,
                            hst.vlabatimento_2),
                     0)) vlabatimento_2,
             sum(nvl(decode(hst.cdmovimento,
                            77,
                            hst.vlrecebido,
                            85,
                            -hst.vlrecebido,
                            86,
                            -hst.vlrecebido,
                            87,
                            -hst.vlrecebido,
                            89,
                            -hst.vlrecebido,
                            hst.vlrecebido),
                     0)) vlrecebido,
             (sum(nvl(decode(hst.cdmovimento,
                             77,
                             hst.vldesconto,
                             85,
                             -hst.vldesconto,
                             86,
                             -hst.vldesconto,
                             87,
                             -hst.vldesconto,
                             89,
                             -hst.vldesconto,
                             hst.vldesconto),
                      0)) + sum(nvl(decode(hst.cdmovimento,
                                            77,
                                            hst.vlabatimento_imposto,
                                            85,
                                            -hst.vlabatimento_imposto,
                                            86,
                                            -hst.vlabatimento_imposto,
                                            87,
                                            -hst.vlabatimento_imposto,
                                            89,
                                            -hst.vlabatimento_imposto,
                                            hst.vlabatimento_imposto),
                                     0))) vldesconto,
             (sum(decode(hst.nrmovimento,
                         h2.nrmovimento,
                         nvl(hst.vltitulo, 0),
                         0)) +
             sum((nvl(decode(hst.cdmovimento,
                              77,
                              hst.vlmulta,
                              85,
                              -hst.vlmulta,
                              86,
                              -hst.vlmulta,
                              87,
                              -hst.vlmulta,
                              89,
                              -hst.vlmulta,
                              hst.vlmulta),
                       0)) + (nvl(decode(hst.cdmovimento,
                                         77,
                                         hst.vljuros,
                                         85,
                                         -hst.vljuros,
                                         86,
                                         -hst.vljuros,
                                         87,
                                         -hst.vljuros,
                                         89,
                                         -hst.vljuros,
                                         hst.vljuros),
                                  0)) + nvl(fn_criteriotaxabancaria(hst.nrregistro_titulo,
                                                                    hst.dtrecebimento,
                                                                    ttr.aotrata_taxa),
                                            0) -
                  (nvl(decode(hst.cdmovimento,
                              77,
                              hst.vldesconto,
                              85,
                              -hst.vldesconto,
                              86,
                              -hst.vldesconto,
                              87,
                              -hst.vldesconto,
                              89,
                              -hst.vldesconto,
                              hst.vldesconto),
                       0)) - (nvl(decode(hst.cdmovimento,
                                         77,
                                         hst.vlabatimento,
                                         85,
                                         -hst.vlabatimento,
                                         86,
                                         -hst.vlabatimento,
                                         87,
                                         -hst.vlabatimento,
                                         89,
                                         -hst.vlabatimento,
                                         hst.vlabatimento),
                                  0)) - (nvl(decode(hst.cdmovimento,
                                                    77,
                                                    hst.vlabatimento_2,
                                                    85,
                                                    -hst.vlabatimento_2,
                                                    86,
                                                    -hst.vlabatimento_2,
                                                    87,
                                                    -hst.vlabatimento_2,
                                                    89,
                                                    -hst.vlabatimento_2,
                                                    hst.vlabatimento_2),
                                             0)) -
                  (nvl(decode(hst.cdmovimento,
                              77,
                              hst.vlir_fonte,
                              85,
                              -hst.vlir_fonte,
                              86,
                              -hst.vlir_fonte,
                              87,
                              -hst.vlir_fonte,
                              89,
                              -hst.vlir_fonte,
                              hst.vlir_fonte),
                       0)) - (nvl(decode(hst.cdmovimento,
                                         77,
                                         hst.vlabatimento_imposto,
                                         85,
                                         -hst.vlabatimento_imposto,
                                         86,
                                         -hst.vlabatimento_imposto,
                                         87,
                                         -hst.vlabatimento_imposto,
                                         89,
                                         -hst.vlabatimento_imposto,
                                         hst.vlabatimento_imposto),
                                  0)) - (nvl(decode(hst.cdmovimento,
                                                    77,
                                                    hst.vlrecebido,
                                                    85,
                                                    -hst.vlrecebido,
                                                    86,
                                                    -hst.vlrecebido,
                                                    87,
                                                    -hst.vlrecebido,
                                                    89,
                                                    -hst.vlrecebido,
                                                    hst.vlrecebido),
                                             0)))) vlaberto
        from producao.titulo_a_receber@unicoo_homologa ttr,
             producao.cliente@unicoo_homologa cli,
             producao.grupo_de_cliente@unicoo_homologa gcl,
             producao.pessoa@unicoo_homologa pes,
             producao.endereco@unicoo_homologa enr,
             producao.historico_do_titulo@unicoo_homologa hst,
             producao.cidade@unicoo_homologa cid,
             (select *
                from producao.v_codigo_de_historico_rec@unicoo_homologa
               where cdempresa = vpcdempresa) cdh,

             -- busca o valor do título na data contabil informada
             (select max(nrmovimento) nrmovimento, nrregistro_titulo
                from producao.historico_do_titulo@unicoo_homologa
               where cdempresa = vpcdempresa
                 and dtmovimento <= vpdtcontabil
                 and cdmovimento in (1, 2, 3, 11)
               group by nrregistro_titulo) h2
       where ttr.cdempresa = vpcdempresa
         and ttr.nrregistro_titulo = hst.nrregistro_titulo
         and ttr.nrregistro_titulo = h2.nrregistro_titulo
         and ttr.cdcliente = cli.cdcliente
         and cli.cdgrupo_cliente = gcl.cdgrupo_cliente
         and ttr.cdhistorico = cdh.cdhistorico
         and cli.nrregistro_cliente = pes.nrregistro
         and pes.nrregistro = enr.nrregistro(+)
         and enr.tpendereco(+) = 'COBR'
         and enr.cdcidade = cid.cdcidade(+)
         and ttr.dttitulo <= vpdtcontabil
         and ttr.dtencerramento > vpdtcontabil
         and hst.cdmovimento in (1,
                                 2,
                                 3,
                                 7,
                                 10,
                                 11,
                                 12,
                                 13,
                                 14,
                                 20,
                                 30,
                                 70,
                                 71,
                                 72,
                                 74,
                                 76,
                                 77,
                                 78,
                                 80,
                                 85,
                                 86,
                                 87,
                                 89)
         and hst.dtmovimento <= vpdtcontabil
         and not exists
       (select *
                from producao.historico_do_titulo@unicoo_homologa ht
               where ht.nrdocumento = ttr.nrdocumento
                 and ht.cdempresa = vpcdempresa
                 and vpdtcontabil >=
                     (select max(h.dtexclusao)
                        from historico_do_titulo h
                       where h.nrdocumento = ttr.nrdocumento
                         and h.cdempresa = vpcdempresa
                         and (vpdtcontabil >= h.dtexclusao)
                         and h.cdmovimento = '80')
                 and vpdtcontabil <
                     (select min(t.dtmovimento)
                        from historico_do_titulo t
                       where t.dtmovimento >=
                             (select max(h.dtexclusao)
                                from historico_do_titulo h
                               where h.nrdocumento = ttr.nrdocumento
                                 and h.cdempresa = vpcdempresa
                                 and (vpdtcontabil >= h.dtexclusao)
                                 and h.cdmovimento = '80')
                         and t.nrdocumento = ttr.nrdocumento
                         and t.cdempresa = vpcdempresa
                         and t.cdmovimento = '99'))
         and not exists
       (select null
                from producao.titulo_gerado_encontro@unicoo_homologa tg
               where tg.nrregistro_titulo_receber = ttr.nrregistro_titulo)
         and not exists
       (select null
                from producao.historico_do_titulo@unicoo_homologa h,
                     producao.historico_do_titulo@unicoo_homologa h3
               where producao.h.nrregistro_titulo = ttr.nrregistro_titulo
                 and h3.nrregistro_titulo = ttr.nrregistro_titulo
                 and h.cdmovimento in ('70', '72', '74', '76', '78')
                 and h3.cdmovimento = 86
                 and h3.dtreferencia <> h3.dtrecebimento
                 and h.dtrecebimento = vpdtcontabil)
         and ttr.dtvencimento between vpdtvenc_ini and vpdtvenc_fin
       group by ttr.cdcliente,
                ttr.nrdocumento,
                ttr.tpdocumento,
                ttr.cdportador,
                ttr.dttitulo,
                ttr.dtultimo_recebimento,
                pes.nopessoa,
                cid.nocidade,
                enr.nrtelefone,
                enr.nrfax,
                cdh.nohistorico,
                cli.cdconta_contabil,
                ttr.nrregistro_titulo,
                pes.nrregistro,
                ttr.cdsituacao;
    --commit;
  end p_gera_carga_matriz_acr;

  procedure p_gera_carga_matriz_apb(vpcdempresa  varchar2,
                                    vpdtcontabil date,
                                    vpdtvenc_ini date,
                                    vpdtvenc_fin date) is
  begin
    -- eliminar os registros da tabela.
    delete from ti_matriz_pagar;
    --commit;
    -- inserir novamente os titulos na tabela.
    insert into ti_matriz_pagar
      select t.nrregistro_titulo,
             p.nrregistro,
             t.cdempresa,
             t.nrdocumento,
             t.cdportador,
             t.tpdocumento,
             t.cdsituacao,
             case
               when t.cdsituacao = 0 then
                'Aberto'
               when t.cdsituacao = 1 then
                'Totalmente pago'
               when t.cdsituacao = 2 then
                'Parcialmente pago'
               when t.cdsituacao = 3 then
                'Verificar Descrição'
               when t.cdsituacao = 4 then
                'Substituido aberto'
               when t.cdsituacao = 5 then
                'Substituido encerrado'
               else
                'Verificar Descrição'
             end descsituacao,
             t.dtvencimento,
             t.dttitulo,
             t.cdfornecedor,
             f.cdgrupo_fornecedor,
             g.nogrupo_fornecedor,
             p.nrcgc_cpf,
             nvl(min(t.vltitulo), 0) vltitulo,
             max(h.dtrecebimento) dtultimo_recebimento,
             sum(decode(h.cdmovimento, 11, 0, nvl(h.vlpago, 0))) vlpago,
             nvl(t.vltitulo, 0) +
             sum(-decode(h.cdmovimento, 11, 0, nvl(h.vlabatimento, 0)) -
                 decode(h.cdmovimento, 11, 0, nvl(h.vlabatimento_2, 0)) -
                 decode(h.cdmovimento, 11, 0, nvl(h.vldesconto, 0)) -
                 decode(h.cdmovimento, 11, 0, nvl(h.vlpago, 0)) +
                 decode(h.cdmovimento, 11, 0, nvl(h.vljuros, 0)) +
                 decode(h.cdmovimento, 11, 0, nvl(h.vlmulta, 0)) +
                 decode(h.cdmovimento, 11, 0, nvl(h.vltaxa_bancaria, 0))) vldevido,
             sum(decode(h.cdmovimento, 11, 0, nvl(h.vldesconto, 0))) vldesconto,
             sum(decode(h.cdmovimento, 11, 0, nvl(h.vlabatimento, 0))) vlabatimento,
             sum(decode(h.cdmovimento, 11, 0, nvl(h.vlabatimento_2, 0))) vlabatimento_2,
             sum(decode(h.cdmovimento, 11, 0, nvl(h.vljuros, 0))) vljuros,
             sum(decode(h.cdmovimento, 11, 0, nvl(h.vlmulta, 0))) vlmulta,
             sum(decode(h.cdmovimento, 11, 0, nvl(h.vltaxa_bancaria, 0))) vltaxa_bancaria
        from producao.pessoa@unicoo_homologa p,
             producao.fornecedor@unicoo_homologa f,
             producao.grupo_de_fornecedor@unicoo_homologa g,
             producao.empresa@unicoo_homologa e,
             producao.titulo_a_pagar@unicoo_homologa t,
             producao.documento_de_cobranca@unicoo_homologa d,
             producao.portador_de_cobranca@unicoo_homologa pc,
             (select nvl(decode(cdmovimento,
                                13,
                                0,
                                11,
                                0,
                                20,
                                0,
                                30,
                                0,
                                85,
                                -vlabatimento,
                                86,
                                -vlabatimento,
                                87,
                                -vlabatimento,
                                vlabatimento),
                         0) vlabatimento,
                     nvl(decode(cdmovimento,
                                13,
                                0,
                                11,
                                0,
                                20,
                                0,
                                30,
                                0,
                                85,
                                -vlabatimento_2,
                                86,
                                -vlabatimento_2,
                                87,
                                -vlabatimento_2,
                                vlabatimento_2),
                         0) vlabatimento_2,

                     nvl(decode(cdmovimento,
                                13,
                                0,
                                11,
                                0,
                                20,
                                0,
                                30,
                                0,
                                85,
                                -vldesconto,
                                86,
                                -vldesconto,
                                87,
                                -vldesconto,
                                vldesconto),
                         0) vldesconto,

                     nvl(decode(cdmovimento,
                                13,
                                vljuros,
                                25,
                                vljuros,
                                70,
                                vljuros,
                                72,
                                vljuros,
                                74,
                                vljuros,
                                76,
                                vljuros,
                                77,
                                vljuros,
                                85,
                                -vljuros,
                                86,
                                -vljuros,
                                87,
                                -vljuros,
                                0),
                         0) vljuros,

                     nvl(decode(cdmovimento,
                                7,
                                0,
                                11,
                                0,
                                12,
                                0,
                                13,
                                0,
                                14,
                                0,
                                20,
                                0,
                                30,
                                0,
                                80,
                                0,
                                85,
                                -vltaxa_bancaria,
                                86,
                                -vltaxa_bancaria,
                                87,
                                -vltaxa_bancaria,
                                vltaxa_bancaria),
                         0) vltaxa_bancaria,

                     nvl(decode(cdmovimento,
                                13,
                                vlmulta,
                                25,
                                vlmulta,
                                70,
                                vlmulta,
                                72,
                                vlmulta,
                                74,
                                vlmulta,
                                76,
                                vlmulta,
                                77,
                                vlmulta,
                                85,
                                -vlmulta,
                                86,
                                -vlmulta,
                                87,
                                -vlmulta,
                                0),
                         0) vlmulta,

                     nvl(decode(cdmovimento,
                                70,
                                vlpago,
                                72,
                                vlpago,
                                74,
                                vlpago,
                                76,
                                vlpago,
                                77,
                                vlpago,
                                85,
                                -vlpago,
                                86,
                                -vlpago,
                                87,
                                -vlpago,
                                0),
                         0) vlpago,
                     dtmovimento,
                     cdmovimento,
                     nrregistro_titulo,
                     dtrecebimento

                from producao.historico_do_titulo_pagar@unicoo_homologa
               where cdempresa = vpcdempresa
                 and cdmovimento in (1,
                                     2,
                                     3,
                                     4,
                                     7,
                                     9,
                                     11,
                                     12,
                                     13,
                                     14,
                                     20,
                                     25,
                                     30,
                                     70,
                                     72,
                                     74,
                                     76,
                                     77,
                                     80,
                                     85,
                                     86,
                                     87)
                 and (decode(cdmovimento,
                             1,
                             to_date(dttitulo), -- incl normal
                             --  2 , to_date(dtmovimento)   ,-- incl agrup
                             --  3 , to_date(dtmovimento)   ,-- incl desmp
                             7,
                             to_date(dtmovimento),
                             9,
                             to_date(dtmovimento),
                             11,
                             to_date(dtmovimento),
                             12,
                             to_date(dtmovimento),
                             13,
                             to_date(dtmovimento),
                             25,
                             to_date(dtmovimento),
                             70,
                             to_date(dtrecebimento), -- baixa normal
                             72,
                             to_date(dtrecebimento), -- baixa arq mag
                             74,
                             to_date(dtrecebimento), -- baixa deb auto
                             75,
                             to_date(dtrecebimento), -- baixa composicao
                             76,
                             to_date(dtrecebimento), -- baixa enc ctas
                             77,
                             to_date(dtrecebimento), -- baixa por adiantamento
                             85,
                             to_date(dtmovimento),
                             86,
                             to_date(dtmovimento),
                             87,
                             to_date(dtmovimento),
                             80,
                             to_date(dttitulo)) <=
                     to_date(vpdtcontabil, 'dd/mm/yyyy') -- titulo cancelado  --
                     or (cdmovimento = 20) or (cdmovimento = 30))
                 and (dtexclusao is null or
                     cdmovimento = 80 and
                     dtexclusao > to_date(vpdtcontabil, 'dd/mm/yyyy'))) h,
             (select d.nrregistro_titulo,
                     --        d.cddivisao,
                     --        d.cdcentro_custo,
                     --        d.cdhistorico,
                     sum(decode(d.tipo_distrib, 'V', d.vldistribuicao, 0)) vltitulo,
                     sum(decode(d.tipo_distrib, 'D', d.vldistribuicao, 0)) vldesconto,
                     sum(decode(d.tipo_distrib, 'A', d.vldistribuicao, 0)) vlabatimento,
                     sum(decode(d.tipo_distrib, 'B', d.vldistribuicao, 0)) vlabatimento_2
                from producao.distribuicao_titulo_pagar@unicoo_homologa d
               where d.nrmovimento in
                     (select max(a.nrmovimento) nrmovimento
                        from producao.historico_do_titulo_pagar@unicoo_homologa a,
                             producao.distribuicao_titulo_pagar@unicoo_homologa b
                       where a.nrregistro_titulo = d.nrregistro_titulo
                         and b.nrregistro_titulo = d.nrregistro_titulo
                         and a.dtmovimento <=
                             to_date(vpdtcontabil, 'dd/mm/yyyy')
                         and a.nrmovimento = b.nrmovimento
                       group by b.tipo_distrib)
               group by d.nrregistro_titulo) k
       where t.cdempresa = e.cdempresa
         and t.nrregistro_titulo = h.nrregistro_titulo(+)
         and t.nrregistro_titulo = k.nrregistro_titulo(+)
         and t.tpdocumento = d.tpdocumento
         and t.cdportador = pc.cdportador
         and t.cdfornecedor = f.cdfornecedor
         and f.nrregistro_fornecedor = p.nrregistro
         and f.cdgrupo_fornecedor = g.cdgrupo_fornecedor
         and t.dttitulo <= to_date(vpdtcontabil, 'dd/mm/yyyy')
         and t.cdempresa = vpcdempresa
         and ((t.cdsituacao in ('0', '2', '4', '6', '7')) or
             (t.cdsituacao in ('1', '5') and
             t.dtultimo_recebimento > to_date(vpdtcontabil, 'dd/mm/yyyy')) or
             (t.cdsituacao in ('1', '5') and
             fn_saldo_titulo_pag_data(t.nrregistro_titulo,
                                        to_date(to_date(vpdtcontabil,
                                                        'dd/mm/yyyy')) + 1,
                                        0) > 0) or
             (t.cdsituacao = '8' and
             t.dtexclusao > to_date(vpdtcontabil, 'dd/mm/yyyy')))
         and not exists
       (select null
                from titulo_gerado_encontro tg
               where tg.nrregistro_titulo_pagar = t.nrregistro_titulo)
         and not exists
       (select null
                from historico_do_titulo_pagar h
               where h.nrregistro_titulo = t.nrregistro_titulo
                 and h.cdmovimento = 5)
         and t.dtvencimento between vpdtvenc_ini and vpdtvenc_fin
         and t.tpdocumento <> 'ADT'
       group by t.nrregistro_titulo,
                t.cdfornecedor,
                p.nrregistro,
                t.cdempresa,
                t.idcontrato,
                t.cdhistorico,
                t.nrdocumento,
                t.cdportador,
                t.tpdocumento,
                t.cdsituacao,
                t.cdoperacao,
                t.dtvencimento,
                t.dttitulo,
                t.cddivisao,
                t.txhistorico,
                f.cdgrupo_fornecedor,
                g.nogrupo_fornecedor,
                p.nopessoa,
                p.nrcgc_cpf,
                p.tppessoa,
                e.noempresa,
                d.nodocumento,
                pc.noportador,
                f.cdconta_contabil,
                t.vltitulo
      having nvl(decode(t.cdsituacao, '6', max(decode(h.cdmovimento, 20, h.dtmovimento, null)), null), to_date('01/01/3000', 'dd/mm/yyyy')) > to_date(vpdtcontabil, 'dd/mm/yyyy') and nvl(decode(t.cdsituacao, '7', max(decode(h.cdmovimento, 30, h.dtmovimento, null)), null), to_date('01/01/3000', 'dd/mm/yyyy')) > to_date(vpdtcontabil, 'dd/mm/yyyy');

    --commit;
  end p_gera_carga_matriz_apb;

  procedure p_gera_dados_comparativo_acr is
  begin
    delete from ti_tit_acr_comparativo;
    --commit;

    insert into ti_tit_acr_comparativo
      select distinct ta.cod_refer,
                      min(a.nrsequencial) nrsequencial,
                      a.nrsequencial_origem,
                      a.tpintegracao,
                      nvl(b.val_titulo, 0) val_titulo,
                      --nvl(imp.val_imposto,0) val_imposto,
                      a.cdsituacao sit_ti_controle,
                      nvl(b.cdsituacao, 'NI') sit_ti_tit_apb,
                      nvl(ta.val_origin_tit_acr, 0) vloriginal,
                      nvl(ta.val_sdo_tit_acr, 0) val_sdo_tit_ap
        from ti_controle_integracao a, ti_tit_acr b, tit_acr ta
       where a.nrsequencial = b.nrseq_controle_integracao(+)
         and nvl(a.tpintegracao, 'TR') = 'TR'
         and nvl(a.cdsituacao, 'RE') <> 'RE'
         and 'TR' || lpad(b.nrseq_controle_integracao, 8, '0') =
             ta.cod_refer(+)
         and nvl(ta.u##ind_tip_espec_docto, 'NORMAL') = 'NORMAL'
       group by ta.cod_refer,
                a.nrsequencial_origem,
                a.tpintegracao,
                b.val_titulo,
                a.cdsituacao,
                b.cdsituacao,
                ta.val_origin_tit_acr,
                ta.val_sdo_tit_acr;
    --commit;

  end p_gera_dados_comparativo_acr;

  procedure p_gera_dados_comparativo_apb is
  begin
    delete from ti_tit_apb_comparativo;
    --commit;

    insert into ti_tit_apb_comparativo
      select distinct tp.cod_refer,
                      min(a.nrsequencial) nrsequencial,
                      a.nrsequencial_origem,
                      a.tpintegracao,
                      nvl(b.val_titulo, 0) val_titulo,
                      nvl(imp.val_imposto, 0) val_imposto,
                      a.cdsituacao sit_ti_controle,
                      nvl(b.cdsituacao, 'NI') sit_ti_tit_apb,
                      nvl(tp.val_origin_tit_ap, 0) vloriginal,
                      nvl(tp.val_sdo_tit_ap, 0) val_sdo_tit_ap
        from ti_controle_integracao a,
             ti_tit_apb b,
             tit_ap tp,
             (select i.nrseq_controle_integracao,
                     sum(i.val_imposto) val_imposto
                from ti_tit_apb_imposto i
               group by i.nrseq_controle_integracao) imp

       where a.nrsequencial = b.nrseq_controle_integracao(+)
         and nvl(a.tpintegracao, 'TP') = 'TP'
         and nvl(a.cdsituacao, 'RE') <> 'RE'
         and imp.nrseq_controle_integracao(+) = a.nrsequencial
         and 'I' || lpad(b.nrseq_controle_integracao, 9, '0') =
             tp.cod_refer(+)
         and nvl(tp.u##ind_tip_espec_docto, 'NORMAL') = 'NORMAL'
       group by tp.cod_refer,
                a.nrsequencial_origem,
                a.tpintegracao,
                b.val_titulo,
                imp.val_imposto,
                a.cdsituacao,
                b.cdsituacao,
                tp.val_origin_tit_ap,
                tp.val_sdo_tit_ap;
    --commit;

  end p_gera_dados_comparativo_apb;

  procedure p_apaga_pessoa_juridica is

    cursor c_pessoa_jurid is
      select progress_recid
        from ems5.pessoa_jurid pj
       where not exists
       (select 1
                from v_pessoa_juridica v
               where pj.num_pessoa_jurid = v.NUM_PESSOA_JURID);

  begin

    for pj in c_pessoa_jurid loop

      delete from ems5.pessoa_jurid p
       where p.progress_recid = pj.progress_recid;

      p_commit;

    end loop;

    --commit;

  end p_apaga_pessoa_juridica;

  procedure p_reprocessa_status_pe(pnrseq_controle_integracao ti_controle_integracao.nrsequencial%type,
                                   ptpintegracao              ti_controle_integracao.tpintegracao%type)

   is

  begin

    if ptpintegracao = 'CL' then

      delete from ti_cliente tc
       where (tc.nrseq_controle_integracao = pnrseq_controle_integracao or
             pnrseq_controle_integracao is null)
         and tc.cdsituacao = 'PE';

      commit;

      pck_ems506unicoo.p_job;

    elsif ptpintegracao = 'FN' then

      delete from ti_fornecedor tc
       where (tc.nrseq_controle_integracao = pnrseq_controle_integracao or
             pnrseq_controle_integracao is null)
         and tc.cdsituacao = 'PE';

      commit;

      pck_ems506unicoo.p_job;

    elsif ptpintegracao = 'TP' then

      delete from ti_tit_apb tc
       where (tc.nrseq_controle_integracao = pnrseq_controle_integracao or
             pnrseq_controle_integracao is null)
         and tc.cdsituacao = 'PE';

      commit;

      pck_ems506unicoo.p_job;

    elsif ptpintegracao = 'TR' then

      delete from ti_tit_acr tc
       where (tc.nrseq_controle_integracao = pnrseq_controle_integracao or
             pnrseq_controle_integracao is null)
         and tc.cdsituacao = 'PE';

      commit;

      pck_ems506unicoo.p_job;

    end if;

  end p_reprocessa_status_pe;

Procedure p_atualiza_fluxo_financ_fornec

is

  v integer;
  w integer;
  registro number;

  Cursor c is
  select
      distinct f.nrregistro_fornecedor
  from
      producao.historico_do_titulo_pagar@unicoo_homologa h,
      producao.fornecedor@unicoo_homologa f,
      ems5.fornecedor ef,
      ti_pessoa p
  where h.cdhistorico          is not null
  and   h.cdfornecedor         is not null
  and   h.cdfornecedor         = f.cdfornecedor
  and   f.nrregistro_fornecedor = p.nrregistro
  and   p.cdn_fornecedor        = ef.cdn_fornecedor
  order by 1;

  Cursor D is
  select
      tip.cdn_fornecedor,
      t.cdhistorico
  from
     (select
         f1.nrregistro_fornecedor,
         h1.cdhistorico,
         tp.dttitulo,
         count(*) maior
      from
         producao.historico_do_titulo_pagar@unicoo_homologa h1,
         producao.fornecedor@unicoo_homologa f1,
         producao.titulo_a_pagar@unicoo_homologa tp
      where h1.cdhistorico          is not null
      and   h1.cdfornecedor         is not null
      and   h1.cdfornecedor         = f1.cdfornecedor
      and   h1.nrregistro_titulo    = tp.nrregistro_titulo
      group by (f1.nrregistro_fornecedor,h1.cdhistorico, tp.dttitulo)
      order by 1,2,4 desc, 3 desc) t,
      ti_pessoa tip,
      ems5.fornecedor ef5
      where t.nrregistro_fornecedor = tip.nrregistro
      and   tip.cdn_fornecedor      = ef5.cdn_fornecedor
      and   tip.nrregistro          = registro
      and   rownum =1;

  begin

    for v in c loop

       registro:=v.nrregistro_fornecedor;

       for w in d loop

           update ems5.fornec_financ ffe
               set ffe.cod_tip_fluxo_financ = decode((select tia.cod_tip_fluxo_financ from ems506unicoo.ti_tipo_movimento_tit_apb tia
                                                      where tia.cdmovimento = w.cdhistorico),null,
                                                     decode((select ps.tppessoa from pessoa ps where ps.nrregistro = v.nrregistro_fornecedor),
                                                             'J',
                                                             (select pi.vlparametro from ti_parametro_integracao pi where pi.cdparametro = 'COD_TIP_FLUXO_FINANC_PREFER_FOR_J'),
                                                             (select pi.vlparametro from ti_parametro_integracao pi where pi.cdparametro = 'COD_TIP_FLUXO_FINANC_PREFER_FOR_F')),
                                                             (select tia.cod_tip_fluxo_financ from ems506unicoo.ti_tipo_movimento_tit_apb tia
                                                              where tia.cdmovimento = w.cdhistorico))
           where ffe.cdn_fornecedor = w.cdn_fornecedor;

       end loop;

    commit;

   end loop;

end p_atualiza_fluxo_financ_fornec;

begin
  -- Initialization
  -- Alessandro 20/03/2012
  select vlparametro
    into wnaoreprocessa
    from ti_parametro_integracao
   where cdparametro = 'TPINTEGRACAONAOREPROCESSA';
  -- Alessandro 20/03/2012

  Pcpf_dtnascimento := f_ti_parametro_integracao('CPF_DTNASCIMENTO');

  NULL;
END PCK_EMS506UNICOO;
/

prompt
prompt Creating package body PCK_EMS506UNICOO_UNIMEDJP
prompt ===============================================
prompt
CREATE OR REPLACE PACKAGE BODY EMS506UNICOO."PCK_EMS506UNICOO_UNIMEDJP" is

 /*
  ************************************************************************************************************************************************
  Criac?o          : Jefferson M Ximenes
  Data             : 09/01/2014
  Modulo Principal : Integrac?o Unicoo X EMS5
  Modulos          : Integrac?o Unicoo X EMS5
  Objetivo         : Realizar a integrac?o do Unicoo com o EMS5   Alteracoes

                     Criado para atender a necessidade de se processar título de forma individual no SistInt
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
  |----------------------------------------------------------------------------------------------------------------------------------------------|
             |                 |                 |           |                                                             |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  ************************************************************************************************************************************************
  */

wnaoreprocessa  ti_parametro_integracao.cdparametro%type;

 procedure p_reprocessa_integracao_UJP(pNRSeq_Controle_integracao number,
                                       p_tpintegracao             varchar2) is

    cursor c_reprocessa is
      select *
        from ti_controle_integracao ci
       where (ci.nrsequencial = pNRSeq_Controle_integracao or
             pNRSeq_Controle_integracao = 0)
         and ci.cdsituacao in ('PE')
         and ((ci.tpintegracao = p_tpintegracao) or (p_tpintegracao = '*'))
         and wnaoreprocessa not like '%' || ci.tpintegracao || '%'
       order by ci.nrsequencial;

       v_seq_controle_integracao number(10);
  begin
    select vlparametro
      into wnaoreprocessa
      from ems506unicoo.ti_parametro_integracao
     where cdparametro = 'TPINTEGRACAONAOREPROCESSA';

    for l_reprocessa in c_reprocessa loop
      select sq_ti_controle_integracao.nextval
        into v_seq_controle_integracao
        from dual;

      insert into ti_controle_integracao
        (nrsequencial,
         tpintegracao,
         dtgeracao,
         nrsequencial_origem,
         dtprocessamento,
         dtintegracao,
         cdacao,
         cdidentificador,
         CDSITUACAO,
         nrseq_controle_integracao_org,
         cdempresa,
         cdmodulo,
         cdmovimento,
         cddivisao)
        select v_seq_controle_integracao,
               tpintegracao,
               sysdate dtgeracao,
               nrsequencial_origem,
               null,
               dtintegracao,
               l_reprocessa.cdacao,
               cdidentificador,
               'GE',
               l_reprocessa.nrsequencial,
               l_reprocessa.cdempresa,
               l_reprocessa.cdmodulo,
               l_reprocessa.cdmovimento,
               l_reprocessa.cddivisao
          from ti_controle_integracao ci
         where ci.nrsequencial = l_reprocessa.nrsequencial;

      update ti_controle_integracao ci
         set ci.dtprocessamento = sysdate, ci.cdsituacao = 'RE'
       where ci.nrsequencial = l_reprocessa.nrsequencial;

      if l_reprocessa.tpintegracao = 'CL' then
        update ti_cliente cl
           set cl.cdsituacao = 'RE' -- REPROCESSA
         where nrseq_controle_integracao = l_reprocessa.nrsequencial;
      elsif l_reprocessa.tpintegracao = 'FN' then
        update ti_fornecedor fn
           set fn.cdsituacao = 'RE' -- REPROCESSA
         where nrseq_controle_integracao = l_reprocessa.nrsequencial;
      elsif l_reprocessa.tpintegracao = 'TR' then
        update ti_tit_acr cl
           set cl.cdsituacao = 'RE'
         where nrseq_controle_integracao = l_reprocessa.nrsequencial;
      elsif l_reprocessa.tpintegracao = 'TP' then
        update ti_tit_apb cl
           set cl.cdsituacao = 'RE'
         where nrseq_controle_integracao = l_reprocessa.nrsequencial;
      elsif l_reprocessa.tpintegracao = 'CT' then
        update ti_lote_ctbl cl
           set cl.cdsituacao = 'RE'
         where nrseq_controle_integracao = l_reprocessa.nrsequencial;
      elsif l_reprocessa.tpintegracao = 'CX' then
        update ti_lote_ctbl cl
           set cl.cdsituacao = 'RE'
         where nrseq_controle_integracao = l_reprocessa.nrsequencial;
      elsif l_reprocessa.tpintegracao IN ('FT', 'EM') then
        update ti_tit_acr_estorno cl
           set cl.cdsituacao = 'RE'
         where nrseq_controle_integracao = l_reprocessa.nrsequencial;
      elsif l_reprocessa.tpintegracao = 'BP' then
        update ti_cx_bx_apb bp
           set bp.cdsituacao = 'RE'
         where nrseq_controle_integracao = l_reprocessa.nrsequencial;
      elsif l_reprocessa.tpintegracao = 'BR' then
        update ti_cx_bx_acr br
           set br.cdsituacao = 'RE'
         where nrseq_controle_integracao = l_reprocessa.nrsequencial;

      end if;
    end loop;

    commit;

    /*
     A mudança com relação ao original esta aqui, ao invez de chamar o JOB e o mesmo
     mandar varrer a lista, o que causa demora, direciona para o registro que quero
     reprocessando-o de forma imediata.
    */

    --pck_ems506unicoo.p_job();

    p_envia_para_monitor( pNRSeq_Controle_integracao ) ;

  end;


 procedure p_envia_para_monitor(pNRSeq_Controle_integracao number ) is

  vtpintegracao ti_parametro_integracao.vlparametro%type;
  begin

          vTPIntegracao := f_ti_parametro_integracao('TP_INTEGRACAO_ONLINE_UNICOO_EMS5');

          if vTPIntegracao LIKE '%' || 'CL' || '%' then
            PCK_EMS506UNICOO.p_monitor_integracao( pNRSeq_Controle_integracao , 'CL');
          end if;
          if vTPIntegracao LIKE '%' || 'FN' || '%' then
            PCK_EMS506UNICOO.p_monitor_integracao( pNRSeq_Controle_integracao , 'FN');
          end if;
          if vTPIntegracao LIKE '%' || 'TR' || '%' then
            PCK_EMS506UNICOO.p_monitor_integracao( pNRSeq_Controle_integracao , 'TR');
          end if;
          if vTPIntegracao LIKE '%' || 'TP' || '%' then
            PCK_EMS506UNICOO.p_monitor_integracao( pNRSeq_Controle_integracao , 'TP');
          end if;
          if vTPIntegracao LIKE '%' || 'FT' || '%' then
            PCK_EMS506UNICOO.p_monitor_integracao( pNRSeq_Controle_integracao , 'FT');
          end if;
          if vTPIntegracao LIKE '%' || 'CX' || '%' then
            PCK_EMS506UNICOO.p_monitor_integracao( pNRSeq_Controle_integracao , 'CX');
          end if;
          if vTPIntegracao LIKE '%' || 'BP' || '%' then
            PCK_EMS506UNICOO.p_monitor_integracao( pNRSeq_Controle_integracao , 'BP');
          end if;
          if vTPIntegracao LIKE '%' || 'BR' || '%' then
            PCK_EMS506UNICOO.p_monitor_integracao( pNRSeq_Controle_integracao , 'BR');
          end if;
          if vTPIntegracao LIKE '%' || 'CP' || '%' then
            -- cancelamento titulo pagar no ems
            PCK_EMS506UNICOO.p_monitor_integracao( pNRSeq_Controle_integracao , 'CP');
          end if;

          commit;
 end;


  procedure p_gera_distrib_apb(pNRSeq_Controle_integracao number )is
  begin
     begin
        insert into ti_tit_apb_ctbl ctb
                (cod_cta_ctbl,
                 dat_processamento,
                 cod_estab,
                 cod_tip_fluxo_financ,
                 cod_unid_federac,
                 val_aprop_ctbl,
                 nrseq_controle_integracao,
                 cod_ccusto,
                 cdsituacao)
                 -- josias 30-06-2014
                 -- falta tratar o problema do centro de custo nao esta
                 -- cadastrado no plano de contas informado
                 (
                  select y.cod_cta_ctbl,
                         y.dat_processamento,
                         y.cod_estab,
                         y.cod_tip_fluxo_financ,
                         y.cod_unid_federac,
                         sum(y.vldistribuicao),
                         y.nrseq_controle_integracao,
                         decode(y.cdcentro_custo,null,' ',y.cdcentro_custo ) cdcentro_custo,
                         y.cdsituacao
                  from (
                         select distinct
                                 x.cod_cta_ctbl,
                                 x.dat_processamento,
                                 x.cod_estab,
                                 x.cod_tip_fluxo_financ,
                                 x.cod_unid_federac,
                                 x.vldistribuicao,
                                 x.nrseq_controle_integracao,
                                 case when x.tipo_ccusto = '$T' then
                                  case when f_ti_parametro_integracao('AOUTILIZA_CODIGO_REDUZIDO') = 'N' then
                                       cc.cdconta
                                  else
                                       to_char(x.cdcentro_custo)
                                  end
                                 else
                                     ' '
                                 end cdcentro_custo,
                                 x.cdsituacao
                            from conta_contabil cc,
                                 (select distinct
                                         cod_cta_ctbl,
                                         dat_processamento,
                                         cod_estab,
                                         cod_tip_fluxo_financ,
                                         cod_unid_federac,
                                         --sum(nvl(decode(b.tipo_distrib,'V',b.vldistribuicao,(-1 * b.vldistribuicao)),ctb.val_aprop_ctbl)) vldistribuicao,     -- Alessandro 22/10/2014
                                         sum(b.vldistribuicao) vldistribuicao,      -- Alessandro 22/10/2014
                                         nrseq_controle_integracao,
                                         ctb.cdsituacao,
                                         case when b.cdcentro_custo is null then
                                             ctb.cod_ccusto
                                         else
                                             to_char(b.cdcentro_custo)
                                         end cdcentro_custo,
                                         ctb.cod_ccusto,
                                         ctb.tipo_ccusto
                                    from v_ti_tit_apb_ctbl ctb,
                                         distribuicao_titulo_pagar b
                                   where ctb.nrregistro_titulo = b.nrregistro_titulo(+)
                                     and nrseq_controle_integracao = pNRSeq_Controle_integracao
                                     and b.tipo_distrib='V'-- ALessandro 22/10/2014
                                   group by cod_cta_ctbl,
                                            dat_processamento,
                                            cod_estab,
                                            cod_tip_fluxo_financ,
                                            cod_unid_federac,
                                            nrseq_controle_integracao,
                                            b.cdcentro_custo,
                                            ctb.cod_ccusto,
                                            ctb.tipo_ccusto,
                                            ctb.cdsituacao ) x
                            where x.cdcentro_custo = cc.nrconta_reduzida(+)
                              and cc.nrplano_contas(+) = f_ti_parametro_integracao('NRPLANO_CENTRO_CUSTO_UNICOO')

                 ) y
                 group by y.cod_cta_ctbl,
                          y.dat_processamento,
                          y.cod_estab,
                          y.cod_tip_fluxo_financ,
                          y.cod_unid_federac,
                          y.nrseq_controle_integracao,
                          y.cdcentro_custo,
                          y.cdsituacao );

                commit;

                p_gera_imposto_apb(pNRSeq_Controle_integracao);
   exception
      when others then
        rollback;
        raise_application_error(-20001,
                                'Erro gerando a distribuição do título APB - Controle ' || pNRSeq_Controle_integracao);
    end;

  end;


  procedure p_gera_imposto_apb(pNRSeq_Controle_integracao number ) is
  begin
     begin
        insert into TI_TIT_APB_IMPOSTO
                (cod_ser_docto,
                 ind_clas_impto,
                 val_impto_ja_recolhid,
                 val_outras_deduc_impto,
                 cod_titulo_ap,
                 val_rendto_tribut,
                 val_aliq_impto,
                 val_deduc_faixa_imto,
                 cod_estab,
                 cod_espec_docto,
                 cod_parcela,
                 cod_unid_federac,
                 cod_imposto,
                 cod_classif_impto,
                 val_deduc_inss,
                 val_deduc_depend,
                 val_deduc_pensao,
                 val_deduc_outras_deduc,
                 val_base_liq_impto,
                 val_imposto,
                 dat_vencto,
                 des_text_histor,
                 dat_processamento,
                 cdsituacao,
                 val_deduc_faixa_impto,
                 cod_cta_ctbl,
                 nrseq_controle_integracao,
                 cod_plano_ctb_cbtl,
                 ind_ocorrencia,
                 cod_tip_fluxo_financ)
                select cod_ser_docto,
                       ind_clas_impto,
                       val_impto_ja_recolhid,
                       val_outras_deduc_impto,
                       substr(cod_titulo_ap,0,10),
                       val_rendto_tribut,
                       val_aliq_impto,
                       val_deduc_faixa_imto,
                       cod_estab,
                       cod_espec_docto,
                       cod_parcela,
                       cod_unid_federac,
                       cod_imposto,
                       cod_classif_impto,
                       val_deduc_inss,
                       val_deduc_depend,
                       val_deduc_pensao,
                       val_deduc_outras_deduc,
                       val_base_liq_impto,
                       val_imposto,
                       dat_vencto,
                       des_text_histor,
                       dat_processamento,
                       cdsituacao,
                       val_deduc_faixa_impto,
                       cod_cta_ctbl,
                       nrseq_controle_integracao,
                       cod_plano_ctb_cbtl,
                       ind_ocorrencia,
                       cod_tip_fluxo_financ
                  from v_ti_tit_apb_imposto ip
                 where ip.nrseq_controle_integracao =pNRSeq_Controle_integracao ;

                 commit;
     exception
       when others then
          rollback;
          raise_application_error(-20001,
                                  'Erro gerando o imposto do título APB - Controle ' || pNRSeq_Controle_integracao);
    end;




   end;

end PCK_EMS506UNICOO_UNIMEDJP ;
/

prompt
prompt Creating package body PCK_EMS506UNICOO_VINI
prompt ===========================================
prompt
CREATE OR REPLACE PACKAGE BODY EMS506UNICOO."PCK_EMS506UNICOO_VINI" IS

  /*  -- Private type declarations
  type <TypeName> is <Datatype>;
  -- Private constant declarations
  <ConstantName> constant <Datatype> := <Value>;
  -- Private variable declarations
  <VariableName> <Datatype>;
  -- Function and procedure implementations
  function <FunctionName>(<Parameter> <Datatype>) return <Datatype> is
    <LocalVariable> <Datatype>;
  begin
    <Statement>;
    return(<Result>);
  end;*/
  /*
  ************************************************************************************************************************************************
  Criac?o          : Alecsandro Ferreira dos Santos
  Data             : 02/07/2009
  Modulo Principal : Integrac?o Unicoo X EMS5
  Modulos          : Integrac?o Unicoo X EMS5
  Objetivo         : Realizar a integrac?o do Unicoo com o EMS5
  Alteracoes
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
  |----------------------------------------------------------------------------------------------------------------------------------------------|
  | 09/03/2012 | Alessandro      |                 |           | - Implementada controle de cancelamento de faturas, para permitir cancelar      |
  |            |                 |                 |           |   faturas no modulo faturamento que est?o contabilizadas no EMS5, foi criado o  |
  |            |                 |                 |           |   parametro CANCELFTCTBL com o valor "S" utiliza o controle, valor "N" n?o      |
  |            |                 |                 |           |   utiliza o controle.                                                           |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 21/03/2012 | Alessandro      |                 |           | - Foi realizado correc?o para controla a integrac?o das Faturas Cancelas com o  |
  |            |                 |                 |           |   EMS5, o parametro CANCELFTCTBL foi alterado, com o valor "S" n?o mudou, para  |
  |            |                 |                 |           |   o valor "N" a integrac?o n?o barra o cancelamento no modulo de Faturamento,   |
  |            |                 |                 |           |   mas so envia o estorno para o EMS5 quando o titulo esta contabilizado,        |
  |            |                 |                 |           |   enquanto isso o cancelamento fica pendente na integrac?o com a situac?o ER,   |
  |            |                 |                 |           |   quando o titulo e contabilizado a integrac?o libera o cancelamento            |
  |            |                 |                 |           |   para integrar.                                                                |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 31/05/2012 | Edmilson Braz Fo|                 |           | - O processo de integracao do ACR estava usando o historico do movimento 1 do   |
  |            |                 |                 |           |   titulo a receber para titulos sem fatura, porem, para o ajius n?o esta sendo  |
  |            |                 |                 |           |   o historico nesse movto, o processo foi alterado para pegar o titulo caso     |
  |            |                 |                 |           |   nulo no movimento.                                                            |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  ************************************************************************************************************************************************
  */
  -- parametros genericos
  VVERSAOFINANCEIRO VARCHAR2(10);

  WNAOREPROCESSA TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;
  PCPF_DTNASCIMENTO TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;

  TTIT_AP TIT_AP%ROWTYPE;

  PROCEDURE VALIDA_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                           PCDFORNECEDOR_EMS5         IN NUMBER) IS
    TTI_TIT_APB TI_TIT_APB%ROWTYPE;
    JAEXISTE    NUMBER;
  BEGIN
    SELECT *
      INTO TTI_TIT_APB
      FROM TI_TIT_APB A
     WHERE NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
    BEGIN
      SELECT COUNT(1)
        INTO JAEXISTE
        FROM TIT_AP A, TI_EMPRESA EMP
       WHERE 1 = 1
         AND A.CDN_FORNECEDOR = PCDFORNECEDOR_EMS5
         AND A.COD_TIT_AP = TTI_TIT_APB.COD_TITULO_AP
         AND A.COD_ESPEC_DOCTO = TTI_TIT_APB.COD_ESPEC_DOCTO
         AND A.COD_SER_DOCTO = TTI_TIT_APB.COD_SER_DOCTO
         AND A.COD_EMPRESA = EMP.COD_EMPRESA
         AND A.COD_PARCELA = TTI_TIT_APB.COD_PARCELA
         AND EMP.CDEMPRESA =
             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
      -- fabiano, nao foi encontrado necessidade de manter a delecao deste registro.
      --          delete ti_tit_apb where nrseq_controle_integracao = pnrseq_controle_integracao;
      -- fabiano,  caso encontre mais que 1 titulo, entao gera falha
      IF JAEXISTE > 0 THEN
        RAISE_APPLICATION_ERROR(-20010, 'Titulo ja existe no EMS');
      END IF;
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        NULL;
    END;
  END;

  PROCEDURE CANCELA_CONTROLE_TIT_IMPOSTOS(PNRSESSAO IN NUMBER) IS
    WTPDOC VARCHAR2(40);
  BEGIN
    /*
       Cancela os controles de titulos do contas a pagar unicoo referentes
       a impostos ( TX ), pois esses titulos n?o s?o integrados para o EMS
    */
    WTPDOC := F_PARAMETRO('TPDOCPRE');
    IF WTPDOC IS NULL THEN
      RAISE_APPLICATION_ERROR(-20001, 'Parametro TPDOCPRE n?o encontrado');
    END IF;
    FOR X IN (SELECT A.ROWID
                FROM TI_CONTROLE_INTEGRACAO A, TITULO_A_PAGAR B
               WHERE A.NRSEQUENCIAL_ORIGEM = B.NRREGISTRO_TITULO
                 AND A.CDSITUACAO IN ('GE', 'ER', 'PE', 'RC') --ADICIONADO OUTRAS SITUACOES ALEM DE GE --BRAZ 11/11/10
                 AND A.TPINTEGRACAO = 'TP'
                 AND A.NRSESSAO = PNRSESSAO
                 AND B.TPDOCUMENTO = WTPDOC
                 AND NOT EXISTS
               (SELECT 1
                        FROM TAXA_TITULO_INTEGRACAO T
                       WHERE T.NRREGISTRO_TITULO_TAXA = B.NRREGISTRO_TITULO) --DESCONSIDER LIQ NEGATIVO BRAZ 11/11/10
              ) LOOP
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'A integracao do unicoo com o ems5 nao integra titulos de previsao'
       WHERE ROWID = X.ROWID;
    END LOOP;
  END;

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_ACR(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
    VCTBZDA NUMBER; -- Alessandro 29/09/2011
    QTD_MOV NUMBER;
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TR'
         AND CI.NRSEQUENCIAL_ORIGEM = PNRRREGISTRO_TITULO
         AND CI.CDIDENTIFICADOR = PNRDOCUMENTO
         AND CI.CDIDENTIFICADOR NOT IN ('CA', 'RE');
    VACHOU BOOLEAN;
  BEGIN
    VACHOU := FALSE;
    FOR L_TITULO IN C_TITULO LOOP
      IF L_TITULO.CDSITUACAO = 'IT' THEN
        VACHOU := TRUE;
      ELSIF L_TITULO.CDSITUACAO IN ('GE', 'ER') THEN
        UPDATE TI_CONTROLE_INTEGRACAO TA
           SET TA.CDSITUACAO = 'CA', TA.TXOBSERVACAO = 'LINHA 152'
         WHERE TA.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
      ELSE
        BEGIN
          UPDATE TI_TIT_ACR TA
             SET TA.CDSITUACAO = 'CA'
           WHERE TA.NRSEQ_CONTROLE_INTEGRACAO = L_TITULO.NRSEQUENCIAL;
          -----
          UPDATE TI_CONTROLE_INTEGRACAO TA
             SET TA.CDSITUACAO = 'CA', TA.TXOBSERVACAO = 'LINHA 166'
           WHERE TA.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
        EXCEPTION
          WHEN OTHERS THEN
            VACHOU := TRUE;
            RAISE_APPLICATION_ERROR(-20101,
                                    'Erro ao cancelar a integrao da fatura ' ||
                                    PNRDOCUMENTO || ' ' || SQLERRM);
        END;
      END IF;
    END LOOP;
    IF VACHOU THEN
      SELECT COUNT(*)
        INTO QTD_MOV
        FROM EMS_MOVIMENTO_TITULO_ACR EMS, MOVTO_TIT_ACR MOV --BRAZ 10/12
       WHERE EMS.NUM_ID_MOVTO_TIT_ACR = MOV.NUM_ID_MOVTO_TIT_ACR
         AND MOV.U##COD_ESTAB = EMS.COD_ESTAB
         AND EMS.NRREGISTRO_TITULO = PNRRREGISTRO_TITULO;
      IF QTD_MOV > 1 THEN
        VRESULT := 'N';
      ELSE
        IF F_TI_PARAMETRO_INTEGRACAO('CANCELFTCTBL') = 'S' THEN
          -- ALESSANDRO 09/03/2012
          -- vResult:='S'; -- Alessandro 07/03/2012
          -- Inicio Alessandro 29/09/2011
          VCTBZDA := 0;
          SELECT MOV.LOG_APROP_CTBL_CTBZDA
            INTO VCTBZDA
            FROM EMS_MOVIMENTO_TITULO_ACR EMS, MOVTO_TIT_ACR MOV --BRAZ 10/12
           WHERE EMS.NUM_ID_MOVTO_TIT_ACR = MOV.NUM_ID_MOVTO_TIT_ACR
             AND MOV.U##COD_ESTAB = EMS.COD_ESTAB
             AND EMS.NRREGISTRO_TITULO = PNRRREGISTRO_TITULO;
          IF VCTBZDA = 0 THEN
            VRESULT := 'N';
            RAISE_APPLICATION_ERROR(-20101,
                                    'Titulo no EMS5 n?o esta contabilizado. Contabilize antes de Cancelar.');
          ELSE
            VRESULT := 'S';
          END IF;
          -- Final Alessandro 29/09/2011
        ELSE
          VRESULT := 'S';
        END IF; -- ALESSANDRO 09/03/2012
      END IF;
    ELSE
      VRESULT := 'S';
    END IF;
    RETURN VRESULT;
  END;

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_APB(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TP'
         AND CI.NRSEQUENCIAL_ORIGEM = PNRRREGISTRO_TITULO
         AND CI.CDIDENTIFICADOR = PNRDOCUMENTO
         AND CI.CDIDENTIFICADOR NOT IN ('CA', 'RE');
    VACHOU BOOLEAN;
  BEGIN
    VACHOU := FALSE;
    FOR L_TITULO IN C_TITULO LOOP
      IF L_TITULO.CDSITUACAO = 'IT' THEN
        VACHOU := TRUE;
      ELSIF L_TITULO.CDSITUACAO IN ('GE', 'ER') THEN
        UPDATE TI_CONTROLE_INTEGRACAO TA
           SET TA.CDSITUACAO = 'CA', TA.TXOBSERVACAO = 'LINHA 250'
         WHERE TA.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
      ELSE
        BEGIN
          UPDATE TI_TIT_APB TA
             SET TA.CDSITUACAO = 'CA'
           WHERE TA.NRSEQ_CONTROLE_INTEGRACAO = L_TITULO.NRSEQUENCIAL;
        EXCEPTION
          WHEN OTHERS THEN
            VACHOU := TRUE;
            RAISE_APPLICATION_ERROR(-20101,
                                    'Erro ao cancelar a integrao da fatura ' ||
                                    PNRDOCUMENTO || ' ' || SQLERRM);
        END;
      END IF;
    END LOOP;
    IF VACHOU THEN
      VRESULT := 'N';
    ELSE
      VRESULT := 'S';
    END IF;
    RETURN VRESULT;
  END;

  FUNCTION F_PERMITE_ALTERAR_TIT_ACR(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
  BEGIN
    -- select DECODE(count(*),0,'S','N')
    SELECT CASE
             WHEN COUNT(*) < 1 THEN
              'S'
             ELSE
              'N'
           END
      INTO VRESULT
      FROM EMS_MOVIMENTO_TITULO_ACR EMS, EMS506UNICOO.TIT_ACR TTA --BRAZ 10/12
     WHERE EMS.NRDOCUMENTO = PNRDOCUMENTO
       AND EMS.NRREGISTRO_TITULO = PNRREGISTRO_TITULO
       AND EMS.NUM_ID_TIT_ACR = TTA.NUM_ID_TIT_ACR
       AND EMS.COD_ESTAB = TTA.U##COD_ESTAB
       AND EMS.IND_TRANS_ACR_ABREV = 'IMPL';
    -----------------------------
    RETURN VRESULT;
  END;

  FUNCTION F_PERMITE_ALTERAR_TIT_APB(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
  BEGIN
    SELECT DECODE(COUNT(*), 0, 'S', 'N')
      INTO VRESULT
      FROM TI_MOVTO_TIT_AP EMS, TIT_AP TTA
     WHERE EMS.NRDOCUMENTO = PNRDOCUMENTO
       AND EMS.NRREGISTRO_TITULO = PNRREGISTRO_TITULO
       AND EMS.NUM_ID_TIT_AP = TTA.NUM_ID_TIT_AP
       AND EMS.COD_ESTAB = TTA.U##COD_ESTAB
       AND EMS.IND_TRANS_AP_ABREV = 'IMPL';
    -----------------------------
    RETURN VRESULT;
  END;

  PROCEDURE P_INS_TI_CONTROLE_INTEGRACAO(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER) IS
    VSEQUENCIAL TI_CONTROLE_INTEGRACAO.NRSEQUENCIAL%TYPE;
  BEGIN
    IF NOT F_TI_PARAMETRO_INTEGRACAO('TP_INTEGRACAO_ONLINE_UNICOO_EMS5') LIKE
        '%' || PTPINTEGRACAO || '%' THEN
      RETURN;
    END IF;
    SELECT SQ_TI_CONTROLE_INTEGRACAO.NEXTVAL INTO VSEQUENCIAL FROM DUAL;
    INSERT INTO TI_CONTROLE_INTEGRACAO
      (NRSEQUENCIAL,
       TPINTEGRACAO,
       DTGERACAO,
       NRSEQUENCIAL_ORIGEM,
       DTPROCESSAMENTO,
       DTINTEGRACAO,
       CDACAO,
       CDIDENTIFICADOR,
       CDSITUACAO,
       CDEMPRESA,
       CDMODULO,
       NRSEQ_CONTROLE_INTEGRACAO_ORG)
    VALUES
      (VSEQUENCIAL,
       PTPINTEGRACAO,
       SYSDATE,
       PNRSEQUENCIAL_ORIGEM,
       NULL,
       NULL,
       PCDACAO,
       PCDIDENTIFICADOR,
       'GE',
       PCDEMPRESA,
       PCDMODULO,
       PNRSEQ_CONTROLE_INTEGRACAO_ORG);
  END;

  PROCEDURE P_INS_TI_CONTROLE_INTEGR_CAN(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER) IS
    VSEQUENCIAL TI_CONTROLE_INTEGRACAO.NRSEQUENCIAL%TYPE;
  BEGIN
    IF NOT F_TI_PARAMETRO_INTEGRACAO('TP_INTEGRACAO_ONLINE_UNICOO_EMS5') LIKE
        '%' || PTPINTEGRACAO || '%' THEN
      RETURN;
    END IF;
    SELECT SQ_TI_CONTROLE_INTEGRACAO.NEXTVAL INTO VSEQUENCIAL FROM DUAL;
    INSERT INTO TI_CONTROLE_INTEGRACAO
      (NRSEQUENCIAL,
       TPINTEGRACAO,
       DTGERACAO,
       NRSEQUENCIAL_ORIGEM,
       DTPROCESSAMENTO,
       DTINTEGRACAO,
       CDACAO,
       CDIDENTIFICADOR,
       CDSITUACAO,
       CDEMPRESA,
       CDMODULO,
       NRSEQ_CONTROLE_INTEGRACAO_ORG)
    VALUES
      (VSEQUENCIAL,
       PTPINTEGRACAO,
       SYSDATE,
       PNRSEQUENCIAL_ORIGEM,
       NULL,
       NULL,
       PCDACAO,
       PCDIDENTIFICADOR,
       'CA',
       PCDEMPRESA,
       PCDMODULO,
       PNRSEQ_CONTROLE_INTEGRACAO_ORG);
  END;

  /*PROCEDURE P_DEFINE_TI_PESSOA(PNRCGC_CPF              VARCHAR2,
                                 PNOPESSOA               VARCHAR2,
                                 PDTNASCIMENTO           DATE,
                                 PTPPESSOA               VARCHAR2,
                                 PNRREGISTRO             NUMBER,
                                 PTPORIGEM               VARCHAR2,
                                 PNOABREVIADO_FORNECEDOR IN OUT VARCHAR2,
                                 PCDN_FORNECEDOR         IN OUT VARCHAR2,
                                 PNOABREVIADO_CLIENTE    IN OUT VARCHAR2,
                                 PCDN_CLIENTE            IN OUT VARCHAR2,
                                 PAODEFINEPESSOA         VARCHAR2 -- < S/N>
                                 ) IS
      VNOM_ABREV_CLIENTE      TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
      VNOM_ABREV_FORNECEDOR   TI_PESSOA.NOABREVIADO_FORNECEDOR%TYPE;
      VNOABREVIADO_CLIENTE    TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
      VNOABREVIADO_FORNECEDOR TI_PESSOA.NOABREVIADO_FORNECEDOR%TYPE;
      VCDN_CLIENTE            TI_PESSOA.CDN_CLIENTE%TYPE;
      VCDN_FORNECEDOR         TI_PESSOA.CDN_FORNECEDOR%TYPE;
      VTI_PESSOA              TI_PESSOA%ROWTYPE;
      VTI_PESSOA_PAI          TI_PESSOA%ROWTYPE;
      VNOM_ABREVIADO          TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
      VCOUNT                  NUMBER;
      CNOM_ABREVIADO          TI_PESSOA.NOABREVIADO_CLIENTE%TYPE := 'p' ||
                                                                    PNRREGISTRO;
      --======================--
      -- Definir a Pessoa Pai --
      --------------------------
      PROCEDURE P_DEFINE_PESSOA_PAI IS
      BEGIN

      --============================================--
      --IMPLENTAÇÃO NOVA IGUAÇU DE/PARA REGISTRO PAI--
      --============================================--
        BEGIN
          SELECT TI.*
            INTO VTI_PESSOA
            FROM TI_PESSOA TI, TI_REGISTRO_PAI TRP
           WHERE TI.NRREGISTRO = TRP.NRREGISTRO_PAI
             AND TRP.NRREGISTRO_FILHO = PNRREGISTRO;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN

            IF PTPPESSOA = 'F' THEN
              BEGIN

                --============--
                -- CPF / NOME --
                ----------------
                SELECT TI.*
                  INTO VTI_PESSOA
                  FROM PESSOA PS, TI_PESSOA TI
                 WHERE TI.NRREGISTRO = PS.NRREGISTRO
                   AND PS.NRCGC_CPF = PNRCGC_CPF
                   AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
                   AND PS.TPPESSOA = PTPPESSOA
                   AND TI.NRREGISTRO_PAI IS NULL
                   AND ROWNUM = 1;
                VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CPF_PESSOA';
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  BEGIN
                    --==========================--
                    -- CPF / DATA DE NASCIMENTO --
                    ------------------------------
                    SELECT TI.*
                      INTO VTI_PESSOA
                      FROM PESSOA PS, TI_PESSOA TI
                     WHERE TI.NRREGISTRO = PS.NRREGISTRO
                       AND PS.NRCGC_CPF = PNRCGC_CPF
                       AND PS.DTNASCIMENTO = PDTNASCIMENTO
                       AND PS.TPPESSOA = PTPPESSOA
                       AND PS.DTNASCIMENTO IS NOT NULL
                       AND ROWNUM = 1;
                    VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CPF_DTNASCIMENTO';
                  EXCEPTION
                    WHEN NO_DATA_FOUND THEN
                      VTI_PESSOA := NULL;
                  END;
              END;
            ELSE
              BEGIN
                --======--
                -- CNPJ --
                ----------
                SELECT TI.*
                  INTO VTI_PESSOA
                  FROM PESSOA PS, TI_PESSOA TI
                 WHERE TI.NRREGISTRO = PS.NRREGISTRO
                   AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
                   AND PS.NRCGC_CPF = PNRCGC_CPF
                   AND PS.TPPESSOA = PTPPESSOA
                   AND TI.NRREGISTRO_PAI IS NULL
                   AND ROWNUM = 1;
                VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CNPJ';
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VTI_PESSOA := NULL;
              END;
            END IF;
        END;
      END; -- p_define_pessoa_pai
      --=======================--
      -- Busca Cliente no EMS5 --
      ---------------------------
      PROCEDURE P_BUSCA_CLIENTE_EMS IS
      BEGIN
        IF PTPPESSOA = 'F' THEN
          --=====================================--
          -- Verifica se o cliente pessoa fisica --
          -- existe no EMS5                      --
          -----------------------------------------
          BEGIN
            SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
              INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
              FROM CLIENTE CL, PESSOA_FISIC PF, TI_EMPRESA EMP
             WHERE PF.U##COD_ID_FEDER = PNRCGC_CPF
               AND PF.DAT_NASC_PESSOA_FISIC = PDTNASCIMENTO
               AND PF.NUM_PESSOA_FISIC = CL.NUM_PESSOA
               AND CL.COD_EMPRESA = EMP.COD_EMPRESA
               AND EMP.CDEMPRESA =
                   F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                SELECT DISTINCT CL.NOM_ABREV, CL.CDN_CLIENTE
                  INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
                  FROM CLIENTE CL, TI_EMPRESA EMP
                 WHERE CL.NOM_ABREV = VNOM_ABREVIADO
                   AND CL.COD_EMPRESA = EMP.COD_EMPRESA
                   AND EMP.CDEMPRESA =
                       F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VNOM_ABREV_CLIENTE := NULL;
                  VCDN_CLIENTE       := NULL;
              END;
          END;
        ELSE
          --======================================--
          -- Verifica se o cliente pessoa juridica --
          -- existe no EMS5                       --
          ------------------------------------------
          BEGIN
            SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
              INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
              FROM CLIENTE CL, PESSOA_JURID PJ, TI_EMPRESA EMP
             WHERE PJ.U##COD_ID_FEDER = PNRCGC_CPF
               AND PJ.NUM_PESSOA_JURID = CL.NUM_PESSOA
               AND CL.COD_EMPRESA = EMP.COD_EMPRESA
               AND EMP.CDEMPRESA =
                   F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
                  INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
                  FROM CLIENTE CL, TI_EMPRESA EMP
                 WHERE CL.NOM_ABREV = VNOM_ABREVIADO
                   AND CL.COD_EMPRESA = EMP.COD_EMPRESA
                   AND EMP.CDEMPRESA =
                       F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VNOM_ABREV_CLIENTE := NULL;
                  VCDN_CLIENTE       := NULL;
              END;
          END;
        END IF;
      END; -- Busca cliente ems5
      --=======================--
      -- Busca fornecedor no EMS5 --
      ---------------------------
      PROCEDURE P_BUSCA_FORNECEDOR_EMS IS
      BEGIN
        IF PTPPESSOA = 'F' THEN
          --=====================================--
          -- Verifica se o fornecedor pessoa fisica --
          -- existe no EMS5                      --
          -----------------------------------------
          BEGIN
            SELECT DISTINCT FN.NOM_ABREV, FN.CDN_FORNECEDOR
              INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
              FROM FORNECEDOR FN, PESSOA_FISIC PF, TI_EMPRESA EMP
             WHERE PF.U##COD_ID_FEDER = PNRCGC_CPF
               AND PF.DAT_NASC_PESSOA_FISIC = PDTNASCIMENTO
               AND PF.NUM_PESSOA_FISIC = FN.NUM_PESSOA
               AND FN.COD_EMPRESA = EMP.COD_EMPRESA
               AND EMP.CDEMPRESA =
                   F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                SELECT DISTINCT FN.NOM_ABREV, FN.CDN_FORNECEDOR
                  INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
                  FROM FORNECEDOR FN, TI_EMPRESA EMP
                 WHERE FN.NOM_ABREV = VNOM_ABREVIADO
                   AND FN.COD_EMPRESA = EMP.COD_EMPRESA
                   AND EMP.CDEMPRESA =
                       F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
                VNOM_ABREVIADO := CNOM_ABREVIADO;
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VNOM_ABREV_FORNECEDOR := NULL;
                  VCDN_FORNECEDOR       := NULL;
              END;
          END;
        ELSE
          --======================================--
          -- Verifica se o fornecedor pessoa juridica --
          -- existe no EMS5                       --
          ------------------------------------------
          BEGIN
            SELECT FN.NOM_ABREV, FN.CDN_FORNECEDOR
              INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
              FROM FORNECEDOR FN, PESSOA_JURID PJ, TI_EMPRESA EMP
             WHERE PJ.U##COD_ID_FEDER = PNRCGC_CPF
               AND PJ.NUM_PESSOA_JURID = FN.NUM_PESSOA
               AND FN.COD_EMPRESA = EMP.COD_EMPRESA
               AND EMP.CDEMPRESA =
                   F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                SELECT FN.NOM_ABREV, FN.CDN_FORNECEDOR
                  INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
                  FROM FORNECEDOR FN
                 WHERE FN.COD_EMPRESA =
                       F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')
                   AND FN.NOM_ABREV = VNOM_ABREVIADO;
                VNOM_ABREVIADO := CNOM_ABREVIADO;
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VNOM_ABREV_FORNECEDOR := NULL;
                  VCDN_FORNECEDOR       := NULL;
              END;
          END;
        END IF;
      END; -- Busca fornecedor ems5
      --==================--
      -- Define o cliente --
      ----------------------
      PROCEDURE P_DEFINE_CLIENTE IS
      BEGIN
        IF F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
           '%' || PNRCGC_CPF || '%' AND PNRCGC_CPF IS NOT NULL THEN
          --------------------------
          -- Definir a pessoa PAI --
          --------------------------
          P_DEFINE_PESSOA_PAI;
          IF VTI_PESSOA.NRREGISTRO IS NULL THEN
            BEGIN
              SELECT TI.*
                INTO VTI_PESSOA
                FROM TI_PESSOA TI
               WHERE TI.NOABREVIADO_CLIENTE = PNRCGC_CPF
                 AND TI.NRREGISTRO_PAI IS NULL
                 AND ROWNUM = 1;
              VNOM_ABREVIADO := CNOM_ABREVIADO;
              VTI_PESSOA     := NULL;
            EXCEPTION
              --======================================--
              -- Caso o CPF/CPNPJ no existir o nome  --
              -- abreviado ser o CPF/CNPJ            --
              ------------------------------------------
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA     := NULL;
                VNOM_ABREVIADO := PNRCGC_CPF;
            END;
          ELSE
            VNOM_ABREVIADO := PNRCGC_CPF;
  --          VTI_PESSOA     := NULL;
          END IF;
        ELSE
          VNOM_ABREVIADO := CNOM_ABREVIADO;
          VTI_PESSOA     := NULL;
        END IF;
        IF VTI_PESSOA_PAI.NRREGISTRO IS NULL THEN
          ----------------------------
          P_BUSCA_CLIENTE_EMS;
          ----------------------------
          IF VNOM_ABREV_CLIENTE IS NOT NULL THEN
            VNOM_ABREVIADO := VNOM_ABREV_CLIENTE;
          END IF;
          VTI_PESSOA_PAI := NULL;
          BEGIN
            SELECT PS.*
              INTO VTI_PESSOA_PAI
              FROM TI_PESSOA PS
             WHERE PS.NOABREVIADO_CLIENTE = SUBSTR(VNOM_ABREVIADO,0,12)
               AND NOT EXISTS (SELECT 1
                      FROM TI_PESSOA PST
                     WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA_PAI := NULL;
          END;
        ELSIF VTI_PESSOA.NRREGISTRO IS NOT NULL THEN
          SELECT PS.*
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_CLIENTE = SUBSTR(VNOM_ABREVIADO,0,12)
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        END IF;
      END; -- fim p_define_cliente
      --==================--
      -- Define o fornecedor --
      ----------------------
      PROCEDURE P_DEFINE_FORNECEDOR IS
      BEGIN
        IF F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
           '%' || PNRCGC_CPF || '%' AND PNRCGC_CPF IS NOT NULL THEN
          --------------------------
          -- Definir a pessoa PAI --
          --------------------------
          P_DEFINE_PESSOA_PAI;
          IF VTI_PESSOA.NRREGISTRO IS NULL THEN
            BEGIN
              SELECT TI.*
                INTO VTI_PESSOA
                FROM TI_PESSOA TI
               WHERE TI.NOABREVIADO_FORNECEDOR = PNRCGC_CPF
                 AND TI.NRREGISTRO_PAI IS NULL
                 AND ROWNUM = 1;
              VNOM_ABREVIADO := CNOM_ABREVIADO;
              VTI_PESSOA     := NULL;
            EXCEPTION
              --======================================--
              -- Caso o CPF/CPNPJ no existir o nome  --
              -- abreviado ser o CPF/CNPJ            --
              ------------------------------------------
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA     := NULL;
                VNOM_ABREVIADO := PNRCGC_CPF;
            END;
          ELSE
            VNOM_ABREVIADO := PNRCGC_CPF;
            VTI_PESSOA     := NULL;
          END IF;
        ELSE
          VNOM_ABREVIADO := CNOM_ABREVIADO;
          VTI_PESSOA     := NULL;
        END IF;
        IF VTI_PESSOA_PAI.NRREGISTRO IS NULL THEN
          -----------------------
          P_BUSCA_FORNECEDOR_EMS;
          -----------------------
          IF VNOM_ABREV_FORNECEDOR IS NOT NULL THEN
            VNOM_ABREVIADO := VNOM_ABREV_FORNECEDOR;
          END IF;
          VTI_PESSOA_PAI := NULL;
          BEGIN
            SELECT PS.*
              INTO VTI_PESSOA_PAI
              FROM TI_PESSOA PS
             WHERE PS.NOABREVIADO_FORNECEDOR = VNOM_ABREVIADO
               AND NOT EXISTS (SELECT 1
                      FROM TI_PESSOA PST
                     WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA_PAI := NULL;
          END;
        ELSIF VTI_PESSOA.NRREGISTRO IS NOT NULL THEN
          SELECT PS.*
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_FORNECEDOR = VNOM_ABREVIADO
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        END IF;
      END; -- fim p_define_fornecedor
      --inicia aqui
    BEGIN
      VTI_PESSOA     := NULL;
      VTI_PESSOA_PAI := NULL;
      SELECT COUNT(*)
        INTO VCOUNT
        FROM TI_PESSOA P
       WHERE P.NRREGISTRO = PNRREGISTRO;
      IF VCOUNT = 0 THEN
        IF PAODEFINEPESSOA = 'S' THEN
          IF NOT F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
              '%' || PNRCGC_CPF || '%' THEN
            VNOABREVIADO_CLIENTE    := CNOM_ABREVIADO;
            VNOABREVIADO_FORNECEDOR := CNOM_ABREVIADO;
            VCDN_FORNECEDOR         := NULL;
            VCDN_CLIENTE            := NULL;
          ELSE
            IF PTPORIGEM = 'CLIENTE' THEN
              ---------------------------
              P_DEFINE_CLIENTE;
              ---------------------------
              --========================--
              -- Se for uma pessoa nova --
              ----------------------------
              IF VTI_PESSOA.NRREGISTRO IS NULL THEN
                ----------------------------
                -- Nome abreviado cliente --
                ----------------------------
                IF VCDN_CLIENTE IS NOT NULL THEN
                  VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                  VNOABREVIADO_CLIENTE   := VNOM_ABREV_CLIENTE;
                ELSE
                  VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                  VNOABREVIADO_CLIENTE   := VNOM_ABREVIADO;
                END IF;
                ------------------------------
                -- Verifica se  fornecedor --
                ------------------------------
                P_BUSCA_FORNECEDOR_EMS;
                -------------------------------
                -- Nome abreviado fornecedor --
                -------------------------------
                IF VCDN_FORNECEDOR IS NOT NULL THEN
                  VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                  VNOABREVIADO_FORNECEDOR   := VNOM_ABREV_FORNECEDOR;
                ELSE
                  VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                  VNOABREVIADO_FORNECEDOR   := VNOM_ABREVIADO;
                END IF;
              END IF;
            ELSE
              -------------------------------
              P_DEFINE_FORNECEDOR;
              -------------------------------
              --========================--
              -- Se for uma pessoa nova --
              ----------------------------
              IF VTI_PESSOA.NRREGISTRO IS NULL THEN
                -------------------------------
                -- Nome abreviado fornecedor --
                -------------------------------
                IF VCDN_FORNECEDOR IS NOT NULL THEN
                  VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                  VNOABREVIADO_FORNECEDOR   := VNOM_ABREV_FORNECEDOR;
                ELSE
                  VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                  VNOABREVIADO_FORNECEDOR   := VNOM_ABREVIADO;
                END IF;
                ------------------------------
                -- verifica se  cliente --
                ------------------------------
                P_BUSCA_CLIENTE_EMS;
                ----------------------------
                -- nome abreviado cliente --
                ----------------------------
                IF VCDN_CLIENTE IS NOT NULL THEN
                  VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                  VNOABREVIADO_CLIENTE   := VNOM_ABREV_CLIENTE;
                ELSE
                  VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                  VNOABREVIADO_CLIENTE   := VNOM_ABREVIADO;
                END IF;
              END IF;
            END IF;
          END IF;
        ELSE
          BEGIN
            SELECT *
              INTO VTI_PESSOA_PAI
              FROM TI_PESSOA PS
             WHERE PS.NOABREVIADO_CLIENTE = PNOABREVIADO_CLIENTE
               AND NOT EXISTS (SELECT 1
                      FROM TI_PESSOA PST
                     WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
               AND ROWNUM = 1;
          EXCEPTION
            WHEN OTHERS THEN
              BEGIN
                SELECT *
                  INTO VTI_PESSOA_PAI
                  FROM TI_PESSOA PS
                 WHERE PS.NOABREVIADO_FORNECEDOR = PNOABREVIADO_FORNECEDOR
                   AND NOT EXISTS
                 (SELECT 1
                          FROM TI_PESSOA PST
                         WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
                   AND ROWNUM = 1;
              EXCEPTION
                WHEN OTHERS THEN
                  VTI_PESSOA_PAI := NULL;
              END;
          END;
        END IF;
        IF VTI_PESSOA.NRREGISTRO IS NULL THEN
          VTI_PESSOA.NRREGISTRO             := PNRREGISTRO;
          VTI_PESSOA.NOABREVIADO_CLIENTE    := VNOABREVIADO_CLIENTE;
          VTI_PESSOA.NOABREVIADO_FORNECEDOR := VNOABREVIADO_FORNECEDOR;
          VTI_PESSOA.CDN_FORNECEDOR         := VCDN_FORNECEDOR;
          VTI_PESSOA.CDN_CLIENTE            := VCDN_CLIENTE;
          VTI_PESSOA.NRREGISTRO_PAI         := NULL;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO    := NULL;
          VTI_PESSOA.NOPESSOA               := PNOPESSOA;
          VTI_PESSOA.DTNASCIMENTO           := PDTNASCIMENTO;
          VTI_PESSOA.NRCGC_CPF              := PNRCGC_CPF;
          VTI_PESSOA.NRREGISTRO_PAI         := VTI_PESSOA_PAI.NRREGISTRO;
        ELSE
          VTI_PESSOA.NRREGISTRO_PAI := VTI_PESSOA_PAI.NRREGISTRO;
          VTI_PESSOA.NRREGISTRO     := PNRREGISTRO;
          VTI_PESSOA.NOPESSOA       := PNOPESSOA;
          VTI_PESSOA.DTNASCIMENTO   := PDTNASCIMENTO;
          VTI_PESSOA.NRCGC_CPF      := PNRCGC_CPF;
        END IF;

        IF F_TI_PARAMETRO_INTEGRACAO('INTR_EMS2') = 'S' THEN
          VTI_PESSOA.NOABREVIADO_CLIENTE    := SUBSTR(VTI_PESSOA.NOABREVIADO_CLIENTE,
                                                      0,
                                                      12);
          VTI_PESSOA.NOABREVIADO_FORNECEDOR := SUBSTR(VTI_PESSOA.NOABREVIADO_FORNECEDOR,
                                                      0,
                                                      12);
        END IF;

  BEGIN

        BEGIN
          SELECT NRREGISTRO INTO VTI_PESSOA.NRREGISTRO_PAI  FROM TI_PESSOA TP WHERE
          TP.NOABREVIADO_CLIENTE = VTI_PESSOA.NOABREVIADO_CLIENTE
          AND TP.NOABREVIADO_FORNECEDOR    = VTI_PESSOA.NOABREVIADO_FORNECEDOR
          AND ROWNUM =1;

          EXCEPTION WHEN NO_DATA_FOUND THEN
          VTI_PESSOA.NRREGISTRO_PAI:= NULL;
  END;
        INSERT INTO TI_PESSOA
          (NRREGISTRO,
           NOABREVIADO_CLIENTE,
           NOABREVIADO_FORNECEDOR,
           CDN_FORNECEDOR,
           CDN_CLIENTE,
           NRREGISTRO_PAI,
           TXREGRA_AGRUPAMENTO,
           NOPESSOA,
           DTNASCIMENTO,
           NRCGC_CPF,
           DTGERACAO,
           DTULTIMA_ATUALIZACAO)
        VALUES
          (VTI_PESSOA.NRREGISTRO,
           VTI_PESSOA.NOABREVIADO_CLIENTE,
           VTI_PESSOA.NOABREVIADO_FORNECEDOR,
           VTI_PESSOA.CDN_FORNECEDOR,
           VTI_PESSOA.CDN_CLIENTE,
           VTI_PESSOA.NRREGISTRO_PAI,
           VTI_PESSOA.TXREGRA_AGRUPAMENTO,
           VTI_PESSOA.NOPESSOA,
           VTI_PESSOA.DTNASCIMENTO,
           VTI_PESSOA.NRCGC_CPF,
           SYSDATE,
           SYSDATE);


        PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
        PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
        PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
        PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;

  EXCEPTION WHEN DUP_VAL_ON_INDEX THEN
    INSERT INTO TI_PESSOA
          (NRREGISTRO,
           NOABREVIADO_CLIENTE,
           NOABREVIADO_FORNECEDOR,
           CDN_FORNECEDOR,
           CDN_CLIENTE,
           NRREGISTRO_PAI,
           TXREGRA_AGRUPAMENTO,
           NOPESSOA,
           DTNASCIMENTO,
           NRCGC_CPF,
           DTGERACAO,
           DTULTIMA_ATUALIZACAO)
        VALUES
          (VTI_PESSOA.NRREGISTRO,
           'p'||VTI_PESSOA.NRREGISTRO,
           'p'||VTI_PESSOA.NRREGISTRO,
           VTI_PESSOA.CDN_FORNECEDOR,
           VTI_PESSOA.CDN_CLIENTE,
           VTI_PESSOA.NRREGISTRO_PAI,
           VTI_PESSOA.TXREGRA_AGRUPAMENTO,
           VTI_PESSOA.NOPESSOA,
           VTI_PESSOA.DTNASCIMENTO,
           VTI_PESSOA.NRCGC_CPF,
           SYSDATE,
           SYSDATE);

    END;



      ELSE
        SELECT *
          INTO VTI_PESSOA
          FROM TI_PESSOA
         WHERE NRREGISTRO = PNRREGISTRO;
        PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
        PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
        PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
        PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;
      END IF;
    END;*/

  PROCEDURE P_DEFINE_TI_PESSOA(PNRCGC_CPF              VARCHAR2,
                               PNOPESSOA               VARCHAR2,
                               PDTNASCIMENTO           DATE,
                               PTPPESSOA               VARCHAR2,
                               PNRREGISTRO             NUMBER,
                               PTPORIGEM               VARCHAR2,
                               PNOABREVIADO_FORNECEDOR IN OUT VARCHAR2,
                               PCDN_FORNECEDOR         IN OUT VARCHAR2,
                               PNOABREVIADO_CLIENTE    IN OUT VARCHAR2,
                               PCDN_CLIENTE            IN OUT VARCHAR2,
                               PAODEFINEPESSOA         VARCHAR2 -- < S/N>
                               ) IS
    VTI_PESSOA       TI_PESSOA%ROWTYPE;
    VTI_PESSOA_PAI   TI_PESSOA%ROWTYPE;
    VCOUNT           NUMBER;
    VEXISTE_PESSOA   CHAR;
    VEXISTE_REGISTRO CHAR;
    CNOM_ABREVIADO   TI_PESSOA.NOABREVIADO_CLIENTE%TYPE := 'p' ||
                                                           PNRREGISTRO;
    VCOD_EMS         NUMBER := 1000;
    VCOD_EMS_AUX     NUMBER := 0;
    VEXISTE_COD      CHAR;
    vaoexiste_nome   char;
    vnom_abrev       varchar2(12);
    qttamanho        number;
    vnum_aux         number := 0;
    vcount           number;

    FUNCTION F_TESTA_NOME(PNOME_ABREV TI_PESSOA.NOABREVIADO_CLIENTE%TYPE)
      RETURN CHAR IS

      VEXISTE_NOME CHAR;

    BEGIN
      BEGIN
        SELECT 'S'
          INTO VEXISTE_NOME
          FROM TI_PESSOA P
         WHERE P.NOABREVIADO_CLIENTE = PNOME_ABREV
         AND ROWNUM = 1;
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          VEXISTE_NOME := 'N';
      END;

      RETURN VEXISTE_NOME;

    END;
    --======================--
    -- Definir a Pessoa Pai --
    --------------------------
    PROCEDURE P_DEFINE_PESSOA_PAI IS
    BEGIN
      IF PTPPESSOA = 'F' THEN
        BEGIN
          --============--
          -- CPF / NOME --
          ----------------
          SELECT TI.*
            INTO VTI_PESSOA_PAI
            FROM PESSOA PS, TI_PESSOA TI
           WHERE TI.NRREGISTRO = PS.NRREGISTRO
             AND PS.NRCGC_CPF = PNRCGC_CPF
             AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
             AND PS.TPPESSOA = PTPPESSOA
             AND TI.NRREGISTRO_PAI IS NULL
             AND ROWNUM = 1
           ORDER BY TI.NRREGISTRO DESC;
          VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO := 'CPF_PESSOA';
        EXCEPTION
          WHEN NO_DATA_FOUND THEN

        IF PCPF_DTNASCIMENTO = 'S' THEN
            BEGIN
              --==========================--
              -- CPF / DATA DE NASCIMENTO --
              ------------------------------
              SELECT TI.*
                INTO VTI_PESSOA_PAI
                FROM PESSOA PS, TI_PESSOA TI
               WHERE TI.NRREGISTRO = PS.NRREGISTRO
                 AND PS.NRCGC_CPF = PNRCGC_CPF
                 AND PS.DTNASCIMENTO = PDTNASCIMENTO
                 AND PS.TPPESSOA = PTPPESSOA
                 AND PS.DTNASCIMENTO IS NOT NULL
                 AND ROWNUM = 1
               ORDER BY TI.NRREGISTRO DESC;
              VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO := 'CPF_DTNASCIMENTO';
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA_PAI := NULL;
            END;
      ELSE
        VTI_PESSOA_PAI := NULL;
       END IF;
        END;
      ELSE
        BEGIN
          --======--
          -- CNPJ --
          ----------
          SELECT TI.*
            INTO VTI_PESSOA_PAI
            FROM PESSOA PS, TI_PESSOA TI
           WHERE TI.NRREGISTRO = PS.NRREGISTRO
             AND PS.NRCGC_CPF = PNRCGC_CPF
             AND PS.TPPESSOA = PTPPESSOA
             AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
             AND TI.NRREGISTRO_PAI IS NULL
             AND ROWNUM = 1
           ORDER BY TI.NRREGISTRO DESC;
          VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO := 'CNPJ';
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            VTI_PESSOA_PAI := NULL;
        END;
      END IF;
    END P_DEFINE_PESSOA_PAI; -- p_define_pessoa_pai

  BEGIN

    VTI_PESSOA_PAI := NULL;
    VEXISTE_COD    := 'N';

    BEGIN
      SELECT 'S'
        INTO VEXISTE_REGISTRO
        FROM TI_PESSOA T
       WHERE T.NRREGISTRO = PNRREGISTRO;
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        VEXISTE_REGISTRO := 'N';
    END;

    IF VEXISTE_REGISTRO = 'N' THEN

      BEGIN
        SELECT 'S'
          INTO VEXISTE_PESSOA
          FROM TI_PESSOA TP
         WHERE TP.NRCGC_CPF = PNRCGC_CPF
           AND ROWNUM = 1;
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          VEXISTE_PESSOA := 'N';
      END;


    --SE NAO EXISTE NINGUEM COM ESTE CPF/CNPJ INSERE NA TABELA TI_PESSOA
      IF VEXISTE_PESSOA = 'N' THEN

        VTI_PESSOA.NRREGISTRO          := PNRREGISTRO;
        VTI_PESSOA.NRREGISTRO_PAI      := NULL;
        VTI_PESSOA.TXREGRA_AGRUPAMENTO := NULL;
        VTI_PESSOA.NOPESSOA            := PNOPESSOA;
        VTI_PESSOA.DTNASCIMENTO        := PDTNASCIMENTO;
        VTI_PESSOA.NRCGC_CPF           := PNRCGC_CPF;

        --VINICIUS 30/08 NOVA DEFINICAO PARA NOME ABREVIADO NO EMS5
        vnom_abrev := trim(F_ABREVIA_NOME(VTI_PESSOA.NOPESSOA, 12, 'PEA'));

        vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

        WHILE vaoexiste_nome = 'S' LOOP

          vnum_aux := vnum_aux + 1;

          qttamanho := length(vnum_aux);

          vnom_abrev := substr(vnom_abrev, 0, (12 - qttamanho)) || vnum_aux;

          vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

        END LOOP;

        VTI_PESSOA.NOABREVIADO_CLIENTE := vnom_abrev;

        VTI_PESSOA.NOABREVIADO_FORNECEDOR := vnom_abrev;

        /* VTI_PESSOA.NOABREVIADO_CLIENTE := CASE
                                              WHEN f_ti_parametro_integracao('INTR_EMS2') = 'S' THEN
                                               SUBSTR(PNRCGC_CPF, 0, 12)
                                              ELSE
                                               PNRCGC_CPF
                                            END;

          VTI_PESSOA.NOABREVIADO_FORNECEDOR := CASE
                                                 WHEN f_ti_parametro_integracao('INTR_EMS2') = 'S' THEN
                                                  SUBSTR(PNRCGC_CPF, 0, 12)
                                                 ELSE
                                                  PNRCGC_CPF
                                               END;
        */


      --SE A ORIGEM FOR "UNIMED" NAO PREENCHE O CODIGO CLIENTE / FORNECEDOR
        IF PTPORIGEM = 'UNIMED' THEN
          VTI_PESSOA.CDN_FORNECEDOR := NULL;
          VTI_PESSOA.CDN_CLIENTE    := NULL;
        ELSE

        --SE A ORIGEM FOR FOR "UNIMED" PREENCHE O CODIGO CLIENTE / FORNECEDOR
          BEGIN
            SELECT 'S'
              INTO VEXISTE_COD
              FROM TI_PESSOA TP
             WHERE NVL(TP.CDN_CLIENTE, 0) >= VCOD_EMS
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS;
              VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS;
          END;

          IF VEXISTE_COD = 'S' THEN
            BEGIN
              SELECT MAX(CDN_CLIENTE) + 1 INTO VCOD_EMS_AUX FROM TI_PESSOA;
            END;
            VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS_AUX;
            VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS_AUX;

          END IF;

        END IF;

        INSERT INTO TI_PESSOA
          (NRREGISTRO,
           NOABREVIADO_CLIENTE,
           NOABREVIADO_FORNECEDOR,
           CDN_FORNECEDOR,
           CDN_CLIENTE,
           NRREGISTRO_PAI,
           TXREGRA_AGRUPAMENTO,
           NOPESSOA,
           DTNASCIMENTO,
           NRCGC_CPF,
           DTGERACAO,
           DTULTIMA_ATUALIZACAO)
        VALUES
          (VTI_PESSOA.NRREGISTRO,
           VTI_PESSOA.NOABREVIADO_CLIENTE,
           VTI_PESSOA.NOABREVIADO_FORNECEDOR,
           VTI_PESSOA.CDN_FORNECEDOR,
           VTI_PESSOA.CDN_CLIENTE,
           VTI_PESSOA.NRREGISTRO_PAI,
           VTI_PESSOA.TXREGRA_AGRUPAMENTO,
           VTI_PESSOA.NOPESSOA,
           VTI_PESSOA.DTNASCIMENTO,
           VTI_PESSOA.NRCGC_CPF,
           SYSDATE,
           SYSDATE);
        PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
        PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
        PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
        PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;

      ELSE

      --SE ACHOU UM CPF/CPNJ PROCURA O REGISTRO PAI
        P_DEFINE_PESSOA_PAI;



      --SE ENCONTROU FAZ OS VINCULOS
        IF VTI_PESSOA_PAI.NRREGISTRO IS NOT NULL THEN

          VTI_PESSOA.NRREGISTRO             := PNRREGISTRO;
          VTI_PESSOA.NOABREVIADO_CLIENTE    := VTI_PESSOA_PAI.NOABREVIADO_CLIENTE;
          VTI_PESSOA.NOABREVIADO_FORNECEDOR := VTI_PESSOA_PAI.NOABREVIADO_FORNECEDOR;
          VTI_PESSOA.CDN_FORNECEDOR         := VTI_PESSOA_PAI.CDN_FORNECEDOR;
          VTI_PESSOA.CDN_CLIENTE            := VTI_PESSOA_PAI.CDN_CLIENTE;
          VTI_PESSOA.NRREGISTRO_PAI         := VTI_PESSOA_PAI.NRREGISTRO;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO    := VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO;
          VTI_PESSOA.NOPESSOA               := PNOPESSOA;
          VTI_PESSOA.DTNASCIMENTO           := PDTNASCIMENTO;
          VTI_PESSOA.NRCGC_CPF              := PNRCGC_CPF;

          INSERT INTO TI_PESSOA
            (NRREGISTRO,
             NOABREVIADO_CLIENTE,
             NOABREVIADO_FORNECEDOR,
             CDN_FORNECEDOR,
             CDN_CLIENTE,
             NRREGISTRO_PAI,
             TXREGRA_AGRUPAMENTO,
             NOPESSOA,
             DTNASCIMENTO,
             NRCGC_CPF,
             DTGERACAO,
             DTULTIMA_ATUALIZACAO)
          VALUES
            (VTI_PESSOA.NRREGISTRO,
             VTI_PESSOA.NOABREVIADO_CLIENTE,
             VTI_PESSOA.NOABREVIADO_FORNECEDOR,
             VTI_PESSOA.CDN_FORNECEDOR,
             VTI_PESSOA.CDN_CLIENTE,
             VTI_PESSOA.NRREGISTRO_PAI,
             VTI_PESSOA.TXREGRA_AGRUPAMENTO,
             VTI_PESSOA.NOPESSOA,
             VTI_PESSOA.DTNASCIMENTO,
             VTI_PESSOA.NRCGC_CPF,
             SYSDATE,
             SYSDATE);
          PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
          PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
          PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
          PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;


        --SE NAO ENCONTROU INSERE PESSOA COM CPF/CNPJ REPETIDO, MAS ALTERANDO O NOME ABREVIADO
        ELSE

      VTI_PESSOA.NRREGISTRO             := PNRREGISTRO;
          VTI_PESSOA.NRREGISTRO_PAI         := NULL;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO    := NULL;
          VTI_PESSOA.NOPESSOA               := PNOPESSOA;
          VTI_PESSOA.DTNASCIMENTO           := PDTNASCIMENTO;
          VTI_PESSOA.NRCGC_CPF              := PNRCGC_CPF;



            --VINICIUS 30/08 NOVA DEFINICAO PARA NOME ABREVIADO NO EMS5
        vnom_abrev := trim(F_ABREVIA_NOME(VTI_PESSOA.NOPESSOA, 12, 'PEA'));

        vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

        WHILE vaoexiste_nome = 'S' LOOP

          vnum_aux := vnum_aux + 1;

          qttamanho := length(vnum_aux);

          vnom_abrev := substr(vnom_abrev, 0, (12 - qttamanho)) || vnum_aux;

          vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

        END LOOP;

        VTI_PESSOA.NOABREVIADO_CLIENTE := vnom_abrev;

        VTI_PESSOA.NOABREVIADO_FORNECEDOR := vnom_abrev;

          IF PTPORIGEM = 'UNIMED' THEN
            VTI_PESSOA.CDN_FORNECEDOR := NULL;
            VTI_PESSOA.CDN_CLIENTE    := NULL;
          ELSE

            BEGIN
              SELECT 'S'
                INTO VEXISTE_COD
                FROM TI_PESSOA TP
               WHERE NVL(TP.CDN_CLIENTE, 0) >= VCOD_EMS
                 AND ROWNUM = 1;
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS;
                VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS;
            END;

            IF VEXISTE_COD = 'S' THEN
              BEGIN
                SELECT MAX(CDN_CLIENTE) + 1
                  INTO VCOD_EMS_AUX
                  FROM TI_PESSOA;
              END;
              VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS_AUX;
              VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS_AUX;

            END IF;

          END IF;

          INSERT INTO TI_PESSOA
            (NRREGISTRO,
             NOABREVIADO_CLIENTE,
             NOABREVIADO_FORNECEDOR,
             CDN_FORNECEDOR,
             CDN_CLIENTE,
             NRREGISTRO_PAI,
             TXREGRA_AGRUPAMENTO,
             NOPESSOA,
             DTNASCIMENTO,
             NRCGC_CPF,
             DTGERACAO,
             DTULTIMA_ATUALIZACAO)
          VALUES
            (VTI_PESSOA.NRREGISTRO,
             VTI_PESSOA.NOABREVIADO_CLIENTE,
             VTI_PESSOA.NOABREVIADO_FORNECEDOR,
             VTI_PESSOA.CDN_FORNECEDOR,
             VTI_PESSOA.CDN_CLIENTE,
             VTI_PESSOA.NRREGISTRO_PAI,
             VTI_PESSOA.TXREGRA_AGRUPAMENTO,
             VTI_PESSOA.NOPESSOA,
             VTI_PESSOA.DTNASCIMENTO,
             VTI_PESSOA.NRCGC_CPF,
             SYSDATE,
             SYSDATE);
          PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
          PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
          PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
          PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;

        END IF;

      END IF;
    ELSE
      --NAO FAZ NADA

      NULL;

    END IF;

  END P_DEFINE_TI_PESSOA;

  PROCEDURE P_DEFINE_TI_PESSOA_OLD(PNRCGC_CPF              VARCHAR2,
                                   PNOPESSOA               VARCHAR2,
                                   PDTNASCIMENTO           DATE,
                                   PTPPESSOA               VARCHAR2,
                                   PNRREGISTRO             NUMBER,
                                   PTPORIGEM               VARCHAR2,
                                   PNOABREVIADO_FORNECEDOR IN OUT VARCHAR2,
                                   PCDN_FORNECEDOR         IN OUT VARCHAR2,
                                   PNOABREVIADO_CLIENTE    IN OUT VARCHAR2,
                                   PCDN_CLIENTE            IN OUT VARCHAR2,
                                   PAODEFINEPESSOA         VARCHAR2 -- < S/N>
                                   ) IS
    VNOM_ABREV_CLIENTE      TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
    VNOM_ABREV_FORNECEDOR   TI_PESSOA.NOABREVIADO_FORNECEDOR%TYPE;
    VNOABREVIADO_CLIENTE    TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
    VNOABREVIADO_FORNECEDOR TI_PESSOA.NOABREVIADO_FORNECEDOR%TYPE;
    VCDN_CLIENTE            TI_PESSOA.CDN_CLIENTE%TYPE;
    VCDN_FORNECEDOR         TI_PESSOA.CDN_FORNECEDOR%TYPE;
    VTI_PESSOA              TI_PESSOA%ROWTYPE;
    VTI_PESSOA_PAI          TI_PESSOA%ROWTYPE;
    VNOM_ABREVIADO          TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
    VCOUNT                  NUMBER;
    CNOM_ABREVIADO          TI_PESSOA.NOABREVIADO_CLIENTE%TYPE := 'p' ||
                                                                  PNRREGISTRO;
    --======================--
    -- Definir a Pessoa Pai --
    --------------------------
    PROCEDURE P_DEFINE_PESSOA_PAI IS
    BEGIN
      IF PTPPESSOA = 'F' THEN
        BEGIN
          --============--
          -- CPF / NOME --
          ----------------
          SELECT TI.*
            INTO VTI_PESSOA
            FROM PESSOA PS, TI_PESSOA TI
           WHERE TI.NRREGISTRO = PS.NRREGISTRO
             AND PS.NRCGC_CPF = PNRCGC_CPF
             AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
             AND PS.TPPESSOA = PTPPESSOA
             AND TI.NRREGISTRO_PAI IS NULL
             AND ROWNUM = 1
           ORDER BY TI.ROWID DESC;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CPF_PESSOA';
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              --==========================--
              -- CPF / DATA DE NASCIMENTO --
              ------------------------------
              SELECT TI.*
                INTO VTI_PESSOA
                FROM PESSOA PS, TI_PESSOA TI
               WHERE TI.NRREGISTRO = PS.NRREGISTRO
                 AND PS.NRCGC_CPF = PNRCGC_CPF
                 AND PS.DTNASCIMENTO = PDTNASCIMENTO
                 AND PS.TPPESSOA = PTPPESSOA
                 AND PS.DTNASCIMENTO IS NOT NULL
                 AND ROWNUM = 1
               ORDER BY TI.ROWID DESC;
              VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CPF_DTNASCIMENTO';
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA := NULL;
            END;
        END;
      ELSE
        BEGIN
          --======--
          -- CNPJ --
          ----------
          SELECT TI.*
            INTO VTI_PESSOA
            FROM PESSOA PS, TI_PESSOA TI
           WHERE TI.NRREGISTRO = PS.NRREGISTRO
             AND PS.NRCGC_CPF = PNRCGC_CPF
             AND PS.TPPESSOA = PTPPESSOA
             AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
             AND TI.NRREGISTRO_PAI IS NULL
             AND ROWNUM = 1
           ORDER BY TI.ROWID DESC;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CNPJ';
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            VTI_PESSOA := NULL;
        END;
      END IF;
    END; -- p_define_pessoa_pai
    --=======================--
    -- Busca Cliente no EMS5 --
    ---------------------------
    PROCEDURE P_BUSCA_CLIENTE_EMS IS
    BEGIN
      IF PTPPESSOA = 'F' THEN
        --=====================================--
        -- Verifica se o cliente pessoa fisica --
        -- existe no EMS5                      --
        -----------------------------------------
        BEGIN
          SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
            INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
            FROM CLIENTE CL, PESSOA_FISIC PF, TI_EMPRESA EMP
           WHERE PF.U##COD_ID_FEDER = PNRCGC_CPF
             AND PF.DAT_NASC_PESSOA_FISIC = PDTNASCIMENTO
             AND PF.NUM_PESSOA_FISIC = CL.NUM_PESSOA
             AND CL.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              SELECT DISTINCT CL.NOM_ABREV, CL.CDN_CLIENTE
                INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
                FROM CLIENTE CL, TI_EMPRESA EMP
               WHERE CL.NOM_ABREV = VNOM_ABREVIADO
                 AND CL.COD_EMPRESA = EMP.COD_EMPRESA
                 AND EMP.CDEMPRESA =
                     F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VNOM_ABREV_CLIENTE := NULL;
                VCDN_CLIENTE       := NULL;
            END;
        END;
      ELSE
        --======================================--
        -- Verifica se o cliente pessoa juridica --
        -- existe no EMS5                       --
        ------------------------------------------
        BEGIN
          SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
            INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
            FROM CLIENTE CL, PESSOA_JURID PJ, TI_EMPRESA EMP
           WHERE PJ.U##COD_ID_FEDER = PNRCGC_CPF
             AND PJ.NUM_PESSOA_JURID = CL.NUM_PESSOA
             AND CL.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
                INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
                FROM CLIENTE CL, TI_EMPRESA EMP
               WHERE CL.NOM_ABREV = VNOM_ABREVIADO
                 AND CL.COD_EMPRESA = EMP.COD_EMPRESA
                 AND EMP.CDEMPRESA =
                     F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VNOM_ABREV_CLIENTE := NULL;
                VCDN_CLIENTE       := NULL;
            END;
        END;
      END IF;
    END; -- Busca cliente ems5
    --=======================--
    -- Busca fornecedor no EMS5 --
    ---------------------------
    PROCEDURE P_BUSCA_FORNECEDOR_EMS IS
    BEGIN
      IF PTPPESSOA = 'F' THEN
        --=====================================--
        -- Verifica se o fornecedor pessoa fisica --
        -- existe no EMS5                      --
        -----------------------------------------
        BEGIN
          SELECT DISTINCT FN.NOM_ABREV, FN.CDN_FORNECEDOR
            INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
            FROM FORNECEDOR FN, PESSOA_FISIC PF, TI_EMPRESA EMP
           WHERE PF.U##COD_ID_FEDER = PNRCGC_CPF
             AND PF.DAT_NASC_PESSOA_FISIC = PDTNASCIMENTO
             AND PF.NUM_PESSOA_FISIC = FN.NUM_PESSOA
             AND FN.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              SELECT DISTINCT FN.NOM_ABREV, FN.CDN_FORNECEDOR
                INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
                FROM FORNECEDOR FN, TI_EMPRESA EMP
               WHERE FN.NOM_ABREV = VNOM_ABREVIADO
                 AND FN.COD_EMPRESA = EMP.COD_EMPRESA
                 AND EMP.CDEMPRESA =
                     F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
              VNOM_ABREVIADO := CNOM_ABREVIADO;
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VNOM_ABREV_FORNECEDOR := NULL;
                VCDN_FORNECEDOR       := NULL;
            END;
        END;
      ELSE
        --======================================--
        -- Verifica se o fornecedor pessoa juridica --
        -- existe no EMS5                       --
        ------------------------------------------
        BEGIN
          SELECT FN.NOM_ABREV, FN.CDN_FORNECEDOR
            INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
            FROM FORNECEDOR FN, PESSOA_JURID PJ, TI_EMPRESA EMP
           WHERE PJ.U##COD_ID_FEDER = PNRCGC_CPF
             AND PJ.NUM_PESSOA_JURID = FN.NUM_PESSOA
             AND FN.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              SELECT FN.NOM_ABREV, FN.CDN_FORNECEDOR
                INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
                FROM FORNECEDOR FN
               WHERE FN.COD_EMPRESA =
                     F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')
                 AND FN.NOM_ABREV = VNOM_ABREVIADO;
              VNOM_ABREVIADO := CNOM_ABREVIADO;
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VNOM_ABREV_FORNECEDOR := NULL;
                VCDN_FORNECEDOR       := NULL;
            END;
        END;
      END IF;
    END; -- Busca fornecedor ems5
    --==================--
    -- Define o cliente --
    ----------------------
    PROCEDURE P_DEFINE_CLIENTE IS
    BEGIN
      IF F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
         '%' || PNRCGC_CPF || '%' AND PNRCGC_CPF IS NOT NULL THEN
        --------------------------
        -- Definir a pessoa PAI --
        --------------------------
        P_DEFINE_PESSOA_PAI;

        IF VTI_PESSOA.NRREGISTRO IS NULL THEN
          BEGIN
            SELECT TI.*
              INTO VTI_PESSOA
              FROM TI_PESSOA TI
             WHERE TI.NOABREVIADO_CLIENTE = PNRCGC_CPF
               AND TI.NRREGISTRO_PAI IS NULL
               AND ROWNUM = 1;
            VNOM_ABREVIADO := CNOM_ABREVIADO;
            VTI_PESSOA     := NULL;
          EXCEPTION
            --======================================--
            -- Caso o CPF/CPNPJ no existir o nome  --
            -- abreviado ser o CPF/CNPJ            --
            ------------------------------------------
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA     := NULL;
              VNOM_ABREVIADO := PNRCGC_CPF;
          END;
        ELSE
          VNOM_ABREVIADO := PNRCGC_CPF;
          VTI_PESSOA     := NULL;
        END IF;
      ELSE
        VNOM_ABREVIADO := CNOM_ABREVIADO;
        VTI_PESSOA     := NULL;
      END IF;
      IF VTI_PESSOA_PAI.NRREGISTRO IS NULL THEN
        ----------------------------
        P_BUSCA_CLIENTE_EMS;
        ----------------------------
        IF VNOM_ABREV_CLIENTE IS NOT NULL THEN
          VNOM_ABREVIADO := VNOM_ABREV_CLIENTE;
        END IF;
        VTI_PESSOA_PAI := NULL;
        BEGIN
          SELECT PS.*
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_CLIENTE = VNOM_ABREVIADO
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            VTI_PESSOA_PAI := NULL;
        END;
      ELSIF VTI_PESSOA.NRREGISTRO IS NOT NULL THEN
        SELECT PS.*
          INTO VTI_PESSOA_PAI
          FROM TI_PESSOA PS
         WHERE PS.NOABREVIADO_CLIENTE = VNOM_ABREVIADO
           AND NOT EXISTS (SELECT 1
                  FROM TI_PESSOA PST
                 WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
           AND ROWNUM = 1;
      END IF;
    END; -- fim p_define_cliente
    --==================--
    -- Define o fornecedor --
    ----------------------
    PROCEDURE P_DEFINE_FORNECEDOR IS
    BEGIN
      IF F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
         '%' || PNRCGC_CPF || '%' AND PNRCGC_CPF IS NOT NULL THEN
        --------------------------
        -- Definir a pessoa PAI --
        --------------------------
        P_DEFINE_PESSOA_PAI;
        IF VTI_PESSOA.NRREGISTRO IS NULL THEN
          BEGIN
            SELECT TI.*
              INTO VTI_PESSOA
              FROM TI_PESSOA TI
             WHERE TI.NOABREVIADO_FORNECEDOR = PNRCGC_CPF
               AND TI.NRREGISTRO_PAI IS NULL
               AND ROWNUM = 1;
            VNOM_ABREVIADO := CNOM_ABREVIADO;
            VTI_PESSOA     := NULL;
          EXCEPTION
            --======================================--
            -- Caso o CPF/CPNPJ no existir o nome  --
            -- abreviado ser o CPF/CNPJ            --
            ------------------------------------------
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA     := NULL;
              VNOM_ABREVIADO := PNRCGC_CPF;
          END;
        ELSE
          VNOM_ABREVIADO := PNRCGC_CPF;
          VTI_PESSOA     := NULL;
        END IF;
      ELSE
        VNOM_ABREVIADO := CNOM_ABREVIADO;
        VTI_PESSOA     := NULL;
      END IF;
      IF VTI_PESSOA_PAI.NRREGISTRO IS NULL THEN
        -----------------------
        P_BUSCA_FORNECEDOR_EMS;
        -----------------------
        IF VNOM_ABREV_FORNECEDOR IS NOT NULL THEN
          VNOM_ABREVIADO := VNOM_ABREV_FORNECEDOR;
        END IF;
        VTI_PESSOA_PAI := NULL;
        BEGIN
          SELECT PS.*
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_FORNECEDOR = VNOM_ABREVIADO
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            VTI_PESSOA_PAI := NULL;
        END;
      ELSIF VTI_PESSOA.NRREGISTRO IS NOT NULL THEN
        SELECT PS.*
          INTO VTI_PESSOA_PAI
          FROM TI_PESSOA PS
         WHERE PS.NOABREVIADO_FORNECEDOR = VNOM_ABREVIADO
           AND NOT EXISTS (SELECT 1
                  FROM TI_PESSOA PST
                 WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
           AND ROWNUM = 1;
      END IF;
    END; -- fim p_define_fornecedor
    --inicia aqui
  BEGIN
    VTI_PESSOA     := NULL;
    VTI_PESSOA_PAI := NULL;
    SELECT COUNT(*)
      INTO VCOUNT
      FROM TI_PESSOA P
     WHERE P.NRREGISTRO = PNRREGISTRO;
    IF VCOUNT = 0 THEN
      IF PAODEFINEPESSOA = 'S' THEN
        IF NOT F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
            '%' || PNRCGC_CPF || '%' THEN
          VNOABREVIADO_CLIENTE    := CNOM_ABREVIADO;
          VNOABREVIADO_FORNECEDOR := CNOM_ABREVIADO;
          VCDN_FORNECEDOR         := NULL;
          VCDN_CLIENTE            := NULL;
        ELSE
          IF PTPORIGEM = 'CLIENTE' THEN
            ---------------------------
            P_DEFINE_CLIENTE;
            ---------------------------
            --========================--
            -- Se for uma pessoa nova --
            ----------------------------
            IF VTI_PESSOA.NRREGISTRO IS NULL THEN
              ----------------------------
              -- Nome abreviado cliente --
              ----------------------------
              IF VCDN_CLIENTE IS NOT NULL THEN
                VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                VNOABREVIADO_CLIENTE   := VNOM_ABREV_CLIENTE;
              ELSE
                VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                VNOABREVIADO_CLIENTE   := VNOM_ABREVIADO;
              END IF;
              ------------------------------
              -- Verifica se  fornecedor --
              ------------------------------
              P_BUSCA_FORNECEDOR_EMS;
              -------------------------------
              -- Nome abreviado fornecedor --
              -------------------------------
              IF VCDN_FORNECEDOR IS NOT NULL THEN
                VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                VNOABREVIADO_FORNECEDOR   := VNOM_ABREV_FORNECEDOR;
              ELSE
                VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                VNOABREVIADO_FORNECEDOR   := VNOM_ABREVIADO;
              END IF;
            END IF;
          ELSE
            -------------------------------
            P_DEFINE_FORNECEDOR;
            -------------------------------
            --========================--
            -- Se for uma pessoa nova --
            ----------------------------
            IF VTI_PESSOA.NRREGISTRO IS NULL THEN
              -------------------------------
              -- Nome abreviado fornecedor --
              -------------------------------
              IF VCDN_FORNECEDOR IS NOT NULL THEN
                VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                VNOABREVIADO_FORNECEDOR   := VNOM_ABREV_FORNECEDOR;
              ELSE
                VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                VNOABREVIADO_FORNECEDOR   := VNOM_ABREVIADO;
              END IF;
              ------------------------------
              -- verifica se  cliente --
              ------------------------------
              P_BUSCA_CLIENTE_EMS;
              ----------------------------
              -- nome abreviado cliente --
              ----------------------------
              IF VCDN_CLIENTE IS NOT NULL THEN
                VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                VNOABREVIADO_CLIENTE   := VNOM_ABREV_CLIENTE;
              ELSE
                VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                VNOABREVIADO_CLIENTE   := VNOM_ABREVIADO;
              END IF;
            END IF;
          END IF;
        END IF;
      ELSE
        BEGIN
          SELECT *
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_CLIENTE = PNOABREVIADO_CLIENTE
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        EXCEPTION
          WHEN OTHERS THEN
            BEGIN
              SELECT *
                INTO VTI_PESSOA_PAI
                FROM TI_PESSOA PS
               WHERE PS.NOABREVIADO_FORNECEDOR = PNOABREVIADO_FORNECEDOR
                 AND NOT EXISTS
               (SELECT 1
                        FROM TI_PESSOA PST
                       WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
                 AND ROWNUM = 1;
            EXCEPTION
              WHEN OTHERS THEN
                VTI_PESSOA_PAI := NULL;
            END;
        END;
      END IF;
      IF VTI_PESSOA.NRREGISTRO IS NULL THEN
        VTI_PESSOA.NRREGISTRO             := PNRREGISTRO;
        VTI_PESSOA.NOABREVIADO_CLIENTE    := VNOABREVIADO_CLIENTE;
        VTI_PESSOA.NOABREVIADO_FORNECEDOR := VNOABREVIADO_FORNECEDOR;
        VTI_PESSOA.CDN_FORNECEDOR         := VCDN_FORNECEDOR;
        VTI_PESSOA.CDN_CLIENTE            := VCDN_CLIENTE;
        VTI_PESSOA.NRREGISTRO_PAI         := NULL;
        VTI_PESSOA.TXREGRA_AGRUPAMENTO    := NULL;
        VTI_PESSOA.NOPESSOA               := PNOPESSOA;
        VTI_PESSOA.DTNASCIMENTO           := PDTNASCIMENTO;
        VTI_PESSOA.NRCGC_CPF              := PNRCGC_CPF;
        VTI_PESSOA.NRREGISTRO_PAI         := VTI_PESSOA_PAI.NRREGISTRO;
      ELSE
        VTI_PESSOA.NRREGISTRO_PAI := VTI_PESSOA_PAI.NRREGISTRO;
        VTI_PESSOA.NRREGISTRO     := PNRREGISTRO;
        VTI_PESSOA.NOPESSOA       := PNOPESSOA;
        VTI_PESSOA.DTNASCIMENTO   := PDTNASCIMENTO;
        VTI_PESSOA.NRCGC_CPF      := PNRCGC_CPF;
      END IF;

      /* IF f_ti_parametro_integracao('INTR_EMS2') = 'S' THEN
              VTI_PESSOA.NOABREVIADO_CLIENTE    := SUBSTR(VTI_PESSOA.NOABREVIADO_CLIENTE,
                                                          0,
                                                          12);
              VTI_PESSOA.NOABREVIADO_FORNECEDOR := SUBSTR(VTI_PESSOA.NOABREVIADO_FORNECEDOR,
                                                          0,
                                                          12);
            END IF;
      */
      INSERT INTO TI_PESSOA
        (NRREGISTRO,
         NOABREVIADO_CLIENTE,
         NOABREVIADO_FORNECEDOR,
         CDN_FORNECEDOR,
         CDN_CLIENTE,
         NRREGISTRO_PAI,
         TXREGRA_AGRUPAMENTO,
         NOPESSOA,
         DTNASCIMENTO,
         NRCGC_CPF,
         DTGERACAO,
         DTULTIMA_ATUALIZACAO)
      VALUES
        (VTI_PESSOA.NRREGISTRO,
         VTI_PESSOA.NOABREVIADO_CLIENTE,
         VTI_PESSOA.NOABREVIADO_FORNECEDOR,
         VTI_PESSOA.CDN_FORNECEDOR,
         VTI_PESSOA.CDN_CLIENTE,
         VTI_PESSOA.NRREGISTRO_PAI,
         VTI_PESSOA.TXREGRA_AGRUPAMENTO,
         VTI_PESSOA.NOPESSOA,
         VTI_PESSOA.DTNASCIMENTO,
         VTI_PESSOA.NRCGC_CPF,
         SYSDATE,
         SYSDATE);
      PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
      PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
      PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
      PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;
    ELSE
      SELECT *
        INTO VTI_PESSOA
        FROM TI_PESSOA
       WHERE NRREGISTRO = PNRREGISTRO;
      PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
      PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
      PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
      PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;
    END IF;
  END;

  PROCEDURE P_JOB_FALHA IS
    CURSOR C_FALHA IS
      SELECT MP.CDACAO, FP.*
        FROM TI_MENSAGEM_PROCESSO MP, TI_FALHA_DE_PROCESSO FP
       WHERE FP.CDINTEGRACAO = MP.CDINTEGRACAO
         AND FP.NRMENSAGEM = MP.NRMENSAGEM;
    VSQL LONG;
  BEGIN
    FOR L_FALHA IN C_FALHA LOOP
      IF L_FALHA.CDACAO = 'CA' THEN
        VSQL := 'update ' || L_FALHA.CDINTEGRACAO || ' set ' ||
                ' cdsituacao=' || '''' || 'CA' || '''' ||
                ' where nrseq_controle_integracao=' ||
                L_FALHA.NRSEQ_CONTROLE_INTEGRACAO;
        EXECUTE IMMEDIATE VSQL;
      ELSIF L_FALHA.CDACAO = 'AT' THEN
        VSQL := 'begin pck_ems506unicoo.p_update_controle_integracao(' ||
                L_FALHA.NRSEQ_CONTROLE_INTEGRACAO ||
                ',f_ti_situacao_integracao(' ||
                L_FALHA.NRSEQ_CONTROLE_INTEGRACAO || ',' || '''' ||
                L_FALHA.CDINTEGRACAO || '''' || '),null ); end;';
        --            dbms_output.put_line(vsql);
        EXECUTE IMMEDIATE VSQL;
        BEGIN
          -- nao apagar falhas
          --pck_ems506unicoo.p_apaga_falha(l_falha.nrseq_controle_integracao);
          NULL;
        END;
      END IF;
      PCK_EMS506UNICOO.P_JOB();
    END LOOP;
  END;

  FUNCTION F_PERMITE_CANC_INT_FI_TIT_APB(PCDUNIMED VARCHAR2,
                                         PNRFATURA VARCHAR2) RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
    CURSOR C_TITULO IS
      SELECT *
        FROM AREA_DE_ACAO AA, TITULO_A_PAGAR TP
       WHERE AA.CDPRESTADOR = TP.CDFORNECEDOR
         AND AA.CDAREAACAO = PCDUNIMED
         AND TP.NRDOCUMENTO = PNRFATURA;
    VAOALTERAR VARCHAR2(1);
    VAOCANCELA VARCHAR2(1);
  BEGIN
    VRESULT := 'S';
    FOR L_TITULO IN C_TITULO LOOP
      VAOALTERAR := F_PERMITE_ALTERAR_TIT_APB(L_TITULO.NRDOCUMENTO,
                                              L_TITULO.NRREGISTRO_TITULO);
      IF VAOALTERAR = 'N' THEN
        VRESULT := 'N';
      ELSE
        VAOCANCELA := F_PERMITE_CANCELAR_TI_TIT_APB(L_TITULO.NRDOCUMENTO,
                                                    L_TITULO.NRREGISTRO_TITULO);
        IF VAOCANCELA = 'N' THEN
          VRESULT := 'N';
        END IF;
      END IF;
    END LOOP;
    RETURN VRESULT;
  END;

  PROCEDURE P_UPDATE_CONTROLE_INTEGRACAO(PNRSEQUENCIAL NUMBER,
                                         PCDSITUACAO   VARCHAR2,
                                         PTXOBSERVACAO VARCHAR2) IS
  BEGIN
    UPDATE TI_CONTROLE_INTEGRACAO TI
       SET TI.CDSITUACAO      = PCDSITUACAO,
           TI.TXOBSERVACAO    = PTXOBSERVACAO,
           TI.DTINTEGRACAO    = DECODE(PCDSITUACAO, 'IT', SYSDATE, NULL),
           TI.DTPROCESSAMENTO = SYSDATE
     WHERE TI.NRSEQUENCIAL = PNRSEQUENCIAL;
  END;

  PROCEDURE P_AJUSTES IS
    PROCEDURE P_ATUALIZA_NOSSONUMERO IS
      CURSOR C_TITULO IS
        SELECT TI.COD_PARCELA, TA.ROWID, TI.COD_TIT_ACR_BCO
          FROM EMS506UNICOO.TI_TIT_ACR TI, TIT_ACR TA
         WHERE TI.COD_TITULO_ACR = TA.COD_TIT_ACR
           AND TI.COD_SER_DOCTO = TA.COD_SER_DOCTO
           AND TI.COD_ESPEC_DOCTO = TA.COD_ESPEC_DOCTO
           AND TI.COD_PARCELA = TA.COD_PARCELA
           AND TA.COD_TIT_ACR_BCO <> TI.COD_TIT_ACR_BCO
           AND 1 = 2;
    BEGIN
      FOR L_TITULO IN C_TITULO LOOP
        UPDATE TIT_ACR Z
           SET Z.COD_TIT_ACR_BCO    = L_TITULO.COD_TIT_ACR_BCO,
               Z.U##COD_TIT_ACR_BCO = L_TITULO.COD_TIT_ACR_BCO
         WHERE Z.ROWID = L_TITULO.ROWID;
      END LOOP;
    END;

  BEGIN
    P_ATUALIZA_NOSSONUMERO;
    --          p_atualiza_cliente;
  END;

  --=========================--
  -- Grava falha de processo --
  -----------------------------
  PROCEDURE P_APAGA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER) IS
  BEGIN
    DELETE FROM TI_FALHA_DE_PROCESSO
     WHERE NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
  END;

  PROCEDURE P_JOB IS
    VTPINTEGRACAO TI_PARAMETRO_INTEGRACAO.VLPARAMETRO%TYPE;
  BEGIN
    VTPINTEGRACAO := F_TI_PARAMETRO_INTEGRACAO('TP_INTEGRACAO_ONLINE_UNICOO_EMS5');
    IF VTPINTEGRACAO LIKE '%' || 'CL' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'CL');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'FN' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'FN');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'TR' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'TR');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'TP' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'TP');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'FT' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'FT');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'CX' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'CX');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'BP' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'BP');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'BR' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'BR');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'CP' || '%' THEN
      -- cancelamento titulo pagar no ems
      P_MONITOR_INTEGRACAO(0, 'CP');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'BC' || '%' THEN
      -- cdhistorico 78
      P_MONITOR_INTEGRACAO(0, 'BC');
    END IF;
    COMMIT;
  END;

  PROCEDURE P_JOB_ERRO IS
  BEGIN
    UPDATE TI_CONTROLE_INTEGRACAO CI
       SET CI.CDSITUACAO = 'GE'
     WHERE CI.CDSITUACAO = 'ER'
       AND WNAOREPROCESSA NOT LIKE '%' || CI.TPINTEGRACAO || '%';
    P_COMMIT_NEW;
    PCK_EMS506UNICOO.P_JOB();
  END;

  PROCEDURE P_COMMIT IS
  BEGIN
    IF GCOMMIT >= GCOUNTOFRECORDS THEN
      COMMIT;
      GCOMMIT := 0;
    END IF;
    GCOMMIT := GCOMMIT + 1;
  END;

  PROCEDURE P_COMMIT_NEW IS
  BEGIN
    IF GCOMMIT >= GCOUNTOFRECORDS THEN
      COMMIT;
      GCOMMIT := 0;
    END IF;
    GCOMMIT := GCOMMIT + 1;
  END;

  PROCEDURE P_REENVIA_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER) IS
  BEGIN
    UPDATE TI_CLIENTE C
       SET CDSITUACAO = 'RC'
     WHERE C.NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
    --       p_apaga_falha(pNRSeq_Controle_integracao);
  END;

  PROCEDURE P_REPROCESSA_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                    P_TPINTEGRACAO             VARCHAR2) IS
    CURSOR C_REPROCESSA IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND CI.CDSITUACAO IN ('PE')
         AND ((CI.TPINTEGRACAO = P_TPINTEGRACAO) OR (P_TPINTEGRACAO = '*'))
         AND WNAOREPROCESSA NOT LIKE '%' || CI.TPINTEGRACAO || '%'
       ORDER BY CI.NRSEQUENCIAL;
    V_SEQ_CONTROLE_INTEGRACAO NUMBER(10);
  BEGIN
    SELECT VLPARAMETRO
      INTO WNAOREPROCESSA
      FROM TI_PARAMETRO_INTEGRACAO
     WHERE CDPARAMETRO = 'TPINTEGRACAONAOREPROCESSA';
    FOR L_REPROCESSA IN C_REPROCESSA LOOP
      SELECT SQ_TI_CONTROLE_INTEGRACAO.NEXTVAL
        INTO V_SEQ_CONTROLE_INTEGRACAO
        FROM DUAL;
      INSERT INTO TI_CONTROLE_INTEGRACAO
        (NRSEQUENCIAL,
         TPINTEGRACAO,
         DTGERACAO,
         NRSEQUENCIAL_ORIGEM,
         DTPROCESSAMENTO,
         DTINTEGRACAO,
         CDACAO,
         CDIDENTIFICADOR,
         CDSITUACAO,
         NRSEQ_CONTROLE_INTEGRACAO_ORG,
         CDEMPRESA,
         CDMODULO,
         CDMOVIMENTO,
         CDDIVISAO)
        SELECT V_SEQ_CONTROLE_INTEGRACAO,
               TPINTEGRACAO,
               SYSDATE DTGERACAO,
               NRSEQUENCIAL_ORIGEM,
               NULL,
               DTINTEGRACAO,
               L_REPROCESSA.CDACAO,
               CDIDENTIFICADOR,
               'GE',
               L_REPROCESSA.NRSEQUENCIAL,
               L_REPROCESSA.CDEMPRESA,
               L_REPROCESSA.CDMODULO,
               L_REPROCESSA.CDMOVIMENTO,
               L_REPROCESSA.CDDIVISAO
          FROM TI_CONTROLE_INTEGRACAO CI
         WHERE CI.NRSEQUENCIAL = L_REPROCESSA.NRSEQUENCIAL;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.DTPROCESSAMENTO = SYSDATE, CI.CDSITUACAO = 'RE'
       WHERE CI.NRSEQUENCIAL = L_REPROCESSA.NRSEQUENCIAL;
      IF L_REPROCESSA.TPINTEGRACAO = 'CL' THEN
        UPDATE TI_CLIENTE CL
           SET CL.CDSITUACAO = 'RE' -- REPROCESSA
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'FN' THEN
        UPDATE TI_FORNECEDOR FN
           SET FN.CDSITUACAO = 'RE' -- REPROCESSA
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'TR' THEN
        UPDATE TI_TIT_ACR CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'TP' THEN
        UPDATE TI_TIT_APB CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'CT' THEN
        UPDATE TI_LOTE_CTBL CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'CX' THEN
        UPDATE TI_LOTE_CTBL CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO IN ('FT', 'EM') THEN
        UPDATE TI_TIT_ACR_ESTORNO CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'BP' THEN
        UPDATE TI_CX_BX_APB BP
           SET BP.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'BR' THEN
        UPDATE TI_CX_BX_ACR BR
           SET BR.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      END IF;
    END LOOP;
    P_COMMIT_NEW;
    PCK_EMS506UNICOO.P_JOB();
  END;

  --======================================================--
  -- Define o mdulo origem dos titulos do contas a pagar --
  ----------------------------------------------------------
  PROCEDURE P_DEFINE_MODULO_TIT_APB(PNRSESSAO TI_CONTROLE_INTEGRACAO.NRSESSAO%TYPE) IS
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TP'
         AND CI.CDMODULO IS NULL
         AND CI.NRSESSAO = PNRSESSAO;
    VCDMOVIMENTO  TI_CONTROLE_INTEGRACAO.CDMOVIMENTO%TYPE;
    VCDDIVISAO    TI_CONTROLE_INTEGRACAO.CDDIVISAO%TYPE;
    VCDMODULO     TI_CONTROLE_INTEGRACAO.CDMODULO%TYPE;
    VCDSITUACAO   TI_CONTROLE_INTEGRACAO.CDSITUACAO%TYPE;
    VTXOBSERVACAO TI_CONTROLE_INTEGRACAO.TXOBSERVACAO%TYPE;
    VQTDESPECIE   NUMBER;
  BEGIN
    FOR L_TITULO IN C_TITULO LOOP
      BEGIN
        --===================================--
        -- Titulos de prestadores e Unimeds --
        ---------------------------------------
        -- Alessandro 18/07/2012
        /*select pr.tpprestador
         into vcdmovimento
         from titulo_a_pagar tp,
              prestador pr
        where
              f_ti_parametro_integracao('CLASSIFICA_INTEGRACAO_PAGPREST') = 'PR'
          and pr.cdprestador                                             = tp.cdfornecedor
          and tp.nrregistro_titulo                                       = l_titulo.nrsequencial_origem
          and tp.cdfuncionario                                          <> 'MVINTEGRA';*/
        SELECT PR.TPPRESTADOR
          INTO VCDMOVIMENTO
          FROM TITULO_A_PAGAR TP, PRESTADOR PR
         WHERE F_TI_PARAMETRO_INTEGRACAO('CLASSIFICA_INTEGRACAO_PAGPREST') = 'PR'
           AND PR.CDPRESTADOR = TP.CDFORNECEDOR
           AND TP.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
           AND TP.CDFUNCIONARIO <> 'MVINTEGRA'
              --
              --and tp.tpdocumento <> wtpdoc
           AND TP.NRDOCUMENTO NOT LIKE 'TX%'
              --
           AND NOT EXISTS
         (SELECT 1
                  FROM REM_IMP_CONTROLE_A550 XX
                 WHERE XX.TP_ARQUIVO IN ('4', '6', '8') -- tp_arquivo = 5 -- Receber  -- tp_arquivo = 6 -- Pagar;-- Alessandro 13/05/2014
                   AND XX.NRREGISTRO_TITULO = TP.NRREGISTRO_TITULO)
           AND PR.TPPRESTADOR <>
               F_TI_PARAMETRO_INTEGRACAO('TIPO_PRESTADOR_NAO_INTEGRA_PAGPREST'); -- Alecsandro 05/08
        -- Alessandro 18/07/2012
        VCDDIVISAO  := NULL;
        VCDMODULO   := 'PR';
        VCDSITUACAO := 'GE';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          --=========================--
          -- Titulos de fornecedores --
          -----------------------------
          IF VVERSAOFINANCEIRO = '1' THEN
            BEGIN
              SELECT CDHISTORICO, HT.CDCENTRO_CUSTO
                INTO VCDMOVIMENTO, VCDDIVISAO
                FROM HISTORICO_DO_TITULO_PAGAR HT
               WHERE HT.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
                 AND HT.CDMOVIMENTO IN ('1', '3');
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VCDMOVIMENTO  := NULL;
                VCDMODULO     := NULL;
                VCDDIVISAO    := NULL;
                VCDSITUACAO   := 'CA';
                VTXOBSERVACAO := 'Nao encontrado movimento 1 ou 3 na tabela historico_do_titulo_pagar ';
            END;
          ELSE
            ----------------------------------------------------
            -- Verificar se o titulo tem somente uma especie.
            -- Josias 05-06-2014 - -João Pessoa
            ----------------------------------------------------
            BEGIN
              SELECT COUNT(*)
                INTO VQTDESPECIE
                FROM (SELECT DISTINCT C.COD_ESPEC_DOCTO
                        FROM TITULO_A_PAGAR            TP,
                             DISTRIBUICAO_TITULO_PAGAR DTP,
                             TI_TIPO_MOVIMENTO_TIT_APB C
                       WHERE TP.NRREGISTRO_TITULO = DTP.NRREGISTRO_TITULO
                         AND C.CDEMPRESA = TP.CDEMPRESA
                         AND C.CDMOVIMENTO =
                             TO_CHAR(NVL(DTP.CDHISTORICO, TP.CDHISTORICO))
                         AND TP.NRREGISTRO_TITULO =
                             L_TITULO.NRSEQUENCIAL_ORIGEM);
              --Quando houver mais de uma especie deverá localizar a distribuicao de maior valor,
              --caso o parametro DEFINE_HISTORICO_PADRAO_APB seja igual a GF, o valor do historico sera
              --substituido pelo exitente no cadastro de grupo de fornecedor (ti_grupo_fornecedor)...
              --Inicio trata espécie duplkicada...
              IF VQTDESPECIE > 1 THEN
                BEGIN
                  VTXOBSERVACAO := 'Titulo rateado pelo critério do maior valor';
                  SELECT CDHISTORICO, CDDIVISAO
                    INTO VCDMOVIMENTO, VCDDIVISAO
                    FROM (SELECT NVL(B.CDHISTORICO, HT.CDHISTORICO) CDHISTORICO,
                                 NVL(B.CDDIVISAO, HT.CDDIVISAO) CDDIVISAO,
                                 NVL(SUM(DECODE(B.TIPO_DISTRIB,
                                                'V',
                                                B.VLDISTRIBUICAO,
                                                -1 * B.VLDISTRIBUICAO)),
                                     0) VALOR
                            FROM TITULO_A_PAGAR            HT,
                                 DISTRIBUICAO_TITULO_PAGAR B
                           WHERE HT.NRREGISTRO_TITULO =
                                 B.NRREGISTRO_TITULO(+)
                             AND HT.NRREGISTRO_TITULO =
                                 L_TITULO.NRSEQUENCIAL_ORIGEM
                           GROUP BY NVL(B.CDHISTORICO, HT.CDHISTORICO),
                                    NVL(B.CDDIVISAO, HT.CDDIVISAO)
                           ORDER BY 3 DESC)
                   WHERE ROWNUM = 1;
                  IF F_TI_PARAMETRO_INTEGRACAO('DEFINE_HISTORICO_PADRAO_APB') = 'GF' THEN
                    BEGIN
                      VTXOBSERVACAO := 'Titulo rateado pelo critério do Grupo do Fornecedor';
                      SELECT GF.CD_HISTORICO_PADRAO
                        INTO VCDMOVIMENTO
                        FROM TITULO_A_PAGAR                      TP,
                             PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FN,
                             TI_GRUPO_DE_FORNECEDOR              GF
                       WHERE GF.CDGRUPO_FORNECEDOR = FN.CDGRUPO_FORNECEDOR
                         AND TP.CDFORNECEDOR = TP.CDFORNECEDOR
                         AND TP.NRREGISTRO_TITULO =
                             L_TITULO.NRSEQUENCIAL_ORIGEM
                         AND GF.CD_HISTORICO_PADRAO IS NOT NULL;
                    EXCEPTION
                      WHEN NO_DATA_FOUND THEN
                        VCDMOVIMENTO  := NULL;
                        VCDMODULO     := NULL;
                        VCDDIVISAO    := NULL;
                        VCDSITUACAO   := 'ER';
                        VTXOBSERVACAO := 'Histórico não cadastrado no Grupo de Fornecedor';
                        P_GRAVA_FALHA(L_TITULO.NRSEQUENCIAL,
                                      'tp',
                                      VTXOBSERVACAO,
                                      NULL,
                                      VCDSITUACAO,
                                      NULL);
                    END;
                  END IF;
                EXCEPTION
                  WHEN NO_DATA_FOUND THEN
                    VCDMOVIMENTO  := NULL;
                    VCDMODULO     := NULL;
                    VCDDIVISAO    := NULL;
                    VCDSITUACAO   := 'ER';
                    VTXOBSERVACAO := 'Não encontrado titulo de origem ';
                    P_GRAVA_FALHA(L_TITULO.NRSEQUENCIAL,
                                  'tp',
                                  VTXOBSERVACAO,
                                  NULL,
                                  VCDSITUACAO,
                                  NULL);
                END;
                --Fim trata espécie duplkicada...
              ELSE
                BEGIN
                  SELECT MIN(CDHISTORICO), MIN(CDDIVISAO)
                    INTO VCDMOVIMENTO, VCDDIVISAO
                    FROM (SELECT DISTINCT NVL(B.CDHISTORICO, HT.CDHISTORICO) CDHISTORICO,
                                          NVL(B.CDDIVISAO, HT.CDDIVISAO) CDDIVISAO
                            FROM TITULO_A_PAGAR            HT,
                                 DISTRIBUICAO_TITULO_PAGAR B
                           WHERE HT.NRREGISTRO_TITULO =
                                 B.NRREGISTRO_TITULO(+)
                             AND HT.NRREGISTRO_TITULO =
                                 L_TITULO.NRSEQUENCIAL_ORIGEM);
                EXCEPTION
                  WHEN NO_DATA_FOUND THEN
                    VCDMOVIMENTO  := NULL;
                    VCDMODULO     := NULL;
                    VCDDIVISAO    := NULL;
                    VCDSITUACAO   := 'ER';
                    VTXOBSERVACAO := 'Não encontrado titulo de origem ';
                    P_GRAVA_FALHA(L_TITULO.NRSEQUENCIAL,
                                  'tp',
                                  VTXOBSERVACAO,
                                  NULL,
                                  VCDSITUACAO,
                                  NULL);
                END;
              END IF;
            END;
          END IF;
          IF NVL(VCDSITUACAO, 'x') <> 'ER' THEN
            VCDMODULO   := 'CP';
            VCDSITUACAO := 'GE';
            --====================--
            -- Classifica imposto --
            ------------------------
            BEGIN
              SELECT PR.TPPRESTADOR
                INTO VCDMOVIMENTO
                FROM TAXA_TITULO_INTEGRACAO TTI,
                     TITULO_A_PAGAR         TP,
                     PRESTADOR              PR
               WHERE PR.CDPRESTADOR = TTI.CDFORNECEDOR
                 AND TP.NRREGISTRO_TITULO = TTI.NRREGISTRO_TITULO_TAXA
                 AND TP.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
                    --
                 AND NOT EXISTS
               (SELECT 1
                        FROM TAXA_TITULO_INTEGRACAO T
                       WHERE T.NRREGISTRO_TITULO_TAXA = TP.NRREGISTRO_TITULO);
              VCDMODULO  := F_TI_PARAMETRO_INTEGRACAO('CLASSIFICA_IMPOSTO_INTEGRACAO_PAGPREST');
              VCDDIVISAO := NULL;
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                NULL;
            END;
          END IF;
      END;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDMODULO     = VCDMODULO,
             CI.CDMOVIMENTO  = VCDMOVIMENTO,
             CI.CDSITUACAO   = VCDSITUACAO,
             CI.CDDIVISAO    = VCDDIVISAO,
             CI.TXOBSERVACAO = VTXOBSERVACAO
       WHERE CI.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
      P_COMMIT_NEW;
    END LOOP;
  END;

  --========================================================--
  -- Define o mdulo origem dos titulos do contas a receber --
  ------------------------------------------------------------
  PROCEDURE P_DEFINE_MODULO_TIT_ACR(PNRSESSAO TI_CONTROLE_INTEGRACAO.NRSESSAO%TYPE) IS
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TR'
         AND CI.CDMODULO IS NULL
         AND CI.NRSESSAO = PNRSESSAO;
    VCDMOVIMENTO TI_CONTROLE_INTEGRACAO.CDMOVIMENTO%TYPE;
    VCDMODULO    TI_CONTROLE_INTEGRACAO.CDMODULO%TYPE;
    VCDSITUACAO  TI_CONTROLE_INTEGRACAO.CDSITUACAO%TYPE;
  BEGIN
    FOR L_TITULO IN C_TITULO LOOP
      BEGIN
        --====================--
        -- Titulos de faturas --
        ------------------------
        SELECT SUBSTR(FT.NRFATURA, 1, INSTR(FT.NRFATURA, '-') - 1)
          INTO VCDMOVIMENTO
          FROM FATURAMENTO FT
         WHERE FT.NRFATURA = L_TITULO.CDIDENTIFICADOR;
        VCDMODULO   := 'FT';
        VCDSITUACAO := 'GE';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          BEGIN
            --===============================--
            -- Titulos de faturas parceladas --
            -----------------------------------
            SELECT SUBSTR(DF.NRFATURA, 1, INSTR(DF.NRFATURA, '-') - 1)
              INTO VCDMOVIMENTO
              FROM DUPLICATA_FATURAMENTO DF
             WHERE DF.NRDUPLICATA = L_TITULO.CDIDENTIFICADOR;
            VCDMODULO   := 'FT';
            VCDSITUACAO := 'GE';
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                --===============================================--
                -- Titulos que no possuem origem no faturamento --
                ---------------------------------------------------
                SELECT NVL(HT.CDHISTORICO, TR.CDHISTORICO)
                  INTO VCDMOVIMENTO
                  FROM HISTORICO_DO_TITULO HT, TITULO_A_RECEBER TR
                 WHERE HT.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
                   AND HT.NRREGISTRO_TITULO = TR.NRREGISTRO_TITULO
                   AND
                      --ht.cdmovimento='1';-- Alessandro 21/10/2014
                       HT.CDMOVIMENTO IN ('1', '3'); -- Alessandro 21/10/2014
                VCDMODULO   := 'CR';
                VCDSITUACAO := 'GE';
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VCDMOVIMENTO := NULL;
                  VCDMODULO    := NULL;
                  VCDSITUACAO  := 'CA';
                  -- gravar falha
                WHEN OTHERS THEN
                  VCDMOVIMENTO := NULL;
                  VCDMODULO    := NULL;
                  VCDSITUACAO  := 'CA';
                  -- gravar falha
              END;
          END;
      END;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDMODULO    = VCDMODULO,
             CI.CDMOVIMENTO = VCDMOVIMENTO,
             CI.CDSITUACAO  = VCDSITUACAO
       WHERE CI.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
    END LOOP;
  END;

  PROCEDURE P_MONITOR_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PTPINTEGRACAO              VARCHAR DEFAULT '*') IS
    CURSOR C_PROCESSA(PNRSESSAO NUMBER, PTPINTEGRACAO VARCHAR2) IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.CDSITUACAO = 'VD'
         AND CI.TPINTEGRACAO NOT IN ('MV', 'FE')
         AND CI.TPINTEGRACAO = PTPINTEGRACAO
       ORDER BY CI.NRSEQUENCIAL;
    VCDSITUACAO VARCHAR2(2);
    /*-------------------------------
    GE --> PI --> PR  // Prepara
    PR --> VI --> VD  // Valida
    VD --> OK         // Processa
    Gerao --> Preparao Inicio --> Preparado
    Preparado --> Validao Inicial --> Validado
    Validado --> OK
    -------------------------------*/
    VNRSESSAO     NUMBER(10);
    VTPINTEGRACAO VARCHAR2(2);
  BEGIN
    WHILE TRUE LOOP
      SELECT SQ_TI_SESSAO.NEXTVAL INTO VNRSESSAO FROM DUAL;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.NRSESSAO = VNRSESSAO
       WHERE (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = CI.TPINTEGRACAO)
         AND CI.CDSITUACAO = 'GE'
         AND ROWNUM <= GSESSAO_MOVIMENTO;
      IF SQL%ROWCOUNT = 0 THEN
        EXIT;
      ELSE
        ----------------------------------------------------------
        P_VALIDA_CONTROLE_INTEGRACAO(PTPINTEGRACAO, VNRSESSAO);
        ----------------------------------------------------------
        IF PTPINTEGRACAO = 'TP' THEN
          P_DEFINE_MODULO_TIT_APB(VNRSESSAO);
        ELSIF PTPINTEGRACAO = 'TR' THEN
          P_DEFINE_MODULO_TIT_ACR(VNRSESSAO);
        END IF;
        --====================--
        -- Prepara Integrao --
        ------------------------
        VCDSITUACAO := 'VD';
        UPDATE TI_CONTROLE_INTEGRACAO CI
           SET CI.CDSITUACAO = VCDSITUACAO
         WHERE CI.NRSESSAO = VNRSESSAO
           AND CI.CDSITUACAO = 'GE'
           AND CI.TPINTEGRACAO NOT IN ('MV', 'FE');
        --=====================--
        -- Processa Integrao --
        -------------------------
        VTPINTEGRACAO := PTPINTEGRACAO;
        FOR L_PROCESSA IN C_PROCESSA(VNRSESSAO, VTPINTEGRACAO) LOOP
          VCDSITUACAO := 'VD';

          P_TI_PROCESSA_INTEGRACAO(L_PROCESSA.TPINTEGRACAO,
                                   L_PROCESSA.NRSEQUENCIAL,
                                   VNRSESSAO,
                                   L_PROCESSA.CDIDENTIFICADOR,
                                   VCDSITUACAO);
        END LOOP;
        P_COMMIT_NEW;
      END IF;
    END LOOP;
    COMMIT;
  END;

  PROCEDURE P_VALIDA_CONTROLE_INTEGRACAO(PTPINTEGRACAO VARCHAR2,
                                         PNRSESSAO     NUMBER) IS
  BEGIN
    P_AJUSTES;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'FT') THEN
      --=============================================--
      -- Cancela integrao de fornecedores diversos --
      -------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'FATURA REATIVADA NO UNICOO'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND EXISTS (SELECT 1
                FROM FATURAMENTO FT
               WHERE FT.NRFATURA = CI.CDIDENTIFICADOR
                 AND FT.DTCANCELAMENTO IS NULL);
      --=============================================--
      -- Cancela integrao de fornecedores diversos --
      -------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'FATURA JA CANCELADA NO EMS5'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND EXISTS (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS, TIT_ACR TTA
               WHERE TTA.U##COD_ESTAB = EMS.COD_ESTAB
                 AND TTA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
                 AND TTA.LOG_TIT_ACR_ESTORDO = 1
                 AND EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR)
         AND NOT EXISTS
       (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS, TIT_ACR TTA
               WHERE TTA.U##COD_ESTAB = EMS.COD_ESTAB
                 AND TTA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
                 AND TTA.LOG_TIT_ACR_ESTORDO = 0
                 AND EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR);
      --=============================================--
      -- Cancela integrao de fornecedores diversos CASO NAO ENCONTRE TITULO NO EMS--
      -------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'FATURA JA CANCELADA OU NAO INTEGRADA NO EMS5'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND NOT EXISTS
       (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS, TIT_ACR TTA
               WHERE TTA.U##COD_ESTAB = EMS.COD_ESTAB
                 AND TTA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
                 AND TTA.LOG_TIT_ACR_ESTORDO = 0
                 AND EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR);
      -- Alessandro 19/03/2012
      --=============================================--
      -- Fatura Integrada com EMS5 e nao Contabilizada
      ------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'ER',
             CI.TXOBSERVACAO = 'FATURA INTEGRADA EMS5 e Nao Contabilizada'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO --386511633--
         AND EXISTS
       (SELECT 1
                FROM TI_CONTROLE_INTEGRACAO CI1,
                     TI_TIT_ACR_ESTORNO     T,
                     TIT_ACR                TA,
                     MOVTO_TIT_ACR          MT
               WHERE MT.U##COD_ESTAB = TA.U##COD_ESTAB
                 AND MT.NUM_ID_TIT_ACR = TA.NUM_ID_TIT_ACR
                 AND MT.IND_TRANS_ACR_ABREV = 'IMPL'
                 AND TA.NUM_ID_TIT_ACR = T.NUM_ID_TIT_ACR
                 AND CI1.NRSEQUENCIAL = T.NRSEQ_CONTROLE_INTEGRACAO
                 AND MT.LOG_APROP_CTBL_CTBZDA = 0
                 AND CI1.NRSEQUENCIAL = CI.NRSEQUENCIAL);
      -- Alessandro 19/03/2012
    END IF;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'TP') THEN
      -- cancela os titulos do contas a pagar que sao de impostos, pois nao devem ser integrados
      -----------------------------------------------
      CANCELA_CONTROLE_TIT_IMPOSTOS(PNRSESSAO);
      -----------------------------------------------
      IF F_TI_PARAMETRO_INTEGRACAO('INTEGRA_SOMENTE_TITULOS_PRESTADORES') = 'S' THEN
        --=============================================--
        -- Cancela integrao de fornecedores diversos --
        -------------------------------------------------
        UPDATE TI_CONTROLE_INTEGRACAO CI
           SET CI.CDSITUACAO   = 'CA',
               CI.TXOBSERVACAO = 'A integração do unicoo com o ems5 integra apenas titulos de prestadores'
         WHERE CI.TPINTEGRACAO = 'TP'
           AND CI.CDSITUACAO = 'GE'
           AND CI.NRSESSAO = PNRSESSAO
           AND NOT EXISTS
         (SELECT 1
                  FROM TITULO_A_PAGAR                      TP,
                       PRESTADOR                           PR,
                       PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FN
                 WHERE FN.CDFORNECEDOR = PR.CDPRESTADOR
                   AND FN.CDFORNECEDOR = TP.CDFORNECEDOR
                   AND CI.NRSEQUENCIAL_ORIGEM = TP.NRREGISTRO_TITULO)
              -- Titulo no  de imposto de prestador com saldo negativo
           AND NOT EXISTS
         (SELECT 1
                  FROM TITULO_A_PAGAR TP --taxa_titulo_integracao tti,
                 WHERE CI.NRSEQUENCIAL_ORIGEM = TP.NRREGISTRO_TITULO);
      END IF;
    END IF;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'TR') THEN
      IF F_TI_PARAMETRO_INTEGRACAO('INTEGRA_SOMENTE_TITULOS_FATURAMENTO') = 'S' THEN
        --=====================================--
        -- Cancela a integrao de titulos que --
        -- no possuem origem no faturamento   --
        -----------------------------------------
        UPDATE TI_CONTROLE_INTEGRACAO CI
           SET CI.CDSITUACAO   = 'CA',
               CI.TXOBSERVACAO = 'TITULO NO POSSUI ORIGEM NO FATURAMENTO'
         WHERE CI.TPINTEGRACAO = 'TR'
           AND CI.CDSITUACAO = 'GE'
           AND CI.NRSESSAO = PNRSESSAO
           AND NOT EXISTS (SELECT 1
                  FROM FATURAMENTO FT
                 WHERE FT.NRFATURA = CI.CDIDENTIFICADOR)
           AND NOT EXISTS
         (SELECT 1
                  FROM DUPLICATA_FATURAMENTO DF
                 WHERE DF.NRDUPLICATA = CI.CDIDENTIFICADOR);
      END IF;
    END IF;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'FT') THEN
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'TITULO CANC NO FATURAMENTO E NAO EXISTE NO EMS/RECEBER UNICOO'
       WHERE CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'FT'
         AND NOT EXISTS
       (SELECT 1
                FROM TI_TIT_ACR_ESTORNO TAC
               WHERE TAC.NRSEQ_CONTROLE_INTEGRACAO = CI.NRSEQUENCIAL)
         AND NOT EXISTS (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS
               WHERE EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR)
         AND NOT EXISTS
       (SELECT 1
                FROM TITULO_A_RECEBER TR
               WHERE TR.NRDOCUMENTO = CI.CDIDENTIFICADOR);
    END IF;
  END;

  --=========================--
  -- Grava falha de processo --
  -----------------------------
  PROCEDURE P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                          PCDINTEGRACAO              VARCHAR2,
                          PTXFALHA                   VARCHAR2,
                          PTXAJUDA                   VARCHAR2,
                          PCDSITUACAO                IN OUT VARCHAR2,
                          PNRMENSAGEM                NUMBER DEFAULT NULL) IS
  BEGIN
    PCDSITUACAO := 'ER';
    BEGIN
      INSERT INTO TI_FALHA_DE_PROCESSO
        (NRSEQUENCIAL,
         NRSEQ_CONTROLE_INTEGRACAO,
         CDINTEGRACAO,
         TXFALHA,
         TXAJUDA,
         DTFALHA,
         NRMENSAGEM)
      VALUES
        (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
         PNRSEQ_CONTROLE_INTEGRACAO,
         PCDINTEGRACAO,
         PTXFALHA,
         PTXAJUDA,
         SYSDATE,
         PNRMENSAGEM);
    EXCEPTION
      WHEN OTHERS THEN
        RAISE_APPLICATION_ERROR(-20001,
                                PNRSEQ_CONTROLE_INTEGRACAO || PCDINTEGRACAO ||
                                PTXFALHA || PTXAJUDA);
    END;
    P_UPDATE_CONTROLE_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO,
                                 PCDSITUACAO,
                                 NULL);
  END;

  PROCEDURE P_TIT_PAGAR_CANCELADO_EMS(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER) IS
    TTI_TIT_APB             TI_TIT_APB%ROWTYPE;
    TTI_CONTROLE_INTEGRACAO TI_CONTROLE_INTEGRACAO%ROWTYPE;
    TTIT_AP                 TIT_AP%ROWTYPE;
    TFORNECEDOR_EMS         FORNECEDOR%ROWTYPE;
    TTIT_CANCDO_APB         TIT_CANCDO_APB%ROWTYPE;
    VSIT                    VARCHAR2(2);
    -- procedure para inserir historico de cancelamento no unicoo
    PROCEDURE INSERE_HISTORICO_80(PNRREGISTRO_TITULO IN NUMBER) IS
      THISTORICO_DO_TITULO_PAGAR HISTORICO_DO_TITULO_PAGAR%ROWTYPE;
    BEGIN
      SELECT *
        INTO THISTORICO_DO_TITULO_PAGAR
        FROM HISTORICO_DO_TITULO_PAGAR
       WHERE NRREGISTRO_TITULO = PNRREGISTRO_TITULO;
      SELECT PRODUCAO.SEQ_NRMOVHIST_PAGAR.NEXTVAL@UNICOO_HOMOLOGA
        INTO THISTORICO_DO_TITULO_PAGAR.NRMOVIMENTO
        FROM DUAL;
      THISTORICO_DO_TITULO_PAGAR.CDMOVIMENTO   := '80';
      THISTORICO_DO_TITULO_PAGAR.CDFUNCIONARIO := 'CANCEMS';
      THISTORICO_DO_TITULO_PAGAR.DTMOVIMENTO   := SYSDATE;
      INSERT INTO HISTORICO_DO_TITULO_PAGAR
      VALUES THISTORICO_DO_TITULO_PAGAR;
    END;

  BEGIN
    -- busca o controle
    SELECT *
      INTO TTI_CONTROLE_INTEGRACAO
      FROM TI_CONTROLE_INTEGRACAO
     WHERE TPINTEGRACAO = 'CP'
       AND NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO;
    -- busca o cancelamento do titulo
    SELECT *
      INTO TTIT_CANCDO_APB
      FROM TIT_CANCDO_APB
     WHERE NUM_ID_TIT_AP = TTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM;
    -- busca o fornecedor do ems
    SELECT EFN.*
      INTO TFORNECEDOR_EMS
      FROM FORNECEDOR EFN, TI_EMPRESA EMP
     WHERE EFN.CDN_FORNECEDOR = TTIT_CANCDO_APB.CDN_FORNECEDOR
       AND EFN.COD_EMPRESA = EMP.COD_EMPRESA
       AND EMP.CDEMPRESA = F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
    SELECT *
      INTO TTI_TIT_APB
      FROM TI_TIT_APB M
     WHERE M.COD_TITULO_AP = TTIT_CANCDO_APB.COD_TIT_AP
       AND M.COD_ID_FEDER = TFORNECEDOR_EMS.COD_ID_FEDER
       AND M.CDSITUACAO = 'IT';
    INSERE_HISTORICO_80(TTI_TIT_APB.NRREGISTRO_TITULO);
    UPDATE TI_CONTROLE_INTEGRACAO
       SET CDSITUACAO = 'IT'
     WHERE NRSEQUENCIAL = TTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL;
  EXCEPTION
    WHEN OTHERS THEN
      P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                    'CP',
                    'Erro ao cancelar o titulo no unicoo',
                    SQLERRM,
                    VSIT);
  END;

  --========================--
  -- Controle de integrao --
  ----------------------------
  PROCEDURE P_TI_PROCESSA_INTEGRACAO(PTPINTEGRACAO    VARCHAR2,
                                     PNRSEQUENCIAL    NUMBER,
                                     PNRSESSAO        NUMBER,
                                     PCDIDENTIFICADOR VARCHAR2,
                                     PCDSITUACAO      IN OUT VARCHAR2) IS
  BEGIN
    IF PTPINTEGRACAO = 'TP' THEN
      --================--
      -- Titulo a pagar --
      --------------------
      P_TI_TIT_APB(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'CL' THEN
      --============--
      -- Cliente --
      ----------------
      P_TI_CLIENTE(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'FN' THEN
      --============--
      -- Fornecedor --
      ----------------
      P_TI_FORNECEDOR(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'TR' THEN
      --==================--
      -- Titulo a receber --
      ----------------------
      P_TI_TIT_ACR(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'FT' THEN
      --=============================--
      -- Cancelamento do faturamento --
      ---------------------------------
      P_TI_TIT_ACR_ESTORNO(PNRSEQUENCIAL,
                           PCDIDENTIFICADOR,
                           PCDSITUACAO,
                           PNRSESSAO);
    ELSIF PTPINTEGRACAO = 'CX' THEN
      --=============================--
      -- Caixa e Bancos              --
      ---------------------------------
      P_TI_MOVIMENTO_CTA_CORRENTE(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'CP' THEN
      --=============================--
      -- Titulo Cancelado no EMS     --
      ---------------------------------
      P_TIT_PAGAR_CANCELADO_EMS(PNRSEQUENCIAL);
    ELSIF PTPINTEGRACAO = 'BP' THEN
      EMS506UNICOO.PCK_BX_TIT_EMS.P_PROCESSA_APB(PNRSEQUENCIAL,
                                                 PNRSESSAO,
                                                 PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'BR' THEN
      EMS506UNICOO.PCK_BX_TIT_EMS.P_PROCESSA_ACR(PNRSEQUENCIAL,
                                                 PNRSESSAO,
                                                 PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'BC' THEN
      EMS506UNICOO.PCK_BX78_TIT_EMS.P_PROCESSA_ACR78(PNRSEQUENCIAL,
                                                     PNRSESSAO,
                                                     PCDSITUACAO);
    END IF;
  END;

  PROCEDURE P_TI_VALIDA_ENDERECO(PNRREGISTRO                IN NUMBER,
                                 PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                                 PCDINTEGRACAO              IN VARCHAR2,
                                 PCDSITUACAO                IN OUT VARCHAR2) IS
    VCDCIDADE ENDERECO.CDCIDADE%TYPE;
  BEGIN
    BEGIN
      ---------------------
      -- Verifica Endereco --
      ---------------------
      BEGIN
        SELECT CDCIDADE
          INTO VCDCIDADE
          FROM ENDERECO ED
         WHERE ED.NRREGISTRO = PNRREGISTRO
           AND ED.TPENDERECO = F_TI_TIP_ENDERECO(PNRREGISTRO);
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          -- Josias 03-07-2014
          --- pegar como default a cidade do endereço defaul
          SELECT CDCIDADE
            INTO VCDCIDADE
            FROM ENDERECO ED
           WHERE ED.NRREGISTRO = 10405
                --    F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO') VINICIUS NOVA IGUAÇU
             AND TPENDERECO = 'COBR';
          --  F_TI_TIP_ENDERECO(F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO'));
      END;
      BEGIN
        ---------------------
        -- Verifica Cidade --
        ---------------------
        SELECT CDCIDADE
          INTO VCDCIDADE
          FROM ENDERECO ED
         WHERE ED.NRREGISTRO = 10405
              -- F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO') VINICIUS NOVA IGUAÇU
           AND TPENDERECO = 'COBR';
        --  F_TI_TIP_ENDERECO(F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO'));
        SELECT CDCIDADE
          INTO VCDCIDADE
          FROM PRODUCAO.CIDADE@UNICOO_HOMOLOGA
         WHERE CDCIDADE = VCDCIDADE;
        PCDSITUACAO := 'RC';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        PCDINTEGRACAO,
                        'Cidade não cadastrada',
                        'Pessoa ==> ' || PNRREGISTRO || ' A Cidade ==> ' ||
                        VCDCIDADE || ' Não existe',
                        PCDSITUACAO,
                        NULL);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        PCDINTEGRACAO,
                        'Cidade no cadastrada',
                        'Pessoa ==> ' || PNRREGISTRO ||
                        ' Erro ao pesquisar cidade ' || SQLERRM,
                        PCDSITUACAO,
                        NULL);
      END;
    EXCEPTION
      /*
      when no_data_found then


                    p_grava_falha(pnrseq_controle_integracao,
                                  pCDIntegracao,
                                  'Endereo no cadastrado',
                                  'Pessoa ==> '||pnrregistro,
                                  pCDSituacao,
                                  null);
       */
      WHEN OTHERS THEN
        P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                      PCDINTEGRACAO,
                      'Erro ao validar o endereo',
                      'Erro ao pesquisar endereco ' || SQLERRM,
                      PCDSITUACAO,
                      NULL);
    END;
  END;

  --==================================--
  -- Grava Fornecedor - TI_FORNECEDOR --
  --------------------------------------
  PROCEDURE P_TI_FORNECEDOR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                            PNRSESSAO                  NUMBER,
                            PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_INTEGRA_CLIFOR IS
      SELECT CI.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
             CI.CDSITUACAO,
             CI.CDIDENTIFICADOR,
             CI.CDACAO,
             CI.NRSEQUENCIAL_ORIGEM
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'FN'
         AND CI.CDSITUACAO = PCDSITUACAO
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0);
    TTI_CONTROLE_INTEGRACAO TI_CONTROLE_INTEGRACAO%ROWTYPE;
    TFORNECEDOR             PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA%ROWTYPE;
    TGRUPO_DE_FORNECEDOR    GRUPO_DE_FORNECEDOR%ROWTYPE;
    TPESSOA                 PESSOA%ROWTYPE;
    TESTADO_CIVIL           ESTADO_CIVIL%ROWTYPE;
    TENDERECO               ENDERECO%ROWTYPE;
    TCIDADE                 PRODUCAO.CIDADE@UNICOO_HOMOLOGA%ROWTYPE;
    TTI_PESSOA              TI_PESSOA%ROWTYPE;
    TTI_GRUPO_DE_FORNECEDOR TI_GRUPO_DE_FORNECEDOR%ROWTYPE;
    TCDN_FORNECEDOR         TI_PESSOA.CDN_FORNECEDOR%TYPE;
  BEGIN
    FOR L_INTEGRA_CLIFOR IN C_INTEGRA_CLIFOR LOOP
      BEGIN
        PCDSITUACAO := 'RC';
        BEGIN
          SELECT *
            INTO TFORNECEDOR
            FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA
           WHERE CDFORNECEDOR = L_INTEGRA_CLIFOR.CDIDENTIFICADOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20100,
                                    'Forn. no unicoo nao encontrado: ' ||
                                    L_INTEGRA_CLIFOR.CDIDENTIFICADOR);
        END;
        BEGIN
          -----------------------------------------------------------------------
          -- Josias 01-07-2014 - Alteração para pegar o codigo do fornecedor do EMS
          -- que esta gravado na ti_pessoa e nao mais no fornecedor
          -----------------------------------------------------------------------
          SELECT P.CDN_FORNECEDOR
            INTO TCDN_FORNECEDOR
            FROM TI_PESSOA P
           WHERE P.NRREGISTRO = TFORNECEDOR.NRREGISTRO_FORNECEDOR;
        EXCEPTION
          WHEN OTHERS THEN
            RAISE_APPLICATION_ERROR(-20100,
                                    'Erro -> pessoa nao cadastrada para fornecedor na TI_PESSOA ' ||
                                    TFORNECEDOR.CDFORNECEDOR);
        END;
        BEGIN
          SELECT *
            INTO TGRUPO_DE_FORNECEDOR
            FROM GRUPO_DE_FORNECEDOR
           WHERE CDGRUPO_FORNECEDOR = TFORNECEDOR.CDGRUPO_FORNECEDOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20101,
                                    'Grupo do Forn. no unicoo nao encontrado: ' ||
                                    TFORNECEDOR.CDGRUPO_FORNECEDOR);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TPESSOA
            FROM PESSOA
           WHERE NRREGISTRO = TFORNECEDOR.NRREGISTRO_FORNECEDOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20102,
                                    'Cadastro de Pessoa do fornecor nao encontrado: ' ||
                                    L_INTEGRA_CLIFOR.CDIDENTIFICADOR);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TESTADO_CIVIL
            FROM ESTADO_CIVIL
           WHERE CDESTADOCIVIL = TPESSOA.CDESTADOCIVIL;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TENDERECO
            FROM ENDERECO
           WHERE NRREGISTRO = TPESSOA.NRREGISTRO
             AND TPENDERECO = F_TI_TIP_ENDERECO(TPESSOA.NRREGISTRO);
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            -- josias 29-06-2014
            -- coloquei para pegar o endereço da unimed como default
            SELECT *
              INTO TENDERECO
              FROM ENDERECO
             WHERE NRREGISTRO = 10405
                  --      F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO') VINICIUS NOVA IGUAÇU
               AND TPENDERECO = 'COBR';
            --     F_TI_TIP_ENDERECO(F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO'));
            --          raise_application_error(-20103,'Fornecedor sem endereco: '||l_integra_clifor.cdidentificador);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TCIDADE
            FROM PRODUCAO.CIDADE@UNICOO_HOMOLOGA
           WHERE CDCIDADE = TENDERECO.CDCIDADE;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            -- Josias 01-07-2014 - retirado esse erro, pois foi criado parametro para
            -- preenher o nome da cidades.
            --raise_application_error(-20104,'Cidade do fornecedor invalido: '||l_integra_clifor.cdidentificador);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TTI_GRUPO_DE_FORNECEDOR
            FROM TI_GRUPO_DE_FORNECEDOR
           WHERE CDGRUPO_FORNECEDOR =
                 TGRUPO_DE_FORNECEDOR.CDGRUPO_FORNECEDOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20104,
                                    'Grupo de fornecedor invalido: ' ||
                                    TGRUPO_DE_FORNECEDOR.CDGRUPO_FORNECEDOR);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TTI_PESSOA
            FROM TI_PESSOA
           WHERE NRREGISTRO = TPESSOA.NRREGISTRO;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20104,
                                    'Pessoa de integracao nao encontrado: ' ||
                                    TPESSOA.NRREGISTRO);
            NULL;
        END;

        IF TTI_GRUPO_DE_FORNECEDOR.COD_GRP_FORNECEDOR = 'NAOM' THEN

          NULL;

        ELSE

          INSERT INTO TI_FORNECEDOR
            (NRSEQ_CONTROLE_INTEGRACAO,
             NRSEQ_FAVORECIDO,
             CDSITUACAO,
             COD_ACAO,
             COD_AGENC_BCIA,
             COD_BANCO,
             COD_CEP,
             COD_CEP_PAGTO,
             COD_CTA_CORREN_BCO,
             COD_CX_POST,
             COD_CX_POST_PAGTO,
             COD_DIGITO_AGENC_BCIA,
             COD_DIGITO_CTA_CORREN,
             COD_E_MAIL,
             COD_EMPRESA,
             COD_FAX,
             COD_FORMA_PAGTO,
             COD_FORNECEDOR,
             COD_GRP_FORNECEDOR,
             COD_ID_ESTAD_FISIC,
             COD_ID_FEDER,
             COD_ID_FEDER_ESTAD_JURID,
             COD_ID_FEDER_JURID,
             COD_ID_FEDER_MATRIZ,
             COD_ID_FEDER_NASC,
             COD_ID_MUNIC_JURID,
             COD_ID_PREVID_SOCIAL,
             COD_ORG_EMIS_ID_ESTAD,
             COD_PAIS_NASC,
             COD_PORTAD_PREFER,
             COD_RAMAL_FAX,
             COD_TELEFONE_1,
             COD_TELEFONE_2,
             COD_TELEFONE_3,
             COD_TIP_FLUXO_FINANC,
             COD_TIP_FORNECEDOR,
             COD_UNID_FEDER,
             COD_UNID_FEDER_EMIS_ESTAD,
             COD_UNID_FEDER_PAGTO,
             DAT_ENVIO,
             DAT_IMPL_FORNECEDOR,
             DAT_NASCIMENTO,
             DAT_PROCESSAMENTO,
             DEST_ANOT_TABELA,
             IND_ESTADO_CIVIL,
             IND_OCORRENCIA,
             IND_TIPO_PESSOA,
             LOG_FINS_LUCRAT,
             NOM_ABREV,
             NOM_BAIRRO,
             NOM_BAIRRO_PAGTO,
             NOM_CIDADE,
             NOM_CIDADE_PAGTO,
             NOM_ENDER_COMPL,
             NOM_ENDER_COMPL_PAGTO,
             NOM_ENDERECO,
             NOM_ENDERECO_PAGTO,
             NOM_FORNECEDOR,
             NOM_HOME_PAGE,
             NOM_MAE,
             NOM_NACIONALIDADE,
             NOM_PROFISSAO,
             NRPESSOA)

          VALUES

            (L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO, -- nrseq_controle_integracao,
             0, --nrseq_favorecido,
             'RC', --cdsituacao,
             L_INTEGRA_CLIFOR.CDACAO, --cd cod_acao,
             ' ', --cod_agenc_bcia,
             ' ', --cod_banco,
             -- josias 29-06-2014
             -- coloquei o cep padrão de americana para evitar os erros.
             NVL(TENDERECO.NRCEP,
                 F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')), --cod_cep,
             NVL(TENDERECO.NRCEP,
                 F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')), --cod_cep_pagto,
             ' ', --cod_cta_corren_bco,
             ' ', --cod_cx_post,
             ' ', --cod_cx_post_pagto,
             ' ', --cod_digito_agenc_bcia,
             ' ', --cod_digito_cta_corren,
             nvl(substr(tendereco.cdemail_adicional,1,40),' '), --cod_e_mail,
             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA'), --cod_empresa,
             ' ', --cod_fax,
             F_TI_PARAMETRO_INTEGRACAO('COD_FORMA_PAGTO'), --cod_forma_pagto,
             TCDN_FORNECEDOR, --cod_fornecedor,
             TTI_GRUPO_DE_FORNECEDOR.COD_GRP_FORNECEDOR, -- cod_grp_fornecedor,
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_estad_fisic,
             CASE WHEN TPESSOA.NRCGC_CPF IS NOT NULL THEN TPESSOA.NRCGC_CPF WHEN
             TPESSOA.TPPESSOA = 'F' THEN
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_PESSOA_FISICA') ELSE
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_PESSOA_JURIDICA') END, --cod_id_feder,

             --F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_feder_estad_jurid,
             CASE WHEN TPESSOA.TPPESSOA = 'J' THEN
             NVL(TPESSOA.NRINSCEST_RG, 'ISENTO') ELSE ' ' END, --cod_id_feder_estad_jurid
             NVL(TPESSOA.NRCGC_CPF, ' '), --cod_id_feder_jurid,
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_feder_matriz,
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_feder_nasc,
             ' ', --cod_id_munic_jurid,
             ' ', --cod_id_previd_social,
             NVL(TPESSOA.NOORGAO_EMISSOR_RG, ' '), --cod_org_emis_id_estad,
             F_TI_PARAMETRO_INTEGRACAO('COD_PAIS'), --cod_pais_nasc,
             DECODE(TPESSOA.TPPESSOA,
                    'F',
                    F_TI_PARAMETRO_INTEGRACAO('COD_PORTAD_PREFER_PESSOA_FISICA'),
                    F_TI_PARAMETRO_INTEGRACAO('COD_PORTAD_PREFER_PESSOA_JURIDICA')), --cod_portad_prefer,
             ' ', --cod_ramal_fax,
             ' ', --cod_telefone_1,
             ' ', --cod_telefone_2,
             ' ', --cod_telefone_3,

             --           F_TI_PARAMETRO_INTEGRACAO('COD_TIP_FLUXO_FINANC_PREFER_FOR'), --cod_tip_fluxo_financ,
             DECODE(TPESSOA.TPPESSOA,
                    'F',
                    F_TI_PARAMETRO_INTEGRACAO('COD_TIP_FLUXO_FINANC_PREFER_FOR_F'),
                    F_TI_PARAMETRO_INTEGRACAO('COD_TIP_FLUXO_FINANC_PREFER_FOR_J')), --cod_tip_fluxo_financ,

             999, --cod_tip_fornecedor,
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_unid_feder,
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_unid_feder_emis_estad,
             ' ', --cod_unid_feder_pagto,
             SYSDATE, --dat_envio,
             F_TI_PARAMETRO_INTEGRACAO('DAT_IMPL_FORNECEDOR'), --dat_impl_fornecedor,
             TPESSOA.DTNASCIMENTO, --dat_nascimento,
             SYSDATE, --dat_processamento,
             ' ', --dest_anot_tabela,
             ' ', --ind_estado_civil,
             0, --ind_ocorrencia,
             TPESSOA.TPPESSOA, --ind_tipo_pessoa,
             'S', --log_fins_lucrat,
             TTI_PESSOA.NOABREVIADO_FORNECEDOR, --nom_abrev,
             -- josias 29-06-2014
             SUBSTR(NVL(TENDERECO.NOBAIRRO,
                        F_TI_PARAMETRO_INTEGRACAO('NOBAIRRO_DEFAULT_INCLUSAO')),
                    1,
                    20), --nom_bairro,
             SUBSTR(NVL(TENDERECO.NOBAIRRO,
                        F_TI_PARAMETRO_INTEGRACAO('NOBAIRRO_DEFAULT_INCLUSAO')),
                    1,
                    20), --nom_bairro_pagto,
             NVL(TRIM(TCIDADE.NOCIDADE),
                 F_TI_PARAMETRO_INTEGRACAO('NOCIDADE_DEFAULT_INCLUSAO')), --nom_cidade,
             NVL(TRIM(TCIDADE.NOCIDADE),
                 F_TI_PARAMETRO_INTEGRACAO('NOCIDADE_DEFAULT_INCLUSAO')), --nom_cidade_pagto,
             NVL(SUBSTR(TENDERECO.TXCOMPLEMENTO, 10), ' '), --nom_ender_compl,
             SUBSTR(TENDERECO.NOLOGRADOURO, 1, 10), --nom_ender_compl_pagto,
             /*
             nvl2(replace(replace(replace(tendereco.nologradouro, ' ',''),',',''),'.',''),
             f_abrevia_nome(trim(tendereco.nologradouro)||decode(tendereco.nrimovel,null,null,','||
                            tendereco.nrimovel),40,'PEA')
                   ,'Sem Endereco'),                         --nom_endereco,
             */
             NVL(TRIM(F_ABREVIA_NOME(TRANSLATE(TENDERECO.NOLOGRADOURO,
                                               '0123456789,.;:]',
                                               '              ') ||
                                     DECODE(TENDERECO.NRIMOVEL,
                                            NULL,
                                            NULL,
                                            ',' || TENDERECO.NRIMOVEL),
                                     40,
                                     'PEA')),
                 'Sem Endereco'), --nom_endereco,
             NVL(TRIM(TENDERECO.NOLOGRADOURO), 'Sem endereço'), --nom_endereco_pagto,
             SUBSTR(TPESSOA.NOPESSOA, 1, 40), --nom_fornecedor,
             ' ', --nom_home_page,
             -- Josias - 29-06-2014
             -- coloquei o truncamento pos estava estourando masi de 40 posições.
             SUBSTR(TPESSOA.NOMAE, 1, 40), --nom_mae,
             F_TI_PARAMETRO_INTEGRACAO('NOM_NACIONALIDADE'), --nom_nacionalidade,
             NULL, --nom_profissao,
             TFORNECEDOR.NRREGISTRO_FORNECEDOR --nrpessoa
             );

          IF SQL%ROWCOUNT = 0 THEN
            P_TI_VALIDA_ENDERECO(L_INTEGRA_CLIFOR.NRSEQUENCIAL_ORIGEM,
                                 L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                                 'TI_FORNECEDOR',
                                 PCDSITUACAO);
            IF PCDSITUACAO = 'RC' THEN
              P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                            'TI_FORNECEDOR',
                            'A VIEW V_TI_FORNECEDOR NO ENCONTROU FORNECEDOR PARA O PROCESSO ==>' ||
                            L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO ||
                            'Pessoa ==>' ||
                            L_INTEGRA_CLIFOR.NRSEQUENCIAL_ORIGEM ||
                            'Fornecedor ==> ' ||
                            L_INTEGRA_CLIFOR.CDIDENTIFICADOR,
                            NULL,
                            PCDSITUACAO,
                            NULL);
            END IF;
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                        'TI_FORNECEDOR',
                        'O Fornecedor j foi enviado para a TI_FORNECEDOR',
                        NULL,
                        PCDSITUACAO,
                        -1);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        'TI_FORNECEDOR',
                        'Falha:  ' || SQLERRM,
                        ' Processo ==> ' ||
                        L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO ||
                        '  Pessoa ==> ' ||
                        L_INTEGRA_CLIFOR.NRSEQUENCIAL_ORIGEM ||
                        '  Fornecedor ==> ' ||
                        L_INTEGRA_CLIFOR.CDIDENTIFICADOR,
                        PCDSITUACAO,
                        NULL);
      END;

      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  --===============================--
  -- Grava Titulo - TI_TIT_ACR --
  -----------------------------------
  PROCEDURE P_TI_TIT_ACR_ESTORNO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PNRDOCUMENTO               VARCHAR2,
                                 PCDSITUACAO                IN OUT VARCHAR2,
                                 PNRSESSAO                  NUMBER) IS
    CURSOR C_FATURA IS
      SELECT CI.*, FT.DTCANCELAMENTO
        FROM TI_CONTROLE_INTEGRACAO CI, FATURAMENTO FT
       WHERE CI.TPINTEGRACAO = 'FT'
         AND FT.NRFATURA = CI.CDIDENTIFICADOR
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND CDSITUACAO = 'VD'
         AND CI.NRSESSAO = PNRSESSAO;
    CURSOR C_EMS(PNRDOCUMENTO VARCHAR2) IS
      SELECT EMS.NUM_ID_TIT_ACR, EMS.NRDOCUMENTO
        FROM EMS_MOVIMENTO_TITULO_ACR EMS, TITULO_A_RECEBER TR, TIT_ACR TA
       WHERE TA.U##COD_ESTAB = EMS.COD_ESTAB
         AND TA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
         AND TR.NRDOCUMENTO = PNRDOCUMENTO
         AND TR.NRDOCUMENTO = EMS.NRDOCUMENTO
         AND EMS.NRREGISTRO_TITULO = TR.NRREGISTRO_TITULO
         AND EMS.IND_TRANS_ACR_ABREV = 'IMPL'
         AND TA.LOG_TIT_ACR_ESTORDO = 0;
    VCDINTEGRACAO    VARCHAR2(100);
    VCOD_ESPEC_DOCTO TI_TIPO_MOVIMENTO_TIT_ACR.COD_ESPEC_DOCTO%TYPE;
    VAOACHOU         BOOLEAN;
  BEGIN
    VCDINTEGRACAO := 'TI_TIT_ACR_ESTORNO';
    PCDSITUACAO   := 'ER';
    FOR L_FATURA IN C_FATURA LOOP
      VAOACHOU := FALSE;
      FOR L_EMS IN C_EMS(L_FATURA.CDIDENTIFICADOR) LOOP
        PCDSITUACAO := 'RC';
        VAOACHOU    := TRUE;
        BEGIN
          INSERT INTO TI_TIT_ACR_ESTORNO
            (NRSEQ_CONTROLE_INTEGRACAO,
             CDSITUACAO,
             NRDOCUMENTO,
             COD_ESTAB,
             COD_ESPEC_DOCTO,
             COD_SER_DOCTO,
             COD_TIT_ACR,
             COD_PARCELA,
             COD_TIT_ACR_BCO,
             COD_REFER,
             NUM_ID_MOVTO_TIT_ACR,
             NUM_ID_TIT_ACR,
             COD_PORTADOR,
             DAT_TRANSACAO,
             DAT_ENVIO,
             CDN_CLIENTE,
             DAT_PROCESSAMENTO,
             IND_NIV_OPERAC_ACR,
             IND_TIP_OPERAC_ACR)
            SELECT L_FATURA.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
                   CDSITUACAO,
                   L_FATURA.CDIDENTIFICADOR NRDOCUMENTO,
                   COD_ESTAB,
                   COD_ESPEC_DOCTO,
                   COD_SER_DOCTO,
                   COD_TIT_ACR,
                   COD_PARCELA,
                   COD_TIT_ACR_BCO,
                   'E' || LPAD(L_FATURA.NRSEQUENCIAL, 9, '0'),
                   NUM_ID_MOVTO_TIT_ACR,
                   NUM_ID_TIT_ACR,
                   COD_PORTADOR,
                   L_FATURA.DTCANCELAMENTO DAT_TRANSACAO,
                   DAT_ENVIO,
                   CDN_CLIENTE,
                   DAT_PROCESSAMENTO,
                   IND_NIV_OPERAC_ACR,
                   IND_TIP_OPERAC_ACR
              FROM V_TI_TIT_ACR_ESTORNO TA
             WHERE TA.NUM_ID_TIT_ACR = L_EMS.NUM_ID_TIT_ACR;
          IF SQL%ROWCOUNT = 0 THEN
            P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Dados no encontrados na V_ti_tit_acr_estorno PARA O PROCESSO ' ||
                          L_FATURA.NRSEQUENCIAL || ' Especie: ' ||
                          VCOD_ESPEC_DOCTO || ' Srie: ' ||
                          SUBSTR(L_FATURA.CDIDENTIFICADOR, 1, 2) ||
                          'Titulo :' ||
                          SUBSTR(L_FATURA.CDIDENTIFICADOR,
                                 INSTR(L_FATURA.CDIDENTIFICADOR, '-') + 1,
                                 12),
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        EXCEPTION
          WHEN DUP_VAL_ON_INDEX THEN
            P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'A fatura j foi enviada para estorno. Processo ==>' ||
                          L_FATURA.NRSEQUENCIAL,
                          NULL,
                          PCDSITUACAO,
                          -1);
          WHEN OTHERS THEN
            P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Erro ao enviar fatura para cancelamento. Processo ==>' ||
                          L_FATURA.NRSEQUENCIAL || ' ' || SQLERRM,
                          NULL,
                          PCDSITUACAO,
                          NULL);
        END;
        --====================================--
        -- Atualizar o situao da integrao --
        ----------------------------------------
        P_UPDATE_CONTROLE_INTEGRACAO(L_FATURA.NRSEQUENCIAL,
                                     PCDSITUACAO,
                                     NULL);
      END LOOP;
      IF NOT VAOACHOU THEN
        P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                      VCDINTEGRACAO,
                      'O titulo no EMS5==> ' || L_FATURA.CDIDENTIFICADOR || ' ' ||
                      L_FATURA.NRSEQUENCIAL || ' ' || SQLERRM,
                      NULL,
                      PCDSITUACAO,
                      NULL);
      END IF;
      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_FATURA.NRSEQUENCIAL,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
    -- Alessandro 19/03/2012
    FOR XX IN (SELECT T.NRDOCUMENTO,
                      T.NUM_ID_TIT_ACR,
                      MT.LOG_APROP_CTBL_CTBZDA,
                      T.NRSEQ_CONTROLE_INTEGRACAO
                 FROM TI_TIT_ACR_ESTORNO T, TIT_ACR TA, MOVTO_TIT_ACR MT
                WHERE MT.U##COD_ESTAB = TA.U##COD_ESTAB
                  AND MT.NUM_ID_TIT_ACR = TA.NUM_ID_TIT_ACR
                  AND MT.IND_TRANS_ACR_ABREV = 'IMPL'
                  AND TA.NUM_ID_TIT_ACR = T.NUM_ID_TIT_ACR
                  AND T.CDSITUACAO IN ('ER', 'RC')
               --and mt.LOG_APROP_CTBL_CTBZDA = 1
               ) LOOP
      IF XX.LOG_APROP_CTBL_CTBZDA = 1 THEN
        UPDATE TI_TIT_ACR_ESTORNO Q
           SET Q.CDSITUACAO = 'RC'
         WHERE Q.NRSEQ_CONTROLE_INTEGRACAO = XX.NRSEQ_CONTROLE_INTEGRACAO;
        P_UPDATE_CONTROLE_INTEGRACAO(XX.NRSEQ_CONTROLE_INTEGRACAO,
                                     'RC',
                                     '');
      ELSE
        UPDATE TI_TIT_ACR_ESTORNO Q
           SET Q.CDSITUACAO = 'ER'
         WHERE Q.NRSEQ_CONTROLE_INTEGRACAO = XX.NRSEQ_CONTROLE_INTEGRACAO;
        P_UPDATE_CONTROLE_INTEGRACAO(XX.NRSEQ_CONTROLE_INTEGRACAO,
                                     'ER',
                                     'Titulo nao CTBL EMS5');
        P_GRAVA_FALHA(XX.NRSEQ_CONTROLE_INTEGRACAO,
                      'FAT_CANCEL',
                      'Fatura Cancelada no Unicoo, e n?o CTBLZ no EMS5',
                      'Contabilize o ACR no EMS5',
                      PCDSITUACAO,
                      NULL);
      END IF;
    END LOOP;
    -- Alessandro 19/03/2012
  END;

  --===============================--
  -- Grava Titulo - TI_TIT_ACR --
  -----------------------------------
  PROCEDURE P_TI_TIT_ACR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_TRATA_FALHA IS
      SELECT DISTINCT UCL.CDCLIENTE,
                      TIP.CDN_CLIENTE,
                      UCL.NRREGISTRO_CLIENTE,
                      CI.CDEMPRESA,
                      CI.CDMODULO,
                      CI.CDMOVIMENTO,
                      ECL.COD_GRP_CLIEN,
                      (SELECT COUNT(*)
                         FROM ENDERECO ED
                        WHERE ED.NRREGISTRO = UCL.NRREGISTRO_CLIENTE) QTENDERECO,
                      F_TI_TIP_MOVTO_TIT_ACR(CI.CDEMPRESA,
                                             CI.CDMODULO,
                                             CI.CDMOVIMENTO,
                                             ECL.COD_GRP_CLIEN) NUM_TIP_MOVTO_TIT_ACR
        FROM TITULO_A_RECEBER                 TR,
             TI_CONTROLE_INTEGRACAO           CI,
             PRODUCAO.CLIENTE@UNICOO_HOMOLOGA UCL,
             CLIENTE                          ECL,
             TI_PESSOA                        TIP,
             TI_EMPRESA                       EMP
       WHERE ECL.CDN_CLIENTE(+) = TIP.CDN_CLIENTE
         AND CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO
         AND TR.NRREGISTRO_TITULO = CI.NRSEQUENCIAL_ORIGEM
         AND TIP.NRREGISTRO(+) = UCL.NRREGISTRO_CLIENTE
         AND TR.CDCLIENTE = UCL.CDCLIENTE
         AND CI.CDEMPRESA = EMP.CDEMPRESA
         AND NVL(ECL.COD_EMPRESA, EMP.COD_EMPRESA) = EMP.COD_EMPRESA;
    CURSOR C_TITULOS IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TR'
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
            --and cdsituacao = 'VD'
         AND CI.NRSESSAO = PNRSESSAO;
    VCDINTEGRACAO  VARCHAR2(100);
    VAO_ACHOU_ERRO BOOLEAN;
  BEGIN
    FOR L_TITULOS IN C_TITULOS LOOP
      BEGIN
        PCDSITUACAO   := 'RC';
        VCDINTEGRACAO := 'TI_TIT_ACR';
        INSERT INTO TI_TIT_ACR
          (COD_ESTAB,
           COD_TITULO_ACR,
           VAL_IR,
           DAT_DESCONTO,
           VAL_LIQ_TITULO,
           DES_TEXT_HISTOR,
           IND_OCORRENCIA,
           NRSEQ_CONTROLE_INTEGRACAO,
           IND_TIPO_PESSOA,
           COD_ID_FEDER_JURID,
           COD_ID_FEDER,
           COD_ESPEC_DOCTO,
           COD_PARCELA,
           DAT_EMISSAO,
           DAT_VENCTO,
           DAT_PREVISAO_LIQUIDAC,
           VAL_TITULO,
           COD_CART_BCIA,
           DAT_PROCESSAMENTO,
           COD_EMPRESA,
           COD_TIP_FLUXO_FINANC,
           COD_PAIS,
           COD_CTA_CTBL,
           COD_CCUSTO,
           VAL_DESCONTO,
           COD_TIT_ACR_BCO,
           COD_PORTADOR,
           COD_SER_DOCTO,
           IND_TIP_ESPEC_DOCTO,
           CDSITUACAO,
           COD_CLIENTE,
           NRPESSOA,
           COD_PLANO_CCUSTO,
           COD_PLANO_CTA_CTBL,
           VAL_PERC_JUROS_DIA_ATRASO,
           VAL_PERC_MULTA_ATRASO)
          SELECT COD_ESTAB,
                 COD_TITULO_ACR,
                 VAL_IR,
                 DAT_DESCONTO,
                 VAL_LIQ_TITULO,
                 DES_TEXT_HISTOR,
                 IND_OCORRENCIA,
                 NRSEQ_CONTROLE_INTEGRACAO,
                 IND_TIPO_PESSOA,
                 COD_ID_FEDER_JURID,
                 COD_ID_FEDER,
                 COD_ESPEC_DOCTO,
                 COD_PARCELA,
                 DAT_EMISSAO,
                 DAT_VENCTO,
                 DAT_PREVISAO_LIQUIDAC,
                 VAL_TITULO,
                 COD_CART_BCIA,
                 DAT_PROCESSAMENTO,
                 COD_EMPRESA,
                 COD_TIP_FLUXO_FINANC,
                 COD_PAIS,
                 COD_CTA_CTBL,
                 COD_CCUSTO,
                 VAL_DESCONTO,
                 COD_TIT_ACR_BCO,
                 COD_PORTADOR,
                 COD_SER_DOCTO,
                 IND_TIP_ESPEC_DOCTO,
                 CDSITUACAO,
                 COD_CLIENTE,
                 NRPESSOA,
                 COD_PLANO_CCUSTO,
                 COD_PLANO_CTA_CTBL,
                 0                         VAL_PERC_JUROS_DIA_ATRASO,
                 0                         VAL_PERC_MULTA_ATRASO
            FROM V_TI_TIT_ACR TIT
           WHERE TIT.NRSEQ_CONTROLE_INTEGRACAO = L_TITULOS.NRSEQUENCIAL;
        IF SQL%ROWCOUNT = 0 THEN
          VAO_ACHOU_ERRO := FALSE;
          /* p_grava_falha(l_titulos.nrsequencial,
          vCDIntegracao,
          'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
          l_titulos.nrsequencial,
          'A view V_TI_TIT_ACR nao encontrou registro',
          pCDSituacao,
          null);*/
          FOR L_TRATA_FALHA IN C_TRATA_FALHA LOOP
            VAO_ACHOU_ERRO := TRUE;
            IF L_TRATA_FALHA.CDN_CLIENTE IS NULL THEN
              -- Fazer a geração do Cliente para poder reprocessar o titulo depois
              ------------------------------------------------------------------------
              P_INSERE_CLIENTE(L_TITULOS.NRSEQUENCIAL_ORIGEM);
              ------------------------------------------------------------------------
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            'Falta integrar o cliente ' ||
                            L_TRATA_FALHA.CDN_CLIENTE || ' para o ',
                            PCDSITUACAO,
                            NULL);
            ELSIF L_TRATA_FALHA.QTENDERECO IS NULL THEN
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            'O Cliente ' || L_TRATA_FALHA.CDCLIENTE ||
                            ' nao foi integrado para o EMS5, o cliente no possui endereco no Unicoo.',
                            PCDSITUACAO,
                            NULL);
            ELSIF L_TRATA_FALHA.NUM_TIP_MOVTO_TIT_ACR = '-1' THEN
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            ' Tipo de movimento no cadastrado em TI_TIPO_MOVIMENTO_TIT_ACR, parametros informados: ' ||
                            ' Cdigo da Empresa: ' ||
                            L_TRATA_FALHA.CDEMPRESA || ' Cdigo do mdulo: ' ||
                            L_TRATA_FALHA.CDMODULO ||
                            ' Cdigo do movimento: ' ||
                            L_TRATA_FALHA.CDMOVIMENTO ||
                            ' Grupo de cliente no EMS5: ' ||
                            L_TRATA_FALHA.COD_GRP_CLIEN ||
                            ' Cdigo de cliente no EMS5: ' ||
                            L_TRATA_FALHA.CDN_CLIENTE,
                            PCDSITUACAO,
                            NULL);
            ELSE
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            NULL,
                            PCDSITUACAO,
                            NULL);
            END IF;
          END LOOP;
          IF VAO_ACHOU_ERRO = FALSE THEN
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                          L_TITULOS.NRSEQUENCIAL ||
                          '. Titulo ou cliente no existe no Unicoo',
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        ELSE
          VCDINTEGRACAO := 'TI_TIT_ACR_CTBL';
          INSERT INTO TI_TIT_ACR_CTBL CTB
            (VAL_APROP_CTBL,
             COD_ESTAB,
             COD_CTA_CTBL,
             COD_UNID_FEDERAC,
             COD_TIP_FLUXO_FINANC,
             NRSEQ_CONTROLE_INTEGRACAO,
             CDSITUACAO,
             COD_CCUSTO,
             DAT_PROCESSAMENTO)
            (SELECT VAL_APROP_CTBL,
                    COD_ESTAB,
                    COD_CTA_CTBL,
                    COD_UNID_FEDERAC,
                    COD_TIP_FLUXO_FINANC,
                    NRSEQ_CONTROLE_INTEGRACAO,
                    CDSITUACAO,
                    COD_CCUSTO,
                    DAT_PROCESSAMENTO
               FROM V_TI_TIT_ACR_CTBL CTB
              WHERE CTB.NRSEQ_CONTROLE_INTEGRACAO = L_TITULOS.NRSEQUENCIAL);
          IF SQL%ROWCOUNT = 0 THEN
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'A view V_ti_TIT_ACR_ctbl no encontrou registro para o processo ==>' ||
                          L_TITULOS.NRSEQUENCIAL,
                          NULL,
                          PCDSITUACAO,
                          NULL);
          ELSE
            VCDINTEGRACAO := 'TI_TIT_ACR_CTBL_IMPOSTO';
            INSERT INTO TI_TIT_ACR_IMPOSTO
              (COD_SER_DOCTO,
               IND_CLAS_IMPTO,
               VAL_RENDTO_TRIBUT,
               VAL_ALIQ_IMPTO,
               COD_ESTAB,
               COD_ESPEC_DOCTO,
               COD_PARCELA,
               COD_UNID_FEDERAC,
               COD_IMPOSTO,
               COD_CLASSIF_IMPTO,
               VAL_IMPOSTO,
               DAT_PROCESSAMENTO,
               CDSITUACAO,
               NRSEQ_CONTROLE_INTEGRACAO,
               IND_OCORRENCIA)
              (SELECT COD_SER_DOCTO,
                      IND_CLAS_IMPTO,
                      VAL_RENDTO_TRIBUT,
                      VAL_ALIQ_IMPTO,
                      COD_ESTAB,
                      COD_ESPEC_DOCTO,
                      COD_PARCELA,
                      COD_UNID_FEDERAC,
                      COD_IMPOSTO,
                      COD_CLASSIF_IMPTO,
                      VAL_IMPOSTO,
                      DAT_PROCESSAMENTO,
                      CDSITUACAO,
                      NRSEQ_CONTROLE_INTEGRACAO,
                      IND_OCORRENCIA
                 FROM V_TI_TIT_ACR_IMPOSTO IP
                WHERE IP.NRSEQ_CONTROLE_INTEGRACAO =
                      PNRSEQ_CONTROLE_INTEGRACAO);
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                        VCDINTEGRACAO,
                        'Titulo ja enviado. Processo ==>' ||
                        L_TITULOS.NRSEQUENCIAL,
                        NULL,
                        PCDSITUACAO,
                        -1);
          /*   when others then
          p_grava_falha(l_titulos.nrsequencial,
                          vCDIntegracao,
                          sqlerrm,
                          null,
                          pcdsituacao,
                          null);*/

          P_COMMIT;

      END;

      P_COMMIT;

      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_TITULOS.NRSEQUENCIAL,
                                   PCDSITUACAO,
                                   NULL);
      --=====================================--
      -- Titulo de Cooperados n?o trata falha,
      -- apenas cancela...
      -----------------------------------------
      IF SUBSTR(L_TITULOS.CDIDENTIFICADOR, 1, 3) = '9956-' THEN
        --braz
        P_UPDATE_CONTROLE_INTEGRACAO(L_TITULOS.NRSEQUENCIAL, --comentado emmaio de 2013 para tratar via arquivo gerado para baixa em lote pelo ems5
                                     'CA',
                                     NULL);
      END IF;
    END LOOP;
  END;

  --============================================--
  -- Grava Titulo a pagar - TI_TIT_APB      --
  --                        TI_TIT_APB_CTBL --
  ------------------------------------------------
  PROCEDURE P_TI_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_TRATA_FALHA IS
      SELECT DISTINCT EFN.CDN_FORNECEDOR CDFORNECEDOR,
                      TIP.CDN_FORNECEDOR CDFORNECEDOR_EMS5,
                      UFN.NRREGISTRO_FORNECEDOR,
                      CI.CDIDENTIFICADOR,
                      CI.CDEMPRESA,
                      CI.CDMODULO,
                      CI.CDMOVIMENTO,
                      EFN.CDN_FORNECEDOR,
                      EFN.COD_GRP_FORNEC,
                      CI.CDDIVISAO,
                      (SELECT COUNT(*)
                         FROM ENDERECO ED
                        WHERE ED.NRREGISTRO = UFN.NRREGISTRO_FORNECEDOR) QTENDERECO,
                      F_TI_TIP_MOVTO_TIT_APB(CI.CDEMPRESA,
                                             CI.CDMODULO,
                                             CI.CDMOVIMENTO,
                                             EFN.COD_GRP_FORNEC,
                                             CI.CDDIVISAO,
                                             CI.CDCENTRO_CUSTO) NUM_TIP_MOVTO_TIT_APB,
                      PE.NOPESSOA NOFORNECEDORUNICOO
        FROM TITULO_A_PAGAR                      TP,
             TI_CONTROLE_INTEGRACAO              CI,
             PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA UFN,
             PESSOA                              PE,
             FORNECEDOR                          EFN,
             TI_PESSOA                           TIP,
             TI_EMPRESA                          EMP
       WHERE CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO
         AND TP.NRREGISTRO_TITULO = CI.NRSEQUENCIAL_ORIGEM
         AND TP.CDFORNECEDOR = UFN.CDFORNECEDOR
         AND UFN.NRREGISTRO_FORNECEDOR = PE.NRREGISTRO
         AND TIP.NRREGISTRO = UFN.NRREGISTRO_FORNECEDOR
         AND EFN.CDN_FORNECEDOR = TIP.CDN_FORNECEDOR
         AND EFN.COD_EMPRESA = EMP.COD_EMPRESA
         AND EMP.CDEMPRESA =
             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
    CURSOR C_TITULOS IS
      SELECT CI.*
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TP'
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND CI.NRSESSAO = PNRSESSAO;
    VCDINTEGRACAO           VARCHAR2(100);
    VAO_ACHOU_ERRO          BOOLEAN;
    RTI_TIT_APB_CTBL        TI_TIT_APB_CTBL%ROWTYPE;
    RTI_CONTROLE_INTEGRACAO TI_CONTROLE_INTEGRACAO%ROWTYPE;
    RFORNECEDOR             EMS506UNICOO.TI_PESSOA%ROWTYPE;
    RFORNECEDOR_EMS         FORNECEDOR%ROWTYPE;
    VCOD_ESTAB              TI_TIPO_MOVIMENTO_TIT_APB.CDDIVISAO%TYPE;
    HAFALHA                 BOOLEAN;
  BEGIN
    FOR L_TITULOS IN C_TITULOS LOOP
      BEGIN
        HAFALHA       := FALSE;
        VCDINTEGRACAO := 'TI_TIT_APB';
        -- tratativas de erro
        BEGIN
          SELECT *
            INTO RTI_CONTROLE_INTEGRACAO
            FROM TI_CONTROLE_INTEGRACAO
           WHERE NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            HAFALHA := TRUE;
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Controle integracão não encontrado',
                          NULL,
                          PCDSITUACAO,
                          NULL);
        END;
        BEGIN
          SELECT B.*
            INTO RFORNECEDOR
            FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA A,
                 EMS506UNICOO.TI_PESSOA              B
           WHERE A.NRREGISTRO_FORNECEDOR = B.NRREGISTRO
             AND CDFORNECEDOR =
                 (SELECT FO.CDFORNECEDOR
                    FROM TITULO_A_PAGAR                      TP,
                         PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FO
                   WHERE FO.CDFORNECEDOR = TP.CDFORNECEDOR
                     AND TP.NRREGISTRO_TITULO =
                         RTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM);
          IF RFORNECEDOR.CDN_FORNECEDOR IS NULL THEN
            -- Fazer a geração do fornecedor para poder reprocessar o titulo depois
            ------------------------------------------------------------------------
            P_INSERE_FORNECEDOR(RTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM);
            ------------------------------------------------------------------------
          END IF;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            -- Fazer a geração do fornecedor para poder reprocessar o titulo depois
            ------------------------------------------------------------------------
            P_INSERE_FORNECEDOR(RTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM);
            ------------------------------------------------------------------------
            HAFALHA := TRUE;
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Fornecedor não integrado com TOTVS11, aguardar a integração do fornecedor !! ',
                          NULL,
                          PCDSITUACAO,
                          NULL);
        END;
        IF L_TITULOS.CDDIVISAO IS NOT NULL THEN
          BEGIN
            SELECT ET.COD_ESTAB
              INTO VCOD_ESTAB
              FROM TI_ESTABELECIMENTO ET
             WHERE ET.CDDIVISAO = L_TITULOS.CDDIVISAO;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              HAFALHA := TRUE;
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'Falta o De-Para do unicoo para a Divisão [' ||
                            L_TITULOS.CDDIVISAO ||
                            ' ] na tabela TI_ESTABELECIMENTO ',
                            'Empresa[' || L_TITULOS.CDEMPRESA || '] ' ||
                            'Modulo[' || L_TITULOS.CDMODULO || '] ' ||
                            'Movimento[' ||
                            RPAD(L_TITULOS.CDMOVIMENTO, 5, ' ') || '] ' ||
                            'Divisão [' || L_TITULOS.CDDIVISAO || '] ' ||
                            'Verifique na tabela de vinculo , qual é o estabelecimento para a divisão ' ||
                            L_TITULOS.CDDIVISAO,
                            PCDSITUACAO,
                            NULL);
          END;
        END IF;
        BEGIN
          SELECT EFN.*
            INTO RFORNECEDOR_EMS
            FROM FORNECEDOR EFN, TI_EMPRESA EMP
           WHERE CDN_FORNECEDOR = RFORNECEDOR.CDN_FORNECEDOR
             AND EFN.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            HAFALHA := TRUE;
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Fornecedor do ems não encontrado. _ ',
                          'Registro do Fornecedor no uicoo: ' ||
                          RFORNECEDOR.NRREGISTRO,
                          PCDSITUACAO,
                          NULL);
        END;
        -- colocado por fabiano
        IF NOT HAFALHA THEN
          PCDSITUACAO   := 'RC';
          VCDINTEGRACAO := 'TI_TIT_APB';
          BEGIN
            INSERT INTO TI_TIT_APB
              (COD_TITULO_AP,
               VAL_PER_DESC,
               COD_CART_BCIA,
               DAT_PROCESSAMENTO,
               COD_TIP_FLUXO_FINANC,
               CDN_FORNECEDOR,
               QTD_PARCELA,
               IND_TIPO_PESSOA,
               COD_SER_DOCTO,
               COD_PARCELA,
               VAL_DESCONTO,
               DES_TEXT_HISTOR,
               CDSITUACAO,
               COD_CCUSTO,
               COD_ID_FEDER_JURID,
               COD_ESPEC_DOCTO,
               DAT_EMISSAO,
               DAT_VENCTO,
               DAT_PREVISAO_PAGTO,
               DAT_DESCONTO,
               VAL_TITULO,
               NUM_DIAS_ATRASO,
               VAL_JUROS,
               VAL_PERC_JUROS_DIA_ATRASO,
               VAL_PERC_MULTA_ATRASO,
               COD_PORTADOR,
               COD_FORMA_PAGTO,
               COD_EMPRESA,
               COD_ESTAB,
               NRSEQ_CONTROLE_INTEGRACAO,
               COD_ID_FEDER,
               IND_OCORRENCIA,
               NRREGISTRO_TITULO,
               NRPESSOA,
               COD_PLANO_CCUSTO,
               COD_PLANO_CTA_CTBL)
              SELECT COD_TITULO_AP,
                     VAL_PER_DESC,
                     COD_CART_BCIA,
                     DAT_PROCESSAMENTO,
                     COD_TIP_FLUXO_FINANC,
                     CDFORNECEDOR_EMS5,
                     QTD_PARCELA,
                     IND_TIPO_PESSOA,
                     COD_SER_DOCTO,
                     COD_PARCELA,
                     VAL_DESCONTO,
                     DES_TEXT_HISTOR,
                     CDSITUACAO,
                     COD_CCUSTO,
                     COD_ID_FEDER COD_ID_FEDER_JURID,
                     COD_ESPEC_DOCTO,
                     DAT_EMISSAO,
                     DAT_VENCTO,
                     DAT_PREVISAO_PAGTO,
                     DAT_DESCONTO,
                     VAL_BRUTO,
                     NUM_DIAS_ATRASO,
                     VAL_JUROS,
                     VAL_PERC_JUROS_DIA_ATRASO,
                     VAL_PERC_MULTA_ATRASO,
                     COD_PORTADOR,
                     COD_FORMA_PAGTO,
                     COD_EMPRESA,
                     COD_ESTAB,
                     NRSEQ_CONTROLE_INTEGRACAO,
                     COD_ID_FEDER,
                     IND_OCORRENCIA,
                     NRREGISTRO_TITULO,
                     NRPESSOA,
                     COD_PLANO_CCUSTO,
                     COD_PLANO_CTA_CTBL
                FROM V_TI_TIT_APB TIT
               WHERE TIT.NRSEQ_CONTROLE_INTEGRACAO =
                     PNRSEQ_CONTROLE_INTEGRACAO;
          EXCEPTION
            WHEN OTHERS THEN
              RAISE_APPLICATION_ERROR(-20100, 'Erro -> ' || SQLERRM);
          END;
          IF SQL%ROWCOUNT = 0 THEN
            VAO_ACHOU_ERRO := FALSE;
            FOR L_TRATA_FALHA IN C_TRATA_FALHA LOOP
              VAO_ACHOU_ERRO := TRUE;
              IF L_TRATA_FALHA.CDFORNECEDOR_EMS5 IS NULL THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              'O Fornecedor [' ||
                              L_TRATA_FALHA.CDFORNECEDOR || '] ' ||
                              L_TRATA_FALHA.NOFORNECEDORUNICOO ||
                              ' no foi integrado para o EMS5',
                              PCDSITUACAO,
                              NULL);
              ELSIF L_TRATA_FALHA.CDEMPRESA IS NULL THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              'A empresa do unicoo no foi informada para o titulo: ' ||
                              L_TRATA_FALHA.CDIDENTIFICADOR,
                              PCDSITUACAO,
                              NULL);
              ELSIF L_TRATA_FALHA.QTENDERECO IS NULL THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              'O Fornecedor [' ||
                              L_TRATA_FALHA.CDFORNECEDOR || '] ' ||
                              L_TRATA_FALHA.NOFORNECEDORUNICOO ||
                              ' no foi integrado para o EMS5, o Fornecedor no possui endereo no Unicoo.',
                              PCDSITUACAO,
                              NULL);
              ELSIF L_TRATA_FALHA.NUM_TIP_MOVTO_TIT_APB = -1 THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'Verifique o De-Para do unicoo para o ems5 para o processo [' ||
                              L_TITULOS.NRSEQUENCIAL || ']',
                              --' Tipo de movimento no cadastrado em TI_TIPO_MOVIMENTO_TIT_ACR, parametros informados: '||
                              'Empresa[' || L_TRATA_FALHA.CDEMPRESA || '] ' ||
                              'Modulo[' || L_TRATA_FALHA.CDMODULO || '] ' ||
                              'Movimento[' ||
                              RPAD(L_TRATA_FALHA.CDMOVIMENTO, 5, ' ') || '] ' ||
                              'Grupo de Fornecedor EMS [' ||
                              L_TRATA_FALHA.COD_GRP_FORNEC || '] ' ||
                              'Codigo do Fornecedor EMS [' ||
                              L_TRATA_FALHA.CDN_FORNECEDOR || '] ' ||
                              'Documento Unicoo [' ||
                              L_TITULOS.CDIDENTIFICADOR || '] ' ||
                              'Fornecedor Unicoo [' ||
                              L_TRATA_FALHA.CDFORNECEDOR || '] ' ||
                              L_TRATA_FALHA.NOFORNECEDORUNICOO,
                              PCDSITUACAO,
                              NULL);
              ELSE
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              NULL,
                              PCDSITUACAO,
                              NULL);
              END IF;
            END LOOP;
            IF VAO_ACHOU_ERRO = FALSE THEN
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL ||
                            '. Titulo ou Fornecedor no existe no Unicoo',
                            NULL,
                            PCDSITUACAO,
                            NULL);
            END IF;
          ELSE
            VALIDA_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO,
                           RFORNECEDOR.CDN_FORNECEDOR);
            VCDINTEGRACAO := 'TI_TIT_APB_CTBL';
            -------------------------------------------------------------
            --- implementação Josias em 28-05-2014 em João Pessoa
            --- Processo para pegar a distribuição do titulo no unicoo.
            -------------------------------------------------------------
            BEGIN
              INSERT INTO TI_TIT_APB_CTBL CTB
                (COD_CTA_CTBL,
                 DAT_PROCESSAMENTO,
                 COD_ESTAB,
                 COD_TIP_FLUXO_FINANC,
                 COD_UNID_FEDERAC,
                 VAL_APROP_CTBL,
                 NRSEQ_CONTROLE_INTEGRACAO,
                 COD_CCUSTO,
                 CDSITUACAO)
              -- josias 30-06-2014
              -- falta tratar o problema do centro de custo nao esta
              -- cadastrado no plano de contas informado
                (SELECT Y.COD_CTA_CTBL,
                        Y.DAT_PROCESSAMENTO,
                        Y.COD_ESTAB,
                        Y.COD_TIP_FLUXO_FINANC,
                        Y.COD_UNID_FEDERAC,
                        SUM(Y.VLDISTRIBUICAO),
                        Y.NRSEQ_CONTROLE_INTEGRACAO,
                        DECODE(Y.CDCENTRO_CUSTO,
                               NULL,
                               ' ',
                               Y.CDCENTRO_CUSTO) CDCENTRO_CUSTO,
                        Y.CDSITUACAO
                   FROM (SELECT DISTINCT X.COD_CTA_CTBL,
                                         X.DAT_PROCESSAMENTO,
                                         X.COD_ESTAB,
                                         X.COD_TIP_FLUXO_FINANC,
                                         X.COD_UNID_FEDERAC,
                                         X.VLDISTRIBUICAO,
                                         X.NRSEQ_CONTROLE_INTEGRACAO,
                                         CASE
                                           WHEN X.TIPO_CCUSTO = '$T' THEN
                                            CASE
                                              WHEN F_TI_PARAMETRO_INTEGRACAO('AOUTILIZA_CODIGO_REDUZIDO') = 'N' THEN
                                               CC.CDCONTA
                                              ELSE
                                               TO_CHAR(X.CDCENTRO_CUSTO)
                                            END
                                           ELSE
                                            ' '
                                         END CDCENTRO_CUSTO,
                                         X.CDSITUACAO
                           FROM CONTA_CONTABIL CC,
                                (SELECT DISTINCT COD_CTA_CTBL,
                                                 DAT_PROCESSAMENTO,
                                                 COD_ESTAB,
                                                 COD_TIP_FLUXO_FINANC,
                                                 COD_UNID_FEDERAC,
                                                 --sum(nvl(decode(b.tipo_distrib,'V',b.vldistribuicao,(-1 * b.vldistribuicao)),ctb.val_aprop_ctbl)) vldistribuicao,     -- Alessandro 22/10/2014
                                                 --sum(b.vldistribuicao) vldistribuicao,      -- Alessandro 22/10/2014
                                                 -- alterado vinicius 31/12/2014
                                                 CASE
                                                   WHEN B.CDHISTORICO IN
                                                        (F_TI_PARAMETRO_INTEGRACAO('HISTORICO_COM_VALOR_LIQUIDO_APB')) THEN
                                                    (SELECT SUM(VLDISTRIBUICAO)
                                                       FROM DISTRIBUICAO_TITULO_PAGAR DTP
                                                      WHERE DTP.NRREGISTRO_TITULO =
                                                            B.NRREGISTRO_TITULO
                                                        AND DTP.TIPO_DISTRIB = 'V') -
                                                    NVL((SELECT SUM(VLDISTRIBUICAO)
                                                          FROM DISTRIBUICAO_TITULO_PAGAR DTP
                                                         WHERE DTP.NRREGISTRO_TITULO =
                                                               B.NRREGISTRO_TITULO
                                                           AND DTP.TIPO_DISTRIB = 'D'),
                                                        0)
                                                   ELSE
                                                    SUM(B.VLDISTRIBUICAO)
                                                 END VLDISTRIBUICAO,
                                                 NRSEQ_CONTROLE_INTEGRACAO,
                                                 CTB.CDSITUACAO,
                                                 CASE
                                                   WHEN B.CDCENTRO_CUSTO IS NULL THEN
                                                    CTB.COD_CCUSTO
                                                   ELSE
                                                    TO_CHAR(B.CDCENTRO_CUSTO)
                                                 END CDCENTRO_CUSTO,
                                                 CTB.COD_CCUSTO,
                                                 CTB.TIPO_CCUSTO
                                   FROM V_TI_TIT_APB_CTBL         CTB,
                                        DISTRIBUICAO_TITULO_PAGAR B
                                  WHERE CTB.NRREGISTRO_TITULO =
                                        B.NRREGISTRO_TITULO(+)
                                    AND NRSEQ_CONTROLE_INTEGRACAO =
                                        PNRSEQ_CONTROLE_INTEGRACAO
                                    AND B.TIPO_DISTRIB = 'V' -- ALessandro 22/10/2014
                                 /*group by cod_cta_ctbl,
                                 dat_processamento,
                                 cod_estab,
                                 cod_tip_fluxo_financ,
                                 cod_unid_federac,
                                 nrseq_controle_integracao,
                                 b.cdcentro_custo,
                                 ctb.cod_ccusto,
                                 ctb.tipo_ccusto,
                                 ctb.cdsituacao*/
                                  GROUP BY COD_CTA_CTBL,
                                           DAT_PROCESSAMENTO,
                                           CDHISTORICO,
                                           B.NRREGISTRO_TITULO,
                                           COD_ESTAB,
                                           COD_TIP_FLUXO_FINANC,
                                           COD_UNID_FEDERAC,
                                           NRSEQ_CONTROLE_INTEGRACAO,
                                           B.CDCENTRO_CUSTO,
                                           CTB.COD_CCUSTO,
                                           CTB.TIPO_CCUSTO,
                                           CTB.CDSITUACAO) X
                          WHERE X.CDCENTRO_CUSTO = CC.NRCONTA_REDUZIDA(+)
                            AND CC.NRPLANO_CONTAS(+) =
                                F_TI_PARAMETRO_INTEGRACAO('NRPLANO_CENTRO_CUSTO_UNICOO')) Y
                  GROUP BY Y.COD_CTA_CTBL,
                           Y.DAT_PROCESSAMENTO,
                           Y.COD_ESTAB,
                           Y.COD_TIP_FLUXO_FINANC,
                           Y.COD_UNID_FEDERAC,
                           Y.NRSEQ_CONTROLE_INTEGRACAO,
                           Y.CDCENTRO_CUSTO,
                           Y.CDSITUACAO);
            EXCEPTION
              WHEN OTHERS THEN
                -- Josias 26-06-2014 - colocado essa exceção para acompanhar erro
                RAISE_APPLICATION_ERROR(-20100, ' Erro -> ' || SQLERRM);
                NULL;
            END;
            IF SQL%ROWCOUNT = 0 THEN
              P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                            VCDINTEGRACAO,
                            'A view v_TI_TIT_APB_CTBL não encontrou registro para o processo ==>' ||
                            PNRSEQ_CONTROLE_INTEGRACAO,
                            NULL,
                            PCDSITUACAO,
                            NULL);
            ELSE
              VCDINTEGRACAO := 'TI_TIT_APB_IMPOSTO';
              INSERT INTO TI_TIT_APB_IMPOSTO
                (COD_SER_DOCTO,
                 IND_CLAS_IMPTO,
                 VAL_IMPTO_JA_RECOLHID,
                 VAL_OUTRAS_DEDUC_IMPTO,
                 COD_TITULO_AP,
                 VAL_RENDTO_TRIBUT,
                 VAL_ALIQ_IMPTO,
                 VAL_DEDUC_FAIXA_IMTO,
                 COD_ESTAB,
                 COD_ESPEC_DOCTO,
                 COD_PARCELA,
                 COD_UNID_FEDERAC,
                 COD_IMPOSTO,
                 COD_CLASSIF_IMPTO,
                 VAL_DEDUC_INSS,
                 VAL_DEDUC_DEPEND,
                 VAL_DEDUC_PENSAO,
                 VAL_DEDUC_OUTRAS_DEDUC,
                 VAL_BASE_LIQ_IMPTO,
                 VAL_IMPOSTO,
                 DAT_VENCTO,
                 DES_TEXT_HISTOR,
                 DAT_PROCESSAMENTO,
                 CDSITUACAO,
                 VAL_DEDUC_FAIXA_IMPTO,
                 COD_CTA_CTBL,
                 NRSEQ_CONTROLE_INTEGRACAO,
                 COD_PLANO_CTB_CBTL,
                 IND_OCORRENCIA,
                 COD_TIP_FLUXO_FINANC)
                SELECT COD_SER_DOCTO,
                       IND_CLAS_IMPTO,
                       VAL_IMPTO_JA_RECOLHID,
                       VAL_OUTRAS_DEDUC_IMPTO,
                       SUBSTR(COD_TITULO_AP, 0, 10),
                       VAL_RENDTO_TRIBUT,
                       VAL_ALIQ_IMPTO,
                       VAL_DEDUC_FAIXA_IMTO,
                       COD_ESTAB,
                       COD_ESPEC_DOCTO,
                       COD_PARCELA,
                       COD_UNID_FEDERAC,
                       COD_IMPOSTO,
                       COD_CLASSIF_IMPTO,
                       VAL_DEDUC_INSS,
                       VAL_DEDUC_DEPEND,
                       VAL_DEDUC_PENSAO,
                       VAL_DEDUC_OUTRAS_DEDUC,
                       VAL_BASE_LIQ_IMPTO,
                       VAL_IMPOSTO,
                       DAT_VENCTO,
                       DES_TEXT_HISTOR,
                       DAT_PROCESSAMENTO,
                       CDSITUACAO,
                       VAL_DEDUC_FAIXA_IMPTO,
                       COD_CTA_CTBL,
                       NRSEQ_CONTROLE_INTEGRACAO,
                       COD_PLANO_CTB_CBTL,
                       IND_OCORRENCIA,
                       COD_TIP_FLUXO_FINANC
                  FROM V_TI_TIT_APB_IMPOSTO IP
                 WHERE IP.NRSEQ_CONTROLE_INTEGRACAO =
                       PNRSEQ_CONTROLE_INTEGRACAO;
            END IF;
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        SQLERRM,
                        NULL,
                        PCDSITUACAO,
                        NULL);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        SQLERRM,
                        NULL,
                        PCDSITUACAO,
                        NULL);
      END;
      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_TITULOS.NRSEQUENCIAL,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  --===============================================--
  -- TI_Cliente --> Enviar Cliente para integracao --
  ---------------------------------------------------
  PROCEDURE P_TI_CLIENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_INTEGRA_CLIFOR IS
      SELECT CI.NRSEQUENCIAL        NRSEQ_CONTROLE_INTEGRACAO,
             CI.CDSITUACAO,
             CI.NRSEQUENCIAL_ORIGEM NRPESSOA
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'CL'
         AND CI.CDSITUACAO = PCDSITUACAO
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0);
  BEGIN
    FOR L_INTEGRA_CLIFOR IN C_INTEGRA_CLIFOR LOOP
      BEGIN
        PCDSITUACAO := 'RC';
        INSERT INTO TI_CLIENTE
          (COD_ORG_EMIS_ID_ESTAD,
           DAT_NASCIMENTO,
           COD_ID_FEDER_NASC,
           NOM_NACIONALIDADE,
           IND_ESTADO_CIVIL,
           COD_CX_POST,
           NOM_HOME_PAGE,
           DAT_IMPL_CLIEN,
           COD_DIGITO_CTA_CORREN,
           COD_TIP_FLUXO_FINANC,
           NUM_DIAS_ATRASO_AVDEB,
           DAT_PROCESSAMENTO,
           CDSITUACAO,
           COD_EMPRESA,
           COD_ID_FEDER_JURID,
           COD_CEP_COBR,
           DEST_ANOT_TABELA,
           COD_CART_BCIA_PREFER,
           IND_TIPO_PESSOA,
           COD_ID_FEDER_MATRIZ,
           COD_PAIS_NASC,
           NOM_MAE,
           NOM_PROFISSAO,
           NOM_CIDADE,
           COD_CEP,
           COD_TELEFONE_1,
           COD_TELEFONE_3,
           COD_FAX,
           NOM_BAIRRO_COBR,
           COD_UNID_FEDER_COBR,
           COD_GRP_CLIEN,
           COD_PORTAD_PREFER,
           COD_CTA_CORREN_BCO,
           COD_BANCO,
           LOG_CALC_MULTA,
           IND_OCORRENCIA,
           NRSEQ_CONTROLE_INTEGRACAO,
           COD_CLIENTE,
           NOM_CLIENTE,
           NOM_ABREV,
           COD_ID_FEDER_ESTAD_JURID,
           COD_ID_PREVID_SOCIAL,
           LOG_FINS_LUCRAT,
           COD_ID_ESTAD_FISIC,
           COD_ID_FEDER_EMIS_ESTAD,
           NOM_BAIRRO,
           COD_UNID_FEDER,
           COD_TELEFONE_2,
           COD_RAMAL_FAX,
           NOM_ENDER_COMPL_COBR,
           NOM_CIDADE_COBR,
           COD_CX_POST_COBR,
           COD_TIP_CLIEN,
           COD_ID_FEDER,
           NOM_ENDER_COMPL,
           COD_DIGITO_AGENC_BCIA,
           COD_ACAO,
           NOM_ENDERECO,
           NOM_ENDERECO_COBR,
           COD_AGENC_BCIA,
           COD_E_MAIL,
           COD_ID_MUNIC_JURID,
           NRSEQ_FAVORECIDO,
           NRPESSOA)
          SELECT COD_ORG_EMIS_ID_ESTAD,
                 DAT_NASCIMENTO,
                 COD_ID_FEDER_NASC,
                 NOM_NACIONALIDADE,
                 IND_ESTADO_CIVIL,
                 COD_CX_POST,
                 NOM_HOME_PAGE,
                 DAT_IMPL_CLIEN,
                 COD_DIGITO_CTA_CORREN,
                 COD_TIP_FLUXO_FINANC,
                 NUM_DIAS_ATRASO_AVDEB,
                 DAT_PROCESSAMENTO,
                 CDSITUACAO,
                 --          nm_arq_retorno,
                 COD_EMPRESA,
                 COD_ID_FEDER_JURID,
                 RPAD(NVL(TRIM(COD_CEP_COBR),
                          F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')),
                      8,
                      '0'),
                 DEST_ANOT_TABELA,
                 COD_CART_BCIA_PREFER,
                 IND_TIPO_PESSOA,
                 COD_ID_FEDER_MATRIZ,
                 COD_PAIS_NASC,
                 -- Josias 29-06-2014
                 -- estava estourando o nome da mae com mais de 40 posições
                 SUBSTR(NOM_MAE, 1, 40),
                 NOM_PROFISSAO,
                 NOM_CIDADE,
                 -- josias 29-06-2014
                 RPAD(NVL(TRIM(COD_CEP),
                          F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')),
                      8,
                      '0'),
                 COD_TELEFONE_1,
                 COD_TELEFONE_3,
                 COD_FAX,
                 NOM_BAIRRO_COBR,
                 COD_UNID_FEDER_COBR,
                 COD_GRP_CLIEN,
                 COD_PORTAD_PREFER,
                 COD_CTA_CORREN_BCO,
                 COD_BANCO,
                 LOG_CALC_MULTA,
                 IND_OCORRENCIA,
                 NRSEQ_CONTROLE_INTEGRACAO,
                 COD_CLIENTE,
                 NOM_CLIENTE,
                 NOM_ABREV,
                 COD_ID_FEDER_ESTAD_JURID,
                 COD_ID_PREVID_SOCIAL,
                 LOG_FINS_LUCRAT,
                 COD_ID_ESTAD_FISIC,
                 COD_ID_FEDER_EMIS_ESTAD,
                 NOM_BAIRRO,
                 COD_UNID_FEDER,
                 COD_TELEFONE_2,
                 COD_RAMAL_FAX,
                 NOM_ENDER_COMPL_COBR,
                 NOM_CIDADE_COBR,
                 COD_CX_POST_COBR,
                 COD_TIP_CLIEN,
                 COD_ID_FEDER,
                 NOM_ENDER_COMPL,
                 COD_DIGITO_AGENC_BCIA,
                 COD_ACAO,
                 NOM_ENDERECO,
                 NOM_ENDERECO_COBR,
                 COD_AGENC_BCIA,
                 COD_E_MAIL,
                 COD_ID_MUNIC_JURID,
                 NRSEQ_FAVORECIDO,
                 NRPESSOA
            FROM V_TI_CLIENTE
           WHERE NRSEQ_CONTROLE_INTEGRACAO =
                 L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO;

        IF SQL%ROWCOUNT = 0 THEN
          P_TI_VALIDA_ENDERECO(L_INTEGRA_CLIFOR.NRPESSOA,
                               L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                               'TI_CLIENTE',
                               PCDSITUACAO);
          IF PCDSITUACAO = 'RC' THEN
            P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                          'TI_CLIENTE',
                          'Dados no encontrados na V_ti_cliente PARA O PROCESSO',
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        END IF;

        P_COMMIT;

      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                        'TI_CLIENTE',
                        'O cliente j foi enviado para a TI_CLIENTE',
                        NULL,
                        PCDSITUACAO,
                        -1);
        WHEN OTHERS THEN
          BEGIN
            P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                          'TI_CLIENTE',
                          SQLERRM,
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END;
      END;
      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  PROCEDURE P_GERAR_DADOS_BANC_FORNEC(VP_COD_EMPRESA IN NUMBER) IS
    /*
    ***************************************************************************************************************
    Criacão          : Josias Rodrigues
    Data             : -
    Modulo Principal : Integracão EMS5
    Modulos          : -
    Objetivo         : Gerar os dados bancários do Fornecedor Unicoo para o EMS5
    Alteracoes
    +------------------------------------------------------------------------------------------------------------------------------------------+
    | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 25/09/2014 | JOSIAS        |               |           | Criação do Objeto                                                                  |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    */
  BEGIN
    DECLARE
      CURSOR C_ATU IS
        SELECT VP_COD_EMPRESA COD_EMPRESA,
               P.CDN_FORNECEDOR,
               LPAD(T.NRBANCO, 3, '0') COD_BANCO,
               CASE
                 WHEN INSTR(T.NRAGENCIA, '-') > 0 THEN
                  SUBSTR(LPAD(F_DEFINIR_NUMERICO(SUBSTR(T.NRAGENCIA,
                                                        1,
                                                        INSTR(T.NRAGENCIA,
                                                              '-') - 1)),
                              F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'),
                              '0'),
                         1,
                         F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'))
                 ELSE
                  SUBSTR(LPAD(F_DEFINIR_NUMERICO(T.NRAGENCIA),
                              F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'),
                              '0'),
                         1,
                         F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'))
               END COD_AGENC_BCIA,
               CASE
                 WHEN INSTR(T.NRAGENCIA, '-') > 0 THEN
                  SUBSTR(T.NRAGENCIA, INSTR(T.NRAGENCIA, '-') + 1, 1)
                 ELSE
                  ' '
               END COD_DIGITO_AGENC_BCIA,
               CASE
                 WHEN INSTR(T.NRCONTA_BANCARIA, '-') > 0 THEN
                  SUBSTR(LPAD(F_DEFINIR_NUMERICO(SUBSTR(T.NRCONTA_BANCARIA,
                                                        1,
                                                        INSTR(T.NRCONTA_BANCARIA,
                                                              '-') - 1)),
                              F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'),
                              '0'),
                         1,
                         F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'))
                 ELSE
                 --                                        substr(t.nrconta_bancaria,1, f_ret_masc_banco(lpad(t.nrbanco,3,'0'),'C'))
                  SUBSTR(LPAD(F_DEFINIR_NUMERICO(T.NRCONTA_BANCARIA),
                              F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'),
                              '0'),
                         1,
                         F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'))
               END COD_CTA_CORREN_BCO,
               CASE
                 WHEN INSTR(T.NRCONTA_BANCARIA, '-') > 0 THEN
                  SUBSTR(T.NRCONTA_BANCARIA,
                         INSTR(T.NRCONTA_BANCARIA, '-') + 1,
                         1)
                 ELSE
                  ' '
               END COD_DIGITO_CTA_CORREN
          FROM FORNECEDOR_AGENCIA_BANCARIA         T,
               PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA F,
               TI_PESSOA                           P,
               FORNEC_FINANC                       FF
         WHERE T.CDFORNECEDOR = F.CDFORNECEDOR
           AND F.NRREGISTRO_FORNECEDOR = P.NRREGISTRO
           AND FF.U##COD_EMPRESA = VP_COD_EMPRESA
           AND P.CDN_FORNECEDOR = FF.CDN_FORNECEDOR
           AND P.CDN_FORNECEDOR IS NOT NULL
           AND T.TPCONTA = 'CC';
    BEGIN
      FOR X IN C_ATU LOOP
        UPDATE FORNEC_FINANC V
           SET V.COD_BANCO             = nvl(X.COD_BANCO, ' '),
               V.COD_AGENC_BCIA        = nvl(X.COD_AGENC_BCIA, ' '),
               V.COD_DIGITO_AGENC_BCIA = nvl(X.COD_DIGITO_AGENC_BCIA, ' '),
               V.COD_CTA_CORREN_BCO    = nvl(X.COD_CTA_CORREN_BCO, ' '),
               V.COD_DIGITO_CTA_CORREN = nvl(X.COD_DIGITO_CTA_CORREN, ' ')
         WHERE V.U##COD_EMPRESA = X.COD_EMPRESA
           AND V.CDN_FORNECEDOR = X.CDN_FORNECEDOR;
      END LOOP;
    END;
    P_COMMIT_NEW;
    commit;
  END;

  FUNCTION F_RET_MASC_BANCO(VPCOD_BANCO IN VARCHAR2, VPTIPO IN VARCHAR2)
    RETURN NUMBER IS
    -- tipo "A" agencia , "C" conta
    VRESULT NUMBER;
  BEGIN
    -- verificar se o tipo de consulta é da agencia
    IF VPTIPO = 'A' THEN
      BEGIN
        SELECT LENGTH(B.COD_FORMAT_AGENC_BCIA)
          INTO VRESULT
          FROM BANCO B
         WHERE B.COD_BANCO = VPCOD_BANCO;
      EXCEPTION
        WHEN OTHERS THEN
          RETURN 10;
      END;
      RETURN VRESULT;
    ELSIF VPTIPO = 'C' THEN
      BEGIN
        SELECT LENGTH(B.COD_FORMAT_CTA_CORREN)
          INTO VRESULT
          FROM BANCO B
         WHERE B.COD_BANCO = VPCOD_BANCO;
      EXCEPTION
        WHEN OTHERS THEN
          RETURN 10;
      END;
    END IF;
    RETURN VRESULT;
  END;

  FUNCTION F_DEFINIR_NUMERICO(VP_CODIGO VARCHAR2) RETURN NUMBER IS
    VAUX VARCHAR2(20);
  BEGIN
    VAUX := '';
    FOR X IN 1 .. LENGTH(VP_CODIGO) LOOP
      IF SUBSTR(VP_CODIGO, X, 1) IN
         ('0', '1', '2', '3', '4', '5', '6', '7', '8', '9') THEN
        VAUX := VAUX || SUBSTR(VP_CODIGO, X, 1);
      END IF;
    END LOOP;
    RETURN TO_NUMBER(NVL(VAUX, 0));
  END;

  PROCEDURE P_VINCULA_IMPOSTO_FORNEC IS
    /*
    ***************************************************************************************************************
    Criac?o          : -
    Data             : -
    Modulo Principal : Integrac?o EMS5
    Modulos          : -
    Objetivo         : vincular os impostos do fornecedor no EMS5
    Alteracoes
    +------------------------------------------------------------------------------------------------------------------------------------------+
    | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 01/07/2014 | JOSIAS        |               |           | Atualizações necessárias   |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    */
  BEGIN
    BEGIN
        INSERT INTO IMPTO_VINCUL_FORNEC
          SELECT F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') U##COD_EMPRESA,
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') COD_EMPRESA,
                 CDN_FORNECEDOR,
                 F_TI_PARAMETRO_INTEGRACAO('COD_PAIS') U##COD_PAIS,
                 F_TI_PARAMETRO_INTEGRACAO('COD_PAIS') COD_PAIS,
                 --f_ti_parametro_integracao('COD_ID_FEDER') u##cod_unid_federac,
                 --f_ti_parametro_integracao('COD_ID_FEDER') cod_unid_federac,
                 COD_UNID_FEDERAC U##COD_UNID_FEDERAC,
                 COD_UNID_FEDERAC COD_UNID_FEDERAC,
                 CDTAXA U##COD_IMPOSTO,
                 CDTAXA COD_IMPOSTO,
                 CDCLASS U##COD_CLASSIF_IMPTO,
                 CDCLASS COD_CLASSIF_IMPTO,
                 0 LOG_IMPTO_OPCNAL,
                 ' ' COD_LIVRE_1,
                 0 LOG_LIVRE_1,
                 0 NUM_LIVRE_1,
                 0 VAL_LIVRE_1,
                 TRUNC(SYSDATE) DAT_LIVRE_1,
                 0 NUMREDUZRENDTOTRIBUT,
                 ' ' COD_LIVRE_2,
                 NULL DAT_LIVRE_2,
                 0 LOG_LIVRE_2,
                 0 NUM_LIVRE_2,
                 0 VAL_LIVRE_2,
                 0 CDD_VERSION,
                 EMS5.IMPTO_VINCUL_FORNEC_SEQ.NEXTVAL PROGRESS_RECID
            FROM (SELECT DISTINCT F_TI_IMPOSTO_AGRUPADO(XX.COD_IMPOSTO,
                                                        TTP.NRREGISTRO_TITULO) CDTAXA,
                                  F_TI_IMPOSTO_AGRUPADO(XX.COD_CLASSIF_IMPTO,
                                                        TTP.NRREGISTRO_TITULO) CDCLASS,
                                  TIP.CDN_FORNECEDOR,
                                  XX.COD_UNID_FEDERAC
                    FROM TAXA_TITULO_A_PAGAR                 TTP,
                         TITULO_A_PAGAR                      TP,
                         PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FN,
                         TI_TAXA_A_PAGAR                     XX,
                         TI_PESSOA                           TIP,
                         TI_FORNECEDOR                       TIF
                   WHERE XX.COD_TAXA = TTP.CDTAXA
                     AND TIP.NRREGISTRO = FN.NRREGISTRO_FORNECEDOR
                     AND FN.CDFORNECEDOR = TP.CDFORNECEDOR
                     AND TP.NRREGISTRO_TITULO = TTP.NRREGISTRO_TITULO
                     AND TIF.NRPESSOA = TIP.NRREGISTRO
                     AND TIP.CDN_FORNECEDOR IS NOT NULL
                     AND NOT EXISTS
                   (SELECT 1
                            FROM IMPTO_VINCUL_FORNEC IVF
                           WHERE IVF.CDN_FORNECEDOR = TIP.CDN_FORNECEDOR
                             AND IVF.COD_CLASSIF_IMPTO =
                                 F_TI_IMPOSTO_AGRUPADO(TTP.CDTAXA,
                                                       TTP.NRREGISTRO_TITULO)));
    exception
          when others then
             raise_application_error(-20100,' erro inserindo impostos '||sqlerrm);
    end;
    P_COMMIT_NEW;
    -------------------
    UPDATE FORNEC_FINANC F
       SET F.LOG_RETENC_IMPTO = 1
     WHERE EXISTS (SELECT 1
              FROM IMPTO_VINCUL_FORNEC I
             WHERE I.U##COD_EMPRESA = F.U##COD_EMPRESA
               AND I.CDN_FORNECEDOR = F.CDN_FORNECEDOR);
    COMMIT;
  END P_VINCULA_IMPOSTO_FORNEC;

  PROCEDURE P_CONTABILIZACAO(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                             PNRPERIODO                 IN NUMBER,
                             PCDLOTE_INTEGRACAO         IN VARCHAR2,
                             PTXDESCRICAO_LOTE          IN VARCHAR2,
                             PDTLOTE                    IN DATE,
                             PCDEMPRESA                 IN VARCHAR2,
                             PTPPERIODO                 IN VARCHAR2,
                             PI_NRLOTE                  IN NUMBER,
                             PI_CDFUNCIONARIO           IN VARCHAR2) IS
    /*
    ***************************************************************************************************************
    Criac?o          : -
    Data             : -
    Modulo Principal : Integrac?o EMS5
    Modulos          : -
    Telas            : CR05FC7
    Objetivo         : Enviar os titulos do Unicoo para o EMS5

    Alteracoes
    +------------------------------------------------------------------------------------------------------------------------------------------+
    | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 04/11/2009 | ALECSANDRO    |               |           | A tabela TI_LANCAMENTO_CONTABIL foi alterada para TI_ITEM_LANCAMENTO_CONTABIL   |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 06/07/2009 | ERIC ARANTES  |               |           | Criado os cursores para trazer o centro custo no lancamento contabil            |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 01/07/2014 | JOSIAS        |               |           | Atualizações necessárias   |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|

    */
    CURSOR C_LANCTO_DEB IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             LC.CDCONTA_MEMO_DEB,
             LC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_DEB CDCONTA_CONTABIL,
             'DB' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO
        FROM LANCAMENTO_CONTABIL LC
       WHERE LC.CDCONTA_DEB IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND (LC.CDLANCTO_PADRAO =
             'L' ||
             SUBSTR(TO_NUMBER(SUBSTR(PCDLOTE_INTEGRACAO, 2, 10)), 1, 5) --pcdlote_integracao
             OR PCDLOTE_INTEGRACAO IS NULL);
    CURSOR C_LANCTO_CRED IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             LC.CDCONTA_MEMO_DEB,
             LC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_CRED CDCONTA_CONTABIL,
             'CR' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO
        FROM LANCAMENTO_CONTABIL LC
       WHERE LC.CDCONTA_CRED IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND (LC.CDLANCTO_PADRAO =
             'L' ||
             SUBSTR(TO_NUMBER(SUBSTR(PCDLOTE_INTEGRACAO, 2, 10)), 1, 5) --pcdlote_integracao
             OR PCDLOTE_INTEGRACAO IS NULL);
    /*
    TODO: owner="Eric" created="08/07/2010"
    text="Não sei se as outras integrações também recebem obrigatóriamente um numero de lote, por isso fiz esse tratamento em cursor separado para não afetar o que já funciona em "
    */
    ----> cursor para o fechamento de estoque
    CURSOR C_LANCTO_DEB_2 IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             IC.CDCONTA_MEMO_DEB,
             IC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_DEB CDCONTA_CONTABIL,
             'DB' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO,
             IC.CDORIGEM
        FROM LANCAMENTO_CONTABIL LC, INTEGRACAO_CONTABIL IC
       WHERE LC.NRLANCAMENTO = IC.NRLANCAMENTO
         AND LC.NRSEQ_LANCTO = IC.NRSEQ_LANCTO
         AND LC.CDCONTA_DEB IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND IC.NRLOTE_INTEGRACAO = PI_NRLOTE
         AND (LC.CDLANCTO_PADRAO = PCDLOTE_INTEGRACAO OR
             PCDLOTE_INTEGRACAO IS NULL);
    CURSOR C_LANCTO_CRED_2 IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             IC.CDCONTA_MEMO_DEB,
             IC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_CRED CDCONTA_CONTABIL,
             'CR' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO,
             IC.CDORIGEM
        FROM LANCAMENTO_CONTABIL LC, INTEGRACAO_CONTABIL IC
       WHERE LC.NRLANCAMENTO = IC.NRLANCAMENTO
         AND LC.NRSEQ_LANCTO = IC.NRSEQ_LANCTO
         AND LC.CDCONTA_CRED IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND IC.NRLOTE_INTEGRACAO = PI_NRLOTE
         AND (LC.CDLANCTO_PADRAO = PCDLOTE_INTEGRACAO OR
             PCDLOTE_INTEGRACAO IS NULL);
    VCOD_CCUSTO TI_CENTRO_CUSTO_CTBL.COD_CCUSTO%TYPE;
    VCOD_ESTAB  TI_CENTRO_CUSTO_CTBL.COD_ESTAB%TYPE;
    VA_CODESTAB VARCHAR2(2) := '01';
    VCDSITUACAO VARCHAR2(2);
  BEGIN
    INSERT INTO TI_LOTE_CTBL
      (NRSEQ_CONTROLE_INTEGRACAO,
       CDSITUACAO,
       NRPERIODO,
       COD_PLANO_CTA_CTBL,
       COD_PLANO_CCUSTO,
       DAT_LOTE_CTBL,
       DAT_PROCESSAMENTO,
       DAT_GERACAO,
       DES_LOTE_CTBL,
       AOLOTE_INTEGRACAO)
      SELECT PNRSEQ_CONTROLE_INTEGRACAO,
             'RC' CDSITUACAO,
             PNRPERIODO,
             F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CTA_CTBL') COD_PLANO_CTA_CTBL,
             F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') COD_PLANO_CCUSTO,
             PDTLOTE,
             SYSDATE DAT_PROCESSAMENTO,
             SYSDATE DAT_GERACAO,
             CASE
               WHEN PTXDESCRICAO_LOTE LIKE 'APROPRIACAO PROD.PREST%' THEN
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || 'APROP. PAGPREST' ||
                       SUBSTR(PTXDESCRICAO_LOTE, 24, 21),
                       1,
                       40)
               WHEN PTXDESCRICAO_LOTE LIKE
                    'APROPRIACAO DAS FATURAS EMITIDAS%' THEN
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || 'APROP. FAT EMITIDAS' ||
                       SUBSTR(PTXDESCRICAO_LOTE, 24, 21),
                       1,
                       40)
               WHEN PTXDESCRICAO_LOTE LIKE
                    'APROPRIACAO DAS FATURAS VENCIDAS%' THEN
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || 'APROP. FAT VENCIDAS' ||
                       SUBSTR(PTXDESCRICAO_LOTE, 24, 21),
                       1,
                       40)
               ELSE
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || PTXDESCRICAO_LOTE, 1, 40)
             END DES_LOTE_CTBL,
             DECODE(PCDLOTE_INTEGRACAO, NULL, 'N', 'S')
        FROM DUAL;
    --=========
    IF PI_CDFUNCIONARIO != 'SISMV' THEN
      FOR L_LANCTO_CRED IN C_LANCTO_CRED LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
            INTO VCOD_CCUSTO, VCOD_ESTAB
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and  cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_CRED.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            VCOD_CCUSTO := ' ';
            VCOD_ESTAB  := '01';
        END;
        IF L_LANCTO_CRED.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
        END IF;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_CRED.CDCONTA_CONTABIL,
           L_LANCTO_CRED.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_CRED.TXHISTORICO, 1, 2000),
           L_LANCTO_CRED.DTLANCAMENTO,
           L_LANCTO_CRED.VLLANCAMENTO,
           VCOD_CCUSTO,
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VCOD_ESTAB --, '01' --va_codestab
          ,
           L_LANCTO_CRED.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --, '1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --, 'UNI'
          ,
           L_LANCTO_CRED.NRLANCAMENTO,
           L_LANCTO_CRED.NRSEQ_LANCTO);
      END LOOP;
      --=========
      FOR L_LANCTO_DEB IN C_LANCTO_DEB LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
            INTO VCOD_CCUSTO, VCOD_ESTAB
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_DEB.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            VCOD_CCUSTO := ' ';
            VCOD_ESTAB  := '01';
        END;
        IF L_LANCTO_DEB.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
        END IF;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_DEB.CDCONTA_CONTABIL,
           L_LANCTO_DEB.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_DEB.TXHISTORICO, 1, 2000),
           L_LANCTO_DEB.DTLANCAMENTO,
           L_LANCTO_DEB.VLLANCAMENTO,
           VCOD_CCUSTO,
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VCOD_ESTAB --, '01'--va_codestab
          ,
           L_LANCTO_DEB.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --'1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --'UNI'
          ,
           L_LANCTO_DEB.NRLANCAMENTO,
           L_LANCTO_DEB.NRSEQ_LANCTO);
      END LOOP;
      ------------------ no caso de fechamento do estoque entra nesse loop ----------------------------------
    ELSE
      FOR L_LANCTO_CRED2 IN C_LANCTO_CRED_2 LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
            INTO VCOD_CCUSTO, VCOD_ESTAB
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and  cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_CRED2.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            IF SUBSTR(L_LANCTO_CRED2.CDCONTA_CONTABIL, 1, 1) IN ('7', '4') THEN
              VCOD_CCUSTO := NVL(L_LANCTO_CRED2.CDCONTA_MEMO_CRED,
                                 L_LANCTO_CRED2.CDCONTA_MEMO_DEB);
            ELSE
              VCOD_CCUSTO := ' ';
              VCOD_ESTAB  := '01';
            END IF;
        END;
        IF L_LANCTO_CRED2.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
        END IF;
        --vcod_ccusto := null; --l_lancto_cred2.cdconta_memo_cred;
        VA_CODESTAB := L_LANCTO_CRED2.CDORIGEM;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_CRED2.CDCONTA_CONTABIL,
           L_LANCTO_CRED2.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_CRED2.TXHISTORICO, 1, 2000),
           L_LANCTO_CRED2.DTLANCAMENTO,
           L_LANCTO_CRED2.VLLANCAMENTO,
           NVL(VCOD_CCUSTO, ' '),
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VA_CODESTAB,
           L_LANCTO_CRED2.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --'1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --'UNI'
          ,
           L_LANCTO_CRED2.NRLANCAMENTO,
           L_LANCTO_CRED2.NRSEQ_LANCTO);
      END LOOP;
      FOR L_LANCTO_DEB2 IN C_LANCTO_DEB_2 LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO
            INTO VCOD_CCUSTO
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_DEB2.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            IF SUBSTR(L_LANCTO_DEB2.CDCONTA_CONTABIL, 1, 1) IN ('7', '4') THEN
              VCOD_CCUSTO := NVL(L_LANCTO_DEB2.CDCONTA_MEMO_DEB,
                                 L_LANCTO_DEB2.CDCONTA_MEMO_CRED);
            ELSE
              VCOD_CCUSTO := ' ';
              VCOD_ESTAB  := '01';
            END IF;
        END;
        IF L_LANCTO_DEB2.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
          VCOD_ESTAB  := '01';
        END IF;
        --            vcod_ccusto := l_lancto_deb2.cdconta_memo_deb;
        VA_CODESTAB := L_LANCTO_DEB2.CDORIGEM;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_DEB2.CDCONTA_CONTABIL,
           L_LANCTO_DEB2.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_DEB2.TXHISTORICO, 1, 2000),
           L_LANCTO_DEB2.DTLANCAMENTO,
           L_LANCTO_DEB2.VLLANCAMENTO,
           NVL(VCOD_CCUSTO, ' '),
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VA_CODESTAB,
           L_LANCTO_DEB2.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --'1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --'UNI'
          ,
           L_LANCTO_DEB2.NRLANCAMENTO,
           L_LANCTO_DEB2.NRSEQ_LANCTO);
      END LOOP;
    END IF;
    --=====================================--
    -- Aplica depara da matriz de tradução --
    -----------------------------------------
    FOR L_MT IN (SELECT ILC.ROWID LINHA,
                        MT.DESTINO_COD_CCUSTO,
                        MT.DESTINO_COD_ESTAB
                   FROM TI_LOTE_CTBL_MATRIZ_TRADUCAO MT,
                        TI_ITEM_LANCAMENTO_CTBL      ILC
                  WHERE ILC.NRSEQ_CONTROLE_INTEGRACAO =
                        PNRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.COD_ESTAB = MT.COD_ESTAB
                    AND (ILC.COD_CTA_CTBL = MT.COD_CTA_CTBL OR
                        MT.COD_CTA_CTBL = '*')
                    AND (MT.COD_CCUSTO = ILC.COD_CCUSTO OR
                        MT.COD_CCUSTO = '*')
                    AND MT.COD_PLANO_CCUSTO =
                        F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                    AND (MT.DES_HISTOR_LANCTO_CTBL = '*' OR
                        MT.DES_HISTOR_LANCTO_CTBL =
                        ILC.DES_HISTOR_LANCTO_CTBL)) LOOP
      UPDATE TI_ITEM_LANCAMENTO_CTBL I
         SET I.COD_ESTAB  = L_MT.DESTINO_COD_ESTAB,
             I.COD_CCUSTO = L_MT.DESTINO_COD_CCUSTO
       WHERE I.ROWID = L_MT.LINHA;
    END LOOP;
    --============================--
    -- Validação centro de custos --
    --------------------------------
    VCDSITUACAO := 'OK';
    FOR L_CCUSTO_NAO_INFORMADO IN (SELECT COD_CTA_CTBL,
                                          COD_CCUSTO,
                                          I.COD_ESTAB,
                                          I.COD_EMPRESA,
                                          I.IND_NATUR_LANCTO_CTBL
                                     FROM TI_ITEM_LANCAMENTO_CTBL I
                                    WHERE I.NRSEQ_CONTROLE_INTEGRACAO =
                                          PNRSEQ_CONTROLE_INTEGRACAO
                                      AND I.COD_CCUSTO = ' '
                                      AND EXISTS
                                    (SELECT 1
                                             FROM CRITERDISTRIBCTACTBL A,
                                                  MAPA_DISTRIB_CCUSTO  M
                                            WHERE M.CODMAPADISTRIBCCUSTO =
                                                  A.CODMAPADISTRIBCCUSTO
                                              AND A.COD_CTA_CTBL =
                                                  I.COD_CTA_CTBL
                                              AND I.DAT_LANCTO BETWEEN
                                                  A.DAT_INIC_VALID AND
                                                  A.DAT_FIM_VALID)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_LOTE_CTBL',
           'NÃO FOI INFORMADO CENTRO DE CUSTO P/ A CONTA CONTABIL ' ||
           L_CCUSTO_NAO_INFORMADO.COD_CTA_CTBL,
           'Verifique o criterio de distribuição do EMS e os esquemas contábeis do Unicoo',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    -- Período não habilitado
    FOR L_PERIODO IN (SELECT MAX(P.COD_EXERC_CTBL ||
                                 LPAD(P.NUM_PERIOD_CTBL, 2, '0')) NRPERIODO,
                             COUNT(*) QTPERIODO,
                             MAX(COD_CENAR_CTBL) NOCENARIO
                        FROM SIT_PERIOD_CTBL P, TI_LOTE_CTBL LT
                       WHERE LT.NRSEQ_CONTROLE_INTEGRACAO =
                             PNRSEQ_CONTROLE_INTEGRACAO
                         AND P.COD_EXERC_CTBL ||
                             LPAD(P.NUM_PERIOD_CTBL, 2, '0') =
                             TO_CHAR(LT.DAT_LOTE_CTBL, 'YYYYMM')
                         AND P.IND_SIT_PERIOD_CTBL <> 'Habilitado'
                         AND P.COD_MODUL_DTSUL = 'FGL'
                         AND P.COD_EMPRESA =
                             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')) LOOP
      BEGIN
        IF L_PERIODO.QTPERIODO > 0 THEN
          INSERT INTO TI_FALHA_DE_PROCESSO
            (NRSEQUENCIAL,
             NRSEQ_CONTROLE_INTEGRACAO,
             CDINTEGRACAO,
             TXFALHA,
             TXAJUDA,
             DTFALHA,
             NRMENSAGEM)
          VALUES
            (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
             PNRSEQ_CONTROLE_INTEGRACAO,
             'TI_LOTE_CTBL',
             'O módulo FGL não esta habilitado para o cenário' ||
             L_PERIODO.NOCENARIO || ', período ' || PNRPERIODO,
             'Utilize a manutenção de período contábil, opção ajuste de período para habilitar o período',
             SYSDATE,
             NULL);
          VCDSITUACAO := 'PE';
        ELSE
          VCDSITUACAO := 'OK';
        END IF;
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
    END LOOP;
    FOR L_CE IN (SELECT ILC.*
                   FROM TI_ITEM_LANCAMENTO_CTBL ILC, TI_LOTE_CTBL LC
                  WHERE LC.NRSEQ_CONTROLE_INTEGRACAO =
                        ILC.NRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.NRSEQ_CONTROLE_INTEGRACAO =
                        PNRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.COD_CCUSTO <> ' '
                    AND EXISTS
                  (SELECT 1
                           FROM CCUSTO P
                          WHERE P.COD_CCUSTO = ILC.COD_CCUSTO
                            AND LC.DAT_LOTE_CTBL NOT BETWEEN P.DAT_INIC_VALID AND
                                P.DAT_FIM_VALID)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_LOTE_CTBL',
           'O Lançamento contábil esta com um centro de custo fora da validade. ' ||
           L_CE.COD_CTA_CTBL || ' C/C ' || L_CE.COD_CCUSTO,
           'Verifique o cadastro do plano de centro de custos',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --- Cenário exclusivo
    FOR L_CE IN (SELECT ILC.*
                   FROM TI_ITEM_LANCAMENTO_CTBL ILC, TI_LOTE_CTBL LC
                  WHERE LC.NRSEQ_CONTROLE_INTEGRACAO =
                        ILC.NRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.NRSEQ_CONTROLE_INTEGRACAO =
                        PNRSEQ_CONTROLE_INTEGRACAO
                    AND EXISTS
                  (SELECT 1
                           FROM CTA_CTBL CC
                          WHERE CC.COD_CENAR_CTBL_EXCLUS <> ' '
                            AND CC.COD_PLANO_CTA_CTBL = LC.COD_PLANO_CTA_CTBL
                            AND CC.COD_CTA_CTBL = ILC.COD_CTA_CTBL)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_LOTE_CTBL',
           'CENÁRIO EXCLUSIVO INFORMADO PARA A CONTA CONTÁBIL ' ||
           L_CE.COD_CTA_CTBL,
           'No cadastro de manutenção da conta contábil não pode ser informado o cenário',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --============================--
    -- Cta necessário cCusto      --
    -- Alessandro 18/08/2014      --
    --------------------------------
    FOR C_CTA IN (SELECT DISTINCT A.COD_CTA_CTBL, A.COD_ESTAB, A.COD_CCUSTO
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL A
                   WHERE A.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND SUBSTR(A.COD_CTA_CTBL, 1, 1) NOT IN ('1', '2')
                     AND EXISTS
                   (SELECT 1
                            FROM CRITERDISTRIBCTACTBL CD
                           WHERE CD.U##COD_CTA_CTBL = A.COD_CTA_CTBL
                             AND CD.U##COD_ESTAB = A.COD_ESTAB)
                     AND NOT EXISTS
                   (SELECT 1
                            FROM EMS506UNICOO.TI_CENTRO_CUSTO_CTBL CCC
                           WHERE CCC.COD_CTA_CTBL = A.COD_CTA_CTBL
                             AND CCC.COD_ESTAB = A.COD_ESTAB
                             AND CCC.COD_CCUSTO = A.COD_CCUSTO)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_CENTRO_CUSTO_CTBL',
           'Falta DePara de Conta Para Centro Custo',
           'Consta no TOTVS11 centro de custo para Conta ' ||
           C_CTA.COD_CTA_CTBL || ' Estab. ' || C_CTA.COD_ESTAB ||
           ' na tabela TI_CENTRO_CUSTO_CTBL',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- Restrição centro de custo por estabelecimento   --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL CCC
                   WHERE CCC.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND EXISTS
                   (SELECT 1
                            FROM RESTRIC_CCUSTO RC
                           WHERE RC.U##COD_CCUSTO = CCC.COD_CCUSTO
                             AND RC.U##COD_ESTAB = CCC.COD_ESTAB)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Restrição CCusto',
           'Há restrição de Estabelecimento para Centro de Custo',
           'Consta no TOTVS11 restrição do Estabelecimento :' ||
           C_CTA.COD_ESTAB || ' p/ CCusto ' || C_CTA.COD_CCUSTO,
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- Cta Unicoo x TOTVS11                            --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT DISTINCT A.COD_CTA_CTBL,
                                  XX.NOCONTA,
                                  EMS506UNICOO.F_TI_PARAMETRO_INTEGRACAO('NRPLANO_CONTA_UNICOO') PL_UNICOO
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL A,
                         CONTA_CONTABIL                       XX
                   WHERE A.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND XX.NRPLANO_CONTAS =
                         EMS506UNICOO.F_TI_PARAMETRO_INTEGRACAO('NRPLANO_CONTA_UNICOO')
                     AND XX.CDCONTA = A.COD_CTA_CTBL
                     AND NOT EXISTS
                   (SELECT 1
                            FROM CTA_CTBL CC
                           WHERE CC.U##COD_CTA_CTBL = A.COD_CTA_CTBL
                             AND F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CTA_CTBL') =
                                 CC.U##COD_PLANO_CTA_CTBL)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Falta Conta',
           'Há Conta Contábil no Unicoo e não cadastrada no TOTVS11',
           'Consta no Unicoo a Conta Contábil :' || C_CTA.COD_CTA_CTBL ||
           ' Desc.:  ' || C_CTA.NOCONTA || ' Plano no Unicoo.:  ' ||
           C_CTA.PL_UNICOO,
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- CCusto existe TOTVS11                           --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT CCC.COD_CCUSTO
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL CCC
                   WHERE CCC.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND CCC.COD_CCUSTO <> ' '
                     AND NOT EXISTS
                   (SELECT 1
                            FROM CCUSTO CC
                           WHERE CC.U##COD_PLANO_CCUSTO =
                                 EMS506UNICOO.F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO')
                             AND CC.U##COD_CCUSTO = CCC.COD_CCUSTO)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Falta CCusto',
           'Há Centro de Custo no Unicoo e não cadastrada no TOTVS11',
           'Consta no Unicoo o Centro de Custo: ' || C_CTA.COD_CCUSTO,
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- Centro Custo sem Unidade                        --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT COD_CCUSTO
                    FROM (SELECT A.U##COD_CCUSTO COD_CCUSTO,
                                 (SELECT B.U##COD_UNID_NEGOC
                                    FROM CCUSTO_UNID_NEGOC B
                                   WHERE B.U##COD_CCUSTO = A.U##COD_CCUSTO) CDUNID
                            FROM CCUSTO                               A,
                                 EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL CCC
                           WHERE A.U##COD_CCUSTO = CCC.COD_CCUSTO
                             AND CCC.NRSEQ_CONTROLE_INTEGRACAO =
                                 PNRSEQ_CONTROLE_INTEGRACAO) XX
                   WHERE XX.CDUNID IS NULL) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Falta CCusto sem Unidade',
           'Centro de Custo está sem Unidade de Negocio no TOTVS11',
           'Centro de Custo: ' || C_CTA.COD_CCUSTO ||
           ' está sem Unidade de Negocio.',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    IF VCDSITUACAO <> 'OK' THEN
      UPDATE TI_LOTE_CTBL LC
         SET LC.CDSITUACAO = 'PE'
       WHERE LC.NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
    END IF;
    /*select
        cod_cta_ctbl,
        cod_ccusto,
        i.cod_estab,
        i.cod_empresa,
        i.ind_natur_lancto_ctbl
    from
         ti_item_lancamento_ctbl i where i.nrseq_controle_integracao = 7192465
         and
         I.COD_CCUSTO <>' '
         AND
         not exists (
                select 1
                from
                    criterdistribctactbl a,
                    mapa_distrib_ccusto m,
                    item_lista_ccusto ic
                where
                     ic.cod_ccusto=i.cod_ccusto
                     and
                     ic.codmapadistribccusto=m.codmapadistribccusto
                     and
                     m.codmapadistribccusto=a.codmapadistribccusto
                     and
                     a.cod_cta_ctbl=i.cod_cta_ctbl
                     and
                     i.dat_lancto between a.dat_inic_valid and a.dat_fim_valid)
    */
  END;

  PROCEDURE P_TI_MOVIMENTO_CTA_CORRENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                        PNRSESSAO                  NUMBER,
                                        PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_INTEGRA_CMG IS
      SELECT CI.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
             CI.CDSITUACAO,
             CI.CDIDENTIFICADOR,
             CI.NRSEQUENCIAL_ORIGEM
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'CX'
         AND CI.CDSITUACAO = PCDSITUACAO
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0);
    VCDINTEGRACAO VARCHAR2(100);
  BEGIN
    FOR L_INTEGRA_CMG IN C_INTEGRA_CMG LOOP
      BEGIN
        PCDSITUACAO   := 'RC';
        VCDINTEGRACAO := 'TI_MOV_CTA_CORREN';
        INSERT INTO TI_MOVIMENTO_CTA_CORRENTE
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CORREN,
           DAT_MOVTO_CTA_CORREN,
           IND_TIP_MOVTO_CTA_CORREN,
           COD_TIP_TRANS_CX,
           IND_FLUXO_MOVTO_CTA_CORREN,
           COD_CENAR_CTBL,
           COD_HISTOR_PADR,
           VAL_MOVTO_CTA_CORREN,
           COD_DOCTO_MOVTO_CTA_BCO,
           COD_MODUL_DTSUL,
           IND_ERRO_VALID,
           DES_HISTOR_PADR,
           NUM_ID_MOVTO_CTA_CORREN)
          SELECT MCT.NRSEQ_CONTROLE_INTEGRACAO,
                 MCT.CDSITUACAO,
                 MCT.COD_CTA_CORREN,
                 MCT.DAT_MOVTO_CTA_CORREN,
                 MCT.IND_TIP_MOVTO_CTA_CORREN,
                 MCT.COD_TIP_TRANS_CX,
                 MCT.IND_FLUXO_MOVTO_CTA_CORREN,
                 MCT.COD_CENAR_CTBL,
                 MCT.COD_HISTOR_PADR,
                 MCT.VAL_MVTO_CTA_CORREN,
                 MCT.COD_DOCTO_MOVTO_CTA_BCO,
                 MCT.COD_MODUL_DTSUL,
                 MCT.IND_ERRO_VALID,
                 MCT.DES_HISTOR_PADR,
                 MCT.NUM_ID_MOVTO_CTA_CORREN
            FROM V_TI_MOVIMENTO_CTA_CORRENTE MCT
           WHERE NRSEQ_CONTROLE_INTEGRACAO =
                 L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO;
        IF SQL%ROWCOUNT = 0 THEN
          IF PCDSITUACAO = 'RC' THEN
            P_GRAVA_FALHA(L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO,
                          VCDINTEGRACAO,
                          'A VIEW V_TI_MOVIMENTO_CTA_CORRENTE N?O ENCONTROU MOVIMENTO CAIXA PARA O PROCESSO ==> ' ||
                          L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO ||
                          'NRMOVIMENTO ==> ' ||
                          L_INTEGRA_CMG.NRSEQUENCIAL_ORIGEM,
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        'O MOVIMENTO JA FOI ENVIADO PARA A TI_MOVIMENTO_CTA_CORRENTE ',
                        NULL,
                        PCDSITUACAO,
                        -1);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        'ERRO AO INCLUIR MOVIMENTO CAIXA NA TABELA TI_MOVIMENTO_CTA_CORRENTE ==> ' ||
                        SQLERRM || ' PROCESSO ==> ' ||
                        L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO ||
                        'NRMOVIMENTO ==> ' ||
                        L_INTEGRA_CMG.NRSEQUENCIAL_ORIGEM,
                        NULL,
                        PCDSITUACAO,
                        NULL);
      END;
      --====================================--
      -- Atualizar o situac?o da integrac?o --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  PROCEDURE P_INSERE_FORNECEDOR(PNRREGISTRO_TITULO IN NUMBER) IS
    CURSOR C_PES IS
      SELECT 'FN' PTPINTEGRACAO,
             'I' PCDACAO,
             P.NRCGC_CPF PNRCGC_CPF,
             P.NOPESSOA PNOPESSOA,
             P.DTNASCIMENTO PDTNASCIMENTO,
             P.TPPESSOA PTPPESSOA,
             P.NRREGISTRO PNRREGISTRO,
             'FORNECEDOR' PTPORIGEM,
             F.CDFORNECEDOR PCDIDENTIFICADOR,
             F.NRREGISTRO_FORNECEDOR PNRSEQUENCIAL_ORIGEM,
             '' PCDMODULO,
             TP.CDEMPRESA PCDEMPRESA,
             '' PNRSEQ_CONTROLE_INTEGRACAO_ORG,
             '' PNOABREVIADO_FORNECEDOR,
             '' PCDN_FORNECEDOR,
             '' PNOABREVIADO_CLIENTE,
             '' PCDN_CLIENTE,
             'S' PAODEFINEPESSOA
        FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA F,
             PESSOA                              P,
             TITULO_A_PAGAR                      TP
       WHERE TP.CDFORNECEDOR = F.CDFORNECEDOR
         AND F.NRREGISTRO_FORNECEDOR = P.NRREGISTRO
         AND TP.NRREGISTRO_TITULO = PNRREGISTRO_TITULO;
  BEGIN
    FOR X IN C_PES LOOP
      PCK_EMS506UNICOO.P_DEFINE_TI_PESSOA(X.PNRCGC_CPF,
                                          X.PNOPESSOA,
                                          X.PDTNASCIMENTO,
                                          X.PTPPESSOA,
                                          X.PNRREGISTRO,
                                          X.PTPORIGEM,
                                          X.PNOABREVIADO_FORNECEDOR,
                                          X.PCDN_FORNECEDOR,
                                          X.PNOABREVIADO_CLIENTE,
                                          X.PCDN_CLIENTE,
                                          X.PAODEFINEPESSOA);
      EMS506UNICOO.PCK_EMS506UNICOO.P_INS_TI_CONTROLE_INTEGRACAO(X.PTPINTEGRACAO,
                                                                 X.PCDACAO,
                                                                 X.PCDIDENTIFICADOR,
                                                                 X.PNRSEQUENCIAL_ORIGEM,
                                                                 X.PCDMODULO,
                                                                 X.PCDEMPRESA,
                                                                 X.PNRSEQ_CONTROLE_INTEGRACAO_ORG);
    END LOOP;
  END;

  PROCEDURE P_INSERE_CLIENTE(PNRREGISTRO_TITULO IN NUMBER) IS
    CURSOR C_CLI IS
      SELECT 'CL' PTPINTEGRACAO,
             'I' PCDACAO,
             P.NRCGC_CPF VNRCGC_CPF,
             P.NOPESSOA VNOPESSOA,
             P.DTNASCIMENTO VDTNASCIMENTO,
             P.TPPESSOA VTPPESSOA,
             C.NRREGISTRO_CLIENTE PNRSEQUENCIAL_ORIGEM,
             C.CDCLIENTE PCDIDENTIFICADOR,
             'CLIENTE',
             '' VNOM_ABREV_FORNECEDOR,
             '' VCDN_FORNECEDOR,
             '' VNOM_ABREV_CLIENTE,
             '' VCDN_CLIENTE,
             TR.CDEMPRESA PCDEMPRESA,
             '' PNRSEQ_CONTROLE_INTEGRACAO_ORG,
             '' PCDMODULO
        FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA C,
             PESSOA                           P,
             TITULO_A_RECEBER                 TR
       WHERE C.NRREGISTRO_CLIENTE = P.NRREGISTRO
         AND TR.CDCLIENTE = C.CDCLIENTE
         AND TR.NRREGISTRO_TITULO = PNRREGISTRO_TITULO;
  BEGIN
    FOR X IN C_CLI LOOP
      P_DEFINE_TI_PESSOA(X.VNRCGC_CPF,
                         X.VNOPESSOA,
                         X.VDTNASCIMENTO,
                         X.VTPPESSOA,
                         X.PNRSEQUENCIAL_ORIGEM,
                         'CLIENTE',
                         X.VNOM_ABREV_FORNECEDOR,
                         X.VCDN_FORNECEDOR,
                         X.VNOM_ABREV_CLIENTE,
                         X.VCDN_CLIENTE,
                         'S');
      EMS506UNICOO.PCK_EMS506UNICOO.P_INS_TI_CONTROLE_INTEGRACAO(X.PTPINTEGRACAO,
                                                                 X.PCDACAO,
                                                                 X.PCDIDENTIFICADOR,
                                                                 X.PNRSEQUENCIAL_ORIGEM,
                                                                 X.PCDMODULO,
                                                                 X.PCDEMPRESA,
                                                                 X.PNRSEQ_CONTROLE_INTEGRACAO_ORG);
    END LOOP;
  END;

  procedure P_CARGA_PESSOA_UNIMED IS
    --------------------------------------
    -- gerar carga de pessoa do unimeds
    --------------------------------------
    cursor c_pes is
      select distinct 'FN' ptpintegracao,
                      'I' pcdacao,
                      nvl(p.nrcgc_cpf, '00000000000000') pnrcgc_cpf,
                      p.nopessoa pnopessoa,
                      p.dtnascimento pdtnascimento,
                      p.tppessoa ptppessoa,
                      p.nrregistro pnrregistro,
                      'UNIMED' ptporigem,
                      f.cdfornecedor pcdidentificador,
                      f.nrregistro_fornecedor pnrsequencial_origem,
                      '' pcdmodulo,
                      '' pcdempresa,
                      '' pnrseq_controle_integracao_org,
                      '' pnoabreviado_fornecedor,
                      '' pcdn_fornecedor,
                      '' pnoabreviado_cliente,
                      '' pcdn_cliente,
                      'S' paodefinepessoa
        from producao.fornecedor@unicoo_homologa f,
             pessoa                              p,
             area_de_acao                        aa
       where f.nrregistro_fornecedor = p.nrregistro
            --and f.nrregistro_fornecedor not in (1976,1075,1628)
         and f.cdsituacao_fornecedor = 'A'
         and aa.cdprestador = f.cdfornecedor
         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = f.cdfornecedor
                 and ci.tpintegracao = 'FN');
    vcommit number;
  begin
    vcommit := 1;

    for x in c_pes loop
      begin
        pck_ems506unicoo.p_define_ti_pessoa(x.pnrcgc_cpf,
                                            x.pnopessoa,
                                            x.pdtnascimento,
                                            x.ptppessoa,
                                            x.pnrregistro,
                                            x.ptporigem,
                                            x.pnoabreviado_fornecedor,
                                            x.pcdn_fornecedor,
                                            x.pnoabreviado_cliente,
                                            x.pcdn_cliente,
                                            x.paodefinepessoa);

      exception
        when others then
          raise_application_error(-20100,
                                  ' Pessoa :' || x.pnrsequencial_origem || ' ' ||
                                  sqlerrm);
          null;
      end;

      ems506unicoo.pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                                 x.pcdacao,
                                                                 x.pcdidentificador,
                                                                 x.pnrsequencial_origem,
                                                                 x.pcdmodulo,
                                                                 x.pcdempresa,
                                                                 x.pnrseq_controle_integracao_org);

      if vcommit >= 500 then
        Commit;
        vcommit := 1;
      else
        vcommit := vcommit + 1;
      end if;
    end loop;
    commit;

    P_JOB;

    COMMIT;

    P_COD_UNIMED_FORNECEDOR;

    COMMIT;

  end P_CARGA_PESSOA_UNIMED;

  procedure P_COD_UNIMED_FORNECEDOR is
    cursor c_for is
      select distinct
             f.nrpessoa,
             a.cdareaacao
        from ti_fornecedor                       f,
             area_de_acao                        a,
             producao.fornecedor@unicoo_homologa xx
       where f.nrpessoa = xx.nrregistro_fornecedor
         and xx.cdfornecedor = a.cdprestador
         and f.cdsituacao = 'RC';

  begin
    for x in c_for loop

      update ti_pessoa p
         set p.cdn_fornecedor = x.cdareaacao, P.CDN_CLIENTE = X.cdareaacao
       where p.nrregistro = x.nrpessoa;

      update ti_fornecedor f
         set f.cod_fornecedor = x.cdareaacao
       where f.nrpessoa = x.nrpessoa;

    end loop;
    commit;
  end P_COD_UNIMED_FORNECEDOR;

  PROCEDURE P_CARGA_INICIAL_FORNECEDOR IS
    --------------------------------------
    -- gerar carga de pessoa do fornecedor
    --------------------------------------

    cursor c_pes is
      select distinct 'FN' ptpintegracao,
                      'I' pcdacao,
                      nvl(trim(replace(replace(replace(p.nrcgc_cpf,
                                                       '-',
                                                       null),
                                               ',',
                                               null),
                                       '.',
                                       null)),
                          '00000000000000') pnrcgc_cpf,
                      nvl(p.noabreviado, p.nopessoa) pnopessoa,
                      p.dtnascimento pdtnascimento,
                      p.tppessoa ptppessoa,
                      p.nrregistro pnrregistro,
                      'FORNECEDOR' ptporigem,
                      f.cdfornecedor pcdidentificador,
                      f.nrregistro_fornecedor pnrsequencial_origem,
                      '' pcdmodulo,
                      '' pcdempresa,
                      '' pnrseq_controle_integracao_org,
                      '' pnoabreviado_fornecedor,
                      '' pcdn_fornecedor,
                      '' pnoabreviado_cliente,
                      '' pcdn_cliente,
                      'S' paodefinepessoa
        from producao.fornecedor@unicoo_homologa f,
             pessoa                              p,
             ti_grupo_de_fornecedor              tif
       where f.nrregistro_fornecedor = p.nrregistro
         AND tif.cdgrupo_fornecedor = F.CDGRUPO_FORNECEDOR
         AND tif.cod_grp_fornecedor <> 'NAOM'
            --and p.nrregistro in (2744, 3184, 3893, 279633, 5781, 5780, 5763)
            --and f.nrregistro_fornecedor not in (560253,560241,591124,477920,587895)
            --and rownum <= 10

         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = f.cdfornecedor
                 and ci.tpintegracao = 'FN'
                 AND ci.cdsituacao <> 'CA')
       ORDER BY P.NRREGISTRO DESC;
    vcommit number;
  begin
    vcommit := 1;

    for x in c_pes loop
      begin
        pck_ems506unicoo.p_define_ti_pessoa(x.pnrcgc_cpf,
                                            x.pnopessoa,
                                            x.pdtnascimento,
                                            x.ptppessoa,
                                            x.pnrregistro,
                                            x.ptporigem,
                                            x.pnoabreviado_fornecedor,
                                            x.pcdn_fornecedor,
                                            x.pnoabreviado_cliente,
                                            x.pcdn_cliente,
                                            x.paodefinepessoa);

      exception
        when others then
          --raise_application_error(-20100,' Pessoa :'||x.pnrsequencial_origem||' '||sqlerrm);
          null;
      end;

      ems506unicoo.pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                                 x.pcdacao,
                                                                 x.pcdidentificador,
                                                                 x.pnrsequencial_origem,
                                                                 x.pcdmodulo,
                                                                 x.pcdempresa,
                                                                 x.pnrseq_controle_integracao_org);

      if vcommit >= 500 then
        Commit;
        vcommit := 1;
      else
        vcommit := vcommit + 1;
      end if;
    end loop;
    commit;

    p_job;

    COMMIT;

  end P_CARGA_INICIAL_FORNECEDOR;

  PROCEDURE P_CARGA_INICIAL_CLIENTE IS
    ----------------------------------
    -- Gerar pessoa cliente integração
    ----------------------------------

    cursor c_cli is
      select nvl(trim(replace(replace(replace(p.nrcgc_cpf, '-', null),
                                      ',',
                                      null),
                              '.',
                              null)),
                 '00000000000000') nrcgc_cpf,
            nvl(p.noabreviado, p.nopessoa)   nopessoa,
             p.dtnascimento,
             p.tppessoa,
             c.nrregistro_cliente,
             'CLIENTE' tipo,
             '' vnom_abrev_fornecedor,
             '' vcdn_fornecedor,
             '' vnom_abrev_cliente,
             '' vcdn_cliente,
             'S' incluir,
             c.cdcliente
        from PRODUCAO.cliente@UNICOO_HOMOLOGA c,
             pessoa                           p,
             ti_grupo_de_cliente              t
       where p.nrregistro = c.nrregistro_cliente
         and t.cdgrupo_cliente = c.cdgrupo_cliente
         and t.cdgrupo_cliente_ems_pj <> 'NAOM'
            --  and p.nrregistro in (2744, 3184, 3893, 279633, 5781, 5780, 5763)
            --  AND P.NRREGISTRO = 162009
            --and p.nrregistro not in (390925,156967,222739,404829)
            --and rownum <= 10
         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = c.cdcliente
                 and ci.tpintegracao = 'CL'
                 AND ci.cdsituacao <> 'CA')
       ORDER BY P.NRREGISTRO DESC;

       cursor c_carga_clientes is
       SELECT NRPESSOA_PAGA, TPPESSOA
  FROM (SELECT P.NRREGISTRO NRPESSOA_PAGA
          FROM CONTRATO_DA_PESSOA P
         WHERE NOT EXISTS (SELECT 1
                  FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA C
                 WHERE C.NRREGISTRO_CLIENTE = P.NRREGISTRO)
        UNION
        SELECT NVL(F.NRPESSOA_PAGA, F.NRPESSOA_TITULAR) NRREGISTRO
          FROM FAMILIA F
         WHERE F.DTINICIO_CONTRATO IS NOT NULL
           AND NOT EXISTS
         (SELECT 1
                  FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA C
                 WHERE C.NRREGISTRO_CLIENTE =
                       NVL(F.NRPESSOA_PAGA, F.NRPESSOA_TITULAR))
        UNION
        SELECT P2.NRPESSOA_PAGA
          FROM CONTRATO_DA_PESSOA P2
         WHERE P2.NRPESSOA_PAGA <> P2.NRREGISTRO
           AND NOT EXISTS
         (SELECT 1
                  FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA C2
                 WHERE C2.NRREGISTRO_CLIENTE = P2.NRPESSOA_PAGA)
        UNION
        SELECT NVL(F.NRPESSOA_PAGA, F.NRPESSOA_TITULAR) NRREGISTRO
          FROM CONTRATO_DA_PESSOA P2, FAMILIA F, USUARIO U
         WHERE P2.NRREGISTRO = U.NRREGISTRO
           AND P2.NRCONTRATO = U.NRCONTRATO
           AND F.NRREGISTRO = U.NRREGISTRO
           AND F.NRCONTRATO = U.NRCONTRATO
           AND F.NRFAMILIA = U.NRFAMILIA
           AND U.NRFAMILIA <> 0
           AND U.TPUSUARIO = 00
           AND P2.TPFATURA = 'U'
           AND NOT EXISTS
         (SELECT 1
                  FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA C
                 WHERE C.NRREGISTRO_CLIENTE =
                       NVL(F.NRPESSOA_PAGA, F.NRPESSOA_TITULAR))
        UNION
        SELECT NRREGISTRO_USUARIO NRPESSOA_PAGA
          FROM USUARIO US
         WHERE NRFAMILIA <> 0
           AND TPUSUARIO = 00
           AND UNICOOGPS.F_TM_PARAMETRO('CONTRATO_PEA') LIKE
               '%' || US.NRCONTRATO || '%'
           AND NOT EXISTS
         (SELECT 1
                  FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA CL
                 WHERE CL.NRREGISTRO_CLIENTE = US.NRREGISTRO_USUARIO)
        UNION
        SELECT A.NRPESSOA_PAGA
          FROM (SELECT L.NRPESSOA_PAGA,
                       L.NRCONTRATO,
                       P.NOPESSOA,
                       L.CDLOTACAO,
                       L.TXDESCRICAO,
                       NVL(CL.CDCLIENTE,
                           'NAO EXISTE CLIENTE COM ESTE NRPESSOA') CDCLIENTE
                  FROM PESSOA                           P,
                       LOTACAO                          L,
                       PRODUCAO.CLIENTE@UNICOO_HOMOLOGA CL,
                       CONTRATO_DA_PESSOA               CDP
                 WHERE P.NRREGISTRO = L.NRPESSOA_PAGA
                   AND CL.NRREGISTRO_CLIENTE(+) = L.NRPESSOA_PAGA
                   AND CDP.NRREGISTRO = L.NRREGISTRO
                   AND CDP.NRCONTRATO = L.NRCONTRATO
                   AND CDP.TPFATURA = 'L') A
         WHERE CDCLIENTE = 'NAO EXISTE CLIENTE COM ESTE NRPESSOA') B,
       PESSOA P
 WHERE B.NRPESSOA_PAGA = P.NRREGISTRO;
    vcommit number;

  begin

    vcommit := 1;

    FOR Y IN c_carga_clientes LOOP

      BEGIN
        PRODUCAO.p_gera_cliente@UNICOO_HOMOLOGA('M' || Y.NRPESSOA_PAGA,
                                                Y.NRPESSOA_PAGA,
                                                'M' || Y.NRPESSOA_PAGA,
                                                NULL,
                                                CASE WHEN Y.TPPESSOA = 'F' THEN 'P' ELSE 'E' END,
                                                NULL,
                                                'N');
      END;

    END LOOP;

    for x in c_cli loop
      begin
        ems506unicoo.pck_ems506unicoo.p_define_ti_pessoa(x.nrcgc_cpf,
                                                         x.nopessoa,
                                                         x.dtnascimento,
                                                         x.tppessoa,
                                                         x.nrregistro_cliente,
                                                         x.tipo,
                                                         x.vnom_abrev_fornecedor,
                                                         x.vcdn_fornecedor,
                                                         x.vnom_abrev_cliente,
                                                         x.vcdn_cliente,
                                                         x.incluir);

      exception
        when others then
          raise_application_error(-20100,
                                  ' Pessoa : ' || x.nrregistro_cliente ||
                                  ' - ' || sqlerrm);
          null;
      end;

      ems506unicoo.PCK_EMS506UNICOO.P_INS_TI_CONTROLE_INTEGRACAO('CL',
                                                                 'I',
                                                                 x.cdcliente,
                                                                 x.NRREGISTRO_cliente,
                                                                 null,
                                                                 NULL,
                                                                 NULL);

      if vcommit >= 500 then
        Commit;
        vcommit := 1;
      else
        vcommit := vcommit + 1;
      end if;
    end loop;
    commit;

    P_JOB;

    COMMIT;

  end P_CARGA_INICIAL_CLIENTE;

  PROCEDURE p_carga_tit_acr IS
    cursor c_tit is
      select 'TR' ptpintegracao,
             'I' pcdacao,
             t.nrdocumento pcdidentificador,
             t.nrregistro_titulo pnrsequencial_origem,
             '' pcdmodulo,
             t.cdempresa cdempresa,
             '' pnrseq_controle_integracao_org
        from producao.cliente@unicoo_homologa c,
             titulo_a_receber                 t,
             pessoa                           p
       where c.cdcliente = t.cdcliente
         and p.nrregistro = c.nrregistro_cliente
         and t.cdempresa = '00001'
         and t.cdsituacao in (0, 2)
            --    AND p.nrregistro = 5624
         and not exists
       (select 1
                from ti_controle_integracao x
               where x.tpintegracao = 'TR'
                 and x.nrsequencial_origem = t.nrregistro_titulo
                 and x.cdsituacao = 'IT')
         AND EXISTS (SELECT 1
                FROM ti_controle_integracao x
               WHERE x.nrsequencial_origem = p.nrregistro
                 AND x.tpintegracao = 'CL'
                 AND x.cdsituacao = 'IT');

    vConta number;
  begin
    vConta := 0;
    for x in c_tit loop
      pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                    x.pcdacao,
                                                    x.pcdidentificador,
                                                    x.pnrsequencial_origem,
                                                    x.pcdmodulo,
                                                    x.cdempresa,
                                                    x.pnrseq_controle_integracao_org);
      if vConta > 500 then
        commit;
        vConta := 0;
      end if;

      vConta := vConta + 1;

    end loop;
    commit;

    p_job;

    COMMIT;

  END p_carga_tit_acr;

  PROCEDURE p_carga_tit_apb IS
    --===================================================================================================
    ----------------------------------------
    -- gerar carga do titulos a pagar
    ----------------------------------------
    cursor c_tit is
      select 'TP' ptpintegracao,
             'I' pcdacao,
             t.nrdocumento pcdidentificador,
             t.nrregistro_titulo pnrsequencial_origem,
             '' pcdmodulo,
             t.cdempresa cdempresa,
             '' pnrseq_controle_integracao_org
        from producao.fornecedor@unicoo_homologa f,
             titulo_a_pagar                      t,
             pessoa                              p
       where t.cdfornecedor = f.cdfornecedor
         and f.nrregistro_fornecedor = p.nrregistro
         and t.cdempresa = '00001'
            --and t.dttitulo>='01/01/2011'
         and t.cdsituacao in (0, 2)
            --and decode(p.tppessoa,'F',f_validador_cpf(p.nrcgc_cpf),f_validador_cnpj(p.nrcgc_cpf)) = 'V'
         and not exists
       (select 1
                from ti_controle_integracao u
               where u.tpintegracao = 'TP'
                 and u.nrsequencial_origem = t.nrregistro_titulo
                 and u.cdsituacao <> 'CA')
         and exists (select 1
                from ti_fornecedor f
               where f.nrpessoa = p.nrregistro
                 and f.cdsituacao = 'IT')

      /*and exists (select 1 from ti_fornecedor u
      where u.nrpessoa = p.nrregistro
        and u.cdsituacao = 'IT')*/
      ;
  begin

    for x in c_tit loop
      pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                    x.pcdacao,
                                                    x.pcdidentificador,
                                                    x.pnrsequencial_origem,
                                                    x.pcdmodulo,
                                                    x.cdempresa,
                                                    x.pnrseq_controle_integracao_org);
      commit;
    end loop;

    p_job;
    COMMIT;

  END p_carga_tit_apb;

  procedure p_carga_tit_acr_fechado is

    cursor ctitulos is
      select nrregistro_TITULO
        from titulo_a_receber t
       where not exists (select 1
                from ti_controle_integracao tc
               where tc.nrsequencial_origem = t.nrregistro_titulo
                 and tc.tpintegracao = 'TR');

  begin
    for ct in ctitulos loop

      begin
        --TITULO
        insert into temp_tit_fechado
        values
          ('"' || 'TIT' || '"', SEQ_TITULO_FECHADO.NEXTVAL);

        insert into temp_tit_fechado
          select registro, SEQ_TITULO_FECHADO.NEXTVAL
            from v_titulo_fechado_acr_inf v
           where v.NRREGISTRO_TITULO = ct.nrregistro_titulo;

        --MOVIMENTOS
        insert into temp_tit_fechado
        values
          ('"' || 'MOVTO' || '"', SEQ_TITULO_FECHADO.NEXTVAL);

        insert into temp_tit_fechado
          select t.MOVIMENTO, SEQ_TITULO_FECHADO.NEXTVAL
            from v_titulo_fechado_acr_mov t

           where t.nrregistro_titulo = ct.nrregistro_titulo;

      exception
        when others then
          null;

      end;
      p_commit;

    end loop;
  end p_carga_tit_acr_fechado;

BEGIN
  -- Initialization
  -- Alessandro 20/03/2012
  SELECT VLPARAMETRO
    INTO WNAOREPROCESSA
    FROM TI_PARAMETRO_INTEGRACAO
   WHERE CDPARAMETRO = 'TPINTEGRACAONAOREPROCESSA';
  -- Alessandro 20/03/2012

  PCPF_DTNASCIMENTO := f_ti_parametro_integracao('CPF_DTNASCIMENTO');


  NULL;
END PCK_EMS506UNICOO_vini;
/

prompt
prompt Creating package body PCK_EMS506UNICOO_VJ
prompt =========================================
prompt
CREATE OR REPLACE PACKAGE BODY EMS506UNICOO."PCK_EMS506UNICOO_VJ" IS

  /*  -- Private type declarations
  type <TypeName> is <Datatype>;
  -- Private constant declarations
  <ConstantName> constant <Datatype> := <Value>;
  -- Private variable declarations
  <VariableName> <Datatype>;
  -- Function and procedure implementations
  function <FunctionName>(<Parameter> <Datatype>) return <Datatype> is
    <LocalVariable> <Datatype>;
  begin
    <Statement>;
    return(<Result>);
  end;*/
  /*
  ************************************************************************************************************************************************
  Criac?o          : Alecsandro Ferreira dos Santos
  Data             : 02/07/2009
  Modulo Principal : Integrac?o Unicoo X EMS5
  Modulos          : Integrac?o Unicoo X EMS5
  Objetivo         : Realizar a integrac?o do Unicoo com o EMS5
  Alteracoes
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL     | VERSAO          | PENDENCIA | ALTERACAO                                                                       |
  |----------------------------------------------------------------------------------------------------------------------------------------------|
  | 09/03/2012 | Alessandro      |                 |           | - Implementada controle de cancelamento de faturas, para permitir cancelar      |
  |            |                 |                 |           |   faturas no modulo faturamento que est?o contabilizadas no EMS5, foi criado o  |
  |            |                 |                 |           |   parametro CANCELFTCTBL com o valor "S" utiliza o controle, valor "N" n?o      |
  |            |                 |                 |           |   utiliza o controle.                                                           |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 21/03/2012 | Alessandro      |                 |           | - Foi realizado correc?o para controla a integrac?o das Faturas Cancelas com o  |
  |            |                 |                 |           |   EMS5, o parametro CANCELFTCTBL foi alterado, com o valor "S" n?o mudou, para  |
  |            |                 |                 |           |   o valor "N" a integrac?o n?o barra o cancelamento no modulo de Faturamento,   |
  |            |                 |                 |           |   mas so envia o estorno para o EMS5 quando o titulo esta contabilizado,        |
  |            |                 |                 |           |   enquanto isso o cancelamento fica pendente na integrac?o com a situac?o ER,   |
  |            |                 |                 |           |   quando o titulo e contabilizado a integrac?o libera o cancelamento            |
  |            |                 |                 |           |   para integrar.                                                                |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  | 31/05/2012 | Edmilson Braz Fo|                 |           | - O processo de integracao do ACR estava usando o historico do movimento 1 do   |
  |            |                 |                 |           |   titulo a receber para titulos sem fatura, porem, para o ajius n?o esta sendo  |
  |            |                 |                 |           |   o historico nesse movto, o processo foi alterado para pegar o titulo caso     |
  |            |                 |                 |           |   nulo no movimento.                                                            |
  +----------------------------------------------------------------------------------------------------------------------------------------------+
  ************************************************************************************************************************************************
  */
  -- parametros genericos
  VVERSAOFINANCEIRO VARCHAR2(10);

  WNAOREPROCESSA TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;
  PCPF_DTNASCIMENTO TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;

  TTIT_AP TIT_AP%ROWTYPE;

  PROCEDURE VALIDA_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                           PCDFORNECEDOR_EMS5         IN NUMBER) IS
    TTI_TIT_APB TI_TIT_APB%ROWTYPE;
    JAEXISTE    NUMBER;
  BEGIN
    SELECT *
      INTO TTI_TIT_APB
      FROM TI_TIT_APB A
     WHERE NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
    BEGIN
      SELECT COUNT(1)
        INTO JAEXISTE
        FROM TIT_AP A, TI_EMPRESA EMP
       WHERE 1 = 1
         AND A.CDN_FORNECEDOR = PCDFORNECEDOR_EMS5
         AND A.COD_TIT_AP = TTI_TIT_APB.COD_TITULO_AP
         AND A.COD_ESPEC_DOCTO = TTI_TIT_APB.COD_ESPEC_DOCTO
         AND A.COD_SER_DOCTO = TTI_TIT_APB.COD_SER_DOCTO
         AND A.COD_EMPRESA = EMP.COD_EMPRESA
         AND A.COD_PARCELA = TTI_TIT_APB.COD_PARCELA
         AND EMP.CDEMPRESA =
             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
      -- fabiano, nao foi encontrado necessidade de manter a delecao deste registro.
      --          delete ti_tit_apb where nrseq_controle_integracao = pnrseq_controle_integracao;
      -- fabiano,  caso encontre mais que 1 titulo, entao gera falha
      IF JAEXISTE > 0 THEN
        RAISE_APPLICATION_ERROR(-20010, 'Titulo ja existe no EMS');
      END IF;
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        NULL;
    END;
  END;

  PROCEDURE CANCELA_CONTROLE_TIT_IMPOSTOS(PNRSESSAO IN NUMBER) IS
    WTPDOC VARCHAR2(40);
  BEGIN
    /*
       Cancela os controles de titulos do contas a pagar unicoo referentes
       a impostos ( TX ), pois esses titulos n?o s?o integrados para o EMS
    */
    WTPDOC := F_PARAMETRO('TPDOCPRE');
    IF WTPDOC IS NULL THEN
      RAISE_APPLICATION_ERROR(-20001, 'Parametro TPDOCPRE n?o encontrado');
    END IF;
    FOR X IN (SELECT A.ROWID
                FROM TI_CONTROLE_INTEGRACAO A,
                     TITULO_A_PAGAR B
               WHERE A.NRSEQUENCIAL_ORIGEM = B.NRREGISTRO_TITULO
                 AND A.CDSITUACAO IN ('GE', 'ER', 'PE', 'RC') --ADICIONADO OUTRAS SITUACOES ALEM DE GE --BRAZ 11/11/10
                 AND A.TPINTEGRACAO = 'TP'
                 AND A.NRSESSAO     = PNRSESSAO
                 AND B.TPDOCUMENTO  = WTPDOC
                 AND NOT EXISTS (SELECT 1
                                     FROM TAXA_TITULO_INTEGRACAO T
                                    WHERE T.NRREGISTRO_TITULO_TAXA = B.NRREGISTRO_TITULO)
              ) LOOP
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'A integracao do unicoo com o ems5 nao integra titulos de previsao'
       WHERE ROWID = X.ROWID;
    END LOOP;
  END;

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_ACR(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
    VCTBZDA NUMBER; -- Alessandro 29/09/2011
    QTD_MOV NUMBER;
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TR'
         AND CI.NRSEQUENCIAL_ORIGEM = PNRRREGISTRO_TITULO
         AND CI.CDIDENTIFICADOR = PNRDOCUMENTO
         AND CI.CDIDENTIFICADOR NOT IN ('CA', 'RE');
    VACHOU BOOLEAN;
  BEGIN
    VACHOU := FALSE;
    FOR L_TITULO IN C_TITULO LOOP
      IF L_TITULO.CDSITUACAO = 'IT' THEN
        VACHOU := TRUE;
      ELSIF L_TITULO.CDSITUACAO IN ('GE', 'ER') THEN
        UPDATE TI_CONTROLE_INTEGRACAO TA
           SET TA.CDSITUACAO = 'CA', TA.TXOBSERVACAO = 'LINHA 152'
         WHERE TA.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
      ELSE
        BEGIN
          UPDATE TI_TIT_ACR TA
             SET TA.CDSITUACAO = 'CA'
           WHERE TA.NRSEQ_CONTROLE_INTEGRACAO = L_TITULO.NRSEQUENCIAL;
          -----
          UPDATE TI_CONTROLE_INTEGRACAO TA
             SET TA.CDSITUACAO = 'CA', TA.TXOBSERVACAO = 'LINHA 166'
           WHERE TA.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
        EXCEPTION
          WHEN OTHERS THEN
            VACHOU := TRUE;
            RAISE_APPLICATION_ERROR(-20101,
                                    'Erro ao cancelar a integrao da fatura ' ||
                                    PNRDOCUMENTO || ' ' || SQLERRM);
        END;
      END IF;
    END LOOP;
    IF VACHOU THEN
      SELECT COUNT(*)
        INTO QTD_MOV
        FROM EMS_MOVIMENTO_TITULO_ACR EMS, MOVTO_TIT_ACR MOV --BRAZ 10/12
       WHERE EMS.NUM_ID_MOVTO_TIT_ACR = MOV.NUM_ID_MOVTO_TIT_ACR
         AND MOV.U##COD_ESTAB = EMS.COD_ESTAB
         AND EMS.NRREGISTRO_TITULO = PNRRREGISTRO_TITULO;
      IF QTD_MOV > 1 THEN
        VRESULT := 'N';
      ELSE
        IF F_TI_PARAMETRO_INTEGRACAO('CANCELFTCTBL') = 'S' THEN
          -- ALESSANDRO 09/03/2012
          -- vResult:='S'; -- Alessandro 07/03/2012
          -- Inicio Alessandro 29/09/2011
          VCTBZDA := 0;
          SELECT MOV.LOG_APROP_CTBL_CTBZDA
            INTO VCTBZDA
            FROM EMS_MOVIMENTO_TITULO_ACR EMS, MOVTO_TIT_ACR MOV --BRAZ 10/12
           WHERE EMS.NUM_ID_MOVTO_TIT_ACR = MOV.NUM_ID_MOVTO_TIT_ACR
             AND MOV.U##COD_ESTAB = EMS.COD_ESTAB
             AND EMS.NRREGISTRO_TITULO = PNRRREGISTRO_TITULO;
          IF VCTBZDA = 0 THEN
            VRESULT := 'N';
            RAISE_APPLICATION_ERROR(-20101,
                                    'Titulo no EMS5 n?o esta contabilizado. Contabilize antes de Cancelar.');
          ELSE
            VRESULT := 'S';
          END IF;
          -- Final Alessandro 29/09/2011
        ELSE
          VRESULT := 'S';
        END IF; -- ALESSANDRO 09/03/2012
      END IF;
    ELSE
      VRESULT := 'S';
    END IF;
    RETURN VRESULT;
  END;

  FUNCTION F_PERMITE_CANCELAR_TI_TIT_APB(PNRDOCUMENTO        VARCHAR2,
                                         PNRRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TP'
         AND CI.NRSEQUENCIAL_ORIGEM = PNRRREGISTRO_TITULO
         AND CI.CDIDENTIFICADOR = PNRDOCUMENTO
         AND CI.CDIDENTIFICADOR NOT IN ('CA', 'RE');
    VACHOU BOOLEAN;
  BEGIN
    VACHOU := FALSE;
    FOR L_TITULO IN C_TITULO LOOP
      IF L_TITULO.CDSITUACAO = 'IT' THEN
        VACHOU := TRUE;
      ELSIF L_TITULO.CDSITUACAO IN ('GE', 'ER') THEN
        UPDATE TI_CONTROLE_INTEGRACAO TA
           SET TA.CDSITUACAO = 'CA', TA.TXOBSERVACAO = 'LINHA 250'
         WHERE TA.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
      ELSE
        BEGIN
          UPDATE TI_TIT_APB TA
             SET TA.CDSITUACAO = 'CA'
           WHERE TA.NRSEQ_CONTROLE_INTEGRACAO = L_TITULO.NRSEQUENCIAL;
        EXCEPTION
          WHEN OTHERS THEN
            VACHOU := TRUE;
            RAISE_APPLICATION_ERROR(-20101,
                                    'Erro ao cancelar a integrao da fatura ' ||
                                    PNRDOCUMENTO || ' ' || SQLERRM);
        END;
      END IF;
    END LOOP;
    IF VACHOU THEN
      VRESULT := 'N';
    ELSE
      VRESULT := 'S';
    END IF;
    RETURN VRESULT;
  END;

  FUNCTION F_PERMITE_ALTERAR_TIT_ACR(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
  BEGIN
    -- select DECODE(count(*),0,'S','N')
    SELECT CASE
             WHEN COUNT(*) < 1 THEN
              'S'
             ELSE
              'N'
           END
      INTO VRESULT
      FROM EMS_MOVIMENTO_TITULO_ACR EMS, EMS506UNICOO.TIT_ACR TTA --BRAZ 10/12
     WHERE EMS.NRDOCUMENTO = PNRDOCUMENTO
       AND EMS.NRREGISTRO_TITULO = PNRREGISTRO_TITULO
       AND EMS.NUM_ID_TIT_ACR = TTA.NUM_ID_TIT_ACR
       AND EMS.COD_ESTAB = TTA.U##COD_ESTAB
       AND EMS.IND_TRANS_ACR_ABREV = 'IMPL';
    -----------------------------
    RETURN VRESULT;
  END;

  FUNCTION F_PERMITE_ALTERAR_TIT_APB(PNRDOCUMENTO       VARCHAR2,
                                     PNRREGISTRO_TITULO NUMBER)
    RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
  BEGIN
    SELECT DECODE(COUNT(*), 0, 'S', 'N')
      INTO VRESULT
      FROM TI_MOVTO_TIT_AP EMS, TIT_AP TTA
     WHERE EMS.NRDOCUMENTO = PNRDOCUMENTO
       AND EMS.NRREGISTRO_TITULO = PNRREGISTRO_TITULO
       AND EMS.NUM_ID_TIT_AP = TTA.NUM_ID_TIT_AP
       AND EMS.COD_ESTAB = TTA.U##COD_ESTAB
       AND EMS.IND_TRANS_AP_ABREV = 'IMPL';
    -----------------------------
    RETURN VRESULT;
  END;

  PROCEDURE P_INS_TI_CONTROLE_INTEGRACAO(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER) IS
    VSEQUENCIAL TI_CONTROLE_INTEGRACAO.NRSEQUENCIAL%TYPE;
  BEGIN
    IF NOT F_TI_PARAMETRO_INTEGRACAO('TP_INTEGRACAO_ONLINE_UNICOO_EMS5') LIKE
        '%' || PTPINTEGRACAO || '%' THEN
      RETURN;
    END IF;
    SELECT SQ_TI_CONTROLE_INTEGRACAO.NEXTVAL INTO VSEQUENCIAL FROM DUAL;
    INSERT INTO TI_CONTROLE_INTEGRACAO
      (NRSEQUENCIAL,
       TPINTEGRACAO,
       DTGERACAO,
       NRSEQUENCIAL_ORIGEM,
       DTPROCESSAMENTO,
       DTINTEGRACAO,
       CDACAO,
       CDIDENTIFICADOR,
       CDSITUACAO,
       CDEMPRESA,
       CDMODULO,
       NRSEQ_CONTROLE_INTEGRACAO_ORG)
    VALUES
      (VSEQUENCIAL,
       PTPINTEGRACAO,
       SYSDATE,
       PNRSEQUENCIAL_ORIGEM,
       NULL,
       NULL,
       PCDACAO,
       PCDIDENTIFICADOR,
       'GE',
       PCDEMPRESA,
       PCDMODULO,
       PNRSEQ_CONTROLE_INTEGRACAO_ORG);
  END;

  PROCEDURE P_INS_TI_CONTROLE_INTEGR_CAN(PTPINTEGRACAO                  VARCHAR2,
                                         PCDACAO                        VARCHAR2,
                                         PCDIDENTIFICADOR               VARCHAR2,
                                         PNRSEQUENCIAL_ORIGEM           NUMBER,
                                         PCDMODULO                      VARCHAR2,
                                         PCDEMPRESA                     VARCHAR2,
                                         PNRSEQ_CONTROLE_INTEGRACAO_ORG NUMBER) IS
    VSEQUENCIAL TI_CONTROLE_INTEGRACAO.NRSEQUENCIAL%TYPE;
  BEGIN
    IF NOT F_TI_PARAMETRO_INTEGRACAO('TP_INTEGRACAO_ONLINE_UNICOO_EMS5') LIKE
        '%' || PTPINTEGRACAO || '%' THEN
      RETURN;
    END IF;
    SELECT SQ_TI_CONTROLE_INTEGRACAO.NEXTVAL INTO VSEQUENCIAL FROM DUAL;
    INSERT INTO TI_CONTROLE_INTEGRACAO
      (NRSEQUENCIAL,
       TPINTEGRACAO,
       DTGERACAO,
       NRSEQUENCIAL_ORIGEM,
       DTPROCESSAMENTO,
       DTINTEGRACAO,
       CDACAO,
       CDIDENTIFICADOR,
       CDSITUACAO,
       CDEMPRESA,
       CDMODULO,
       NRSEQ_CONTROLE_INTEGRACAO_ORG)
    VALUES
      (VSEQUENCIAL,
       PTPINTEGRACAO,
       SYSDATE,
       PNRSEQUENCIAL_ORIGEM,
       NULL,
       NULL,
       PCDACAO,
       PCDIDENTIFICADOR,
       'CA',
       PCDEMPRESA,
       PCDMODULO,
       PNRSEQ_CONTROLE_INTEGRACAO_ORG);
  END;

  /*PROCEDURE P_DEFINE_TI_PESSOA(PNRCGC_CPF              VARCHAR2,
                                 PNOPESSOA               VARCHAR2,
                                 PDTNASCIMENTO           DATE,
                                 PTPPESSOA               VARCHAR2,
                                 PNRREGISTRO             NUMBER,
                                 PTPORIGEM               VARCHAR2,
                                 PNOABREVIADO_FORNECEDOR IN OUT VARCHAR2,
                                 PCDN_FORNECEDOR         IN OUT VARCHAR2,
                                 PNOABREVIADO_CLIENTE    IN OUT VARCHAR2,
                                 PCDN_CLIENTE            IN OUT VARCHAR2,
                                 PAODEFINEPESSOA         VARCHAR2 -- < S/N>
                                 ) IS
      VNOM_ABREV_CLIENTE      TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
      VNOM_ABREV_FORNECEDOR   TI_PESSOA.NOABREVIADO_FORNECEDOR%TYPE;
      VNOABREVIADO_CLIENTE    TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
      VNOABREVIADO_FORNECEDOR TI_PESSOA.NOABREVIADO_FORNECEDOR%TYPE;
      VCDN_CLIENTE            TI_PESSOA.CDN_CLIENTE%TYPE;
      VCDN_FORNECEDOR         TI_PESSOA.CDN_FORNECEDOR%TYPE;
      VTI_PESSOA              TI_PESSOA%ROWTYPE;
      VTI_PESSOA_PAI          TI_PESSOA%ROWTYPE;
      VNOM_ABREVIADO          TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
      VCOUNT                  NUMBER;
      CNOM_ABREVIADO          TI_PESSOA.NOABREVIADO_CLIENTE%TYPE := 'p' ||
                                                                    PNRREGISTRO;
      --======================--
      -- Definir a Pessoa Pai --
      --------------------------
      PROCEDURE P_DEFINE_PESSOA_PAI IS
      BEGIN

      --============================================--
      --IMPLENTAÇÃO NOVA IGUAÇU DE/PARA REGISTRO PAI--
      --============================================--
        BEGIN
          SELECT TI.*
            INTO VTI_PESSOA
            FROM TI_PESSOA TI, TI_REGISTRO_PAI TRP
           WHERE TI.NRREGISTRO = TRP.NRREGISTRO_PAI
             AND TRP.NRREGISTRO_FILHO = PNRREGISTRO;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN

            IF PTPPESSOA = 'F' THEN
              BEGIN

                --============--
                -- CPF / NOME --
                ----------------
                SELECT TI.*
                  INTO VTI_PESSOA
                  FROM PESSOA PS, TI_PESSOA TI
                 WHERE TI.NRREGISTRO = PS.NRREGISTRO
                   AND PS.NRCGC_CPF = PNRCGC_CPF
                   AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
                   AND PS.TPPESSOA = PTPPESSOA
                   AND TI.NRREGISTRO_PAI IS NULL
                   AND ROWNUM = 1;
                VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CPF_PESSOA';
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  BEGIN
                    --==========================--
                    -- CPF / DATA DE NASCIMENTO --
                    ------------------------------
                    SELECT TI.*
                      INTO VTI_PESSOA
                      FROM PESSOA PS, TI_PESSOA TI
                     WHERE TI.NRREGISTRO = PS.NRREGISTRO
                       AND PS.NRCGC_CPF = PNRCGC_CPF
                       AND PS.DTNASCIMENTO = PDTNASCIMENTO
                       AND PS.TPPESSOA = PTPPESSOA
                       AND PS.DTNASCIMENTO IS NOT NULL
                       AND ROWNUM = 1;
                    VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CPF_DTNASCIMENTO';
                  EXCEPTION
                    WHEN NO_DATA_FOUND THEN
                      VTI_PESSOA := NULL;
                  END;
              END;
            ELSE
              BEGIN
                --======--
                -- CNPJ --
                ----------
                SELECT TI.*
                  INTO VTI_PESSOA
                  FROM PESSOA PS, TI_PESSOA TI
                 WHERE TI.NRREGISTRO = PS.NRREGISTRO
                   AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
                   AND PS.NRCGC_CPF = PNRCGC_CPF
                   AND PS.TPPESSOA = PTPPESSOA
                   AND TI.NRREGISTRO_PAI IS NULL
                   AND ROWNUM = 1;
                VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CNPJ';
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VTI_PESSOA := NULL;
              END;
            END IF;
        END;
      END; -- p_define_pessoa_pai
      --=======================--
      -- Busca Cliente no EMS5 --
      ---------------------------
      PROCEDURE P_BUSCA_CLIENTE_EMS IS
      BEGIN
        IF PTPPESSOA = 'F' THEN
          --=====================================--
          -- Verifica se o cliente pessoa fisica --
          -- existe no EMS5                      --
          -----------------------------------------
          BEGIN
            SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
              INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
              FROM CLIENTE CL, PESSOA_FISIC PF, TI_EMPRESA EMP
             WHERE PF.U##COD_ID_FEDER = PNRCGC_CPF
               AND PF.DAT_NASC_PESSOA_FISIC = PDTNASCIMENTO
               AND PF.NUM_PESSOA_FISIC = CL.NUM_PESSOA
               AND CL.COD_EMPRESA = EMP.COD_EMPRESA
               AND EMP.CDEMPRESA =
                   F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                SELECT DISTINCT CL.NOM_ABREV, CL.CDN_CLIENTE
                  INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
                  FROM CLIENTE CL, TI_EMPRESA EMP
                 WHERE CL.NOM_ABREV = VNOM_ABREVIADO
                   AND CL.COD_EMPRESA = EMP.COD_EMPRESA
                   AND EMP.CDEMPRESA =
                       F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VNOM_ABREV_CLIENTE := NULL;
                  VCDN_CLIENTE       := NULL;
              END;
          END;
        ELSE
          --======================================--
          -- Verifica se o cliente pessoa juridica --
          -- existe no EMS5                       --
          ------------------------------------------
          BEGIN
            SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
              INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
              FROM CLIENTE CL, PESSOA_JURID PJ, TI_EMPRESA EMP
             WHERE PJ.U##COD_ID_FEDER = PNRCGC_CPF
               AND PJ.NUM_PESSOA_JURID = CL.NUM_PESSOA
               AND CL.COD_EMPRESA = EMP.COD_EMPRESA
               AND EMP.CDEMPRESA =
                   F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
                  INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
                  FROM CLIENTE CL, TI_EMPRESA EMP
                 WHERE CL.NOM_ABREV = VNOM_ABREVIADO
                   AND CL.COD_EMPRESA = EMP.COD_EMPRESA
                   AND EMP.CDEMPRESA =
                       F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VNOM_ABREV_CLIENTE := NULL;
                  VCDN_CLIENTE       := NULL;
              END;
          END;
        END IF;
      END; -- Busca cliente ems5
      --=======================--
      -- Busca fornecedor no EMS5 --
      ---------------------------
      PROCEDURE P_BUSCA_FORNECEDOR_EMS IS
      BEGIN
        IF PTPPESSOA = 'F' THEN
          --=====================================--
          -- Verifica se o fornecedor pessoa fisica --
          -- existe no EMS5                      --
          -----------------------------------------
          BEGIN
            SELECT DISTINCT FN.NOM_ABREV, FN.CDN_FORNECEDOR
              INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
              FROM FORNECEDOR FN, PESSOA_FISIC PF, TI_EMPRESA EMP
             WHERE PF.U##COD_ID_FEDER = PNRCGC_CPF
               AND PF.DAT_NASC_PESSOA_FISIC = PDTNASCIMENTO
               AND PF.NUM_PESSOA_FISIC = FN.NUM_PESSOA
               AND FN.COD_EMPRESA = EMP.COD_EMPRESA
               AND EMP.CDEMPRESA =
                   F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                SELECT DISTINCT FN.NOM_ABREV, FN.CDN_FORNECEDOR
                  INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
                  FROM FORNECEDOR FN, TI_EMPRESA EMP
                 WHERE FN.NOM_ABREV = VNOM_ABREVIADO
                   AND FN.COD_EMPRESA = EMP.COD_EMPRESA
                   AND EMP.CDEMPRESA =
                       F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
                VNOM_ABREVIADO := CNOM_ABREVIADO;
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VNOM_ABREV_FORNECEDOR := NULL;
                  VCDN_FORNECEDOR       := NULL;
              END;
          END;
        ELSE
          --======================================--
          -- Verifica se o fornecedor pessoa juridica --
          -- existe no EMS5                       --
          ------------------------------------------
          BEGIN
            SELECT FN.NOM_ABREV, FN.CDN_FORNECEDOR
              INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
              FROM FORNECEDOR FN, PESSOA_JURID PJ, TI_EMPRESA EMP
             WHERE PJ.U##COD_ID_FEDER = PNRCGC_CPF
               AND PJ.NUM_PESSOA_JURID = FN.NUM_PESSOA
               AND FN.COD_EMPRESA = EMP.COD_EMPRESA
               AND EMP.CDEMPRESA =
                   F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                SELECT FN.NOM_ABREV, FN.CDN_FORNECEDOR
                  INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
                  FROM FORNECEDOR FN
                 WHERE FN.COD_EMPRESA =
                       F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')
                   AND FN.NOM_ABREV = VNOM_ABREVIADO;
                VNOM_ABREVIADO := CNOM_ABREVIADO;
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VNOM_ABREV_FORNECEDOR := NULL;
                  VCDN_FORNECEDOR       := NULL;
              END;
          END;
        END IF;
      END; -- Busca fornecedor ems5
      --==================--
      -- Define o cliente --
      ----------------------
      PROCEDURE P_DEFINE_CLIENTE IS
      BEGIN
        IF F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
           '%' || PNRCGC_CPF || '%' AND PNRCGC_CPF IS NOT NULL THEN
          --------------------------
          -- Definir a pessoa PAI --
          --------------------------
          P_DEFINE_PESSOA_PAI;
          IF VTI_PESSOA.NRREGISTRO IS NULL THEN
            BEGIN
              SELECT TI.*
                INTO VTI_PESSOA
                FROM TI_PESSOA TI
               WHERE TI.NOABREVIADO_CLIENTE = PNRCGC_CPF
                 AND TI.NRREGISTRO_PAI IS NULL
                 AND ROWNUM = 1;
              VNOM_ABREVIADO := CNOM_ABREVIADO;
              VTI_PESSOA     := NULL;
            EXCEPTION
              --======================================--
              -- Caso o CPF/CPNPJ no existir o nome  --
              -- abreviado ser o CPF/CNPJ            --
              ------------------------------------------
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA     := NULL;
                VNOM_ABREVIADO := PNRCGC_CPF;
            END;
          ELSE
            VNOM_ABREVIADO := PNRCGC_CPF;
  --          VTI_PESSOA     := NULL;
          END IF;
        ELSE
          VNOM_ABREVIADO := CNOM_ABREVIADO;
          VTI_PESSOA     := NULL;
        END IF;
        IF VTI_PESSOA_PAI.NRREGISTRO IS NULL THEN
          ----------------------------
          P_BUSCA_CLIENTE_EMS;
          ----------------------------
          IF VNOM_ABREV_CLIENTE IS NOT NULL THEN
            VNOM_ABREVIADO := VNOM_ABREV_CLIENTE;
          END IF;
          VTI_PESSOA_PAI := NULL;
          BEGIN
            SELECT PS.*
              INTO VTI_PESSOA_PAI
              FROM TI_PESSOA PS
             WHERE PS.NOABREVIADO_CLIENTE = SUBSTR(VNOM_ABREVIADO,0,12)
               AND NOT EXISTS (SELECT 1
                      FROM TI_PESSOA PST
                     WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA_PAI := NULL;
          END;
        ELSIF VTI_PESSOA.NRREGISTRO IS NOT NULL THEN
          SELECT PS.*
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_CLIENTE = SUBSTR(VNOM_ABREVIADO,0,12)
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        END IF;
      END; -- fim p_define_cliente
      --==================--
      -- Define o fornecedor --
      ----------------------
      PROCEDURE P_DEFINE_FORNECEDOR IS
      BEGIN
        IF F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
           '%' || PNRCGC_CPF || '%' AND PNRCGC_CPF IS NOT NULL THEN
          --------------------------
          -- Definir a pessoa PAI --
          --------------------------
          P_DEFINE_PESSOA_PAI;
          IF VTI_PESSOA.NRREGISTRO IS NULL THEN
            BEGIN
              SELECT TI.*
                INTO VTI_PESSOA
                FROM TI_PESSOA TI
               WHERE TI.NOABREVIADO_FORNECEDOR = PNRCGC_CPF
                 AND TI.NRREGISTRO_PAI IS NULL
                 AND ROWNUM = 1;
              VNOM_ABREVIADO := CNOM_ABREVIADO;
              VTI_PESSOA     := NULL;
            EXCEPTION
              --======================================--
              -- Caso o CPF/CPNPJ no existir o nome  --
              -- abreviado ser o CPF/CNPJ            --
              ------------------------------------------
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA     := NULL;
                VNOM_ABREVIADO := PNRCGC_CPF;
            END;
          ELSE
            VNOM_ABREVIADO := PNRCGC_CPF;
            VTI_PESSOA     := NULL;
          END IF;
        ELSE
          VNOM_ABREVIADO := CNOM_ABREVIADO;
          VTI_PESSOA     := NULL;
        END IF;
        IF VTI_PESSOA_PAI.NRREGISTRO IS NULL THEN
          -----------------------
          P_BUSCA_FORNECEDOR_EMS;
          -----------------------
          IF VNOM_ABREV_FORNECEDOR IS NOT NULL THEN
            VNOM_ABREVIADO := VNOM_ABREV_FORNECEDOR;
          END IF;
          VTI_PESSOA_PAI := NULL;
          BEGIN
            SELECT PS.*
              INTO VTI_PESSOA_PAI
              FROM TI_PESSOA PS
             WHERE PS.NOABREVIADO_FORNECEDOR = VNOM_ABREVIADO
               AND NOT EXISTS (SELECT 1
                      FROM TI_PESSOA PST
                     WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA_PAI := NULL;
          END;
        ELSIF VTI_PESSOA.NRREGISTRO IS NOT NULL THEN
          SELECT PS.*
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_FORNECEDOR = VNOM_ABREVIADO
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        END IF;
      END; -- fim p_define_fornecedor
      --inicia aqui
    BEGIN
      VTI_PESSOA     := NULL;
      VTI_PESSOA_PAI := NULL;
      SELECT COUNT(*)
        INTO VCOUNT
        FROM TI_PESSOA P
       WHERE P.NRREGISTRO = PNRREGISTRO;
      IF VCOUNT = 0 THEN
        IF PAODEFINEPESSOA = 'S' THEN
          IF NOT F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
              '%' || PNRCGC_CPF || '%' THEN
            VNOABREVIADO_CLIENTE    := CNOM_ABREVIADO;
            VNOABREVIADO_FORNECEDOR := CNOM_ABREVIADO;
            VCDN_FORNECEDOR         := NULL;
            VCDN_CLIENTE            := NULL;
          ELSE
            IF PTPORIGEM = 'CLIENTE' THEN
              ---------------------------
              P_DEFINE_CLIENTE;
              ---------------------------
              --========================--
              -- Se for uma pessoa nova --
              ----------------------------
              IF VTI_PESSOA.NRREGISTRO IS NULL THEN
                ----------------------------
                -- Nome abreviado cliente --
                ----------------------------
                IF VCDN_CLIENTE IS NOT NULL THEN
                  VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                  VNOABREVIADO_CLIENTE   := VNOM_ABREV_CLIENTE;
                ELSE
                  VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                  VNOABREVIADO_CLIENTE   := VNOM_ABREVIADO;
                END IF;
                ------------------------------
                -- Verifica se  fornecedor --
                ------------------------------
                P_BUSCA_FORNECEDOR_EMS;
                -------------------------------
                -- Nome abreviado fornecedor --
                -------------------------------
                IF VCDN_FORNECEDOR IS NOT NULL THEN
                  VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                  VNOABREVIADO_FORNECEDOR   := VNOM_ABREV_FORNECEDOR;
                ELSE
                  VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                  VNOABREVIADO_FORNECEDOR   := VNOM_ABREVIADO;
                END IF;
              END IF;
            ELSE
              -------------------------------
              P_DEFINE_FORNECEDOR;
              -------------------------------
              --========================--
              -- Se for uma pessoa nova --
              ----------------------------
              IF VTI_PESSOA.NRREGISTRO IS NULL THEN
                -------------------------------
                -- Nome abreviado fornecedor --
                -------------------------------
                IF VCDN_FORNECEDOR IS NOT NULL THEN
                  VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                  VNOABREVIADO_FORNECEDOR   := VNOM_ABREV_FORNECEDOR;
                ELSE
                  VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                  VNOABREVIADO_FORNECEDOR   := VNOM_ABREVIADO;
                END IF;
                ------------------------------
                -- verifica se  cliente --
                ------------------------------
                P_BUSCA_CLIENTE_EMS;
                ----------------------------
                -- nome abreviado cliente --
                ----------------------------
                IF VCDN_CLIENTE IS NOT NULL THEN
                  VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                  VNOABREVIADO_CLIENTE   := VNOM_ABREV_CLIENTE;
                ELSE
                  VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                  VNOABREVIADO_CLIENTE   := VNOM_ABREVIADO;
                END IF;
              END IF;
            END IF;
          END IF;
        ELSE
          BEGIN
            SELECT *
              INTO VTI_PESSOA_PAI
              FROM TI_PESSOA PS
             WHERE PS.NOABREVIADO_CLIENTE = PNOABREVIADO_CLIENTE
               AND NOT EXISTS (SELECT 1
                      FROM TI_PESSOA PST
                     WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
               AND ROWNUM = 1;
          EXCEPTION
            WHEN OTHERS THEN
              BEGIN
                SELECT *
                  INTO VTI_PESSOA_PAI
                  FROM TI_PESSOA PS
                 WHERE PS.NOABREVIADO_FORNECEDOR = PNOABREVIADO_FORNECEDOR
                   AND NOT EXISTS
                 (SELECT 1
                          FROM TI_PESSOA PST
                         WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
                   AND ROWNUM = 1;
              EXCEPTION
                WHEN OTHERS THEN
                  VTI_PESSOA_PAI := NULL;
              END;
          END;
        END IF;
        IF VTI_PESSOA.NRREGISTRO IS NULL THEN
          VTI_PESSOA.NRREGISTRO             := PNRREGISTRO;
          VTI_PESSOA.NOABREVIADO_CLIENTE    := VNOABREVIADO_CLIENTE;
          VTI_PESSOA.NOABREVIADO_FORNECEDOR := VNOABREVIADO_FORNECEDOR;
          VTI_PESSOA.CDN_FORNECEDOR         := VCDN_FORNECEDOR;
          VTI_PESSOA.CDN_CLIENTE            := VCDN_CLIENTE;
          VTI_PESSOA.NRREGISTRO_PAI         := NULL;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO    := NULL;
          VTI_PESSOA.NOPESSOA               := PNOPESSOA;
          VTI_PESSOA.DTNASCIMENTO           := PDTNASCIMENTO;
          VTI_PESSOA.NRCGC_CPF              := PNRCGC_CPF;
          VTI_PESSOA.NRREGISTRO_PAI         := VTI_PESSOA_PAI.NRREGISTRO;
        ELSE
          VTI_PESSOA.NRREGISTRO_PAI := VTI_PESSOA_PAI.NRREGISTRO;
          VTI_PESSOA.NRREGISTRO     := PNRREGISTRO;
          VTI_PESSOA.NOPESSOA       := PNOPESSOA;
          VTI_PESSOA.DTNASCIMENTO   := PDTNASCIMENTO;
          VTI_PESSOA.NRCGC_CPF      := PNRCGC_CPF;
        END IF;

        IF F_TI_PARAMETRO_INTEGRACAO('INTR_EMS2') = 'S' THEN
          VTI_PESSOA.NOABREVIADO_CLIENTE    := SUBSTR(VTI_PESSOA.NOABREVIADO_CLIENTE,
                                                      0,
                                                      12);
          VTI_PESSOA.NOABREVIADO_FORNECEDOR := SUBSTR(VTI_PESSOA.NOABREVIADO_FORNECEDOR,
                                                      0,
                                                      12);
        END IF;

  BEGIN

        BEGIN
          SELECT NRREGISTRO INTO VTI_PESSOA.NRREGISTRO_PAI  FROM TI_PESSOA TP WHERE
          TP.NOABREVIADO_CLIENTE = VTI_PESSOA.NOABREVIADO_CLIENTE
          AND TP.NOABREVIADO_FORNECEDOR    = VTI_PESSOA.NOABREVIADO_FORNECEDOR
          AND ROWNUM =1;

          EXCEPTION WHEN NO_DATA_FOUND THEN
          VTI_PESSOA.NRREGISTRO_PAI:= NULL;
  END;
        INSERT INTO TI_PESSOA
          (NRREGISTRO,
           NOABREVIADO_CLIENTE,
           NOABREVIADO_FORNECEDOR,
           CDN_FORNECEDOR,
           CDN_CLIENTE,
           NRREGISTRO_PAI,
           TXREGRA_AGRUPAMENTO,
           NOPESSOA,
           DTNASCIMENTO,
           NRCGC_CPF,
           DTGERACAO,
           DTULTIMA_ATUALIZACAO)
        VALUES
          (VTI_PESSOA.NRREGISTRO,
           VTI_PESSOA.NOABREVIADO_CLIENTE,
           VTI_PESSOA.NOABREVIADO_FORNECEDOR,
           VTI_PESSOA.CDN_FORNECEDOR,
           VTI_PESSOA.CDN_CLIENTE,
           VTI_PESSOA.NRREGISTRO_PAI,
           VTI_PESSOA.TXREGRA_AGRUPAMENTO,
           VTI_PESSOA.NOPESSOA,
           VTI_PESSOA.DTNASCIMENTO,
           VTI_PESSOA.NRCGC_CPF,
           SYSDATE,
           SYSDATE);


        PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
        PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
        PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
        PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;

  EXCEPTION WHEN DUP_VAL_ON_INDEX THEN
    INSERT INTO TI_PESSOA
          (NRREGISTRO,
           NOABREVIADO_CLIENTE,
           NOABREVIADO_FORNECEDOR,
           CDN_FORNECEDOR,
           CDN_CLIENTE,
           NRREGISTRO_PAI,
           TXREGRA_AGRUPAMENTO,
           NOPESSOA,
           DTNASCIMENTO,
           NRCGC_CPF,
           DTGERACAO,
           DTULTIMA_ATUALIZACAO)
        VALUES
          (VTI_PESSOA.NRREGISTRO,
           'p'||VTI_PESSOA.NRREGISTRO,
           'p'||VTI_PESSOA.NRREGISTRO,
           VTI_PESSOA.CDN_FORNECEDOR,
           VTI_PESSOA.CDN_CLIENTE,
           VTI_PESSOA.NRREGISTRO_PAI,
           VTI_PESSOA.TXREGRA_AGRUPAMENTO,
           VTI_PESSOA.NOPESSOA,
           VTI_PESSOA.DTNASCIMENTO,
           VTI_PESSOA.NRCGC_CPF,
           SYSDATE,
           SYSDATE);

    END;



      ELSE
        SELECT *
          INTO VTI_PESSOA
          FROM TI_PESSOA
         WHERE NRREGISTRO = PNRREGISTRO;
        PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
        PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
        PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
        PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;
      END IF;
    END;*/

  PROCEDURE P_DEFINE_TI_PESSOA(PNRCGC_CPF              VARCHAR2,
                               PNOPESSOA               VARCHAR2,
                               PDTNASCIMENTO           DATE,
                               PTPPESSOA               VARCHAR2,
                               PNRREGISTRO             NUMBER,
                               PTPORIGEM               VARCHAR2,
                               PNOABREVIADO_FORNECEDOR IN OUT VARCHAR2,
                               PCDN_FORNECEDOR         IN OUT VARCHAR2,
                               PNOABREVIADO_CLIENTE    IN OUT VARCHAR2,
                               PCDN_CLIENTE            IN OUT VARCHAR2,
                               PAODEFINEPESSOA         VARCHAR2 -- < S/N>
                               ) IS
    VTI_PESSOA       TI_PESSOA%ROWTYPE;
    VTI_PESSOA_PAI   TI_PESSOA%ROWTYPE;
    VCOUNT           NUMBER;
    VEXISTE_PESSOA   CHAR;
    VEXISTE_REGISTRO CHAR;
    CNOM_ABREVIADO   TI_PESSOA.NOABREVIADO_CLIENTE%TYPE := 'p' ||
                                                           PNRREGISTRO;
    VCOD_EMS         NUMBER := 1000;
    VCOD_EMS_AUX     NUMBER := 0;
    VEXISTE_COD      CHAR;
    vaoexiste_nome   char;
    vnom_abrev       varchar2(12);
    qttamanho        number;
    vnum_aux         number := 0;
    vcount           number;

    FUNCTION F_TESTA_NOME(PNOME_ABREV TI_PESSOA.NOABREVIADO_CLIENTE%TYPE)
      RETURN CHAR IS

      VEXISTE_NOME CHAR;

    BEGIN
      BEGIN
        SELECT 'S'
          INTO VEXISTE_NOME
          FROM TI_PESSOA P
         WHERE P.NOABREVIADO_CLIENTE = PNOME_ABREV
         AND ROWNUM = 1;
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          VEXISTE_NOME := 'N';
      END;

      RETURN VEXISTE_NOME;

    END;
    --======================--
    -- Definir a Pessoa Pai --
    --------------------------
    PROCEDURE P_DEFINE_PESSOA_PAI IS
    BEGIN
      IF PTPPESSOA = 'F' THEN
        BEGIN
          --============--
          -- CPF / NOME --
          ----------------
          SELECT TI.*
            INTO VTI_PESSOA_PAI
            FROM PESSOA PS, TI_PESSOA TI
           WHERE TI.NRREGISTRO = PS.NRREGISTRO
             AND PS.NRCGC_CPF = PNRCGC_CPF
             AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
             AND PS.TPPESSOA = PTPPESSOA
             AND TI.NRREGISTRO_PAI IS NULL
             AND ROWNUM = 1
           ORDER BY TI.NRREGISTRO DESC;
          VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO := 'CPF_PESSOA';
        EXCEPTION
          WHEN NO_DATA_FOUND THEN

        IF PCPF_DTNASCIMENTO = 'S' THEN
            BEGIN
              --==========================--
              -- CPF / DATA DE NASCIMENTO --
              ------------------------------
              SELECT TI.*
                INTO VTI_PESSOA_PAI
                FROM PESSOA PS, TI_PESSOA TI
               WHERE TI.NRREGISTRO = PS.NRREGISTRO
                 AND PS.NRCGC_CPF = PNRCGC_CPF
                 AND PS.DTNASCIMENTO = PDTNASCIMENTO
                 AND PS.TPPESSOA = PTPPESSOA
                 AND PS.DTNASCIMENTO IS NOT NULL
                 AND ROWNUM = 1
               ORDER BY TI.NRREGISTRO DESC;
              VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO := 'CPF_DTNASCIMENTO';
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA_PAI := NULL;
            END;
      ELSE
        VTI_PESSOA_PAI := NULL;
       END IF;
        END;
      ELSE
        BEGIN
          --======--
          -- CNPJ --
          ----------
          SELECT TI.*
            INTO VTI_PESSOA_PAI
            FROM PESSOA PS, TI_PESSOA TI
           WHERE TI.NRREGISTRO = PS.NRREGISTRO
             AND PS.NRCGC_CPF = PNRCGC_CPF
             AND PS.TPPESSOA = PTPPESSOA
             AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
             AND TI.NRREGISTRO_PAI IS NULL
             AND ROWNUM = 1
           ORDER BY TI.NRREGISTRO DESC;
          VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO := 'CNPJ';
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            VTI_PESSOA_PAI := NULL;
        END;
      END IF;
    END P_DEFINE_PESSOA_PAI; -- p_define_pessoa_pai

  BEGIN

    VTI_PESSOA_PAI := NULL;
    VEXISTE_COD    := 'N';

    BEGIN
      SELECT 'S'
        INTO VEXISTE_REGISTRO
        FROM TI_PESSOA T
       WHERE T.NRREGISTRO = PNRREGISTRO;
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        VEXISTE_REGISTRO := 'N';
    END;

    IF VEXISTE_REGISTRO = 'N' THEN

      BEGIN
        SELECT 'S'
          INTO VEXISTE_PESSOA
          FROM TI_PESSOA TP
         WHERE TP.NRCGC_CPF = PNRCGC_CPF
           AND ROWNUM = 1
           and f_ti_parametro_integracao('UNIFICA_PESSOA') = 'S';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          VEXISTE_PESSOA := 'N';
      END;


    --SE NAO EXISTE NINGUEM COM ESTE CPF/CNPJ INSERE NA TABELA TI_PESSOA
      IF VEXISTE_PESSOA = 'N' THEN

        VTI_PESSOA.NRREGISTRO          := PNRREGISTRO;
        VTI_PESSOA.NRREGISTRO_PAI      := NULL;
        VTI_PESSOA.TXREGRA_AGRUPAMENTO := NULL;
        VTI_PESSOA.NOPESSOA            := PNOPESSOA;
        VTI_PESSOA.DTNASCIMENTO        := PDTNASCIMENTO;
        VTI_PESSOA.NRCGC_CPF           := PNRCGC_CPF;

        --VINICIUS 30/08 NOVA DEFINICAO PARA NOME ABREVIADO NO EMS5
        vnom_abrev := trim(F_ABREVIA_NOME(VTI_PESSOA.NOPESSOA, 12, 'PEA'));

        vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

        WHILE vaoexiste_nome = 'S' LOOP

          vnum_aux := vnum_aux + 1;

          qttamanho := length(vnum_aux);

          vnom_abrev := substr(vnom_abrev, 0, (12 - qttamanho)) || vnum_aux;

          vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

        END LOOP;

        VTI_PESSOA.NOABREVIADO_CLIENTE := vnom_abrev;

        VTI_PESSOA.NOABREVIADO_FORNECEDOR := vnom_abrev;

        /* VTI_PESSOA.NOABREVIADO_CLIENTE := CASE
                                              WHEN f_ti_parametro_integracao('INTR_EMS2') = 'S' THEN
                                               SUBSTR(PNRCGC_CPF, 0, 12)
                                              ELSE
                                               PNRCGC_CPF
                                            END;

          VTI_PESSOA.NOABREVIADO_FORNECEDOR := CASE
                                                 WHEN f_ti_parametro_integracao('INTR_EMS2') = 'S' THEN
                                                  SUBSTR(PNRCGC_CPF, 0, 12)
                                                 ELSE
                                                  PNRCGC_CPF
                                               END;
        */


      --SE A ORIGEM FOR "UNIMED" NAO PREENCHE O CODIGO CLIENTE / FORNECEDOR
        IF PTPORIGEM = 'UNIMED' THEN
          VTI_PESSOA.CDN_FORNECEDOR := NULL;
          VTI_PESSOA.CDN_CLIENTE    := NULL;
        ELSE

        --SE A ORIGEM FOR FOR "UNIMED" PREENCHE O CODIGO CLIENTE / FORNECEDOR
          BEGIN
            SELECT 'S'
              INTO VEXISTE_COD
              FROM TI_PESSOA TP
             WHERE NVL(TP.CDN_CLIENTE, 0) >= VCOD_EMS
               AND ROWNUM = 1;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS;
              VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS;
          END;

          IF VEXISTE_COD = 'S' THEN
            BEGIN
              SELECT MAX(CDN_CLIENTE) + 1 INTO VCOD_EMS_AUX FROM TI_PESSOA;
            END;
            VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS_AUX;
            VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS_AUX;

          END IF;

        END IF;

        INSERT INTO TI_PESSOA
          (NRREGISTRO,
           NOABREVIADO_CLIENTE,
           NOABREVIADO_FORNECEDOR,
           CDN_FORNECEDOR,
           CDN_CLIENTE,
           NRREGISTRO_PAI,
           TXREGRA_AGRUPAMENTO,
           NOPESSOA,
           DTNASCIMENTO,
           NRCGC_CPF,
           DTGERACAO,
           DTULTIMA_ATUALIZACAO)
        VALUES
          (VTI_PESSOA.NRREGISTRO,
           VTI_PESSOA.NOABREVIADO_CLIENTE,
           VTI_PESSOA.NOABREVIADO_FORNECEDOR,
           VTI_PESSOA.CDN_FORNECEDOR,
           VTI_PESSOA.CDN_CLIENTE,
           VTI_PESSOA.NRREGISTRO_PAI,
           VTI_PESSOA.TXREGRA_AGRUPAMENTO,
           VTI_PESSOA.NOPESSOA,
           VTI_PESSOA.DTNASCIMENTO,
           VTI_PESSOA.NRCGC_CPF,
           SYSDATE,
           SYSDATE);
        PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
        PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
        PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
        PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;

      ELSE

      --SE ACHOU UM CPF/CPNJ PROCURA O REGISTRO PAI
        P_DEFINE_PESSOA_PAI;



      --SE ENCONTROU FAZ OS VINCULOS
        IF VTI_PESSOA_PAI.NRREGISTRO IS NOT NULL THEN

          VTI_PESSOA.NRREGISTRO             := PNRREGISTRO;
          VTI_PESSOA.NOABREVIADO_CLIENTE    := VTI_PESSOA_PAI.NOABREVIADO_CLIENTE;
          VTI_PESSOA.NOABREVIADO_FORNECEDOR := VTI_PESSOA_PAI.NOABREVIADO_FORNECEDOR;
          VTI_PESSOA.CDN_FORNECEDOR         := VTI_PESSOA_PAI.CDN_FORNECEDOR;
          VTI_PESSOA.CDN_CLIENTE            := VTI_PESSOA_PAI.CDN_CLIENTE;
          VTI_PESSOA.NRREGISTRO_PAI         := VTI_PESSOA_PAI.NRREGISTRO;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO    := VTI_PESSOA_PAI.TXREGRA_AGRUPAMENTO;
          VTI_PESSOA.NOPESSOA               := PNOPESSOA;
          VTI_PESSOA.DTNASCIMENTO           := PDTNASCIMENTO;
          VTI_PESSOA.NRCGC_CPF              := PNRCGC_CPF;

          INSERT INTO TI_PESSOA
            (NRREGISTRO,
             NOABREVIADO_CLIENTE,
             NOABREVIADO_FORNECEDOR,
             CDN_FORNECEDOR,
             CDN_CLIENTE,
             NRREGISTRO_PAI,
             TXREGRA_AGRUPAMENTO,
             NOPESSOA,
             DTNASCIMENTO,
             NRCGC_CPF,
             DTGERACAO,
             DTULTIMA_ATUALIZACAO)
          VALUES
            (VTI_PESSOA.NRREGISTRO,
             VTI_PESSOA.NOABREVIADO_CLIENTE,
             VTI_PESSOA.NOABREVIADO_FORNECEDOR,
             VTI_PESSOA.CDN_FORNECEDOR,
             VTI_PESSOA.CDN_CLIENTE,
             VTI_PESSOA.NRREGISTRO_PAI,
             VTI_PESSOA.TXREGRA_AGRUPAMENTO,
             VTI_PESSOA.NOPESSOA,
             VTI_PESSOA.DTNASCIMENTO,
             VTI_PESSOA.NRCGC_CPF,
             SYSDATE,
             SYSDATE);
          PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
          PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
          PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
          PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;


        --SE NAO ENCONTROU INSERE PESSOA COM CPF/CNPJ REPETIDO, MAS ALTERANDO O NOME ABREVIADO
        ELSE

      VTI_PESSOA.NRREGISTRO             := PNRREGISTRO;
          VTI_PESSOA.NRREGISTRO_PAI         := NULL;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO    := NULL;
          VTI_PESSOA.NOPESSOA               := PNOPESSOA;
          VTI_PESSOA.DTNASCIMENTO           := PDTNASCIMENTO;
          VTI_PESSOA.NRCGC_CPF              := PNRCGC_CPF;



            --VINICIUS 30/08 NOVA DEFINICAO PARA NOME ABREVIADO NO EMS5
        vnom_abrev := trim(F_ABREVIA_NOME(VTI_PESSOA.NOPESSOA, 12, 'PEA'));

        vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

        WHILE vaoexiste_nome = 'S' LOOP

          vnum_aux := vnum_aux + 1;

          qttamanho := length(vnum_aux);

          vnom_abrev := substr(vnom_abrev, 0, (12 - qttamanho)) || vnum_aux;

          vaoexiste_nome := F_TESTA_NOME(vnom_abrev);

        END LOOP;

        VTI_PESSOA.NOABREVIADO_CLIENTE := vnom_abrev;

        VTI_PESSOA.NOABREVIADO_FORNECEDOR := vnom_abrev;

          IF PTPORIGEM = 'UNIMED' THEN
            VTI_PESSOA.CDN_FORNECEDOR := NULL;
            VTI_PESSOA.CDN_CLIENTE    := NULL;
          ELSE

            BEGIN
              SELECT 'S'
                INTO VEXISTE_COD
                FROM TI_PESSOA TP
               WHERE NVL(TP.CDN_CLIENTE, 0) >= VCOD_EMS
                 AND ROWNUM = 1;
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS;
                VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS;
            END;

            IF VEXISTE_COD = 'S' THEN
              BEGIN
                SELECT MAX(CDN_CLIENTE) + 1
                  INTO VCOD_EMS_AUX
                  FROM TI_PESSOA;
              END;
              VTI_PESSOA.CDN_FORNECEDOR := VCOD_EMS_AUX;
              VTI_PESSOA.CDN_CLIENTE    := VCOD_EMS_AUX;

            END IF;

          END IF;

          INSERT INTO TI_PESSOA
            (NRREGISTRO,
             NOABREVIADO_CLIENTE,
             NOABREVIADO_FORNECEDOR,
             CDN_FORNECEDOR,
             CDN_CLIENTE,
             NRREGISTRO_PAI,
             TXREGRA_AGRUPAMENTO,
             NOPESSOA,
             DTNASCIMENTO,
             NRCGC_CPF,
             DTGERACAO,
             DTULTIMA_ATUALIZACAO)
          VALUES
            (VTI_PESSOA.NRREGISTRO,
             VTI_PESSOA.NOABREVIADO_CLIENTE,
             VTI_PESSOA.NOABREVIADO_FORNECEDOR,
             VTI_PESSOA.CDN_FORNECEDOR,
             VTI_PESSOA.CDN_CLIENTE,
             VTI_PESSOA.NRREGISTRO_PAI,
             VTI_PESSOA.TXREGRA_AGRUPAMENTO,
             VTI_PESSOA.NOPESSOA,
             VTI_PESSOA.DTNASCIMENTO,
             VTI_PESSOA.NRCGC_CPF,
             SYSDATE,
             SYSDATE);
          PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
          PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
          PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
          PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;

        END IF;

      END IF;
    ELSE
      --NAO FAZ NADA

      NULL;

    END IF;

  END P_DEFINE_TI_PESSOA;

  PROCEDURE P_DEFINE_TI_PESSOA_OLD(PNRCGC_CPF              VARCHAR2,
                                   PNOPESSOA               VARCHAR2,
                                   PDTNASCIMENTO           DATE,
                                   PTPPESSOA               VARCHAR2,
                                   PNRREGISTRO             NUMBER,
                                   PTPORIGEM               VARCHAR2,
                                   PNOABREVIADO_FORNECEDOR IN OUT VARCHAR2,
                                   PCDN_FORNECEDOR         IN OUT VARCHAR2,
                                   PNOABREVIADO_CLIENTE    IN OUT VARCHAR2,
                                   PCDN_CLIENTE            IN OUT VARCHAR2,
                                   PAODEFINEPESSOA         VARCHAR2 -- < S/N>
                                   ) IS
    VNOM_ABREV_CLIENTE      TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
    VNOM_ABREV_FORNECEDOR   TI_PESSOA.NOABREVIADO_FORNECEDOR%TYPE;
    VNOABREVIADO_CLIENTE    TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
    VNOABREVIADO_FORNECEDOR TI_PESSOA.NOABREVIADO_FORNECEDOR%TYPE;
    VCDN_CLIENTE            TI_PESSOA.CDN_CLIENTE%TYPE;
    VCDN_FORNECEDOR         TI_PESSOA.CDN_FORNECEDOR%TYPE;
    VTI_PESSOA              TI_PESSOA%ROWTYPE;
    VTI_PESSOA_PAI          TI_PESSOA%ROWTYPE;
    VNOM_ABREVIADO          TI_PESSOA.NOABREVIADO_CLIENTE%TYPE;
    VCOUNT                  NUMBER;
    CNOM_ABREVIADO          TI_PESSOA.NOABREVIADO_CLIENTE%TYPE := 'p' ||
                                                                  PNRREGISTRO;
    --======================--
    -- Definir a Pessoa Pai --
    --------------------------
    PROCEDURE P_DEFINE_PESSOA_PAI IS
    BEGIN
      IF PTPPESSOA = 'F' THEN
        BEGIN
          --============--
          -- CPF / NOME --
          ----------------
          SELECT TI.*
            INTO VTI_PESSOA
            FROM PESSOA PS, TI_PESSOA TI
           WHERE TI.NRREGISTRO = PS.NRREGISTRO
             AND PS.NRCGC_CPF = PNRCGC_CPF
             AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
             AND PS.TPPESSOA = PTPPESSOA
             AND TI.NRREGISTRO_PAI IS NULL
             AND ROWNUM = 1
           ORDER BY TI.ROWID DESC;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CPF_PESSOA';
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              --==========================--
              -- CPF / DATA DE NASCIMENTO --
              ------------------------------
              SELECT TI.*
                INTO VTI_PESSOA
                FROM PESSOA PS, TI_PESSOA TI
               WHERE TI.NRREGISTRO = PS.NRREGISTRO
                 AND PS.NRCGC_CPF = PNRCGC_CPF
                 AND PS.DTNASCIMENTO = PDTNASCIMENTO
                 AND PS.TPPESSOA = PTPPESSOA
                 AND PS.DTNASCIMENTO IS NOT NULL
                 AND ROWNUM = 1
               ORDER BY TI.ROWID DESC;
              VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CPF_DTNASCIMENTO';
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VTI_PESSOA := NULL;
            END;
        END;
      ELSE
        BEGIN
          --======--
          -- CNPJ --
          ----------
          SELECT TI.*
            INTO VTI_PESSOA
            FROM PESSOA PS, TI_PESSOA TI
           WHERE TI.NRREGISTRO = PS.NRREGISTRO
             AND PS.NRCGC_CPF = PNRCGC_CPF
             AND PS.TPPESSOA = PTPPESSOA
             AND PS.NOPESSOA = PNOPESSOA --trata tipo de pessoa e cnpj iguais....
             AND TI.NRREGISTRO_PAI IS NULL
             AND ROWNUM = 1
           ORDER BY TI.ROWID DESC;
          VTI_PESSOA.TXREGRA_AGRUPAMENTO := 'CNPJ';
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            VTI_PESSOA := NULL;
        END;
      END IF;
    END; -- p_define_pessoa_pai
    --=======================--
    -- Busca Cliente no EMS5 --
    ---------------------------
    PROCEDURE P_BUSCA_CLIENTE_EMS IS
    BEGIN
      IF PTPPESSOA = 'F' THEN
        --=====================================--
        -- Verifica se o cliente pessoa fisica --
        -- existe no EMS5                      --
        -----------------------------------------
        BEGIN
          SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
            INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
            FROM CLIENTE CL, PESSOA_FISIC PF, TI_EMPRESA EMP
           WHERE PF.U##COD_ID_FEDER = PNRCGC_CPF
             AND PF.DAT_NASC_PESSOA_FISIC = PDTNASCIMENTO
             AND PF.NUM_PESSOA_FISIC = CL.NUM_PESSOA
             AND CL.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              SELECT DISTINCT CL.NOM_ABREV, CL.CDN_CLIENTE
                INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
                FROM CLIENTE CL, TI_EMPRESA EMP
               WHERE CL.NOM_ABREV = VNOM_ABREVIADO
                 AND CL.COD_EMPRESA = EMP.COD_EMPRESA
                 AND EMP.CDEMPRESA =
                     F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VNOM_ABREV_CLIENTE := NULL;
                VCDN_CLIENTE       := NULL;
            END;
        END;
      ELSE
        --======================================--
        -- Verifica se o cliente pessoa juridica --
        -- existe no EMS5                       --
        ------------------------------------------
        BEGIN
          SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
            INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
            FROM CLIENTE CL, PESSOA_JURID PJ, TI_EMPRESA EMP
           WHERE PJ.U##COD_ID_FEDER = PNRCGC_CPF
             AND PJ.NUM_PESSOA_JURID = CL.NUM_PESSOA
             AND CL.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              SELECT CL.NOM_ABREV, CL.CDN_CLIENTE
                INTO VNOM_ABREV_CLIENTE, VCDN_CLIENTE
                FROM CLIENTE CL, TI_EMPRESA EMP
               WHERE CL.NOM_ABREV = VNOM_ABREVIADO
                 AND CL.COD_EMPRESA = EMP.COD_EMPRESA
                 AND EMP.CDEMPRESA =
                     F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VNOM_ABREV_CLIENTE := NULL;
                VCDN_CLIENTE       := NULL;
            END;
        END;
      END IF;
    END; -- Busca cliente ems5
    --=======================--
    -- Busca fornecedor no EMS5 --
    ---------------------------
    PROCEDURE P_BUSCA_FORNECEDOR_EMS IS
    BEGIN
      IF PTPPESSOA = 'F' THEN
        --=====================================--
        -- Verifica se o fornecedor pessoa fisica --
        -- existe no EMS5                      --
        -----------------------------------------
        BEGIN
          SELECT DISTINCT FN.NOM_ABREV, FN.CDN_FORNECEDOR
            INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
            FROM FORNECEDOR FN, PESSOA_FISIC PF, TI_EMPRESA EMP
           WHERE PF.U##COD_ID_FEDER = PNRCGC_CPF
             AND PF.DAT_NASC_PESSOA_FISIC = PDTNASCIMENTO
             AND PF.NUM_PESSOA_FISIC = FN.NUM_PESSOA
             AND FN.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              SELECT DISTINCT FN.NOM_ABREV, FN.CDN_FORNECEDOR
                INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
                FROM FORNECEDOR FN, TI_EMPRESA EMP
               WHERE FN.NOM_ABREV = VNOM_ABREVIADO
                 AND FN.COD_EMPRESA = EMP.COD_EMPRESA
                 AND EMP.CDEMPRESA =
                     F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
              VNOM_ABREVIADO := CNOM_ABREVIADO;
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VNOM_ABREV_FORNECEDOR := NULL;
                VCDN_FORNECEDOR       := NULL;
            END;
        END;
      ELSE
        --======================================--
        -- Verifica se o fornecedor pessoa juridica --
        -- existe no EMS5                       --
        ------------------------------------------
        BEGIN
          SELECT FN.NOM_ABREV, FN.CDN_FORNECEDOR
            INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
            FROM FORNECEDOR FN, PESSOA_JURID PJ, TI_EMPRESA EMP
           WHERE PJ.U##COD_ID_FEDER = PNRCGC_CPF
             AND PJ.NUM_PESSOA_JURID = FN.NUM_PESSOA
             AND FN.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO')
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            BEGIN
              SELECT FN.NOM_ABREV, FN.CDN_FORNECEDOR
                INTO VNOM_ABREV_FORNECEDOR, VCDN_FORNECEDOR
                FROM FORNECEDOR FN
               WHERE FN.COD_EMPRESA =
                     F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')
                 AND FN.NOM_ABREV = VNOM_ABREVIADO;
              VNOM_ABREVIADO := CNOM_ABREVIADO;
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VNOM_ABREV_FORNECEDOR := NULL;
                VCDN_FORNECEDOR       := NULL;
            END;
        END;
      END IF;
    END; -- Busca fornecedor ems5
    --==================--
    -- Define o cliente --
    ----------------------
    PROCEDURE P_DEFINE_CLIENTE IS
    BEGIN
      IF F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
         '%' || PNRCGC_CPF || '%' AND PNRCGC_CPF IS NOT NULL THEN
        --------------------------
        -- Definir a pessoa PAI --
        --------------------------
        P_DEFINE_PESSOA_PAI;

        IF VTI_PESSOA.NRREGISTRO IS NULL THEN
          BEGIN
            SELECT TI.*
              INTO VTI_PESSOA
              FROM TI_PESSOA TI
             WHERE TI.NOABREVIADO_CLIENTE = PNRCGC_CPF
               AND TI.NRREGISTRO_PAI IS NULL
               AND ROWNUM = 1;
            VNOM_ABREVIADO := CNOM_ABREVIADO;
            VTI_PESSOA     := NULL;
          EXCEPTION
            --======================================--
            -- Caso o CPF/CPNPJ no existir o nome  --
            -- abreviado ser o CPF/CNPJ            --
            ------------------------------------------
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA     := NULL;
              VNOM_ABREVIADO := PNRCGC_CPF;
          END;
        ELSE
          VNOM_ABREVIADO := PNRCGC_CPF;
          VTI_PESSOA     := NULL;
        END IF;
      ELSE
        VNOM_ABREVIADO := CNOM_ABREVIADO;
        VTI_PESSOA     := NULL;
      END IF;
      IF VTI_PESSOA_PAI.NRREGISTRO IS NULL THEN
        ----------------------------
        P_BUSCA_CLIENTE_EMS;
        ----------------------------
        IF VNOM_ABREV_CLIENTE IS NOT NULL THEN
          VNOM_ABREVIADO := VNOM_ABREV_CLIENTE;
        END IF;
        VTI_PESSOA_PAI := NULL;
        BEGIN
          SELECT PS.*
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_CLIENTE = VNOM_ABREVIADO
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            VTI_PESSOA_PAI := NULL;
        END;
      ELSIF VTI_PESSOA.NRREGISTRO IS NOT NULL THEN
        SELECT PS.*
          INTO VTI_PESSOA_PAI
          FROM TI_PESSOA PS
         WHERE PS.NOABREVIADO_CLIENTE = VNOM_ABREVIADO
           AND NOT EXISTS (SELECT 1
                  FROM TI_PESSOA PST
                 WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
           AND ROWNUM = 1;
      END IF;
    END; -- fim p_define_cliente
    --==================--
    -- Define o fornecedor --
    ----------------------
    PROCEDURE P_DEFINE_FORNECEDOR IS
    BEGIN
      IF F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
         '%' || PNRCGC_CPF || '%' AND PNRCGC_CPF IS NOT NULL THEN
        --------------------------
        -- Definir a pessoa PAI --
        --------------------------
        P_DEFINE_PESSOA_PAI;
        IF VTI_PESSOA.NRREGISTRO IS NULL THEN
          BEGIN
            SELECT TI.*
              INTO VTI_PESSOA
              FROM TI_PESSOA TI
             WHERE TI.NOABREVIADO_FORNECEDOR = PNRCGC_CPF
               AND TI.NRREGISTRO_PAI IS NULL
               AND ROWNUM = 1;
            VNOM_ABREVIADO := CNOM_ABREVIADO;
            VTI_PESSOA     := NULL;
          EXCEPTION
            --======================================--
            -- Caso o CPF/CPNPJ no existir o nome  --
            -- abreviado ser o CPF/CNPJ            --
            ------------------------------------------
            WHEN NO_DATA_FOUND THEN
              VTI_PESSOA     := NULL;
              VNOM_ABREVIADO := PNRCGC_CPF;
          END;
        ELSE
          VNOM_ABREVIADO := PNRCGC_CPF;
          VTI_PESSOA     := NULL;
        END IF;
      ELSE
        VNOM_ABREVIADO := CNOM_ABREVIADO;
        VTI_PESSOA     := NULL;
      END IF;
      IF VTI_PESSOA_PAI.NRREGISTRO IS NULL THEN
        -----------------------
        P_BUSCA_FORNECEDOR_EMS;
        -----------------------
        IF VNOM_ABREV_FORNECEDOR IS NOT NULL THEN
          VNOM_ABREVIADO := VNOM_ABREV_FORNECEDOR;
        END IF;
        VTI_PESSOA_PAI := NULL;
        BEGIN
          SELECT PS.*
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_FORNECEDOR = VNOM_ABREVIADO
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            VTI_PESSOA_PAI := NULL;
        END;
      ELSIF VTI_PESSOA.NRREGISTRO IS NOT NULL THEN
        SELECT PS.*
          INTO VTI_PESSOA_PAI
          FROM TI_PESSOA PS
         WHERE PS.NOABREVIADO_FORNECEDOR = VNOM_ABREVIADO
           AND NOT EXISTS (SELECT 1
                  FROM TI_PESSOA PST
                 WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
           AND ROWNUM = 1;
      END IF;
    END; -- fim p_define_fornecedor
    --inicia aqui
  BEGIN
    VTI_PESSOA     := NULL;
    VTI_PESSOA_PAI := NULL;
    SELECT COUNT(*)
      INTO VCOUNT
      FROM TI_PESSOA P
     WHERE P.NRREGISTRO = PNRREGISTRO;
    IF VCOUNT = 0 THEN
      IF PAODEFINEPESSOA = 'S' THEN
        IF NOT F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_NAO_IMPORTA') NOT LIKE
            '%' || PNRCGC_CPF || '%' THEN
          VNOABREVIADO_CLIENTE    := CNOM_ABREVIADO;
          VNOABREVIADO_FORNECEDOR := CNOM_ABREVIADO;
          VCDN_FORNECEDOR         := NULL;
          VCDN_CLIENTE            := NULL;
        ELSE
          IF PTPORIGEM = 'CLIENTE' THEN
            ---------------------------
            P_DEFINE_CLIENTE;
            ---------------------------
            --========================--
            -- Se for uma pessoa nova --
            ----------------------------
            IF VTI_PESSOA.NRREGISTRO IS NULL THEN
              ----------------------------
              -- Nome abreviado cliente --
              ----------------------------
              IF VCDN_CLIENTE IS NOT NULL THEN
                VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                VNOABREVIADO_CLIENTE   := VNOM_ABREV_CLIENTE;
              ELSE
                VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                VNOABREVIADO_CLIENTE   := VNOM_ABREVIADO;
              END IF;
              ------------------------------
              -- Verifica se  fornecedor --
              ------------------------------
              P_BUSCA_FORNECEDOR_EMS;
              -------------------------------
              -- Nome abreviado fornecedor --
              -------------------------------
              IF VCDN_FORNECEDOR IS NOT NULL THEN
                VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                VNOABREVIADO_FORNECEDOR   := VNOM_ABREV_FORNECEDOR;
              ELSE
                VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                VNOABREVIADO_FORNECEDOR   := VNOM_ABREVIADO;
              END IF;
            END IF;
          ELSE
            -------------------------------
            P_DEFINE_FORNECEDOR;
            -------------------------------
            --========================--
            -- Se for uma pessoa nova --
            ----------------------------
            IF VTI_PESSOA.NRREGISTRO IS NULL THEN
              -------------------------------
              -- Nome abreviado fornecedor --
              -------------------------------
              IF VCDN_FORNECEDOR IS NOT NULL THEN
                VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                VNOABREVIADO_FORNECEDOR   := VNOM_ABREV_FORNECEDOR;
              ELSE
                VTI_PESSOA.CDN_FORNECEDOR := VCDN_FORNECEDOR;
                VNOABREVIADO_FORNECEDOR   := VNOM_ABREVIADO;
              END IF;
              ------------------------------
              -- verifica se  cliente --
              ------------------------------
              P_BUSCA_CLIENTE_EMS;
              ----------------------------
              -- nome abreviado cliente --
              ----------------------------
              IF VCDN_CLIENTE IS NOT NULL THEN
                VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                VNOABREVIADO_CLIENTE   := VNOM_ABREV_CLIENTE;
              ELSE
                VTI_PESSOA.CDN_CLIENTE := VCDN_CLIENTE;
                VNOABREVIADO_CLIENTE   := VNOM_ABREVIADO;
              END IF;
            END IF;
          END IF;
        END IF;
      ELSE
        BEGIN
          SELECT *
            INTO VTI_PESSOA_PAI
            FROM TI_PESSOA PS
           WHERE PS.NOABREVIADO_CLIENTE = PNOABREVIADO_CLIENTE
             AND NOT EXISTS (SELECT 1
                    FROM TI_PESSOA PST
                   WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
             AND ROWNUM = 1;
        EXCEPTION
          WHEN OTHERS THEN
            BEGIN
              SELECT *
                INTO VTI_PESSOA_PAI
                FROM TI_PESSOA PS
               WHERE PS.NOABREVIADO_FORNECEDOR = PNOABREVIADO_FORNECEDOR
                 AND NOT EXISTS
               (SELECT 1
                        FROM TI_PESSOA PST
                       WHERE PS.NRREGISTRO = PST.NRREGISTRO_PAI)
                 AND ROWNUM = 1;
            EXCEPTION
              WHEN OTHERS THEN
                VTI_PESSOA_PAI := NULL;
            END;
        END;
      END IF;
      IF VTI_PESSOA.NRREGISTRO IS NULL THEN
        VTI_PESSOA.NRREGISTRO             := PNRREGISTRO;
        VTI_PESSOA.NOABREVIADO_CLIENTE    := VNOABREVIADO_CLIENTE;
        VTI_PESSOA.NOABREVIADO_FORNECEDOR := VNOABREVIADO_FORNECEDOR;
        VTI_PESSOA.CDN_FORNECEDOR         := VCDN_FORNECEDOR;
        VTI_PESSOA.CDN_CLIENTE            := VCDN_CLIENTE;
        VTI_PESSOA.NRREGISTRO_PAI         := NULL;
        VTI_PESSOA.TXREGRA_AGRUPAMENTO    := NULL;
        VTI_PESSOA.NOPESSOA               := PNOPESSOA;
        VTI_PESSOA.DTNASCIMENTO           := PDTNASCIMENTO;
        VTI_PESSOA.NRCGC_CPF              := PNRCGC_CPF;
        VTI_PESSOA.NRREGISTRO_PAI         := VTI_PESSOA_PAI.NRREGISTRO;
      ELSE
        VTI_PESSOA.NRREGISTRO_PAI := VTI_PESSOA_PAI.NRREGISTRO;
        VTI_PESSOA.NRREGISTRO     := PNRREGISTRO;
        VTI_PESSOA.NOPESSOA       := PNOPESSOA;
        VTI_PESSOA.DTNASCIMENTO   := PDTNASCIMENTO;
        VTI_PESSOA.NRCGC_CPF      := PNRCGC_CPF;
      END IF;

      /* IF f_ti_parametro_integracao('INTR_EMS2') = 'S' THEN
              VTI_PESSOA.NOABREVIADO_CLIENTE    := SUBSTR(VTI_PESSOA.NOABREVIADO_CLIENTE,
                                                          0,
                                                          12);
              VTI_PESSOA.NOABREVIADO_FORNECEDOR := SUBSTR(VTI_PESSOA.NOABREVIADO_FORNECEDOR,
                                                          0,
                                                          12);
            END IF;
      */
      INSERT INTO TI_PESSOA
        (NRREGISTRO,
         NOABREVIADO_CLIENTE,
         NOABREVIADO_FORNECEDOR,
         CDN_FORNECEDOR,
         CDN_CLIENTE,
         NRREGISTRO_PAI,
         TXREGRA_AGRUPAMENTO,
         NOPESSOA,
         DTNASCIMENTO,
         NRCGC_CPF,
         DTGERACAO,
         DTULTIMA_ATUALIZACAO)
      VALUES
        (VTI_PESSOA.NRREGISTRO,
         VTI_PESSOA.NOABREVIADO_CLIENTE,
         VTI_PESSOA.NOABREVIADO_FORNECEDOR,
         VTI_PESSOA.CDN_FORNECEDOR,
         VTI_PESSOA.CDN_CLIENTE,
         VTI_PESSOA.NRREGISTRO_PAI,
         VTI_PESSOA.TXREGRA_AGRUPAMENTO,
         VTI_PESSOA.NOPESSOA,
         VTI_PESSOA.DTNASCIMENTO,
         VTI_PESSOA.NRCGC_CPF,
         SYSDATE,
         SYSDATE);
      PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
      PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
      PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
      PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;
    ELSE
      SELECT *
        INTO VTI_PESSOA
        FROM TI_PESSOA
       WHERE NRREGISTRO = PNRREGISTRO;
      PNOABREVIADO_CLIENTE    := VTI_PESSOA.NOABREVIADO_CLIENTE;
      PNOABREVIADO_FORNECEDOR := VTI_PESSOA.NOABREVIADO_FORNECEDOR;
      PCDN_CLIENTE            := VTI_PESSOA.CDN_CLIENTE;
      PCDN_FORNECEDOR         := VTI_PESSOA.CDN_FORNECEDOR;
    END IF;
  END;

  PROCEDURE P_JOB_FALHA IS
    CURSOR C_FALHA IS
      SELECT MP.CDACAO, FP.*
        FROM TI_MENSAGEM_PROCESSO MP, TI_FALHA_DE_PROCESSO FP
       WHERE FP.CDINTEGRACAO = MP.CDINTEGRACAO
         AND FP.NRMENSAGEM = MP.NRMENSAGEM;
    VSQL LONG;
  BEGIN
    FOR L_FALHA IN C_FALHA LOOP
      IF L_FALHA.CDACAO = 'CA' THEN
        VSQL := 'update ' || L_FALHA.CDINTEGRACAO || ' set ' ||
                ' cdsituacao=' || '''' || 'CA' || '''' ||
                ' where nrseq_controle_integracao=' ||
                L_FALHA.NRSEQ_CONTROLE_INTEGRACAO;
        EXECUTE IMMEDIATE VSQL;
      ELSIF L_FALHA.CDACAO = 'AT' THEN
        VSQL := 'begin pck_ems506unicoo.p_update_controle_integracao(' ||
                L_FALHA.NRSEQ_CONTROLE_INTEGRACAO ||
                ',f_ti_situacao_integracao(' ||
                L_FALHA.NRSEQ_CONTROLE_INTEGRACAO || ',' || '''' ||
                L_FALHA.CDINTEGRACAO || '''' || '),null ); end;';
        --            dbms_output.put_line(vsql);
        EXECUTE IMMEDIATE VSQL;
        BEGIN
          -- nao apagar falhas
          --pck_ems506unicoo.p_apaga_falha(l_falha.nrseq_controle_integracao);
          NULL;
        END;
      END IF;
      PCK_EMS506UNICOO.P_JOB();
    END LOOP;
  END;

  FUNCTION F_PERMITE_CANC_INT_FI_TIT_APB(PCDUNIMED VARCHAR2,
                                         PNRFATURA VARCHAR2) RETURN VARCHAR2 IS
    VRESULT VARCHAR2(1);
    CURSOR C_TITULO IS
      SELECT *
        FROM AREA_DE_ACAO AA, TITULO_A_PAGAR TP
       WHERE AA.CDPRESTADOR = TP.CDFORNECEDOR
         AND AA.CDAREAACAO = PCDUNIMED
         AND TP.NRDOCUMENTO = PNRFATURA;
    VAOALTERAR VARCHAR2(1);
    VAOCANCELA VARCHAR2(1);
  BEGIN
    VRESULT := 'S';
    FOR L_TITULO IN C_TITULO LOOP
      VAOALTERAR := F_PERMITE_ALTERAR_TIT_APB(L_TITULO.NRDOCUMENTO,
                                              L_TITULO.NRREGISTRO_TITULO);
      IF VAOALTERAR = 'N' THEN
        VRESULT := 'N';
      ELSE
        VAOCANCELA := F_PERMITE_CANCELAR_TI_TIT_APB(L_TITULO.NRDOCUMENTO,
                                                    L_TITULO.NRREGISTRO_TITULO);
        IF VAOCANCELA = 'N' THEN
          VRESULT := 'N';
        END IF;
      END IF;
    END LOOP;
    RETURN VRESULT;
  END;

  PROCEDURE P_UPDATE_CONTROLE_INTEGRACAO(PNRSEQUENCIAL NUMBER,
                                         PCDSITUACAO   VARCHAR2,
                                         PTXOBSERVACAO VARCHAR2) IS
  BEGIN
    UPDATE TI_CONTROLE_INTEGRACAO TI
       SET TI.CDSITUACAO      = PCDSITUACAO,
           TI.TXOBSERVACAO    = PTXOBSERVACAO,
           TI.DTINTEGRACAO    = DECODE(PCDSITUACAO, 'IT', SYSDATE, NULL),
           TI.DTPROCESSAMENTO = SYSDATE
     WHERE TI.NRSEQUENCIAL = PNRSEQUENCIAL;
  END;

  PROCEDURE P_AJUSTES IS
    PROCEDURE P_ATUALIZA_NOSSONUMERO IS
      CURSOR C_TITULO IS
        SELECT TI.COD_PARCELA, TA.ROWID, TI.COD_TIT_ACR_BCO
          FROM EMS506UNICOO.TI_TIT_ACR TI, TIT_ACR TA
         WHERE TI.COD_TITULO_ACR = TA.COD_TIT_ACR
           AND TI.COD_SER_DOCTO = TA.COD_SER_DOCTO
           AND TI.COD_ESPEC_DOCTO = TA.COD_ESPEC_DOCTO
           AND TI.COD_PARCELA = TA.COD_PARCELA
           AND TA.COD_TIT_ACR_BCO <> TI.COD_TIT_ACR_BCO
           AND 1 = 2;
    BEGIN
      FOR L_TITULO IN C_TITULO LOOP
        UPDATE TIT_ACR Z
           SET Z.COD_TIT_ACR_BCO    = L_TITULO.COD_TIT_ACR_BCO,
               Z.U##COD_TIT_ACR_BCO = L_TITULO.COD_TIT_ACR_BCO
         WHERE Z.ROWID = L_TITULO.ROWID;
      END LOOP;
    END;

  BEGIN
    P_ATUALIZA_NOSSONUMERO;
    --          p_atualiza_cliente;
  END;

  --=========================--
  -- Grava falha de processo --
  -----------------------------
  PROCEDURE P_APAGA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER) IS
  BEGIN
    DELETE FROM TI_FALHA_DE_PROCESSO
     WHERE NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
  END;

  PROCEDURE P_JOB IS
    VTPINTEGRACAO TI_PARAMETRO_INTEGRACAO.VLPARAMETRO%TYPE;
  BEGIN
    VTPINTEGRACAO := F_TI_PARAMETRO_INTEGRACAO('TP_INTEGRACAO_ONLINE_UNICOO_EMS5');
    IF VTPINTEGRACAO LIKE '%' || 'CL' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'CL');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'FN' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'FN');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'TR' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'TR');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'TP' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'TP');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'FT' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'FT');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'CX' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'CX');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'BP' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'BP');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'BR' || '%' THEN
      P_MONITOR_INTEGRACAO(0, 'BR');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'CP' || '%' THEN
      -- cancelamento titulo pagar no ems
      P_MONITOR_INTEGRACAO(0, 'CP');
    END IF;
    IF VTPINTEGRACAO LIKE '%' || 'BC' || '%' THEN
      -- cdhistorico 78
      P_MONITOR_INTEGRACAO(0, 'BC');
    END IF;
    --COMMIT;
  END;

  PROCEDURE P_JOB_ERRO IS
  BEGIN
    UPDATE TI_CONTROLE_INTEGRACAO CI
       SET CI.CDSITUACAO = 'GE'
     WHERE CI.CDSITUACAO = 'ER'
       AND WNAOREPROCESSA NOT LIKE '%' || CI.TPINTEGRACAO || '%';
    P_COMMIT_NEW;
    PCK_EMS506UNICOO.P_JOB();
  END;

  PROCEDURE P_COMMIT IS
  BEGIN
    IF GCOMMIT >= GCOUNTOFRECORDS THEN
      --COMMIT;
      GCOMMIT := 0;
    END IF;
    GCOMMIT := GCOMMIT + 1;
  END;

  PROCEDURE P_COMMIT_NEW IS
  BEGIN
    IF GCOMMIT >= GCOUNTOFRECORDS THEN
      --COMMIT;
      GCOMMIT := 0;
    END IF;
    GCOMMIT := GCOMMIT + 1;
  END;

  PROCEDURE P_REENVIA_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER) IS
  BEGIN
    UPDATE TI_CLIENTE C
       SET CDSITUACAO = 'RC'
     WHERE C.NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
    --       p_apaga_falha(pNRSeq_Controle_integracao);
  END;

  PROCEDURE P_REPROCESSA_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                    P_TPINTEGRACAO             VARCHAR2) IS
    CURSOR C_REPROCESSA IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND CI.CDSITUACAO IN ('PE')
         AND ((CI.TPINTEGRACAO = P_TPINTEGRACAO) OR (P_TPINTEGRACAO = '*'))
         AND WNAOREPROCESSA NOT LIKE '%' || CI.TPINTEGRACAO || '%'
       ORDER BY CI.NRSEQUENCIAL;
    V_SEQ_CONTROLE_INTEGRACAO NUMBER(10);
  BEGIN
    SELECT VLPARAMETRO
      INTO WNAOREPROCESSA
      FROM TI_PARAMETRO_INTEGRACAO
     WHERE CDPARAMETRO = 'TPINTEGRACAONAOREPROCESSA';
    FOR L_REPROCESSA IN C_REPROCESSA LOOP
      SELECT SQ_TI_CONTROLE_INTEGRACAO.NEXTVAL
        INTO V_SEQ_CONTROLE_INTEGRACAO
        FROM DUAL;
      INSERT INTO TI_CONTROLE_INTEGRACAO
        (NRSEQUENCIAL,
         TPINTEGRACAO,
         DTGERACAO,
         NRSEQUENCIAL_ORIGEM,
         DTPROCESSAMENTO,
         DTINTEGRACAO,
         CDACAO,
         CDIDENTIFICADOR,
         CDSITUACAO,
         NRSEQ_CONTROLE_INTEGRACAO_ORG,
         CDEMPRESA,
         CDMODULO,
         CDMOVIMENTO,
         CDDIVISAO)
        SELECT V_SEQ_CONTROLE_INTEGRACAO,
               TPINTEGRACAO,
               SYSDATE DTGERACAO,
               NRSEQUENCIAL_ORIGEM,
               NULL,
               DTINTEGRACAO,
               L_REPROCESSA.CDACAO,
               CDIDENTIFICADOR,
               'GE',
               L_REPROCESSA.NRSEQUENCIAL,
               L_REPROCESSA.CDEMPRESA,
               L_REPROCESSA.CDMODULO,
               L_REPROCESSA.CDMOVIMENTO,
               L_REPROCESSA.CDDIVISAO
          FROM TI_CONTROLE_INTEGRACAO CI
         WHERE CI.NRSEQUENCIAL = L_REPROCESSA.NRSEQUENCIAL;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.DTPROCESSAMENTO = SYSDATE, CI.CDSITUACAO = 'RE'
       WHERE CI.NRSEQUENCIAL = L_REPROCESSA.NRSEQUENCIAL;
      IF L_REPROCESSA.TPINTEGRACAO = 'CL' THEN
        UPDATE TI_CLIENTE CL
           SET CL.CDSITUACAO = 'RE' -- REPROCESSA
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'FN' THEN
        UPDATE TI_FORNECEDOR FN
           SET FN.CDSITUACAO = 'RE' -- REPROCESSA
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'TR' THEN
        UPDATE TI_TIT_ACR CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'TP' THEN
        UPDATE TI_TIT_APB CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'CT' THEN
        UPDATE TI_LOTE_CTBL CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'CX' THEN
        UPDATE TI_LOTE_CTBL CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO IN ('FT', 'EM') THEN
        UPDATE TI_TIT_ACR_ESTORNO CL
           SET CL.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'BP' THEN
        UPDATE TI_CX_BX_APB BP
           SET BP.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      ELSIF L_REPROCESSA.TPINTEGRACAO = 'BR' THEN
        UPDATE TI_CX_BX_ACR BR
           SET BR.CDSITUACAO = 'RE'
         WHERE NRSEQ_CONTROLE_INTEGRACAO = L_REPROCESSA.NRSEQUENCIAL;
      END IF;
    END LOOP;
    P_COMMIT_NEW;
    PCK_EMS506UNICOO.P_JOB();
  END;

  --======================================================--
  -- Define o mdulo origem dos titulos do contas a pagar --
  ----------------------------------------------------------
  PROCEDURE P_DEFINE_MODULO_TIT_APB(PNRSESSAO TI_CONTROLE_INTEGRACAO.NRSESSAO%TYPE) IS
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TP'
         AND CI.CDMODULO IS NULL
         AND CI.NRSESSAO = PNRSESSAO;
    VCDMOVIMENTO  TI_CONTROLE_INTEGRACAO.CDMOVIMENTO%TYPE;
    VCDDIVISAO    TI_CONTROLE_INTEGRACAO.CDDIVISAO%TYPE;
    VCDMODULO     TI_CONTROLE_INTEGRACAO.CDMODULO%TYPE;
    VCDSITUACAO   TI_CONTROLE_INTEGRACAO.CDSITUACAO%TYPE;
    VTXOBSERVACAO TI_CONTROLE_INTEGRACAO.TXOBSERVACAO%TYPE;
    VQTDESPECIE   NUMBER;
  BEGIN
    FOR L_TITULO IN C_TITULO LOOP
      BEGIN
        --===================================--
        -- Titulos de prestadores e Unimeds --
        ---------------------------------------
        -- Alessandro 18/07/2012
        /*select pr.tpprestador
         into vcdmovimento
         from titulo_a_pagar tp,
              prestador pr
        where
              f_ti_parametro_integracao('CLASSIFICA_INTEGRACAO_PAGPREST') = 'PR'
          and pr.cdprestador                                             = tp.cdfornecedor
          and tp.nrregistro_titulo                                       = l_titulo.nrsequencial_origem
          and tp.cdfuncionario                                          <> 'MVINTEGRA';*/
        SELECT PR.TPPRESTADOR
          INTO VCDMOVIMENTO
          FROM TITULO_A_PAGAR TP, PRESTADOR PR
         WHERE F_TI_PARAMETRO_INTEGRACAO('CLASSIFICA_INTEGRACAO_PAGPREST') = 'PR'
           AND PR.CDPRESTADOR = TP.CDFORNECEDOR
           AND TP.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
           AND TP.CDFUNCIONARIO <> 'MVINTEGRA'
              --
              --and tp.tpdocumento <> wtpdoc
           AND TP.NRDOCUMENTO NOT LIKE 'TX%'
              --
           AND NOT EXISTS
         (SELECT 1
                  FROM REM_IMP_CONTROLE_A550 XX
                 WHERE XX.TP_ARQUIVO IN ('4', '6', '8') -- tp_arquivo = 5 -- Receber  -- tp_arquivo = 6 -- Pagar;-- Alessandro 13/05/2014
                   AND XX.NRREGISTRO_TITULO = TP.NRREGISTRO_TITULO)
           AND PR.TPPRESTADOR <>
               F_TI_PARAMETRO_INTEGRACAO('TIPO_PRESTADOR_NAO_INTEGRA_PAGPREST'); -- Alecsandro 05/08
        -- Alessandro 18/07/2012
        VCDDIVISAO  := NULL;
        VCDMODULO   := 'PR';
        VCDSITUACAO := 'GE';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          --=========================--
          -- Titulos de fornecedores --
          -----------------------------

          IF VVERSAOFINANCEIRO = '1' THEN
            BEGIN
              SELECT CDHISTORICO, HT.CDCENTRO_CUSTO
                INTO VCDMOVIMENTO, VCDDIVISAO
                FROM HISTORICO_DO_TITULO_PAGAR HT
               WHERE HT.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
                 AND HT.CDMOVIMENTO IN ('1', '3');
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                VCDMOVIMENTO  := NULL;
                VCDMODULO     := NULL;
                VCDDIVISAO    := NULL;
                VCDSITUACAO   := 'CA';
                VTXOBSERVACAO := 'Nao encontrado movimento 1 ou 3 na tabela historico_do_titulo_pagar ';
            END;
          ELSE
            ----------------------------------------------------
            -- Verificar se o titulo tem somente uma especie.
            -- Josias 05-06-2014 - -João Pessoa
            ----------------------------------------------------
            BEGIN
              SELECT COUNT(*)
                INTO VQTDESPECIE
                FROM (SELECT DISTINCT C.COD_ESPEC_DOCTO
                        FROM TITULO_A_PAGAR            TP,
                             DISTRIBUICAO_TITULO_PAGAR DTP,
                             TI_TIPO_MOVIMENTO_TIT_APB C
                       WHERE TP.NRREGISTRO_TITULO = DTP.NRREGISTRO_TITULO
                         AND C.CDEMPRESA = TP.CDEMPRESA
                         AND C.CDMOVIMENTO =
                             TO_CHAR(NVL(DTP.CDHISTORICO, TP.CDHISTORICO))
                         AND TP.NRREGISTRO_TITULO =
                             L_TITULO.NRSEQUENCIAL_ORIGEM);
              --Quando houver mais de uma especie deverá localizar a distribuicao de maior valor,
              --caso o parametro DEFINE_HISTORICO_PADRAO_APB seja igual a GF, o valor do historico sera
              --substituido pelo exitente no cadastro de grupo de fornecedor (ti_grupo_fornecedor)...
              --Inicio trata espécie duplkicada...
              IF VQTDESPECIE > 1 THEN
                BEGIN
                  VTXOBSERVACAO := 'Titulo rateado pelo critério do maior valor';
                  SELECT CDHISTORICO, CDDIVISAO
                    INTO VCDMOVIMENTO, VCDDIVISAO
                    FROM (SELECT NVL(B.CDHISTORICO, HT.CDHISTORICO) CDHISTORICO,
                                 NVL(B.CDDIVISAO, HT.CDDIVISAO) CDDIVISAO,
                                 NVL(SUM(DECODE(B.TIPO_DISTRIB,
                                                'V',
                                                B.VLDISTRIBUICAO,
                                                -1 * B.VLDISTRIBUICAO)),
                                     0) VALOR
                            FROM TITULO_A_PAGAR            HT,
                                 DISTRIBUICAO_TITULO_PAGAR B
                           WHERE HT.NRREGISTRO_TITULO =
                                 B.NRREGISTRO_TITULO(+)
                             AND HT.NRREGISTRO_TITULO =
                                 L_TITULO.NRSEQUENCIAL_ORIGEM
                           GROUP BY NVL(B.CDHISTORICO, HT.CDHISTORICO),
                                    NVL(B.CDDIVISAO, HT.CDDIVISAO)
                           ORDER BY 3 DESC)
                   WHERE ROWNUM = 1;
                  IF F_TI_PARAMETRO_INTEGRACAO('DEFINE_HISTORICO_PADRAO_APB') = 'GF' THEN
                    BEGIN
                      VTXOBSERVACAO := 'Titulo rateado pelo critério do Grupo do Fornecedor';
                      SELECT GF.CD_HISTORICO_PADRAO
                        INTO VCDMOVIMENTO
                        FROM TITULO_A_PAGAR                      TP,
                             PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FN,
                             TI_GRUPO_DE_FORNECEDOR              GF
                       WHERE GF.CDGRUPO_FORNECEDOR = FN.CDGRUPO_FORNECEDOR
                         AND TP.CDFORNECEDOR = TP.CDFORNECEDOR
                         AND TP.NRREGISTRO_TITULO =
                             L_TITULO.NRSEQUENCIAL_ORIGEM
                         AND GF.CD_HISTORICO_PADRAO IS NOT NULL;
                    EXCEPTION
                      WHEN NO_DATA_FOUND THEN
                        VCDMOVIMENTO  := NULL;
                        VCDMODULO     := NULL;
                        VCDDIVISAO    := NULL;
                        VCDSITUACAO   := 'ER';
                        VTXOBSERVACAO := 'Histórico não cadastrado no Grupo de Fornecedor';
                        P_GRAVA_FALHA(L_TITULO.NRSEQUENCIAL,
                                      'TP',
                                      VTXOBSERVACAO,
                                      NULL,
                                      VCDSITUACAO,
                                      NULL);
                    END;
                  END IF;
                EXCEPTION
                  WHEN NO_DATA_FOUND THEN
                    VCDMOVIMENTO  := NULL;
                    VCDMODULO     := NULL;
                    VCDDIVISAO    := NULL;
                    VCDSITUACAO   := 'ER';
                    VTXOBSERVACAO := 'Não encontrado titulo de origem ';
                    P_GRAVA_FALHA(L_TITULO.NRSEQUENCIAL,
                                  'TP',
                                  VTXOBSERVACAO,
                                  NULL,
                                  VCDSITUACAO,
                                  NULL);
                END;
                --Fim trata espécie duplkicada...
              ELSE
                BEGIN
                  SELECT MIN(CDHISTORICO), MIN(CDDIVISAO)
                    INTO VCDMOVIMENTO, VCDDIVISAO
                    FROM (SELECT DISTINCT NVL(B.CDHISTORICO, HT.CDHISTORICO) CDHISTORICO,
                                          NVL(B.CDDIVISAO, HT.CDDIVISAO) CDDIVISAO
                            FROM TITULO_A_PAGAR            HT,
                                 DISTRIBUICAO_TITULO_PAGAR B
                           WHERE HT.NRREGISTRO_TITULO =
                                 B.NRREGISTRO_TITULO(+)
                             AND HT.NRREGISTRO_TITULO =
                                 L_TITULO.NRSEQUENCIAL_ORIGEM);
                EXCEPTION
                  WHEN NO_DATA_FOUND THEN
                    VCDMOVIMENTO  := NULL;
                    VCDMODULO     := NULL;
                    VCDDIVISAO    := NULL;
                    VCDSITUACAO   := 'ER';
                    VTXOBSERVACAO := 'Não encontrado titulo de origem ';
                    P_GRAVA_FALHA(L_TITULO.NRSEQUENCIAL,
                                  'TP',
                                  VTXOBSERVACAO,
                                  NULL,
                                  VCDSITUACAO,
                                  NULL);
                END;
              END IF;
            END;
          END IF;
          IF NVL(VCDSITUACAO, 'x') <> 'ER' THEN
            VCDMODULO   := 'CP';
            VCDSITUACAO := 'GE';
            --====================--
            -- Classifica imposto --
            ------------------------
            BEGIN
              SELECT PR.TPPRESTADOR
                INTO VCDMOVIMENTO
                FROM TAXA_TITULO_INTEGRACAO TTI,
                     TITULO_A_PAGAR         TP,
                     PRESTADOR              PR
               WHERE PR.CDPRESTADOR = TTI.CDFORNECEDOR
                 AND TP.NRREGISTRO_TITULO = TTI.NRREGISTRO_TITULO_TAXA
                 AND TP.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
                    --
                 AND NOT EXISTS
               (SELECT 1
                        FROM TAXA_TITULO_INTEGRACAO T
                       WHERE T.NRREGISTRO_TITULO_TAXA = TP.NRREGISTRO_TITULO);
              VCDMODULO  := F_TI_PARAMETRO_INTEGRACAO('CLASSIFICA_IMPOSTO_INTEGRACAO_PAGPREST');
              VCDDIVISAO := NULL;
            EXCEPTION
              WHEN NO_DATA_FOUND THEN
                NULL;
            END;
          END IF;
      END;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDMODULO     = VCDMODULO,
             CI.CDMOVIMENTO  = VCDMOVIMENTO,
             CI.CDSITUACAO   = VCDSITUACAO,
             CI.CDDIVISAO    = VCDDIVISAO,
             CI.TXOBSERVACAO = VTXOBSERVACAO
       WHERE CI.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
      P_COMMIT_NEW;
    END LOOP;
  END;

  --========================================================--
  -- Define o mdulo origem dos titulos do contas a receber --
  ------------------------------------------------------------
  PROCEDURE P_DEFINE_MODULO_TIT_ACR(PNRSESSAO TI_CONTROLE_INTEGRACAO.NRSESSAO%TYPE) IS
    CURSOR C_TITULO IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TR'
         AND CI.CDMODULO IS NULL
         AND CI.NRSESSAO = PNRSESSAO;
    VCDMOVIMENTO TI_CONTROLE_INTEGRACAO.CDMOVIMENTO%TYPE;
    VCDMODULO    TI_CONTROLE_INTEGRACAO.CDMODULO%TYPE;
    VCDSITUACAO  TI_CONTROLE_INTEGRACAO.CDSITUACAO%TYPE;
  BEGIN
    FOR L_TITULO IN C_TITULO LOOP
      BEGIN
        --====================--
        -- Titulos de faturas --
        ------------------------
        SELECT SUBSTR(FT.NRFATURA, 1, INSTR(FT.NRFATURA, '-') - 1)
          INTO VCDMOVIMENTO
          FROM FATURAMENTO FT
         WHERE FT.NRFATURA = L_TITULO.CDIDENTIFICADOR;
        VCDMODULO   := 'FT';
        VCDSITUACAO := 'GE';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          BEGIN
            --===============================--
            -- Titulos de faturas parceladas --
            -----------------------------------
            SELECT SUBSTR(DF.NRFATURA, 1, INSTR(DF.NRFATURA, '-') - 1)
              INTO VCDMOVIMENTO
              FROM DUPLICATA_FATURAMENTO DF
             WHERE DF.NRDUPLICATA = L_TITULO.CDIDENTIFICADOR;
            VCDMODULO   := 'FT';
            VCDSITUACAO := 'GE';
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              BEGIN
                --===============================================--
                -- Titulos que no possuem origem no faturamento --
                ---------------------------------------------------
                SELECT NVL(HT.CDHISTORICO, TR.CDHISTORICO)
                  INTO VCDMOVIMENTO
                  FROM HISTORICO_DO_TITULO HT, TITULO_A_RECEBER TR
                 WHERE HT.NRREGISTRO_TITULO = L_TITULO.NRSEQUENCIAL_ORIGEM
                   AND HT.NRREGISTRO_TITULO = TR.NRREGISTRO_TITULO
                   AND
                      --ht.cdmovimento='1';-- Alessandro 21/10/2014
                       HT.CDMOVIMENTO IN ('1', '3'); -- Alessandro 21/10/2014
                VCDMODULO   := 'CR';
                VCDSITUACAO := 'GE';
              EXCEPTION
                WHEN NO_DATA_FOUND THEN
                  VCDMOVIMENTO := NULL;
                  VCDMODULO    := NULL;
                  VCDSITUACAO  := 'CA';
                  -- gravar falha
                WHEN OTHERS THEN
                  VCDMOVIMENTO := NULL;
                  VCDMODULO    := NULL;
                  VCDSITUACAO  := 'CA';
                  -- gravar falha
              END;
          END;
      END;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDMODULO    = VCDMODULO,
             CI.CDMOVIMENTO = VCDMOVIMENTO,
             CI.CDSITUACAO  = VCDSITUACAO
       WHERE CI.NRSEQUENCIAL = L_TITULO.NRSEQUENCIAL;
    END LOOP;
  END;

  PROCEDURE P_MONITOR_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PTPINTEGRACAO              VARCHAR DEFAULT '*') IS
    CURSOR C_PROCESSA(PNRSESSAO NUMBER, PTPINTEGRACAO VARCHAR2) IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.CDSITUACAO = 'VD'
         AND CI.TPINTEGRACAO NOT IN ('MV', 'FE')
         AND CI.TPINTEGRACAO = PTPINTEGRACAO
       ORDER BY CI.NRSEQUENCIAL;
    VCDSITUACAO VARCHAR2(2);
    /*-------------------------------
    GE --> PI --> PR  // Prepara
    PR --> VI --> VD  // Valida
    VD --> OK         // Processa
    Gerao --> Preparao Inicio --> Preparado
    Preparado --> Validao Inicial --> Validado
    Validado --> OK
    -------------------------------*/
    VNRSESSAO     NUMBER(10);
    VTPINTEGRACAO VARCHAR2(2);
  BEGIN
    WHILE TRUE LOOP
      SELECT SQ_TI_SESSAO.NEXTVAL INTO VNRSESSAO FROM DUAL;
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.NRSESSAO = VNRSESSAO
       WHERE (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = CI.TPINTEGRACAO)
         AND CI.CDSITUACAO = 'GE'
         AND ROWNUM <= GSESSAO_MOVIMENTO;
      IF SQL%ROWCOUNT = 0 THEN
        EXIT;
      ELSE
        ----------------------------------------------------------
        P_VALIDA_CONTROLE_INTEGRACAO(PTPINTEGRACAO, VNRSESSAO);
        ----------------------------------------------------------
        IF PTPINTEGRACAO = 'TP' THEN
          P_DEFINE_MODULO_TIT_APB(VNRSESSAO);
        ELSIF PTPINTEGRACAO = 'TR' THEN
          P_DEFINE_MODULO_TIT_ACR(VNRSESSAO);
        END IF;
        --====================--
        -- Prepara Integrao --
        ------------------------
        VCDSITUACAO := 'VD';
        UPDATE TI_CONTROLE_INTEGRACAO CI
           SET CI.CDSITUACAO = VCDSITUACAO
         WHERE CI.NRSESSAO = VNRSESSAO
           AND CI.CDSITUACAO = 'GE'
           AND CI.TPINTEGRACAO NOT IN ('MV', 'FE');
        --=====================--
        -- Processa Integrao --
        -------------------------
        VTPINTEGRACAO := PTPINTEGRACAO;
        FOR L_PROCESSA IN C_PROCESSA(VNRSESSAO, VTPINTEGRACAO) LOOP
          VCDSITUACAO := 'VD';

          P_TI_PROCESSA_INTEGRACAO(L_PROCESSA.TPINTEGRACAO,
                                   L_PROCESSA.NRSEQUENCIAL,
                                   VNRSESSAO,
                                   L_PROCESSA.CDIDENTIFICADOR,
                                   VCDSITUACAO);
        END LOOP;
        P_COMMIT_NEW;
      END IF;
    END LOOP;
    --COMMIT;
  END;

  PROCEDURE P_VALIDA_CONTROLE_INTEGRACAO(PTPINTEGRACAO VARCHAR2,
                                         PNRSESSAO     NUMBER) IS
  BEGIN
    P_AJUSTES;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'FT') THEN
      --=============================================--
      -- Cancela integrao de fornecedores diversos --
      -------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'FATURA REATIVADA NO UNICOO'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND EXISTS (SELECT 1
                FROM FATURAMENTO FT
               WHERE FT.NRFATURA = CI.CDIDENTIFICADOR
                 AND FT.DTCANCELAMENTO IS NULL);
      --=============================================--
      -- Cancela integrao de fornecedores diversos --
      -------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'FATURA JA CANCELADA NO EMS5'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND EXISTS (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS, TIT_ACR TTA
               WHERE TTA.U##COD_ESTAB = EMS.COD_ESTAB
                 AND TTA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
                 AND TTA.LOG_TIT_ACR_ESTORDO = 1
                 AND EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR)
         AND NOT EXISTS
       (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS, TIT_ACR TTA
               WHERE TTA.U##COD_ESTAB = EMS.COD_ESTAB
                 AND TTA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
                 AND TTA.LOG_TIT_ACR_ESTORDO = 0
                 AND EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR);
      --=============================================--
      -- Cancela integrao de fornecedores diversos CASO NAO ENCONTRE TITULO NO EMS--
      -------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'FATURA JA CANCELADA OU NAO INTEGRADA NO EMS5'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND NOT EXISTS
       (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS, TIT_ACR TTA
               WHERE TTA.U##COD_ESTAB = EMS.COD_ESTAB
                 AND TTA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
                 AND TTA.LOG_TIT_ACR_ESTORDO = 0
                 AND EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR);
      -- Alessandro 19/03/2012
      --=============================================--
      -- Fatura Integrada com EMS5 e nao Contabilizada
      ------------------------------------------------
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'ER',
             CI.TXOBSERVACAO = 'FATURA INTEGRADA EMS5 e Nao Contabilizada'
       WHERE CI.TPINTEGRACAO = 'FT'
         AND CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO --386511633--
         AND EXISTS
       (SELECT 1
                FROM TI_CONTROLE_INTEGRACAO CI1,
                     TI_TIT_ACR_ESTORNO     T,
                     TIT_ACR                TA,
                     MOVTO_TIT_ACR          MT
               WHERE MT.U##COD_ESTAB = TA.U##COD_ESTAB
                 AND MT.NUM_ID_TIT_ACR = TA.NUM_ID_TIT_ACR
                 AND MT.IND_TRANS_ACR_ABREV = 'IMPL'
                 AND TA.NUM_ID_TIT_ACR = T.NUM_ID_TIT_ACR
                 AND CI1.NRSEQUENCIAL = T.NRSEQ_CONTROLE_INTEGRACAO
                 AND MT.LOG_APROP_CTBL_CTBZDA = 0
                 AND CI1.NRSEQUENCIAL = CI.NRSEQUENCIAL);
      -- Alessandro 19/03/2012
    END IF;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'TP') THEN
      -- cancela os titulos do contas a pagar que sao de impostos, pois nao devem ser integrados
      -----------------------------------------------
      CANCELA_CONTROLE_TIT_IMPOSTOS(PNRSESSAO);
      -----------------------------------------------
      IF F_TI_PARAMETRO_INTEGRACAO('INTEGRA_SOMENTE_TITULOS_PRESTADORES') = 'S' THEN
        --=============================================--
        -- Cancela integrao de fornecedores diversos --
        -------------------------------------------------
        UPDATE TI_CONTROLE_INTEGRACAO CI
           SET CI.CDSITUACAO   = 'CA',
               CI.TXOBSERVACAO = 'A integração do unicoo com o ems5 integra apenas titulos de prestadores'
         WHERE CI.TPINTEGRACAO = 'TP'
           AND CI.CDSITUACAO = 'GE'
           AND CI.NRSESSAO = PNRSESSAO
           AND NOT EXISTS
         (SELECT 1
                  FROM TITULO_A_PAGAR                      TP,
                       PRESTADOR                           PR,
                       PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FN
                 WHERE FN.CDFORNECEDOR = PR.CDPRESTADOR
                   AND FN.CDFORNECEDOR = TP.CDFORNECEDOR
                   AND CI.NRSEQUENCIAL_ORIGEM = TP.NRREGISTRO_TITULO)
              -- Titulo no  de imposto de prestador com saldo negativo
           AND NOT EXISTS
         (SELECT 1
                  FROM TITULO_A_PAGAR TP --taxa_titulo_integracao tti,
                 WHERE CI.NRSEQUENCIAL_ORIGEM = TP.NRREGISTRO_TITULO);
      END IF;
    END IF;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'TR') THEN
      IF F_TI_PARAMETRO_INTEGRACAO('INTEGRA_SOMENTE_TITULOS_FATURAMENTO') = 'S' THEN
        --=====================================--
        -- Cancela a integrao de titulos que --
        -- no possuem origem no faturamento   --
        -----------------------------------------
        UPDATE TI_CONTROLE_INTEGRACAO CI
           SET CI.CDSITUACAO   = 'CA',
               CI.TXOBSERVACAO = 'TITULO NO POSSUI ORIGEM NO FATURAMENTO'
         WHERE CI.TPINTEGRACAO = 'TR'
           AND CI.CDSITUACAO = 'GE'
           AND CI.NRSESSAO = PNRSESSAO
           AND NOT EXISTS (SELECT 1
                  FROM FATURAMENTO FT
                 WHERE FT.NRFATURA = CI.CDIDENTIFICADOR)
           AND NOT EXISTS
         (SELECT 1
                  FROM DUPLICATA_FATURAMENTO DF
                 WHERE DF.NRDUPLICATA = CI.CDIDENTIFICADOR);
      END IF;
    END IF;
    IF (PTPINTEGRACAO = '*' OR PTPINTEGRACAO = 'FT') THEN
      UPDATE TI_CONTROLE_INTEGRACAO CI
         SET CI.CDSITUACAO   = 'CA',
             CI.TXOBSERVACAO = 'TITULO CANC NO FATURAMENTO E NAO EXISTE NO EMS/RECEBER UNICOO'
       WHERE CI.CDSITUACAO = 'GE'
         AND CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'FT'
         AND NOT EXISTS
       (SELECT 1
                FROM TI_TIT_ACR_ESTORNO TAC
               WHERE TAC.NRSEQ_CONTROLE_INTEGRACAO = CI.NRSEQUENCIAL)
         AND NOT EXISTS (SELECT 1
                FROM EMS_MOVIMENTO_TITULO_ACR EMS
               WHERE EMS.NRDOCUMENTO = CI.CDIDENTIFICADOR)
         AND NOT EXISTS
       (SELECT 1
                FROM TITULO_A_RECEBER TR
               WHERE TR.NRDOCUMENTO = CI.CDIDENTIFICADOR);
    END IF;
  END;

  --=========================--
  -- Grava falha de processo --
  -----------------------------
  PROCEDURE P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                          PCDINTEGRACAO              VARCHAR2,
                          PTXFALHA                   VARCHAR2,
                          PTXAJUDA                   VARCHAR2,
                          PCDSITUACAO                IN OUT VARCHAR2,
                          PNRMENSAGEM                NUMBER DEFAULT NULL) IS
  BEGIN
    PCDSITUACAO := 'ER';
    BEGIN
      INSERT INTO TI_FALHA_DE_PROCESSO
        (NRSEQUENCIAL,
         NRSEQ_CONTROLE_INTEGRACAO,
         CDINTEGRACAO,
         TXFALHA,
         TXAJUDA,
         DTFALHA,
         NRMENSAGEM)
      VALUES
        (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
         PNRSEQ_CONTROLE_INTEGRACAO,
         PCDINTEGRACAO,
         PTXFALHA,
         PTXAJUDA,
         SYSDATE,
         PNRMENSAGEM);
    EXCEPTION
      WHEN OTHERS THEN
        RAISE_APPLICATION_ERROR(-20001,
                                PNRSEQ_CONTROLE_INTEGRACAO || PCDINTEGRACAO ||
                                PTXFALHA || PTXAJUDA);
    END;
    P_UPDATE_CONTROLE_INTEGRACAO(PNRSEQ_CONTROLE_INTEGRACAO,
                                 PCDSITUACAO,
                                 NULL);
  END;

  PROCEDURE P_TIT_PAGAR_CANCELADO_EMS(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER) IS
    TTI_TIT_APB             TI_TIT_APB%ROWTYPE;
    TTI_CONTROLE_INTEGRACAO TI_CONTROLE_INTEGRACAO%ROWTYPE;
    TTIT_AP                 TIT_AP%ROWTYPE;
    TFORNECEDOR_EMS         FORNECEDOR%ROWTYPE;
    TTIT_CANCDO_APB         TIT_CANCDO_APB%ROWTYPE;
    VSIT                    VARCHAR2(2);
    -- procedure para inserir historico de cancelamento no unicoo
    PROCEDURE INSERE_HISTORICO_80(PNRREGISTRO_TITULO IN NUMBER) IS
      THISTORICO_DO_TITULO_PAGAR HISTORICO_DO_TITULO_PAGAR%ROWTYPE;
    BEGIN
      SELECT *
        INTO THISTORICO_DO_TITULO_PAGAR
        FROM HISTORICO_DO_TITULO_PAGAR
       WHERE NRREGISTRO_TITULO = PNRREGISTRO_TITULO;
      SELECT PRODUCAO.SEQ_NRMOVHIST_PAGAR.NEXTVAL@UNICOO_HOMOLOGA
        INTO THISTORICO_DO_TITULO_PAGAR.NRMOVIMENTO
        FROM DUAL;
      THISTORICO_DO_TITULO_PAGAR.CDMOVIMENTO   := '80';
      THISTORICO_DO_TITULO_PAGAR.CDFUNCIONARIO := 'CANCEMS';
      THISTORICO_DO_TITULO_PAGAR.DTMOVIMENTO   := SYSDATE;
      INSERT INTO HISTORICO_DO_TITULO_PAGAR
      VALUES THISTORICO_DO_TITULO_PAGAR;
    END;

  BEGIN
    -- busca o controle
    SELECT *
      INTO TTI_CONTROLE_INTEGRACAO
      FROM TI_CONTROLE_INTEGRACAO
     WHERE TPINTEGRACAO = 'CP'
       AND NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO;
    -- busca o cancelamento do titulo
    SELECT *
      INTO TTIT_CANCDO_APB
      FROM TIT_CANCDO_APB
     WHERE NUM_ID_TIT_AP = TTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM;
    -- busca o fornecedor do ems
    SELECT EFN.*
      INTO TFORNECEDOR_EMS
      FROM FORNECEDOR EFN, TI_EMPRESA EMP
     WHERE EFN.CDN_FORNECEDOR = TTIT_CANCDO_APB.CDN_FORNECEDOR
       AND EFN.COD_EMPRESA = EMP.COD_EMPRESA
       AND EMP.CDEMPRESA = F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
    SELECT *
      INTO TTI_TIT_APB
      FROM TI_TIT_APB M
     WHERE M.COD_TITULO_AP = TTIT_CANCDO_APB.COD_TIT_AP
       AND M.COD_ID_FEDER = TFORNECEDOR_EMS.COD_ID_FEDER
       AND M.CDSITUACAO = 'IT';
    INSERE_HISTORICO_80(TTI_TIT_APB.NRREGISTRO_TITULO);
    UPDATE TI_CONTROLE_INTEGRACAO
       SET CDSITUACAO = 'IT'
     WHERE NRSEQUENCIAL = TTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL;
  EXCEPTION
    WHEN OTHERS THEN
      P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                    'CP',
                    'Erro ao cancelar o titulo no unicoo',
                    SQLERRM,
                    VSIT);
  END;

  --========================--
  -- Controle de integrao --
  ----------------------------
  PROCEDURE P_TI_PROCESSA_INTEGRACAO(PTPINTEGRACAO    VARCHAR2,
                                     PNRSEQUENCIAL    NUMBER,
                                     PNRSESSAO        NUMBER,
                                     PCDIDENTIFICADOR VARCHAR2,
                                     PCDSITUACAO      IN OUT VARCHAR2) IS
  BEGIN
    IF PTPINTEGRACAO = 'TP' THEN
      --================--
      -- Titulo a pagar --
      --------------------
      P_TI_TIT_APB(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'CL' THEN
      --============--
      -- Cliente --
      ----------------
      P_TI_CLIENTE(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'FN' THEN
      --============--
      -- Fornecedor --
      ----------------
      P_TI_FORNECEDOR(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'TR' THEN
      --==================--
      -- Titulo a receber --
      ----------------------
      P_TI_TIT_ACR(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'FT' THEN
      --=============================--
      -- Cancelamento do faturamento --
      ---------------------------------
      P_TI_TIT_ACR_ESTORNO(PNRSEQUENCIAL,
                           PCDIDENTIFICADOR,
                           PCDSITUACAO,
                           PNRSESSAO);
    ELSIF PTPINTEGRACAO = 'CX' THEN
      --=============================--
      -- Caixa e Bancos              --
      ---------------------------------
      P_TI_MOVIMENTO_CTA_CORRENTE(PNRSEQUENCIAL, PNRSESSAO, PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'CP' THEN
      --=============================--
      -- Titulo Cancelado no EMS     --
      ---------------------------------
      P_TIT_PAGAR_CANCELADO_EMS(PNRSEQUENCIAL);
    ELSIF PTPINTEGRACAO = 'BP' THEN
      EMS506UNICOO.PCK_BX_TIT_EMS.P_PROCESSA_APB(PNRSEQUENCIAL,
                                                 PNRSESSAO,
                                                 PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'BR' THEN
      EMS506UNICOO.PCK_BX_TIT_EMS.P_PROCESSA_ACR(PNRSEQUENCIAL,
                                                 PNRSESSAO,
                                                 PCDSITUACAO);
    ELSIF PTPINTEGRACAO = 'BC' THEN
      EMS506UNICOO.PCK_BX78_TIT_EMS.P_PROCESSA_ACR78(PNRSEQUENCIAL,
                                                     PNRSESSAO,
                                                     PCDSITUACAO);
    END IF;
  END;

  PROCEDURE P_TI_VALIDA_ENDERECO(PNRREGISTRO                IN NUMBER,
                                 PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                                 PCDINTEGRACAO              IN VARCHAR2,
                                 PCDSITUACAO                IN OUT VARCHAR2) IS
    VCDCIDADE ENDERECO.CDCIDADE%TYPE;
  BEGIN
    BEGIN
      ---------------------
      -- Verifica Endereco --
      ---------------------
      BEGIN
        SELECT CDCIDADE
          INTO VCDCIDADE
          FROM ENDERECO ED
         WHERE ED.NRREGISTRO = PNRREGISTRO
           AND ED.TPENDERECO = F_TI_TIP_ENDERECO(PNRREGISTRO);
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          -- Josias 03-07-2014
          --- pegar como default a cidade do endereço defaul
          SELECT CDCIDADE
            INTO VCDCIDADE
            FROM ENDERECO ED
           WHERE ED.NRREGISTRO = 10405
                --    F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO') VINICIUS NOVA IGUAÇU
             AND TPENDERECO = 'COBR';
          --  F_TI_TIP_ENDERECO(F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO'));
      END;
      BEGIN
        ---------------------
        -- Verifica Cidade --
        ---------------------
        SELECT CDCIDADE
          INTO VCDCIDADE
          FROM ENDERECO ED
         WHERE ED.NRREGISTRO = 10405
              -- F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO') VINICIUS NOVA IGUAÇU
           AND TPENDERECO = 'COBR';
        --  F_TI_TIP_ENDERECO(F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO'));
        SELECT CDCIDADE
          INTO VCDCIDADE
          FROM PRODUCAO.CIDADE@UNICOO_HOMOLOGA
         WHERE CDCIDADE = VCDCIDADE;
        PCDSITUACAO := 'RC';
      EXCEPTION
        WHEN NO_DATA_FOUND THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        PCDINTEGRACAO,
                        'Cidade não cadastrada',
                        'Pessoa ==> ' || PNRREGISTRO || ' A Cidade ==> ' ||
                        VCDCIDADE || ' Não existe',
                        PCDSITUACAO,
                        NULL);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        PCDINTEGRACAO,
                        'Cidade no cadastrada',
                        'Pessoa ==> ' || PNRREGISTRO ||
                        ' Erro ao pesquisar cidade ' || SQLERRM,
                        PCDSITUACAO,
                        NULL);
      END;
    EXCEPTION
      /*
      when no_data_found then


                    p_grava_falha(pnrseq_controle_integracao,
                                  pCDIntegracao,
                                  'Endereo no cadastrado',
                                  'Pessoa ==> '||pnrregistro,
                                  pCDSituacao,
                                  null);
       */
      WHEN OTHERS THEN
        P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                      PCDINTEGRACAO,
                      'Erro ao validar o endereo',
                      'Erro ao pesquisar endereco ' || SQLERRM,
                      PCDSITUACAO,
                      NULL);
    END;
  END;

  --==================================--
  -- Grava Fornecedor - TI_FORNECEDOR --
  --------------------------------------
  PROCEDURE P_TI_FORNECEDOR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                            PNRSESSAO                  NUMBER,
                            PCDSITUACAO                IN OUT VARCHAR2) IS

    VLOGRADOURO             TI_FORNECEDOR.NOM_ENDERECO%TYPE;
    VCOMPLEMENTO            TI_FORNECEDOR.NOM_ENDER_COMPL%TYPE;
    VBAIRRO                 TI_FORNECEDOR.NOM_BAIRRO%TYPE;

    VQTLOGRADOURO           NUMBER :=40;
    VQTCOMPLEMENTO          NUMBER :=10;
    VQTNRIMOVEL             NUMBER := 1;
    
 
    VLENGTH_TXCOMPLEMENTO        NUMBER;
    VLENGTH_TXCOMPLEMENTO_REDUZ    NUMBER;
    VLENGTH_NOLOGRADOURO      NUMBER;
    VLENGTH_NOLOGRADOURO_REDUZ NUMBER;
    
    

    CURSOR C_INTEGRA_CLIFOR IS
      SELECT CI.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
             CI.CDSITUACAO,
             CI.CDIDENTIFICADOR,
             CI.CDACAO,
             CI.NRSEQUENCIAL_ORIGEM
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'FN'
         AND CI.CDSITUACAO = PCDSITUACAO
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0);
    TTI_CONTROLE_INTEGRACAO TI_CONTROLE_INTEGRACAO%ROWTYPE;
    TFORNECEDOR             PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA%ROWTYPE;
    TGRUPO_DE_FORNECEDOR    GRUPO_DE_FORNECEDOR%ROWTYPE;
    TPESSOA                 PESSOA%ROWTYPE;
    TESTADO_CIVIL           ESTADO_CIVIL%ROWTYPE;
    TENDERECO               ENDERECO%ROWTYPE;
    TCIDADE                 PRODUCAO.CIDADE@UNICOO_HOMOLOGA%ROWTYPE;
    TTI_PESSOA              TI_PESSOA%ROWTYPE;
    TTI_GRUPO_DE_FORNECEDOR TI_GRUPO_DE_FORNECEDOR%ROWTYPE;
    TCDN_FORNECEDOR         TI_PESSOA.CDN_FORNECEDOR%TYPE;
  BEGIN
    FOR L_INTEGRA_CLIFOR IN C_INTEGRA_CLIFOR LOOP
      BEGIN
        PCDSITUACAO := 'RC';
        BEGIN
          SELECT *
            INTO TFORNECEDOR
            FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA
           WHERE CDFORNECEDOR = L_INTEGRA_CLIFOR.CDIDENTIFICADOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20100,
                                    'Forn. no unicoo nao encontrado: ' ||
                                    L_INTEGRA_CLIFOR.CDIDENTIFICADOR);
        END;
        BEGIN
          -----------------------------------------------------------------------
          -- Josias 01-07-2014 - Alteração para pegar o codigo do fornecedor do EMS
          -- que esta gravado na ti_pessoa e nao mais no fornecedor
          -----------------------------------------------------------------------
          SELECT P.CDN_FORNECEDOR
            INTO TCDN_FORNECEDOR
            FROM TI_PESSOA P
           WHERE P.NRREGISTRO = TFORNECEDOR.NRREGISTRO_FORNECEDOR;
        EXCEPTION
          WHEN OTHERS THEN
            RAISE_APPLICATION_ERROR(-20100,
                                    'Erro -> pessoa nao cadastrada para fornecedor na TI_PESSOA ' ||
                                    TFORNECEDOR.CDFORNECEDOR);
        END;
        BEGIN
          SELECT *
            INTO TGRUPO_DE_FORNECEDOR
            FROM GRUPO_DE_FORNECEDOR
           WHERE CDGRUPO_FORNECEDOR = TFORNECEDOR.CDGRUPO_FORNECEDOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20101,
                                    'Grupo do Forn. no unicoo nao encontrado: ' ||
                                    TFORNECEDOR.CDGRUPO_FORNECEDOR);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TPESSOA
            FROM PESSOA
           WHERE NRREGISTRO = TFORNECEDOR.NRREGISTRO_FORNECEDOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20102,
                                    'Cadastro de Pessoa do fornecor nao encontrado: ' ||
                                    L_INTEGRA_CLIFOR.CDIDENTIFICADOR);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TESTADO_CIVIL
            FROM ESTADO_CIVIL
           WHERE CDESTADOCIVIL = TPESSOA.CDESTADOCIVIL;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TENDERECO
            FROM ENDERECO
           WHERE NRREGISTRO = TPESSOA.NRREGISTRO
             AND TPENDERECO = F_TI_TIP_ENDERECO(TPESSOA.NRREGISTRO);
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            -- josias 29-06-2014
            -- coloquei para pegar o endereço da unimed como default
            --SELECT *
            --  INTO TENDERECO
            --  FROM ENDERECO
            -- WHERE NRREGISTRO = 9999999999
                  --      F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO') VINICIUS NOVA IGUAÇU
             --  AND TPENDERECO = 'COBR';
            --     F_TI_TIP_ENDERECO(F_TI_PARAMETRO_INTEGRACAO('NRREGISTRO_ENDERECO_DEFAULT_INCLUSAO'));
            --          raise_application_error(-20103,'Fornecedor sem endereco: '||l_integra_clifor.cdidentificador);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TCIDADE
            FROM PRODUCAO.CIDADE@UNICOO_HOMOLOGA
           WHERE CDCIDADE = TENDERECO.CDCIDADE;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            -- Josias 01-07-2014 - retirado esse erro, pois foi criado parametro para
            -- preenher o nome da cidades.
            --raise_application_error(-20104,'Cidade do fornecedor invalido: '||l_integra_clifor.cdidentificador);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TTI_GRUPO_DE_FORNECEDOR
            FROM TI_GRUPO_DE_FORNECEDOR
           WHERE CDGRUPO_FORNECEDOR =
                 TGRUPO_DE_FORNECEDOR.CDGRUPO_FORNECEDOR;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20104,
                                    'Grupo de fornecedor invalido: ' ||
                                    TGRUPO_DE_FORNECEDOR.CDGRUPO_FORNECEDOR);
            NULL;
        END;
        BEGIN
          SELECT *
            INTO TTI_PESSOA
            FROM TI_PESSOA
           WHERE NRREGISTRO = TPESSOA.NRREGISTRO;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            RAISE_APPLICATION_ERROR(-20104,
                                    'Pessoa de integracao nao encontrado: ' ||
                                    TPESSOA.NRREGISTRO);
            NULL;
        END;
        begin
          select distinct 1
            into vlmatriz
            from ti_matriz_pagar v
            where v.nrregistro = tfornecedor.nrregistro_fornecedor;
        exception
           when no_data_found then
           vlmatriz := 0;
        end;

 VQTNRIMOVEL := LENGTH(TENDERECO.NRIMOVEL);
  VLENGTH_TXCOMPLEMENTO    := LENGTH(TENDERECO.TXCOMPLEMENTO)     ;
 VLENGTH_TXCOMPLEMENTO_REDUZ := LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0))   ;
  VLENGTH_NOLOGRADOURO  :=      (LENGTH(TRIM(TENDERECO.NOLOGRADOURO))) ;
  VLENGTH_NOLOGRADOURO_REDUZ  := (LENGTH(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0)));


 --TRATATIVA DOS ENDEÇOES E LOGRADOUROS (21/10/2016)
 --COMPLEMENTO NULO OU ATÉ 10 E O LOGRADOURO + NRIMOVEL ATÉ 40
 --LINHAS 1 E 2 DA PLANILHA
  IF ((TENDERECO.TXCOMPLEMENTO IS NULL OR LENGTH(TENDERECO.TXCOMPLEMENTO) <= VQTCOMPLEMENTO) AND
     (LENGTH(TRIM(TENDERECO.NOLOGRADOURO)))+ NVL((VQTNRIMOVEL + 1),0) <= VQTLOGRADOURO) THEN

      IF TENDERECO.NRIMOVEL IS NULL THEN VLOGRADOURO :=  TRIM(TENDERECO.NOLOGRADOURO);
      ELSE                               VLOGRADOURO :=  TRIM(TENDERECO.NOLOGRADOURO) || ',' ||TENDERECO.NRIMOVEL;
      END IF;

      VCOMPLEMENTO := TENDERECO.TXCOMPLEMENTO;

      INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '1', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

   --FIM DA TRATATIVA DAS LINHAS 1 E 2
   --LOGRADOURO+NRIMOVEL ACIMA DE 40, PORÉM LOGRAD+IMOVEL REDUZ ATÉ 40 E O COMPLEMENTO ATÉ 10
   --LINHA 3 DA PLANILHA
   ELSIF (((LENGTH(TENDERECO.TXCOMPLEMENTO) <= VQTCOMPLEMENTO) OR (TENDERECO.TXCOMPLEMENTO IS NULL)) AND
         (LENGTH(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0)))+ NVL((VQTNRIMOVEL + 1),0) <= VQTLOGRADOURO) THEN

      IF TENDERECO.NRIMOVEL IS NULL THEN VLOGRADOURO :=  F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0);
      ELSE                               VLOGRADOURO :=  F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0) || ',' ||TENDERECO.NRIMOVEL;
      END IF;

      VCOMPLEMENTO := TENDERECO.TXCOMPLEMENTO;

      INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '3', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);


   --FIM DA TRATATIVA DA LINHA 3
   --COMPLEMENTO ACIMA DE 10, PORÉM COMPL REDUZ ATÉ 10 E O LOGRADOURO + NRIMOVEL ATÉ 40
   --LINHA 4 DA PLANILHA
   ELSIF (VLENGTH_TXCOMPLEMENTO > VQTCOMPLEMENTO AND VLENGTH_TXCOMPLEMENTO_REDUZ<=VQTCOMPLEMENTO) AND
         ( VLENGTH_NOLOGRADOURO+ NVL((VQTNRIMOVEL + 1),0) <= VQTLOGRADOURO) THEN

      IF TENDERECO.NRIMOVEL IS NULL THEN VLOGRADOURO :=  TRIM(TENDERECO.NOLOGRADOURO);
      ELSE                               VLOGRADOURO :=  TRIM(TENDERECO.NOLOGRADOURO) || ',' ||TENDERECO.NRIMOVEL;
      END IF;

      VCOMPLEMENTO := F_REDUZ_COMPL(TENDERECO.TXCOMPLEMENTO,0);

      INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '4', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

   --FIM DA TRATATIVA DA LINHA 4
   --COMPLEMENTO ACIMA DE 10, PORÉM COMPL REDUZ ATÉ 10 E O LOGRADOURO + NRIMOVEL ACIMA DE 40, PORÉM LOGR+IMOVEL REDUZ ATÉ 40
   --LINHA 5 DA PLANILHA
   ELSIF ((LENGTH(TENDERECO.TXCOMPLEMENTO) > VQTCOMPLEMENTO AND LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0))<= VQTCOMPLEMENTO) AND
         ((LENGTH(TRIM(TENDERECO.NOLOGRADOURO)))+ NVL((VQTNRIMOVEL + 1),0) > VQTLOGRADOURO) AND
         ((LENGTH(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0)))+ NVL((VQTNRIMOVEL + 1),0) <= VQTLOGRADOURO)) THEN

      IF TENDERECO.NRIMOVEL IS NULL THEN VLOGRADOURO :=  F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0);
      ELSE                               VLOGRADOURO :=  F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0) || ',' ||TENDERECO.NRIMOVEL;
      END IF;

      VCOMPLEMENTO := F_REDUZ_COMPL(TENDERECO.TXCOMPLEMENTO,0);

      INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '5', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

   --FIM DA TRATATIVA DA LINHA 5

   --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO + NRIMOVEL ATE 40
   --LINHA 6 DA PLANILHA
   ELSIF ((LENGTH(TENDERECO.TXCOMPLEMENTO) > VQTCOMPLEMENTO AND LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0))> VQTCOMPLEMENTO) AND
         ((LENGTH(TRIM(TENDERECO.NOLOGRADOURO)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) <= VQTLOGRADOURO)) THEN

      INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '6', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

      IF TENDERECO.NRIMOVEL IS NULL THEN VLOGRADOURO :=  TRIM(TENDERECO.NOLOGRADOURO) || '-' || F_REDUZ_COMPL(TENDERECO.TXCOMPLEMENTO,0);
      ELSE                               VLOGRADOURO :=  TRIM(TENDERECO.NOLOGRADOURO) || ',' || TENDERECO.NRIMOVEL || '-' || F_REDUZ_COMPL(TENDERECO.TXCOMPLEMENTO,0);
      END IF;

      VCOMPLEMENTO := NULL;

      INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '6', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

   --FIM DA TRATATIVA DA LINHA 6
   --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO REDUZ + NRIMOVEL ATE 40
   --LINHA 7 DA PLANILHA
    ELSIF (VLENGTH_TXCOMPLEMENTO > VQTCOMPLEMENTO AND VLENGTH_TXCOMPLEMENTO_REDUZ > VQTCOMPLEMENTO) AND
         (VLENGTH_NOLOGRADOURO+ NVL((VQTNRIMOVEL + 1),0) +1+VLENGTH_TXCOMPLEMENTO_REDUZ > VQTLOGRADOURO) AND
         (VLENGTH_NOLOGRADOURO_REDUZ + NVL((VQTNRIMOVEL + 1),0) +1+ VLENGTH_TXCOMPLEMENTO_REDUZ <= VQTLOGRADOURO) THEN

      IF TENDERECO.NRIMOVEL IS NULL THEN VLOGRADOURO :=  F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0) || '-' || F_REDUZ_COMPL(TENDERECO.TXCOMPLEMENTO,0) ;
      ELSE                               VLOGRADOURO :=  F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0) || ',' ||TENDERECO.NRIMOVEL || '-' || F_REDUZ_COMPL(TENDERECO.TXCOMPLEMENTO,0);
      END IF;

      VCOMPLEMENTO := NULL;

      INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '7', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

   --FIM DA TRATATIVA DA LINHA 7
   --COMPLEMENTO REDUZ ACIMA DE 10, PORÉM COMPL REDUZ E O LOGRADOURO REDUZ E ABREVIADO (ÚLTIMO RECURSO) + NRIMOVEL ATE 40
   --LINHA 8 DA PLANILHA
    ELSIF ((LENGTH(TENDERECO.TXCOMPLEMENTO) > VQTCOMPLEMENTO AND LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0))> VQTCOMPLEMENTO) AND
         ((LENGTH(TRIM(TENDERECO.NOLOGRADOURO)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
         ((LENGTH(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
         ((LENGTH(F_REDUZ_END_ABREV(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) <= VQTLOGRADOURO)
         ) THEN

      IF TENDERECO.NRIMOVEL IS NULL THEN VLOGRADOURO :=  F_REDUZ_END_ABREV(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0),0) || '-' || F_REDUZ_COMPL(TENDERECO.TXCOMPLEMENTO,0) ;
      ELSE                               VLOGRADOURO :=  F_REDUZ_END_ABREV(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0),0) || ',' ||TENDERECO.NRIMOVEL || '-' || F_REDUZ_COMPL(TENDERECO.TXCOMPLEMENTO,0);
      END IF;

      VCOMPLEMENTO := NULL;

      INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '8', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

   --FIM DA TRATATIVA DA LINHA 8
   -- ERRO - NAO ENTROU EM NENHUM DOS IFS ACIMA
    ELSIF ((LENGTH(TENDERECO.TXCOMPLEMENTO) > VQTCOMPLEMENTO AND LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0))> VQTCOMPLEMENTO) AND
         ((LENGTH(TRIM(TENDERECO.NOLOGRADOURO)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
         ((LENGTH(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO) AND
         ((LENGTH(F_REDUZ_END_ABREV(F_REDUZ_END(TRIM(TENDERECO.NOLOGRADOURO),0),0)))+ NVL((VQTNRIMOVEL + 1),0) +1+ LENGTH(f_reduz_compl(TENDERECO.TXCOMPLEMENTO,0)) > VQTLOGRADOURO)
         ) THEN

      -- VER COM O VINI PARA GRAVAR FALHA NO PROCESSO
      VLOGRADOURO  := NULL;
      VCOMPLEMENTO := NULL;

      INSERT INTO END_MIGRA VALUES (TENDERECO.NOLOGRADOURO, TENDERECO.TXCOMPLEMENTO, VLOGRADOURO, VCOMPLEMENTO, '9', TENDERECO.NRIMOVEL, TENDERECO.NRREGISTRO);

   END IF;

   --VALIDACAO DO TAMANHO DO BAIRRO
   --SE NAO ENVIAR O BAIRRO COMPLETO, TENTA O REDUZIDO E POR ÚLTIMO TRUNCA
   VBAIRRO := '';

   IF LENGTH(TENDERECO.NOBAIRRO) >20 THEN
      IF LENGTH(f_reduz_bairro(TENDERECO.NOBAIRRO,0)) > 20 THEN
         VBAIRRO := SUBSTR(F_REDUZ_BAIRRO(TENDERECO.NOBAIRRO,0),1,20); --20 POSICOES DO REDUZIDO
      ELSE
         VBAIRRO := f_reduz_bairro(TENDERECO.NOBAIRRO,0); -- BAIRRO REDUZIDO
      END IF;
   ELSE VBAIRRO := TENDERECO.NOBAIRRO; -- BAIRRO INTEIRO
   END IF;

   INSERT INTO END_MIGRA VALUES (VBAIRRO,NULL,TENDERECO.NOBAIRRO,NULL,NULL,NULL,TENDERECO.NRREGISTRO);

        if ((tti_grupo_de_fornecedor.cod_grp_fornecedor = 'NAOM') and (vlmatriz = 0)) then

          null;

        else

          INSERT INTO TI_FORNECEDOR
            (NRSEQ_CONTROLE_INTEGRACAO,
             NRSEQ_FAVORECIDO,
             CDSITUACAO,
             COD_ACAO,
             COD_AGENC_BCIA,
             COD_BANCO,
             COD_CEP,
             COD_CEP_PAGTO,
             COD_CTA_CORREN_BCO,
             COD_CX_POST,
             COD_CX_POST_PAGTO,
             COD_DIGITO_AGENC_BCIA,
             COD_DIGITO_CTA_CORREN,
             COD_E_MAIL,
             COD_EMPRESA,
             COD_FAX,
             COD_FORMA_PAGTO,
             COD_FORNECEDOR,
             COD_GRP_FORNECEDOR,
             COD_ID_ESTAD_FISIC,
             COD_ID_FEDER,
             COD_ID_FEDER_ESTAD_JURID,
             COD_ID_FEDER_JURID,
             COD_ID_FEDER_MATRIZ,
             COD_ID_FEDER_NASC,
             COD_ID_MUNIC_JURID,
             COD_ID_PREVID_SOCIAL,
             COD_ORG_EMIS_ID_ESTAD,
             COD_PAIS_NASC,
             COD_PORTAD_PREFER,
             COD_RAMAL_FAX,
             COD_TELEFONE_1,
             COD_TELEFONE_2,
             COD_TELEFONE_3,
             COD_TIP_FLUXO_FINANC,
             COD_TIP_FORNECEDOR,
             COD_UNID_FEDER,
             COD_UNID_FEDER_EMIS_ESTAD,
             COD_UNID_FEDER_PAGTO,
             DAT_ENVIO,
             DAT_IMPL_FORNECEDOR,
             DAT_NASCIMENTO,
             DAT_PROCESSAMENTO,
             DEST_ANOT_TABELA,
             IND_ESTADO_CIVIL,
             IND_OCORRENCIA,
             IND_TIPO_PESSOA,
             LOG_FINS_LUCRAT,
             NOM_ABREV,
             NOM_BAIRRO,
             NOM_BAIRRO_PAGTO,
             NOM_CIDADE,
             NOM_CIDADE_PAGTO,
             NOM_ENDER_COMPL,
             NOM_ENDER_COMPL_PAGTO,
             NOM_ENDERECO,
             NOM_ENDERECO_PAGTO,
             NOM_FORNECEDOR,
             NOM_HOME_PAGE,
             NOM_MAE,
             NOM_NACIONALIDADE,
             NOM_PROFISSAO,
             NRPESSOA)

          VALUES

            (L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO, -- nrseq_controle_integracao,
             0, --nrseq_favorecido,
             'RC', --cdsituacao,
             L_INTEGRA_CLIFOR.CDACAO, --cd cod_acao,
             ' ', --cod_agenc_bcia,
             ' ', --cod_banco,
             -- josias 29-06-2014
             -- coloquei o cep padrão de americana para evitar os erros.
             NVL(TENDERECO.NRCEP,
                 ' '),--F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')), --cod_cep,
             NVL(TENDERECO.NRCEP,
                 ' '),--F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')), --cod_cep_pagto,
             ' ', --cod_cta_corren_bco,
             ' ', --cod_cx_post,
             ' ', --cod_cx_post_pagto,
             ' ', --cod_digito_agenc_bcia,
             ' ', --cod_digito_cta_corren,
             nvl(substr(tendereco.cdemail_adicional,1,40),' '), --cod_e_mail,
             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA'), --cod_empresa,
             ' ', --cod_fax,
             F_TI_PARAMETRO_INTEGRACAO('COD_FORMA_PAGTO'), --cod_forma_pagto,
             TCDN_FORNECEDOR, --cod_fornecedor,
             TTI_GRUPO_DE_FORNECEDOR.COD_GRP_FORNECEDOR, -- cod_grp_fornecedor,
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_estad_fisic,
             CASE WHEN TPESSOA.NRCGC_CPF IS NOT NULL THEN TPESSOA.NRCGC_CPF WHEN
             TPESSOA.TPPESSOA = 'F' THEN
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_PESSOA_FISICA') ELSE
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER_PESSOA_JURIDICA') END, --cod_id_feder,

             --F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_feder_estad_jurid,
             CASE WHEN TPESSOA.TPPESSOA = 'J' THEN
             NVL(TPESSOA.NRINSCEST_RG, 'ISENTO') ELSE ' ' END, --cod_id_feder_estad_jurid
             NVL(TPESSOA.NRCGC_CPF, ' '), --cod_id_feder_jurid,
             ' ',--F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_feder_matriz,
             ' ',--F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_id_feder_nasc,
             ' ', --cod_id_munic_jurid,
             ' ', --cod_id_previd_social,
             NVL(TPESSOA.NOORGAO_EMISSOR_RG, ' '), --cod_org_emis_id_estad,
             F_TI_PARAMETRO_INTEGRACAO('COD_PAIS'), --cod_pais_nasc,
             DECODE(TPESSOA.TPPESSOA,
                    'F',
                    F_TI_PARAMETRO_INTEGRACAO('COD_PORTAD_PREFER_PESSOA_FISICA'),
                    F_TI_PARAMETRO_INTEGRACAO('COD_PORTAD_PREFER_PESSOA_JURIDICA')), --cod_portad_prefer,
             ' ', --cod_ramal_fax,
             ' ', --cod_telefone_1,
             ' ', --cod_telefone_2,
             ' ', --cod_telefone_3,

             --           F_TI_PARAMETRO_INTEGRACAO('COD_TIP_FLUXO_FINANC_PREFER_FOR'), --cod_tip_fluxo_financ,
             DECODE(TPESSOA.TPPESSOA,
                    'F',
                    F_TI_PARAMETRO_INTEGRACAO('COD_TIP_FLUXO_FINANC_PREFER_FOR_F'),
                    F_TI_PARAMETRO_INTEGRACAO('COD_TIP_FLUXO_FINANC_PREFER_FOR_J')), --cod_tip_fluxo_financ,

             999, --cod_tip_fornecedor,
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_unid_feder,
             F_TI_PARAMETRO_INTEGRACAO('COD_ID_FEDER'), --cod_unid_feder_emis_estad,
             ' ', --cod_unid_feder_pagto,
             SYSDATE, --dat_envio,
             F_TI_PARAMETRO_INTEGRACAO('DAT_IMPL_FORNECEDOR'), --dat_impl_fornecedor,
             TPESSOA.DTNASCIMENTO, --dat_nascimento,
             SYSDATE, --dat_processamento,

             -- O CAMPO DEST_ANOT_TABELA RECEBERÁ O ENDEREÇO COMPLETO (LOGRAD + NR + COMPL + BAIRRO
             -- PARA DEPOIS ENVIÁ-LO PARA O CAMPO NOM_ENDER_TEXT QUE NÃO EXISTE NA TI_FORNECEDOR
             -- O TI_FORNECEDOR.P (PROGRESS) FARÁ ESTA TRANSFERÊNCIA DE CONTEÚDO ENTRE ESTES CAMPOS
             -- NA A CHAMADA DA API
             TRIM(TENDERECO.NOLOGRADOURO) || DECODE(TENDERECO.NRIMOVEL,NULL,'',', ') ||
                                             DECODE(TENDERECO.NRIMOVEL,NULL,'',TENDERECO.NRIMOVEL) ||
                                             DECODE(TENDERECO.TXCOMPLEMENTO,NULL,'',' - ') ||
                                             DECODE(TENDERECO.TXCOMPLEMENTO,NULL,'',TRIM(TENDERECO.TXCOMPLEMENTO)) ||
                                             ' - ' || TENDERECO.NOBAIRRO, --dest_anot_tabela,

             ' ', --ind_estado_civil,
             0, --ind_ocorrencia,
             TPESSOA.TPPESSOA, --ind_tipo_pessoa,
             'S', --log_fins_lucrat,
             TTI_PESSOA.NOABREVIADO_FORNECEDOR, --nom_abrev,
             -- josias 29-06-2014

             /*
             SUBSTR(NVL(TENDERECO.NOBAIRRO,
                        ' '),--F_TI_PARAMETRO_INTEGRACAO('NOBAIRRO_DEFAULT_INCLUSAO')),
                    1,
                    20), --nom_bairro,
             SUBSTR(NVL(TENDERECO.NOBAIRRO,
                        ' '),--F_TI_PARAMETRO_INTEGRACAO('NOBAIRRO_DEFAULT_INCLUSAO')),
                    1,
                    20), --nom_bairro_pagto,
             */
             VBAIRRO, --NOM_BAIRRO
             VBAIRRO, --NOM_BAIRRO_PAGTO

             NVL(TRIM(TCIDADE.NOCIDADE),
                 ' '),--F_TI_PARAMETRO_INTEGRACAO('NOCIDADE_DEFAULT_INCLUSAO')), --nom_cidade,
             NVL(TRIM(TCIDADE.NOCIDADE),
                 ' '),--F_TI_PARAMETRO_INTEGRACAO('NOCIDADE_DEFAULT_INCLUSAO')), --nom_cidade_pagto,
             --NVL(SUBSTR(TENDERECO.TXCOMPLEMENTO, 1,10), ' '), --nom_ender_compl,
             --NVL(SUBSTR(TENDERECO.TXCOMPLEMENTO, 1,10), ' '), --nom_ender_compl_pagto,
             VCOMPLEMENTO, --NOM_ENDER_COMPL
             VCOMPLEMENTO, --NOM_ENDER_COMPL_PAGTO
             /*
             nvl2(replace(replace(replace(tendereco.nologradouro, ' ',''),',',''),'.',''),
             f_abrevia_nome(trim(tendereco.nologradouro)||decode(tendereco.nrimovel,null,null,','||
                            tendereco.nrimovel),40,'PEA')
                   ,'Sem Endereco'),                         --nom_endereco,
             NVL(TRIM(F_ABREVIA_NOME(TRANSLATE(TENDERECO.NOLOGRADOURO,
                                               '0123456789,.;:]',
                                               '              ') ||
                                     DECODE(TENDERECO.NRIMOVEL,
                                            NULL,
                                            NULL,
                                            ',' || TENDERECO.NRIMOVEL),
                                     40,
                                     'PEA')),
                 'Sem Endereco'), --nom_endereco,
             */

             /*
             decode(TRIM(TENDERECO.NOLOGRADOURO),NULL,NULL,
                                                 decode(TENDERECO.NRIMOVEL,NULL,TENDERECO.NOLOGRADOURO,
                                                                           TENDERECO.NOLOGRADOURO || ', ' || TENDERECO.NRIMOVEL)), --NOM_ENDERECO


             decode(TRIM(TENDERECO.NOLOGRADOURO),NULL,NULL,
                                                 decode(TENDERECO.NRIMOVEL,NULL,TENDERECO.NOLOGRADOURO,
                                                                           TENDERECO.NOLOGRADOURO || ', ' || TENDERECO.NRIMOVEL)), --NOM_ENDERECO_PAGTO

             */
             VLOGRADOURO, --NOM_ENDERECO
             VLOGRADOURO, --NOM_ENDERECO_PAGTO

--             NVL(TRIM(TENDERECO.NOLOGRADOURO), 'Sem endereço'), --nom_endereco_pagto,

             F_ABREVIA_NOME(TPESSOA.NOPESSOA,40,''), --nom_fornecedor,
             ' ', --nom_home_page,
             -- Josias - 29-06-2014
             -- coloquei o truncamento pois estava estourando mais de 40 posições.
             F_ABREVIA_NOME(TPESSOA.NOMAE,40,''), --nom_mae,
             ' ',--F_TI_PARAMETRO_INTEGRACAO('NOM_NACIONALIDADE'), --nom_nacionalidade,
             NULL, --nom_profissao,
             TFORNECEDOR.NRREGISTRO_FORNECEDOR --nrpessoa
             );

          IF SQL%ROWCOUNT = 0 THEN
            P_TI_VALIDA_ENDERECO(L_INTEGRA_CLIFOR.NRSEQUENCIAL_ORIGEM,
                                 L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                                 'TI_FORNECEDOR',
                                 PCDSITUACAO);
            IF PCDSITUACAO = 'RC' THEN
              P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                            'TI_FORNECEDOR',
                            'A VIEW V_TI_FORNECEDOR NO ENCONTROU FORNECEDOR PARA O PROCESSO ==>' ||
                            L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO ||
                            'Pessoa ==>' ||
                            L_INTEGRA_CLIFOR.NRSEQUENCIAL_ORIGEM ||
                            'Fornecedor ==> ' ||
                            L_INTEGRA_CLIFOR.CDIDENTIFICADOR,
                            NULL,
                            PCDSITUACAO,
                            NULL);
            END IF;
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                        'TI_FORNECEDOR',
                        'O Fornecedor j foi enviado para a TI_FORNECEDOR',
                        NULL,
                        PCDSITUACAO,
                        -1);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        'TI_FORNECEDOR',
                        'Falha:  ' || SQLERRM,
                        ' Processo ==> ' ||
                        L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO ||
                        '  Pessoa ==> ' ||
                        L_INTEGRA_CLIFOR.NRSEQUENCIAL_ORIGEM ||
                        '  Fornecedor ==> ' ||
                        L_INTEGRA_CLIFOR.CDIDENTIFICADOR,
                        PCDSITUACAO,
                        NULL);

      END;

      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  --===============================--
  -- Grava Titulo - TI_TIT_ACR --
  -----------------------------------
  PROCEDURE P_TI_TIT_ACR_ESTORNO(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                 PNRDOCUMENTO               VARCHAR2,
                                 PCDSITUACAO                IN OUT VARCHAR2,
                                 PNRSESSAO                  NUMBER) IS
    CURSOR C_FATURA IS
      SELECT CI.*, FT.DTCANCELAMENTO
        FROM TI_CONTROLE_INTEGRACAO CI, FATURAMENTO FT
       WHERE CI.TPINTEGRACAO = 'FT'
         AND FT.NRFATURA = CI.CDIDENTIFICADOR
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND CDSITUACAO = 'VD'
         AND CI.NRSESSAO = PNRSESSAO;
    CURSOR C_EMS(PNRDOCUMENTO VARCHAR2) IS
      SELECT EMS.NUM_ID_TIT_ACR, EMS.NRDOCUMENTO
        FROM EMS_MOVIMENTO_TITULO_ACR EMS, TITULO_A_RECEBER TR, TIT_ACR TA
       WHERE TA.U##COD_ESTAB = EMS.COD_ESTAB
         AND TA.NUM_ID_TIT_ACR = EMS.NUM_ID_TIT_ACR
         AND TR.NRDOCUMENTO = PNRDOCUMENTO
         AND TR.NRDOCUMENTO = EMS.NRDOCUMENTO
         AND EMS.NRREGISTRO_TITULO = TR.NRREGISTRO_TITULO
         AND EMS.IND_TRANS_ACR_ABREV = 'IMPL'
         AND TA.LOG_TIT_ACR_ESTORDO = 0;
    VCDINTEGRACAO    VARCHAR2(100);
    VCOD_ESPEC_DOCTO TI_TIPO_MOVIMENTO_TIT_ACR.COD_ESPEC_DOCTO%TYPE;
    VAOACHOU         BOOLEAN;
  BEGIN
    VCDINTEGRACAO := 'TI_TIT_ACR_ESTORNO';
    PCDSITUACAO   := 'ER';
    FOR L_FATURA IN C_FATURA LOOP
      VAOACHOU := FALSE;
      FOR L_EMS IN C_EMS(L_FATURA.CDIDENTIFICADOR) LOOP
        PCDSITUACAO := 'RC';
        VAOACHOU    := TRUE;
        BEGIN
          INSERT INTO TI_TIT_ACR_ESTORNO
            (NRSEQ_CONTROLE_INTEGRACAO,
             CDSITUACAO,
             NRDOCUMENTO,
             COD_ESTAB,
             COD_ESPEC_DOCTO,
             COD_SER_DOCTO,
             COD_TIT_ACR,
             COD_PARCELA,
             COD_TIT_ACR_BCO,
             COD_REFER,
             NUM_ID_MOVTO_TIT_ACR,
             NUM_ID_TIT_ACR,
             COD_PORTADOR,
             DAT_TRANSACAO,
             DAT_ENVIO,
             CDN_CLIENTE,
             DAT_PROCESSAMENTO,
             IND_NIV_OPERAC_ACR,
             IND_TIP_OPERAC_ACR)
            SELECT L_FATURA.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
                   CDSITUACAO,
                   L_FATURA.CDIDENTIFICADOR NRDOCUMENTO,
                   COD_ESTAB,
                   COD_ESPEC_DOCTO,
                   COD_SER_DOCTO,
                   COD_TIT_ACR,
                   COD_PARCELA,
                   COD_TIT_ACR_BCO,
                   'E' || LPAD(L_FATURA.NRSEQUENCIAL, 9, '0'),
                   NUM_ID_MOVTO_TIT_ACR,
                   NUM_ID_TIT_ACR,
                   COD_PORTADOR,
                   L_FATURA.DTCANCELAMENTO DAT_TRANSACAO,
                   DAT_ENVIO,
                   CDN_CLIENTE,
                   DAT_PROCESSAMENTO,
                   IND_NIV_OPERAC_ACR,
                   IND_TIP_OPERAC_ACR
              FROM V_TI_TIT_ACR_ESTORNO TA
             WHERE TA.NUM_ID_TIT_ACR = L_EMS.NUM_ID_TIT_ACR;
          IF SQL%ROWCOUNT = 0 THEN
            P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Dados no encontrados na V_ti_tit_acr_estorno PARA O PROCESSO ' ||
                          L_FATURA.NRSEQUENCIAL || ' Especie: ' ||
                          VCOD_ESPEC_DOCTO || ' Srie: ' ||
                          SUBSTR(L_FATURA.CDIDENTIFICADOR, 1, 2) ||
                          'Titulo :' ||
                          SUBSTR(L_FATURA.CDIDENTIFICADOR,
                                 INSTR(L_FATURA.CDIDENTIFICADOR, '-') + 1,
                                 12),
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        EXCEPTION
          WHEN DUP_VAL_ON_INDEX THEN
            P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'A fatura j foi enviada para estorno. Processo ==>' ||
                          L_FATURA.NRSEQUENCIAL,
                          NULL,
                          PCDSITUACAO,
                          -1);
          WHEN OTHERS THEN
            P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Erro ao enviar fatura para cancelamento. Processo ==>' ||
                          L_FATURA.NRSEQUENCIAL || ' ' || SQLERRM,
                          NULL,
                          PCDSITUACAO,
                          NULL);
        END;
        --====================================--
        -- Atualizar o situao da integrao --
        ----------------------------------------
        P_UPDATE_CONTROLE_INTEGRACAO(L_FATURA.NRSEQUENCIAL,
                                     PCDSITUACAO,
                                     NULL);
      END LOOP;
      IF NOT VAOACHOU THEN
        P_GRAVA_FALHA(L_FATURA.NRSEQUENCIAL,
                      VCDINTEGRACAO,
                      'O titulo no EMS5==> ' || L_FATURA.CDIDENTIFICADOR || ' ' ||
                      L_FATURA.NRSEQUENCIAL || ' ' || SQLERRM,
                      NULL,
                      PCDSITUACAO,
                      NULL);
      END IF;
      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_FATURA.NRSEQUENCIAL,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
    -- Alessandro 19/03/2012
    FOR XX IN (SELECT T.NRDOCUMENTO,
                      T.NUM_ID_TIT_ACR,
                      MT.LOG_APROP_CTBL_CTBZDA,
                      T.NRSEQ_CONTROLE_INTEGRACAO
                 FROM TI_TIT_ACR_ESTORNO T, TIT_ACR TA, MOVTO_TIT_ACR MT
                WHERE MT.U##COD_ESTAB = TA.U##COD_ESTAB
                  AND MT.NUM_ID_TIT_ACR = TA.NUM_ID_TIT_ACR
                  AND MT.IND_TRANS_ACR_ABREV = 'IMPL'
                  AND TA.NUM_ID_TIT_ACR = T.NUM_ID_TIT_ACR
                  AND T.CDSITUACAO IN ('ER', 'RC')
               --and mt.LOG_APROP_CTBL_CTBZDA = 1
               ) LOOP
      IF XX.LOG_APROP_CTBL_CTBZDA = 1 THEN
        UPDATE TI_TIT_ACR_ESTORNO Q
           SET Q.CDSITUACAO = 'RC'
         WHERE Q.NRSEQ_CONTROLE_INTEGRACAO = XX.NRSEQ_CONTROLE_INTEGRACAO;
        P_UPDATE_CONTROLE_INTEGRACAO(XX.NRSEQ_CONTROLE_INTEGRACAO,
                                     'RC',
                                     '');
      ELSE
        UPDATE TI_TIT_ACR_ESTORNO Q
           SET Q.CDSITUACAO = 'ER'
         WHERE Q.NRSEQ_CONTROLE_INTEGRACAO = XX.NRSEQ_CONTROLE_INTEGRACAO;
        P_UPDATE_CONTROLE_INTEGRACAO(XX.NRSEQ_CONTROLE_INTEGRACAO,
                                     'ER',
                                     'Titulo nao CTBL EMS5');
        P_GRAVA_FALHA(XX.NRSEQ_CONTROLE_INTEGRACAO,
                      'FAT_CANCEL',
                      'Fatura Cancelada no Unicoo, e n?o CTBLZ no EMS5',
                      'Contabilize o ACR no EMS5',
                      PCDSITUACAO,
                      NULL);
      END IF;
    END LOOP;
    -- Alessandro 19/03/2012
  END;

  --===============================--
  -- Grava Titulo - TI_TIT_ACR --
  -----------------------------------
  PROCEDURE P_TI_TIT_ACR(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_TRATA_FALHA IS
      SELECT DISTINCT UCL.CDCLIENTE,
                      TIP.CDN_CLIENTE,
                      UCL.NRREGISTRO_CLIENTE,
                      CI.CDEMPRESA,
                      CI.CDMODULO,
                      CI.CDMOVIMENTO,
                      ECL.COD_GRP_CLIEN,
                      (SELECT COUNT(*)
                         FROM ENDERECO ED
                        WHERE ED.NRREGISTRO = UCL.NRREGISTRO_CLIENTE) QTENDERECO,
                      F_TI_TIP_MOVTO_TIT_ACR(CI.CDEMPRESA,
                                             CI.CDMODULO,
                                             CI.CDMOVIMENTO,
                                             ECL.COD_GRP_CLIEN) NUM_TIP_MOVTO_TIT_ACR
        FROM TITULO_A_RECEBER                 TR,
             TI_CONTROLE_INTEGRACAO           CI,
             PRODUCAO.CLIENTE@UNICOO_HOMOLOGA UCL,
             CLIENTE                          ECL,
             TI_PESSOA                        TIP,
             TI_EMPRESA                       EMP
       WHERE ECL.CDN_CLIENTE(+) = TIP.CDN_CLIENTE
         AND CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO
         AND TR.NRREGISTRO_TITULO = CI.NRSEQUENCIAL_ORIGEM
         AND TIP.NRREGISTRO(+) = UCL.NRREGISTRO_CLIENTE
         AND TR.CDCLIENTE = UCL.CDCLIENTE
         AND CI.CDEMPRESA = EMP.CDEMPRESA
         AND NVL(ECL.COD_EMPRESA, EMP.COD_EMPRESA) = EMP.COD_EMPRESA;
    CURSOR C_TITULOS IS
      SELECT *
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TR'
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
            --and cdsituacao = 'VD'
         AND CI.NRSESSAO = PNRSESSAO;
    VCDINTEGRACAO  VARCHAR2(100);
    VAO_ACHOU_ERRO BOOLEAN;
  BEGIN
    FOR L_TITULOS IN C_TITULOS LOOP
      BEGIN
        PCDSITUACAO   := 'RC';
        VCDINTEGRACAO := 'TI_TIT_ACR';
        INSERT INTO TI_TIT_ACR
          (COD_ESTAB,
           COD_TITULO_ACR,
           VAL_IR,
           DAT_DESCONTO,
           VAL_LIQ_TITULO,
           DES_TEXT_HISTOR,
           IND_OCORRENCIA,
           NRSEQ_CONTROLE_INTEGRACAO,
           IND_TIPO_PESSOA,
           COD_ID_FEDER_JURID,
           COD_ID_FEDER,
           COD_ESPEC_DOCTO,
           COD_PARCELA,
           DAT_EMISSAO,
           DAT_VENCTO,
           DAT_PREVISAO_LIQUIDAC,
           VAL_TITULO,
           COD_CART_BCIA,
           DAT_PROCESSAMENTO,
           COD_EMPRESA,
           COD_TIP_FLUXO_FINANC,
           COD_PAIS,
           COD_CTA_CTBL,
           COD_CCUSTO,
           VAL_DESCONTO,
           COD_TIT_ACR_BCO,
           COD_PORTADOR,
           COD_SER_DOCTO,
           IND_TIP_ESPEC_DOCTO,
           CDSITUACAO,
           COD_CLIENTE,
           NRPESSOA,
           COD_PLANO_CCUSTO,
           COD_PLANO_CTA_CTBL,
           VAL_PERC_JUROS_DIA_ATRASO,
           VAL_PERC_MULTA_ATRASO)
          SELECT COD_ESTAB,
                 COD_TITULO_ACR,
                 VAL_IR,
                 DAT_DESCONTO,
                 VAL_LIQ_TITULO,
                 DES_TEXT_HISTOR,
                 IND_OCORRENCIA,
                 NRSEQ_CONTROLE_INTEGRACAO,
                 IND_TIPO_PESSOA,
                 COD_ID_FEDER_JURID,
                 COD_ID_FEDER,
                 COD_ESPEC_DOCTO,
                 COD_PARCELA,
                 DAT_EMISSAO,
                 DAT_VENCTO,
                 DAT_PREVISAO_LIQUIDAC,
                 VAL_TITULO,
                 COD_CART_BCIA,
                 DAT_PROCESSAMENTO,
                 COD_EMPRESA,
                 COD_TIP_FLUXO_FINANC,
                 COD_PAIS,
                 COD_CTA_CTBL,
                 COD_CCUSTO,
                 VAL_DESCONTO,
                 COD_TIT_ACR_BCO,
                 COD_PORTADOR,
                 COD_SER_DOCTO,
                 IND_TIP_ESPEC_DOCTO,
                 CDSITUACAO,
                 COD_CLIENTE,
                 NRPESSOA,
                 COD_PLANO_CCUSTO,
                 COD_PLANO_CTA_CTBL,
                 0                         VAL_PERC_JUROS_DIA_ATRASO,
                 0                         VAL_PERC_MULTA_ATRASO
            FROM V_TI_TIT_ACR TIT
           WHERE TIT.NRSEQ_CONTROLE_INTEGRACAO = L_TITULOS.NRSEQUENCIAL;
        IF SQL%ROWCOUNT = 0 THEN
          VAO_ACHOU_ERRO := FALSE;
          /* p_grava_falha(l_titulos.nrsequencial,
          vCDIntegracao,
          'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
          l_titulos.nrsequencial,
          'A view V_TI_TIT_ACR nao encontrou registro',
          pCDSituacao,
          null);*/
          FOR L_TRATA_FALHA IN C_TRATA_FALHA LOOP
            VAO_ACHOU_ERRO := TRUE;
            IF L_TRATA_FALHA.CDN_CLIENTE IS NULL THEN
              -- Fazer a geração do Cliente para poder reprocessar o titulo depois
              ------------------------------------------------------------------------
              P_INSERE_CLIENTE(L_TITULOS.NRSEQUENCIAL_ORIGEM);
              ------------------------------------------------------------------------
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            'Falta integrar o cliente ' ||
                            L_TRATA_FALHA.CDN_CLIENTE || ' para o ',
                            PCDSITUACAO,
                            NULL);
            ELSIF L_TRATA_FALHA.QTENDERECO IS NULL THEN
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            'O Cliente ' || L_TRATA_FALHA.CDCLIENTE ||
                            ' nao foi integrado para o EMS5, o cliente no possui endereco no Unicoo.',
                            PCDSITUACAO,
                            NULL);
            ELSIF L_TRATA_FALHA.NUM_TIP_MOVTO_TIT_ACR = '-1' THEN
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            ' Tipo de movimento no cadastrado em TI_TIPO_MOVIMENTO_TIT_ACR, parametros informados: ' ||
                            ' Cdigo da Empresa: ' ||
                            L_TRATA_FALHA.CDEMPRESA || ' Cdigo do mdulo: ' ||
                            L_TRATA_FALHA.CDMODULO ||
                            ' Cdigo do movimento: ' ||
                            L_TRATA_FALHA.CDMOVIMENTO ||
                            ' Grupo de cliente no EMS5: ' ||
                            L_TRATA_FALHA.COD_GRP_CLIEN ||
                            ' Cdigo de cliente no EMS5: ' ||
                            L_TRATA_FALHA.CDN_CLIENTE,
                            PCDSITUACAO,
                            NULL);
            ELSE
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL,
                            NULL,
                            PCDSITUACAO,
                            NULL);
            END IF;
          END LOOP;
          IF VAO_ACHOU_ERRO = FALSE THEN
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'A view V_TI_TIT_ACR nao encontrou registro para o processo ==>' ||
                          L_TITULOS.NRSEQUENCIAL ||
                          '. Titulo ou cliente no existe no Unicoo',
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        ELSE
          VCDINTEGRACAO := 'TI_TIT_ACR_CTBL';
          INSERT INTO TI_TIT_ACR_CTBL CTB
            (VAL_APROP_CTBL,
             COD_ESTAB,
             COD_CTA_CTBL,
             COD_UNID_FEDERAC,
             COD_TIP_FLUXO_FINANC,
             NRSEQ_CONTROLE_INTEGRACAO,
             CDSITUACAO,
             COD_CCUSTO,
             DAT_PROCESSAMENTO)
            (SELECT VAL_APROP_CTBL,
                    COD_ESTAB,
                    COD_CTA_CTBL,
                    COD_UNID_FEDERAC,
                    COD_TIP_FLUXO_FINANC,
                    NRSEQ_CONTROLE_INTEGRACAO,
                    CDSITUACAO,
                    COD_CCUSTO,
                    DAT_PROCESSAMENTO
               FROM V_TI_TIT_ACR_CTBL CTB
              WHERE CTB.NRSEQ_CONTROLE_INTEGRACAO = L_TITULOS.NRSEQUENCIAL);
          IF SQL%ROWCOUNT = 0 THEN
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'A view V_ti_TIT_ACR_ctbl no encontrou registro para o processo ==>' ||
                          L_TITULOS.NRSEQUENCIAL,
                          NULL,
                          PCDSITUACAO,
                          NULL);
          ELSE
            VCDINTEGRACAO := 'TI_TIT_ACR_CTBL_IMPOSTO';
            INSERT INTO TI_TIT_ACR_IMPOSTO
              (COD_SER_DOCTO,
               IND_CLAS_IMPTO,
               VAL_RENDTO_TRIBUT,
               VAL_ALIQ_IMPTO,
               COD_ESTAB,
               COD_ESPEC_DOCTO,
               COD_PARCELA,
               COD_UNID_FEDERAC,
               COD_IMPOSTO,
               COD_CLASSIF_IMPTO,
               VAL_IMPOSTO,
               DAT_PROCESSAMENTO,
               CDSITUACAO,
               NRSEQ_CONTROLE_INTEGRACAO,
               IND_OCORRENCIA)
              (SELECT COD_SER_DOCTO,
                      IND_CLAS_IMPTO,
                      VAL_RENDTO_TRIBUT,
                      VAL_ALIQ_IMPTO,
                      COD_ESTAB,
                      COD_ESPEC_DOCTO,
                      COD_PARCELA,
                      COD_UNID_FEDERAC,
                      COD_IMPOSTO,
                      COD_CLASSIF_IMPTO,
                      VAL_IMPOSTO,
                      DAT_PROCESSAMENTO,
                      CDSITUACAO,
                      NRSEQ_CONTROLE_INTEGRACAO,
                      IND_OCORRENCIA
                 FROM V_TI_TIT_ACR_IMPOSTO IP
                WHERE IP.NRSEQ_CONTROLE_INTEGRACAO =
                      PNRSEQ_CONTROLE_INTEGRACAO);
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                        VCDINTEGRACAO,
                        'Titulo ja enviado. Processo ==>' ||
                        L_TITULOS.NRSEQUENCIAL,
                        NULL,
                        PCDSITUACAO,
                        -1);
          /*   when others then
          p_grava_falha(l_titulos.nrsequencial,
                          vCDIntegracao,
                          sqlerrm,
                          null,
                          pcdsituacao,
                          null);*/

          P_COMMIT;

      END;

      P_COMMIT;

      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_TITULOS.NRSEQUENCIAL,
                                   PCDSITUACAO,
                                   NULL);
      --=====================================--
      -- Titulo de Cooperados n?o trata falha,
      -- apenas cancela...
      -----------------------------------------
      IF SUBSTR(L_TITULOS.CDIDENTIFICADOR, 1, 3) = '9956-' THEN
        --braz
        P_UPDATE_CONTROLE_INTEGRACAO(L_TITULOS.NRSEQUENCIAL, --comentado emmaio de 2013 para tratar via arquivo gerado para baixa em lote pelo ems5
                                     'CA',
                                     NULL);
      END IF;
    END LOOP;
  END;

  --============================================--
  -- Grava Titulo a pagar - TI_TIT_APB      --
  --                        TI_TIT_APB_CTBL --
  ------------------------------------------------
  PROCEDURE P_TI_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_TRATA_FALHA IS
      SELECT DISTINCT EFN.CDN_FORNECEDOR CDFORNECEDOR,
                      TIP.CDN_FORNECEDOR CDFORNECEDOR_EMS5,
                      UFN.NRREGISTRO_FORNECEDOR,
                      CI.CDIDENTIFICADOR,
                      CI.CDEMPRESA,
                      CI.CDMODULO,
                      CI.CDMOVIMENTO,
                      EFN.CDN_FORNECEDOR,
                      EFN.COD_GRP_FORNEC,
                      CI.CDDIVISAO,
                      (SELECT COUNT(*)
                         FROM ENDERECO ED
                        WHERE ED.NRREGISTRO = UFN.NRREGISTRO_FORNECEDOR) QTENDERECO,
                      F_TI_TIP_MOVTO_TIT_APB(CI.CDEMPRESA,
                                             CI.CDMODULO,
                                             CI.CDMOVIMENTO,
                                             EFN.COD_GRP_FORNEC,
                                             CI.CDDIVISAO,
                                             CI.CDCENTRO_CUSTO) NUM_TIP_MOVTO_TIT_APB,
                      PE.NOPESSOA NOFORNECEDORUNICOO
        FROM TITULO_A_PAGAR                      TP,
             TI_CONTROLE_INTEGRACAO              CI,
             PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA UFN,
             PESSOA                              PE,
             FORNECEDOR                          EFN,
             TI_PESSOA                           TIP,
             TI_EMPRESA                          EMP
       WHERE CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO
         AND TP.NRREGISTRO_TITULO = CI.NRSEQUENCIAL_ORIGEM
         AND TP.CDFORNECEDOR = UFN.CDFORNECEDOR
         AND UFN.NRREGISTRO_FORNECEDOR = PE.NRREGISTRO
         AND TIP.NRREGISTRO = UFN.NRREGISTRO_FORNECEDOR
         AND EFN.CDN_FORNECEDOR = TIP.CDN_FORNECEDOR
         AND EFN.COD_EMPRESA = EMP.COD_EMPRESA
         AND EMP.CDEMPRESA =
             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
    CURSOR C_TITULOS IS
      SELECT CI.*
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.TPINTEGRACAO = 'TP'
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0)
         AND CI.NRSESSAO = PNRSESSAO;
    VCDINTEGRACAO           VARCHAR2(100);
    VAO_ACHOU_ERRO          BOOLEAN;
    RTI_TIT_APB_CTBL        TI_TIT_APB_CTBL%ROWTYPE;
    RTI_CONTROLE_INTEGRACAO TI_CONTROLE_INTEGRACAO%ROWTYPE;
    RFORNECEDOR             EMS506UNICOO.TI_PESSOA%ROWTYPE;
    RFORNECEDOR_EMS         FORNECEDOR%ROWTYPE;
    VCOD_ESTAB              TI_TIPO_MOVIMENTO_TIT_APB.CDDIVISAO%TYPE;
    HAFALHA                 BOOLEAN;
  BEGIN
    FOR L_TITULOS IN C_TITULOS LOOP
      BEGIN
        HAFALHA       := FALSE;
        VCDINTEGRACAO := 'TI_TIT_APB';
        -- tratativas de erro
        BEGIN
          SELECT *
            INTO RTI_CONTROLE_INTEGRACAO
            FROM TI_CONTROLE_INTEGRACAO
           WHERE NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            HAFALHA := TRUE;
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Controle integracão não encontrado',
                          NULL,
                          PCDSITUACAO,
                          NULL);
        END;
        BEGIN
          SELECT B.*
            INTO RFORNECEDOR
            FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA A,
                 EMS506UNICOO.TI_PESSOA              B
           WHERE A.NRREGISTRO_FORNECEDOR = B.NRREGISTRO
             AND CDFORNECEDOR =
                 (SELECT FO.CDFORNECEDOR
                    FROM TITULO_A_PAGAR                      TP,
                         PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FO
                   WHERE FO.CDFORNECEDOR = TP.CDFORNECEDOR
                     AND TP.NRREGISTRO_TITULO =
                         RTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM);
          IF RFORNECEDOR.CDN_FORNECEDOR IS NULL THEN
            -- Fazer a geração do fornecedor para poder reprocessar o titulo depois
            ------------------------------------------------------------------------
            P_INSERE_FORNECEDOR(RTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM);
            ------------------------------------------------------------------------
          END IF;
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            -- Fazer a geração do fornecedor para poder reprocessar o titulo depois
            ------------------------------------------------------------------------
            P_INSERE_FORNECEDOR(RTI_CONTROLE_INTEGRACAO.NRSEQUENCIAL_ORIGEM);
            ------------------------------------------------------------------------
            HAFALHA := TRUE;
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Fornecedor não integrado com TOTVS11, aguardar a integração do fornecedor !! ',
                          NULL,
                          PCDSITUACAO,
                          NULL);
        END;
        IF L_TITULOS.CDDIVISAO IS NOT NULL THEN
          BEGIN
            SELECT ET.COD_ESTAB
              INTO VCOD_ESTAB
              FROM TI_ESTABELECIMENTO ET
             WHERE ET.CDDIVISAO = L_TITULOS.CDDIVISAO;
          EXCEPTION
            WHEN NO_DATA_FOUND THEN
              HAFALHA := TRUE;
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'Falta o De-Para do unicoo para a Divisão [' ||
                            L_TITULOS.CDDIVISAO ||
                            ' ] na tabela TI_ESTABELECIMENTO ',
                            'Empresa[' || L_TITULOS.CDEMPRESA || '] ' ||
                            'Modulo[' || L_TITULOS.CDMODULO || '] ' ||
                            'Movimento[' ||
                            RPAD(L_TITULOS.CDMOVIMENTO, 5, ' ') || '] ' ||
                            'Divisão [' || L_TITULOS.CDDIVISAO || '] ' ||
                            'Verifique na tabela de vinculo , qual é o estabelecimento para a divisão ' ||
                            L_TITULOS.CDDIVISAO,
                            PCDSITUACAO,
                            NULL);
          END;
        END IF;
        BEGIN
          SELECT EFN.*
            INTO RFORNECEDOR_EMS
            FROM FORNECEDOR EFN, TI_EMPRESA EMP
           WHERE CDN_FORNECEDOR = RFORNECEDOR.CDN_FORNECEDOR
             AND EFN.COD_EMPRESA = EMP.COD_EMPRESA
             AND EMP.CDEMPRESA =
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA_UNICOO');
        EXCEPTION
          WHEN NO_DATA_FOUND THEN
            HAFALHA := TRUE;
            P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                          VCDINTEGRACAO,
                          'Fornecedor do ems não encontrado. _ ',
                          'Registro do Fornecedor no uicoo: ' ||
                          RFORNECEDOR.NRREGISTRO,
                          PCDSITUACAO,
                          NULL);
        END;
        -- colocado por fabiano
        IF NOT HAFALHA THEN
          PCDSITUACAO   := 'RC';
          VCDINTEGRACAO := 'TI_TIT_APB';
          BEGIN
            INSERT INTO TI_TIT_APB
              (COD_TITULO_AP,
               VAL_PER_DESC,
               COD_CART_BCIA,
               DAT_PROCESSAMENTO,
               COD_TIP_FLUXO_FINANC,
               CDN_FORNECEDOR,
               QTD_PARCELA,
               IND_TIPO_PESSOA,
               COD_SER_DOCTO,
               COD_PARCELA,
               VAL_DESCONTO,
               DES_TEXT_HISTOR,
               CDSITUACAO,
               COD_CCUSTO,
               COD_ID_FEDER_JURID,
               COD_ESPEC_DOCTO,
               DAT_EMISSAO,
               DAT_VENCTO,
               DAT_PREVISAO_PAGTO,
               DAT_DESCONTO,
               VAL_TITULO,
               NUM_DIAS_ATRASO,
               VAL_JUROS,
               VAL_PERC_JUROS_DIA_ATRASO,
               VAL_PERC_MULTA_ATRASO,
               COD_PORTADOR,
               COD_FORMA_PAGTO,
               COD_EMPRESA,
               COD_ESTAB,
               NRSEQ_CONTROLE_INTEGRACAO,
               COD_ID_FEDER,
               IND_OCORRENCIA,
               NRREGISTRO_TITULO,
               NRPESSOA,
               COD_PLANO_CCUSTO,
               COD_PLANO_CTA_CTBL)
              SELECT COD_TITULO_AP,
                     VAL_PER_DESC,
                     COD_CART_BCIA,
                     DAT_PROCESSAMENTO,
                     COD_TIP_FLUXO_FINANC,
                     CDFORNECEDOR_EMS5,
                     QTD_PARCELA,
                     IND_TIPO_PESSOA,
                     COD_SER_DOCTO,
                     COD_PARCELA,
                     VAL_DESCONTO,
                     DES_TEXT_HISTOR,
                     CDSITUACAO,
                     COD_CCUSTO,
                     COD_ID_FEDER COD_ID_FEDER_JURID,
                     COD_ESPEC_DOCTO,
                     DAT_EMISSAO,
                     DAT_VENCTO,
                     DAT_PREVISAO_PAGTO,
                     DAT_DESCONTO,
                     VAL_BRUTO,
                     NUM_DIAS_ATRASO,
                     VAL_JUROS,
                     VAL_PERC_JUROS_DIA_ATRASO,
                     VAL_PERC_MULTA_ATRASO,
                     COD_PORTADOR,
                     COD_FORMA_PAGTO,
                     COD_EMPRESA,
                     COD_ESTAB,
                     NRSEQ_CONTROLE_INTEGRACAO,
                     COD_ID_FEDER,
                     IND_OCORRENCIA,
                     NRREGISTRO_TITULO,
                     NRPESSOA,
                     COD_PLANO_CCUSTO,
                     COD_PLANO_CTA_CTBL
                FROM V_TI_TIT_APB TIT
               WHERE TIT.NRSEQ_CONTROLE_INTEGRACAO =
                     PNRSEQ_CONTROLE_INTEGRACAO;
          EXCEPTION
            WHEN OTHERS THEN
              RAISE_APPLICATION_ERROR(-20100, 'Erro -> ' || SQLERRM);
          END;
          IF SQL%ROWCOUNT = 0 THEN
            VAO_ACHOU_ERRO := FALSE;
            FOR L_TRATA_FALHA IN C_TRATA_FALHA LOOP
              VAO_ACHOU_ERRO := TRUE;
              IF L_TRATA_FALHA.CDFORNECEDOR_EMS5 IS NULL THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              'O Fornecedor [' ||
                              L_TRATA_FALHA.CDFORNECEDOR || '] ' ||
                              L_TRATA_FALHA.NOFORNECEDORUNICOO ||
                              ' no foi integrado para o EMS5',
                              PCDSITUACAO,
                              NULL);
              ELSIF L_TRATA_FALHA.CDEMPRESA IS NULL THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              'A empresa do unicoo no foi informada para o titulo: ' ||
                              L_TRATA_FALHA.CDIDENTIFICADOR,
                              PCDSITUACAO,
                              NULL);
              ELSIF L_TRATA_FALHA.QTENDERECO IS NULL THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              'O Fornecedor [' ||
                              L_TRATA_FALHA.CDFORNECEDOR || '] ' ||
                              L_TRATA_FALHA.NOFORNECEDORUNICOO ||
                              ' no foi integrado para o EMS5, o Fornecedor no possui endereo no Unicoo.',
                              PCDSITUACAO,
                              NULL);
              ELSIF L_TRATA_FALHA.NUM_TIP_MOVTO_TIT_APB = -1 THEN
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'Verifique o De-Para do unicoo para o ems5 para o processo [' ||
                              L_TITULOS.NRSEQUENCIAL || ']',
                              --' Tipo de movimento no cadastrado em TI_TIPO_MOVIMENTO_TIT_ACR, parametros informados: '||
                              'Empresa[' || L_TRATA_FALHA.CDEMPRESA || '] ' ||
                              'Modulo[' || L_TRATA_FALHA.CDMODULO || '] ' ||
                              'Movimento[' ||
                              RPAD(L_TRATA_FALHA.CDMOVIMENTO, 5, ' ') || '] ' ||
                              'Grupo de Fornecedor EMS [' ||
                              L_TRATA_FALHA.COD_GRP_FORNEC || '] ' ||
                              'Codigo do Fornecedor EMS [' ||
                              L_TRATA_FALHA.CDN_FORNECEDOR || '] ' ||
                              'Documento Unicoo [' ||
                              L_TITULOS.CDIDENTIFICADOR || '] ' ||
                              'Fornecedor Unicoo [' ||
                              L_TRATA_FALHA.CDFORNECEDOR || '] ' ||
                              L_TRATA_FALHA.NOFORNECEDORUNICOO,
                              PCDSITUACAO,
                              NULL);
              ELSE
                P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                              VCDINTEGRACAO,
                              'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                              L_TITULOS.NRSEQUENCIAL,
                              NULL,
                              PCDSITUACAO,
                              NULL);
              END IF;
            END LOOP;
            IF VAO_ACHOU_ERRO = FALSE THEN
              P_GRAVA_FALHA(L_TITULOS.NRSEQUENCIAL,
                            VCDINTEGRACAO,
                            'A view v_TI_TIT_APB no encontrou registro para o processo ==>' ||
                            L_TITULOS.NRSEQUENCIAL ||
                            '. Titulo ou Fornecedor no existe no Unicoo',
                            NULL,
                            PCDSITUACAO,
                            NULL);
            END IF;
          ELSE
            VALIDA_TIT_APB(PNRSEQ_CONTROLE_INTEGRACAO,
                           RFORNECEDOR.CDN_FORNECEDOR);
            VCDINTEGRACAO := 'TI_TIT_APB_CTBL';
            -------------------------------------------------------------
            --- implementação Josias em 28-05-2014 em João Pessoa
            --- Processo para pegar a distribuição do titulo no unicoo.
            -------------------------------------------------------------
            BEGIN
              INSERT INTO TI_TIT_APB_CTBL CTB
                (COD_CTA_CTBL,
                 DAT_PROCESSAMENTO,
                 COD_ESTAB,
                 COD_TIP_FLUXO_FINANC,
                 COD_UNID_FEDERAC,
                 VAL_APROP_CTBL,
                 NRSEQ_CONTROLE_INTEGRACAO,
                 COD_CCUSTO,
                 CDSITUACAO)
              -- josias 30-06-2014
              -- falta tratar o problema do centro de custo nao esta
              -- cadastrado no plano de contas informado
                (SELECT Y.COD_CTA_CTBL,
                        Y.DAT_PROCESSAMENTO,
                        Y.COD_ESTAB,
                        Y.COD_TIP_FLUXO_FINANC,
                        Y.COD_UNID_FEDERAC,
                        SUM(Y.VLDISTRIBUICAO),
                        Y.NRSEQ_CONTROLE_INTEGRACAO,
                        DECODE(Y.CDCENTRO_CUSTO,
                               NULL,
                               ' ',
                               Y.CDCENTRO_CUSTO) CDCENTRO_CUSTO,
                        Y.CDSITUACAO
                   FROM (SELECT DISTINCT X.COD_CTA_CTBL,
                                         X.DAT_PROCESSAMENTO,
                                         X.COD_ESTAB,
                                         X.COD_TIP_FLUXO_FINANC,
                                         X.COD_UNID_FEDERAC,
                                         X.VLDISTRIBUICAO,
                                         X.NRSEQ_CONTROLE_INTEGRACAO,
                                         CASE
                                           WHEN X.TIPO_CCUSTO = '$T' THEN
                                            CASE
                                              WHEN F_TI_PARAMETRO_INTEGRACAO('AOUTILIZA_CODIGO_REDUZIDO') = 'N' THEN
                                               CC.CDCONTA
                                              ELSE
                                               TO_CHAR(X.CDCENTRO_CUSTO)
                                            END
                                           ELSE
                                            ' '
                                         END CDCENTRO_CUSTO,
                                         X.CDSITUACAO
                           FROM CONTA_CONTABIL CC,
                                (SELECT DISTINCT COD_CTA_CTBL,
                                                 DAT_PROCESSAMENTO,
                                                 COD_ESTAB,
                                                 COD_TIP_FLUXO_FINANC,
                                                 COD_UNID_FEDERAC,
                                                 --sum(nvl(decode(b.tipo_distrib,'V',b.vldistribuicao,(-1 * b.vldistribuicao)),ctb.val_aprop_ctbl)) vldistribuicao,     -- Alessandro 22/10/2014
                                                 --sum(b.vldistribuicao) vldistribuicao,      -- Alessandro 22/10/2014
                                                 -- alterado vinicius 31/12/2014
                                                 CASE
                                                   WHEN B.CDHISTORICO IN
                                                        (F_TI_PARAMETRO_INTEGRACAO('HISTORICO_COM_VALOR_LIQUIDO_APB')) THEN
                                                    (SELECT SUM(VLDISTRIBUICAO)
                                                       FROM DISTRIBUICAO_TITULO_PAGAR DTP
                                                      WHERE DTP.NRREGISTRO_TITULO =
                                                            B.NRREGISTRO_TITULO
                                                        AND DTP.TIPO_DISTRIB = 'V') -
                                                    NVL((SELECT SUM(VLDISTRIBUICAO)
                                                          FROM DISTRIBUICAO_TITULO_PAGAR DTP
                                                         WHERE DTP.NRREGISTRO_TITULO =
                                                               B.NRREGISTRO_TITULO
                                                           AND DTP.TIPO_DISTRIB = 'D'),
                                                        0)
                                                   ELSE
                                                    SUM(B.VLDISTRIBUICAO)
                                                 END VLDISTRIBUICAO,
                                                 NRSEQ_CONTROLE_INTEGRACAO,
                                                 CTB.CDSITUACAO,
                                                 CASE
                                                   WHEN B.CDCENTRO_CUSTO IS NULL THEN
                                                    CTB.COD_CCUSTO
                                                   ELSE
                                                    TO_CHAR(B.CDCENTRO_CUSTO)
                                                 END CDCENTRO_CUSTO,
                                                 CTB.COD_CCUSTO,
                                                 CTB.TIPO_CCUSTO
                                   FROM V_TI_TIT_APB_CTBL         CTB,
                                        DISTRIBUICAO_TITULO_PAGAR B
                                  WHERE CTB.NRREGISTRO_TITULO =
                                        B.NRREGISTRO_TITULO(+)
                                    AND NRSEQ_CONTROLE_INTEGRACAO =
                                        PNRSEQ_CONTROLE_INTEGRACAO
                                    AND B.TIPO_DISTRIB = 'V' -- ALessandro 22/10/2014
                                 /*group by cod_cta_ctbl,
                                 dat_processamento,
                                 cod_estab,
                                 cod_tip_fluxo_financ,
                                 cod_unid_federac,
                                 nrseq_controle_integracao,
                                 b.cdcentro_custo,
                                 ctb.cod_ccusto,
                                 ctb.tipo_ccusto,
                                 ctb.cdsituacao*/
                                  GROUP BY COD_CTA_CTBL,
                                           DAT_PROCESSAMENTO,
                                           CDHISTORICO,
                                           B.NRREGISTRO_TITULO,
                                           COD_ESTAB,
                                           COD_TIP_FLUXO_FINANC,
                                           COD_UNID_FEDERAC,
                                           NRSEQ_CONTROLE_INTEGRACAO,
                                           B.CDCENTRO_CUSTO,
                                           CTB.COD_CCUSTO,
                                           CTB.TIPO_CCUSTO,
                                           CTB.CDSITUACAO) X
                          WHERE X.CDCENTRO_CUSTO = CC.NRCONTA_REDUZIDA(+)
                            AND CC.NRPLANO_CONTAS(+) =
                                F_TI_PARAMETRO_INTEGRACAO('NRPLANO_CENTRO_CUSTO_UNICOO')) Y
                  GROUP BY Y.COD_CTA_CTBL,
                           Y.DAT_PROCESSAMENTO,
                           Y.COD_ESTAB,
                           Y.COD_TIP_FLUXO_FINANC,
                           Y.COD_UNID_FEDERAC,
                           Y.NRSEQ_CONTROLE_INTEGRACAO,
                           Y.CDCENTRO_CUSTO,
                           Y.CDSITUACAO);
            EXCEPTION
              WHEN OTHERS THEN
                -- Josias 26-06-2014 - colocado essa exceção para acompanhar erro
                RAISE_APPLICATION_ERROR(-20100, ' Erro -> ' || SQLERRM);
                NULL;
            END;
            IF SQL%ROWCOUNT = 0 THEN
              P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                            VCDINTEGRACAO,
                            'A view v_TI_TIT_APB_CTBL não encontrou registro para o processo ==>' ||
                            PNRSEQ_CONTROLE_INTEGRACAO,
                            NULL,
                            PCDSITUACAO,
                            NULL);
            ELSE
              vcdintegracao := 'TI_TIT_APB_IMPOSTO';
              insert into ti_tit_apb_imposto
                 (cod_ser_docto,
                 ind_clas_impto,
                 val_impto_ja_recolhid,
                 val_outras_deduc_impto,
                 cod_titulo_ap,
                 val_rendto_tribut,
                 val_aliq_impto,
                 val_deduc_faixa_imto,
                 cod_estab,
                 cod_espec_docto,
                 cod_parcela,
                 cod_unid_federac,
                 cod_imposto,
                 cod_classif_impto,
                 val_deduc_inss,
                 val_deduc_depend,
                 val_deduc_pensao,
                 val_deduc_outras_deduc,
                 val_base_liq_impto,
                 val_imposto,
                 dat_vencto,
                 des_text_histor,
                 dat_processamento,
                 cdsituacao,
                 val_deduc_faixa_impto,
                 cod_cta_ctbl,
                 nrseq_controle_integracao,
                 cod_plano_ctb_cbtl,
                 ind_ocorrencia,
                 cod_tip_fluxo_financ)

                select cod_ser_docto,
                       ind_clas_impto,
                       val_impto_ja_recolhid,
                       val_outras_deduc_impto,
                       substr(cod_titulo_ap, 0, 10),
                       val_rendto_tribut,
                       val_aliq_impto,
                       val_deduc_faixa_imto,
                       cod_estab,
                       cod_espec_docto,
                       cod_parcela,
                       cod_unid_federac,
                       cod_imposto,
                       cod_classif_impto,
                       val_deduc_inss,
                       val_deduc_depend,
                       val_deduc_pensao,
                       val_deduc_outras_deduc,
                       val_base_liq_impto,
                       val_imposto,
                       dat_vencto,
                       des_text_histor,
                       dat_processamento,
                       cdsituacao,
                       val_deduc_faixa_impto,
                       cod_cta_ctbl,
                       nrseq_controle_integracao,
                       cod_plano_ctb_cbtl,
                       ind_ocorrencia,
                       cod_tip_fluxo_financ
                  from v_ti_tit_apb_imposto ip
                 where ip.nrseq_controle_integracao = pnrseq_controle_integracao;
            END IF;
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        SQLERRM,
                        NULL,
                        PCDSITUACAO,
                        NULL);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        SQLERRM,
                        NULL,
                        PCDSITUACAO,
                        NULL);
      END;
      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_TITULOS.NRSEQUENCIAL,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  --===============================================--
  -- TI_Cliente --> Enviar Cliente para integracao --
  ---------------------------------------------------
  PROCEDURE P_TI_CLIENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                         PNRSESSAO                  NUMBER,
                         PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_INTEGRA_CLIFOR IS
      SELECT CI.NRSEQUENCIAL        NRSEQ_CONTROLE_INTEGRACAO,
             CI.CDSITUACAO,
             CI.NRSEQUENCIAL_ORIGEM NRPESSOA
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'CL'
         AND CI.CDSITUACAO = PCDSITUACAO
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0);
  BEGIN
    FOR L_INTEGRA_CLIFOR IN C_INTEGRA_CLIFOR LOOP
      BEGIN
        PCDSITUACAO := 'RC';
        INSERT INTO TI_CLIENTE
          (COD_ORG_EMIS_ID_ESTAD,
           DAT_NASCIMENTO,
           COD_ID_FEDER_NASC,
           NOM_NACIONALIDADE,
           IND_ESTADO_CIVIL,
           COD_CX_POST,
           NOM_HOME_PAGE,
           DAT_IMPL_CLIEN,
           COD_DIGITO_CTA_CORREN,
           COD_TIP_FLUXO_FINANC,
           NUM_DIAS_ATRASO_AVDEB,
           DAT_PROCESSAMENTO,
           CDSITUACAO,
           COD_EMPRESA,
           COD_ID_FEDER_JURID,
           COD_CEP_COBR,
           DEST_ANOT_TABELA,
           COD_CART_BCIA_PREFER,
           IND_TIPO_PESSOA,
           COD_ID_FEDER_MATRIZ,
           COD_PAIS_NASC,
           NOM_MAE,
           NOM_PROFISSAO,
           NOM_CIDADE,
           COD_CEP,
           COD_TELEFONE_1,
           COD_TELEFONE_3,
           COD_FAX,
           NOM_BAIRRO_COBR,
           COD_UNID_FEDER_COBR,
           COD_GRP_CLIEN,
           COD_PORTAD_PREFER,
           COD_CTA_CORREN_BCO,
           COD_BANCO,
           LOG_CALC_MULTA,
           IND_OCORRENCIA,
           NRSEQ_CONTROLE_INTEGRACAO,
           COD_CLIENTE,
           NOM_CLIENTE,
           NOM_ABREV,
           COD_ID_FEDER_ESTAD_JURID,
           COD_ID_PREVID_SOCIAL,
           LOG_FINS_LUCRAT,
           COD_ID_ESTAD_FISIC,
           COD_ID_FEDER_EMIS_ESTAD,
           NOM_BAIRRO,
           COD_UNID_FEDER,
           COD_TELEFONE_2,
           COD_RAMAL_FAX,
           NOM_ENDER_COMPL_COBR,
           NOM_CIDADE_COBR,
           COD_CX_POST_COBR,
           COD_TIP_CLIEN,
           COD_ID_FEDER,
           NOM_ENDER_COMPL,
           COD_DIGITO_AGENC_BCIA,
           COD_ACAO,
           NOM_ENDERECO,
           NOM_ENDERECO_COBR,
           COD_AGENC_BCIA,
           COD_E_MAIL,
           COD_ID_MUNIC_JURID,
           NRSEQ_FAVORECIDO,
           NRPESSOA)
          SELECT COD_ORG_EMIS_ID_ESTAD,
                 DAT_NASCIMENTO,
                 COD_ID_FEDER_NASC,
                 NOM_NACIONALIDADE,
                 IND_ESTADO_CIVIL,
                 COD_CX_POST,
                 NOM_HOME_PAGE,
                 DAT_IMPL_CLIEN,
                 COD_DIGITO_CTA_CORREN,
                 COD_TIP_FLUXO_FINANC,
                 NUM_DIAS_ATRASO_AVDEB,
                 DAT_PROCESSAMENTO,
                 CDSITUACAO,
                 --          nm_arq_retorno,
                 COD_EMPRESA,
                 COD_ID_FEDER_JURID,
                 RPAD(NVL(TRIM(COD_CEP_COBR),
                          F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')),
                      8,
                      '0'),
                 DEST_ANOT_TABELA,
                 COD_CART_BCIA_PREFER,
                 IND_TIPO_PESSOA,
                 COD_ID_FEDER_MATRIZ,
                 COD_PAIS_NASC,
                 -- Josias 29-06-2014
                 -- estava estourando o nome da mae com mais de 40 posições
                 SUBSTR(NOM_MAE, 1, 40),
                 NOM_PROFISSAO,
                 NOM_CIDADE,
                 -- josias 29-06-2014
                 RPAD(NVL(TRIM(COD_CEP),
                          F_TI_PARAMETRO_INTEGRACAO('NRCEP_DEFAULT_INCLUSAO')),
                      8,
                      '0'),
                 COD_TELEFONE_1,
                 COD_TELEFONE_3,
                 COD_FAX,
                 NOM_BAIRRO_COBR,
                 COD_UNID_FEDER_COBR,
                 COD_GRP_CLIEN,
                 COD_PORTAD_PREFER,
                 COD_CTA_CORREN_BCO,
                 COD_BANCO,
                 LOG_CALC_MULTA,
                 IND_OCORRENCIA,
                 NRSEQ_CONTROLE_INTEGRACAO,
                 COD_CLIENTE,
                 NOM_CLIENTE,
                 NOM_ABREV,
                 COD_ID_FEDER_ESTAD_JURID,
                 COD_ID_PREVID_SOCIAL,
                 LOG_FINS_LUCRAT,
                 COD_ID_ESTAD_FISIC,
                 COD_ID_FEDER_EMIS_ESTAD,
                 NOM_BAIRRO,
                 COD_UNID_FEDER,
                 COD_TELEFONE_2,
                 COD_RAMAL_FAX,
                 NOM_ENDER_COMPL_COBR,
                 NOM_CIDADE_COBR,
                 COD_CX_POST_COBR,
                 COD_TIP_CLIEN,
                 COD_ID_FEDER,
                 NOM_ENDER_COMPL,
                 COD_DIGITO_AGENC_BCIA,
                 COD_ACAO,
                 NOM_ENDERECO,
                 NOM_ENDERECO_COBR,
                 COD_AGENC_BCIA,
                 COD_E_MAIL,
                 COD_ID_MUNIC_JURID,
                 NRSEQ_FAVORECIDO,
                 NRPESSOA
            FROM V_TI_CLIENTE
           WHERE NRSEQ_CONTROLE_INTEGRACAO =
                 L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO;

        IF SQL%ROWCOUNT = 0 THEN
          P_TI_VALIDA_ENDERECO(L_INTEGRA_CLIFOR.NRPESSOA,
                               L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                               'TI_CLIENTE',
                               PCDSITUACAO);
          IF PCDSITUACAO = 'RC' THEN
            P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                          'TI_CLIENTE',
                          'Dados no encontrados na V_ti_cliente PARA O PROCESSO',
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        END IF;

        P_COMMIT;

      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                        'TI_CLIENTE',
                        'O cliente j foi enviado para a TI_CLIENTE',
                        NULL,
                        PCDSITUACAO,
                        -1);
        WHEN OTHERS THEN
          BEGIN
            P_GRAVA_FALHA(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                          'TI_CLIENTE',
                          SQLERRM,
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END;
      END;
      --====================================--
      -- Atualizar o situao da integrao --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_INTEGRA_CLIFOR.NRSEQ_CONTROLE_INTEGRACAO,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  PROCEDURE P_GERAR_DADOS_BANC_FORNEC(VP_COD_EMPRESA IN NUMBER) IS
    /*
    ***************************************************************************************************************
    Criacão          : Josias Rodrigues
    Data             : -
    Modulo Principal : Integracão EMS5
    Modulos          : -
    Objetivo         : Gerar os dados bancários do Fornecedor Unicoo para o EMS5
    Alteracoes
    +------------------------------------------------------------------------------------------------------------------------------------------+
    | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 25/09/2014 | JOSIAS        |               |           | Criação do Objeto                                                                  |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    */
  BEGIN
    DECLARE
      CURSOR C_ATU IS
        SELECT VP_COD_EMPRESA COD_EMPRESA,
               P.CDN_FORNECEDOR,
               LPAD(T.NRBANCO, 3, '0') COD_BANCO,
               CASE
                 WHEN INSTR(T.NRAGENCIA, '-') > 0 THEN
                  SUBSTR(LPAD(F_DEFINIR_NUMERICO(SUBSTR(T.NRAGENCIA,
                                                        1,
                                                        INSTR(T.NRAGENCIA,
                                                              '-') - 1)),
                              F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'),
                              '0'),
                         1,
                         F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'))
                 ELSE
                  SUBSTR(LPAD(F_DEFINIR_NUMERICO(T.NRAGENCIA),
                              F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'),
                              '0'),
                         1,
                         F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'A'))
               END COD_AGENC_BCIA,
               CASE
                 WHEN INSTR(T.NRAGENCIA, '-') > 0 THEN
                  SUBSTR(T.NRAGENCIA, INSTR(T.NRAGENCIA, '-') + 1, 1)
                 ELSE
                  ' '
               END COD_DIGITO_AGENC_BCIA,
               CASE
                 WHEN INSTR(T.NRCONTA_BANCARIA, '-') > 0 THEN
                  SUBSTR(LPAD(F_DEFINIR_NUMERICO(SUBSTR(T.NRCONTA_BANCARIA,
                                                        1,
                                                        INSTR(T.NRCONTA_BANCARIA,
                                                              '-') - 1)),
                              F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'),
                              '0'),
                         1,
                         F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'))
                 ELSE
                 --                                        substr(t.nrconta_bancaria,1, f_ret_masc_banco(lpad(t.nrbanco,3,'0'),'C'))
                  SUBSTR(LPAD(F_DEFINIR_NUMERICO(T.NRCONTA_BANCARIA),
                              F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'),
                              '0'),
                         1,
                         F_RET_MASC_BANCO(LPAD(T.NRBANCO, 3, '0'), 'C'))
               END COD_CTA_CORREN_BCO,
               CASE
                 WHEN INSTR(T.NRCONTA_BANCARIA, '-') > 0 THEN
                  SUBSTR(T.NRCONTA_BANCARIA,
                         INSTR(T.NRCONTA_BANCARIA, '-') + 1,
                         1)
                 ELSE
                  ' '
               END COD_DIGITO_CTA_CORREN
          FROM FORNECEDOR_AGENCIA_BANCARIA         T,
               PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA F,
               TI_PESSOA                           P,
               FORNEC_FINANC                       FF
         WHERE T.CDFORNECEDOR = F.CDFORNECEDOR
           AND F.NRREGISTRO_FORNECEDOR = P.NRREGISTRO
           AND FF.U##COD_EMPRESA = VP_COD_EMPRESA
           AND P.CDN_FORNECEDOR = FF.CDN_FORNECEDOR
           AND P.CDN_FORNECEDOR IS NOT NULL
           AND T.TPCONTA = 'CC';
    BEGIN
      FOR X IN C_ATU LOOP
        UPDATE FORNEC_FINANC V
           SET V.COD_BANCO             = nvl(X.COD_BANCO, ' '),
               V.COD_AGENC_BCIA        = nvl(X.COD_AGENC_BCIA, ' '),
               V.COD_DIGITO_AGENC_BCIA = nvl(X.COD_DIGITO_AGENC_BCIA, ' '),
               V.COD_CTA_CORREN_BCO    = nvl(X.COD_CTA_CORREN_BCO, ' '),
               V.COD_DIGITO_CTA_CORREN = nvl(X.COD_DIGITO_CTA_CORREN, ' ')
         WHERE V.U##COD_EMPRESA = X.COD_EMPRESA
           AND V.CDN_FORNECEDOR = X.CDN_FORNECEDOR;
      END LOOP;
    END;
    P_COMMIT_NEW;
    --commit;
  END;

  FUNCTION F_RET_MASC_BANCO(VPCOD_BANCO IN VARCHAR2, VPTIPO IN VARCHAR2)
    RETURN NUMBER IS
    -- tipo "A" agencia , "C" conta
    VRESULT NUMBER;
  BEGIN
    -- verificar se o tipo de consulta é da agencia
    IF VPTIPO = 'A' THEN
      BEGIN
        SELECT LENGTH(B.COD_FORMAT_AGENC_BCIA)
          INTO VRESULT
          FROM BANCO B
         WHERE B.COD_BANCO = VPCOD_BANCO;
      EXCEPTION
        WHEN OTHERS THEN
          RETURN 10;
      END;
      RETURN VRESULT;
    ELSIF VPTIPO = 'C' THEN
      BEGIN
        SELECT LENGTH(B.COD_FORMAT_CTA_CORREN)
          INTO VRESULT
          FROM BANCO B
         WHERE B.COD_BANCO = VPCOD_BANCO;
      EXCEPTION
        WHEN OTHERS THEN
          RETURN 10;
      END;
    END IF;
    RETURN VRESULT;
  END;

  FUNCTION F_DEFINIR_NUMERICO(VP_CODIGO VARCHAR2) RETURN NUMBER IS
    VAUX VARCHAR2(20);
  BEGIN
    VAUX := '';
    FOR X IN 1 .. LENGTH(VP_CODIGO) LOOP
      IF SUBSTR(VP_CODIGO, X, 1) IN
         ('0', '1', '2', '3', '4', '5', '6', '7', '8', '9') THEN
        VAUX := VAUX || SUBSTR(VP_CODIGO, X, 1);
      END IF;
    END LOOP;
    RETURN TO_NUMBER(NVL(VAUX, 0));
  END;

  PROCEDURE P_VINCULA_IMPOSTO_FORNEC IS
    /*
    ***************************************************************************************************************
    Criac?o          : -
    Data             : -
    Modulo Principal : Integrac?o EMS5
    Modulos          : -
    Objetivo         : vincular os impostos do fornecedor no EMS5
    Alteracoes
    +------------------------------------------------------------------------------------------------------------------------------------------+
    | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 01/07/2014 | JOSIAS        |               |           | Atualizações necessárias   |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    */
  BEGIN
    BEGIN
        INSERT INTO IMPTO_VINCUL_FORNEC
          SELECT F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') U##COD_EMPRESA,
                 F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') COD_EMPRESA,
                 CDN_FORNECEDOR,
                 F_TI_PARAMETRO_INTEGRACAO('COD_PAIS') U##COD_PAIS,
                 F_TI_PARAMETRO_INTEGRACAO('COD_PAIS') COD_PAIS,
                 --f_ti_parametro_integracao('COD_ID_FEDER') u##cod_unid_federac,
                 --f_ti_parametro_integracao('COD_ID_FEDER') cod_unid_federac,
                 COD_UNID_FEDERAC U##COD_UNID_FEDERAC,
                 COD_UNID_FEDERAC COD_UNID_FEDERAC,
                 CDTAXA U##COD_IMPOSTO,
                 CDTAXA COD_IMPOSTO,
                 CDCLASS U##COD_CLASSIF_IMPTO,
                 CDCLASS COD_CLASSIF_IMPTO,
                 0 LOG_IMPTO_OPCNAL,
                 ' ' COD_LIVRE_1,
                 0 LOG_LIVRE_1,
                 0 NUM_LIVRE_1,
                 0 VAL_LIVRE_1,
                 TRUNC(SYSDATE) DAT_LIVRE_1,
                 0 NUMREDUZRENDTOTRIBUT,
                 ' ' COD_LIVRE_2,
                 NULL DAT_LIVRE_2,
                 0 LOG_LIVRE_2,
                 0 NUM_LIVRE_2,
                 0 VAL_LIVRE_2,
                 0 CDD_VERSION,
                 EMS5.IMPTO_VINCUL_FORNEC_SEQ.NEXTVAL PROGRESS_RECID
            FROM (SELECT DISTINCT F_TI_IMPOSTO_AGRUPADO(XX.COD_IMPOSTO,
                                                        TTP.NRREGISTRO_TITULO) CDTAXA,
                                  F_TI_IMPOSTO_AGRUPADO(XX.COD_CLASSIF_IMPTO,
                                                        TTP.NRREGISTRO_TITULO) CDCLASS,
                                  TIP.CDN_FORNECEDOR,
                                  XX.COD_UNID_FEDERAC
                    FROM TAXA_TITULO_A_PAGAR                 TTP,
                         TITULO_A_PAGAR                      TP,
                         PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA FN,
                         TI_TAXA_A_PAGAR                     XX,
                         TI_PESSOA                           TIP,
                         TI_FORNECEDOR                       TIF
                   WHERE XX.COD_TAXA = TTP.CDTAXA
                     AND TIP.NRREGISTRO = FN.NRREGISTRO_FORNECEDOR
                     AND FN.CDFORNECEDOR = TP.CDFORNECEDOR
                     AND TP.NRREGISTRO_TITULO = TTP.NRREGISTRO_TITULO
                     AND TIF.NRPESSOA = TIP.NRREGISTRO
                     AND TIP.CDN_FORNECEDOR IS NOT NULL
                     AND NOT EXISTS
                   (SELECT 1
                            FROM IMPTO_VINCUL_FORNEC IVF
                           WHERE IVF.CDN_FORNECEDOR = TIP.CDN_FORNECEDOR
                             AND IVF.COD_CLASSIF_IMPTO =
                                 F_TI_IMPOSTO_AGRUPADO(TTP.CDTAXA,
                                                       TTP.NRREGISTRO_TITULO)));
    exception
          when others then
             raise_application_error(-20100,' erro inserindo impostos '||sqlerrm);
    end;
    P_COMMIT_NEW;
    -------------------
    UPDATE FORNEC_FINANC F
       SET F.LOG_RETENC_IMPTO = 1
     WHERE EXISTS (SELECT 1
              FROM IMPTO_VINCUL_FORNEC I
             WHERE I.U##COD_EMPRESA = F.U##COD_EMPRESA
               AND I.CDN_FORNECEDOR = F.CDN_FORNECEDOR);
    --COMMIT;
  END P_VINCULA_IMPOSTO_FORNEC;

  PROCEDURE P_CONTABILIZACAO(PNRSEQ_CONTROLE_INTEGRACAO IN NUMBER,
                             PNRPERIODO                 IN NUMBER,
                             PCDLOTE_INTEGRACAO         IN VARCHAR2,
                             PTXDESCRICAO_LOTE          IN VARCHAR2,
                             PDTLOTE                    IN DATE,
                             PCDEMPRESA                 IN VARCHAR2,
                             PTPPERIODO                 IN VARCHAR2,
                             PI_NRLOTE                  IN NUMBER,
                             PI_CDFUNCIONARIO           IN VARCHAR2) IS
    /*
    ***************************************************************************************************************
    Criac?o          : -
    Data             : -
    Modulo Principal : Integrac?o EMS5
    Modulos          : -
    Telas            : CR05FC7
    Objetivo         : Enviar os titulos do Unicoo para o EMS5

    Alteracoes
    +------------------------------------------------------------------------------------------------------------------------------------------+
    | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 04/11/2009 | ALECSANDRO    |               |           | A tabela TI_LANCAMENTO_CONTABIL foi alterada para TI_ITEM_LANCAMENTO_CONTABIL   |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 06/07/2009 | ERIC ARANTES  |               |           | Criado os cursores para trazer o centro custo no lancamento contabil            |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
    | 01/07/2014 | JOSIAS        |               |           | Atualizações necessárias   |
    |------------|---------------|---------------|---------------------------------------------------------------------------------------------|

    */
    CURSOR C_LANCTO_DEB IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             LC.CDCONTA_MEMO_DEB,
             LC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_DEB CDCONTA_CONTABIL,
             'DB' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO
        FROM LANCAMENTO_CONTABIL LC
       WHERE LC.CDCONTA_DEB IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND (LC.CDLANCTO_PADRAO =
             'L' ||
             SUBSTR(TO_NUMBER(SUBSTR(PCDLOTE_INTEGRACAO, 2, 10)), 1, 5) --pcdlote_integracao
             OR PCDLOTE_INTEGRACAO IS NULL);
    CURSOR C_LANCTO_CRED IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             LC.CDCONTA_MEMO_DEB,
             LC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_CRED CDCONTA_CONTABIL,
             'CR' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO
        FROM LANCAMENTO_CONTABIL LC
       WHERE LC.CDCONTA_CRED IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND (LC.CDLANCTO_PADRAO =
             'L' ||
             SUBSTR(TO_NUMBER(SUBSTR(PCDLOTE_INTEGRACAO, 2, 10)), 1, 5) --pcdlote_integracao
             OR PCDLOTE_INTEGRACAO IS NULL);
    /*
    TODO: owner="Eric" created="08/07/2010"
    text="Não sei se as outras integrações também recebem obrigatóriamente um numero de lote, por isso fiz esse tratamento em cursor separado para não afetar o que já funciona em "
    */
    ----> cursor para o fechamento de estoque
    CURSOR C_LANCTO_DEB_2 IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             IC.CDCONTA_MEMO_DEB,
             IC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_DEB CDCONTA_CONTABIL,
             'DB' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO,
             IC.CDORIGEM
        FROM LANCAMENTO_CONTABIL LC, INTEGRACAO_CONTABIL IC
       WHERE LC.NRLANCAMENTO = IC.NRLANCAMENTO
         AND LC.NRSEQ_LANCTO = IC.NRSEQ_LANCTO
         AND LC.CDCONTA_DEB IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND IC.NRLOTE_INTEGRACAO = PI_NRLOTE
         AND (LC.CDLANCTO_PADRAO = PCDLOTE_INTEGRACAO OR
             PCDLOTE_INTEGRACAO IS NULL);
    CURSOR C_LANCTO_CRED_2 IS
      SELECT LC.CDEMPRESA,
             LC.NRPERIODO,
             LC.TPPERIODO,
             IC.CDCONTA_MEMO_DEB,
             IC.CDCONTA_MEMO_CRED,
             LC.NRLANCAMENTO,
             LC.NRSEQ_LANCTO,
             LC.DTLANCAMENTO,
             LC.VLLANCAMENTO,
             LC.CDCONTA_CRED CDCONTA_CONTABIL,
             'CR' TPLANCAMENTO,
             LC.CDLANCTO_PADRAO,
             LC.TXHISTORICO,
             LC.NRDOCUMENTO,
             IC.CDORIGEM
        FROM LANCAMENTO_CONTABIL LC, INTEGRACAO_CONTABIL IC
       WHERE LC.NRLANCAMENTO = IC.NRLANCAMENTO
         AND LC.NRSEQ_LANCTO = IC.NRSEQ_LANCTO
         AND LC.CDCONTA_CRED IS NOT NULL
         AND LC.NRPERIODO = PNRPERIODO
         AND LC.CDEMPRESA = PCDEMPRESA
         AND LC.TPPERIODO = PTPPERIODO
         AND IC.NRLOTE_INTEGRACAO = PI_NRLOTE
         AND (LC.CDLANCTO_PADRAO = PCDLOTE_INTEGRACAO OR
             PCDLOTE_INTEGRACAO IS NULL);
    VCOD_CCUSTO TI_CENTRO_CUSTO_CTBL.COD_CCUSTO%TYPE;
    VCOD_ESTAB  TI_CENTRO_CUSTO_CTBL.COD_ESTAB%TYPE;
    VA_CODESTAB VARCHAR2(2) := '01';
    VCDSITUACAO VARCHAR2(2);
  BEGIN
    INSERT INTO TI_LOTE_CTBL
      (NRSEQ_CONTROLE_INTEGRACAO,
       CDSITUACAO,
       NRPERIODO,
       COD_PLANO_CTA_CTBL,
       COD_PLANO_CCUSTO,
       DAT_LOTE_CTBL,
       DAT_PROCESSAMENTO,
       DAT_GERACAO,
       DES_LOTE_CTBL,
       AOLOTE_INTEGRACAO)
      SELECT PNRSEQ_CONTROLE_INTEGRACAO,
             'RC' CDSITUACAO,
             PNRPERIODO,
             F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CTA_CTBL') COD_PLANO_CTA_CTBL,
             F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') COD_PLANO_CCUSTO,
             PDTLOTE,
             SYSDATE DAT_PROCESSAMENTO,
             SYSDATE DAT_GERACAO,
             CASE
               WHEN PTXDESCRICAO_LOTE LIKE 'APROPRIACAO PROD.PREST%' THEN
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || 'APROP. PAGPREST' ||
                       SUBSTR(PTXDESCRICAO_LOTE, 24, 21),
                       1,
                       40)
               WHEN PTXDESCRICAO_LOTE LIKE
                    'APROPRIACAO DAS FATURAS EMITIDAS%' THEN
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || 'APROP. FAT EMITIDAS' ||
                       SUBSTR(PTXDESCRICAO_LOTE, 24, 21),
                       1,
                       40)
               WHEN PTXDESCRICAO_LOTE LIKE
                    'APROPRIACAO DAS FATURAS VENCIDAS%' THEN
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || 'APROP. FAT VENCIDAS' ||
                       SUBSTR(PTXDESCRICAO_LOTE, 24, 21),
                       1,
                       40)
               ELSE
                SUBSTR(PCDLOTE_INTEGRACAO || '-' || PTXDESCRICAO_LOTE, 1, 40)
             END DES_LOTE_CTBL,
             DECODE(PCDLOTE_INTEGRACAO, NULL, 'N', 'S')
        FROM DUAL;
    --=========
    IF PI_CDFUNCIONARIO != 'SISMV' THEN
      FOR L_LANCTO_CRED IN C_LANCTO_CRED LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
            INTO VCOD_CCUSTO, VCOD_ESTAB
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and  cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_CRED.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            VCOD_CCUSTO := ' ';
            VCOD_ESTAB  := '01';
        END;
        IF L_LANCTO_CRED.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
        END IF;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_CRED.CDCONTA_CONTABIL,
           L_LANCTO_CRED.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_CRED.TXHISTORICO, 1, 2000),
           L_LANCTO_CRED.DTLANCAMENTO,
           L_LANCTO_CRED.VLLANCAMENTO,
           VCOD_CCUSTO,
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VCOD_ESTAB --, '01' --va_codestab
          ,
           L_LANCTO_CRED.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --, '1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --, 'UNI'
          ,
           L_LANCTO_CRED.NRLANCAMENTO,
           L_LANCTO_CRED.NRSEQ_LANCTO);
      END LOOP;
      --=========
      FOR L_LANCTO_DEB IN C_LANCTO_DEB LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
            INTO VCOD_CCUSTO, VCOD_ESTAB
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_DEB.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            VCOD_CCUSTO := ' ';
            VCOD_ESTAB  := '01';
        END;
        IF L_LANCTO_DEB.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
        END IF;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_DEB.CDCONTA_CONTABIL,
           L_LANCTO_DEB.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_DEB.TXHISTORICO, 1, 2000),
           L_LANCTO_DEB.DTLANCAMENTO,
           L_LANCTO_DEB.VLLANCAMENTO,
           VCOD_CCUSTO,
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VCOD_ESTAB --, '01'--va_codestab
          ,
           L_LANCTO_DEB.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --'1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --'UNI'
          ,
           L_LANCTO_DEB.NRLANCAMENTO,
           L_LANCTO_DEB.NRSEQ_LANCTO);
      END LOOP;
      ------------------ no caso de fechamento do estoque entra nesse loop ----------------------------------
    ELSE
      FOR L_LANCTO_CRED2 IN C_LANCTO_CRED_2 LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
            INTO VCOD_CCUSTO, VCOD_ESTAB
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and  cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_CRED2.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            IF SUBSTR(L_LANCTO_CRED2.CDCONTA_CONTABIL, 1, 1) IN ('7', '4') THEN
              VCOD_CCUSTO := NVL(L_LANCTO_CRED2.CDCONTA_MEMO_CRED,
                                 L_LANCTO_CRED2.CDCONTA_MEMO_DEB);
            ELSE
              VCOD_CCUSTO := ' ';
              VCOD_ESTAB  := '01';
            END IF;
        END;
        IF L_LANCTO_CRED2.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
        END IF;
        --vcod_ccusto := null; --l_lancto_cred2.cdconta_memo_cred;
        VA_CODESTAB := L_LANCTO_CRED2.CDORIGEM;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_CRED2.CDCONTA_CONTABIL,
           L_LANCTO_CRED2.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_CRED2.TXHISTORICO, 1, 2000),
           L_LANCTO_CRED2.DTLANCAMENTO,
           L_LANCTO_CRED2.VLLANCAMENTO,
           NVL(VCOD_CCUSTO, ' '),
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VA_CODESTAB,
           L_LANCTO_CRED2.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --'1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --'UNI'
          ,
           L_LANCTO_CRED2.NRLANCAMENTO,
           L_LANCTO_CRED2.NRSEQ_LANCTO);
      END LOOP;
      FOR L_LANCTO_DEB2 IN C_LANCTO_DEB_2 LOOP
        BEGIN
          SELECT CCC.COD_CCUSTO
            INTO VCOD_CCUSTO
            FROM TI_CENTRO_CUSTO_CTBL CCC
           WHERE COD_PLANO_CCUSTO =
                 F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                --and cod_estab='01'
             AND COD_CTA_CTBL = L_LANCTO_DEB2.CDCONTA_CONTABIL;
        EXCEPTION
          WHEN OTHERS THEN
            IF SUBSTR(L_LANCTO_DEB2.CDCONTA_CONTABIL, 1, 1) IN ('7', '4') THEN
              VCOD_CCUSTO := NVL(L_LANCTO_DEB2.CDCONTA_MEMO_DEB,
                                 L_LANCTO_DEB2.CDCONTA_MEMO_CRED);
            ELSE
              VCOD_CCUSTO := ' ';
              VCOD_ESTAB  := '01';
            END IF;
        END;
        IF L_LANCTO_DEB2.DTLANCAMENTO <= '31/07/2009' THEN
          VCOD_CCUSTO := ' ';
          VCOD_ESTAB  := '01';
        END IF;
        --            vcod_ccusto := l_lancto_deb2.cdconta_memo_deb;
        VA_CODESTAB := L_LANCTO_DEB2.CDORIGEM;
        INSERT INTO TI_ITEM_LANCAMENTO_CTBL
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CTBL,
           IND_NATUR_LANCTO_CTBL,
           COD_HISTOR_PADR,
           DES_HISTOR_LANCTO_CTBL,
           DAT_LANCTO,
           VAL_LANCTO_CTBL,
           COD_CCUSTO,
           COD_PROJ_FINANC,
           IND_OCORRENCIA,
           DAT_PROCESSAMENTO,
           DAT_GERACAO,
           COD_ESTAB,
           DES_DOCTO,
           NRPERIODO,
           COD_EMPRESA,
           COD_UNID_NEGOC,
           NRLANCAMENTO,
           NRSEQ_LANCTO)
        VALUES
          (PNRSEQ_CONTROLE_INTEGRACAO,
           'RC',
           L_LANCTO_DEB2.CDCONTA_CONTABIL,
           L_LANCTO_DEB2.TPLANCAMENTO,
           ' ',
           SUBSTR(L_LANCTO_DEB2.TXHISTORICO, 1, 2000),
           L_LANCTO_DEB2.DTLANCAMENTO,
           L_LANCTO_DEB2.VLLANCAMENTO,
           NVL(VCOD_CCUSTO, ' '),
           DECODE(F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO'),
                  'NULO',
                  '',
                  F_TI_PARAMETRO_INTEGRACAO('COD_PROJETO_PADRAO')) --, ' '
          ,
           0,
           NULL,
           SYSDATE,
           VA_CODESTAB,
           L_LANCTO_DEB2.NRDOCUMENTO,
           PNRPERIODO,
           F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA') --'1'
          ,
           F_TI_PARAMETRO_INTEGRACAO('COD_UNI_NEG') --'UNI'
          ,
           L_LANCTO_DEB2.NRLANCAMENTO,
           L_LANCTO_DEB2.NRSEQ_LANCTO);
      END LOOP;
    END IF;
    --=====================================--
    -- Aplica depara da matriz de tradução --
    -----------------------------------------
    FOR L_MT IN (SELECT ILC.ROWID LINHA,
                        MT.DESTINO_COD_CCUSTO,
                        MT.DESTINO_COD_ESTAB
                   FROM TI_LOTE_CTBL_MATRIZ_TRADUCAO MT,
                        TI_ITEM_LANCAMENTO_CTBL      ILC
                  WHERE ILC.NRSEQ_CONTROLE_INTEGRACAO =
                        PNRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.COD_ESTAB = MT.COD_ESTAB
                    AND (ILC.COD_CTA_CTBL = MT.COD_CTA_CTBL OR
                        MT.COD_CTA_CTBL = '*')
                    AND (MT.COD_CCUSTO = ILC.COD_CCUSTO OR
                        MT.COD_CCUSTO = '*')
                    AND MT.COD_PLANO_CCUSTO =
                        F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO') --'PCCVR'
                    AND (MT.DES_HISTOR_LANCTO_CTBL = '*' OR
                        MT.DES_HISTOR_LANCTO_CTBL =
                        ILC.DES_HISTOR_LANCTO_CTBL)) LOOP
      UPDATE TI_ITEM_LANCAMENTO_CTBL I
         SET I.COD_ESTAB  = L_MT.DESTINO_COD_ESTAB,
             I.COD_CCUSTO = L_MT.DESTINO_COD_CCUSTO
       WHERE I.ROWID = L_MT.LINHA;
    END LOOP;
    --============================--
    -- Validação centro de custos --
    --------------------------------
    VCDSITUACAO := 'OK';
    FOR L_CCUSTO_NAO_INFORMADO IN (SELECT COD_CTA_CTBL,
                                          COD_CCUSTO,
                                          I.COD_ESTAB,
                                          I.COD_EMPRESA,
                                          I.IND_NATUR_LANCTO_CTBL
                                     FROM TI_ITEM_LANCAMENTO_CTBL I
                                    WHERE I.NRSEQ_CONTROLE_INTEGRACAO =
                                          PNRSEQ_CONTROLE_INTEGRACAO
                                      AND I.COD_CCUSTO = ' '
                                      AND EXISTS
                                    (SELECT 1
                                             FROM CRITERDISTRIBCTACTBL A,
                                                  MAPA_DISTRIB_CCUSTO  M
                                            WHERE M.CODMAPADISTRIBCCUSTO =
                                                  A.CODMAPADISTRIBCCUSTO
                                              AND A.COD_CTA_CTBL =
                                                  I.COD_CTA_CTBL
                                              AND I.DAT_LANCTO BETWEEN
                                                  A.DAT_INIC_VALID AND
                                                  A.DAT_FIM_VALID)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_LOTE_CTBL',
           'NÃO FOI INFORMADO CENTRO DE CUSTO P/ A CONTA CONTABIL ' ||
           L_CCUSTO_NAO_INFORMADO.COD_CTA_CTBL,
           'Verifique o criterio de distribuição do EMS e os esquemas contábeis do Unicoo',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    -- Período não habilitado
    FOR L_PERIODO IN (SELECT MAX(P.COD_EXERC_CTBL ||
                                 LPAD(P.NUM_PERIOD_CTBL, 2, '0')) NRPERIODO,
                             COUNT(*) QTPERIODO,
                             MAX(COD_CENAR_CTBL) NOCENARIO
                        FROM SIT_PERIOD_CTBL P, TI_LOTE_CTBL LT
                       WHERE LT.NRSEQ_CONTROLE_INTEGRACAO =
                             PNRSEQ_CONTROLE_INTEGRACAO
                         AND P.COD_EXERC_CTBL ||
                             LPAD(P.NUM_PERIOD_CTBL, 2, '0') =
                             TO_CHAR(LT.DAT_LOTE_CTBL, 'YYYYMM')
                         AND P.IND_SIT_PERIOD_CTBL <> 'Habilitado'
                         AND P.COD_MODUL_DTSUL = 'FGL'
                         AND P.COD_EMPRESA =
                             F_TI_PARAMETRO_INTEGRACAO('COD_EMPRESA')) LOOP
      BEGIN
        IF L_PERIODO.QTPERIODO > 0 THEN
          INSERT INTO TI_FALHA_DE_PROCESSO
            (NRSEQUENCIAL,
             NRSEQ_CONTROLE_INTEGRACAO,
             CDINTEGRACAO,
             TXFALHA,
             TXAJUDA,
             DTFALHA,
             NRMENSAGEM)
          VALUES
            (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
             PNRSEQ_CONTROLE_INTEGRACAO,
             'TI_LOTE_CTBL',
             'O módulo FGL não esta habilitado para o cenário' ||
             L_PERIODO.NOCENARIO || ', período ' || PNRPERIODO,
             'Utilize a manutenção de período contábil, opção ajuste de período para habilitar o período',
             SYSDATE,
             NULL);
          VCDSITUACAO := 'PE';
        ELSE
          VCDSITUACAO := 'OK';
        END IF;
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
    END LOOP;
    FOR L_CE IN (SELECT ILC.*
                   FROM TI_ITEM_LANCAMENTO_CTBL ILC, TI_LOTE_CTBL LC
                  WHERE LC.NRSEQ_CONTROLE_INTEGRACAO =
                        ILC.NRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.NRSEQ_CONTROLE_INTEGRACAO =
                        PNRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.COD_CCUSTO <> ' '
                    AND EXISTS
                  (SELECT 1
                           FROM CCUSTO P
                          WHERE P.COD_CCUSTO = ILC.COD_CCUSTO
                            AND LC.DAT_LOTE_CTBL NOT BETWEEN P.DAT_INIC_VALID AND
                                P.DAT_FIM_VALID)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_LOTE_CTBL',
           'O Lançamento contábil esta com um centro de custo fora da validade. ' ||
           L_CE.COD_CTA_CTBL || ' C/C ' || L_CE.COD_CCUSTO,
           'Verifique o cadastro do plano de centro de custos',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --- Cenário exclusivo
    FOR L_CE IN (SELECT ILC.*
                   FROM TI_ITEM_LANCAMENTO_CTBL ILC, TI_LOTE_CTBL LC
                  WHERE LC.NRSEQ_CONTROLE_INTEGRACAO =
                        ILC.NRSEQ_CONTROLE_INTEGRACAO
                    AND ILC.NRSEQ_CONTROLE_INTEGRACAO =
                        PNRSEQ_CONTROLE_INTEGRACAO
                    AND EXISTS
                  (SELECT 1
                           FROM CTA_CTBL CC
                          WHERE CC.COD_CENAR_CTBL_EXCLUS <> ' '
                            AND CC.COD_PLANO_CTA_CTBL = LC.COD_PLANO_CTA_CTBL
                            AND CC.COD_CTA_CTBL = ILC.COD_CTA_CTBL)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_LOTE_CTBL',
           'CENÁRIO EXCLUSIVO INFORMADO PARA A CONTA CONTÁBIL ' ||
           L_CE.COD_CTA_CTBL,
           'No cadastro de manutenção da conta contábil não pode ser informado o cenário',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --============================--
    -- Cta necessário cCusto      --
    -- Alessandro 18/08/2014      --
    --------------------------------
    FOR C_CTA IN (SELECT DISTINCT A.COD_CTA_CTBL, A.COD_ESTAB, A.COD_CCUSTO
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL A
                   WHERE A.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND SUBSTR(A.COD_CTA_CTBL, 1, 1) NOT IN ('1', '2')
                     AND EXISTS
                   (SELECT 1
                            FROM CRITERDISTRIBCTACTBL CD
                           WHERE CD.U##COD_CTA_CTBL = A.COD_CTA_CTBL
                             AND CD.U##COD_ESTAB = A.COD_ESTAB)
                     AND NOT EXISTS
                   (SELECT 1
                            FROM EMS506UNICOO.TI_CENTRO_CUSTO_CTBL CCC
                           WHERE CCC.COD_CTA_CTBL = A.COD_CTA_CTBL
                             AND CCC.COD_ESTAB = A.COD_ESTAB
                             AND CCC.COD_CCUSTO = A.COD_CCUSTO)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'TI_CENTRO_CUSTO_CTBL',
           'Falta DePara de Conta Para Centro Custo',
           'Consta no TOTVS11 centro de custo para Conta ' ||
           C_CTA.COD_CTA_CTBL || ' Estab. ' || C_CTA.COD_ESTAB ||
           ' na tabela TI_CENTRO_CUSTO_CTBL',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- Restrição centro de custo por estabelecimento   --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT CCC.COD_CCUSTO, CCC.COD_ESTAB
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL CCC
                   WHERE CCC.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND EXISTS
                   (SELECT 1
                            FROM RESTRIC_CCUSTO RC
                           WHERE RC.U##COD_CCUSTO = CCC.COD_CCUSTO
                             AND RC.U##COD_ESTAB = CCC.COD_ESTAB)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Restrição CCusto',
           'Há restrição de Estabelecimento para Centro de Custo',
           'Consta no TOTVS11 restrição do Estabelecimento :' ||
           C_CTA.COD_ESTAB || ' p/ CCusto ' || C_CTA.COD_CCUSTO,
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- Cta Unicoo x TOTVS11                            --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT DISTINCT A.COD_CTA_CTBL,
                                  XX.NOCONTA,
                                  EMS506UNICOO.F_TI_PARAMETRO_INTEGRACAO('NRPLANO_CONTA_UNICOO') PL_UNICOO
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL A,
                         CONTA_CONTABIL                       XX
                   WHERE A.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND XX.NRPLANO_CONTAS =
                         EMS506UNICOO.F_TI_PARAMETRO_INTEGRACAO('NRPLANO_CONTA_UNICOO')
                     AND XX.CDCONTA = A.COD_CTA_CTBL
                     AND NOT EXISTS
                   (SELECT 1
                            FROM CTA_CTBL CC
                           WHERE CC.U##COD_CTA_CTBL = A.COD_CTA_CTBL
                             AND F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CTA_CTBL') =
                                 CC.U##COD_PLANO_CTA_CTBL)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Falta Conta',
           'Há Conta Contábil no Unicoo e não cadastrada no TOTVS11',
           'Consta no Unicoo a Conta Contábil :' || C_CTA.COD_CTA_CTBL ||
           ' Desc.:  ' || C_CTA.NOCONTA || ' Plano no Unicoo.:  ' ||
           C_CTA.PL_UNICOO,
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- CCusto existe TOTVS11                           --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT CCC.COD_CCUSTO
                    FROM EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL CCC
                   WHERE CCC.NRSEQ_CONTROLE_INTEGRACAO =
                         PNRSEQ_CONTROLE_INTEGRACAO
                     AND CCC.COD_CCUSTO <> ' '
                     AND NOT EXISTS
                   (SELECT 1
                            FROM CCUSTO CC
                           WHERE CC.U##COD_PLANO_CCUSTO =
                                 EMS506UNICOO.F_TI_PARAMETRO_INTEGRACAO('COD_PLANO_CCUSTO')
                             AND CC.U##COD_CCUSTO = CCC.COD_CCUSTO)) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Falta CCusto',
           'Há Centro de Custo no Unicoo e não cadastrada no TOTVS11',
           'Consta no Unicoo o Centro de Custo: ' || C_CTA.COD_CCUSTO,
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    --=================================================--
    -- Centro Custo sem Unidade                        --
    -- Alessandro 18/08/2014                           --
    -----------------------------------------------------
    FOR C_CTA IN (SELECT COD_CCUSTO
                    FROM (SELECT A.U##COD_CCUSTO COD_CCUSTO,
                                 (SELECT B.U##COD_UNID_NEGOC
                                    FROM CCUSTO_UNID_NEGOC B
                                   WHERE B.U##COD_CCUSTO = A.U##COD_CCUSTO) CDUNID
                            FROM CCUSTO                               A,
                                 EMS506UNICOO.TI_ITEM_LANCAMENTO_CTBL CCC
                           WHERE A.U##COD_CCUSTO = CCC.COD_CCUSTO
                             AND CCC.NRSEQ_CONTROLE_INTEGRACAO =
                                 PNRSEQ_CONTROLE_INTEGRACAO) XX
                   WHERE XX.CDUNID IS NULL) LOOP
      BEGIN
        INSERT INTO TI_FALHA_DE_PROCESSO
          (NRSEQUENCIAL,
           NRSEQ_CONTROLE_INTEGRACAO,
           CDINTEGRACAO,
           TXFALHA,
           TXAJUDA,
           DTFALHA,
           NRMENSAGEM)
        VALUES
          (SQ_TI_FALHA_DE_PROCESSO.NEXTVAL,
           PNRSEQ_CONTROLE_INTEGRACAO,
           'Falta CCusto sem Unidade',
           'Centro de Custo está sem Unidade de Negocio no TOTVS11',
           'Centro de Custo: ' || C_CTA.COD_CCUSTO ||
           ' está sem Unidade de Negocio.',
           SYSDATE,
           NULL);
      EXCEPTION
        WHEN OTHERS THEN
          RAISE_APPLICATION_ERROR(-20001,
                                  PNRSEQ_CONTROLE_INTEGRACAO ||
                                  'TI_LOTE_CTBL ' || SQLERRM);
      END;
      VCDSITUACAO := 'PE';
    END LOOP;
    IF VCDSITUACAO <> 'OK' THEN
      UPDATE TI_LOTE_CTBL LC
         SET LC.CDSITUACAO = 'PE'
       WHERE LC.NRSEQ_CONTROLE_INTEGRACAO = PNRSEQ_CONTROLE_INTEGRACAO;
    END IF;
    /*select
        cod_cta_ctbl,
        cod_ccusto,
        i.cod_estab,
        i.cod_empresa,
        i.ind_natur_lancto_ctbl
    from
         ti_item_lancamento_ctbl i where i.nrseq_controle_integracao = 7192465
         and
         I.COD_CCUSTO <>' '
         AND
         not exists (
                select 1
                from
                    criterdistribctactbl a,
                    mapa_distrib_ccusto m,
                    item_lista_ccusto ic
                where
                     ic.cod_ccusto=i.cod_ccusto
                     and
                     ic.codmapadistribccusto=m.codmapadistribccusto
                     and
                     m.codmapadistribccusto=a.codmapadistribccusto
                     and
                     a.cod_cta_ctbl=i.cod_cta_ctbl
                     and
                     i.dat_lancto between a.dat_inic_valid and a.dat_fim_valid)
    */
  END;

  PROCEDURE P_TI_MOVIMENTO_CTA_CORRENTE(PNRSEQ_CONTROLE_INTEGRACAO NUMBER,
                                        PNRSESSAO                  NUMBER,
                                        PCDSITUACAO                IN OUT VARCHAR2) IS
    CURSOR C_INTEGRA_CMG IS
      SELECT CI.NRSEQUENCIAL NRSEQ_CONTROLE_INTEGRACAO,
             CI.CDSITUACAO,
             CI.CDIDENTIFICADOR,
             CI.NRSEQUENCIAL_ORIGEM
        FROM TI_CONTROLE_INTEGRACAO CI
       WHERE CI.NRSESSAO = PNRSESSAO
         AND CI.TPINTEGRACAO = 'CX'
         AND CI.CDSITUACAO = PCDSITUACAO
         AND (CI.NRSEQUENCIAL = PNRSEQ_CONTROLE_INTEGRACAO OR
             PNRSEQ_CONTROLE_INTEGRACAO = 0);
    VCDINTEGRACAO VARCHAR2(100);
  BEGIN
    FOR L_INTEGRA_CMG IN C_INTEGRA_CMG LOOP
      BEGIN
        PCDSITUACAO   := 'RC';
        VCDINTEGRACAO := 'TI_MOV_CTA_CORREN';
        INSERT INTO TI_MOVIMENTO_CTA_CORRENTE
          (NRSEQ_CONTROLE_INTEGRACAO,
           CDSITUACAO,
           COD_CTA_CORREN,
           DAT_MOVTO_CTA_CORREN,
           IND_TIP_MOVTO_CTA_CORREN,
           COD_TIP_TRANS_CX,
           IND_FLUXO_MOVTO_CTA_CORREN,
           COD_CENAR_CTBL,
           COD_HISTOR_PADR,
           VAL_MOVTO_CTA_CORREN,
           COD_DOCTO_MOVTO_CTA_BCO,
           COD_MODUL_DTSUL,
           IND_ERRO_VALID,
           DES_HISTOR_PADR,
           NUM_ID_MOVTO_CTA_CORREN)
          SELECT MCT.NRSEQ_CONTROLE_INTEGRACAO,
                 MCT.CDSITUACAO,
                 MCT.COD_CTA_CORREN,
                 MCT.DAT_MOVTO_CTA_CORREN,
                 MCT.IND_TIP_MOVTO_CTA_CORREN,
                 MCT.COD_TIP_TRANS_CX,
                 MCT.IND_FLUXO_MOVTO_CTA_CORREN,
                 MCT.COD_CENAR_CTBL,
                 MCT.COD_HISTOR_PADR,
                 MCT.VAL_MVTO_CTA_CORREN,
                 MCT.COD_DOCTO_MOVTO_CTA_BCO,
                 MCT.COD_MODUL_DTSUL,
                 MCT.IND_ERRO_VALID,
                 MCT.DES_HISTOR_PADR,
                 MCT.NUM_ID_MOVTO_CTA_CORREN
            FROM V_TI_MOVIMENTO_CTA_CORRENTE MCT
           WHERE NRSEQ_CONTROLE_INTEGRACAO =
                 L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO;
        IF SQL%ROWCOUNT = 0 THEN
          IF PCDSITUACAO = 'RC' THEN
            P_GRAVA_FALHA(L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO,
                          VCDINTEGRACAO,
                          'A VIEW V_TI_MOVIMENTO_CTA_CORRENTE N?O ENCONTROU MOVIMENTO CAIXA PARA O PROCESSO ==> ' ||
                          L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO ||
                          'NRMOVIMENTO ==> ' ||
                          L_INTEGRA_CMG.NRSEQUENCIAL_ORIGEM,
                          NULL,
                          PCDSITUACAO,
                          NULL);
          END IF;
        END IF;
      EXCEPTION
        WHEN DUP_VAL_ON_INDEX THEN
          P_GRAVA_FALHA(L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        'O MOVIMENTO JA FOI ENVIADO PARA A TI_MOVIMENTO_CTA_CORRENTE ',
                        NULL,
                        PCDSITUACAO,
                        -1);
        WHEN OTHERS THEN
          P_GRAVA_FALHA(PNRSEQ_CONTROLE_INTEGRACAO,
                        VCDINTEGRACAO,
                        'ERRO AO INCLUIR MOVIMENTO CAIXA NA TABELA TI_MOVIMENTO_CTA_CORRENTE ==> ' ||
                        SQLERRM || ' PROCESSO ==> ' ||
                        L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO ||
                        'NRMOVIMENTO ==> ' ||
                        L_INTEGRA_CMG.NRSEQUENCIAL_ORIGEM,
                        NULL,
                        PCDSITUACAO,
                        NULL);
      END;
      --====================================--
      -- Atualizar o situac?o da integrac?o --
      ----------------------------------------
      P_UPDATE_CONTROLE_INTEGRACAO(L_INTEGRA_CMG.NRSEQ_CONTROLE_INTEGRACAO,
                                   PCDSITUACAO,
                                   NULL);
    END LOOP;
  END;

  PROCEDURE P_INSERE_FORNECEDOR(PNRREGISTRO_TITULO IN NUMBER) IS
    CURSOR C_PES IS
      SELECT 'FN' PTPINTEGRACAO,
             'I' PCDACAO,
             P.NRCGC_CPF PNRCGC_CPF,
             P.NOPESSOA PNOPESSOA,
             P.DTNASCIMENTO PDTNASCIMENTO,
             P.TPPESSOA PTPPESSOA,
             P.NRREGISTRO PNRREGISTRO,
             'FORNECEDOR' PTPORIGEM,
             F.CDFORNECEDOR PCDIDENTIFICADOR,
             F.NRREGISTRO_FORNECEDOR PNRSEQUENCIAL_ORIGEM,
             '' PCDMODULO,
             TP.CDEMPRESA PCDEMPRESA,
             '' PNRSEQ_CONTROLE_INTEGRACAO_ORG,
             '' PNOABREVIADO_FORNECEDOR,
             '' PCDN_FORNECEDOR,
             '' PNOABREVIADO_CLIENTE,
             '' PCDN_CLIENTE,
             'S' PAODEFINEPESSOA
        FROM PRODUCAO.FORNECEDOR@UNICOO_HOMOLOGA F,
             PESSOA                              P,
             TITULO_A_PAGAR                      TP
       WHERE TP.CDFORNECEDOR = F.CDFORNECEDOR
         AND F.NRREGISTRO_FORNECEDOR = P.NRREGISTRO
         AND TP.NRREGISTRO_TITULO = PNRREGISTRO_TITULO;
  BEGIN
    FOR X IN C_PES LOOP
      PCK_EMS506UNICOO.P_DEFINE_TI_PESSOA(X.PNRCGC_CPF,
                                          X.PNOPESSOA,
                                          X.PDTNASCIMENTO,
                                          X.PTPPESSOA,
                                          X.PNRREGISTRO,
                                          X.PTPORIGEM,
                                          X.PNOABREVIADO_FORNECEDOR,
                                          X.PCDN_FORNECEDOR,
                                          X.PNOABREVIADO_CLIENTE,
                                          X.PCDN_CLIENTE,
                                          X.PAODEFINEPESSOA);
      EMS506UNICOO.PCK_EMS506UNICOO.P_INS_TI_CONTROLE_INTEGRACAO(X.PTPINTEGRACAO,
                                                                 X.PCDACAO,
                                                                 X.PCDIDENTIFICADOR,
                                                                 X.PNRSEQUENCIAL_ORIGEM,
                                                                 X.PCDMODULO,
                                                                 X.PCDEMPRESA,
                                                                 X.PNRSEQ_CONTROLE_INTEGRACAO_ORG);
    END LOOP;
  END;

  PROCEDURE P_INSERE_CLIENTE(PNRREGISTRO_TITULO IN NUMBER) IS
    CURSOR C_CLI IS
      SELECT 'CL' PTPINTEGRACAO,
             'I' PCDACAO,
             P.NRCGC_CPF VNRCGC_CPF,
             P.NOPESSOA VNOPESSOA,
             P.DTNASCIMENTO VDTNASCIMENTO,
             P.TPPESSOA VTPPESSOA,
             C.NRREGISTRO_CLIENTE PNRSEQUENCIAL_ORIGEM,
             C.CDCLIENTE PCDIDENTIFICADOR,
             'CLIENTE',
             '' VNOM_ABREV_FORNECEDOR,
             '' VCDN_FORNECEDOR,
             '' VNOM_ABREV_CLIENTE,
             '' VCDN_CLIENTE,
             TR.CDEMPRESA PCDEMPRESA,
             '' PNRSEQ_CONTROLE_INTEGRACAO_ORG,
             '' PCDMODULO
        FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA C,
             PESSOA                           P,
             TITULO_A_RECEBER                 TR
       WHERE C.NRREGISTRO_CLIENTE = P.NRREGISTRO
         AND TR.CDCLIENTE = C.CDCLIENTE
         AND TR.NRREGISTRO_TITULO = PNRREGISTRO_TITULO;
  BEGIN
    FOR X IN C_CLI LOOP
      P_DEFINE_TI_PESSOA(X.VNRCGC_CPF,
                         X.VNOPESSOA,
                         X.VDTNASCIMENTO,
                         X.VTPPESSOA,
                         X.PNRSEQUENCIAL_ORIGEM,
                         'CLIENTE',
                         X.VNOM_ABREV_FORNECEDOR,
                         X.VCDN_FORNECEDOR,
                         X.VNOM_ABREV_CLIENTE,
                         X.VCDN_CLIENTE,
                         'S');
      EMS506UNICOO.PCK_EMS506UNICOO.P_INS_TI_CONTROLE_INTEGRACAO(X.PTPINTEGRACAO,
                                                                 X.PCDACAO,
                                                                 X.PCDIDENTIFICADOR,
                                                                 X.PNRSEQUENCIAL_ORIGEM,
                                                                 X.PCDMODULO,
                                                                 X.PCDEMPRESA,
                                                                 X.PNRSEQ_CONTROLE_INTEGRACAO_ORG);
    END LOOP;
  END;

  procedure P_CARGA_PESSOA_UNIMED IS
    --------------------------------------
    -- gerar carga de pessoa do unimeds
    --------------------------------------
    cursor c_pes is
      select distinct 'FN' ptpintegracao,
                      'I' pcdacao,
                      nvl(p.nrcgc_cpf, '00000000000000') pnrcgc_cpf,
                      p.nopessoa pnopessoa,
                      p.dtnascimento pdtnascimento,
                      p.tppessoa ptppessoa,
                      p.nrregistro pnrregistro,
                      'UNIMED' ptporigem,
                      f.cdfornecedor pcdidentificador,
                      p.nrregistro pnrsequencial_origem,
                      '' pcdmodulo,
                      '' pcdempresa,
                      '' pnrseq_controle_integracao_org,
                      '' pnoabreviado_fornecedor,
                      '' pcdn_fornecedor,
                      '' pnoabreviado_cliente,
                      '' pcdn_cliente,
                      'S' paodefinepessoa
        from producao.fornecedor@unicoo_homologa f,
             pessoa                              p,
             area_de_acao                        aa
       where f.nrregistro_fornecedor   = p.nrregistro
            --and f.nrregistro_fornecedor not in (1976,1075,1628)
         --and f.cdsituacao_fornecedor = 'A'
         --and aa.nrregistro_pessoa   = f.nrregistro_fornecedor
         and aa.cdprestador         = f.cdfornecedor
         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = f.cdfornecedor
                 and ci.tpintegracao = 'FN');
    vcommit number;
  begin
    vcommit := 1;

    for x in c_pes loop
      begin
        pck_ems506unicoo.p_define_ti_pessoa(x.pnrcgc_cpf,
                                            x.pnopessoa,
                                            x.pdtnascimento,
                                            x.ptppessoa,
                                            x.pnrregistro,
                                            x.ptporigem,
                                            x.pnoabreviado_fornecedor,
                                            x.pcdn_fornecedor,
                                            x.pnoabreviado_cliente,
                                            x.pcdn_cliente,
                                            x.paodefinepessoa);

      exception
        when others then
          raise_application_error(-20100,
                                  ' Pessoa :' || x.pnrsequencial_origem || ' ' ||
                                  sqlerrm);
          null;
      end;

      ems506unicoo.pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                                 x.pcdacao,
                                                                 x.pcdidentificador,
                                                                 x.pnrsequencial_origem,
                                                                 x.pcdmodulo,
                                                                 x.pcdempresa,
                                                                 x.pnrseq_controle_integracao_org);

      if vcommit >= 500 then
        --Commit;
        vcommit := 1;
      else
        vcommit := vcommit + 1;
      end if;
    end loop;
    --commit;

    P_JOB;

    --COMMIT;

--    P_COD_UNIMED_FORNECEDOR;

    --COMMIT;

  end P_CARGA_PESSOA_UNIMED;

  procedure P_COD_UNIMED_FORNECEDOR is
    cursor c_for is
      select distinct
             f.nrpessoa,
             a.cdareaacao
        from ti_fornecedor                       f,
             area_de_acao                        a,
             producao.fornecedor@unicoo_homologa xx
       where f.nrpessoa = xx.nrregistro_fornecedor
         and xx.cdfornecedor = a.cdprestador
         and f.cdsituacao = 'RC';

  begin
    for x in c_for loop

      update ti_pessoa p
         set p.cdn_fornecedor = x.cdareaacao, P.CDN_CLIENTE = X.cdareaacao
       where p.nrregistro = x.nrpessoa;

      update ti_fornecedor f
         set f.cod_fornecedor = x.cdareaacao
       where f.nrpessoa = x.nrpessoa;

    end loop;
    --commit;
  end P_COD_UNIMED_FORNECEDOR;

  PROCEDURE P_CARGA_INICIAL_FORNECEDOR IS
    --------------------------------------
    -- gerar carga de pessoa do fornecedor
    --------------------------------------

    cursor c_pes is
      select distinct 'FN' ptpintegracao,
                      'I' pcdacao,
                      nvl(trim(replace(replace(replace(p.nrcgc_cpf,
                                                       '-',
                                                       null),
                                               ',',
                                               null),
                                       '.',
                                       null)),
                          '00000000000000') pnrcgc_cpf,
                      nvl(p.noabreviado, p.nopessoa) pnopessoa,
                      p.dtnascimento pdtnascimento,
                      p.tppessoa ptppessoa,
                      p.nrregistro pnrregistro,
                      'FORNECEDOR' ptporigem,
                      f.cdfornecedor pcdidentificador,
                      f.nrregistro_fornecedor pnrsequencial_origem,
                      '' pcdmodulo,
                      '' pcdempresa,
                      '' pnrseq_controle_integracao_org,
                      '' pnoabreviado_fornecedor,
                      '' pcdn_fornecedor,
                      '' pnoabreviado_cliente,
                      '' pcdn_cliente,
                      'S' paodefinepessoa
        from producao.fornecedor@unicoo_homologa f,
             pessoa                              p,
             ti_matriz_pagar                     tm
       where f.nrregistro_fornecedor = p.nrregistro
         and p.nrregistro            = tm.nrregistro
         and not exists (select 1
                           from ti_controle_integracao ci
                          where ci.cdidentificador = f.cdfornecedor
                            and ci.tpintegracao = 'FN')
      union all
      select distinct 'FN' ptpintegracao,
                      'I' pcdacao,
                      nvl(trim(replace(replace(replace(p.nrcgc_cpf,
                                                       '-',
                                                       null),
                                               ',',
                                               null),
                                       '.',
                                       null)),
                          '00000000000000') pnrcgc_cpf,
                      nvl(p.noabreviado, p.nopessoa) pnopessoa,
                      p.dtnascimento pdtnascimento,
                      p.tppessoa ptppessoa,
                      p.nrregistro pnrregistro,
                      'FORNECEDOR' ptporigem,
                      f.cdfornecedor pcdidentificador,
                      f.nrregistro_fornecedor pnrsequencial_origem,
                      '' pcdmodulo,
                      '' pcdempresa,
                      '' pnrseq_controle_integracao_org,
                      '' pnoabreviado_fornecedor,
                      '' pcdn_fornecedor,
                      '' pnoabreviado_cliente,
                      '' pcdn_cliente,
                      'S' paodefinepessoa
        from producao.fornecedor@unicoo_homologa f,
             pessoa                              p,
             ti_grupo_de_fornecedor              tif
       where f.nrregistro_fornecedor = p.nrregistro
         and tif.cdgrupo_fornecedor = f.cdgrupo_fornecedor
         and tif.cod_grp_fornecedor <> 'NAOM'
         and not exists (select 1 from ti_matriz_pagar tm where tm.nrregistro = f.nrregistro_fornecedor)
         and not exists (select 1
                           from ti_controle_integracao ci
                          where ci.cdidentificador = f.cdfornecedor
                            and ci.tpintegracao = 'FN')
        order by pnrregistro  desc ;

    vcommit number;
  begin
    vcommit := 1;

    for x in c_pes loop
      begin
        pck_ems506unicoo.p_define_ti_pessoa(x.pnrcgc_cpf,
                                            x.pnopessoa,
                                            x.pdtnascimento,
                                            x.ptppessoa,
                                            x.pnrregistro,
                                            x.ptporigem,
                                            x.pnoabreviado_fornecedor,
                                            x.pcdn_fornecedor,
                                            x.pnoabreviado_cliente,
                                            x.pcdn_cliente,
                                            x.paodefinepessoa);

      exception
        when others then
          --raise_application_error(-20100,' Pessoa :'||x.pnrsequencial_origem||' '||sqlerrm);
          null;
      end;

      ems506unicoo.pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                                 x.pcdacao,
                                                                 x.pcdidentificador,
                                                                 x.pnrsequencial_origem,
                                                                 x.pcdmodulo,
                                                                 x.pcdempresa,
                                                                 x.pnrseq_controle_integracao_org);

      if vcommit >= 500 then
        --Commit;
        vcommit := 1;
      else
        vcommit := vcommit + 1;
      end if;
    end loop;
    --commit;

    p_job;

    --COMMIT;

  end P_CARGA_INICIAL_FORNECEDOR;

  PROCEDURE P_CARGA_INICIAL_CLIENTE IS
    ----------------------------------
    -- Gerar pessoa cliente integração
    ----------------------------------

    cursor c_cli is
      select nvl(trim(replace(replace(replace(p.nrcgc_cpf, '-', null),
                                      ',',
                                      null),
                              '.',
                              null)),
                 '00000000000000') nrcgc_cpf,
            nvl(p.noabreviado, p.nopessoa)   nopessoa,
             p.dtnascimento,
             p.tppessoa,
             c.nrregistro_cliente,
             'CLIENTE' tipo,
             '' vnom_abrev_fornecedor,
             '' vcdn_fornecedor,
             '' vnom_abrev_cliente,
             '' vcdn_cliente,
             'S' incluir,
             c.cdcliente
        from producao.cliente@unicoo_homologa c,
             pessoa                           p,
             ti_grupo_de_cliente              t
       where p.nrregistro = c.nrregistro_cliente
         and t.cdgrupo_cliente = c.cdgrupo_cliente
         and t.cdgrupo_cliente_ems_pj <> 'NAOM'
         and not exists (select 1 from ti_matriz_receber tm
                                 where tm.nrregistro = p.nrregistro)
         and not exists (select 1
                from ti_controle_integracao ci
               where ci.cdidentificador = c.cdcliente
                 and ci.tpintegracao = 'CL')
    union all
     select nvl(trim(replace(replace(replace(p.nrcgc_cpf, '-', null),
                                      ',',
                                      null),
                              '.',
                              null)),
                 '00000000000000') nrcgc_cpf,
            nvl(p.noabreviado, p.nopessoa)   nopessoa,
             p.dtnascimento,
             p.tppessoa,
             c.nrregistro_cliente,
             'CLIENTE' tipo,
             '' vnom_abrev_fornecedor,
             '' vcdn_fornecedor,
             '' vnom_abrev_cliente,
             '' vcdn_cliente,
             'S' incluir,
             c.cdcliente
        from producao.cliente@unicoo_homologa c,
             pessoa                           p,
             ti_matriz_receber                tm
       where p.nrregistro = c.nrregistro_cliente
         and p.nrregistro = tm.nrregistro
         and not exists (select 1
                           from ti_controle_integracao ci
                          where ci.cdidentificador = c.cdcliente
                            and ci.tpintegracao = 'CL');

       cursor c_carga_clientes is
               SELECT NRPESSOA_PAGA, TPPESSOA
  FROM (SELECT P.NRREGISTRO NRPESSOA_PAGA
          FROM CONTRATO_DA_PESSOA P
         WHERE NOT EXISTS (SELECT 1
                  FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA C
                 WHERE C.NRREGISTRO_CLIENTE = P.NRREGISTRO)
        UNION
        SELECT NVL(F.NRPESSOA_PAGA, F.NRPESSOA_TITULAR) NRREGISTRO
          FROM FAMILIA F
         WHERE F.DTINICIO_CONTRATO IS NOT NULL
           AND NOT EXISTS
         (SELECT 1
                  FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA C
                 WHERE C.NRREGISTRO_CLIENTE =
                       NVL(F.NRPESSOA_PAGA, F.NRPESSOA_TITULAR))
        UNION
        SELECT P2.NRPESSOA_PAGA
          FROM CONTRATO_DA_PESSOA P2
         WHERE P2.NRPESSOA_PAGA <> P2.NRREGISTRO
           AND NOT EXISTS
         (SELECT 1
                  FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA C2
                 WHERE C2.NRREGISTRO_CLIENTE = P2.NRPESSOA_PAGA)
        UNION
        SELECT NVL(F.NRPESSOA_PAGA, F.NRPESSOA_TITULAR) NRREGISTRO
          FROM CONTRATO_DA_PESSOA P2, FAMILIA F, USUARIO U
         WHERE P2.NRREGISTRO = U.NRREGISTRO
           AND P2.NRCONTRATO = U.NRCONTRATO
           AND F.NRREGISTRO = U.NRREGISTRO
           AND F.NRCONTRATO = U.NRCONTRATO
           AND F.NRFAMILIA = U.NRFAMILIA
           AND U.NRFAMILIA <> 0
           AND U.TPUSUARIO = 00
           AND P2.TPFATURA = 'U'
           AND NOT EXISTS
         (SELECT 1
                  FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA C
                 WHERE C.NRREGISTRO_CLIENTE =
                       NVL(F.NRPESSOA_PAGA, F.NRPESSOA_TITULAR))
        UNION
        SELECT NRREGISTRO_USUARIO NRPESSOA_PAGA
          FROM USUARIO US
         WHERE NRFAMILIA <> 0
           AND TPUSUARIO = 00
           AND UNICOOGPS.F_TM_PARAMETRO('CONTRATO_PEA') LIKE
               '%' || US.NRCONTRATO || '%'
           AND NOT EXISTS
         (SELECT 1
                  FROM PRODUCAO.CLIENTE@UNICOO_HOMOLOGA CL
                 WHERE CL.NRREGISTRO_CLIENTE = US.NRREGISTRO_USUARIO)
        UNION
        SELECT A.NRPESSOA_PAGA
          FROM (SELECT L.NRPESSOA_PAGA,
                       L.NRCONTRATO,
                       P.NOPESSOA,
                       L.CDLOTACAO,
                       L.TXDESCRICAO,
                       NVL(CL.CDCLIENTE,
                           'NAO EXISTE CLIENTE COM ESTE NRPESSOA') CDCLIENTE
                  FROM PESSOA                           P,
                       LOTACAO                          L,
                       PRODUCAO.CLIENTE@UNICOO_HOMOLOGA CL,
                       CONTRATO_DA_PESSOA               CDP
                 WHERE P.NRREGISTRO = L.NRPESSOA_PAGA
                   AND CL.NRREGISTRO_CLIENTE(+) = L.NRPESSOA_PAGA
                   AND CDP.NRREGISTRO = L.NRREGISTRO
                   AND CDP.NRCONTRATO = L.NRCONTRATO
                   AND CDP.TPFATURA = 'L') A
         WHERE CDCLIENTE = 'NAO EXISTE CLIENTE COM ESTE NRPESSOA') B,
       PESSOA P
 WHERE B.NRPESSOA_PAGA = P.NRREGISTRO;
    vcommit number;

  begin

    vcommit := 1;

    FOR Y IN c_carga_clientes LOOP

      BEGIN
        PRODUCAO.p_gera_cliente@UNICOO_HOMOLOGA('M' || Y.NRPESSOA_PAGA,
                                                Y.NRPESSOA_PAGA,
                                                'M' || Y.NRPESSOA_PAGA,
                                                NULL,
                                                CASE WHEN Y.TPPESSOA = 'F' THEN 'P' ELSE 'E' END,
                                                NULL,
                                                'N');
      END;

    END LOOP;

    for x in c_cli loop
      begin
        ems506unicoo.pck_ems506unicoo.p_define_ti_pessoa(x.nrcgc_cpf,
                                                         x.nopessoa,
                                                         x.dtnascimento,
                                                         x.tppessoa,
                                                         x.nrregistro_cliente,
                                                         x.tipo,
                                                         x.vnom_abrev_fornecedor,
                                                         x.vcdn_fornecedor,
                                                         x.vnom_abrev_cliente,
                                                         x.vcdn_cliente,
                                                         x.incluir);

      exception
        when others then
          raise_application_error(-20100,
                                  ' Pessoa : ' || x.nrregistro_cliente ||
                                  ' - ' || sqlerrm);
          null;
      end;

      ems506unicoo.PCK_EMS506UNICOO.P_INS_TI_CONTROLE_INTEGRACAO('CL',
                                                                 'I',
                                                                 x.cdcliente,
                                                                 x.NRREGISTRO_cliente,
                                                                 null,
                                                                 NULL,
                                                                 NULL);

      if vcommit >= 500 then
        --Commit;
        vcommit := 1;
      else
        vcommit := vcommit + 1;
      end if;
    end loop;
    --commit;

    P_JOB;

    --COMMIT;

  end P_CARGA_INICIAL_CLIENTE;

  procedure p_carga_tit_acr IS
    cursor c_tit is
      select 'TR' ptpintegracao,
             'I' pcdacao,
             t.nrdocumento pcdidentificador,
             t.nrregistro_titulo pnrsequencial_origem,
             '' pcdmodulo,
             t.cdempresa cdempresa,
             '' pnrseq_controle_integracao_org
        from producao.cliente@unicoo_homologa c,
             titulo_a_receber                 t,
             pessoa                           p
       where c.cdcliente = t.cdcliente
         and p.nrregistro = c.nrregistro_cliente
         and t.nrregistro_titulo in (select b.nrregistro_titulo
                                       from ti_matriz_receber b)
         and not exists (select 1
                           from ti_controle_integracao x
                          where x.tpintegracao = 'TR'
                            and x.nrsequencial_origem = t.nrregistro_titulo) ;

    vConta number;
  begin
    vConta := 0;
    for x in c_tit loop
      pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                    x.pcdacao,
                                                    x.pcdidentificador,
                                                    x.pnrsequencial_origem,
                                                    x.pcdmodulo,
                                                    x.cdempresa,
                                                    x.pnrseq_controle_integracao_org);
      if vConta > 500 then
        --commit;
        vConta := 0;
      end if;

      vConta := vConta + 1;

    end loop;
    --commit;

    p_job;

    --COMMIT;

  END p_carga_tit_acr;

  PROCEDURE p_carga_tit_apb IS
    --===================================================================================================
    ----------------------------------------
    -- gerar carga do titulos a pagar
    ----------------------------------------
    cursor c_tit is
      select 'TP' ptpintegracao,
             'I' pcdacao,
             t.nrdocumento pcdidentificador,
             t.nrregistro_titulo pnrsequencial_origem,
             '' pcdmodulo,
             t.cdempresa cdempresa,
             '' pnrseq_controle_integracao_org
        from producao.fornecedor@unicoo_homologa f,
             titulo_a_pagar                      t,
             pessoa                              p
       where t.cdfornecedor = f.cdfornecedor
         and f.nrregistro_fornecedor = p.nrregistro
         and t.nrregistro_titulo in (select b.nrregistro_titulo
                                      from ti_matriz_pagar b)
         and not exists (select 1
                           from ti_controle_integracao u
                          where u.tpintegracao = 'TP'
                            and u.nrsequencial_origem = t.nrregistro_titulo) ;
  begin

    for x in c_tit loop
      pck_ems506unicoo.p_ins_ti_controle_integracao(x.ptpintegracao,
                                                    x.pcdacao,
                                                    x.pcdidentificador,
                                                    x.pnrsequencial_origem,
                                                    x.pcdmodulo,
                                                    x.cdempresa,
                                                    x.pnrseq_controle_integracao_org);
      --commit;
    end loop;

    p_job;

    --commit;

  end p_carga_tit_apb;

  procedure p_carga_tit_acr_fechado(pdttitulo date) is

    cursor ctitulos is
      select nrregistro_TITULO
        from titulo_a_receber t
        where (t.dttitulo >= pdttitulo or pdttitulo is null)
       and not exists (select 1
                from ti_controle_integracao tc
               where tc.nrsequencial_origem = t.nrregistro_titulo
                 and tc.tpintegracao = 'TR');

  begin
    for ct in ctitulos loop

      begin
        --TITULO
        insert into temp_tit_fechado
        values
          ('"' || 'TIT' || '"', SEQ_TITULO_FECHADO.NEXTVAL);

        insert into temp_tit_fechado
          select registro, SEQ_TITULO_FECHADO.NEXTVAL
            from v_titulo_fechado_acr_inf v
           where v.NRREGISTRO_TITULO = ct.nrregistro_titulo;

        --MOVIMENTOS
        insert into temp_tit_fechado
        values
          ('"' || 'MOVTO' || '"', SEQ_TITULO_FECHADO.NEXTVAL);

        insert into temp_tit_fechado
          select t.MOVIMENTO, SEQ_TITULO_FECHADO.NEXTVAL
            from v_titulo_fechado_acr_mov t

           where t.nrregistro_titulo = ct.nrregistro_titulo;

      exception
        when others then
          null;

      end;
      p_commit;

    end loop;
  end p_carga_tit_acr_fechado;


procedure p_atualiza_status_cliente(p_qtsessoes number) IS

  vqtregistros number;
  w            number := 0;

begin



  loop

   w := 0;

    select count(*) / p_qtsessoes
      into vqtregistros
      from ti_cliente
     where cdsituacao = 'RC';

    while w <= p_qtsessoes loop

      update ti_cliente t
         set cdsituacao = 'R' || w
       where cdsituacao = 'RC'
         and rownum <= vqtregistros;


    --commit;
      w := w + 1;

    end loop;

  end loop;
end p_atualiza_status_cliente;

procedure p_atualiza_status_fornecedor (p_qtsessoes number) IS

  vqtregistros number;
  w            number := 0;

begin

  loop

    w := 0;

    select count(*) / p_qtsessoes
      into vqtregistros
      from ti_fornecedor
     where cdsituacao = 'RC';

    while w <= p_qtsessoes loop

      update ti_fornecedor t
         set cdsituacao = 'R' || w
       where cdsituacao = 'RC'
         and rownum <= vqtregistros;

      --commit;
      w := w + 1;

    end loop;

  end loop;
end p_atualiza_status_fornecedor;

procedure p_atualiza_status_tit_apb(p_qtsessoes number) IS

  vqtregistros number;
  w            number := 0;

begin



  loop

   w := 0;

    select round(count(*) / p_qtsessoes,0)
      into vqtregistros
      from ti_tit_apb
     where cdsituacao = 'RC';

    while w <= p_qtsessoes loop

      update ti_tit_apb t
         set cdsituacao = 'R' || w
       where cdsituacao = 'RC'
         and rownum <= vqtregistros;

    --commit;
      w := w + 1;

    end loop;

  end loop;
end p_atualiza_status_tit_apb;


procedure p_gera_carga_matriz_acr(vpcdempresa varchar2,
                                  vpdtcontabil date,
                                  vpdtvenc_ini date,
                                  vpdtvenc_fin date) is
begin
  -- eliminar os registros da tabela.
  delete from ti_matriz_receber;
  --commit;
 -- inserir novamente os titulos na tabela.
  insert into ti_matriz_receber
    select ttr.cdcliente,
           ttr.nrregistro_titulo,
           pes.nrregistro,
           ttr.nrdocumento,
           ttr.cdsituacao,
           case
           when ttr.cdsituacao = 0  then
              'Aberto'
           when ttr.cdsituacao = 1  then
              'Totalmente Pago'
           when ttr.cdsituacao = 2  then
              'Parcialmente Pago'
           when ttr.cdsituacao = 3  then
              'Encerrado em Prejuizo'
           when ttr.cdsituacao = 4  then
              'Substituído'
           when ttr.cdsituacao = 5  then
              'Substituído Encerrado'
           when ttr.cdsituacao = 6  then
              'Desmembrado'
           when ttr.cdsituacao = 7  then
              'Agrupado'
           when ttr.cdsituacao = 8  then
              'Cancelado'
           end descsituacao,
           ttr.dttitulo,
           max(decode(cdmovimento, 1 ,hst.dtvencimento,
                                   2 ,hst.dtvencimento,
                                   3 ,hst.dtvencimento,
                                  10 ,hst.dtvencimento,
                                  to_date('31/12/1889'))) dtvencimento,
           decode(nvl(min(ttr.vlfaturado),0),0,
                  sum(decode(hst.nrmovimento,h2.nrmovimento,nvl(hst.vltitulo,0),0)),
                  nvl(min(ttr.vlfaturado),0)) vlfaturado,
           sum(decode(hst.nrmovimento,h2.nrmovimento,nvl(hst.vltitulo,0),0)) vltitulo,
           max(hst.dtrecebimento) dtultimo_recebimento,
           sum(nvl(decode(hst.cdmovimento,77, hst.vlmulta,
                                          85,-hst.vlmulta,
                                          86,-hst.vlmulta,
                                          87,-hst.vlmulta,
                                          89,-hst.vlmulta,
                                              hst.vlmulta),0)) vlmulta,
           sum(nvl(decode(hst.cdmovimento,77, hst.vljuros,
                                          85,-hst.vljuros,
                                          86,-hst.vljuros,
                                          87,-hst.vljuros,
                                          89,-hst.vljuros,
                                              hst.vljuros),0)) vljuros,
           sum(nvl(decode(hst.cdmovimento,77, hst.vlabatimento,
                                          85,-hst.vlabatimento,
                                          86,-hst.vlabatimento,
                                          87,-hst.vlabatimento,
                                          89,-hst.vlabatimento,
                                            hst.vlabatimento),0)) vlabatimento,
           sum(nvl(decode(hst.cdmovimento, 77, hst.vlabatimento_2,
                                           85,-hst.vlabatimento_2,
                                           86,-hst.vlabatimento_2,
                                           87,-hst.vlabatimento_2,
                                           89,-hst.vlabatimento_2,
                                               hst.vlabatimento_2),0)) vlabatimento_2,
           sum(nvl(decode(hst.cdmovimento, 77, hst.vlrecebido,
                                           85,-hst.vlrecebido,
                                           86,-hst.vlrecebido,
                                           87,-hst.vlrecebido,
                                           89,-hst.vlrecebido,
                                              hst.vlrecebido),0)) vlrecebido,
           (sum(nvl(decode(hst.cdmovimento,77, hst.vldesconto,
                                           85,-hst.vldesconto,
                                           86,-hst.vldesconto,
                                           87,-hst.vldesconto,
                                           89,-hst.vldesconto,
                                                    hst.vldesconto),0)) +
            sum(nvl(decode(hst.cdmovimento,77, hst.vlabatimento_imposto,
                                           85,-hst.vlabatimento_imposto,
                                           86,-hst.vlabatimento_imposto,
                                           87,-hst.vlabatimento_imposto,
                                           89,-hst.vlabatimento_imposto,
                                               hst.vlabatimento_imposto),0))) vldesconto,
           (sum(decode(hst.nrmovimento,h2.nrmovimento,nvl(hst.vltitulo,0),0))    +
                sum((nvl(decode(hst.cdmovimento,77, hst.vlmulta,
                                                85,-hst.vlmulta,
                                                86,-hst.vlmulta,
                                                87,-hst.vlmulta,
                                                89,-hst.vlmulta,
                                                    hst.vlmulta),0)) +
                    (nvl(decode(hst.cdmovimento,77, hst.vljuros,
                                                85,-hst.vljuros,
                                                86,-hst.vljuros,
                                                87,-hst.vljuros,
                                                89,-hst.vljuros,
                                                    hst.vljuros),0)) +
                    nvl(fn_criteriotaxabancaria( hst.nrregistro_titulo
                                               , hst.dtrecebimento
                                               , ttr.aotrata_taxa), 0) -
                    (nvl(decode(hst.cdmovimento,77, hst.vldesconto,
                                                85,-hst.vldesconto,
                                                86,-hst.vldesconto,
                                                87,-hst.vldesconto,
                                                89,-hst.vldesconto,
                                                    hst.vldesconto),0))  -
                    (nvl(decode(hst.cdmovimento,77, hst.vlabatimento,
                                                85,-hst.vlabatimento,
                                                86,-hst.vlabatimento,
                                                87,-hst.vlabatimento,
                                                89,-hst.vlabatimento,
                                                    hst.vlabatimento),0)) -
                    (nvl(decode(hst.cdmovimento,77, hst.vlabatimento_2,
                                                85,-hst.vlabatimento_2,
                                                86,-hst.vlabatimento_2,
                                                87,-hst.vlabatimento_2,
                                                89,-hst.vlabatimento_2,
                                                    hst.vlabatimento_2),0)) -
                    (nvl(decode(hst.cdmovimento,77, hst.vlir_fonte,
                                                85,-hst.vlir_fonte,
                                                86,-hst.vlir_fonte,
                                                87,-hst.vlir_fonte,
                                                89,-hst.vlir_fonte,
                                                    hst.vlir_fonte),0)) -
                    (nvl(decode(hst.cdmovimento,77, hst.vlabatimento_imposto,
                                                85,-hst.vlabatimento_imposto,
                                                86,-hst.vlabatimento_imposto,
                                                87,-hst.vlabatimento_imposto,
                                                89,-hst.vlabatimento_imposto,
                                                    hst.vlabatimento_imposto),0)) -
                    (nvl(decode(hst.cdmovimento,77, hst.vlrecebido,
                                                85,-hst.vlrecebido,
                                                86,-hst.vlrecebido,
                                                87,-hst.vlrecebido,
                                                89,-hst.vlrecebido,
                                                   hst.vlrecebido),0))
           )) vlaberto
    from   producao.titulo_a_receber@unicoo_homologa     ttr,
           producao.cliente@unicoo_homologa              cli,
           producao.grupo_de_cliente@unicoo_homologa     gcl,
           producao.pessoa@unicoo_homologa               pes,
           producao.endereco@unicoo_homologa             enr,
           producao.historico_do_titulo@unicoo_homologa  hst,
           producao.cidade@unicoo_homologa                cid,
          (select *
             from producao.v_codigo_de_historico_rec@unicoo_homologa
            where cdempresa = vpcdempresa ) cdh,

          -- busca o valor do título na data contabil informada
          (select max(nrmovimento) nrmovimento,
                  nrregistro_titulo
             from producao.historico_do_titulo@unicoo_homologa
            where cdempresa = vpcdempresa
              and dtmovimento <= vpdtcontabil
              and cdmovimento in (1,2,3,11)
            group by nrregistro_titulo ) h2
    where  ttr.cdempresa                     =  vpcdempresa
           and ttr.nrregistro_titulo         =  hst.nrregistro_titulo
           and ttr.nrregistro_titulo         =  h2.nrregistro_titulo
           and ttr.cdcliente                 =  cli.cdcliente
           and cli.cdgrupo_cliente           =  gcl.cdgrupo_cliente
           and ttr.cdhistorico               =  cdh.cdhistorico
           and cli.nrregistro_cliente        =  pes.nrregistro
           and pes.nrregistro                =  enr.nrregistro(+)
           and enr.tpendereco(+)             =  'COBR'
           and enr.cdcidade                  =  cid.cdcidade(+)
           and ttr.dttitulo <= vpdtcontabil
           and ttr.dtencerramento > vpdtcontabil
           and  hst.cdmovimento in (1, 2, 3, 7, 10, 11, 12, 13, 14, 20, 30, 70, 71, 72, 74, 76,77, 78, 80, 85, 86, 87, 89)
           and  hst.dtmovimento <= vpdtcontabil
           and not exists  (select *
                              from producao.historico_do_titulo@unicoo_homologa ht
                             where ht.nrdocumento = ttr.nrdocumento
                               and ht.cdempresa = vpcdempresa
                               and vpdtcontabil >= (select max(h.dtexclusao)
                                                     from historico_do_titulo h
                                                    where h.nrdocumento = ttr.nrdocumento
                                                      and h.cdempresa = vpcdempresa
                                                      and (vpdtcontabil >= h.dtexclusao)
                                                      and h.cdmovimento = '80')
                               and vpdtcontabil < (select min(t.dtmovimento)
                                                    from historico_do_titulo t
                                                   where t.dtmovimento >=
                                                 (select max(h.dtexclusao)
                                                    from historico_do_titulo h
                                                   where h.nrdocumento = ttr.nrdocumento
                                                     and h.cdempresa = vpcdempresa
                                                     and (vpdtcontabil >= h.dtexclusao)
                                                     and h.cdmovimento = '80')
                               and t.nrdocumento = ttr.nrdocumento
                               and t.cdempresa = vpcdempresa
                               and t.cdmovimento = '99'))
           and not exists(select null
                            from producao.titulo_gerado_encontro@unicoo_homologa tg
                           where tg.nrregistro_titulo_receber = ttr.nrregistro_titulo)
           and not exists(select null
                            from producao.historico_do_titulo@unicoo_homologa h,
                                 producao.historico_do_titulo@unicoo_homologa h3
                           where producao.h.nrregistro_titulo = ttr.nrregistro_titulo
                             and h3.nrregistro_titulo = ttr.nrregistro_titulo
                             and h.cdmovimento in ('70','72','74','76','78')
                             and h3.cdmovimento = 86
                             and h3.dtreferencia <> h3.dtrecebimento
                             and h.dtrecebimento = vpdtcontabil )
    and ttr.dtvencimento between vpdtvenc_ini and vpdtvenc_fin
    group by ttr.cdcliente,
             ttr.nrdocumento,
             ttr.tpdocumento,
             ttr.cdportador,
             ttr.dttitulo,
             ttr.dtultimo_recebimento,
             pes.nopessoa,
             cid.nocidade,
             enr.nrtelefone,
             enr.nrfax,
             cdh.nohistorico,
             cli.cdconta_contabil,
             ttr.nrregistro_titulo,
             pes.nrregistro ,
             ttr.cdsituacao;
    --commit;
end p_gera_carga_matriz_acr;

procedure p_gera_carga_matriz_apb(vpcdempresa varchar2,
                                  vpdtcontabil date,
                                  vpdtvenc_ini date,
                                  vpdtvenc_fin date) is
begin
  -- eliminar os registros da tabela.
  delete from ti_matriz_pagar;
  --commit;
 -- inserir novamente os titulos na tabela.
  insert into ti_matriz_pagar
        select t.nrregistro_titulo,
               p.nrregistro,
               t.cdempresa,
               t.nrdocumento,
               t.cdportador,
               t.tpdocumento,
               t.cdsituacao,
               case when t.cdsituacao = 0 then
                   'Aberto'
               when t.cdsituacao = 1 then
                  'Totalmente pago'
               when t.cdsituacao = 2 then
                   'Parcialmente pago'
               when t.cdsituacao = 3 then
                   'Verificar Descrição'
               when t.cdsituacao = 4 then
                   'Substituido aberto'
               when t.cdsituacao = 5 then
                   'Substituido encerrado'
               else
                   'Verificar Descrição'
               end descsituacao,
               t.dtvencimento,
               t.dttitulo,
               t.cdfornecedor,
               f.cdgrupo_fornecedor,
               g.nogrupo_fornecedor,
               p.nrcgc_cpf,
               nvl(min(t.vltitulo),0) vltitulo,
               max(h.dtrecebimento) dtultimo_recebimento,
               sum(decode(h.cdmovimento,11,0,nvl(h.vlpago,0))) vlpago,
               nvl(t.vltitulo,0) +
                 sum(  - decode(h.cdmovimento,11,0,nvl(h.vlabatimento,0))
                       - decode(h.cdmovimento,11,0,nvl(h.vlabatimento_2,0))
                       - decode(h.cdmovimento,11,0,nvl(h.vldesconto,0))
                       - decode(h.cdmovimento,11,0,nvl(h.vlpago,0))
                       + decode(h.cdmovimento,11,0,nvl(h.vljuros,0))
                       + decode(h.cdmovimento,11,0,nvl(h.vlmulta,0))
                       + decode(h.cdmovimento,11,0,nvl(h.vltaxa_bancaria,0))) vldevido,
               sum(decode(h.cdmovimento,11,0,nvl(h.vldesconto,  0)))  vldesconto,
               sum(decode(h.cdmovimento,11,0,nvl(h.vlabatimento,0)))  vlabatimento,
               sum(decode(h.cdmovimento,11,0,nvl(h.vlabatimento_2, 0))) vlabatimento_2,
               sum(decode(h.cdmovimento,11,0,nvl(h.vljuros,  0)))  vljuros,
               sum(decode(h.cdmovimento,11,0,nvl(h.vlmulta,0)))  vlmulta,
               sum(decode(h.cdmovimento,11,0,nvl(h.vltaxa_bancaria,0))) vltaxa_bancaria
          from producao.pessoa@unicoo_homologa p,
               producao.fornecedor@unicoo_homologa f,
               producao.grupo_de_fornecedor@unicoo_homologa g,
               producao.empresa@unicoo_homologa e,
               producao.titulo_a_pagar@unicoo_homologa  t,
               producao.documento_de_cobranca@unicoo_homologa d,
               producao.portador_de_cobranca@unicoo_homologa pc,
               ( select nvl(decode(cdmovimento,13,0,
                                               11,0,
                                               20,0,
                                               30,0,
                                               85,-vlabatimento,
                                               86,-vlabatimento,
                                               87,-vlabatimento,
                                               vlabatimento),0) vlabatimento,
                        nvl(decode(cdmovimento,13,0,
                                               11,0,
                                               20,0,
                                               30,0,
                                               85,-vlabatimento_2,
                                               86,-vlabatimento_2,
                                               87,-vlabatimento_2,
                                               vlabatimento_2),0) vlabatimento_2,


                        nvl(decode(cdmovimento,13,0,
                                               11,0,
                                               20,0,
                                               30,0,
                                               85,-vldesconto,
                                               86,-vldesconto,
                                               87,-vldesconto,
                                               vldesconto),0) vldesconto,

                        nvl(decode(cdmovimento,13,vljuros,
                                               25,vljuros,
                                               70,vljuros,
                                               72,vljuros,
                                               74,vljuros,
                                               76,vljuros,
                                               77,vljuros,
                                               85,-vljuros,
                                               86,-vljuros,
                                               87,-vljuros,
                                               0),0) vljuros,

                        nvl(decode(cdmovimento,7,0,
                                              11,0,
                                              12,0,
                                              13,0,
                                              14,0,
                                              20,0,
                                              30,0,
                                              80,0,
                                              85,-vltaxa_bancaria,
                                              86,-vltaxa_bancaria,
                                              87,-vltaxa_bancaria,
                                              vltaxa_bancaria),0) vltaxa_bancaria,

                        nvl(decode(cdmovimento,13,vlmulta,
                                               25,vlmulta,
                                               70,vlmulta,
                                               72,vlmulta,
                                               74,vlmulta,
                                               76,vlmulta,
                                               77,vlmulta,
                                               85,-vlmulta,
                                               86,-vlmulta,
                                               87,-vlmulta,
                                               0),0) vlmulta,


                        nvl(decode(cdmovimento,70,vlpago,
                                               72,vlpago,
                                               74,vlpago,
                                               76,vlpago,
                                               77,vlpago,
                                               85,-vlpago,
                                               86,-vlpago,
                                               87,-vlpago,
                                               0),0) vlpago,
                        dtmovimento,
                        cdmovimento,
                        nrregistro_titulo,
                        dtrecebimento

                   from producao.historico_do_titulo_pagar@unicoo_homologa
                  where cdempresa = vpcdempresa
                    and cdmovimento in (1, 2, 3, 4, 7, 9, 11, 12, 13, 14, 20, 25, 30, 70, 72, 74, 76, 77, 80, 85, 86, 87)
                    and ( decode(cdmovimento,
                                         1 , to_date(dttitulo)      ,-- incl normal
                                     --  2 , to_date(dtmovimento)   ,-- incl agrup
                                     --  3 , to_date(dtmovimento)   ,-- incl desmp
                                         7 , to_date(dtmovimento)   ,
                                         9 , to_date(dtmovimento)   ,
                                         11, to_date(dtmovimento)   ,
                                         12, to_date(dtmovimento)   ,
                                         13, to_date(dtmovimento)   ,
                                         25, to_date(dtmovimento)   ,
                                         70, to_date(dtrecebimento) ,-- baixa normal
                                         72, to_date(dtrecebimento) ,-- baixa arq mag
                                         74, to_date(dtrecebimento) ,-- baixa deb auto
                                         75, to_date(dtrecebimento) ,-- baixa composicao
                                         76, to_date(dtrecebimento) ,-- baixa enc ctas
                                         77, to_date(dtrecebimento) ,-- baixa por adiantamento
                                         85, to_date(dtmovimento)   ,
                                         86, to_date(dtmovimento)   ,
                                         87, to_date(dtmovimento)   ,
                                         80, to_date(dttitulo)     ) <= to_date(vpdtcontabil,'dd/mm/yyyy')      -- titulo cancelado  --
                            or (cdmovimento = 20)
                            or (cdmovimento = 30) )
                    and ( dtexclusao is null or cdmovimento = 80 and dtexclusao > to_date(vpdtcontabil,'dd/mm/yyyy'))
               ) h   ,
               (select
                d.nrregistro_titulo,
        --        d.cddivisao,
        --        d.cdcentro_custo,
        --        d.cdhistorico,
                sum(decode(d.tipo_distrib, 'V', d.vldistribuicao, 0)) vltitulo,
                sum(decode(d.tipo_distrib, 'D', d.vldistribuicao, 0)) vldesconto,
                sum(decode(d.tipo_distrib, 'A', d.vldistribuicao, 0)) vlabatimento,
                sum(decode(d.tipo_distrib, 'B', d.vldistribuicao, 0)) vlabatimento_2
               from producao.distribuicao_titulo_pagar@unicoo_homologa d
              where d.nrmovimento in (select max(a.nrmovimento) nrmovimento
                                        from producao.historico_do_titulo_pagar@unicoo_homologa a,
                                             producao.distribuicao_titulo_pagar@unicoo_homologa b
                                      where a.nrregistro_titulo = d.nrregistro_titulo
                                        and b.nrregistro_titulo = d.nrregistro_titulo
                                        and a.dtmovimento <= to_date(vpdtcontabil,'dd/mm/yyyy')
                                        and a.nrmovimento = b.nrmovimento
                                      group by b.tipo_distrib)
              group by
                d.nrregistro_titulo ) k
         where t.cdempresa             = e.cdempresa
           and t.nrregistro_titulo     = h.nrregistro_titulo (+)
           and t.nrregistro_titulo     = k.nrregistro_titulo (+)
           and t.tpdocumento           = d.tpdocumento
           and t.cdportador            = pc.cdportador
           and t.cdfornecedor          = f.cdfornecedor
           and f.nrregistro_fornecedor = p.nrregistro
           and f.cdgrupo_fornecedor    = g.cdgrupo_fornecedor
           and t.dttitulo <= to_date(vpdtcontabil,'dd/mm/yyyy')
           and t.cdempresa = vpcdempresa
           and (    (t.cdsituacao in ('0','2','4','6','7'))
                 or (t.cdsituacao in ('1','5') and t.dtultimo_recebimento > to_date(vpdtcontabil,'dd/mm/yyyy'))
                 or (t.cdsituacao in ('1','5') and fn_saldo_titulo_pag_data(t.nrregistro_titulo, to_date(to_date(vpdtcontabil,'dd/mm/yyyy'))+1, 0) > 0)
                 or (t.cdsituacao = '8' and t.dtexclusao >  to_date(vpdtcontabil,'dd/mm/yyyy'))
               )
           and not exists(select null from titulo_gerado_encontro tg
                           where tg.nrregistro_titulo_pagar = t.nrregistro_titulo)
           and not exists(select null from historico_do_titulo_pagar h where h.nrregistro_titulo = t.nrregistro_titulo and h.cdmovimento = 5)
        and t.dtvencimento between vpdtvenc_ini and vpdtvenc_fin
        and t.tpdocumento <> 'ADT'
        group by t.nrregistro_titulo,
                 t.cdfornecedor,
                 p.nrregistro,
                 t.cdempresa,
                 t.idcontrato,
                 t.cdhistorico,
                 t.nrdocumento,
                 t.cdportador,
                 t.tpdocumento,
                 t.cdsituacao,
                 t.cdoperacao,
                 t.dtvencimento,
                 t.dttitulo,
                 t.cddivisao,
                 t.txhistorico,
                 f.cdgrupo_fornecedor,
                 g.nogrupo_fornecedor,
                 p.nopessoa,
                 p.nrcgc_cpf,
                 p.tppessoa,
                 e.noempresa,
                 d.nodocumento,
                 pc.noportador,
                 f.cdconta_contabil,
                 t.vltitulo
        having nvl(decode(t.cdsituacao, '6', max(decode(h.cdmovimento, 20, h.dtmovimento, null)), null), to_date('01/01/3000', 'dd/mm/yyyy')) > to_date(vpdtcontabil,'dd/mm/yyyy')
           and nvl(decode(t.cdsituacao, '7', max(decode(h.cdmovimento, 30, h.dtmovimento, null)), null), to_date('01/01/3000', 'dd/mm/yyyy')) > to_date(vpdtcontabil,'dd/mm/yyyy');

    --commit;
end p_gera_carga_matriz_apb;

procedure p_gera_dados_comparativo_acr is
begin
   delete from ti_tit_acr_comparativo;
   --commit;

   insert into ti_tit_acr_comparativo
   select distinct
               ta.cod_refer,
               min(a.nrsequencial) nrsequencial,
               a.nrsequencial_origem,
               a.tpintegracao,
               nvl(b.val_titulo,0) val_titulo,
               --nvl(imp.val_imposto,0) val_imposto,
               a.cdsituacao sit_ti_controle,
               nvl(b.cdsituacao,'NI') sit_ti_tit_apb,
               nvl(ta.val_origin_tit_acr,0) vloriginal,
               nvl(ta.val_sdo_tit_acr,0) val_sdo_tit_ap
          from ti_controle_integracao a,
               ti_tit_acr             b,
               tit_acr                ta
         where a.nrsequencial             = b.nrseq_controle_integracao(+)
           and nvl(a.tpintegracao,'TR')   = 'TR'
           and nvl(a.cdsituacao,'RE') <> 'RE'
           and 'TR'||lpad(b.nrseq_controle_integracao,8,'0') = ta.cod_refer(+)
           and nvl(ta.u##ind_tip_espec_docto,'NORMAL') = 'NORMAL'
           group by ta.cod_refer,
                 a.nrsequencial_origem,
                 a.tpintegracao,
                 b.val_titulo,
                 a.cdsituacao,
                 b.cdsituacao,
                 ta.val_origin_tit_acr,
                 ta.val_sdo_tit_acr;
   --commit;

end p_gera_dados_comparativo_acr;


procedure p_gera_dados_comparativo_apb is
begin
   delete from ti_tit_apb_comparativo;
   --commit;

   insert into ti_tit_apb_comparativo
                    select distinct
                           tp.cod_refer,
                           min(a.nrsequencial) nrsequencial,
                           a.nrsequencial_origem,
                           a.tpintegracao,
                           nvl(b.val_titulo,0) val_titulo,
                           nvl(imp.val_imposto,0) val_imposto,
                           a.cdsituacao sit_ti_controle,
                           nvl(b.cdsituacao,'NI') sit_ti_tit_apb,
                           nvl(tp.val_origin_tit_ap,0) vloriginal,
                           nvl(tp.val_sdo_tit_ap,0) val_sdo_tit_ap
                      from ti_controle_integracao a,
                           ti_tit_apb             b,
                           tit_ap                 tp,
                           (select i.nrseq_controle_integracao,
                                   sum(i.val_imposto) val_imposto
                              from ti_tit_apb_imposto i
                             group by i.nrseq_controle_integracao  ) imp

                     where a.nrsequencial             = b.nrseq_controle_integracao(+)
                       and nvl(a.tpintegracao,'TP')   = 'TP'
                       and nvl(a.cdsituacao,'RE') <> 'RE'
                       and imp.nrseq_controle_integracao(+) = a.nrsequencial
                       and 'I'||lpad(b.nrseq_controle_integracao,9,'0') = tp.cod_refer(+)
                       and nvl(tp.u##ind_tip_espec_docto,'NORMAL') = 'NORMAL'
                       group by tp.cod_refer,
                             a.nrsequencial_origem,
                             a.tpintegracao,
                             b.val_titulo,
                             imp.val_imposto,
                             a.cdsituacao,
                             b.cdsituacao,
                             tp.val_origin_tit_ap,
                             tp.val_sdo_tit_ap;
   --commit;

end p_gera_dados_comparativo_apb;



procedure p_apaga_pessoa_juridica is

  cursor c_pessoa_jurid is
    select progress_recid
      from ems5.pessoa_jurid pj
     where not exists
     (select 1
              from v_pessoa_juridica v
             where pj.num_pessoa_jurid = v.NUM_PESSOA_JURID);

begin

  for pj in c_pessoa_jurid loop

    delete from ems5.pessoa_jurid p
     where p.progress_recid = pj.progress_recid;

    p_commit;

  end loop;

  --commit;

end p_apaga_pessoa_juridica;

begin
  -- Initialization
  -- Alessandro 20/03/2012
  select vlparametro
    into wnaoreprocessa
    from ti_parametro_integracao
   where cdparametro = 'TPINTEGRACAONAOREPROCESSA';
  -- Alessandro 20/03/2012

  Pcpf_dtnascimento := f_ti_parametro_integracao('CPF_DTNASCIMENTO');


  NULL;
END PCK_EMS506UNICOO_VJ;
/

prompt
prompt Creating package body PCK_EMS_ACR_UNICOO
prompt ========================================
prompt
CREATE OR REPLACE PACKAGE BODY EMS506UNICOO."PCK_EMS_ACR_UNICOO" is

  -- Variaveis
  vMovimento_ACR    ems_movimento_titulo_acr%rowtype;
  vTitulo_Unicoo    titulo_a_receber%rowtype;
  vTransacao_acr    ems_transacao_acr%Rowtype;
  vTxUltima_falha   ems_falha_acr_unicoo.txfalha%type;
  Vvldescontounicoo number;
  vData_desconto    date;

  procedure GravaFalha(pNum_id_movto_tit_acr number, pTxFalha varchar2) is
    pragma autonomous_transaction;

  begin
    insert into ems_falha_acr_unicoo
    values
      (pNum_id_movto_tit_acr, substr(ptxfalha, 1, 4000), sysdate);

    commit;
    vTxUltima_falha := pTxFalha;
  end;

  function defineNrMovimentoNoUnicoo return number is
    vResultado Number;
  begin
    select PRODUCAO.seq_movimento_historico.nextval@UNICOO_HOMOLOGA into vResultado from dual;
    --
    Return vResultado;
  end defineNrMovimentoNoUnicoo;

  procedure AtualizaControleIntegracao(pNum_Id_Movto_Tit_Acr number,
                                       pnrmovimento          number) is
  begin
    update ems_movimento_titulo_acr a
       set a.dtmovimento_unicoo = decode(vTxUltima_falha,
                                         null,
                                         sysdate,
                                         null),
           a.txultima_falha     = decode(vTxUltima_falha,
                                         null,
                                         null,
                                         vTxUltima_falha),
           a.nrmovimento        = pnrmovimento
     where a.num_id_movto_tit_acr = pNum_Id_Movto_Tit_Acr;
  end;
  function CancelaTitulo(pnrmovimento number, pNum_Id_Movto_Tit_Acr number)
    return boolean is
    vResult Boolean;
  begin
    begin
      vResult := True;
      PRODUCAO.p_exclui_titulo@UNICOO_HOMOLOGA(vTitulo_unicoo.Nrregistro_Titulo,
                      vMovimento_acr.Dat_Transacao,
                      cNRMotivo_Exc_titulo,
                      ccdfuncionario,
                      null);
    exception
      when others then
        vResult := false;
        GravaFalha(pNum_id_movto_tit_acr,
                   'Erro ao cancelar o titulo.Documento: ' ||
                   vTitulo_Unicoo.nrdocumento || '. Erro: ' || sqlerrm);
    end;
    return vResult;
  end;

  function BuscaMovimentoAcr(pNum_id_movto_tit_acr number) return boolean is
    vResult Boolean;
  begin
    begin
      select *
        into vMovimento_ACR
        from ems_movimento_titulo_acr acr
       where acr.Num_id_movto_tit_acr = pNum_id_movto_tit_acr;
      --  where acr.num_id_tit_acr = pNum_id_movto_tit_acr;

      vResult := True;
    exception
      when no_data_found then
        GravaFalha(pNum_id_movto_tit_acr,
                   'Erro ao Pesquisar Titulo no Ems ' || sqlerrm);
        vResult := False;
    end;
    return vResult;
  end;

  function BuscaTituloUnicoo(pNum_id_movto_tit_acr number) return boolean is
    vResult Boolean;
    --      vNRDocumento varchar2(12);
  begin
    /*         vNRDocumento:='';
    if trim(vMovimento_ACR.Cod_Ser_Docto) is not null then
       if vMovimento_acr.Cod_Parcela is null then
          vNRDocumento:=trim(vMovimento_ACR.Cod_Ser_Docto)||'-';
       else
          vNRDocumento:=trim(vMovimento_ACR.Cod_Ser_Docto);
       end if;
    else
       vNRDocumento:='';
    end if;
    vNRDocumento:=vNRDocumento||vMovimento_ACR.Cod_Tit_Acr;
    if vMovimento_acr.Cod_Parcela is not null then
       vNRDocumento:=vNRDocumento||trim(vMovimento_acr.Cod_parcela);
    end if;*/
    begin
      select *
        into vTitulo_Unicoo
        from titulo_a_receber tr
       where tr.nrregistro_titulo = vMovimento_ACR.Nrregistro_Titulo /*tr.nrnossonumero = vmovimento_acr.cod_tit_acr_bco*/
      ;
      vResult := True;
    exception
      when others then
        begin
          select *
            into vTitulo_Unicoo
            from titulo_a_receber tr
           where (tr.nrdocumento = trim(vMovimento_ACR.Cod_Ser_Docto) || '-' ||
                 vMovimento_ACR.Cod_Tit_Acr or
                 tr.nrdocumento = trim(vMovimento_ACR.Cod_Ser_Docto) ||
                 vMovimento_ACR.Cod_Tit_Acr ||
                 lpad(vMovimento_ACR.Cod_Parcela, 2, '0') or
                 tr.nrdocumento =
                 trim(vMovimento_ACR.Cod_Ser_Docto) ||
                 vMovimento_ACR.Cod_Tit_Acr || vMovimento_ACR.Cod_Parcela or
                 (tr.nrdocumento like '00%' and length(tr.nrdocumento) = 8 and
                 lpad(tr.nrnossonumero, 12, '0') =
                 lpad(vMovimento_ACR.Cod_Tit_Acr_bco, 12, '0') and
                 tr.txhistorico like '%contesta%') --braz 2013-05-15
                 or (tr.nrnossonumero =
                 substr(vMovimento_ACR.Cod_Tit_Acr_bco, -8, 8))) -- Alessandro 08/10/2014
             and tr.cdsituacao in (0, 2)
             and tr.nrregistro_titulo = vMovimento_ACR.Nrregistro_Titulo;

          SELECT *
            INTO vTitulo_Unicoo
            from titulo_a_receber tr
           where tr.nrdocumento = vMovimento_ACR.Nrdocumento
             and tr.nrregistro_titulo = vMovimento_ACR.Nrregistro_Titulo
             and tr.cdsituacao in (0, 2);
          vResult := True;
        exception
          when no_data_found then
            null;
            GravaFalha(pNum_id_movto_tit_acr,
                       'Titulo nao Encontrato do Unicoo --> ' ||
                       /*trim(vMovimento_ACR.Cod_Ser_Docto) || '-' ||
                                                                                                                                                                                                               vMovimento_ACR.Cod_Tit_Acr)*/
                        vMovimento_ACR.Nrregistro_Titulo);
          when others then
            GravaFalha(pNum_id_movto_tit_acr,
                       'Erro ao Pesquisar Titulo no Unicoo -->' ||
                       trim(vMovimento_ACR.Cod_Ser_Docto) || '-' ||
                       vMovimento_ACR.Cod_Tit_Acr || ' ' || sqlerrm);
            vResult := False;
        end;
    end;

    return vResult;
  end;
  procedure incluiHistoricoDoTitulo(pNrMovimento              in out Historico_do_Titulo.NrMovimento%Type,
                                    pCdMovimento              in Historico_do_Titulo.CdMovimento%Type,
                                    pNrMovimento_Original     in Historico_do_Titulo.NrMovimento_Original%Type,
                                    pDtMovimento              in Historico_do_Titulo.DtMovimento%Type,
                                    pNrRegistro_Titulo        in Historico_do_Titulo.NrRegistro_Titulo%Type,
                                    pCdEmpresa                in Historico_do_Titulo.CdEmpresa%Type,
                                    pCdCentro_Custo           in Historico_do_Titulo.CdCentro_Custo%Type,
                                    pNrRegistro_Cliente       in Historico_do_Titulo.NrRegistro_Cliente%Type,
                                    pNrContrato               in Historico_do_Titulo.NrContrato%Type,
                                    pNrDocumento              in Historico_do_Titulo.NrDocumento%Type,
                                    pTpDocumento              in Historico_do_Titulo.TpDocumento%Type,
                                    pNrPeriodo_Compet         in Historico_do_Titulo.NrPeriodo_Compet%Type,
                                    pDtTitulo                 in Historico_do_Titulo.DtTitulo%Type,
                                    pDtReferencia             in Historico_do_Titulo.DtReferencia%Type,
                                    pDtVencimento             in Historico_do_Titulo.DtVencimento%Type,
                                    pDtIntegracao             in Historico_do_Titulo.DtIntegracao%Type,
                                    pCdHistorico              in Historico_do_Titulo.CdHistorico%Type,
                                    pCdSituacao               in Historico_do_Titulo.CdSituacao%Type,
                                    pCdPortador               in Historico_do_Titulo.CdPortador%Type,
                                    pCdOperacao               in Historico_do_Titulo.CdOperacao%Type,
                                    pNrBanco                  in Historico_do_Titulo.NrBanco%Type,
                                    pNrAgencia                in Historico_do_Titulo.NrAgencia%Type,
                                    pNrConta_Corrente         in Historico_do_Titulo.NrConta_Corrente%Type,
                                    pNrNossoNumero            in Historico_do_Titulo.NrNossoNumero%Type,
                                    pCdInstr_Bancaria         in Historico_do_Titulo.CdInstr_Bancaria%Type,
                                    pNrInstrucao              in Historico_do_Titulo.NrInstrucao%Type,
                                    pCdVendedor               in Historico_do_Titulo.CdVendedor%Type,
                                    pNrMovimento_Caixa        in Historico_do_Titulo.NrMovimento_Caixa%Type,
                                    pNrUltimo_Retorno         in Historico_do_Titulo.NrUltimo_Retorno%Type,
                                    pCdComando_Atual          in Historico_do_Titulo.CdComando_Atual%Type,
                                    pCdComando_Retorno        in Historico_do_Titulo.CdComando_Retorno%Type,
                                    pCdTaxa                   in Historico_do_Titulo.CdTaxa%Type,
                                    pCdIdentificador_Deposito in Historico_do_Titulo.CdIdentificador_Deposito%Type,
                                    pDtEnvio_Banco            in Historico_do_Titulo.DtEnvio_Banco%Type,
                                    pDtConfirma_Banco         in Historico_do_Titulo.DtConfirma_Banco%Type,
                                    pDtRecebimento            in Historico_do_Titulo.DtRecebimento%Type,
                                    pDtUltimo_Retorno         in Historico_do_Titulo.DtUltimo_Retorno%Type,
                                    pDtProtesto               in Historico_do_Titulo.DtProtesto%Type,
                                    pTxReferencia_Banco       in Historico_do_Titulo.TxReferencia_Banco%Type,
                                    pNrMotivo_Exclusao        in Historico_do_Titulo.NrMotivo_Exclusao%Type,
                                    pDtExclusao               in Historico_do_Titulo.DtExclusao%Type,
                                    pNrPeriodo_Contabil       in Historico_do_Titulo.NrPeriodo_Contabil%Type,
                                    pDtContabilizado          in Historico_do_Titulo.DtContabilizado%Type,
                                    pNrNota_Fiscal_Devolucao  in Historico_do_Titulo.NrNota_Fiscal_Devolucao%Type,
                                    pAoTrata_Taxa             in Historico_do_Titulo.AoTrata_Taxa%Type,
                                    pNrRegistro_Tit_Agrup     in Historico_do_Titulo.NrRegistro_Tit_Agrup%Type,
                                    pNrRegistro_Tit_Desm      in Historico_do_Titulo.NrRegistro_Tit_Desm%Type,
                                    pNrComposicao             in Historico_do_Titulo.NrComposicao%Type,
                                    pNrEncontro_de_Contas     in Historico_do_Titulo.NrEncontro_de_Contas%Type,
                                    pTxHistorico              in Historico_do_Titulo.TxHistorico%Type,
                                    pCdFuncionario            in Historico_do_Titulo.CdFuncionario%Type,
                                    pVlTitulo                 in Historico_do_Titulo.VlTitulo%Type,
                                    pVlFaturado               in Historico_do_Titulo.VlFaturado%Type,
                                    pVlRecebido               in Historico_do_Titulo.VlRecebido%Type,
                                    pVlAbatimento             in Historico_do_Titulo.VlAbatimento%Type,
                                    pVlAbatimento_2           in Historico_do_Titulo.VlAbatimento_2%Type,
                                    pVlDesconto               in Historico_do_Titulo.VlDesconto%Type,
                                    pVlMulta                  in Historico_do_Titulo.VlMulta%Type,
                                    pVlJuros                  in Historico_do_Titulo.VlJuros%Type,
                                    pVlDiferenca_Recebimento  in Historico_do_Titulo.VlDiferenca_Recebimento%Type,
                                    pVlDiferenca_Juros        in Historico_do_Titulo.VlDiferenca_Juros%Type,
                                    pVlIr_Fonte               in Historico_do_Titulo.VlIr_Fonte%Type,
                                    pVl_IR_Fonte_Fat          in Historico_do_Titulo.Vl_IR_Fonte_Fat%Type,
                                    pVlAbatimento_Imposto     in Historico_do_Titulo.VlAbatimento_Imposto%Type,
                                    pVlTaxa_Bancaria          in Historico_do_Titulo.VlTaxa_Bancaria%Type) as
    wcdsituacao varchar2(1);
    wid         rowid;
  begin
    if pNrMovimento is null then
      Select PRODUCAO.Seq_Movimento_Historico.NextVal@UNICOO_HOMOLOGA into pNrMovimento from Dual;
      --
    end if;
    Insert into Historico_do_Titulo
      (NrMovimento,
       CdMovimento,
       NrMovimento_Original,
       DtMovimento,
       NrRegistro_Titulo,
       CdEmpresa,
       CdCentro_Custo,
       NrRegistro_Cliente,
       NrContrato,
       NrDocumento,
       TpDocumento,
       NrPeriodo_Compet,
       DtTitulo,
       DtReferencia,
       DtVencimento,
       DtIntegracao,
       CdHistorico,
       CdSituacao,
       CdPortador,
       CdOperacao,
       NrBanco,
       NrAgencia,
       NrConta_Corrente,
       NrNossoNumero,
       CdInstr_Bancaria,
       NrInstrucao,
       CdVendedor,
       NrMovimento_Caixa,
       NrUltimo_Retorno,
       CdComando_Atual,
       CdComando_Retorno,
       CdTaxa,
       CdIdentificador_Deposito,
       DtEnvio_Banco,
       DtConfirma_Banco,
       DtRecebimento,
       DtUltimo_Retorno,
       DtProtesto,
       TxReferencia_Banco,
       NrMotivo_Exclusao,
       DtExclusao,
       NrPeriodo_Contabil,
       DtContabilizado,
       NrNota_Fiscal_Devolucao,
       AoTrata_Taxa,
       NrRegistro_Tit_Agrup,
       NrRegistro_Tit_Desm,
       NrComposicao,
       NrEncontro_de_Contas,
       TxHistorico,
       CdFuncionario,
       VlTitulo,
       VlFaturado,
       VlRecebido,
       VlAbatimento,
       VlAbatimento_2,
       VlDesconto,
       VlMulta,
       VlJuros,
       VlDiferenca_Recebimento,
       VlDiferenca_Juros,
       VlIr_Fonte,
       Vl_IR_Fonte_Fat,
       VlAbatimento_Imposto,
       VlTaxa_Bancaria)
    values
      (pNrMovimento,
       pCdMovimento,
       pNrMovimento_Original,
       pDtMovimento,
       pNrRegistro_Titulo,
       pCdEmpresa,
       pCdCentro_Custo,
       pNrRegistro_Cliente,
       pNrContrato,
       pNrDocumento,
       pTpDocumento,
       pNrPeriodo_Compet,
       pDtTitulo,
       pDtReferencia,
       pDtVencimento,
       pDtIntegracao,
       pCdHistorico,
       pCdSituacao,
       pCdPortador,
       pCdOperacao,
       pNrBanco,
       pNrAgencia,
       pNrConta_Corrente,
       pNrNossoNumero,
       pCdInstr_Bancaria,
       pNrInstrucao,
       pCdVendedor,
       pNrMovimento_Caixa,
       pNrUltimo_Retorno,
       pCdComando_Atual,
       pCdComando_Retorno,
       pCdTaxa,
       pCdIdentificador_Deposito, -- 'SISTEMA_EMS',
       pDtEnvio_Banco,
       pDtConfirma_Banco,
       pDtRecebimento,
       pDtUltimo_Retorno,
       pDtProtesto,
       pTxReferencia_Banco,
       pNrMotivo_Exclusao,
       pDtExclusao,
       pNrPeriodo_Contabil,
       pDtContabilizado,
       pNrNota_Fiscal_Devolucao,
       pAoTrata_Taxa,
       pNrRegistro_Tit_Agrup,
       pNrRegistro_Tit_Desm,
       pNrComposicao,
       pNrEncontro_de_Contas,
       pTxHistorico,
       pCdFuncionario,
       pVlTitulo,
       pVlFaturado,
       pVlRecebido,
       pVlAbatimento,
       pVlAbatimento_2,
       pVlDesconto,
       pVlMulta,
       pVlJuros,
       pVlDiferenca_Recebimento,
       pVlDiferenca_Juros,
       pVlIr_Fonte,
       pVl_IR_Fonte_Fat,
       pVlAbatimento_Imposto,
       pVlTaxa_Bancaria);

    -- em alguns casos, o titulo era baixado parcialmente, mesmo tendo o valor recebido 100%
    -- colocado este tratamento para resolver isso
    select cdsituacao, rowid
      into wcdsituacao, wid
      from titulo_a_receber
     where nrregistro_titulo = pNrRegistro_Titulo;

    if wcdsituacao = '2' then
      if nvl(pVlRecebido, 0) >
         nvl(pVlTitulo, 0) - nvl(pVlAbatimento, 0) -
         nvl(pVlAbatimento_2, 0) - nvl(pVlDesconto, 0) + nvl(pVlMulta, 0) +
         nvl(pVlJuros, 0) then
        update titulo_a_receber
           set cdsituacao = '1'
         where rowid = wid;
      end if;
    end if;
  exception
    when Others then
      GravaFalha(vMovimento_acr.Num_Id_Movto_Tit_Acr,
                 'Erro ao Incluir o Historico do Titulo. Erro: Dtmovimento: ' ||
                 pDtRecebimento || '  ' || SQLErrm);
      null;
  end incluiHistoricoDoTitulo;

  procedure cancelaBaixaTituloUnicoo(pnrmovimento       in out historico_do_titulo.nrmovimento%type,
                                     pNrRegistro_Titulo in Historico_do_Titulo.NrRegistro_Titulo%Type,
                                     pCDMovimento       in historico_do_titulo.cdmovimento%type) is
    vNrMovimento Historico_do_Titulo.NrMovimento%Type;
    vcdsituacao  titulo_a_receber.cdsituacao%type;
    vcdmovimento historico_do_titulo.cdmovimento%type;
  begin
    begin
      -- captura o ultimo movimento
      select cdsituacao
        into vcdsituacao
        from titulo_a_receber h
       where h.nrregistro_titulo = pNrRegistro_Titulo;

      -- se for cancelamento de baixa, nao faz outra
      if vcdsituacao in ('1', '2') then
        vcdsituacao := vTitulo_Unicoo.Cdsituacao;

        select max(h.nrmovimento)
          into vNrMovimento
          from historico_do_titulo h
         where h.nrregistro_titulo = pNrRegistro_Titulo
           and h.cdmovimento in (70, 71, 72, 74, 76, 78);

        if vNrMovimento is not null then
          update historico_do_titulo h
             set h.cdmovimento = pCDMovimento
           where h.nrmovimento = vNrMovimento;
        end if;
        pnrmovimento := vnrmovimento;
        /*    Leo TI - 18/02/2011 -> N?o mudava a situac?o do titulo para 0 (Aberto)
                 --====================================--
                 -- Tratar estorno de baixa por perdas --
                 ----------------------------------------
                 if vcdsituacao in ('3','2' ) then
                     update titulo_a_receber tr
                     set
                            tr.cdsituacao='0'
                     where
                            tr.nrregistro_titulo=pNrRegistro_Titulo;
                 end if;
        */
      end if;
      --Leo TI - 18/02/2011 - Muda a situac?o do titulo para 0 (Aberto)
      --====================================--
      -- Tratar estorno de baixa por perdas --
      ----------------------------------------
      if vcdsituacao in ('3', '2') then
        update titulo_a_receber tr
           set tr.cdsituacao = '0'
         where tr.nrregistro_titulo = pNrRegistro_Titulo;
      end if;

    exception
      when no_data_found then
        null;
    end;
  end;

  procedure atualizaTituloNoUnicoo(pNrMovimento        in out Historico_do_Titulo.NrMovimento%Type,
                                   pCDMovimento        in historico_do_titulo.cdmovimento%type,
                                   pDtMovimento        in Historico_do_Titulo.DtMovimento%Type,
                                   pNrRegistro_Titulo  in Historico_do_Titulo.NrRegistro_Titulo%Type,
                                   pCdEmpresa          in Historico_do_Titulo.CdEmpresa%Type,
                                   pCdCentro_Custo     in Historico_do_Titulo.CdCentro_Custo%Type,
                                   pNrRegistro_Cliente in Historico_do_Titulo.NrRegistro_Cliente%Type,
                                   pNrContrato         in Historico_do_Titulo.NrContrato%Type,
                                   pNrDocumento        in Historico_do_Titulo.NrDocumento%Type,
                                   pTpDocumento        in Historico_do_Titulo.TpDocumento%Type,
                                   pNrPeriodo_Compet   in Historico_do_Titulo.NrPeriodo_Compet%Type,
                                   pDtTitulo           in Historico_do_Titulo.DtTitulo%Type,
                                   pDtVencimento       in Historico_do_Titulo.DtVencimento%Type,
                                   pDtIntegracao       in Historico_do_Titulo.DtIntegracao%Type,
                                   pCdHistorico        in Historico_do_Titulo.CdHistorico%Type,
                                   --                                          pCdSituacao         in Historico_do_Titulo.CdSituacao%Type,
                                   --                                          pCdPortador         in Historico_do_Titulo.CdPortador%Type,
                                   pCdOperacao in Historico_do_Titulo.CdOperacao%Type,
                                   --                                          pNrBanco            in Historico_do_Titulo.NrBanco%Type,
                                   --                                          pNrAgencia          in Historico_do_Titulo.NrAgencia%Type,
                                   --                                          pNrConta_Corrente   in Historico_do_Titulo.NrConta_Corrente%Type,
                                   pNrNossonumero in Historico_do_Titulo.NrNossonumero%Type,
                                   pCdVendedor    in Historico_do_Titulo.CdVendedor%Type,
                                   --                                          pNrMovimento_Caixa  in Historico_do_Titulo.NrMovimento_Caixa%Type,
                                   pDtConfirma_Banco in Historico_do_Titulo.DtConfirma_Banco%Type,
                                   pDtRecebimento    in Historico_do_Titulo.DtRecebimento%Type,
                                   --                                          pTxHistorico        in Historico_do_Titulo.TxHistorico%Type,
                                   pCdFuncionario   in Historico_do_Titulo.CdFuncionario%Type,
                                   pVlTitulo        in Historico_do_Titulo.VlTitulo%Type,
                                   pVlFaturado      in Historico_do_Titulo.VlFaturado%Type,
                                   pVlRecebido      in Historico_do_Titulo.VlRecebido%Type,
                                   pVlAbatimento    in Historico_do_Titulo.VlAbatimento%Type,
                                   pVlAbatimento_2  in Historico_do_Titulo.VlAbatimento_2%Type,
                                   pVlDesconto      in Historico_do_Titulo.VlDesconto%Type,
                                   pVlMulta         in Historico_do_Titulo.VlMulta%Type,
                                   pVlJuros         in Historico_do_Titulo.VlJuros%Type,
                                   pVlTaxa_Bancaria in Historico_do_Titulo.VlTaxa_Bancaria%Type) as
  begin

    incluiHistoricoDoTitulo(pNrMovimento,
                            pCDMovimento, --pCdMovimento,
                            null, --pNrMovimento_Original,
                            pDtMovimento,
                            pNrRegistro_Titulo,
                            pCdEmpresa,
                            pCdCentro_Custo,
                            pNrRegistro_Cliente,
                            pNrContrato,
                            pNrDocumento,
                            pTpDocumento,
                            pNrPeriodo_Compet,
                            pDtTitulo,
                            null, -- pDtReferencia,
                            pDtVencimento,
                            pDtIntegracao,
                            pCdHistorico,
                            null, -- pCdSituacao,
                            null, -- pCdPortador,
                            pCdOperacao,
                            null, -- pNrBanco,
                            null, -- pNrAgencia,
                            null, -- pNrConta_Corrente,
                            pNrNossoNumero,
                            null, --pCdInstr_Bancaria,
                            null, --pNrInstrucao,
                            pCdVendedor,
                            null, -- pNrMovimento_Caixa,
                            null, --pNrUltimo_Retorno,
                            null, --pCdComando_Atual,
                            null, --pCdComando_Retorno,
                            null, --pCdTaxa,
                            null, --pCdIdentificador_Deposito,
                            null, --pDtEnvio_Banco,
                            pDtConfirma_Banco,
                            pDtRecebimento,
                            null, --pDtUltimo_Retorno,
                            null, --pDtProtesto,
                            null, --pTxReferencia_Banco,
                            null, --pNrMotivo_Exclusao,
                            null, --pDtExclusao,
                            null, --pNrPeriodo_Contabil,
                            null, --pDtContabilizado,
                            null, --pNrNota_Fiscal_Devolucao,
                            null, --pAoTrata_Taxa,
                            null, --pNrRegistro_Tit_Agrup,
                            null, --pNrRegistro_Tit_Desm,
                            null, --pNrComposicao,
                            null, --pNrEncontro_de_Contas,
                            null, -- pTxHistorico,
                            pCdFuncionario,
                            pVlTitulo,
                            pVlFaturado,
                            pVlRecebido,
                            pVlAbatimento,
                            pVlAbatimento_2,
                            pVlDesconto,
                            pVlMulta,
                            pVlJuros,
                            null, --pVlDiferenca_Recebimento,
                            null, --pVlDiferenca_Juros,
                            null, --pVlIr_Fonte,
                            null, --pVl_IR_Fonte_Fat,
                            null, --pVlAbatimento_Imposto,
                            pVlTaxa_Bancaria);
    --

  end atualizaTituloNoUnicoo;

  procedure atualizarTituloNoUnicoo(pNum_id_movto_tit_acr number,
                                    pNum_id_tit_acr       number,
                                    ptxfalha_unicoo       in out varchar2) is

    vNrMovimento      historico_do_titulo.nrmovimento%type;
    vVlRecebido       historico_do_titulo.vlrecebido%type;
    vVLtitulo         historico_do_titulo.vlrecebido%type;
    vCdMovimento      Historico_Do_Titulo.cdmovimento%type; -- Alessandro 06/05/2010
    vVlDesconto       Historico_Do_Titulo.vldesconto%type; -- Alessandro 06/05/2010
    vNrDocumento      historico_do_titulo.nrdocumento%type; -- Eric 29/06/2010
    vVlJuros          ems_movimento_titulo_acr.val_juros%type;
    vAoExiste_Imposto char;

    function defineCdMovimentoNoUnicoo(pNum_id_movto_tit_acr Number)
      return boolean is
      vResult Boolean;
    begin
      begin

        Select tra.*
          into vTransacao_acr
          from ems_movimento_titulo_acr acr, ems_transacao_acr tra
         where tra.cdtransacao = acr.ind_trans_acr_abrev
           and acr.num_id_movto_tit_acr = pNum_id_movto_tit_acr;

        vResult := true;

        Select acr.nrdocumento
          into vNrDocumento
          from ems_movimento_titulo_acr acr
         where acr.num_id_movto_tit_acr = pNum_id_movto_tit_acr;

        vResult := true;

      exception
        when no_data_found then
          GravaFalha(pNum_id_movto_tit_acr,
                     'A transac?o n?o esta cadastrada na tabela EMS_TRANSACAO_ACR. Codigo de Transac?o --> ' ||
                     vMovimento_ACR.Ind_Trans_Acr_Abrev || ' ' || sqlerrm);
          vResult := False;
        when others then
          GravaFalha(pNum_id_movto_tit_acr,
                     vMovimento_ACR.Ind_Trans_Acr_Abrev || ' ' || sqlerrm);
          vResult := False;
      end;
      return vResult;
    end defineCdMovimentoNoUnicoo;

  begin
    vTxUltima_falha := null;
    if BuscaMovimentoAcr(pNum_id_movto_tit_acr) then
      if BuscaTituloUnicoo(pNum_id_movto_tit_acr) then
        if vMovimento_acr.Ind_Tip_Espec_Docto = 'NORMAL' then

          if defineCdMovimentoNoUnicoo(pNum_id_movto_tit_acr) then

            if vTransacao_acr.CDMovimento in
               ('7', '10', '11', '12', '70', '71', '76', '78', '30','80') then
              if vTransacao_acr.Cdmovimento = '70' then
                Begin
                  select e.val_juros
                    into vVlJuros
                    from ems_movimento_titulo_acr e
                   where e.nrdocumento = vNrDocumento
                     and e.num_id_movto_tit_acr = pNum_id_movto_tit_acr /*Alterado pela unimed*/
                     and e.ind_trans_acr_abrev = 'ELQR';

                exception
                  when no_data_found then
                    null;
                end;
                -- implementado Eric 29/06/2010
                update titulo_a_receber t
                   set t.cdsituacao = 0
                 where t.nrdocumento = vNrDocumento;

              end if;

              --if vTransacao_acr.CDMovimento in ('7','11') then -- Alessandro 06/05/2010
              if vTransacao_acr.CDMovimento in ('7', '11') or
                 (vTransacao_acr.Aodesconto = 'S' and
                 vmovimento_acr.val_movto_tit_acr <
                 vmovimento_acr.val_liq_tit_acr) then
                -- Alessandro 06/05/2010
                vVlRecebido := 0;

              elsif vVlJuros is not null then
                vVlRecebido              := vMovimento_acr.Val_Movto_Tit_Acr +
                                            nvl(vMovimento_acr.Val_Juros, 0);
                vMovimento_acr.Val_Juros := nvl(vVlJuros, 0) +
                                            nvl(vMovimento_acr.Val_Juros, 0);

              else
                vVlRecebido := vMovimento_acr.Val_Movto_Tit_Acr +
                               nvl(vMovimento_acr.Val_Multa_Tit_Acr, 0) +
                               nvl(vMovimento_acr.Val_Juros, 0) -
                               nvl(vMovimento_acr.Val_Abat_Tit_Acr, 0) -
                               nvl(vMovimento_acr.Val_Desconto, 0);
              end if;

              if vTransacao_acr.CDMovimento = '11' then
                vVLtitulo := vMovimento_acr.Val_Liq_Tit_Acr +
                             vMOvimento_Acr.Val_Ajust_Val_Tit_Acr +
                             (vMovimento_acr.Val_Movto_Tit_Acr *
                             vTransacao_acr.VlSinal);
              else
                vVLtitulo := vTitulo_unicoo.Vltitulo;
              end if;

              -- Inicio : Alessandro 06/05/2010
              vCdMovimento := vTransacao_acr.Cdmovimento;
              vVlDesconto  := vMovimento_ACR.Val_Desconto;

              -- Final : Alessandro 06/05/2010

              IF vCdMovimento = 70 AND -- Vinicius 17/12/2014
                 f_saldo_titulo_receber(vTitulo_Unicoo.Nrregistro_Titulo) =
                 vVlRecebido AND vTitulo_Unicoo.Vldesconto = vVlDesconto THEN
                vVlDesconto := 0;
              ELSIF vCdMovimento = 70 AND f_saldo_titulo_receber(vTitulo_Unicoo.Nrregistro_Titulo) >
                    vVlRecebido THEN
                vVlDesconto := vVlDesconto;
              END IF;


            IF vMovimento_acr.Val_Juros  = 0 THEN
              vVlRecebido := vVlRecebido + vMovimento_acr.Val_Multa_Tit_Acr + -- vlmulta,
                             vMovimento_acr.Val_Juros + -- vljuros,
                             vMovimento_acr.Val_Despes_Bcia;
                             END IF;

             IF (f_saldo_titulo_receber(vTitulo_Unicoo.Nrregistro_Titulo) +
                 vMovimento_acr.Val_Multa_Tit_Acr + -- vlmulta,
                 vMovimento_acr.Val_Juros + -- vljuros,
                 vMovimento_acr.Val_Despes_Bcia) <
                 (vVlRecebido + vVlDesconto) THEN
                vVlRecebido := (f_saldo_titulo_receber(vTitulo_Unicoo.Nrregistro_Titulo) +
                 vMovimento_acr.Val_Multa_Tit_Acr + -- vlmulta,
                 vMovimento_acr.Val_Juros + -- vljuros,
                 vMovimento_acr.Val_Despes_Bcia) +
                               vMovimento_acr.Val_Multa_Tit_Acr + -- vlmulta,
                               vMovimento_acr.Val_Juros + -- vljuros,
                               vMovimento_acr.Val_Despes_Bcia;

              END IF;

              /*if ((

               (f_saldo_titulo_receber(vTitulo_Unicoo.Nrregistro_Titulo) +
                 vMovimento_acr.Val_Multa_Tit_Acr + -- vlmulta,
                 vMovimento_acr.Val_Juros + -- vljuros,
                 vMovimento_acr.Val_Despes_Bcia)



                ) -
                 nvl(vMovimento_acr.Val_Abat_Tit_Acr, 0) -
                 nvl(vMovimento_acr.Val_Desconto, 0)) < vVlRecebido THEN



                vVlRecebido := ((f_saldo_titulo_receber(vTitulo_Unicoo.Nrregistro_Titulo) +
                 vMovimento_acr.Val_Multa_Tit_Acr + -- vlmulta,
                 vMovimento_acr.Val_Juros + -- vljuros,
                 vMovimento_acr.Val_Despes_Bcia)) -
                               nvl(vMovimento_acr.Val_Abat_Tit_Acr, 0) -
                               nvl(vMovimento_acr.Val_Desconto, 0);
              END IF;*/

            vNRMovimento := defineNrMovimentoNoUnicoo;

              atualizaTituloNoUnicoo(vNRMovimento,
                                     vCdMovimento, --vTransacao_acr.CDMovimento, -- Alessandro 06/05/2010
                                     vMovimento_acr.Dat_Transacao,
                                     vTitulo_Unicoo.nrregistro_titulo,
                                     vTitulo_Unicoo.cdempresa,
                                     vTitulo_Unicoo.cdcentro_custo,
                                     vTitulo_Unicoo.nrregistro_cliente,
                                     vTitulo_Unicoo.nrcontrato,
                                     vTitulo_Unicoo.nrdocumento,
                                     vTitulo_Unicoo.tpdocumento,
                                     vTitulo_Unicoo.nrperiodo_compet,
                                     vTitulo_Unicoo.dttitulo,
                                     vMovimento_acr.Dat_Vencto_Tit_Acr,
                                     vTitulo_Unicoo.dtintegracao,
                                     vTitulo_Unicoo.cdhistorico,
                                     vTitulo_Unicoo.cdoperacao,
                                     vTitulo_Unicoo.nrnossonumero,
                                     vTitulo_Unicoo.cdvendedor,
                                     vMovimento_acr.Dat_Liquidac_Tit_Acr,
                                     vMovimento_acr.Dat_Liquidac_Tit_Acr,
                                     cCDFuncionario,
                                     vVltitulo, -- Valor titulo
                                     vTitulo_unicoo.vlfaturado,
                                     vVlRecebido, -- vlRecebido,
                                     vMovimento_acr.Val_Abat_Tit_Acr, --vlabatimento,
                                     0, --vlabatimento_2,
                                     vVlDesconto, --vMovimento_acr.Val_Desconto, --vldesconto, -- Alessandro 06/05/2010
                                     vMovimento_acr.Val_Multa_Tit_Acr, -- vlmulta,
                                     vMovimento_acr.Val_Juros, -- vljuros,
                                     vMovimento_acr.Val_Despes_Bcia --VlTaxa_Bancaria
                                     );
            elsif vTransacao_acr.Aodesconto = 'S' then
              -- Josias - Emplementado o tratamento do desconto

              ----------------------------------------------------
              -- Verifica se foi preenchido a data de desconto
              ----------------------------------------------------
              select dat_desconto
                into vData_desconto
                from tit_acr a
               where a.num_id_tit_acr = pnum_id_tit_acr;

              vCdMovimento := vTransacao_acr.Cddesconto;
              vVlRecebido  := 0;

              -- Josias - 03-11-2014 Implementação do desconto.
              if vData_desconto is not null then
                begin
                  ----------------------------------------------------
                  -- Verificar o desconto dado no titulo APB
                  ----------------------------------------------------
                  /*  begin
                    select round(((b.val_perc_desc * b.val_origin_tit_acr) / 100),
                                 2)
                      into vVlDesconto
                      from tit_acr b
                     where b.num_id_tit_acr = pNum_id_tit_acr;
                  exception
                    when others then
                      vVlDesconto := 0;
                  end;*/

                  --VINICIUS 24/04/2015 - DESCONTO SOBRE O SALDO
                  begin
                    select round(((b.val_perc_desc * b.val_sdo_tit_acr) / 100),
                                 2)
                      into vVlDesconto
                      from tit_acr b
                     where b.num_id_tit_acr = pNum_id_tit_acr;
                  exception
                    when others then
                      vVlDesconto := 0;
                  end;

                  --
                  -- Vericar se o valor de desconto é maior que zero
                  if vVlDesconto > 0 then
                    begin
                      ----------------------------------------------------
                      -- Verifica se ja existe desconto no UNICOO
                      ----------------------------------------------------
                      begin
                        select sum(v.vldesconto)
                          into Vvldescontounicoo
                          from historico_do_titulo v
                         where v.CdMovimento = vCdMovimento
                           and v.nrregistro_titulo =
                               vTitulo_Unicoo.Nrregistro_Titulo;
                      exception
                        when no_data_found then
                          Vvldescontounicoo := 0;
                      end;
                      -----------------------------------------------------------------------
                      -- Se existir o desconto, calcular a diferença do desconto ja aplicado
                      -- com o novo desconto dado.
                      ----------------------------------------------------------------------
                      if Vvldescontounicoo > 0 then
                        vVlDesconto := ((vVlDesconto) - Vvldescontounicoo);
                      end if;

                      if vVlDesconto <> 0 then
                        atualizaTituloNoUnicoo(vNRMovimento,
                                               vCdMovimento, --vTransacao_acr.CDMovimento, -- Alessandro 06/05/2010
                                               vMovimento_acr.Dat_Transacao,
                                               vTitulo_Unicoo.nrregistro_titulo,
                                               vTitulo_Unicoo.cdempresa,
                                               vTitulo_Unicoo.cdcentro_custo,
                                               vTitulo_Unicoo.nrregistro_cliente,
                                               vTitulo_Unicoo.nrcontrato,
                                               vTitulo_Unicoo.nrdocumento,
                                               vTitulo_Unicoo.tpdocumento,
                                               vTitulo_Unicoo.nrperiodo_compet,
                                               vTitulo_Unicoo.dttitulo,
                                               vMovimento_acr.Dat_Vencto_Tit_Acr,
                                               vTitulo_Unicoo.dtintegracao,
                                               vTitulo_Unicoo.cdhistorico,
                                               vTitulo_Unicoo.cdoperacao,
                                               vTitulo_Unicoo.nrnossonumero,
                                               vTitulo_Unicoo.cdvendedor,
                                               vMovimento_acr.Dat_Liquidac_Tit_Acr,
                                               vMovimento_acr.Dat_Liquidac_Tit_Acr,
                                               cCDFuncionario,
                                               vVltitulo, -- Valor titulo
                                               vTitulo_unicoo.vlfaturado,
                                               vVlRecebido, -- vlRecebido,
                                               vMovimento_acr.Val_Abat_Tit_Acr, --vlabatimento,
                                               0, --vlabatimento_2,
                                               vVlDesconto, --vMovimento_acr.Val_Desconto, --vldesconto, -- Alessandro 06/05/2010
                                               vMovimento_acr.Val_Multa_Tit_Acr, -- vlmulta,
                                               vMovimento_acr.Val_Juros, -- vljuros,
                                               vMovimento_acr.Val_Despes_Bcia --VlTaxa_Bancaria
                                               );
                      end if;
                    end;
                  end if;
                end;
              end if;
            elsif vTransacao_acr.CDMovimento = '81' then
              if vtitulo_unicoo.cdsituacao = '3' then
                cancelaBaixaTituloUnicoo(vnrmovimento,
                                         vTitulo_Unicoo.nrregistro_titulo,
                                         '82');
              else
                cancelaBaixaTituloUnicoo(vnrmovimento,
                                         vTitulo_Unicoo.nrregistro_titulo,
                                         vTransacao_acr.CDMovimento);
              end if;
            elsif vTransacao_acr.CDMovimento = '80' then
              if CancelaTitulo(vnrmovimento, pNum_id_movto_tit_acr) then
                null;
              end if;
            end if;
          end if;
        end if;
      end if;
    end if;

    AtualizaControleIntegracao(pNum_id_movto_tit_acr, vnrmovimento);

    ptxfalha_unicoo := vTxUltima_falha;
  end;

  procedure CorrigeTituloNoUnicoo is
    cursor c_movimento is
      select emta.rowid linha, emta.*
        from ems_movimento_titulo_acr emta
       where emta.nrmovimento is not null
         and not exists
       (select 1
                from movto_tit_acr mta
               where mta.num_id_movto_tit_acr = emta.num_id_movto_tit_acr);
  begin
    for l_movimento in c_movimento loop
      delete from historico_do_titulo ht
       where ht.nrmovimento = l_movimento.nrmovimento;

      insert into ems_movimento_titulo_acr_log
        select *
          from ems_movimento_titulo_acr eta
         where eta.rowid = l_movimento.linha;

      delete ems_movimento_titulo_acr eta
       where eta.rowid = l_movimento.linha;

    end loop;
    /*update titulo_a_receber t set t.cdsituacao='1'
    where t.cdsituacao='2'
      and t.vlrecebido=t.vltitulo
      and t.dtultimo_recebimento>='01/08/2009';*/
  end;
  procedure atualizabaixanounicoo is

    vtxfalha ems_falha_acr_unicoo.txfalha%type;

  begin
    for i in (select *
                from ems_movimento_titulo_acr t
               where trunc(dtmovimento_ems) = trunc(sysdate)
                 and ind_trans_acr_abrev != 'IMPL'
                 and nrmovimento is null) loop

      pck_ems_acr_unicoo.atualizartitulonounicoo(i.num_id_movto_tit_acr,
                                                 i.num_id_tit_acr,
                                                 vtxfalha);

      update ems_movimento_titulo_acr mov
         set mov.txultima_falha = vtxfalha
       where mov.num_id_movto_tit_acr = i.num_id_movto_tit_acr;
    end loop;
  end;

end;
/

prompt
prompt Creating package body PCK_EMS_ACR_UNICOO_BKP
prompt ============================================
prompt
CREATE OR REPLACE PACKAGE BODY EMS506UNICOO."PCK_EMS_ACR_UNICOO_BKP" is


  -- Variaveis
  vMovimento_ACR        ems_movimento_titulo_acr%rowtype;
  vTitulo_Unicoo        titulo_a_receber%rowtype;
  vTransacao_acr        ems_transacao_acr%Rowtype;
  vTxUltima_falha       ems_falha_acr_unicoo.txfalha%type;

  procedure GravaFalha( pNum_id_movto_tit_acr number,
                         pTxFalha               varchar2
                        ) is
    PRAGMA AUTONOMOUS_TRANSACTION;


    begin
        insert into ems_falha_acr_unicoo
        values
        (pNum_id_movto_tit_acr,
         substr(ptxfalha,1,4000),
         sysdate
        );
        commit;
        vTxUltima_falha:=pTxFalha;
    end;

  function defineNrMovimentoNoUnicoo return number is
    vResultado Number;
  begin
    select PRODUCAO.seq_movimento_historico.nextval@UNICOO_HOMOLOGA
      into vResultado
      from dual;
    --
    Return vResultado;
  end defineNrMovimentoNoUnicoo;

  procedure AtualizaControleIntegracao(pNum_Id_Movto_Tit_Acr number, pnrmovimento number)
  is
  begin
           update ems_movimento_titulo_acr a
           set
                  a.dtmovimento_unicoo=decode(vTxUltima_falha,null,sysdate,null),
                  a.txultima_falha    =decode(vTxUltima_falha,null,null,vTxUltima_falha),
                  a.nrmovimento =pnrmovimento
           where
                  a.num_id_movto_tit_acr=pNum_Id_Movto_Tit_Acr;
  end;
  function CancelaTitulo(pnrmovimento number, pNum_Id_Movto_Tit_Acr number) return boolean
  is
      vResult Boolean;
  begin
        begin
            vResult:=True;
            PRODUCAO.p_exclui_titulo@UNICOO_HOMOLOGA(vTitulo_unicoo.Nrregistro_Titulo,
                            vMovimento_acr.Dat_Transacao,
                            cNRMotivo_Exc_titulo,
                            ccdfuncionario,
                            null
                            );
           exception
                when others then
                                vResult:=false;
                                GravaFalha(pNum_id_movto_tit_acr,'Erro ao cancelar o titulo. Documento: ' ||
                                                                       vTitulo_Unicoo.nrdocumento || '. Erro: ' ||
                                                                       sqlerrm
                                          );
           end;
        return vResult;
  end;



    function BuscaMovimentoAcr(pNum_id_movto_tit_acr number) return boolean
    is
      vResult Boolean;
    begin
         begin
             select
                 *
             into
                 vMovimento_ACR
             from ems_movimento_titulo_acr acr
             where
                    acr.Num_id_movto_tit_acr=pNum_id_movto_tit_acr;

             vResult:=True;
         exception
                   when no_data_found then
                        GravaFalha(pNum_id_movto_tit_acr,'Erro ao Pesquisar Titulo no Ems '||sqlerrm);
                        vResult:=False;
         end ;
         return vResult;
    end;

    function BuscaTituloUnicoo(pNum_id_movto_tit_acr number) return boolean
    is
      vResult Boolean;
--      vNRDocumento varchar2(12);
    begin
/*         vNRDocumento:='';
         if trim(vMovimento_ACR.Cod_Ser_Docto) is not null then
            if vMovimento_acr.Cod_Parcela is null then
               vNRDocumento:=trim(vMovimento_ACR.Cod_Ser_Docto)||'-';
            else
               vNRDocumento:=trim(vMovimento_ACR.Cod_Ser_Docto);
            end if;
         else
            vNRDocumento:='';
         end if;
         vNRDocumento:=vNRDocumento||vMovimento_ACR.Cod_Tit_Acr;
         if vMovimento_acr.Cod_Parcela is not null then
            vNRDocumento:=vNRDocumento||trim(vMovimento_acr.Cod_parcela);
         end if;*/
         begin
              select * into vTitulo_Unicoo
              from
                     titulo_a_receber tr
              where
                     tr.nrnossonumero=vMovimento_ACR.Cod_Tit_Acr_bco
                     or
                     tr.nrdocumento=vMovimento_ACR.Nrdocumento;

             vResult:=True;
         exception
             when others then
               begin
                    select * into vTitulo_Unicoo
                    from
                           titulo_a_receber tr
                    where

                           tr.nrdocumento = trim(vMovimento_ACR.Cod_Ser_Docto)||'-'||vMovimento_ACR.Cod_Tit_Acr
                           or

                           tr.nrdocumento = trim(vMovimento_ACR.Cod_Ser_Docto)||vMovimento_ACR.Cod_Tit_Acr||lpad(vMovimento_ACR.Cod_Parcela,2,'0')

                           or tr.nrdocumento = trim(vMovimento_ACR.Cod_Ser_Docto)||vMovimento_ACR.Cod_Tit_Acr||vMovimento_ACR.Cod_Parcela

                           or (tr.nrdocumento like '00%' and length(tr.nrdocumento) = 8 and lpad(tr.nrnossonumero,12,'0') = lpad(vMovimento_ACR.Cod_Tit_Acr_bco,12,'0') and tr.txhistorico like '%contesta%') --braz 2013-05-15

                           or (lpad(tr.nrnossonumero,12,'0') = lpad(vMovimento_ACR.Cod_Tit_Acr_bco,12,'0'))  -- Alessandro 08/10/2014
                           ;


                   vResult:=True;
               exception
                         when no_data_found then
                              GravaFalha(pNum_id_movto_tit_acr,'Titulo nao Encontrato do Unicoo -->'||trim(vMovimento_ACR.Cod_Ser_Docto)||'-'||vMovimento_ACR.Cod_Tit_Acr);
                         when others then
                              GravaFalha(pNum_id_movto_tit_acr,'Erro ao Pesquisar Titulo no Unicoo -->'||trim(vMovimento_ACR.Cod_Ser_Docto)||'-'||vMovimento_ACR.Cod_Tit_Acr||' '||sqlerrm);
                              vResult:=False;
               end ;
         end ;

         return vResult;
    end;
procedure incluiHistoricoDoTitulo( pNrMovimento              in out Historico_do_Titulo.NrMovimento%Type,
                                     pCdMovimento              in Historico_do_Titulo.CdMovimento%Type,
                                     pNrMovimento_Original     in Historico_do_Titulo.NrMovimento_Original%Type,
                                     pDtMovimento              in Historico_do_Titulo.DtMovimento%Type,
                                     pNrRegistro_Titulo        in Historico_do_Titulo.NrRegistro_Titulo%Type,
                                     pCdEmpresa                in Historico_do_Titulo.CdEmpresa%Type,
                                     pCdCentro_Custo           in Historico_do_Titulo.CdCentro_Custo%Type,
                                     pNrRegistro_Cliente       in Historico_do_Titulo.NrRegistro_Cliente%Type,
                                     pNrContrato               in Historico_do_Titulo.NrContrato%Type,
                                     pNrDocumento              in Historico_do_Titulo.NrDocumento%Type,
                                     pTpDocumento              in Historico_do_Titulo.TpDocumento%Type,
                                     pNrPeriodo_Compet         in Historico_do_Titulo.NrPeriodo_Compet%Type,
                                     pDtTitulo                 in Historico_do_Titulo.DtTitulo%Type,
                                     pDtReferencia             in Historico_do_Titulo.DtReferencia%Type,
                                     pDtVencimento             in Historico_do_Titulo.DtVencimento%Type,
                                     pDtIntegracao             in Historico_do_Titulo.DtIntegracao%Type,
                                     pCdHistorico              in Historico_do_Titulo.CdHistorico%Type,
                                     pCdSituacao               in Historico_do_Titulo.CdSituacao%Type,
                                     pCdPortador               in Historico_do_Titulo.CdPortador%Type,
                                     pCdOperacao               in Historico_do_Titulo.CdOperacao%Type,
                                     pNrBanco                  in Historico_do_Titulo.NrBanco%Type,
                                     pNrAgencia                in Historico_do_Titulo.NrAgencia%Type,
                                     pNrConta_Corrente         in Historico_do_Titulo.NrConta_Corrente%Type,
                                     pNrNossoNumero            in Historico_do_Titulo.NrNossoNumero%Type,
                                     pCdInstr_Bancaria         in Historico_do_Titulo.CdInstr_Bancaria%Type,
                                     pNrInstrucao              in Historico_do_Titulo.NrInstrucao%Type,
                                     pCdVendedor               in Historico_do_Titulo.CdVendedor%Type,
                                     pNrMovimento_Caixa        in Historico_do_Titulo.NrMovimento_Caixa%Type,
                                     pNrUltimo_Retorno         in Historico_do_Titulo.NrUltimo_Retorno%Type,
                                     pCdComando_Atual          in Historico_do_Titulo.CdComando_Atual%Type,
                                     pCdComando_Retorno        in Historico_do_Titulo.CdComando_Retorno%Type,
                                     pCdTaxa                   in Historico_do_Titulo.CdTaxa%Type,
                                     pCdIdentificador_Deposito in Historico_do_Titulo.CdIdentificador_Deposito%Type,
                                     pDtEnvio_Banco            in Historico_do_Titulo.DtEnvio_Banco%Type,
                                     pDtConfirma_Banco         in Historico_do_Titulo.DtConfirma_Banco%Type,
                                     pDtRecebimento            in Historico_do_Titulo.DtRecebimento%Type,
                                     pDtUltimo_Retorno         in Historico_do_Titulo.DtUltimo_Retorno%Type,
                                     pDtProtesto               in Historico_do_Titulo.DtProtesto%Type,
                                     pTxReferencia_Banco       in Historico_do_Titulo.TxReferencia_Banco%Type,
                                     pNrMotivo_Exclusao        in Historico_do_Titulo.NrMotivo_Exclusao%Type,
                                     pDtExclusao               in Historico_do_Titulo.DtExclusao%Type,
                                     pNrPeriodo_Contabil       in Historico_do_Titulo.NrPeriodo_Contabil%Type,
                                     pDtContabilizado          in Historico_do_Titulo.DtContabilizado%Type,
                                     pNrNota_Fiscal_Devolucao  in Historico_do_Titulo.NrNota_Fiscal_Devolucao%Type,
                                     pAoTrata_Taxa             in Historico_do_Titulo.AoTrata_Taxa%Type,
                                     pNrRegistro_Tit_Agrup     in Historico_do_Titulo.NrRegistro_Tit_Agrup%Type,
                                     pNrRegistro_Tit_Desm      in Historico_do_Titulo.NrRegistro_Tit_Desm%Type,
                                     pNrComposicao             in Historico_do_Titulo.NrComposicao%Type,
                                     pNrEncontro_de_Contas     in Historico_do_Titulo.NrEncontro_de_Contas%Type,
                                     pTxHistorico              in Historico_do_Titulo.TxHistorico%Type,
                                     pCdFuncionario            in Historico_do_Titulo.CdFuncionario%Type,
                                     pVlTitulo                 in Historico_do_Titulo.VlTitulo%Type,
                                     pVlFaturado               in Historico_do_Titulo.VlFaturado%Type,
                                     pVlRecebido               in Historico_do_Titulo.VlRecebido%Type,
                                     pVlAbatimento             in Historico_do_Titulo.VlAbatimento%Type,
                                     pVlAbatimento_2           in Historico_do_Titulo.VlAbatimento_2%Type,
                                     pVlDesconto               in Historico_do_Titulo.VlDesconto%Type,
                                     pVlMulta                  in Historico_do_Titulo.VlMulta%Type,
                                     pVlJuros                  in Historico_do_Titulo.VlJuros%Type,
                                     pVlDiferenca_Recebimento  in Historico_do_Titulo.VlDiferenca_Recebimento%Type,
                                     pVlDiferenca_Juros        in Historico_do_Titulo.VlDiferenca_Juros%Type,
                                     pVlIr_Fonte               in Historico_do_Titulo.VlIr_Fonte%Type,
                                     pVl_IR_Fonte_Fat          in Historico_do_Titulo.Vl_IR_Fonte_Fat%Type,
                                     pVlAbatimento_Imposto     in Historico_do_Titulo.VlAbatimento_Imposto%Type,
                                     pVlTaxa_Bancaria          in Historico_do_Titulo.VlTaxa_Bancaria%Type ) as
    wcdsituacao  varchar2(1);
    wid          rowid;
  begin
    if pNrMovimento is null then
      Select PRODUCAO.Seq_Movimento_Historico.NextVal@UNICOO_HOMOLOGA
        into pNrMovimento
        from Dual;
      --
    end if;
    Insert into Historico_do_Titulo
                ( NrMovimento,
                  CdMovimento,
                  NrMovimento_Original,
                  DtMovimento,
                  NrRegistro_Titulo,
                  CdEmpresa,
                  CdCentro_Custo,
                  NrRegistro_Cliente,
                  NrContrato,
                  NrDocumento,
                  TpDocumento,
                  NrPeriodo_Compet,
                  DtTitulo,
                  DtReferencia,
                  DtVencimento,
                  DtIntegracao,
                  CdHistorico,
                  CdSituacao,
                  CdPortador,
                  CdOperacao,
                  NrBanco,
                  NrAgencia,
                  NrConta_Corrente,
                  NrNossoNumero,
                  CdInstr_Bancaria,
                  NrInstrucao,
                  CdVendedor,
                  NrMovimento_Caixa,
                  NrUltimo_Retorno,
                  CdComando_Atual,
                  CdComando_Retorno,
                  CdTaxa,
                  CdIdentificador_Deposito,
                  DtEnvio_Banco,
                  DtConfirma_Banco,
                  DtRecebimento,
                  DtUltimo_Retorno,
                  DtProtesto,
                  TxReferencia_Banco,
                  NrMotivo_Exclusao,
                  DtExclusao,
                  NrPeriodo_Contabil,
                  DtContabilizado,
                  NrNota_Fiscal_Devolucao,
                  AoTrata_Taxa,
                  NrRegistro_Tit_Agrup,
                  NrRegistro_Tit_Desm,
                  NrComposicao,
                  NrEncontro_de_Contas,
                  TxHistorico,
                  CdFuncionario,
                  VlTitulo,
                  VlFaturado,
                  VlRecebido,
                  VlAbatimento,
                  VlAbatimento_2,
                  VlDesconto,
                  VlMulta,
                  VlJuros,
                  VlDiferenca_Recebimento,
                  VlDiferenca_Juros,
                  VlIr_Fonte,
                  Vl_IR_Fonte_Fat,
                  VlAbatimento_Imposto,
                  VlTaxa_Bancaria   )
         values ( pNrMovimento,
                  pCdMovimento,
                  pNrMovimento_Original,
                  pDtMovimento,
                  pNrRegistro_Titulo,
                  pCdEmpresa,
                  pCdCentro_Custo,
                  pNrRegistro_Cliente,
                  pNrContrato,
                  pNrDocumento,
                  pTpDocumento,
                  pNrPeriodo_Compet,
                  pDtTitulo,
                  pDtReferencia,
                  pDtVencimento,
                  pDtIntegracao,
                  pCdHistorico,
                  pCdSituacao,
                  pCdPortador,
                  pCdOperacao,
                  pNrBanco,
                  pNrAgencia,
                  pNrConta_Corrente,
                  pNrNossoNumero,
                  pCdInstr_Bancaria,
                  pNrInstrucao,
                  pCdVendedor,
                  pNrMovimento_Caixa,
                  pNrUltimo_Retorno,
                  pCdComando_Atual,
                  pCdComando_Retorno,
                  pCdTaxa,
                  pCdIdentificador_Deposito, -- 'SISTEMA_EMS',
                  pDtEnvio_Banco,
                  pDtConfirma_Banco,
                  pDtRecebimento,
                  pDtUltimo_Retorno,
                  pDtProtesto,
                  pTxReferencia_Banco,
                  pNrMotivo_Exclusao,
                  pDtExclusao,
                  pNrPeriodo_Contabil,
                  pDtContabilizado,
                  pNrNota_Fiscal_Devolucao,
                  pAoTrata_Taxa,
                  pNrRegistro_Tit_Agrup,
                  pNrRegistro_Tit_Desm,
                  pNrComposicao,
                  pNrEncontro_de_Contas,
                  pTxHistorico,
                  pCdFuncionario,
                  pVlTitulo,
                  pVlFaturado,
                  pVlRecebido,
                  pVlAbatimento,
                  pVlAbatimento_2,
                  pVlDesconto,
                  pVlMulta,
                  pVlJuros,
                  pVlDiferenca_Recebimento,
                  pVlDiferenca_Juros,
                  pVlIr_Fonte,
                  pVl_IR_Fonte_Fat,
                  pVlAbatimento_Imposto,
                  pVlTaxa_Bancaria
                  );


      -- em alguns casos, o titulo era baixado parcialmente, mesmo tendo o valor recebido 100%
      -- colocado este tratamento para resolver isso
      select cdsituacao, rowid
        into wcdsituacao, wid
        from titulo_a_receber
       where nrregistro_titulo = pNrRegistro_Titulo;

      if wcdsituacao = '2' then
         if    nvl( pVlRecebido,0)  >
               nvl( pVlTitulo,0)
             - nvl( pVlAbatimento,0)
             - nvl( pVlAbatimento_2,0)
             - nvl( pVlDesconto,0)
             + nvl( pVlMulta,0)
             + nvl( pVlJuros ,0)
          then
             update titulo_a_receber
                set cdsituacao = '1'
              where rowid      = wid;
          end if;
       end if;
  exception
    when Others then
      GravaFalha(vMovimento_acr.Num_Id_Movto_Tit_Acr, 'Erro ao Incluir o Historico do Titulo. Erro: Dtmovimento: '||pDtRecebimento||'  ' ||SQLErrm);
  end incluiHistoricoDoTitulo;

  procedure cancelaBaixaTituloUnicoo (
                                       pnrmovimento        in out historico_do_titulo.nrmovimento%type,
                                       pNrRegistro_Titulo  in Historico_do_Titulo.NrRegistro_Titulo%Type,
                                       pCDMovimento        in historico_do_titulo.cdmovimento%type
                                     ) is
    vNrMovimento   Historico_do_Titulo.NrMovimento%Type;
    vcdsituacao    titulo_a_receber.cdsituacao%type;
    vcdmovimento   historico_do_titulo.cdmovimento%type;
  begin
    begin
      -- captura o ultimo movimento
      select cdsituacao
        into vcdsituacao
        from titulo_a_receber h
       where h.nrregistro_titulo = pNrRegistro_Titulo;



      -- se for cancelamento de baixa, nao faz outra
      if vcdsituacao in ( '1','2') then
         vcdsituacao:=vTitulo_Unicoo.Cdsituacao;

         select max(h.nrmovimento)
         into vNrMovimento
         from historico_do_titulo h
         where h.nrregistro_titulo = pNrRegistro_Titulo
           and h.cdmovimento in (70, 71, 72, 74, 76);

         if vNrMovimento is not null then
           update historico_do_titulo h
           set h.cdmovimento = pCDMovimento
           where h.nrmovimento = vNrMovimento;
         end if;
         pnrmovimento:=vnrmovimento;
/*    Leo TI - 18/02/2011 -> N?o mudava a situac?o do titulo para 0 (Aberto)
         --====================================--
         -- Tratar estorno de baixa por perdas --
         ----------------------------------------
         if vcdsituacao in ('3','2' ) then
             update titulo_a_receber tr
             set
                    tr.cdsituacao='0'
             where
                    tr.nrregistro_titulo=pNrRegistro_Titulo;
         end if;
*/      end if;
--Leo TI - 18/02/2011 - Muda a situac?o do titulo para 0 (Aberto)
         --====================================--
         -- Tratar estorno de baixa por perdas --
         ----------------------------------------
         if vcdsituacao in ('3','2' ) then
             update titulo_a_receber tr
             set
                    tr.cdsituacao='0'
             where
                    tr.nrregistro_titulo=pNrRegistro_Titulo;
         end if;

    exception
      when no_data_found then
        null;
    end;
  end;

  procedure atualizaTituloNoUnicoo( pNrMovimento        in out Historico_do_Titulo.NrMovimento%Type,
                                          pCDMovimento        in historico_do_titulo.cdmovimento%type,
                                          pDtMovimento        in Historico_do_Titulo.DtMovimento%Type,
                                          pNrRegistro_Titulo  in Historico_do_Titulo.NrRegistro_Titulo%Type,
                                          pCdEmpresa          in Historico_do_Titulo.CdEmpresa%Type,
                                          pCdCentro_Custo     in Historico_do_Titulo.CdCentro_Custo%Type,
                                          pNrRegistro_Cliente in Historico_do_Titulo.NrRegistro_Cliente%Type,
                                          pNrContrato         in Historico_do_Titulo.NrContrato%Type,
                                          pNrDocumento        in Historico_do_Titulo.NrDocumento%Type,
                                          pTpDocumento        in Historico_do_Titulo.TpDocumento%Type,
                                          pNrPeriodo_Compet   in Historico_do_Titulo.NrPeriodo_Compet%Type,
                                          pDtTitulo           in Historico_do_Titulo.DtTitulo%Type,
                                          pDtVencimento       in Historico_do_Titulo.DtVencimento%Type,
                                          pDtIntegracao       in Historico_do_Titulo.DtIntegracao%Type,
                                          pCdHistorico        in Historico_do_Titulo.CdHistorico%Type,
--                                          pCdSituacao         in Historico_do_Titulo.CdSituacao%Type,
--                                          pCdPortador         in Historico_do_Titulo.CdPortador%Type,
                                          pCdOperacao         in Historico_do_Titulo.CdOperacao%Type,
--                                          pNrBanco            in Historico_do_Titulo.NrBanco%Type,
--                                          pNrAgencia          in Historico_do_Titulo.NrAgencia%Type,
--                                          pNrConta_Corrente   in Historico_do_Titulo.NrConta_Corrente%Type,
                                          pNrNossonumero      in Historico_do_Titulo.NrNossonumero%Type,
                                          pCdVendedor         in Historico_do_Titulo.CdVendedor%Type,
--                                          pNrMovimento_Caixa  in Historico_do_Titulo.NrMovimento_Caixa%Type,
                                          pDtConfirma_Banco   in Historico_do_Titulo.DtConfirma_Banco%Type,
                                          pDtRecebimento      in Historico_do_Titulo.DtRecebimento%Type,
--                                          pTxHistorico        in Historico_do_Titulo.TxHistorico%Type,
                                          pCdFuncionario      in Historico_do_Titulo.CdFuncionario%Type,
                                          pVlTitulo           in Historico_do_Titulo.VlTitulo%Type,
                                          pVlFaturado         in Historico_do_Titulo.VlFaturado%Type,
                                          pVlRecebido         in Historico_do_Titulo.VlRecebido%Type,
                                          pVlAbatimento       in Historico_do_Titulo.VlAbatimento%Type,
                                          pVlAbatimento_2     in Historico_do_Titulo.VlAbatimento_2%Type,
                                          pVlDesconto         in Historico_do_Titulo.VlDesconto%Type,
                                          pVlMulta            in Historico_do_Titulo.VlMulta%Type,
                                          pVlJuros            in Historico_do_Titulo.VlJuros%Type,
                                          pVlTaxa_Bancaria    in Historico_do_Titulo.VlTaxa_Bancaria%Type) as
  begin

    incluiHistoricoDoTitulo( pNrMovimento,
                             pCDMovimento,  --pCdMovimento,
                             null, --pNrMovimento_Original,
                             pDtMovimento,
                             pNrRegistro_Titulo,
                             pCdEmpresa,
                             pCdCentro_Custo,
                             pNrRegistro_Cliente,
                             pNrContrato,
                             pNrDocumento,
                             pTpDocumento,
                             pNrPeriodo_Compet,
                             pDtTitulo,
                             null, -- pDtReferencia,
                             pDtVencimento,
                             pDtIntegracao,
                             pCdHistorico,
                             null, -- pCdSituacao,
                             null, -- pCdPortador,
                             pCdOperacao,
                             null, -- pNrBanco,
                             null, -- pNrAgencia,
                             null, -- pNrConta_Corrente,
                             pNrNossoNumero,
                             null, --pCdInstr_Bancaria,
                             null, --pNrInstrucao,
                             pCdVendedor,
                             null, -- pNrMovimento_Caixa,
                             null, --pNrUltimo_Retorno,
                             null, --pCdComando_Atual,
                             null, --pCdComando_Retorno,
                             null, --pCdTaxa,
                             null, --pCdIdentificador_Deposito,
                             null, --pDtEnvio_Banco,
                             pDtConfirma_Banco,
                             pDtRecebimento,
                             null, --pDtUltimo_Retorno,
                             null, --pDtProtesto,
                             null, --pTxReferencia_Banco,
                             null, --pNrMotivo_Exclusao,
                             null, --pDtExclusao,
                             null, --pNrPeriodo_Contabil,
                             null, --pDtContabilizado,
                             null, --pNrNota_Fiscal_Devolucao,
                             null, --pAoTrata_Taxa,
                             null, --pNrRegistro_Tit_Agrup,
                             null, --pNrRegistro_Tit_Desm,
                             null, --pNrComposicao,
                             null, --pNrEncontro_de_Contas,
                             null, -- pTxHistorico,
                             pCdFuncionario,
                             pVlTitulo,
                             pVlFaturado,
                             pVlRecebido,
                             pVlAbatimento,
                             pVlAbatimento_2,
                             pVlDesconto,
                             pVlMulta,
                             pVlJuros,
                             null, --pVlDiferenca_Recebimento,
                             null, --pVlDiferenca_Juros,
                             null, --pVlIr_Fonte,
                             null, --pVl_IR_Fonte_Fat,
                             null, --pVlAbatimento_Imposto,
                             pVlTaxa_Bancaria
                              );
    --

  end atualizaTituloNoUnicoo;




    procedure atualizarTituloNoUnicoo(
                                   pNum_id_movto_tit_acr number,
                                   ptxfalha_unicoo      in out varchar2
                                  ) is

       vNrMovimento historico_do_titulo.nrmovimento%type;
       vVlRecebido  historico_do_titulo.vlrecebido%type;
       vVLtitulo    historico_do_titulo.vlrecebido%type;
       vCdMovimento Historico_Do_Titulo.CDMOVIMENTO%type;  -- Alessandro 06/05/2010
       vVlDesconto  Historico_Do_Titulo.VLDESCONTO%type;   -- Alessandro 06/05/2010
       vNrDocumento historico_do_titulo.nrdocumento%type; -- Eric 29/06/2010
       vVlJuros     ems_movimento_titulo_acr.val_juros%type;


        function defineCdMovimentoNoUnicoo( pNum_id_movto_tit_acr Number ) return boolean is
          vResult Boolean;
        begin
          begin

            Select tra.*
              into vTransacao_acr

              from ems_movimento_titulo_acr acr,
                   ems_transacao_acr tra

             where tra.cdtransacao=acr.ind_trans_acr_abrev
               and acr.num_id_movto_tit_acr=pNum_id_movto_tit_acr;

           vResult:=true;

            Select acr.nrdocumento
              into vNrDocumento
              from ems_movimento_titulo_acr acr
             where acr.num_id_movto_tit_acr=pNum_id_movto_tit_acr;

            vResult:=true;

          exception
                 when no_data_found then
                        GravaFalha(pNum_id_movto_tit_acr,'A transac?o n?o esta cadastrada na tabela EMS_TRANSACAO_ACR. Codigo de Transac?o --> '||vMovimento_ACR.Ind_Trans_Acr_Abrev||' '||sqlerrm);
                        vResult:=False;
                 when others then
                        GravaFalha(pNum_id_movto_tit_acr,'Erro ao Definir o codigo de movimento p/ a transac?o '||vMovimento_ACR.Ind_Trans_Acr_Abrev||' '||sqlerrm);
                        vResult:=False;


          end;
          return vResult;
        end defineCdMovimentoNoUnicoo;

    begin
         vTxUltima_falha:=null;
         if BuscaMovimentoAcr(pNum_id_movto_tit_acr) then
            if BuscaTituloUnicoo(pNum_id_movto_tit_acr) then
                if vMovimento_acr.Ind_Tip_Espec_Docto='NORMAL' then
                    if defineCdMovimentoNoUnicoo(pNum_id_movto_tit_acr) then

                        if vTransacao_acr.CDMovimento in ('7','10','11','12','70','71','76') then
                             if vTransacao_acr.Cdmovimento = '70' then
                                Begin
                                   select e.val_juros
                                     into  vVlJuros
                                     from ems_movimento_titulo_acr e
                                    where e.nrdocumento = vNrDocumento
                                      and e.num_id_movto_tit_acr = pNum_id_movto_tit_acr /*Alterado pela unimed*/
                                      and e.ind_trans_acr_abrev = 'ELQR';

                                   exception when no_data_found then
                                      null;
                                end;


                             -- implementado Eric 29/06/2010
                                 update titulo_a_receber t
                                    set t.cdsituacao  = 0
                                  where t.nrdocumento = vNrDocumento;


                             end if;
                            --if vTransacao_acr.CDMovimento in ('7','11') then -- Alessandro 06/05/2010
                            if vTransacao_acr.CDMovimento in ('7','11') or (vTransacao_acr.Aodesconto = 'S' and vMovimento_ACR.Val_Movto_Tit_Acr < vMovimento_ACR.Val_Liq_Tit_Acr) then -- Alessandro 06/05/2010
                                vVlRecebido:=0;

                            elsif vVlJuros is not null then
                                vVlRecebido := vMovimento_acr.Val_Movto_Tit_Acr +  nvl(vMovimento_acr.Val_Juros, 0);
                                vMovimento_acr.Val_Juros := nvl(vVlJuros, 0)+ nvl(vMovimento_acr.Val_Juros, 0);

                            else
                               vVlRecebido:=vMovimento_acr.Val_Movto_Tit_Acr +
                                            nvl(vMovimento_acr.Val_Multa_Tit_Acr, 0) +
                                            nvl(vMovimento_acr.Val_Juros, 0) -
                                            nvl(vMovimento_acr.Val_Abat_Tit_Acr, 0) -
                                            nvl(vMovimento_acr.Val_Desconto, 0);
                            end if;

                            if vTransacao_acr.CDMovimento='11' then
                                  vVLtitulo:=vMovimento_acr.Val_Liq_Tit_Acr+vMOvimento_Acr.Val_Ajust_Val_Tit_Acr+(vMovimento_acr.Val_Movto_Tit_Acr*vTransacao_acr.VlSinal);
                            else
                               vVLtitulo:=vTitulo_unicoo.Vltitulo;
                            end if;

                       -- Inicio : Alessandro 06/05/2010
                           if vTransacao_acr.Aodesconto = 'S' then

                              vCdMovimento := vTransacao_acr.Cddesconto;
                              vVlDesconto  := vMovimento_ACR.Val_Movto_Tit_Acr;
                              vVLtitulo    := 0;

                           else

                              vCdMovimento := vTransacao_acr.Cdmovimento;
                              vVlDesconto  := vMovimento_ACR.Val_Desconto;

                           end if;
                           -- Final : Alessandro 06/05/2010

                           vNRMovimento:=defineNrMovimentoNoUnicoo;
                           atualizaTituloNoUnicoo( vNRMovimento,
                                      vCdMovimento,--vTransacao_acr.CDMovimento, -- Alessandro 06/05/2010
                                      vMovimento_acr.Dat_Transacao,
                                      vTitulo_Unicoo.nrregistro_titulo,
                                      vTitulo_Unicoo.cdempresa,
                                      vTitulo_Unicoo.cdcentro_custo,
                                      vTitulo_Unicoo.nrregistro_cliente,
                                      vTitulo_Unicoo.nrcontrato,
                                      vTitulo_Unicoo.nrdocumento,
                                      vTitulo_Unicoo.tpdocumento,
                                      vTitulo_Unicoo.nrperiodo_compet,
                                      vTitulo_Unicoo.dttitulo,
                                      vMovimento_acr.Dat_Vencto_Tit_Acr,
                                      vTitulo_Unicoo.dtintegracao,
                                      vTitulo_Unicoo.cdhistorico,
    --                                  null,
    --                                  null, -- Portador
                                      vTitulo_Unicoo.cdoperacao,
    --                                  null, -- NRbanco
    --                                  null, -- Agencia
    --                                  null, -- NrConta_Corrente
                                      vTitulo_Unicoo.nrnossonumero,
                                      vTitulo_Unicoo.cdvendedor,
    --                                  null, -- Movimento caixa
                                      vMovimento_acr.Dat_Transacao,
                                      vMovimento_acr.Dat_Transacao,
    --                                  null, -- Txhistorico
                                      cCDFuncionario,
                                      vVltitulo, -- Valor titulo
                                      vTitulo_unicoo.vlfaturado,
                                      vVlRecebido, -- vlRecebido,
                                      vMovimento_acr.Val_Abat_Tit_Acr, --vlabatimento,
                                      0, --vlabatimento_2,
                                      vVlDesconto,--vMovimento_acr.Val_Desconto, --vldesconto, -- Alessandro 06/05/2010
                                      vMovimento_acr.Val_Multa_Tit_Acr, -- vlmulta,
                                      vMovimento_acr.Val_Juros, -- vljuros,
                                      vMovimento_acr.Val_Despes_Bcia --VlTaxa_Bancaria
                                      );
                        elsif vTransacao_acr.CDMovimento='81' then
                           if vtitulo_unicoo.cdsituacao='3' then
                               cancelaBaixaTituloUnicoo(vnrmovimento,vTitulo_Unicoo.nrregistro_titulo,
                                                        '82');
                           else
                               cancelaBaixaTituloUnicoo(vnrmovimento,
                                                        vTitulo_Unicoo.nrregistro_titulo,
                                                        vTransacao_acr.CDMovimento);
                           end if;
                        elsif vTransacao_acr.CDMovimento='80' then
                           if CancelaTitulo(vnrmovimento,
                                            pNum_id_movto_tit_acr) then
                              null;
                           end if;
                        end if;
                    end if;
                end if;
            end if;
         end if;
         AtualizaControleIntegracao(pNum_id_movto_tit_acr,vnrmovimento);
         ptxfalha_unicoo:=vTxUltima_falha;
    end;
    procedure CorrigeTituloNoUnicoo
    is
      cursor c_movimento
      is
      select emta.rowid linha, emta.* from ems_movimento_titulo_acr emta
      where
             emta.nrmovimento is not null
             and
             not exists (select 1 from movto_tit_acr mta
                        where
                                mta.num_id_movto_tit_acr=emta.num_id_movto_tit_acr);
    begin
         for l_movimento in c_movimento loop
             delete from historico_do_titulo ht
             where
                    ht.nrmovimento=l_movimento.nrmovimento;
             insert into ems_movimento_titulo_acr_log
             select * from ems_movimento_titulo_acr  eta
             where
                    eta.rowid=l_movimento.linha;
             delete ems_movimento_titulo_acr  eta
             where
                    eta.rowid=l_movimento.linha;
         end loop;
/*update titulo_a_receber t
set
       t.cdsituacao='1'
where
       t.cdsituacao='2'
       and
       t.vlrecebido=t.vltitulo
       and
       t.dtultimo_recebimento>='01/08/2009';*/

    end;

PROCEDURE ATUALIZABAIXANOUNICOO IS

VTXFALHA EMS_FALHA_ACR_UNICOO.TXFALHA%TYPE;

BEGIN
   FOR I IN (SELECT *
               FROM EMS_MOVIMENTO_TITULO_ACR T
              WHERE TRUNC(DTMOVIMENTO_EMS) = TRUNC(SYSDATE)
                AND IND_TRANS_ACR_ABREV != 'IMPL'
                AND NRMOVIMENTO IS NULL
            ) LOOP

      pck_ems_acr_unicoo_bkp.ATUALIZARTITULONOUNICOO(I.NUM_ID_MOVTO_TIT_ACR,VTXFALHA);

      UPDATE EMS_MOVIMENTO_TITULO_ACR MOV
         SET MOV.TXULTIMA_FALHA = VTXFALHA
       WHERE MOV.NUM_ID_MOVTO_TIT_ACR = I.NUM_ID_MOVTO_TIT_ACR;
   END LOOP;
END;


end;
/

prompt
prompt Creating package body PCK_EXECUTA_MIGRACAO
prompt ==========================================
prompt
CREATE OR REPLACE PACKAGE BODY EMS506UNICOO."PCK_EXECUTA_MIGRACAO" IS

  V_PIPENAME   VARCHAR2(30);
  V_INDEX_PIPE NUMBER := 0;
  V_RESULTADO  NUMBER;
  V_ERRO       VARCHAR2(2000);

  FUNCTION COMANDO(P_ROTINA IN VARCHAR2) RETURN VARCHAR2 IS
    V_COMANDO VARCHAR2(400);
  BEGIN

    V_INDEX_PIPE := V_INDEX_PIPE + 1;
    V_COMANDO    := V_COMANDO || ' declare';
    V_COMANDO    := V_COMANDO || '   v_resultado number;';
    V_COMANDO    := V_COMANDO || '   v_erro varchar2(2000);';
    V_COMANDO    := V_COMANDO || ' begin';
    V_COMANDO    := V_COMANDO || '    begin';
    V_COMANDO    := V_COMANDO || '    ' || P_ROTINA;
    V_COMANDO    := V_COMANDO || '       v_erro := null;';
    V_COMANDO    := V_COMANDO || '    exception when others then';
    V_COMANDO    := V_COMANDO || '       v_erro := sqlerrm;';
    V_COMANDO    := V_COMANDO || '    end;';
    V_COMANDO    := V_COMANDO || '  DBMS_PIPE.pack_message(' ||
                    V_INDEX_PIPE || ');';
    V_COMANDO    := V_COMANDO || '  DBMS_PIPE.pack_message(v_erro);';
    V_COMANDO    := V_COMANDO ||
                    '  v_resultado := DBMS_PIPE.send_message(''' ||
                    V_PIPENAME || ''');';
    V_COMANDO    := V_COMANDO || ' end;';

    RETURN V_COMANDO;

  END;

  PROCEDURE AGENDAR(P_COMANDO IN VARCHAR2) IS
    V_ID_JOB NUMBER;
  BEGIN

    DBMS_JOB.SUBMIT(JOB       => V_ID_JOB,
                    WHAT      => P_COMANDO,
                    NEXT_DATE => SYSDATE);

    COMMIT;

  END;

  PROCEDURE EXECUTAR(P_EXECUTAR IN OUT TYP_TB_EXECUTAR) IS
    V_COMANDO VARCHAR2(400);

  BEGIN

    FOR DD IN 1 .. P_EXECUTAR.COUNT LOOP

      V_COMANDO := COMANDO(P_ROTINA => P_EXECUTAR(DD).ROTINA);

      AGENDAR(P_COMANDO => V_COMANDO);

    END LOOP;

    FOR DD IN 1 .. V_INDEX_PIPE LOOP

      P_EXECUTAR(V_RESULTADO).ERRO := V_ERRO;

    END LOOP;

  END EXECUTAR;

END PCK_EXECUTA_MIGRACAO;
/

prompt
prompt Creating package body UTL_PARALELO
prompt ==================================
prompt
CREATE OR REPLACE PACKAGE BODY EMS506UNICOO."UTL_PARALELO" IS

  V_PIPENAME   VARCHAR2(30);
  V_INDEX_PIPE NUMBER := 0;
  V_RESULTADO  NUMBER;
  V_ERRO       VARCHAR2(2000);

  FUNCTION COMANDO(P_ROTINA IN VARCHAR2) RETURN VARCHAR2 IS
    V_COMANDO VARCHAR2(400);
  BEGIN

    V_INDEX_PIPE := V_INDEX_PIPE + 1;
    V_COMANDO    := V_COMANDO || ' declare';
    V_COMANDO    := V_COMANDO || '   v_resultado number;';
    V_COMANDO    := V_COMANDO || '   v_erro varchar2(2000);';
    V_COMANDO    := V_COMANDO || ' begin';
    V_COMANDO    := V_COMANDO || '    begin';
    V_COMANDO    := V_COMANDO || '    ' || P_ROTINA;
    V_COMANDO    := V_COMANDO || '       v_erro := null;';
    V_COMANDO    := V_COMANDO || '    exception when others then';
    V_COMANDO    := V_COMANDO || '       v_erro := sqlerrm;';
    V_COMANDO    := V_COMANDO || '    end;';
    V_COMANDO    := V_COMANDO || '  DBMS_PIPE.pack_message(' ||
                    V_INDEX_PIPE || ');';
    V_COMANDO    := V_COMANDO || '  DBMS_PIPE.pack_message(v_erro);';
    V_COMANDO    := V_COMANDO ||
                    '  v_resultado := DBMS_PIPE.send_message(''' ||
                    V_PIPENAME || ''');';
    V_COMANDO    := V_COMANDO || ' end;';

    RETURN V_COMANDO;

  END;

  PROCEDURE AGENDAR(P_COMANDO IN VARCHAR2) IS
    V_ID_JOB NUMBER;
  BEGIN

    DBMS_JOB.SUBMIT(JOB       => V_ID_JOB,
                    WHAT      => P_COMANDO,
                    NEXT_DATE => SYSDATE);

    COMMIT;

  END;

  PROCEDURE EXECUTAR(P_EXECUTAR IN OUT TYP_TB_EXECUTAR) IS
    V_COMANDO VARCHAR2(400);

  BEGIN

    FOR DD IN 1 .. P_EXECUTAR.COUNT LOOP

      V_COMANDO := COMANDO(P_ROTINA => P_EXECUTAR(DD).ROTINA);

      AGENDAR(P_COMANDO => V_COMANDO);

    END LOOP;

    FOR DD IN 1 .. V_INDEX_PIPE LOOP

      P_EXECUTAR(V_RESULTADO).ERRO := V_ERRO;

    END LOOP;

  END EXECUTAR;

END;
/

prompt
prompt Creating trigger TR_AU_TI_MOV_CTA_CORRENTE
prompt ==========================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_AU_TI_MOV_CTA_CORRENTE"
  after update on ti_movimento_cta_corrente
  for each row
declare
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 01/07/2014 | JOSIAS          |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/
  PRAGMA AUTONOMOUS_TRANSACTION;
begin
/*  If :new.cdsituacao = 'IT' then

     update ti_controle_integracao c
        set c.cdsituacao = 'IT'
      where c.nrsequencial = :new.nrseq_controle_integracao;

      commit;
  end if;*/
  null;
end TR_AU_TI_MOV_CTA_CORRENTE;
/

prompt
prompt Creating trigger TR_BI_CONTROLE_INTEGRACAO_HU
prompt =============================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BI_CONTROLE_INTEGRACAO_HU" BEFORE INSERT
ON EMS506UNICOO.TI_CONTROLE_INTEGRACAO FOR EACH ROW
DECLARE
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 17/12/2014 | EDMILSON        |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/
pragma autonomous_transaction;
begin

  if :new.tpintegracao = 'TR' and substr(:new.cdidentificador,1,2) = 'HU' then
     :new.cdsituacao:= 'HU';
  else if :new.tpintegracao = 'TR' and substr(:new.cdidentificador,1,2) = 'MD' then
     :new.cdsituacao:= 'MD';
       end if;
  end if;

end;
/

prompt
prompt Creating trigger TR_BI_MOVTO_RETORNO_TITULO_ACR
prompt ===============================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BI_MOVTO_RETORNO_TITULO_ACR"
  before insert  on MOVIMENTO_RETORNO_TITULO_ACR   for each row

declare
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 01/07/2014 | JOSIAS          |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/
  -- local variables here
    vNRSequencial Number;
begin
     select sq_movto_retorno_titulo_acr.NEXTVAL
     into
         vNRSequencial
     from dual;
     :NEW.NRSEQUENCIAL:=vNRSequencial;

end TR_BI_MOVTO_RETORNO_TITULO_ACR;
/

prompt
prompt Creating trigger TR_BI_TI_FALHA_DE_PROCESSO
prompt ===========================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BI_TI_FALHA_DE_PROCESSO"
  before insert  on EMS506UNICOO.TI_FALHA_DE_PROCESSO   for each row

declare
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 01/07/2014 | JOSIAS          |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/
  -- local variables here
    vNRSequencial Number;
begin
     select sq_ti_falha_de_processo.nextval
       into vnrsequencial
       from dual;

     :new.nrsequencial := vnrsequencial;
     :new.dtfalha      := sysdate;

end tr_bi_ti_falha_de_processo;
/

prompt
prompt Creating trigger TR_BI_TI_PESSOA
prompt ================================
prompt
create or replace trigger ems506unicoo."TR_BI_TI_PESSOA"
before insert or update  on ems506unicoo.ti_pessoa for each row
declare
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 01/07/2014 | JOSIAS          |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/
    ealteracao_cliente     exception;
    ealteracao_fornecedor  exception;
BEGIN
    begin
    -----------------------------------------------------------------------
    -- Josias - 01-07-2014
    -- Verifica se utiliza o EMS2 para definir nome abreviado com 12 digitos
    -----------------------------------------------------------------------
     --if f_TI_PARAMETRO_INTEGRACAO('AOUTILIZA_SISTEMA_EMS2') = 'S' then
     --   :new.noabreviado_cliente    := substr(:new.noabreviado_cliente,1,12);
     --   :new.noabreviado_fornecedor := substr(:new.noabreviado_fornecedor,1,12);
     --end if;

           if :new.Cdn_Cliente is not null
              and :old.Cdn_Cliente is not null
              and :old.Cdn_Cliente <> :new.Cdn_Cliente then
          NULL; --    raise ealteracao_cliente; vinicius 2801
           end if;

/*           if :new.cdn_cliente is not null and :old.cdn_cliente is null then
          BEGIN
                insert into texto_cadastro
                select
                    'CR' cdmodulo,
                    CDCLIENTE  cdcadastro,
                    'EMS' cdtipotexto,
                    SYSDATE dttexto,
                    'CLIENTE NO EMS5 ==> '||:new.Cdn_Cliente,
                    'CLIENTE NO EMS5'
                from producao.CLIENTE@UNICOO_HOMOLOGA CL
                WHERE
                     cl.nrregistro_cliente=:new.nrregistro;
               EXCEPTION WHEN OTHERS THEN NULL; END;
           end if;
*/
           if :new.Cdn_fornecedor is not null
              and :old.Cdn_fornecedor is not null
              and :old.Cdn_fornecedor <> :new.Cdn_fornecedor then
    NULL;  ---         raise ealteracao_fornecedor; vinicius 2801
           end if;
           --======================--
           -- Atualizar o cliente  --
           --------------------------
           if :new.cdn_cliente is not null and :old.cdn_cliente is null then
              update producao.cliente@UNICOO_HOMOLOGA c set cdcliente_ems5 = :new.cdn_cliente
               where c.nrregistro_cliente = :new.nrregistro;
           end if;

           --=========================--
           -- Atualizar o fornecedor  --
           -----------------------------
           if :new.cdn_fornecedor is not null and :old.cdn_fornecedor is null  then
              update producao.fornecedor@UNICOO_HOMOLOGA f set cdfornecedor_ems5 = :new.cdn_fornecedor
               where f.nrregistro_fornecedor = :new.nrregistro;
           end if;


     exception
        when ealteracao_cliente then
           raise_application_error(-20100, 'A pessoa '||:new.nrregistro||' possui o cliente '||:old.cdn_cliente
           ||' e esta sendo alterado para '||:new.cdn_cliente
           ||'. Alterac?o n?o permitida em TI_PESSOA');
        when ealteracao_fornecedor then
           raise_application_error(-20100, 'A pessoa '||:new.nrregistro||' possui o fornecedor '||:old.cdn_fornecedor
           ||' e esta sendo alterado para '||:new.cdn_fornecedor
           ||'. Alterac?o n?o permitida em TI_PESSOA');

        when others then null;
           raise_application_error(-20100, 'Erro ao incluir or alterar o TI_PESSOA '||:new.nrregistro||' '||SQLERRM);
     end;

END;
/

prompt
prompt Creating trigger TR_BI_TI_TIPO_MOV_TIT_APB
prompt ==========================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BI_TI_TIPO_MOV_TIT_APB"
  before insert on ti_tipo_movimento_tit_apb
  for each row
declare
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 01/07/2014 | JOSIAS          |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/
  -- local variables here
begin
  select sq_ti_tipo_movimento_tit_apb.nextval into :new.nrsequencial from dual;

end TR_BI_TI_TIPO_MOV_TIT_APB;
/

prompt
prompt Creating trigger TR_BIU_CONTROLE_INTEGRACAO_TP
prompt ==============================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_CONTROLE_INTEGRACAO_TP" BEFORE INSERT OR UPDATE  ON TI_CONTROLE_INTEGRACAO FOR EACH ROW
DECLARE
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 01/07/2014 | JOSIAS          |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/
aux number;
pragma autonomous_transaction;
begin

  if :new.tpintegracao = 'TP' then
     select count(*)
       into aux
       from titulo_a_pagar tp
      where tp.nrsequencianotafiscalent is not null
        and tp.nrregistro_titulo=:new.nrsequencial_origem;

     if aux = 0 then
        null;
     end if;
  end if;
end;
/

prompt
prompt Creating trigger TR_BIU_CST_TI_CONTROLE_INT_APB
prompt ===============================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_CST_TI_CONTROLE_INT_APB"
  before insert on ti_controle_integracao
  for each row
declare
  /*
  ***************************************************************************************************************
  Criac?o          : -
  Data             : -
  Modulo Principal : Integrac?o EMS5
  Modulos          : -
  Telas            : CR05FC7
  Objetivo         : Validar os dados da integrac?o

  Alteracoes
  +------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
  |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
  | 02/02/2015 | ALECSANDRO    |               |           | Bloquear a integração de titulos desmembrados     |
  |            |               |               |           |
  *|----------------------------------------------------------------------------------------------------------------|
  | 02/03/2015 | Jefferson     |               |           |  cdmovimento IN ('30','03')
                                                              tp.cdfuncionario not in  ('EMSACR','CONVERSAO');  |
  |            |               |               |           |
  *|----------------------------------------------------------------------------------------------------------------|

 */

  ---PRAGMA AUTONOMOUS_TRANSACTION;

  vCount      number;
  vDist       number;
  vDivisao    titulo_a_pagar.cddivisao%type;
  vHistorico  titulo_a_pagar.cdhistorico%type;
  VCDSITUACAO VARCHAR2(2);



begin
  :new.dtprocessamento := sysdate;
  if :new.tpintegracao = 'TP' then
    select nvl(count(*), 0)
      into vcount
      from historico_do_titulo_pagar tp
     where tp.nrregistro_titulo = :new.nrsequencial_origem
       and cdmovimento IN ('30','03')
       and tp.cdfuncionario not in  ('EMSACR','CONVERSAO');
    if vCount <> 0 then
      :new.cdsituacao      := 'CA';
      :new.txobservacao    := 'Nao pode integrar titulo de desmembramento(ems506unicoo.tr_biu_cst_ti_controle_int_apb)';
      :new.dtprocessamento := sysdate;
       pck_ems506unicoo.p_grava_falha(:new.nrsequencial,
      'TP',
      :new.txobservacao,
      :new.txobservacao,
      VCDSITUACAO,
      NULL);
    end if;
  end if;
end tr_biu_cst_ti_controle_int_apb;
/

prompt
prompt Creating trigger TR_BIU_CST_TI_TIT_ACR
prompt ======================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_CST_TI_TIT_ACR"
  before insert or update on EMS506UNICOO.ti_TIT_ACR   for each row

declare
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 06/10/2014 | JOSIAS          |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/  -- local variables here
    vCount Number;
begin
    if (:new.COD_ESPEC_DOCTO IN ('1MP','NPF','RCS') or :new.cod_estab in('02','04') )then
        :new.des_text_histor:='IMEDIATO';
    end if;

end tr_biu_cst_ti_tit_acr;
/

prompt
prompt Creating trigger TR_BIU_TI_BX_ACR_LIQ
prompt =====================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_TI_BX_ACR_LIQ"
  before insert or update on ems506unicoo.ti_cx_bx_acr   for each row

declare
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 28/07/2014 | Alessandro      |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/  -- local variables here
    vCount Number;
begin
    if (:NEW.cod_espec_docto = f_ti_parametro_integracao('ESPECIE_LIQ_PP')) then
       :NEW.cod_portador := f_ti_parametro_integracao('PROTADOR_BX_LIQ_PP');
    end if;

end tr_biu_ti_bx_acr_LIQ;
/

prompt
prompt Creating trigger TR_BIU_TI_CLIENTE
prompt ==================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_TI_CLIENTE"
  before insert or update or delete on EMS506UNICOO.TI_CLIENTE   for each row

declare
/*
***************************************************************************************************************
* Criacao              : Alecsandro Ferreira dos Santos
* Dt.Criacao           : 23/06/2009
* Modulo Principal     : Integrac?o do EMS5
* Versao               :
* Objetivo             : Atualizar o controle de integrac?o
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 16/11/2009 | Alecsandro      |              | Correc?o no processo de apagar as falhas da integrac?o           |
*|----------------------------------------------------------------------------------------------------------------|
*| 01/07/2014 | JOSIAS          |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|

************************************************************************************************************
*/

begin
    --==========================--
    -- Apagar Falha de Processo --
    ------------------------------
    if (:new.CDSITUACAO='RC' AND :OLD.cdsituacao<>'RC')
       OR
       (:new.CDSITUACAO='CA' AND :OLD.cdsituacao<>'CA')
       OR
       (:new.CDSITUACAO<>'PE' AND :OLD.cdsituacao='PE')
       OR
       (:new.CDSITUACAO<>'ER' AND :OLD.cdsituacao='ER')
        then
      pck_ems506unicoo.p_apaga_falha(:new.nrseq_controle_integracao);
  elsif
    
  (:new.CDSITUACAO='IT' AND :OLD.cdsituacao='PE') then
  
     update ti_falha_de_processo tf
     set tf.txfalha = 'Aviso: '||tf.txfalha
     where tf.nrseq_controle_integracao = :new.nrseq_controle_integracao;
     
      
    end if;
    ------------------------------------
    if inserting then
       :new.dat_envio:=sysdate;
    elsif updating then
          --================================--
          -- Atualizar o controle de STATUS --
          ------------------------------------
          if :new.cdsituacao<>:old.cdsituacao then
             :new.dat_processamento:=sysdate;
             pck_ems506unicoo.p_update_controle_integracao(:NEW.nrseq_controle_integracao,:new.cdsituacao,null);
          end if;
    end if;
    
    if deleting then
      
    pck_ems506unicoo.p_apaga_falha(:old.nrseq_controle_integracao);
 pck_ems506unicoo.p_update_controle_integracao(:old.nrseq_controle_integracao,'GE',null);
 end if;
   
    
end TR_BIU_TI_CLIENTE;
/

prompt
prompt Creating trigger TR_BIU_TI_CONTROLE_INTEG_FN
prompt ============================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_TI_CONTROLE_INTEG_FN"
  AFTER INSERT OR UPDATE ON EMS506UNICOO.TI_CONTROLE_INTEGRACAO
  FOR EACH ROW
declare
  /*
  ***************************************************************************************************************
  Criac?o          : -
  Data             : -
  Modulo Principal : Integrac?o EMS5
  Modulos          : -
  Telas            : CR05FC7
  Objetivo         : Validar os dados da integrac?o

  Alteracoes
  +------------------------------------------------------------------------------------------------------------------------------------------+
  | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
  |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
  | 04/11/2010 | ALESSANDRO    |               |           | Correc?o endereco do Fornecedor.
 *|----------------------------------------------------------------------------------------------------------------|
 *| 01/07/2014 | JOSIAS          |              | Ajustes necessários                                              |
  |------------|---------------|---------------|---------------------------------------------------------------------------------------------|

  */

  vCount      number;
  vCep        endereco.nrcep%type;
  vtpendereco endereco.tpendereco%type;
  vnrpessoa   endereco.nrregistro%type;

begin
/*
  if :new.tpintegracao = 'TP' then
     update ti_tit_apb_ctbl v set v.cod_estab = v.cod_estab
     where v.nrseq_controle_integracao = :new.nrsequencial;
  end if;
*/
  if :new.tpintegracao = 'FN' AND f_parametro('NRUNIMED') = '179' then

    begin

      select f.nrregistro_fornecedor
        into vnrpessoa
        from producao.fornecedor@UNICOO_HOMOLOGA f
       where f.cdfornecedor = :new.cdidentificador;

      vcount := 0;

      select count(*)
        into vcount
        from endereco e
       where e.nrregistro = vnrpessoa; --:new.nrsequencial_origem;

      if vcount = 0 then

        insert into endereco
          (nrregistro,
           tpendereco,
           nologradouro,
           nrimovel,
           txcomplemento,
           nobairro,
           cdcidade,
           cdestado,
           nrcep,
           nrtelefone,
           nrfax,
           nocontato,
           nocargocontato,
           cdemail,
           txobservacoes,
           aocorrespondencia,
           nooperador,
           nrcelular,
           aosituacao,
           nrddd,
           txreferencia_endereco,
           aoreside_exterior)
        values
          (vnrpessoa, --:new.nrsequencial_origem, --nrregistro,
           'COBR', -- tpendereco,
           'RODOVIA TANCREDO NEVES', -- nologradouro,
           '2500', -- nrimovel,
           null, -- txcomplemento,
           'JARDIM BELVEDERE', -- nobairro,
           '472', -- cdcidade,
           'RJ', -- cdestado,
           '27258000', -- nrcep,
           null, -- nrtelefone,
           null, -- nrfax,
           null, -- nocontato,
           null, -- nocargocontato,
           '', -- cdemail,
           null, -- txobservacoes,
           'N', -- aocorrespondencia,
           'INTEGRA', -- nooperador,
           null, -- nrcelular,
           'A', -- aosituacao,
           null, -- nrddd,
           null, -- txreferencia_endereco,
           'N' -- aoreside_exterior
           );

      else

        select e.nrcep, e.tpendereco
          into vcep, vtpendereco
          from endereco e
         where e.nrregistro = vnrpessoa; --:new.nrsequencial_origem;

        if vcep is null then

          update endereco e
             set e.nrcep = '27258000'
           where e.nrregistro = vnrpessoa --:new.nrsequencial_origem
             and e.tpendereco = vtpendereco;

        end if;

      end if;

    exception

      when others then
        null;

    end;

  end if;

end TR_BIU_TI_CONTROLE_INTEG_FN;
/

prompt
prompt Creating trigger TR_BIU_TI_CONTROLE_INTEGRACAO
prompt ==============================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_TI_CONTROLE_INTEGRACAO" before insert or update  on ti_controle_integracao
for each row
declare
/*
***************************************************************************************************************
Criac?o          : -
Data             : -
Modulo Principal : Integrac?o EMS5
Modulos          : -
Telas            : CR05FC7
Objetivo         : Validar os dados da integrac?o

Alteracoes
+------------------------------------------------------------------------------------------------------------------------------------------+
| DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
|------------|---------------|---------------|---------------------------------------------------------------------------------------------|
| 27/10/2009 | ALECSANDRO    |               |           | Ao reprocessar um registro com erro o sistema passou a verificar se o mesmo     |
|            |               |               |           | se o mesmo esta valido.
*|----------------------------------------------------------------------------------------------------------------|
*| 01/07/2014 | JOSIAS        |               |           |Ajustes necessários                                              |
|------------|---------------|---------------|---------------------------------------------------------------------------------------------|
*/

  vCount number;
  vDist  number;
  vDivisao titulo_a_pagar.cddivisao%type;
  vHistorico titulo_a_pagar.cdhistorico%type;

begin
    :new.dtprocessamento:=sysdate;
/*
    if :old.cdsituacao <> :new.cdsituacao then
       if :new.tpintegracao = 'TP' then
          update ti_tit_apb tp set tp.cdsituacao = :new.cdsituacao;
       end if;
       if :new.tpintegracao = 'TR' then
          update ti_tit_acr tr set tr.cdsituacao = :new.cdsituacao;
       end if;
       if :new.tpintegracao = 'FN' then
          update ti_fornecedor fn set fn.cdsituacao = :new.cdsituacao;
       end if;
       if :new.tpintegracao = 'CL' then
          update ti_cliente cl set cl.cdsituacao = :new.cdsituacao;
       end if;
       if :new.tpintegracao = 'BR' then
          update ti_cx_bx_acr br set br.cdsituacao = :new.cdsituacao;
       end if;
    end if;
    */
    if :old.cdsituacao = 'ER' and :new.cdsituacao <> 'ER' then

       pck_ems506unicoo.p_apaga_falha(:new.nrsequencial);
       --=========================================--
       -- Verifica se o titulo a receber e valido --
       ---------------------------------------------
       if :new.tpintegracao='TR' then
           select count(*)
           into
               vCount
           from titulo_a_receber tr
           where
                tr.nrregistro_titulo=:new.nrsequencial_origem;
           if vCount=0 then
              :new.cdsituacao:='CA';
              :new.txobservacao:='Titulo n?o encontrato no contas a receber do Unicoo';
              :new.dtprocessamento:=sysdate;
           end if;
       end if;
       --=========================================--
       -- Verifica se o titulo a pagar e valido --
       ---------------------------------------------
       if :new.tpintegracao='TP' then
           select count(*)
           into
               vCount
           from titulo_a_pagar tp
           where
                tp.nrregistro_titulo=:new.nrsequencial_origem;
           if vCount=0 then
              :new.cdsituacao:='CA';
              :new.txobservacao:='Titulo n?o encontrato no contas a receber do Unicoo';
              :new.dtprocessamento:=sysdate;
           end if;
       end if;

       --================================--
       -- Verifica se o cliente e valido --
       ------------------------------------
       if :new.tpintegracao='CL' then
           select count(*)
           into
               vCount
           from producao.cliente@UNICOO_HOMOLOGA cl
           where
                cl.nrregistro_cliente=:new.nrsequencial_origem
                and
                cl.cdcliente=:new.cdidentificador;

           if vCount=0 then
              :new.cdsituacao:='CA';
              :new.txobservacao:='Cliente n?o encontrato no contas a receber do Unicoo';
              :new.dtprocessamento:=sysdate;
           end if;
       end if;
       --================================--
       -- Verifica se o cliente e valido --
       ------------------------------------
       if :new.tpintegracao='FN' then
           select count(*)
           into
               vCount
           from producao.fornecedor@UNICOO_HOMOLOGA fn
           where
                fn.nrregistro_fornecedor=:new.nrsequencial_origem
                and
                fn.cdfornecedor=:new.cdidentificador;

           if vCount=0 then
              :new.cdsituacao:='CA';
              :new.txobservacao:='Titulo n?o encontrato no contas a receber do Unicoo';
              :new.dtprocessamento:=sysdate;
           end if;
       end if;

       --================================--
       -- Verifica se o movimento de caixa e valido --
       ------------------------------------
       if :new.tpintegracao='CX' then
           select count(*)
           into
               vCount
           from movimento_caixa mc
           where
                mc.nrmovimento = :new.nrsequencial_origem;

           if vCount=0 then
              :new.cdsituacao:='CA';
              :new.txobservacao:='Movimento Caixa n?o encontrato nna tabela do Unicoo';
              :new.dtprocessamento:=sysdate;
           end if;
       end if;
    end if;

    if :new.tpintegracao ='TP'
       and :new.cdmodulo    <> 'PP'
       and (:new.cdmovimento is null or :new.cddivisao is null) then

       vDist := 0;

        select count(*) into vDist
          from distribuicao_titulo_pagar dtp,
               titulo_a_pagar            tp
         where dtp.nrregistro_titulo = :new.nrsequencial_origem
           and dtp.aoativo = 'S'
           and dtp.nrregistro_titulo = tp.nrregistro_titulo
           and tp.cdorigem <> 'PP'
           and tp.nrdocumento not like 'TX%';

       if vDist = 1 then

         select f_acha_distribuicao(:new.nrsequencial_origem,'DIS'),
                f_acha_distribuicao(:new.nrsequencial_origem,'HIS')
                into vDivisao, vHistorico
           from distribuicao_titulo_pagar dtp
          where dtp.nrregistro_titulo = :new.nrsequencial_origem
            and dtp.aoativo = 'S';

         :new.cdmovimento := vHistorico;
         :new.cddivisao   := vDivisao;

       end if;

    end if;

    if :new.cdcentro_custo is null then
       :new.cdcentro_custo := ' ';
    end if;
end tr_biu_controle_integracao;
/

prompt
prompt Creating trigger TR_BIU_TI_CX_BX_ACR
prompt ====================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_TI_CX_BX_ACR"
  before insert or update on ems506unicoo.ti_cx_bx_acr   for each row

declare
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 23/09/2014 | Alessandro      |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/  -- local variables here
    vCount Number;
begin
    --==========================--
    -- Apagar Falha de Processo --
    ------------------------------
    if (:new.cdsituacao = 'RC' and :old.cdsituacao <> 'RC')
       or
       (:new.cdsituacao = 'CA' and :old.cdsituacao<>'CA') then
       pck_ems506unicoo.p_apaga_falha(:new.nrseq_controle_integracao);
    end if;
    ------------------------------------
   
    if :new.cdsituacao <> :old.cdsituacao then
      
    update ti_controle_integracao tc
    set tc.cdsituacao = :new.cdsituacao
    where tc.nrsequencial = :new.nrseq_controle_integracao;
    
    end if;

end tr_biu_ti_cx_bx_acr;
/

prompt
prompt Creating trigger TR_BIU_TI_CX_BX_APB
prompt ====================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_TI_CX_BX_APB"
  before insert or update on ems506unicoo.ti_cx_bx_apb   for each row

declare
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 04/11/2014 | JOSIAS          |              | Criação do Objeto                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/  -- local variables here
    vCount Number;
    vdatareferencia Date;
    NrdiasVencimento Number;
begin
    --==========================--
    -- Apagar Falha de Processo --
    ------------------------------
    if (:new.cdsituacao = 'RC' and :old.cdsituacao <> 'RC')
       or
       (:new.cdsituacao = 'CA' and :old.cdsituacao <> 'CA')
        then
      pck_ems506unicoo.p_apaga_falha(:new.nrseq_controle_integracao);
    end if;
    ------------------------------------

    if inserting then
       :new.dat_envio := sysdate;
        pck_ems506unicoo.p_update_controle_integracao(:new.nrseq_controle_integracao,:new.cdsituacao,null);

    elsif updating then
          --================================--
          -- Atualizar o controle de STATUS --
          ------------------------------------
          if :new.cdsituacao <> :old.cdsituacao then
             :new.dat_processamento := sysdate;
             pck_ems506unicoo.p_update_controle_integracao(:new.nrseq_controle_integracao,:new.cdsituacao,null);
          end if;
    end if;

end tr_biu_ti_cx_bx_apb;
/

prompt
prompt Creating trigger TR_BIU_TI_FORNECEDOR
prompt =====================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_TI_FORNECEDOR"
  before insert or update or delete
on EMS506UNICOO.TI_FORNECEDOR
   for each row

declare
/*
***************************************************************************************************************
* Criacao              : Alecsandro Ferreira dos Santos
* Dt.Criacao           : 23/06/2009
* Modulo Principal     : Integrac?o do EMS5
* Versao               :
* Objetivo             : Atualizar o controle de integrac?o
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 16/11/2009 | Alecsandro      |              | Correc?o no processo de apagar as falhas da integrac?o           |
*|----------------------------------------------------------------------------------------------------------------|
*| 01/07/2014 | JOSIAS          |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|

************************************************************************************************************
*/

PNRCEP TI_PARAMETRO_INTEGRACAO.CDPARAMETRO%TYPE;

BEGIN
  

PNRCEP := f_ti_parametro_integracao('NRCEP_DEFAULT_INCLUSAO');

    --==========================--
    -- Apagar Falha de Processo --
    ------------------------------
    if (:new.cdsituacao = 'RC' and :old.cdsituacao <> 'RC')
       or
       (:new.cdsituacao = 'CA' AND :old.cdsituacao <> 'CA') 
       or
       (:new.cdsituacao <> 'PE' AND :old.cdsituacao = 'PE') 
       or
       (:new.cdsituacao <> 'ER' AND :old.cdsituacao = 'ER')
       then

       pck_ems506unicoo.p_apaga_falha(:new.nrseq_controle_integracao);

    end if;
    
  
    ------------------------------------
    if inserting then
       :new.dat_envio:=sysdate;
    elsif updating then
          --================================--
          -- Atualizar o controle de STATUS --
          ------------------------------------
          if :new.cdsituacao <> :old.cdsituacao then
             :new.dat_processamento := sysdate;
              pck_ems506unicoo.p_update_controle_integracao(:new.nrseq_controle_integracao,:new.cdsituacao,null);
          end if;
    end if;


    -------------------------------------------------------------
    -- josias 30-06-2014
    -- feito o tratamento para os endereços com menos de 3 digitos com ponto ou virgula e zero.
    -------------------------------------------------------------
    if length(:new.nom_endereco) < 3 then
      :new.nom_endereco := translate(:new.nom_endereco,'.,0','   ');

    end if;


    -------------------------------------------------------------
    -- josias 30-06-2014
    -- feito o tratamento para os ceps com menos de oito digitos.
    -------------------------------------------------------------

    if inserting or updating then

        :new.cod_cep := TRANSLATE(UPPER(:new.cod_cep),'ABCDEFGHIJKLMNOPQRSTUVXZ-=','                          ');
        :new.cod_cep_pagto := TRANSLATE(UPPER(:new.cod_cep_pagto),'ABCDEFGHIJKLMNOPQRSTUVXZ-=','
                                 ');
        if length(trim(replace(:new.cod_cep,' ',''))) < 8 then
            :new.cod_cep := PNRCEP;
        else
            if :new.cod_cep = '00000000' then
                :new.cod_cep := PNRCEP;
            else
               :new.cod_cep := nvl(trim(:new.cod_cep),PNRCEP);
            end if;
        end if;

        if length(trim(replace(:new.cod_cep_pagto,' ',''))) < 8 then
            :new.cod_cep_pagto := PNRCEP;
        else
            if :new.cod_cep_pagto = '00000000' then
                :new.cod_cep_pagto := PNRCEP;
            else
               :new.cod_cep_pagto := nvl(trim(:new.cod_cep_pagto),PNRCEP);
            end if;
        end if;
   end if;        
    
    if deleting then
      pck_ems506unicoo.p_apaga_falha(:old.nrseq_controle_integracao);
 pck_ems506unicoo.p_update_controle_integracao(:old.nrseq_controle_integracao,'GE',null);
 end if;

end tr_biu_ti_fornecedor;
/

prompt
prompt Creating trigger TR_BIU_TI_LOTE_CTBL
prompt ====================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_TI_LOTE_CTBL"
  before insert or update on EMS506UNICOO.TI_LOTE_CTBL   for each row

declare
/*
***************************************************************************************************************
Criac?o          : 04/11/2009
Data             : -
Modulo Principal : Integrac?o EMS5
Modulos          : -
Telas            :
Objetivo         : Atualizar controle de integrac?o e limpar falhas

Alteracoes
 +------------------------------------------------------------------------------------------------------------------------------------------+
 | DATA       | RESPONSAVEL   | VERSAO        | PENDENCIA | ALTERACAO                                                                       |
 |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
 | 04/11/2009 | ALECSANDRO    |               |           |                                                                                 |
*|----------------------------------------------------------------------------------------------------------------|
*| 01/07/2014 | JOSIAS        |               | Ajustes necessários                                              |
 |------------|---------------|---------------|---------------------------------------------------------------------------------------------|
*/
vAocontabilizado varchar2(1);

begin
    pck_ems506unicoo.p_update_controle_integracao(
                                                    :new.nrseq_controle_integracao,
                                                    :new.cdsituacao,
                                                    NULL
                                                    );
    if inserting then
        :new.dat_geracao:=sysdate;
    elsif updating then
        --==========================--
        -- Apagar Falha de Processo --
        ------------------------------
        if :new.cdsituacao='RC' AND :OLD.cdsituacao<>'RC' then
           pck_ems506unicoo.p_apaga_falha(:new.nrseq_controle_integracao);

        end if;
        --=================================--
        -- Atualiza controle de integrac?o --
        -------------------------------------
        if :new.cdsituacao<>:old.cdsituacao then
           :new.dat_processamento:=sysdate;
            pck_ems506unicoo.p_update_controle_integracao(
                                                            :new.nrseq_controle_integracao,
                                                            :new.cdsituacao,
                                                            NULL
                                                            );
        end if;
    end if;
    --================================--
    -- Verifica se o lote esta valido --
    ------------------------------------
    if
       (
         (:new.cdsituacao='RC' AND :OLD.cdsituacao<>'RC')
         OR
         inserting
       ) then
       if  nvl(:NEW.AOLOTE_INTEGRACAO,'N')='S' then
             begin
                  select aocontabilizado
                  into
                      vAocontabilizado
                  from
                       lote_de_integracao li
                  where
                       li.nrlote_integracao=substr(:new.des_lote_ctbl,2,6);


                  if vAocontabilizado ='N' then
                                   :new.cdsituacao:='CA';
                                    pck_ems506unicoo.p_update_controle_integracao(
                                                                                    :new.nrseq_controle_integracao,
                                                                                    :new.cdsituacao,
                                                                                    'O lote n?o esta contabilizado no Unicoo'
                                                                                    );
                  end if;
             exception
                   when no_data_found then
                                   :new.cdsituacao:='CA';
                                    pck_ems506unicoo.p_update_controle_integracao(
                                                                                    :new.nrseq_controle_integracao,
                                                                                    :new.cdsituacao,
                                                                                    'Lote n?o existe em Unicoo'
                                                                                    );

             end;
       else
          pck_ems506unicoo.p_update_controle_integracao(
                                                          :new.nrseq_controle_integracao,
                                                          :new.cdsituacao,
                                                          null
                                                          );

       end if;
    end if;
end TR_BIU_TI_LOTE_CTBL;
/

prompt
prompt Creating trigger TR_BIU_TI_MOV_CC_FALHA
prompt =======================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_TI_MOV_CC_FALHA"
  BEFORE UPDATE ON EMS506UNICOO.TI_MOVIMENTO_CTA_CORRENTE
  FOR EACH ROW

DECLARE
  VAOFALHA CHAR;
BEGIN

  IF :NEW.CDSITUACAO = 'PE'  THEN
    BEGIN
      SELECT 'S'
        INTO VAOFALHA
        FROM EMS506UNICOO.TI_FALHA_DE_PROCESSO TF
       WHERE TF.TXFALHA LIKE
             'Favor comunicar a Datasul o número desta mensagem%e o local em que ela apareceu.'
         AND TF.NRSEQ_CONTROLE_INTEGRACAO = :NEW.NRSEQ_CONTROLE_INTEGRACAO;
    EXCEPTION
      WHEN NO_DATA_FOUND THEN
        VAOFALHA := 'N';
    END;

    IF VAOFALHA = 'S' THEN
      PCK_EMS506UNICOO.P_APAGA_FALHA(:NEW.NRSEQ_CONTROLE_INTEGRACAO);
      :NEW.CDSITUACAO := 'RC';
    END IF;

  END IF;
END TR_BIU_TI_MOV_CC_FALHA;
/

prompt
prompt Creating trigger TR_BIU_TI_MOVTO_CTA_CORRENTE
prompt =============================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_TI_MOVTO_CTA_CORRENTE"
  before insert or update on EMS506UNICOO.ti_movimento_cta_corrente   for each row

declare
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 01/07/2014 | JOSIAS          |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/
  -- local variables here
    vCount Number;
begin
    --==========================--
    -- Apagar Falha de Processo --
    ------------------------------
    if (:new.CDSITUACAO='RC' AND :OLD.cdsituacao<>'RC')
       OR
       (:new.CDSITUACAO='CA' AND :OLD.cdsituacao<>'CA')
        then
      pck_ems506unicoo.p_apaga_falha(:new.nrseq_controle_integracao);
    end if;
    ------------------------------------
    if inserting then
       :new.dat_envio:=sysdate;
    elsif updating then
          --================================--
          -- Atualizar o controle de STATUS --
          ------------------------------------
          if :new.cdsituacao<>:old.cdsituacao then
             :new.dat_processamento:=sysdate;
             pck_ems506unicoo.p_update_controle_integracao(:NEW.nrseq_controle_integracao,:new.cdsituacao,null);
          end if;
    end if;

end TR_BIU_TI_MOVTO_CTA_CORRENTE;
/

prompt
prompt Creating trigger TR_BIU_TI_TIT_ACR
prompt ==================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_TI_TIT_ACR"
  before insert or update or delete on EMS506UNICOO.ti_TIT_ACR   for each row

declare
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 01/07/2014 | JOSIAS          |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/  -- local variables here
    vCount Number;
begin
    --==========================--
    -- Apagar Falha de Processo --
    ------------------------------
    if (:new.cdsituacao = 'RC' and :old.cdsituacao <> 'RC')
       or
       (:new.cdsituacao = 'CA' and :old.cdsituacao <> 'CA') then
      pck_ems506unicoo.p_apaga_falha(:new.nrseq_controle_integracao);
    end if;
    ------------------------------------
    if inserting then
       :new.dat_envio:=sysdate;
    elsif updating then
          --================================--
          -- Atualizar o controle de STATUS --
          ------------------------------------
          if :new.cdsituacao<>:old.cdsituacao then
             :new.dat_processamento:=sysdate;
             --pck_ems506unicoo.p_update_controle_integracao(:NEW.nrseq_controle_integracao,:new.cdsituacao,null);
          
          UPDATE TI_CONTROLE_INTEGRACAO TI
       SET TI.CDSITUACAO      = :new.cdsituacao,
           TI.TXOBSERVACAO    = null,
           TI.DTINTEGRACAO    = DECODE(:new.cdsituacao, 'IT', SYSDATE, NULL),
           TI.DTPROCESSAMENTO = SYSDATE
     WHERE TI.NRSEQUENCIAL = :NEW.nrseq_controle_integracao;

          
          
          end if;
    end if;
    if deleting then
      
    pck_ems506unicoo.p_apaga_falha(:old.nrseq_controle_integracao);
 pck_ems506unicoo.p_update_controle_integracao(:old.nrseq_controle_integracao,'GE',null);
 
 delete from ti_tit_acr_ctbl tctb
 where tctb.nrseq_controle_integracao = :old.nrseq_controle_integracao;
 
 delete from ti_tit_acr_imposto timp
 where timp.nrseq_controle_integracao = :old.nrseq_controle_integracao;
 
 
 end if;

end tr_biu_ti_tit_acr;
/

prompt
prompt Creating trigger TR_BIU_TI_TIT_ACR_ESTORNO
prompt ==========================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_TI_TIT_ACR_ESTORNO"
  before insert or update on TI_TIT_ACR_ESTORNO   for each row

declare
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 01/07/2014 | JOSIAS          |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/  -- local variables here
  vCount number;
  vCdidentificador ti_controle_integracao.cdidentificador%type;
  /*================
  * IT (Integrado/Processado
    PE (Pendente)
    CA (Cancelado)
  */
begin
    if inserting then
       :new.dat_envio:=sysdate;
        pck_ems506unicoo.p_update_controle_integracao(
                                                        :new.nrseq_controle_integracao,
                                                        :new.cdsituacao,
                                                        NULL
                                                        );
    elsif updating then
        --==========================--
        -- Apagar Falha de Processo --
        ------------------------------
        if :new.cdsituacao='RC' AND :OLD.cdsituacao<>'RC' then
           pck_ems506unicoo.p_apaga_falha(:new.nrseq_controle_integracao);
           --================================================--
           -- Verifica se o titulo j esta estornado no EMS5 --
           ----------------------------------------------------
           begin
                SELECT count(*)
                into
                       vCount
                FROM movto_tit_acr mt
                where
                       mt.num_id_tit_acr=:new.num_id_tit_acr
                       and
                       mt.ind_trans_acr_abrev='ESTT';
           exception
                     when others then vCount:=0;
           end;
           if vCount>0 then  -- J estornado
               -----------------------------------
               -- Atualiza status de integracao --
               -----------------------------------
               :new.cdsituacao:='CA';
           end if;
        end if;
        --=================================--
        -- Atualiza controle de integrao --
        -------------------------------------
        if :new.cdsituacao<>:old.cdsituacao then
           :new.dat_processamento:=sysdate;
            pck_ems506unicoo.p_update_controle_integracao(
                                                            :new.nrseq_controle_integracao,
                                                            :new.cdsituacao,
                                                            NULL
                                                            );
        end if;
    end if;

    --==========================--
    -- Apagar Falha de Processo --
    ------------------------------
    if (:new.CDSITUACAO='RC' AND :OLD.cdsituacao<>'RC')
       OR
       (:new.CDSITUACAO='CA' AND :OLD.cdsituacao<>'CA')
        then
      pck_ems506unicoo.p_apaga_falha(:new.nrseq_controle_integracao);
    end if;

    /*if :new.cdsituacao = 'IT' then
      begin
        select cdidentificador into vCdidentificador from ti_controle_integracao c
        where c.nrsequencial= :new.nrseq_controle_integracao;
        end;

       P_MARCA_CONTABILIZA_ESTORNO(vCdidentificador);

     end if;*/

end TR_BIU_TI_TIT_ACR_ESTORNO;
/

prompt
prompt Creating trigger TR_BIU_TI_TIT_APB
prompt ==================================
prompt
CREATE OR REPLACE TRIGGER "EMS506UNICOO"."TR_BIU_TI_TIT_APB"
  before insert or update or delete on ems506unicoo.ti_tit_apb   for each row

declare
/*
***************************************************************************************************************
* Criacao              :
* Dt.Criacao           :
* Modulo Principal     : Integração do EMS5
* Versao               :
* Objetivo             :
* Historico
*|----------------------------------------------------------------------------------------------------------------
*| DATA       | RESPONSAVEL     | VERSAO       | ALTERACAO                                                        |
*|----------------------------------------------------------------------------------------------------------------|
*| 01/07/2014 | JOSIAS          |              | Ajustes necessários                                              |
*|----------------------------------------------------------------------------------------------------------------|
************************************************************************************************************
*/  -- local variables here
--    vCount Number;
--    vdatareferencia Date;
--    NrdiasVencimento Number;
begin
    --==========================--
    -- Apagar Falha de Processo --
    ------------------------------
    if (:new.cdsituacao = 'RC' and :old.cdsituacao <> 'RC')
       or
       (:new.cdsituacao='CA' and :old.cdsituacao<>'CA')
        then
      pck_ems506unicoo.p_apaga_falha(:new.nrseq_controle_integracao);
    end if;
    ------------------------------------

    if inserting then
       :new.dat_envio:=sysdate;
        pck_ems506unicoo.p_update_controle_integracao(:new.nrseq_controle_integracao,:new.cdsituacao,null);

    elsif updating then
          --================================--
          -- Atualizar o controle de STATUS --
          ------------------------------------
          if :new.cdsituacao <> :old.cdsituacao then
             :new.dat_processamento:=sysdate;
             pck_ems506unicoo.p_update_controle_integracao(:new.nrseq_controle_integracao,:new.cdsituacao,null);
          end if;
    end if;


 if deleting then
   
 pck_ems506unicoo.p_apaga_falha(:old.nrseq_controle_integracao);
 pck_ems506unicoo.p_update_controle_integracao(:old.nrseq_controle_integracao,'GE',null);
 
 delete from ti_tit_apb_ctbl tctb
 where tctb.nrseq_controle_integracao = :old.nrseq_controle_integracao;

 delete from ti_tit_apb_imposto timp
 where timp.nrseq_controle_integracao = :old.nrseq_controle_integracao;
 
 
 end if;
 
end tr_biu_ti_tit_apb;
/


spool off
